---
uid: whitepapers/ms03-32-issue
title: 套用 IE 的安全性更新之後，修正「伺服器應用程式無法使用」錯誤Microsoft Docs
author: rick-anderson
description: 本文說明的修補程式可修正 Internet Explorer 的 MS03-32 安全性更新問題，這會影響在 Wi-fi 上執行的 ASP.NET 1.0 應用程式。
ms.author: riande
ms.date: 02/10/2010
ms.assetid: 1365eebb-bdf7-4a05-8d18-7f200531be55
msc.legacyurl: /whitepapers/ms03-32-issue
msc.type: content
ms.openlocfilehash: e0b6776cbfe22e341ac7105f03daac5074b480fc
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/06/2020
ms.locfileid: "78574183"
---
# <a name="fix-for-server-application-unavailable-error-after-applying-security-update-for-ie"></a><span data-ttu-id="a836d-103">套用 IE 的安全性更新之後，修正「無法使用伺服器應用程式」錯誤</span><span class="sxs-lookup"><span data-stu-id="a836d-103">Fix for 'Server Application Unavailable' Error after Applying Security Update for IE</span></span>

> <span data-ttu-id="a836d-104">本文說明的修補程式可修正 Internet Explorer 的 MS03-32 安全性更新問題，這會影響在 Windows XP Professional 上執行的 ASP.NET 1.0 應用程式。</span><span class="sxs-lookup"><span data-stu-id="a836d-104">This paper describes the patch that fixes an issue with the MS03-32 Security Update for Internet Explorer that affects ASP.NET 1.0 applications running on Windows XP Professional.</span></span>
> 
> <span data-ttu-id="a836d-105">適用于 ASP.NET 1.0 和 Windows XP Professional。</span><span class="sxs-lookup"><span data-stu-id="a836d-105">Applies to ASP.NET 1.0 and Windows XP Professional.</span></span>

<span data-ttu-id="a836d-106">Microsoft 發現 Windows XP 上執行的 Internet Explorer 安全性修補程式和 ASP.NET 1.0 的 MS03-32 安全性更新發生問題。</span><span class="sxs-lookup"><span data-stu-id="a836d-106">Microsoft identified an issue with the MS03-32 Security Update for Internet Explorer security patch and ASP.NET 1.0 running on Windows XP.</span></span> <span data-ttu-id="a836d-107">您可以手動安裝此修補程式，或從 Windows Update 網站取得最近的重大更新。</span><span class="sxs-lookup"><span data-stu-id="a836d-107">This patch can be installed manually or by obtaining recent critical updates from the Windows Update site.</span></span>

<span data-ttu-id="a836d-108">這個問題的徵兆是，在 Windows XP 電腦上安裝修補程式之後，ASP.NET 在本機 IIS 5.1 web 伺服器上執行之應用程式的所有要求都會產生一則錯誤訊息，指出「伺服器應用程式無法使用」。</span><span class="sxs-lookup"><span data-stu-id="a836d-108">The symptom of this issue is that after installing the patch on a Windows XP machine, all requests to ASP.NET applications running on the local IIS 5.1 web server result in an error message saying "Server Application Unavailable".</span></span> <span data-ttu-id="a836d-109">對遠端網頁伺服器的要求不會受到影響。</span><span class="sxs-lookup"><span data-stu-id="a836d-109">Requests to remote web servers are unaffected.</span></span>

<span data-ttu-id="a836d-110">這個問題只會影響在 Windows XP 上執行 ASP.NET 1.0 的安裝。</span><span class="sxs-lookup"><span data-stu-id="a836d-110">This issue only impacts installations running ASP.NET 1.0 on Windows XP.</span></span> <span data-ttu-id="a836d-111">它不會影響執行 Windows 2000 或 Windows Server 2003 的機器。</span><span class="sxs-lookup"><span data-stu-id="a836d-111">It does not impact machines running Windows 2000 or Windows Server 2003.</span></span> <span data-ttu-id="a836d-112">它也不會影響執行 Windows XP 且已安裝 ASP.NET 1.1 的機器。</span><span class="sxs-lookup"><span data-stu-id="a836d-112">It also does not impact machines running Windows XP with ASP.NET 1.1 installed.</span></span>

<span data-ttu-id="a836d-113">請注意，此問題**不是**ASP.NET 的安全性錯誤。</span><span class="sxs-lookup"><span data-stu-id="a836d-113">Please note that this issue **is not** a security bug with ASP.NET.</span></span> <span data-ttu-id="a836d-114">它不**會**開啟或允許對 ASP.NET 應用程式或伺服器進行任何惡意的攻擊。</span><span class="sxs-lookup"><span data-stu-id="a836d-114">It **does not** open up or allow any malicious attacks against an ASP.NET application or server.</span></span> <span data-ttu-id="a836d-115">相反地，它只是由修補程式本身所造成的功能性 bug。</span><span class="sxs-lookup"><span data-stu-id="a836d-115">Instead, it is purely a functional bug caused by the patch itself.</span></span>

<span data-ttu-id="a836d-116">我們正在努力解決此問題的永久性解決方案。</span><span class="sxs-lookup"><span data-stu-id="a836d-116">We are working hard on a permanent solution for this issue.</span></span> <span data-ttu-id="a836d-117">在此同時，您可以執行下列批次檔，做為問題的因應措施。</span><span class="sxs-lookup"><span data-stu-id="a836d-117">In the meantime, you can execute the following batch file as a workaround for the issue.</span></span> <span data-ttu-id="a836d-118">批次檔會執行下列動作：</span><span class="sxs-lookup"><span data-stu-id="a836d-118">The batch file does the following:</span></span>

1. <span data-ttu-id="a836d-119">停止 IIS 和 ASP.NET 狀態服務</span><span class="sxs-lookup"><span data-stu-id="a836d-119">Stops the IIS and ASP.NET state services</span></span>
2. <span data-ttu-id="a836d-120">刪除並重新建立具有已知暫時密碼的 ASPNET 帳戶</span><span class="sxs-lookup"><span data-stu-id="a836d-120">Deletes and recreates the ASPNET account with a known temporary password</span></span>
3. <span data-ttu-id="a836d-121">使用 Windows `runas` 命令來啟動可執行檔，以建立 ASPNET 使用者設定檔</span><span class="sxs-lookup"><span data-stu-id="a836d-121">Uses the Windows `runas` command to launch an executable that creates an ASPNET user profile</span></span>
4. <span data-ttu-id="a836d-122">重新註冊 ASP.NET。</span><span class="sxs-lookup"><span data-stu-id="a836d-122">Re-registers ASP.NET.</span></span> <span data-ttu-id="a836d-123">這會為帳戶建立新的隨機密碼，並為其套用預設的 ASP.NET 存取控制設定</span><span class="sxs-lookup"><span data-stu-id="a836d-123">This creates a new random password for the account and applies default ASP.NET access control settings for it</span></span>
5. <span data-ttu-id="a836d-124">重新開機 IIS 服務</span><span class="sxs-lookup"><span data-stu-id="a836d-124">Restarts the IIS service</span></span>

<span data-ttu-id="a836d-125">批次檔包含「<strong>1pass\@word</strong>」的硬式編碼暫時密碼，當批次檔執行時，系統會提示您輸入 runas 命令。</span><span class="sxs-lookup"><span data-stu-id="a836d-125">The batch file contains a hardcoded temporary password of "<strong>1pass\@word</strong>" which you will be prompted to enter for the runas command when the batch file is run.</span></span> <span data-ttu-id="a836d-126">Runas 命令完成之後，會使用強式隨機值重新建立 ASPNET 帳戶密碼。</span><span class="sxs-lookup"><span data-stu-id="a836d-126">After the runas command completes, the ASPNET account password is recreated with a strong random value.</span></span> <span data-ttu-id="a836d-127">請注意，如果硬式編碼的密碼不符合環境中的密碼複雜性需求，批次檔可能會失敗。</span><span class="sxs-lookup"><span data-stu-id="a836d-127">Note that the batch file may fail if the hardcoded password does not meet the password complexity requirements in your environment.</span></span> <span data-ttu-id="a836d-128">如果是這種情況，您可以將它變更為適用于您環境的另一個值。</span><span class="sxs-lookup"><span data-stu-id="a836d-128">If that's the case, you can change it to another value that is appropriate for your environment.</span></span>

<span data-ttu-id="a836d-129">*> [!IMPORTANT]* 如果您已新增 ASPNET 帳戶的自訂存取控制設定或資料庫帳戶許可權，則必須在此批次檔完成之後重新建立。</span><span class="sxs-lookup"><span data-stu-id="a836d-129">*> [!IMPORTANT]* If you have added custom access control settings or database account permissions for the ASPNET account, they will need to be recreated after this batch file completes.</span></span> <span data-ttu-id="a836d-130">這是因為重新建立帳戶時，將會取得新的安全識別碼（SID）。</span><span class="sxs-lookup"><span data-stu-id="a836d-130">This is because when the account is recreated, it will get a new security identifier (SID).</span></span>

<span data-ttu-id="a836d-131">*> [!IMPORTANT]* 如果您使用 ASPNET 帳戶以外的自訂帳戶來執行 ASP.NET 背景工作進程，則不應該執行此批次檔。</span><span class="sxs-lookup"><span data-stu-id="a836d-131">*> [!IMPORTANT]* If you are running the ASP.NET worker process with a custom account other than the ASPNET account, then you should not run this batch file.</span></span> <span data-ttu-id="a836d-132">相反地，您應該以互動方式登入，或使用 runas 命令搭配該帳戶，這會建立該帳戶的使用者設定檔。</span><span class="sxs-lookup"><span data-stu-id="a836d-132">Instead, you should log in interactively or use the runas command with that account which will create a user profile for that account.</span></span>

<span data-ttu-id="a836d-133">批次檔包含在下面的自我解壓縮封存中。</span><span class="sxs-lookup"><span data-stu-id="a836d-133">The batch file is included in the self-extracting archive below.</span></span> <span data-ttu-id="a836d-134">使用方式：</span><span class="sxs-lookup"><span data-stu-id="a836d-134">To use it:</span></span>

1. <span data-ttu-id="a836d-135">您必須以具有系統管理員許可權的帳戶身分執行</span><span class="sxs-lookup"><span data-stu-id="a836d-135">You must be running as an account with Administrator privileges</span></span>
2. [<span data-ttu-id="a836d-136">下載並開啟自動解壓縮的可執行檔</span><span class="sxs-lookup"><span data-stu-id="a836d-136">Download and open the self-extracting executable file</span></span>](ms03-32-issue/_static/fixup1.exe)
3. <span data-ttu-id="a836d-137">將內容解壓縮至 c：</span><span class="sxs-lookup"><span data-stu-id="a836d-137">Extract the contents to c:</span></span>\
4. <span data-ttu-id="a836d-138">選取 [執行 ...]從 [開始] 功能表，然後輸入 `cmd.exe`</span><span class="sxs-lookup"><span data-stu-id="a836d-138">Select Run... from the start menu, and enter `cmd.exe`</span></span>
5. <span data-ttu-id="a836d-139">在 [開啟命令] 視窗中，輸入 `c:\fixup.cmd`。</span><span class="sxs-lookup"><span data-stu-id="a836d-139">In the open command windows, type `c:\fixup.cmd`.</span></span>
6. <span data-ttu-id="a836d-140">出現提示時，輸入<strong>1pass\@word</strong>  做為密碼。</span><span class="sxs-lookup"><span data-stu-id="a836d-140">When prompted, enter <strong>1pass\@word</strong> as the password.</span></span>
7. <span data-ttu-id="a836d-141">如果您先前已有 ASPNET 帳戶的自訂存取控制設定或資料庫帳戶許可權，就必須立即重新套用這些設定。</span><span class="sxs-lookup"><span data-stu-id="a836d-141">If you have previously custom access control settings or database account permissions for the ASPNET account, you'll need to re-apply these settings now.</span></span>

<span data-ttu-id="a836d-142">許多讀者表達歉意會造成這種情況引起的不便。</span><span class="sxs-lookup"><span data-stu-id="a836d-142">Many apologies for the inconvenience that this has caused.</span></span> <span data-ttu-id="a836d-143">我們會在其他資訊可供使用時張貼。</span><span class="sxs-lookup"><span data-stu-id="a836d-143">We'll post additional information as it becomes available.</span></span>

<span data-ttu-id="a836d-144">下方的矩陣詳述受此問題影響的平臺和版本。</span><span class="sxs-lookup"><span data-stu-id="a836d-144">The matrix below details platforms and versions impacted by this issue.</span></span>

| <span data-ttu-id="a836d-145">.NET Framework</span><span class="sxs-lookup"><span data-stu-id="a836d-145">.NET Framework</span></span> | <span data-ttu-id="a836d-146">Platform</span><span class="sxs-lookup"><span data-stu-id="a836d-146">Platform</span></span> | <span data-ttu-id="a836d-147">會</span><span class="sxs-lookup"><span data-stu-id="a836d-147">Affected</span></span> |
| --- | --- | --- |
| <span data-ttu-id="a836d-148">版本1。0</span><span class="sxs-lookup"><span data-stu-id="a836d-148">Version 1.0</span></span> | <span data-ttu-id="a836d-149">Windows 2000 Professional</span><span class="sxs-lookup"><span data-stu-id="a836d-149">Windows 2000 Professional</span></span> | <span data-ttu-id="a836d-150">否</span><span class="sxs-lookup"><span data-stu-id="a836d-150">No</span></span> |
| <span data-ttu-id="a836d-151">版本1。0</span><span class="sxs-lookup"><span data-stu-id="a836d-151">Version 1.0</span></span> | <span data-ttu-id="a836d-152">Windows 2000 Server</span><span class="sxs-lookup"><span data-stu-id="a836d-152">Windows 2000 Server</span></span> | <span data-ttu-id="a836d-153">否</span><span class="sxs-lookup"><span data-stu-id="a836d-153">No</span></span> |
| <span data-ttu-id="a836d-154">版本1。0</span><span class="sxs-lookup"><span data-stu-id="a836d-154">Version 1.0</span></span> | <span data-ttu-id="a836d-155">Windows XP Professional</span><span class="sxs-lookup"><span data-stu-id="a836d-155">Windows XP Professional</span></span> | <span data-ttu-id="a836d-156">[是]</span><span class="sxs-lookup"><span data-stu-id="a836d-156">Yes</span></span> |
| <span data-ttu-id="a836d-157">版本1。0</span><span class="sxs-lookup"><span data-stu-id="a836d-157">Version 1.0</span></span> | <span data-ttu-id="a836d-158">Windows Server 2003</span><span class="sxs-lookup"><span data-stu-id="a836d-158">Windows Server 2003</span></span> | <span data-ttu-id="a836d-159">否</span><span class="sxs-lookup"><span data-stu-id="a836d-159">No</span></span> |
| <span data-ttu-id="a836d-160">版本1。0</span><span class="sxs-lookup"><span data-stu-id="a836d-160">Version 1.0</span></span> | <span data-ttu-id="a836d-161">Windows XP Home with Cassini</span><span class="sxs-lookup"><span data-stu-id="a836d-161">Windows XP Home with Cassini</span></span> | <span data-ttu-id="a836d-162">否</span><span class="sxs-lookup"><span data-stu-id="a836d-162">No</span></span> |
| <span data-ttu-id="a836d-163">1\.1 版</span><span class="sxs-lookup"><span data-stu-id="a836d-163">Version 1.1</span></span> | <span data-ttu-id="a836d-164">Windows 2000 Professional</span><span class="sxs-lookup"><span data-stu-id="a836d-164">Windows 2000 Professional</span></span> | <span data-ttu-id="a836d-165">否</span><span class="sxs-lookup"><span data-stu-id="a836d-165">No</span></span> |
| <span data-ttu-id="a836d-166">1\.1 版</span><span class="sxs-lookup"><span data-stu-id="a836d-166">Version 1.1</span></span> | <span data-ttu-id="a836d-167">Windows 2000 Server</span><span class="sxs-lookup"><span data-stu-id="a836d-167">Windows 2000 Server</span></span> | <span data-ttu-id="a836d-168">否</span><span class="sxs-lookup"><span data-stu-id="a836d-168">No</span></span> |
| <span data-ttu-id="a836d-169">1\.1 版</span><span class="sxs-lookup"><span data-stu-id="a836d-169">Version 1.1</span></span> | <span data-ttu-id="a836d-170">Windows XP Professional</span><span class="sxs-lookup"><span data-stu-id="a836d-170">Windows XP Professional</span></span> | <span data-ttu-id="a836d-171">否</span><span class="sxs-lookup"><span data-stu-id="a836d-171">No</span></span> |
| <span data-ttu-id="a836d-172">1\.1 版</span><span class="sxs-lookup"><span data-stu-id="a836d-172">Version 1.1</span></span> | <span data-ttu-id="a836d-173">Windows Server 2003</span><span class="sxs-lookup"><span data-stu-id="a836d-173">Windows Server 2003</span></span> | <span data-ttu-id="a836d-174">否</span><span class="sxs-lookup"><span data-stu-id="a836d-174">No</span></span> |
| <span data-ttu-id="a836d-175">1\.1 版</span><span class="sxs-lookup"><span data-stu-id="a836d-175">Version 1.1</span></span> | <span data-ttu-id="a836d-176">Windows XP Home with Cassini</span><span class="sxs-lookup"><span data-stu-id="a836d-176">Windows XP Home with Cassini</span></span> | <span data-ttu-id="a836d-177">否</span><span class="sxs-lookup"><span data-stu-id="a836d-177">No</span></span> |

<span data-ttu-id="a836d-178">謹此，</span><span class="sxs-lookup"><span data-stu-id="a836d-178">Thanks,</span></span>   
 <span data-ttu-id="a836d-179">ASP.NET 小組</span><span class="sxs-lookup"><span data-stu-id="a836d-179">The ASP.NET Team</span></span>
