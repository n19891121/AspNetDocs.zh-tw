---
uid: web-pages/overview/data/7-displaying-data-in-a-chart
title: 在圖表中顯示數據,其中ASP.NET網頁 (Razor) |微軟文件
author: rick-anderson
description: 本章介紹如何在圖表中顯示數據。 在前面的章節中,您學習了如何在網格中手動顯示數據。 本章解釋...
ms.author: riande
ms.date: 05/22/2012
ms.assetid: f889fd46-4dac-4ecb-83d8-60e64c22036e
msc.legacyurl: /web-pages/overview/data/7-displaying-data-in-a-chart
msc.type: authoredcontent
ms.openlocfilehash: ad55d4898ee39e0239ef8b0bd5eea6387af3c816
ms.sourcegitcommit: 022f79dbc1350e0c6ffaa1e7e7c6e850cdabf9af
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/17/2020
ms.locfileid: "81542881"
---
# <a name="displaying-data-in-a-chart-with-aspnet-web-pages-razor"></a><span data-ttu-id="83bc2-105">在圖表中顯示具有 ASP.NET 網頁(Razor)的資料</span><span class="sxs-lookup"><span data-stu-id="83bc2-105">Displaying Data in a Chart with ASP.NET Web Pages (Razor)</span></span>

<span data-ttu-id="83bc2-106">由[微軟](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="83bc2-106">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="83bc2-107">本文介紹如何使用圖表使用`Chart`説明程式在ASP.NET網頁 (Razor) 網站中顯示數據。</span><span class="sxs-lookup"><span data-stu-id="83bc2-107">This article explains how to use a chart to display data in an ASP.NET Web Pages (Razor) website by using the `Chart` helper.</span></span>
> 
> <span data-ttu-id="83bc2-108">**您將學習:**</span><span class="sxs-lookup"><span data-stu-id="83bc2-108">**What you'll learn**:</span></span>
> 
> - <span data-ttu-id="83bc2-109">如何在圖表中顯示數據。</span><span class="sxs-lookup"><span data-stu-id="83bc2-109">How to display data in a chart.</span></span>
> - <span data-ttu-id="83bc2-110">如何使用內置主題對圖表進行樣式設置。</span><span class="sxs-lookup"><span data-stu-id="83bc2-110">How to style charts using built-in themes.</span></span>
> - <span data-ttu-id="83bc2-111">如何保存圖表以及如何緩存圖表以獲得更好的性能。</span><span class="sxs-lookup"><span data-stu-id="83bc2-111">How to save charts and how to cache them for better performance.</span></span>
> 
> <span data-ttu-id="83bc2-112">以下是本文介紹的ASP.NET程式設計功能:</span><span class="sxs-lookup"><span data-stu-id="83bc2-112">These are the ASP.NET programming features introduced in the article:</span></span>
> 
> - <span data-ttu-id="83bc2-113">幫手`Chart`</span><span class="sxs-lookup"><span data-stu-id="83bc2-113">The `Chart` helper.</span></span>
> 
> > [!NOTE]
> > <span data-ttu-id="83bc2-114">本文中的資訊適用於ASP.NET網頁 1.0 和網頁 2。</span><span class="sxs-lookup"><span data-stu-id="83bc2-114">The information in this article applies to ASP.NET Web Pages 1.0 and Web Pages 2.</span></span>

<a id="The_Chart_Helper"></a>
## <a name="the-chart-helper"></a><span data-ttu-id="83bc2-115">圖表說明程式</span><span class="sxs-lookup"><span data-stu-id="83bc2-115">The Chart Helper</span></span>

<span data-ttu-id="83bc2-116">當您要以圖形形式顯示數據時,可以使用`Chart`幫助程式。</span><span class="sxs-lookup"><span data-stu-id="83bc2-116">When you want to display your data in graphical form, you can use `Chart` helper.</span></span> <span data-ttu-id="83bc2-117">`Chart`説明程式可以渲染顯示各種圖表類型中的數據的圖像。</span><span class="sxs-lookup"><span data-stu-id="83bc2-117">The `Chart` helper can render an image that displays data in a variety of chart types.</span></span> <span data-ttu-id="83bc2-118">它支援許多格式設定和標籤選項。</span><span class="sxs-lookup"><span data-stu-id="83bc2-118">It supports many options for formatting and labeling.</span></span> <span data-ttu-id="83bc2-119">`Chart`説明程式可以呈現 30 多種圖表類型,包括您可能從 Microsoft Excel 或其他工具&#8212;區域圖、條形圖、柱形圖、折線圖和餅圖等工具中熟悉的所有類型的圖表,以及更專業的圖表(如股票圖表)。</span><span class="sxs-lookup"><span data-stu-id="83bc2-119">The `Chart` helper can render more than 30 types of charts, including all the types of charts that you might be familiar with from Microsoft Excel or other tools &#8212; area charts, bar charts, column charts, line charts, and pie charts, along with more specialized charts like stock charts.</span></span>

| <span data-ttu-id="83bc2-120">**面積圖**![描述:面積圖類型的圖片](7-displaying-data-in-a-chart/_static/image1.jpg)</span><span class="sxs-lookup"><span data-stu-id="83bc2-120">**Area chart** ![Description: Picture of the Area chart type](7-displaying-data-in-a-chart/_static/image1.jpg)</span></span> | <span data-ttu-id="83bc2-121">**條形圖**![說明:條形圖類型的圖片](7-displaying-data-in-a-chart/_static/image2.jpg)</span><span class="sxs-lookup"><span data-stu-id="83bc2-121">**Bar chart** ![Description: Picture of the Bar chart type](7-displaying-data-in-a-chart/_static/image2.jpg)</span></span> |
| --- | --- |
| <span data-ttu-id="83bc2-122">**柱形圖**![說明:柱形圖類型的圖片](7-displaying-data-in-a-chart/_static/image3.jpg)</span><span class="sxs-lookup"><span data-stu-id="83bc2-122">**Column chart** ![Description: Picture of the Column chart type](7-displaying-data-in-a-chart/_static/image3.jpg)</span></span> | <span data-ttu-id="83bc2-123">**折線圖**![描述:折線圖類型的圖片](7-displaying-data-in-a-chart/_static/image4.jpg)</span><span class="sxs-lookup"><span data-stu-id="83bc2-123">**Line chart** ![Description: Picture of the Line chart type](7-displaying-data-in-a-chart/_static/image4.jpg)</span></span> |
| <span data-ttu-id="83bc2-124">**圓形圖**![說明:圓形圖類型的圖片](7-displaying-data-in-a-chart/_static/image5.jpg)</span><span class="sxs-lookup"><span data-stu-id="83bc2-124">**Pie chart** ![Description: Picture of the Pie chart type](7-displaying-data-in-a-chart/_static/image5.jpg)</span></span> | <span data-ttu-id="83bc2-125">**股票圖表**![描述:股票圖表類型的圖片](7-displaying-data-in-a-chart/_static/image6.jpg)</span><span class="sxs-lookup"><span data-stu-id="83bc2-125">**Stock chart** ![Description: Picture of the Stock chart type](7-displaying-data-in-a-chart/_static/image6.jpg)</span></span> |

### <a name="chart-elements"></a><span data-ttu-id="83bc2-126">圖表項目</span><span class="sxs-lookup"><span data-stu-id="83bc2-126">Chart Elements</span></span>

<span data-ttu-id="83bc2-127">圖表顯示數據和其他元素,如圖例、軸、系列等。</span><span class="sxs-lookup"><span data-stu-id="83bc2-127">Charts show data and additional elements like legends, axes, series, and so on.</span></span> <span data-ttu-id="83bc2-128">下圖顯示了使用`Chart`幫助器時可以自定義的許多圖表元素。</span><span class="sxs-lookup"><span data-stu-id="83bc2-128">The following picture shows many of the chart elements that you can customize when you use the `Chart` helper.</span></span> <span data-ttu-id="83bc2-129">本文介紹如何設置其中某些(不是全部)元素。</span><span class="sxs-lookup"><span data-stu-id="83bc2-129">This article shows you how to set some (not all) of these elements.</span></span>

![標題:顯示圖表元素的圖片](7-displaying-data-in-a-chart/_static/image7.jpg)

<a id="Creating_a_Chart"></a>
## <a name="creating-a-chart-from-data"></a><span data-ttu-id="83bc2-131">從資料建立圖表</span><span class="sxs-lookup"><span data-stu-id="83bc2-131">Creating a Chart from Data</span></span>

<span data-ttu-id="83bc2-132">在圖表中顯示的數據可以來自陣列、從資料庫返回的結果或 XML 檔中的數據。</span><span class="sxs-lookup"><span data-stu-id="83bc2-132">The data you display in a chart can be from an array, from the results returned from a database, or from data that's in an XML file.</span></span>

### <a name="using-an-array"></a><span data-ttu-id="83bc2-133">使用陣列</span><span class="sxs-lookup"><span data-stu-id="83bc2-133">Using an Array</span></span>

<span data-ttu-id="83bc2-134">如ASP.NET[網頁程式設計簡介中所述,使用Razor語法](https://go.microsoft.com/fwlink/?LinkId=202890)程式設計,陣列允許您在單個變數中存儲類似項的集合。</span><span class="sxs-lookup"><span data-stu-id="83bc2-134">As explained in [Introduction to ASP.NET Web Pages Programming Using the Razor Syntax](https://go.microsoft.com/fwlink/?LinkId=202890), an array lets you store a collection of similar items in a single variable.</span></span> <span data-ttu-id="83bc2-135">可以使用陣列來包含要包含在圖表中的數據。</span><span class="sxs-lookup"><span data-stu-id="83bc2-135">You can use arrays to contain the data that you want to include in your chart.</span></span>

<span data-ttu-id="83bc2-136">此過程展示如何使用預設圖表類型從陣列中的數據建立圖表。</span><span class="sxs-lookup"><span data-stu-id="83bc2-136">This procedure shows how you can create a chart from data in arrays, using the default chart type.</span></span> <span data-ttu-id="83bc2-137">它還演示如何在頁面中顯示圖表。</span><span class="sxs-lookup"><span data-stu-id="83bc2-137">It also shows how to display the chart within the page.</span></span>

1. <span data-ttu-id="83bc2-138">建立名為*ChartArrayBasic.cshtml*的新檔案。</span><span class="sxs-lookup"><span data-stu-id="83bc2-138">Create a new file named *ChartArrayBasic.cshtml*.</span></span>
2. <span data-ttu-id="83bc2-139">將現有內容取代為以下內容:</span><span class="sxs-lookup"><span data-stu-id="83bc2-139">Replace the existing content with the following:</span></span> 

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample1.cshtml)]

    <span data-ttu-id="83bc2-140">代碼首先創建一個新圖表並設置其寬度和高度。</span><span class="sxs-lookup"><span data-stu-id="83bc2-140">The code first creates a new chart and sets its width and height.</span></span> <span data-ttu-id="83bc2-141">使用`AddTitle`方法指定圖表標題。</span><span class="sxs-lookup"><span data-stu-id="83bc2-141">You specify the chart title by using the `AddTitle` method.</span></span> <span data-ttu-id="83bc2-142">要新增資料,請使用方法`AddSeries`。</span><span class="sxs-lookup"><span data-stu-id="83bc2-142">To add data, you use the `AddSeries` method.</span></span> <span data-ttu-id="83bc2-143">在此範例中`name`,使用`xValue``yValues``AddSeries`方法的和參數。</span><span class="sxs-lookup"><span data-stu-id="83bc2-143">In this example, you use the `name`, `xValue`, and `yValues` parameters of the `AddSeries` method.</span></span> <span data-ttu-id="83bc2-144">參數`name`顯示在圖表例中。</span><span class="sxs-lookup"><span data-stu-id="83bc2-144">The `name` parameter is displayed in the chart legend.</span></span> <span data-ttu-id="83bc2-145">該`xValue`參數包含沿圖表水平軸顯示的數據陣列。</span><span class="sxs-lookup"><span data-stu-id="83bc2-145">The `xValue` parameter contains an array of data that's displayed along the horizontal axis of the chart.</span></span> <span data-ttu-id="83bc2-146">該`yValues`參數包含用於繪製圖表垂直點的數據陣列。</span><span class="sxs-lookup"><span data-stu-id="83bc2-146">The `yValues` parameter contains an array of data that's used to plot the vertical points of the chart.</span></span>

    <span data-ttu-id="83bc2-147">該方法`Write`實際上呈現圖表。</span><span class="sxs-lookup"><span data-stu-id="83bc2-147">The `Write` method actually renders the chart.</span></span> <span data-ttu-id="83bc2-148">在這種情況下,由於您沒有指定圖表類型,`Chart`説明程式將呈現其預設圖表,即柱形圖。</span><span class="sxs-lookup"><span data-stu-id="83bc2-148">In this case, because you didn't specify a chart type, the `Chart` helper renders its default chart, which is a column chart.</span></span>
3. <span data-ttu-id="83bc2-149">在瀏覽器中運行頁面。</span><span class="sxs-lookup"><span data-stu-id="83bc2-149">Run the page in the browser.</span></span> <span data-ttu-id="83bc2-150">瀏覽器顯示圖表。</span><span class="sxs-lookup"><span data-stu-id="83bc2-150">The browser displays the chart.</span></span> 

    ![](7-displaying-data-in-a-chart/_static/image8.jpg)

### <a name="using-a-database-query-for-chart-data"></a><span data-ttu-id="83bc2-151">對圖表資料使用資料庫查詢</span><span class="sxs-lookup"><span data-stu-id="83bc2-151">Using a Database Query for Chart Data</span></span>

<span data-ttu-id="83bc2-152">如果要繪製圖表的資訊位於資料庫中,則可以運行資料庫查詢,然後使用結果中的資料創建圖表。</span><span class="sxs-lookup"><span data-stu-id="83bc2-152">If the information you want to chart is in a database, you can run a database query and then use data from the results to create the chart.</span></span> <span data-ttu-id="83bc2-153">此過程展示如何讀取和顯示在[文章"使用ASP.NET網頁網站中的資料庫簡介](https://go.microsoft.com/fwlink/?LinkId=202893)"中創建的資料庫中的數據。</span><span class="sxs-lookup"><span data-stu-id="83bc2-153">This procedure shows you how to read and display the data from the database created in the article [Introduction to Working with a Database in ASP.NET Web Pages Sites](https://go.microsoft.com/fwlink/?LinkId=202893).</span></span>

1. <span data-ttu-id="83bc2-154">如果該資料夾不存在,則向網站的根目錄添加*應用\_數據*資料夾。</span><span class="sxs-lookup"><span data-stu-id="83bc2-154">Add an *App\_Data* folder to the root of the website if the folder does not already exist.</span></span>
2. <span data-ttu-id="83bc2-155">在 *「\_應用資料*」資料夾中,添加名為*SmallBakery.sdf*的資料庫檔案,該檔在[「使用ASP.NET網頁網站中的資料庫簡介」中](https://go.microsoft.com/fwlink/?LinkId=202893)所述。</span><span class="sxs-lookup"><span data-stu-id="83bc2-155">In the *App\_Data* folder, add the database file named *SmallBakery.sdf* that's described in [Introduction to Working with a Database in ASP.NET Web Pages Sites](https://go.microsoft.com/fwlink/?LinkId=202893).</span></span>
3. <span data-ttu-id="83bc2-156">建立名為*ChartDataQuery.cshtml*的新檔案。</span><span class="sxs-lookup"><span data-stu-id="83bc2-156">Create a new file named *ChartDataQuery.cshtml*.</span></span>
4. <span data-ttu-id="83bc2-157">將現有內容取代為以下內容:</span><span class="sxs-lookup"><span data-stu-id="83bc2-157">Replace the existing content with the following:</span></span>   

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample2.cshtml)]

    <span data-ttu-id="83bc2-158">代碼首先打開 SmallBakery 資料庫並將其分配給`db`名為的 變數。</span><span class="sxs-lookup"><span data-stu-id="83bc2-158">The code first opens the SmallBakery database and assigns it to a variable named `db`.</span></span> <span data-ttu-id="83bc2-159">此變數表示可用於`Database`讀取資料庫和寫入資料庫的物件。</span><span class="sxs-lookup"><span data-stu-id="83bc2-159">This variable represents a `Database` object that can be used to read from and write to the database.</span></span> <span data-ttu-id="83bc2-160">接下來,代碼運行 SQL 查詢以獲取每個產品的名稱和價格。</span><span class="sxs-lookup"><span data-stu-id="83bc2-160">Next, the code runs a SQL query to get the name and price of each product.</span></span> <span data-ttu-id="83bc2-161">代碼創建一個新圖表,並通過調用圖表`DataBindTable`的方法將資料庫查詢傳遞給它。</span><span class="sxs-lookup"><span data-stu-id="83bc2-161">The code creates a new chart and passes the database query to it by calling the chart's `DataBindTable` method.</span></span> <span data-ttu-id="83bc2-162">此方法採用兩個參數:`dataSource`參數用於查詢中的數據`xField`, 該參數允許您設定用於圖表 x 軸的資料列。</span><span class="sxs-lookup"><span data-stu-id="83bc2-162">This method takes two parameters: the `dataSource` parameter is for the data from the query, and the `xField` parameter lets you set which data column is used for the chart's x-axis.</span></span>

    <span data-ttu-id="83bc2-163">作為使用 方法的替代`DataBindTable`方法 ,`AddSeries``Chart`可以使用 幫助器的方法。</span><span class="sxs-lookup"><span data-stu-id="83bc2-163">As an alternative to using the `DataBindTable` method, you can use the `AddSeries` method of the `Chart` helper.</span></span> <span data-ttu-id="83bc2-164">該方法`AddSeries`允許您設置`xValue``yValues`和 參數。</span><span class="sxs-lookup"><span data-stu-id="83bc2-164">The `AddSeries` method lets you set the `xValue` and `yValues` parameters.</span></span> <span data-ttu-id="83bc2-165">例如,而不是使用如下所示`DataBindTable`的方法:</span><span class="sxs-lookup"><span data-stu-id="83bc2-165">For example, instead of using the `DataBindTable` method like this:</span></span>

    [!code-css[Main](7-displaying-data-in-a-chart/samples/sample3.css)]

    <span data-ttu-id="83bc2-166">可以使用以下的方法`AddSeries`:</span><span class="sxs-lookup"><span data-stu-id="83bc2-166">You can use the `AddSeries` method like this:</span></span>

    [!code-html[Main](7-displaying-data-in-a-chart/samples/sample4.html)]

    <span data-ttu-id="83bc2-167">兩者都呈現相同的結果。</span><span class="sxs-lookup"><span data-stu-id="83bc2-167">Both render the same results.</span></span> <span data-ttu-id="83bc2-168">該方法`AddSeries`更靈活,因為您可以更明確地指定圖表類型和數據,但如果不需要額外的靈活性`DataBindTable`, 則該方法更易於使用。</span><span class="sxs-lookup"><span data-stu-id="83bc2-168">The `AddSeries` method is more flexible because you can specify the chart type and data more explicitly, but the `DataBindTable` method is easier to use if you don't need the extra flexibility.</span></span>
5. <span data-ttu-id="83bc2-169">在瀏覽器中運行頁面。</span><span class="sxs-lookup"><span data-stu-id="83bc2-169">Run the page in a browser.</span></span> 

    ![](7-displaying-data-in-a-chart/_static/image9.jpg)

### <a name="using-xml-data"></a><span data-ttu-id="83bc2-170">使用 XML 資料</span><span class="sxs-lookup"><span data-stu-id="83bc2-170">Using XML Data</span></span>

<span data-ttu-id="83bc2-171">圖表的第三個選項是使用 XML 檔案作為圖表的數據。</span><span class="sxs-lookup"><span data-stu-id="83bc2-171">The third option for charting is to use an XML file as the data for the chart.</span></span> <span data-ttu-id="83bc2-172">這要求 XML 檔也具有描述 XML 結構的架構檔 *(.xsd*檔)。</span><span class="sxs-lookup"><span data-stu-id="83bc2-172">This requires that the XML file also have a schema file (*.xsd* file) that describes the XML structure.</span></span> <span data-ttu-id="83bc2-173">此過程展示如何從 XML 檔讀取數據。</span><span class="sxs-lookup"><span data-stu-id="83bc2-173">This procedure shows you how to read data from an XML file.</span></span>

1. <span data-ttu-id="83bc2-174">在*應用\_資料*資料夾中,創建名為*data.xml*的新 XML 檔。</span><span class="sxs-lookup"><span data-stu-id="83bc2-174">In the *App\_Data* folder, create a new XML file named *data.xml*.</span></span>
2. <span data-ttu-id="83bc2-175">將現有 XML 替換為以下內容,即有關虛構公司員工的一些 XML 數據。</span><span class="sxs-lookup"><span data-stu-id="83bc2-175">Replace the existing XML with the following, which is some XML data about employees in a fictional company.</span></span> 

    [!code-xml[Main](7-displaying-data-in-a-chart/samples/sample5.xml)]
3. <span data-ttu-id="83bc2-176">在*應用\_資料*資料夾中,創建名為*data.xsd*的新 XML 檔。</span><span class="sxs-lookup"><span data-stu-id="83bc2-176">In the *App\_Data* folder, create a new XML file named *data.xsd*.</span></span> <span data-ttu-id="83bc2-177">(請注意,這次的擴展是 *.xsd*.)</span><span class="sxs-lookup"><span data-stu-id="83bc2-177">(Note that the extension this time is *.xsd*.)</span></span>
4. <span data-ttu-id="83bc2-178">將現有 XML 取代為以下內容:</span><span class="sxs-lookup"><span data-stu-id="83bc2-178">Replace the existing XML with the following:</span></span> 

    [!code-xml[Main](7-displaying-data-in-a-chart/samples/sample6.xml)]
5. <span data-ttu-id="83bc2-179">在網站的根目錄中,創建一個名為*ChartDataXML.cshtml*的新檔。</span><span class="sxs-lookup"><span data-stu-id="83bc2-179">In the root of the website, create a new file named *ChartDataXML.cshtml*.</span></span>
6. <span data-ttu-id="83bc2-180">將現有內容取代為以下內容:</span><span class="sxs-lookup"><span data-stu-id="83bc2-180">Replace the existing content with the following:</span></span> 

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample7.cshtml)]

    <span data-ttu-id="83bc2-181">代碼首先創建一個`DataSet`物件。</span><span class="sxs-lookup"><span data-stu-id="83bc2-181">The code first creates a `DataSet` object.</span></span> <span data-ttu-id="83bc2-182">此物件用於管理從 XML 檔讀取的數據,並根據架構檔中的資訊對其進行組織。</span><span class="sxs-lookup"><span data-stu-id="83bc2-182">This object is used to manage the data that's read from the XML file and organize it according to the information in the schema file.</span></span> <span data-ttu-id="83bc2-183">(請注意,代碼的頂部包括敘述`using SystemData`。</span><span class="sxs-lookup"><span data-stu-id="83bc2-183">(Notice that the top of the code includes the statement `using SystemData`.</span></span> <span data-ttu-id="83bc2-184">這是為了能夠處理`DataSet`物件所必需的。</span><span class="sxs-lookup"><span data-stu-id="83bc2-184">This is required in order to be able to work with the `DataSet` object.</span></span> <span data-ttu-id="83bc2-185">有關詳細資訊,請參閱[&quot;本文後面的&quot;使用 語句和完全限定名稱](#SB_UsingStatements)。</span><span class="sxs-lookup"><span data-stu-id="83bc2-185">For more information, see [&quot;Using&quot; Statements and Fully Qualified Names](#SB_UsingStatements) later in this article.)</span></span>

    <span data-ttu-id="83bc2-186">接下來,代碼基於數據集創建`DataView`一個物件。</span><span class="sxs-lookup"><span data-stu-id="83bc2-186">Next, the code creates a `DataView` object based on the dataset.</span></span> <span data-ttu-id="83bc2-187">數據視圖提供圖表可以綁定到&#8212;的物件,即讀取和繪圖。</span><span class="sxs-lookup"><span data-stu-id="83bc2-187">The data view provides an object that the chart can bind to &#8212; that is, read and plot.</span></span> <span data-ttu-id="83bc2-188">`AddSeries`圖表使用 方法綁定到數據,如您前面在繪製陣列數據圖表時所看到的那樣,但`xValue`此`yValues`時間和`DataView`參數設置為 物件除外。</span><span class="sxs-lookup"><span data-stu-id="83bc2-188">The chart binds to the data using the `AddSeries` method, as you saw earlier when charting the array data, except that this time the `xValue` and `yValues` parameters are set to the `DataView` object.</span></span>

    <span data-ttu-id="83bc2-189">此示例還演示如何指定特定的圖表類型。</span><span class="sxs-lookup"><span data-stu-id="83bc2-189">This example also shows you how to specify a particular chart type.</span></span> <span data-ttu-id="83bc2-190">在`AddSeries`方法中添加數據時`chartType`, 參數也會設置為顯示圓體圖。</span><span class="sxs-lookup"><span data-stu-id="83bc2-190">When the data is added in the `AddSeries` method, the `chartType` parameter is also set to display a pie chart.</span></span>
7. <span data-ttu-id="83bc2-191">在瀏覽器中運行頁面。</span><span class="sxs-lookup"><span data-stu-id="83bc2-191">Run the page in a browser.</span></span> 

    ![](7-displaying-data-in-a-chart/_static/image10.jpg)

> [!TIP]
> 
> <a id="SB_UsingStatements"></a>
> ### <a name="using-statements-and-fully-qualified-names"></a><span data-ttu-id="83bc2-192">「使用」語句和完全限定的名稱</span><span class="sxs-lookup"><span data-stu-id="83bc2-192">"Using" Statements and Fully Qualified Names</span></span>
> 
> <span data-ttu-id="83bc2-193">使用 Razor 語法 ASP.NET 網頁的 .NET 框架由數千個元件(類)組成。</span><span class="sxs-lookup"><span data-stu-id="83bc2-193">The .NET Framework that ASP.NET Web Pages with Razor syntax is based on consists of many thousands of components (classes).</span></span> <span data-ttu-id="83bc2-194">為了使使用所有這些類可以管理,它們被組織成*命名空間*,有點像庫。</span><span class="sxs-lookup"><span data-stu-id="83bc2-194">To make it manageable to work with all these classes, they're organized into *namespaces*, which are somewhat like libraries.</span></span> <span data-ttu-id="83bc2-195">例如,`System.Web`命名空間包含支援瀏覽器/ 伺服器通訊的`System.Xml`類別, 命名空間包含用於建立和讀取 XML`System.Data`檔的類別, 並且命名空間包含允許您處理資料的類別。</span><span class="sxs-lookup"><span data-stu-id="83bc2-195">For example, the `System.Web` namespace contains classes that support browser/server communication, the `System.Xml` namespace contains classes that are used to create and read XML files, and the `System.Data` namespace contains classes that let you work with data.</span></span>
> 
> <span data-ttu-id="83bc2-196">為了訪問 .NET Framework 中的任何給定類,代碼不僅需要瞭解類名稱,還需要瞭解類中的命名空間。</span><span class="sxs-lookup"><span data-stu-id="83bc2-196">In order to access any given class in the .NET Framework, code needs to know not just the class name, but also the namespace that the class is in.</span></span> <span data-ttu-id="83bc2-197">例如,為了使用`Chart`幫助程式,代碼需要查找`System.Web.Helpers.Chart`類,該類將命名空間`System.Web.Helpers`() 與類名稱`Chart`( ( ) 合併在一起。</span><span class="sxs-lookup"><span data-stu-id="83bc2-197">For example, in order to use the `Chart` helper, code needs to find the `System.Web.Helpers.Chart` class, which combines the namespace (`System.Web.Helpers`) with the class name (`Chart`).</span></span> <span data-ttu-id="83bc2-198">這稱為類的*完全限定*名稱&#8212;其在 .NET 框架的龐大範圍內的完整、明確位置。</span><span class="sxs-lookup"><span data-stu-id="83bc2-198">This is known as the class's *fully-qualified* name &#8212; its complete, unambiguous location within the vastness of the .NET Framework.</span></span> <span data-ttu-id="83bc2-199">在代碼中,如下所示:</span><span class="sxs-lookup"><span data-stu-id="83bc2-199">In code, this would look like the following:</span></span>
> 
> `var myChart = new System.Web.Helpers.Chart(width: 600, height: 400) // etc.`
> 
> <span data-ttu-id="83bc2-200">但是,每次要引用類或説明程式時,必須使用這些長而完全限定的名稱是繁瑣的(且容易出錯)。</span><span class="sxs-lookup"><span data-stu-id="83bc2-200">However, it's cumbersome (and error prone) to have to use these long, fully-qualified names every time you want to refer to a class or helper.</span></span> <span data-ttu-id="83bc2-201">因此,為了更輕鬆地使用類名,可以*導入*您感興趣的命名空間,這通常只是 .NET 框架中許多命名空間中的少數。</span><span class="sxs-lookup"><span data-stu-id="83bc2-201">Therefore, to make it easier to use class names, you can *import* the namespaces you're interested in, which is usually is just a handful from among the many namespaces in the .NET Framework.</span></span> <span data-ttu-id="83bc2-202">如果已匯入命名空間,則只能使用類別名稱`Chart`( ) 而不是完全限定`System.Web.Helpers.Chart`的名稱 ( 。</span><span class="sxs-lookup"><span data-stu-id="83bc2-202">If you've imported a namespace, you can use just a class name (`Chart`) instead of the fully qualified name (`System.Web.Helpers.Chart`).</span></span> <span data-ttu-id="83bc2-203">當代碼運行並遇到類名稱時,它可以只查看已導入的命名空間來查找該類。</span><span class="sxs-lookup"><span data-stu-id="83bc2-203">When your code runs and encounters a class name, it can look in just the namespaces you've imported to find that class.</span></span>
> 
> <span data-ttu-id="83bc2-204">當您使用帶有 Razor 語法的ASP.NET網頁創建網頁時,您通常每次都使用相同的類集`WebPage`,包括類、各種幫助器等。</span><span class="sxs-lookup"><span data-stu-id="83bc2-204">When you use ASP.NET Web Pages with Razor syntax to create web pages, you typically use the same set of classes each time, including the `WebPage` class, the various helpers, and so on.</span></span> <span data-ttu-id="83bc2-205">為了節省您每次創建網站時導入相關命名空間的工作,ASP.NET進行了配置,以便自動為每個網站導入一組核心命名空間。</span><span class="sxs-lookup"><span data-stu-id="83bc2-205">To save you the work of importing the relevant namespaces every time you create a website, ASP.NET is configured so it automatically imports a set of core namespaces for every website.</span></span> <span data-ttu-id="83bc2-206">這就是為什麼到目前為止您不必處理命名空間或導入名稱空間的原因;您使用的所有類都位於已導入的命名空間中。</span><span class="sxs-lookup"><span data-stu-id="83bc2-206">That's why you haven't had to deal with namespaces or importing up to now; all the classes you've worked with are in namespaces that are already imported for you.</span></span>
> 
> <span data-ttu-id="83bc2-207">但是,有時您需要使用不在自動導入的命名空間中的類。</span><span class="sxs-lookup"><span data-stu-id="83bc2-207">However, sometimes you need to work with a class that isn't in a namespace that's automatically imported for you.</span></span> <span data-ttu-id="83bc2-208">在這種情況下,可以使用該類的完全限定名稱,也可以手動導入包含該類的命名空間。</span><span class="sxs-lookup"><span data-stu-id="83bc2-208">In that case, you can either use that class's fully-qualified name, or you can manually import the namespace that contains the class.</span></span> <span data-ttu-id="83bc2-209">要匯入命名空間,請使用`using`語句(`import`在 Visual Basic 中),如您前面的範例一樣。</span><span class="sxs-lookup"><span data-stu-id="83bc2-209">To import a namespace, you use the `using` statement (`import` in Visual Basic), as you saw in an example earlier the article.</span></span>
> 
> <span data-ttu-id="83bc2-210">例如,`DataSet`類別位於命名空間`System.Data`中 。</span><span class="sxs-lookup"><span data-stu-id="83bc2-210">For example, the `DataSet` class is in the `System.Data` namespace.</span></span> <span data-ttu-id="83bc2-211">命名`System.Data`空間不能自動可用於ASP.NET Razor 頁面。</span><span class="sxs-lookup"><span data-stu-id="83bc2-211">The `System.Data` namespace is not automatically available to ASP.NET Razor pages.</span></span> <span data-ttu-id="83bc2-212">因此,要使用完全限定`DataSet`名稱使用類,可以使用如下所示的代碼:</span><span class="sxs-lookup"><span data-stu-id="83bc2-212">Therefore, to work with the `DataSet` class using its fully qualified name, you can use code like this:</span></span>
> 
> `var dataSet = new System.Data.DataSet();`
> 
> <span data-ttu-id="83bc2-213">如果必須重複使用類,`DataSet`則可以匯入以下的命名空間,然後在代碼中僅使用類別名稱:</span><span class="sxs-lookup"><span data-stu-id="83bc2-213">If you have to use the `DataSet` class repeatedly you can import a namespace like this and then use just the class name in code:</span></span>
> 
> [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample8.cshtml)]
> 
> <span data-ttu-id="83bc2-214">可以為要引用`using`的任何其他 .NET框架命名空間添加語句。</span><span class="sxs-lookup"><span data-stu-id="83bc2-214">You can add `using` statements for any other .NET Framework namespaces that you want to reference.</span></span> <span data-ttu-id="83bc2-215">但是,如上所述,您不需要經常執行此操作,因為要使用的大多數類都位於命名空間中,名稱空間由ASP.NET自動導入,用於 *.cshtml*和 *.vbhtml*頁面。</span><span class="sxs-lookup"><span data-stu-id="83bc2-215">However, as noted, you won't need to do this often, because most of the classes that you'll work with are in namespaces that are imported automatically by ASP.NET for use in *.cshtml* and *.vbhtml* pages.</span></span>

<a id="Displaying_Charts"></a>
## <a name="displaying-charts-inside-a-web-page"></a><span data-ttu-id="83bc2-216">在網頁內顯示圖表</span><span class="sxs-lookup"><span data-stu-id="83bc2-216">Displaying Charts Inside a Web Page</span></span>

<span data-ttu-id="83bc2-217">在到目前為止看到的範例中,您將創建一個圖表,然後將圖表作為圖形直接呈現給瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="83bc2-217">In the examples you've seen so far, you create a chart and then the chart is rendered directly to the browser as a graphic.</span></span> <span data-ttu-id="83bc2-218">但是,在許多情況下,您希望將圖表顯示為頁面的一部分,而不僅僅是在瀏覽器中。</span><span class="sxs-lookup"><span data-stu-id="83bc2-218">In many cases, though, you want to display a chart as part of a page, not just by itself in the browser.</span></span> <span data-ttu-id="83bc2-219">為此,需要兩步過程。</span><span class="sxs-lookup"><span data-stu-id="83bc2-219">To do that requires a two-step process.</span></span> <span data-ttu-id="83bc2-220">第一步是創建生成圖表的頁面,正如您已經看到的那樣。</span><span class="sxs-lookup"><span data-stu-id="83bc2-220">The first step is to create a page that generates the chart, as you've already seen.</span></span>

<span data-ttu-id="83bc2-221">第二步是在另一頁中顯示生成的圖像。</span><span class="sxs-lookup"><span data-stu-id="83bc2-221">The second step is to display the resulting image in another page.</span></span> <span data-ttu-id="83bc2-222">要顯示影像,請使用`<img>`HTML 元素,就像顯示任何影像一樣。</span><span class="sxs-lookup"><span data-stu-id="83bc2-222">To display the image, you use an HTML `<img>` element, in the same way you would to display any image.</span></span> <span data-ttu-id="83bc2-223">但是`<img>`,該元素引用的不是 *.jpg*或 *.png*檔,而是`Chart`引用包含創建圖表 的説明器的 *.cshtml*檔。</span><span class="sxs-lookup"><span data-stu-id="83bc2-223">However, instead of referencing a *.jpg* or *.png* file, the `<img>` element references the *.cshtml* file that contains the `Chart` helper that creates the chart.</span></span> <span data-ttu-id="83bc2-224">當顯示頁執行時,`<img>`元素取得幫助器`Chart`的 輸出並呈現圖表。</span><span class="sxs-lookup"><span data-stu-id="83bc2-224">When the display page runs, the `<img>` element gets the output of the `Chart` helper and renders the chart.</span></span>

![](7-displaying-data-in-a-chart/_static/image11.jpg)

1. <span data-ttu-id="83bc2-225">建立名為*ShowChart.cshtml*的檔案。</span><span class="sxs-lookup"><span data-stu-id="83bc2-225">Create a file named *ShowChart.cshtml*.</span></span>
2. <span data-ttu-id="83bc2-226">將現有內容取代為以下內容:</span><span class="sxs-lookup"><span data-stu-id="83bc2-226">Replace the existing content with the following:</span></span> 

    [!code-html[Main](7-displaying-data-in-a-chart/samples/sample9.html)]

    <span data-ttu-id="83bc2-227">代碼使用`<img>`元素 來顯示您在*ChartArrayBasic.cshtml*檔案中建立的圖表。</span><span class="sxs-lookup"><span data-stu-id="83bc2-227">The code uses the `<img>` element to display the chart that you created earlier in the *ChartArrayBasic.cshtml* file.</span></span>
3. <span data-ttu-id="83bc2-228">在瀏覽器中運行網頁。</span><span class="sxs-lookup"><span data-stu-id="83bc2-228">Run the web page in a browser.</span></span> <span data-ttu-id="83bc2-229">*ShowChart.cshtml*檔案基於*ChartArrayBasic.cshtml*檔案中的代碼顯示圖表圖像。</span><span class="sxs-lookup"><span data-stu-id="83bc2-229">The *ShowChart.cshtml* file displays the chart image based on the code contained in the *ChartArrayBasic.cshtml* file.</span></span>

<a id="Styling_a_Chart"></a>
## <a name="styling-a-chart"></a><span data-ttu-id="83bc2-230">設定圖表樣式</span><span class="sxs-lookup"><span data-stu-id="83bc2-230">Styling a Chart</span></span>

<span data-ttu-id="83bc2-231">`Chart`幫助程式支援大量選項,這些選項允許您自定義圖表的外觀。</span><span class="sxs-lookup"><span data-stu-id="83bc2-231">The `Chart` helper supports a large number of options that let you customize the appearance of the chart.</span></span> <span data-ttu-id="83bc2-232">您可以設置顏色、字體、邊框等。</span><span class="sxs-lookup"><span data-stu-id="83bc2-232">You can set colors, fonts, borders, and so on.</span></span> <span data-ttu-id="83bc2-233">自訂圖表外觀的一種簡單方法是使用*主題*。</span><span class="sxs-lookup"><span data-stu-id="83bc2-233">An easy way to customize the appearance of a chart is to use a *theme*.</span></span> <span data-ttu-id="83bc2-234">佈景主題是指定如何使用字型、色彩、標籤、調色盤、框線和效果來呈現圖表的資訊集合。</span><span class="sxs-lookup"><span data-stu-id="83bc2-234">Themes are collections of information that specify how to render a chart using fonts, colors, labels, palettes, borders, and effects.</span></span> <span data-ttu-id="83bc2-235">(請注意,圖表的樣式並不指示圖表的類型。</span><span class="sxs-lookup"><span data-stu-id="83bc2-235">(Note that the style of a chart does not indicate the type of chart.)</span></span>

<span data-ttu-id="83bc2-236">下表列出了內置主題。</span><span class="sxs-lookup"><span data-stu-id="83bc2-236">The following table lists built-in themes.</span></span>

| <span data-ttu-id="83bc2-237">佈景主題</span><span class="sxs-lookup"><span data-stu-id="83bc2-237">Theme</span></span> | <span data-ttu-id="83bc2-238">描述</span><span class="sxs-lookup"><span data-stu-id="83bc2-238">Description</span></span> |
| --- | --- |
| `Vanilla` | <span data-ttu-id="83bc2-239">在白色背景上顯示紅色列。</span><span class="sxs-lookup"><span data-stu-id="83bc2-239">Displays red columns on a white background.</span></span> |
| `Blue` | <span data-ttu-id="83bc2-240">在藍色漸變背景上顯示藍色列。</span><span class="sxs-lookup"><span data-stu-id="83bc2-240">Displays blue columns on a blue gradient background.</span></span> |
| `Green` | <span data-ttu-id="83bc2-241">在綠色漸變背景上顯示藍色列。</span><span class="sxs-lookup"><span data-stu-id="83bc2-241">Displays blue columns on a green gradient background.</span></span> |
| `Yellow` | <span data-ttu-id="83bc2-242">在黃色漸變背景上顯示橙色列。</span><span class="sxs-lookup"><span data-stu-id="83bc2-242">Displays orange columns on a yellow gradient background.</span></span> |
| `Vanilla3D` | <span data-ttu-id="83bc2-243">在白色背景上顯示三維紅色列。</span><span class="sxs-lookup"><span data-stu-id="83bc2-243">Displays 3-D red columns on a white background.</span></span> |

<span data-ttu-id="83bc2-244">您可以指定建立新圖表時要使用的主題。</span><span class="sxs-lookup"><span data-stu-id="83bc2-244">You can specify the theme to use when you create a new chart.</span></span>

1. <span data-ttu-id="83bc2-245">建立名為*ChartStyleGreen.cshtml*的新檔。</span><span class="sxs-lookup"><span data-stu-id="83bc2-245">Create a new file named *ChartStyleGreen.cshtml*.</span></span>
2. <span data-ttu-id="83bc2-246">將頁面中的現有內容取代為以下內容:</span><span class="sxs-lookup"><span data-stu-id="83bc2-246">Replace the existing content in the page with the following:</span></span>

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample10.cshtml)]

    <span data-ttu-id="83bc2-247">此代碼與使用資料庫進行資料的早期示例相同,但在創建`theme``Chart`物件時添加參數。</span><span class="sxs-lookup"><span data-stu-id="83bc2-247">This code is the same as the earlier example that uses the database for data, but adds the `theme` parameter when it creates the `Chart` object.</span></span> <span data-ttu-id="83bc2-248">下面顯示了變更的代碼:</span><span class="sxs-lookup"><span data-stu-id="83bc2-248">The following shows the changed code:</span></span>

    [!code-csharp[Main](7-displaying-data-in-a-chart/samples/sample11.cs)]
3. <span data-ttu-id="83bc2-249">在瀏覽器中運行頁面。</span><span class="sxs-lookup"><span data-stu-id="83bc2-249">Run the page in a browser.</span></span> <span data-ttu-id="83bc2-250">您看到的資料與以前相同,但圖表看起來更精美:</span><span class="sxs-lookup"><span data-stu-id="83bc2-250">You see the same data as before, but the chart looks more polished:</span></span> 

    ![](7-displaying-data-in-a-chart/_static/image12.jpg)

<a id="Saving_a_Chart"></a>
## <a name="saving-a-chart"></a><span data-ttu-id="83bc2-251">儲存圖表</span><span class="sxs-lookup"><span data-stu-id="83bc2-251">Saving a Chart</span></span>

<span data-ttu-id="83bc2-252">當您在本文中看到的幫助`Chart`器時,説明程式每次調用圖表時都會從頭開始重新創建圖表。</span><span class="sxs-lookup"><span data-stu-id="83bc2-252">When you use the `Chart` helper as you've seen so far in this article, the helper re-creates the chart from scratch each time it's invoked.</span></span> <span data-ttu-id="83bc2-253">如有必要,圖表的代碼還會重新查詢資料庫或重新讀取 XML 檔以獲取數據。</span><span class="sxs-lookup"><span data-stu-id="83bc2-253">If necessary, the code for the chart also re-queries the database or re-reads the XML file to get the data.</span></span> <span data-ttu-id="83bc2-254">在某些情況下,執行此操作可能是一個複雜的操作,例如,如果您要查詢的資料庫很大,或者 XML 檔包含大量數據。</span><span class="sxs-lookup"><span data-stu-id="83bc2-254">In some cases, doing this can be a complex operation, such as if the database that you're querying is large, or if the XML file contains a lot of data.</span></span> <span data-ttu-id="83bc2-255">即使圖表不涉及大量數據,動態創建圖像的過程也會佔用伺服器資源,如果許多人請求顯示圖表的頁面或頁面,也會對網站的性能產生影響。</span><span class="sxs-lookup"><span data-stu-id="83bc2-255">Even if the chart doesn't involve a lot of data, the process of dynamically creating an image takes up server resources, and if many people request the page or pages that display the chart, there can be an impact on the performance of your website.</span></span>

<span data-ttu-id="83bc2-256">為了幫助減少創建圖表的潛在性能影響,可以在第一次創建圖表時創建圖表,然後保存它。</span><span class="sxs-lookup"><span data-stu-id="83bc2-256">To help you reduce the potential performance impact of creating a chart, you can create a chart the first time you need it and then save it.</span></span> <span data-ttu-id="83bc2-257">當再次需要圖表時,而不是重新生成它時,只需獲取保存的版本並呈現它。</span><span class="sxs-lookup"><span data-stu-id="83bc2-257">When the chart is needed again, rather than regenerating it, you can just fetch the saved version and render that.</span></span>

<span data-ttu-id="83bc2-258">您可以透過以下方式儲存圖表:</span><span class="sxs-lookup"><span data-stu-id="83bc2-258">You can save a chart in these ways:</span></span>

- <span data-ttu-id="83bc2-259">將圖表緩存在計算機記憶體中(在伺服器上)。</span><span class="sxs-lookup"><span data-stu-id="83bc2-259">Cache the chart in computer memory (on the server).</span></span>
- <span data-ttu-id="83bc2-260">將圖表另存為圖像檔。</span><span class="sxs-lookup"><span data-stu-id="83bc2-260">Save the chart as an image file.</span></span>
- <span data-ttu-id="83bc2-261">將圖表另存為 XML 檔。</span><span class="sxs-lookup"><span data-stu-id="83bc2-261">Save the chart as an XML file.</span></span> <span data-ttu-id="83bc2-262">此選項允許您在保存圖表之前對其進行修改。</span><span class="sxs-lookup"><span data-stu-id="83bc2-262">This option lets you modify the chart before you save it.</span></span>

### <a name="caching-a-chart"></a><span data-ttu-id="83bc2-263">快取圖表</span><span class="sxs-lookup"><span data-stu-id="83bc2-263">Caching a Chart</span></span>

<span data-ttu-id="83bc2-264">創建圖表後,可以緩存它。</span><span class="sxs-lookup"><span data-stu-id="83bc2-264">After you've created a chart, you can cache it.</span></span> <span data-ttu-id="83bc2-265">緩存圖表意味著,如果需要再次顯示圖表,則不必重新創建圖表。</span><span class="sxs-lookup"><span data-stu-id="83bc2-265">Caching a chart means that it doesn't have to be re-created if it needs to be displayed again.</span></span> <span data-ttu-id="83bc2-266">在緩存中保存圖表時,會為它提供一個必須是唯一的圖表的鍵。</span><span class="sxs-lookup"><span data-stu-id="83bc2-266">When you save a chart in the cache, you give it a key that must be unique to that chart.</span></span>

<span data-ttu-id="83bc2-267">如果伺服器記憶體不足,則保存到快取的圖表可能會被刪除。</span><span class="sxs-lookup"><span data-stu-id="83bc2-267">Charts saved to the cache might be removed if the server runs low on memory.</span></span> <span data-ttu-id="83bc2-268">此外,如果應用程式出於任何原因重新啟動,緩存將被清除。</span><span class="sxs-lookup"><span data-stu-id="83bc2-268">In addition, the cache is cleared if your application restarts for any reason.</span></span> <span data-ttu-id="83bc2-269">因此,使用快取圖表的標準方法是始終檢查緩存中是否可用,如果沒有,則先創建或重新創建它。</span><span class="sxs-lookup"><span data-stu-id="83bc2-269">Therefore, the standard way to work with a cached chart is to always check first whether it's available in the cache, and if not, then to create or re-create it.</span></span>

1. <span data-ttu-id="83bc2-270">在網站的根目錄,創建一個名為*ShowCachedChart.cshtml*的檔。</span><span class="sxs-lookup"><span data-stu-id="83bc2-270">At the root of your website, create a file named *ShowCachedChart.cshtml*.</span></span>
2. <span data-ttu-id="83bc2-271">將現有內容取代為以下內容:</span><span class="sxs-lookup"><span data-stu-id="83bc2-271">Replace the existing content with the following:</span></span> 

    [!code-html[Main](7-displaying-data-in-a-chart/samples/sample12.html)]

    <span data-ttu-id="83bc2-272">該`<img>`標記包括`src`指向*ChartSaveToCache.cshtml*檔並將密鑰作為查詢字串傳遞到頁面的屬性。</span><span class="sxs-lookup"><span data-stu-id="83bc2-272">The `<img>` tag includes a `src` attribute that points to the *ChartSaveToCache.cshtml* file and passes a key to the page as a query string.</span></span> <span data-ttu-id="83bc2-273">該鍵包含「我的圖表&quot;&quot;鍵」的值。</span><span class="sxs-lookup"><span data-stu-id="83bc2-273">The key contains the value &quot;myChartKey&quot;.</span></span> <span data-ttu-id="83bc2-274">*ChartSaveToCache.cshtml*檔案包含建立圖`Chart`表 的説明程式。</span><span class="sxs-lookup"><span data-stu-id="83bc2-274">The *ChartSaveToCache.cshtml* file contains the `Chart` helper that creates the chart.</span></span> <span data-ttu-id="83bc2-275">您將在一瞬間創建此頁面。</span><span class="sxs-lookup"><span data-stu-id="83bc2-275">You'll create this page in a moment.</span></span>

    <span data-ttu-id="83bc2-276">在頁面的末尾有一個指向*名為ClearCache.cshtml*的頁面的連結。</span><span class="sxs-lookup"><span data-stu-id="83bc2-276">At the end of the page there's a link to a page named *ClearCache.cshtml*.</span></span> <span data-ttu-id="83bc2-277">稍後還將創建該頁面。</span><span class="sxs-lookup"><span data-stu-id="83bc2-277">That's a page that you'll also create shortly.</span></span> <span data-ttu-id="83bc2-278">您只需要*ClearCache.cshtml*來測試此範例的快取 -它不是使用快取的圖表時通常包含的連結或頁面。</span><span class="sxs-lookup"><span data-stu-id="83bc2-278">You need the *ClearCache.cshtml* only to test caching for this example — it's not a link or page that you'd normally include when working with cached charts.</span></span>
3. <span data-ttu-id="83bc2-279">在網站的根目錄,創建一個名為*ChartSaveToCache.cshtml*的新檔。</span><span class="sxs-lookup"><span data-stu-id="83bc2-279">At the root of your website, create a new file named *ChartSaveToCache.cshtml*.</span></span>
4. <span data-ttu-id="83bc2-280">將現有內容取代為以下內容:</span><span class="sxs-lookup"><span data-stu-id="83bc2-280">Replace the existing content with the following:</span></span>

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample13.cshtml)]

    <span data-ttu-id="83bc2-281">代碼首先檢查是否傳遞了任何內容作為查詢字串中的鍵值。</span><span class="sxs-lookup"><span data-stu-id="83bc2-281">The code first checks whether anything was passed as the key value in the query string.</span></span> <span data-ttu-id="83bc2-282">如果是這樣,代碼會嘗試通過調用`GetFromCache`方法並傳遞密鑰來從快取中讀取圖表。</span><span class="sxs-lookup"><span data-stu-id="83bc2-282">If so, the code tries to read a chart out of the cache by calling the `GetFromCache` method and passing it the key.</span></span> <span data-ttu-id="83bc2-283">如果事實證明該鍵下的緩存中沒有任何內容(在首次請求圖表時發生),則代碼將像往常一樣創建圖表。</span><span class="sxs-lookup"><span data-stu-id="83bc2-283">If it turns out that there's nothing in the cache under that key (which would happen the first time that the chart is requested), the code creates the chart as usual.</span></span> <span data-ttu-id="83bc2-284">圖表完成後,代碼通過調用`SaveToCache`將其保存到緩存中。</span><span class="sxs-lookup"><span data-stu-id="83bc2-284">When the chart is finished, the code saves it to the cache by calling `SaveToCache`.</span></span> <span data-ttu-id="83bc2-285">該方法需要一個鍵(以便以後可以請求圖表),以及圖表應保存在緩存中的時間量。</span><span class="sxs-lookup"><span data-stu-id="83bc2-285">That method requires a key (so the chart can be requested later), and the amount of time that the chart should be saved in the cache.</span></span> <span data-ttu-id="83bc2-286">(快取圖表的確切時間取決於您認為圖表表示的數據可能會更改的頻率。該方法`SaveToCache`還需要一`slidingExpiration`個 參數&#8212;如果設置為 true,則每次訪問圖表時都會重置超時計數器。</span><span class="sxs-lookup"><span data-stu-id="83bc2-286">(The exact time you'd cache a chart would depend on how often you thought the data it represents might change.) The `SaveToCache` method also requires a `slidingExpiration` parameter &#8212; if this is set to true, the timeout counter is reset each time the chart is accessed.</span></span> <span data-ttu-id="83bc2-287">在這種情況下,它實際上意味著圖表的緩存條目在上次有人訪問圖表后 2 分鐘過期。</span><span class="sxs-lookup"><span data-stu-id="83bc2-287">In this case, it in effect means that the chart's cache entry expires 2 minutes after the last time someone accessed the chart.</span></span> <span data-ttu-id="83bc2-288">(滑動過期的替代方法是絕對過期的,這意味著緩存條目在放入緩存后正好 2 分鐘后過期,無論訪問頻率如何。</span><span class="sxs-lookup"><span data-stu-id="83bc2-288">(The alternative to sliding expiration is absolute expiration, meaning that the cache entry would expire exactly 2 minutes after it was put into the cache, no matter how often it had been accessed.)</span></span>

    <span data-ttu-id="83bc2-289">最後,程式碼使用`WriteFromCache`方法 從緩存中獲取和呈現圖表。</span><span class="sxs-lookup"><span data-stu-id="83bc2-289">Finally, the code uses the `WriteFromCache` method to fetch and render the chart from the cache.</span></span> <span data-ttu-id="83bc2-290">請注意,此方法位於檢查緩存`if`的塊之外,因為它將從緩存中獲取圖表,無論圖表是開始還是必須生成並保存在緩存中。</span><span class="sxs-lookup"><span data-stu-id="83bc2-290">Note that this method is outside the `if` block that checks the cache, because it will get the chart from the cache whether the chart was there to begin with or had to be generated and saved in the cache.</span></span>

    <span data-ttu-id="83bc2-291">請注意,在此示例中,`AddTitle`該方法包含時間戳。</span><span class="sxs-lookup"><span data-stu-id="83bc2-291">Notice that in the example, the `AddTitle` method includes a timestamp.</span></span> <span data-ttu-id="83bc2-292">(它將當前日期和時間&#8212;&#8212;`DateTime.Now`添加到標題中。</span><span class="sxs-lookup"><span data-stu-id="83bc2-292">(It adds the current date and time &#8212; `DateTime.Now` &#8212; to the title.)</span></span>
5. <span data-ttu-id="83bc2-293">建立名為*ClearCache.cshtml*的新頁面,並將其內容取代為以下內容:</span><span class="sxs-lookup"><span data-stu-id="83bc2-293">Create a new page named *ClearCache.cshtml* and replace its content with the following:</span></span>

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample14.cshtml)]

    <span data-ttu-id="83bc2-294">此頁使用`WebCache`幫助程式刪除在*ChartSaveToCache.cshtml*中快取的圖表。</span><span class="sxs-lookup"><span data-stu-id="83bc2-294">This page uses the `WebCache` helper to remove the chart that's cached in *ChartSaveToCache.cshtml*.</span></span> <span data-ttu-id="83bc2-295">如前所述,您通常不必有這樣的頁面。</span><span class="sxs-lookup"><span data-stu-id="83bc2-295">As noted earlier, you don't normally have to have a page like this.</span></span> <span data-ttu-id="83bc2-296">您在此處創建它只是為了更輕鬆地測試快取。</span><span class="sxs-lookup"><span data-stu-id="83bc2-296">You're creating it here only to make it easier to test caching.</span></span>
6. <span data-ttu-id="83bc2-297">在瀏覽器中運行*ShowCachedChart.cshtml*網頁。</span><span class="sxs-lookup"><span data-stu-id="83bc2-297">Run the *ShowCachedChart.cshtml* web page in a browser.</span></span> <span data-ttu-id="83bc2-298">該頁面基於*ChartSaveToCache.cshtml*檔中的代碼顯示圖表圖像。</span><span class="sxs-lookup"><span data-stu-id="83bc2-298">The page displays the chart image based on the code contained in the *ChartSaveToCache.cshtml* file.</span></span> <span data-ttu-id="83bc2-299">記下時間戳在圖表標題中的內容。</span><span class="sxs-lookup"><span data-stu-id="83bc2-299">Take note of what the timestamp says in the chart title.</span></span> 

    ![說明:圖表標題中帶有時間戳的基本圖表圖片](7-displaying-data-in-a-chart/_static/image13.jpg)
7. <span data-ttu-id="83bc2-301">關閉瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="83bc2-301">Close the browser.</span></span>
8. <span data-ttu-id="83bc2-302">再次運行*ShowCachedChart.cshtml。*</span><span class="sxs-lookup"><span data-stu-id="83bc2-302">Run the *ShowCachedChart.cshtml* again.</span></span> <span data-ttu-id="83bc2-303">請注意,時間戳與以前相同,表示圖表未重新生成,而是從緩存中讀取。</span><span class="sxs-lookup"><span data-stu-id="83bc2-303">Notice that the timestamp is the same as before, which indicates that the chart was not regenerated, but was instead read from the cache.</span></span>
9. <span data-ttu-id="83bc2-304">在*ShowCachedChart.cshtml*中,按一下**清除快取**連結。</span><span class="sxs-lookup"><span data-stu-id="83bc2-304">In *ShowCachedChart.cshtml*, click the **Clear cache** link.</span></span> <span data-ttu-id="83bc2-305">這將帶您到*ClearCache.cshtml*,它報告緩存已清除。</span><span class="sxs-lookup"><span data-stu-id="83bc2-305">This takes you to *ClearCache.cshtml*, which reports that the cache has been cleared.</span></span>
10. <span data-ttu-id="83bc2-306">按下 **「返回顯示快取圖表.cshtml」** 連結,或從 WebMatrix 重新執行*ShowCachedChart.cshtml。*</span><span class="sxs-lookup"><span data-stu-id="83bc2-306">Click the **Return to ShowCachedChart.cshtml** link, or re-run *ShowCachedChart.cshtml* from WebMatrix.</span></span> <span data-ttu-id="83bc2-307">請注意,此時間戳已更改,因為緩存已清除。</span><span class="sxs-lookup"><span data-stu-id="83bc2-307">Notice that this time the timestamp has changed, because the cache has been cleared.</span></span> <span data-ttu-id="83bc2-308">因此,代碼必須重新生成圖表並將其放回緩存中。</span><span class="sxs-lookup"><span data-stu-id="83bc2-308">Therefore, the code had to regenerate the chart and put it back into the cache.</span></span>

### <a name="saving-a-chart-as-an-image-file"></a><span data-ttu-id="83bc2-309">儲存圖表為影像檔案</span><span class="sxs-lookup"><span data-stu-id="83bc2-309">Saving a Chart as an Image File</span></span>

<span data-ttu-id="83bc2-310">您還可以將圖表另存為伺服器上的圖像檔(例如,作為 *.jpg*檔)。</span><span class="sxs-lookup"><span data-stu-id="83bc2-310">You can also save a chart as an image file (for example, as a *.jpg* file) on the server.</span></span> <span data-ttu-id="83bc2-311">然後,您可以像使用任何圖像的方式使用圖像檔。</span><span class="sxs-lookup"><span data-stu-id="83bc2-311">You can then use the image file the way you would any image.</span></span> <span data-ttu-id="83bc2-312">優點是檔被存儲而不是保存到臨時緩存。</span><span class="sxs-lookup"><span data-stu-id="83bc2-312">The advantage is the file is stored rather than saved to a temporary cache.</span></span> <span data-ttu-id="83bc2-313">您可以在不同時間(例如,每小時)保存新的圖表圖像,然後保留隨時間變化的永久記錄。</span><span class="sxs-lookup"><span data-stu-id="83bc2-313">You can save a new chart image at different times (for example, every hour) and then keep a permanent record of the changes that occur over time.</span></span> <span data-ttu-id="83bc2-314">請注意,必須確保 Web 應用程式具有將檔案儲存到要放置圖像檔的伺服器上的資料夾的許可權。</span><span class="sxs-lookup"><span data-stu-id="83bc2-314">Note that you must make sure that your web application has permission to save a file to the folder on the server where you want to put the image file.</span></span>

1. <span data-ttu-id="83bc2-315">在網站的根目錄,創建名為*\_ChartFiles 的*資料夾(如果該資料夾不存在)。</span><span class="sxs-lookup"><span data-stu-id="83bc2-315">At the root of your website, create a folder named *\_ChartFiles* if it does not already exist.</span></span>
2. <span data-ttu-id="83bc2-316">在網站的根目錄,創建一個名為*ChartSave.cshtml*的新檔。</span><span class="sxs-lookup"><span data-stu-id="83bc2-316">At the root of your website, create a new file named *ChartSave.cshtml*.</span></span>
3. <span data-ttu-id="83bc2-317">將現有內容取代為以下內容:</span><span class="sxs-lookup"><span data-stu-id="83bc2-317">Replace the existing content with the following:</span></span>

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample15.cshtml)]

    <span data-ttu-id="83bc2-318">代碼首先通過調用`File.Exists`方法檢查 *.jpg*檔是否存在。</span><span class="sxs-lookup"><span data-stu-id="83bc2-318">The code first checks to see whether the *.jpg* file exists by calling the `File.Exists` method.</span></span> <span data-ttu-id="83bc2-319">如果檔案不存在,代碼會從陣列建立新`Chart`。</span><span class="sxs-lookup"><span data-stu-id="83bc2-319">If the file does not exist, the code creates a new `Chart` from an array.</span></span> <span data-ttu-id="83bc2-320">這一次,代碼調用`Save`方法並`path`傳遞 參數以指定保存圖表的位置的文件路徑和檔名。</span><span class="sxs-lookup"><span data-stu-id="83bc2-320">This time, the code calls the `Save` method and passes the `path` parameter to specify the file path and file name of where to save the chart.</span></span> <span data-ttu-id="83bc2-321">在頁面正文中,`<img>`元素使用路徑指向要顯示的 *.jpg*檔。</span><span class="sxs-lookup"><span data-stu-id="83bc2-321">In the body of the page, an `<img>` element uses the path to point to the *.jpg* file to display.</span></span>
4. <span data-ttu-id="83bc2-322">運行*ChartSave.cshtml*檔。</span><span class="sxs-lookup"><span data-stu-id="83bc2-322">Run the *ChartSave.cshtml* file.</span></span>
5. <span data-ttu-id="83bc2-323">返回到 WebMatrix。</span><span class="sxs-lookup"><span data-stu-id="83bc2-323">Return to WebMatrix.</span></span> <span data-ttu-id="83bc2-324">請注意,名為*chart01.jpg*的圖像檔已儲存在*\_圖表檔*資料夾中。</span><span class="sxs-lookup"><span data-stu-id="83bc2-324">Notice that an image file named *chart01.jpg* has been saved in the *\_ChartFiles* folder.</span></span>

### <a name="saving-a-chart-as-an-xml-file"></a><span data-ttu-id="83bc2-325">儲存圖表為 XML 檔</span><span class="sxs-lookup"><span data-stu-id="83bc2-325">Saving a Chart as an XML File</span></span>

<span data-ttu-id="83bc2-326">最後,您可以將圖表另存為伺服器上的 XML 檔。</span><span class="sxs-lookup"><span data-stu-id="83bc2-326">Finally, you can save a chart as an XML file on the server.</span></span> <span data-ttu-id="83bc2-327">使用此方法對快取圖表或將圖表保存到檔中的一個優點是,如果需要,可以在顯示圖表之前修改 XML。</span><span class="sxs-lookup"><span data-stu-id="83bc2-327">An advantage of using this method over caching the chart or saving the chart to a file is that you could modify the XML before displaying the chart if you wanted to.</span></span> <span data-ttu-id="83bc2-328">應用程式必須具有要放置映像檔的伺服器上的資料夾的讀/寫許可權。</span><span class="sxs-lookup"><span data-stu-id="83bc2-328">Your application has to have read/write permissions for the folder on the server where you want to put the image file.</span></span>

1. <span data-ttu-id="83bc2-329">在網站的根目錄,創建一個名為*ChartSaveXml.cshtml*的新檔。</span><span class="sxs-lookup"><span data-stu-id="83bc2-329">At the root of your website, create a new file named *ChartSaveXml.cshtml*.</span></span>
2. <span data-ttu-id="83bc2-330">將現有內容取代為以下內容:</span><span class="sxs-lookup"><span data-stu-id="83bc2-330">Replace the existing content with the following:</span></span>

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample16.cshtml)]

    <span data-ttu-id="83bc2-331">此代碼類似於您之前在快取中儲存圖表時看到的代碼,只不過它使用 XML 檔。</span><span class="sxs-lookup"><span data-stu-id="83bc2-331">This code is similar to the code that you saw earlier for storing a chart in the cache, except that it uses an XML file.</span></span> <span data-ttu-id="83bc2-332">代碼首先通過調用`File.Exists`方法檢查 XML 檔是否存在。</span><span class="sxs-lookup"><span data-stu-id="83bc2-332">The code first checks to see whether the XML file exists by calling the `File.Exists` method.</span></span> <span data-ttu-id="83bc2-333">如果文件確實存在,代碼將創建一個新`Chart`物件,並將檔名`themePath`作為 參數傳遞。</span><span class="sxs-lookup"><span data-stu-id="83bc2-333">If the file does exist, the code creates a new `Chart` object and passes the file name as the `themePath` parameter.</span></span> <span data-ttu-id="83bc2-334">這將基於 XML 檔中的任何內容建立圖表。</span><span class="sxs-lookup"><span data-stu-id="83bc2-334">This creates the chart based on whatever's in the XML file.</span></span> <span data-ttu-id="83bc2-335">如果 XML 檔不存在,代碼將創建一個類似於正常圖表的圖表,然後`SaveXml`調用 以儲存它。</span><span class="sxs-lookup"><span data-stu-id="83bc2-335">If the XML file doesn't already exist, the code creates a chart like normal and then calls `SaveXml` to save it.</span></span> <span data-ttu-id="83bc2-336">圖表使用 方法呈現`Write`, 如您以前看到的那樣。</span><span class="sxs-lookup"><span data-stu-id="83bc2-336">The chart is rendered using the `Write` method, as you've seen before.</span></span>

    <span data-ttu-id="83bc2-337">與顯示快取的頁面一樣,此代碼在圖表標題中包括時間戳。</span><span class="sxs-lookup"><span data-stu-id="83bc2-337">As with the page that showed caching, this code includes a timestamp in the chart title.</span></span>
3. <span data-ttu-id="83bc2-338">建立名為*ChartDisplayXMLChart.cshtml*的新頁面,並新增以下標記:</span><span class="sxs-lookup"><span data-stu-id="83bc2-338">Create a new page named *ChartDisplayXMLChart.cshtml* and add the following markup to it:</span></span> 

    [!code-html[Main](7-displaying-data-in-a-chart/samples/sample17.html)]
4. <span data-ttu-id="83bc2-339">運行*圖表顯示XMLChart.cshtml*頁面。</span><span class="sxs-lookup"><span data-stu-id="83bc2-339">Run the *ChartDisplayXMLChart.cshtml* page.</span></span> <span data-ttu-id="83bc2-340">將顯示圖表。</span><span class="sxs-lookup"><span data-stu-id="83bc2-340">The chart is displayed.</span></span> <span data-ttu-id="83bc2-341">記下圖表標題中的時間戳。</span><span class="sxs-lookup"><span data-stu-id="83bc2-341">Take note of the timestamp in the chart's title.</span></span>
5. <span data-ttu-id="83bc2-342">關閉瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="83bc2-342">Close the browser.</span></span>
6. <span data-ttu-id="83bc2-343">在 WebMatrix 中,右鍵按*\_一下圖表檔*資料夾,按下 **「刷新**」,然後打開該資料夾。</span><span class="sxs-lookup"><span data-stu-id="83bc2-343">In WebMatrix, right-click the *\_ChartFiles* folder, click **Refresh**, and then open the folder.</span></span> <span data-ttu-id="83bc2-344">此資料夾中的*XMLChart.xml*`Chart`檔案由 幫助程式創建。</span><span class="sxs-lookup"><span data-stu-id="83bc2-344">The *XMLChart.xml* file in this folder was created by the `Chart` helper.</span></span> 

    ![說明:顯示圖表説明程式創建的 XMLChart.xml 檔的_ChartFiles資料夾。](7-displaying-data-in-a-chart/_static/image14.jpg)
7. <span data-ttu-id="83bc2-346">再次執行*圖表顯示XMLChart.cshtml*頁面。</span><span class="sxs-lookup"><span data-stu-id="83bc2-346">Run the *ChartDisplayXMLChart.cshtml* page again.</span></span> <span data-ttu-id="83bc2-347">該圖表顯示的時間戳與首次運行頁面時的時間戳相同。</span><span class="sxs-lookup"><span data-stu-id="83bc2-347">The chart shows the same timestamp as the first time you ran the page.</span></span> <span data-ttu-id="83bc2-348">這是因為圖表是從您之前保存的 XML 生成的。</span><span class="sxs-lookup"><span data-stu-id="83bc2-348">That's because the chart is being generated from the XML you saved earlier.</span></span>
8. <span data-ttu-id="83bc2-349">在 WebMatrix 中,開啟*\_圖表檔案*資料夾並刪除*XMLChart.xml*檔案。</span><span class="sxs-lookup"><span data-stu-id="83bc2-349">In WebMatrix, open the *\_ChartFiles* folder and delete the *XMLChart.xml* file.</span></span>
9. <span data-ttu-id="83bc2-350">再次執行*圖表顯示XMLChart.cshtml*頁面。</span><span class="sxs-lookup"><span data-stu-id="83bc2-350">Run the *ChartDisplayXMLChart.cshtml* page once more.</span></span> <span data-ttu-id="83bc2-351">這一次,時間戳將更新,因為`Chart`幫助程式必須重新創建 XML 檔。</span><span class="sxs-lookup"><span data-stu-id="83bc2-351">This time, the timestamp is updated, because the `Chart` helper had to recreate the XML file.</span></span> <span data-ttu-id="83bc2-352">如果需要,請檢查*\_ChartFiles*資料夾,並注意到 XML 檔已返回。</span><span class="sxs-lookup"><span data-stu-id="83bc2-352">If you want, check the *\_ChartFiles* folder and notice that the XML file is back.</span></span>

<a id="Additional_Resources"></a>
## <a name="additional-resources"></a><span data-ttu-id="83bc2-353">其他資源</span><span class="sxs-lookup"><span data-stu-id="83bc2-353">Additional Resources</span></span>

- [<span data-ttu-id="83bc2-354">ASP.NET網頁網站中使用資料庫的簡介</span><span class="sxs-lookup"><span data-stu-id="83bc2-354">Introduction to Working with a Database in ASP.NET Web Pages Sites</span></span>](https://go.microsoft.com/fwlink/?LinkId=202893)
- [<span data-ttu-id="83bc2-355">在ASP.NET網頁網站中使用緩存以提高性能</span><span class="sxs-lookup"><span data-stu-id="83bc2-355">Using Caching in ASP.NET Web Pages Sites to Improve Performance</span></span>](https://go.microsoft.com/fwlink/?LinkId=202903)
- <span data-ttu-id="83bc2-356">[圖表類別](https://msdn.microsoft.com/library/system.web.helpers.chart(v=vs.99))(ASP.NET MSDN 上的網頁 API 引用)</span><span class="sxs-lookup"><span data-stu-id="83bc2-356">[Chart Class](https://msdn.microsoft.com/library/system.web.helpers.chart(v=vs.99)) (ASP.NET Web Pages API reference on MSDN)</span></span>
