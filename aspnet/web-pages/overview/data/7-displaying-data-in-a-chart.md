---
uid: web-pages/overview/data/7-displaying-data-in-a-chart
title: 使用 ASP.NET Web Pages （Razor）在圖表中顯示資料 |Microsoft Docs
author: microsoft
description: 本章說明如何在圖表中顯示資料。 在上一章中，您已瞭解如何以手動方式在方格中顯示資料。 本章將說明 。
ms.author: riande
ms.date: 05/22/2012
ms.assetid: f889fd46-4dac-4ecb-83d8-60e64c22036e
msc.legacyurl: /web-pages/overview/data/7-displaying-data-in-a-chart
msc.type: authoredcontent
ms.openlocfilehash: 6dad67d4e3d38d57a761c567d937d714a3184ea9
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/06/2020
ms.locfileid: "78627488"
---
# <a name="displaying-data-in-a-chart-with-aspnet-web-pages-razor"></a><span data-ttu-id="5725c-105">使用 ASP.NET Web Pages （Razor）在圖表中顯示資料</span><span class="sxs-lookup"><span data-stu-id="5725c-105">Displaying Data in a Chart with ASP.NET Web Pages (Razor)</span></span>

<span data-ttu-id="5725c-106">由[Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="5725c-106">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="5725c-107">本文說明如何使用圖表，在 ASP.NET Web Pages （Razor）網站中，使用 `Chart` helper 來顯示資料。</span><span class="sxs-lookup"><span data-stu-id="5725c-107">This article explains how to use a chart to display data in an ASP.NET Web Pages (Razor) website by using the `Chart` helper.</span></span>
> 
> <span data-ttu-id="5725c-108">**您將瞭解的內容**：</span><span class="sxs-lookup"><span data-stu-id="5725c-108">**What you'll learn**:</span></span>
> 
> - <span data-ttu-id="5725c-109">如何在圖表中顯示資料。</span><span class="sxs-lookup"><span data-stu-id="5725c-109">How to display data in a chart.</span></span>
> - <span data-ttu-id="5725c-110">如何使用內建主題來為圖表樣式。</span><span class="sxs-lookup"><span data-stu-id="5725c-110">How to style charts using built-in themes.</span></span>
> - <span data-ttu-id="5725c-111">如何儲存圖表以及如何加以快取，以提升效能。</span><span class="sxs-lookup"><span data-stu-id="5725c-111">How to save charts and how to cache them for better performance.</span></span>
> 
> <span data-ttu-id="5725c-112">以下是文章中引進的 ASP.NET 程式設計功能：</span><span class="sxs-lookup"><span data-stu-id="5725c-112">These are the ASP.NET programming features introduced in the article:</span></span>
> 
> - <span data-ttu-id="5725c-113">`Chart` helper。</span><span class="sxs-lookup"><span data-stu-id="5725c-113">The `Chart` helper.</span></span>
> 
> > [!NOTE]
> > <span data-ttu-id="5725c-114">本文中的資訊適用于 ASP.NET Web Pages 1.0 和 Web Pages 2。</span><span class="sxs-lookup"><span data-stu-id="5725c-114">The information in this article applies to ASP.NET Web Pages 1.0 and Web Pages 2.</span></span>

<a id="The_Chart_Helper"></a>
## <a name="the-chart-helper"></a><span data-ttu-id="5725c-115">圖表 Helper</span><span class="sxs-lookup"><span data-stu-id="5725c-115">The Chart Helper</span></span>

<span data-ttu-id="5725c-116">當您想要以圖形形式顯示資料時，可以使用 `Chart` helper。</span><span class="sxs-lookup"><span data-stu-id="5725c-116">When you want to display your data in graphical form, you can use `Chart` helper.</span></span> <span data-ttu-id="5725c-117">`Chart` helper 可以轉譯影像，以顯示各種圖表類型的資料。</span><span class="sxs-lookup"><span data-stu-id="5725c-117">The `Chart` helper can render an image that displays data in a variety of chart types.</span></span> <span data-ttu-id="5725c-118">它支援許多格式設定和標籤的選項。</span><span class="sxs-lookup"><span data-stu-id="5725c-118">It supports many options for formatting and labeling.</span></span> <span data-ttu-id="5725c-119">`Chart` helper 可以轉譯超過30種圖表類型，包括您可能熟悉的 Microsoft Excel 或其他工具&#8212;區域圖、橫條圖、直條圖、折線圖和圓形圖，以及更多特製化圖表，例如股票圖。</span><span class="sxs-lookup"><span data-stu-id="5725c-119">The `Chart` helper can render more than 30 types of charts, including all the types of charts that you might be familiar with from Microsoft Excel or other tools &#8212; area charts, bar charts, column charts, line charts, and pie charts, along with more specialized charts like stock charts.</span></span>

| <span data-ttu-id="5725c-120">**區域圖**![描述：區域圖類型的圖片](7-displaying-data-in-a-chart/_static/image1.jpg)</span><span class="sxs-lookup"><span data-stu-id="5725c-120">**Area chart** ![Description: Picture of the Area chart type](7-displaying-data-in-a-chart/_static/image1.jpg)</span></span> | <span data-ttu-id="5725c-121">**橫條圖**![描述：橫條圖類型的圖片](7-displaying-data-in-a-chart/_static/image2.jpg)</span><span class="sxs-lookup"><span data-stu-id="5725c-121">**Bar chart** ![Description: Picture of the Bar chart type](7-displaying-data-in-a-chart/_static/image2.jpg)</span></span> |
| --- | --- |
| <span data-ttu-id="5725c-122">**直條圖**![描述：直條圖類型的圖片](7-displaying-data-in-a-chart/_static/image3.jpg)</span><span class="sxs-lookup"><span data-stu-id="5725c-122">**Column chart** ![Description: Picture of the Column chart type](7-displaying-data-in-a-chart/_static/image3.jpg)</span></span> | <span data-ttu-id="5725c-123">**折線圖**![描述：折線圖類型的圖片](7-displaying-data-in-a-chart/_static/image4.jpg)</span><span class="sxs-lookup"><span data-stu-id="5725c-123">**Line chart** ![Description: Picture of the Line chart type](7-displaying-data-in-a-chart/_static/image4.jpg)</span></span> |
| <span data-ttu-id="5725c-124">**圓形圖**![描述：圓形圖類型的圖片](7-displaying-data-in-a-chart/_static/image5.jpg)</span><span class="sxs-lookup"><span data-stu-id="5725c-124">**Pie chart** ![Description: Picture of the Pie chart type](7-displaying-data-in-a-chart/_static/image5.jpg)</span></span> | <span data-ttu-id="5725c-125">**股票圖**![描述：股票圖類型的圖片](7-displaying-data-in-a-chart/_static/image6.jpg)</span><span class="sxs-lookup"><span data-stu-id="5725c-125">**Stock chart** ![Description: Picture of the Stock chart type](7-displaying-data-in-a-chart/_static/image6.jpg)</span></span> |

### <a name="chart-elements"></a><span data-ttu-id="5725c-126">圖表項目</span><span class="sxs-lookup"><span data-stu-id="5725c-126">Chart Elements</span></span>

<span data-ttu-id="5725c-127">圖表會顯示資料和其他元素，例如圖例、軸、數列等等。</span><span class="sxs-lookup"><span data-stu-id="5725c-127">Charts show data and additional elements like legends, axes, series, and so on.</span></span> <span data-ttu-id="5725c-128">下圖顯示當您使用 `Chart` helper 時，可以自訂的許多圖表元素。</span><span class="sxs-lookup"><span data-stu-id="5725c-128">The following picture shows many of the chart elements that you can customize when you use the `Chart` helper.</span></span> <span data-ttu-id="5725c-129">本文說明如何設定這些元素的部分（而非全部）。</span><span class="sxs-lookup"><span data-stu-id="5725c-129">This article shows you how to set some (not all) of these elements.</span></span>

![描述：顯示圖表元素的圖片](7-displaying-data-in-a-chart/_static/image7.jpg)

<a id="Creating_a_Chart"></a>
## <a name="creating-a-chart-from-data"></a><span data-ttu-id="5725c-131">從資料建立圖表</span><span class="sxs-lookup"><span data-stu-id="5725c-131">Creating a Chart from Data</span></span>

<span data-ttu-id="5725c-132">您在圖表中顯示的資料可以來自陣列、從資料庫傳回的結果，或 XML 檔案中的資料。</span><span class="sxs-lookup"><span data-stu-id="5725c-132">The data you display in a chart can be from an array, from the results returned from a database, or from data that's in an XML file.</span></span>

### <a name="using-an-array"></a><span data-ttu-id="5725c-133">使用陣列</span><span class="sxs-lookup"><span data-stu-id="5725c-133">Using an Array</span></span>

<span data-ttu-id="5725c-134">如[使用 Razor 語法進行 ASP.NET Web Pages 程式設計簡介](https://go.microsoft.com/fwlink/?LinkId=202890)中所述，陣列可讓您在單一變數中儲存類似專案的集合。</span><span class="sxs-lookup"><span data-stu-id="5725c-134">As explained in [Introduction to ASP.NET Web Pages Programming Using the Razor Syntax](https://go.microsoft.com/fwlink/?LinkId=202890), an array lets you store a collection of similar items in a single variable.</span></span> <span data-ttu-id="5725c-135">您可以使用陣列來包含您想要包含在圖表中的資料。</span><span class="sxs-lookup"><span data-stu-id="5725c-135">You can use arrays to contain the data that you want to include in your chart.</span></span>

<span data-ttu-id="5725c-136">此程式說明如何使用預設圖表類型，從陣列中的資料建立圖表。</span><span class="sxs-lookup"><span data-stu-id="5725c-136">This procedure shows how you can create a chart from data in arrays, using the default chart type.</span></span> <span data-ttu-id="5725c-137">它也會顯示如何在頁面中顯示圖表。</span><span class="sxs-lookup"><span data-stu-id="5725c-137">It also shows how to display the chart within the page.</span></span>

1. <span data-ttu-id="5725c-138">建立名為*ChartArrayBasic*的新檔案。</span><span class="sxs-lookup"><span data-stu-id="5725c-138">Create a new file named *ChartArrayBasic.cshtml*.</span></span>
2. <span data-ttu-id="5725c-139">以下列內容取代現有的內容：</span><span class="sxs-lookup"><span data-stu-id="5725c-139">Replace the existing content with the following:</span></span> 

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample1.cshtml)]

    <span data-ttu-id="5725c-140">程式碼會先建立新的圖表，並設定其寬度和高度。</span><span class="sxs-lookup"><span data-stu-id="5725c-140">The code first creates a new chart and sets its width and height.</span></span> <span data-ttu-id="5725c-141">您可以使用 `AddTitle` 方法來指定圖表標題。</span><span class="sxs-lookup"><span data-stu-id="5725c-141">You specify the chart title by using the `AddTitle` method.</span></span> <span data-ttu-id="5725c-142">若要加入資料，您可以使用 `AddSeries` 方法。</span><span class="sxs-lookup"><span data-stu-id="5725c-142">To add data, you use the `AddSeries` method.</span></span> <span data-ttu-id="5725c-143">在此範例中，您會使用 `AddSeries` 方法的 `name`、`xValue`和 `yValues` 參數。</span><span class="sxs-lookup"><span data-stu-id="5725c-143">In this example, you use the `name`, `xValue`, and `yValues` parameters of the `AddSeries` method.</span></span> <span data-ttu-id="5725c-144">[`name`] 參數會顯示在圖表圖例中。</span><span class="sxs-lookup"><span data-stu-id="5725c-144">The `name` parameter is displayed in the chart legend.</span></span> <span data-ttu-id="5725c-145">`xValue` 參數包含沿著圖表水準軸顯示的資料陣列。</span><span class="sxs-lookup"><span data-stu-id="5725c-145">The `xValue` parameter contains an array of data that's displayed along the horizontal axis of the chart.</span></span> <span data-ttu-id="5725c-146">`yValues` 參數包含用來繪製圖表垂直點的資料陣列。</span><span class="sxs-lookup"><span data-stu-id="5725c-146">The `yValues` parameter contains an array of data that's used to plot the vertical points of the chart.</span></span>

    <span data-ttu-id="5725c-147">`Write` 方法實際上會呈現圖表。</span><span class="sxs-lookup"><span data-stu-id="5725c-147">The `Write` method actually renders the chart.</span></span> <span data-ttu-id="5725c-148">在此情況下，因為您未指定圖表類型，所以 `Chart` helper 會轉譯其預設圖表，也就是直條圖。</span><span class="sxs-lookup"><span data-stu-id="5725c-148">In this case, because you didn't specify a chart type, the `Chart` helper renders its default chart, which is a column chart.</span></span>
3. <span data-ttu-id="5725c-149">在瀏覽器中執行頁面。</span><span class="sxs-lookup"><span data-stu-id="5725c-149">Run the page in the browser.</span></span> <span data-ttu-id="5725c-150">瀏覽器會顯示圖表。</span><span class="sxs-lookup"><span data-stu-id="5725c-150">The browser displays the chart.</span></span> 

    ![](7-displaying-data-in-a-chart/_static/image8.jpg)

### <a name="using-a-database-query-for-chart-data"></a><span data-ttu-id="5725c-151">針對圖表資料使用資料庫查詢</span><span class="sxs-lookup"><span data-stu-id="5725c-151">Using a Database Query for Chart Data</span></span>

<span data-ttu-id="5725c-152">如果您想要建立圖表的資訊是在資料庫中，您可以執行資料庫查詢，然後使用結果中的資料來建立圖表。</span><span class="sxs-lookup"><span data-stu-id="5725c-152">If the information you want to chart is in a database, you can run a database query and then use data from the results to create the chart.</span></span> <span data-ttu-id="5725c-153">此程式說明如何從在[ASP.NET Web Pages 網站中使用資料庫簡介](https://go.microsoft.com/fwlink/?LinkId=202893)中所建立的資料庫中，讀取和顯示資料。</span><span class="sxs-lookup"><span data-stu-id="5725c-153">This procedure shows you how to read and display the data from the database created in the article [Introduction to Working with a Database in ASP.NET Web Pages Sites](https://go.microsoft.com/fwlink/?LinkId=202893).</span></span>

1. <span data-ttu-id="5725c-154">如果資料夾不存在，請將*應用程式\_Data*資料夾新增至網站的根目錄。</span><span class="sxs-lookup"><span data-stu-id="5725c-154">Add an *App\_Data* folder to the root of the website if the folder does not already exist.</span></span>
2. <span data-ttu-id="5725c-155">在*應用程式\_資料* 資料夾中，新增名為*SmallBakery*的資料庫檔案，其說明請參閱在[ASP.NET Web Pages 網站中使用資料庫簡介](https://go.microsoft.com/fwlink/?LinkId=202893)。</span><span class="sxs-lookup"><span data-stu-id="5725c-155">In the *App\_Data* folder, add the database file named *SmallBakery.sdf* that's described in [Introduction to Working with a Database in ASP.NET Web Pages Sites](https://go.microsoft.com/fwlink/?LinkId=202893).</span></span>
3. <span data-ttu-id="5725c-156">建立名為*ChartDataQuery*的新檔案。</span><span class="sxs-lookup"><span data-stu-id="5725c-156">Create a new file named *ChartDataQuery.cshtml*.</span></span>
4. <span data-ttu-id="5725c-157">以下列內容取代現有的內容：</span><span class="sxs-lookup"><span data-stu-id="5725c-157">Replace the existing content with the following:</span></span>   

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample2.cshtml)]

    <span data-ttu-id="5725c-158">程式碼會先開啟 SmallBakery 資料庫，並將它指派給名為 `db`的變數。</span><span class="sxs-lookup"><span data-stu-id="5725c-158">The code first opens the SmallBakery database and assigns it to a variable named `db`.</span></span> <span data-ttu-id="5725c-159">這個變數代表可以用來讀取和寫入資料庫的 `Database` 物件。</span><span class="sxs-lookup"><span data-stu-id="5725c-159">This variable represents a `Database` object that can be used to read from and write to the database.</span></span> <span data-ttu-id="5725c-160">接下來，程式碼會執行 SQL 查詢，以取得每個產品的名稱和價格。</span><span class="sxs-lookup"><span data-stu-id="5725c-160">Next, the code runs a SQL query to get the name and price of each product.</span></span> <span data-ttu-id="5725c-161">此程式碼會建立新的圖表，並藉由呼叫圖表的 `DataBindTable` 方法，將資料庫查詢傳遞給它。</span><span class="sxs-lookup"><span data-stu-id="5725c-161">The code creates a new chart and passes the database query to it by calling the chart's `DataBindTable` method.</span></span> <span data-ttu-id="5725c-162">這個方法會採用兩個參數： `dataSource` 參數用於查詢中的資料，而 `xField` 參數可讓您設定要用於圖表 X 軸的資料行。</span><span class="sxs-lookup"><span data-stu-id="5725c-162">This method takes two parameters: the `dataSource` parameter is for the data from the query, and the `xField` parameter lets you set which data column is used for the chart's x-axis.</span></span>

    <span data-ttu-id="5725c-163">除了使用 `DataBindTable` 方法以外，您還可以使用 `Chart` helper 的 `AddSeries` 方法。</span><span class="sxs-lookup"><span data-stu-id="5725c-163">As an alternative to using the `DataBindTable` method, you can use the `AddSeries` method of the `Chart` helper.</span></span> <span data-ttu-id="5725c-164">`AddSeries` 方法可讓您設定 `xValue` 和 `yValues` 參數。</span><span class="sxs-lookup"><span data-stu-id="5725c-164">The `AddSeries` method lets you set the `xValue` and `yValues` parameters.</span></span> <span data-ttu-id="5725c-165">例如，而不是使用 `DataBindTable` 的方法，如下所示：</span><span class="sxs-lookup"><span data-stu-id="5725c-165">For example, instead of using the `DataBindTable` method like this:</span></span>

    [!code-css[Main](7-displaying-data-in-a-chart/samples/sample3.css)]

    <span data-ttu-id="5725c-166">您可以使用 `AddSeries` 方法，如下所示：</span><span class="sxs-lookup"><span data-stu-id="5725c-166">You can use the `AddSeries` method like this:</span></span>

    [!code-html[Main](7-displaying-data-in-a-chart/samples/sample4.html)]

    <span data-ttu-id="5725c-167">兩者都會呈現相同的結果。</span><span class="sxs-lookup"><span data-stu-id="5725c-167">Both render the same results.</span></span> <span data-ttu-id="5725c-168">`AddSeries` 方法更具彈性，因為您可以更明確地指定圖表類型和資料，但如果您不需要額外的彈性，`DataBindTable` 方法會更容易使用。</span><span class="sxs-lookup"><span data-stu-id="5725c-168">The `AddSeries` method is more flexible because you can specify the chart type and data more explicitly, but the `DataBindTable` method is easier to use if you don't need the extra flexibility.</span></span>
5. <span data-ttu-id="5725c-169">在瀏覽器中執行頁面。</span><span class="sxs-lookup"><span data-stu-id="5725c-169">Run the page in a browser.</span></span> 

    ![](7-displaying-data-in-a-chart/_static/image9.jpg)

### <a name="using-xml-data"></a><span data-ttu-id="5725c-170">使用 XML 資料</span><span class="sxs-lookup"><span data-stu-id="5725c-170">Using XML Data</span></span>

<span data-ttu-id="5725c-171">圖表的第三個選項是使用 XML 檔案做為圖表的資料。</span><span class="sxs-lookup"><span data-stu-id="5725c-171">The third option for charting is to use an XML file as the data for the chart.</span></span> <span data-ttu-id="5725c-172">這需要 XML 檔案也有描述 XML 結構的架構檔案（ *.xsd*檔案）。</span><span class="sxs-lookup"><span data-stu-id="5725c-172">This requires that the XML file also have a schema file (*.xsd* file) that describes the XML structure.</span></span> <span data-ttu-id="5725c-173">此程式說明如何從 XML 檔案讀取資料。</span><span class="sxs-lookup"><span data-stu-id="5725c-173">This procedure shows you how to read data from an XML file.</span></span>

1. <span data-ttu-id="5725c-174">在*應用程式\_資料* 資料夾中，建立名為*Data .XML*的新 XML 檔案。</span><span class="sxs-lookup"><span data-stu-id="5725c-174">In the *App\_Data* folder, create a new XML file named *data.xml*.</span></span>
2. <span data-ttu-id="5725c-175">將現有的 XML 取代為下列，這是關於虛構公司員工的一些 XML 資料。</span><span class="sxs-lookup"><span data-stu-id="5725c-175">Replace the existing XML with the following, which is some XML data about employees in a fictional company.</span></span> 

    [!code-xml[Main](7-displaying-data-in-a-chart/samples/sample5.xml)]
3. <span data-ttu-id="5725c-176">在*應用程式\_資料* 資料夾中，建立名為*Data .XSD*的新 XML 檔案。</span><span class="sxs-lookup"><span data-stu-id="5725c-176">In the *App\_Data* folder, create a new XML file named *data.xsd*.</span></span> <span data-ttu-id="5725c-177">（請注意，這次的副檔名是 *.xsd*）。</span><span class="sxs-lookup"><span data-stu-id="5725c-177">(Note that the extension this time is *.xsd*.)</span></span>
4. <span data-ttu-id="5725c-178">以下列內容取代現有的 XML：</span><span class="sxs-lookup"><span data-stu-id="5725c-178">Replace the existing XML with the following:</span></span> 

    [!code-xml[Main](7-displaying-data-in-a-chart/samples/sample6.xml)]
5. <span data-ttu-id="5725c-179">在網站的根目錄中，建立名為*ChartDataXML*的新檔案。</span><span class="sxs-lookup"><span data-stu-id="5725c-179">In the root of the website, create a new file named *ChartDataXML.cshtml*.</span></span>
6. <span data-ttu-id="5725c-180">以下列內容取代現有的內容：</span><span class="sxs-lookup"><span data-stu-id="5725c-180">Replace the existing content with the following:</span></span> 

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample7.cshtml)]

    <span data-ttu-id="5725c-181">程式碼會先建立 `DataSet` 物件。</span><span class="sxs-lookup"><span data-stu-id="5725c-181">The code first creates a `DataSet` object.</span></span> <span data-ttu-id="5725c-182">這個物件是用來管理從 XML 檔案讀取的資料，並根據架構檔案中的資訊加以組織。</span><span class="sxs-lookup"><span data-stu-id="5725c-182">This object is used to manage the data that's read from the XML file and organize it according to the information in the schema file.</span></span> <span data-ttu-id="5725c-183">（請注意，程式碼的頂端會包含 `using SystemData`的語句。</span><span class="sxs-lookup"><span data-stu-id="5725c-183">(Notice that the top of the code includes the statement `using SystemData`.</span></span> <span data-ttu-id="5725c-184">若要能夠使用 `DataSet` 物件，這是必要的。</span><span class="sxs-lookup"><span data-stu-id="5725c-184">This is required in order to be able to work with the `DataSet` object.</span></span> <span data-ttu-id="5725c-185">如需詳細資訊，請參閱本文稍後的[使用&quot; 語句和完整限定名稱的&quot;](#SB_UsingStatements) 。）</span><span class="sxs-lookup"><span data-stu-id="5725c-185">For more information, see [&quot;Using&quot; Statements and Fully Qualified Names](#SB_UsingStatements) later in this article.)</span></span>

    <span data-ttu-id="5725c-186">接下來，程式碼會根據資料集建立 `DataView` 物件。</span><span class="sxs-lookup"><span data-stu-id="5725c-186">Next, the code creates a `DataView` object based on the dataset.</span></span> <span data-ttu-id="5725c-187">資料檢視會提供圖表可以系結&#8212;的物件，也就是 [讀取] 和 [繪製]。</span><span class="sxs-lookup"><span data-stu-id="5725c-187">The data view provides an object that the chart can bind to &#8212; that is, read and plot.</span></span> <span data-ttu-id="5725c-188">圖表會使用 `AddSeries` 方法系結至資料，如您稍早在建立陣列資料的圖表時所見，但這次 `xValue` 和 `yValues` 參數會設定為 `DataView` 物件。</span><span class="sxs-lookup"><span data-stu-id="5725c-188">The chart binds to the data using the `AddSeries` method, as you saw earlier when charting the array data, except that this time the `xValue` and `yValues` parameters are set to the `DataView` object.</span></span>

    <span data-ttu-id="5725c-189">這個範例也會示範如何指定特定的圖表類型。</span><span class="sxs-lookup"><span data-stu-id="5725c-189">This example also shows you how to specify a particular chart type.</span></span> <span data-ttu-id="5725c-190">在 `AddSeries` 方法中加入資料時，`chartType` 參數也會設定為顯示圓形圖。</span><span class="sxs-lookup"><span data-stu-id="5725c-190">When the data is added in the `AddSeries` method, the `chartType` parameter is also set to display a pie chart.</span></span>
7. <span data-ttu-id="5725c-191">在瀏覽器中執行頁面。</span><span class="sxs-lookup"><span data-stu-id="5725c-191">Run the page in a browser.</span></span> 

    ![](7-displaying-data-in-a-chart/_static/image10.jpg)

> [!TIP]
> 
> <a id="SB_UsingStatements"></a>
> ### <a name="using-statements-and-fully-qualified-names"></a><span data-ttu-id="5725c-192">"Using" 語句和完整限定名稱</span><span class="sxs-lookup"><span data-stu-id="5725c-192">"Using" Statements and Fully Qualified Names</span></span>
> 
> <span data-ttu-id="5725c-193">使用 Razor 語法 ASP.NET Web Pages 的 .NET Framework 是由數千個元件（類別）所組成。</span><span class="sxs-lookup"><span data-stu-id="5725c-193">The .NET Framework that ASP.NET Web Pages with Razor syntax is based on consists of many thousands of components (classes).</span></span> <span data-ttu-id="5725c-194">為了讓它能夠管理所有的類別，它們會組織成*命名空間*，而這些都有點類似程式庫。</span><span class="sxs-lookup"><span data-stu-id="5725c-194">To make it manageable to work with all these classes, they're organized into *namespaces*, which are somewhat like libraries.</span></span> <span data-ttu-id="5725c-195">例如，`System.Web` 命名空間包含支援瀏覽器/伺服器通訊的類別，`System.Xml` 命名空間包含用來建立和讀取 XML 檔案的類別，而 `System.Data` 命名空間包含可讓您處理資料的類別。</span><span class="sxs-lookup"><span data-stu-id="5725c-195">For example, the `System.Web` namespace contains classes that support browser/server communication, the `System.Xml` namespace contains classes that are used to create and read XML files, and the `System.Data` namespace contains classes that let you work with data.</span></span>
> 
> <span data-ttu-id="5725c-196">為了在 .NET Framework 中存取任何指定的類別，程式碼必須不只知道類別名稱，也不能知道類別所在的命名空間。</span><span class="sxs-lookup"><span data-stu-id="5725c-196">In order to access any given class in the .NET Framework, code needs to know not just the class name, but also the namespace that the class is in.</span></span> <span data-ttu-id="5725c-197">例如，若要使用 `Chart` helper，程式碼必須尋找 `System.Web.Helpers.Chart` 類別，其結合了命名空間（`System.Web.Helpers`）與類別名稱（`Chart`）。</span><span class="sxs-lookup"><span data-stu-id="5725c-197">For example, in order to use the `Chart` helper, code needs to find the `System.Web.Helpers.Chart` class, which combines the namespace (`System.Web.Helpers`) with the class name (`Chart`).</span></span> <span data-ttu-id="5725c-198">這稱為類別的完整名稱&#8212; ，在 .NET Framework 的 vastness 中，其完整且*明確的位置*。</span><span class="sxs-lookup"><span data-stu-id="5725c-198">This is known as the class's *fully-qualified* name &#8212; its complete, unambiguous location within the vastness of the .NET Framework.</span></span> <span data-ttu-id="5725c-199">在程式碼中，這看起來會像下面這樣：</span><span class="sxs-lookup"><span data-stu-id="5725c-199">In code, this would look like the following:</span></span>
> 
> `var myChart = new System.Web.Helpers.Chart(width: 600, height: 400) // etc.`
> 
> <span data-ttu-id="5725c-200">不過，每次您想要參考類別或協助程式時，都必須使用這些長的完整名稱，這很麻煩（而且容易出錯）。</span><span class="sxs-lookup"><span data-stu-id="5725c-200">However, it's cumbersome (and error prone) to have to use these long, fully-qualified names every time you want to refer to a class or helper.</span></span> <span data-ttu-id="5725c-201">因此，為了讓您更輕鬆地使用類別名稱，您可以匯*入*您感興趣的命名空間，這通常只是 .NET Framework 的多個命名空間中的少數幾個。</span><span class="sxs-lookup"><span data-stu-id="5725c-201">Therefore, to make it easier to use class names, you can *import* the namespaces you're interested in, which is usually is just a handful from among the many namespaces in the .NET Framework.</span></span> <span data-ttu-id="5725c-202">如果您已匯入命名空間，則只能使用類別名稱（`Chart`），而不是完整名稱（`System.Web.Helpers.Chart`）。</span><span class="sxs-lookup"><span data-stu-id="5725c-202">If you've imported a namespace, you can use just a class name (`Chart`) instead of the fully qualified name (`System.Web.Helpers.Chart`).</span></span> <span data-ttu-id="5725c-203">當您的程式碼執行並遇到類別名稱時，它只會查看您已匯入以尋找該類別的命名空間。</span><span class="sxs-lookup"><span data-stu-id="5725c-203">When your code runs and encounters a class name, it can look in just the namespaces you've imported to find that class.</span></span>
> 
> <span data-ttu-id="5725c-204">當您使用 ASP.NET Web Pages 搭配 Razor 語法來建立網頁時，通常會每次都使用相同的一組類別，包括 `WebPage` 類別、各種協助程式等等。</span><span class="sxs-lookup"><span data-stu-id="5725c-204">When you use ASP.NET Web Pages with Razor syntax to create web pages, you typically use the same set of classes each time, including the `WebPage` class, the various helpers, and so on.</span></span> <span data-ttu-id="5725c-205">若要在每次建立網站時儲存匯入相關命名空間的工作，請設定 ASP.NET，讓它自動匯入每個網站的一組核心命名空間。</span><span class="sxs-lookup"><span data-stu-id="5725c-205">To save you the work of importing the relevant namespaces every time you create a website, ASP.NET is configured so it automatically imports a set of core namespaces for every website.</span></span> <span data-ttu-id="5725c-206">這就是為什麼您不需要處理命名空間或匯入到目前為止;您所使用的所有類別都是在已為您匯入的命名空間中。</span><span class="sxs-lookup"><span data-stu-id="5725c-206">That's why you haven't had to deal with namespaces or importing up to now; all the classes you've worked with are in namespaces that are already imported for you.</span></span>
> 
> <span data-ttu-id="5725c-207">不過，有時候您必須使用不在自動匯入的命名空間中的類別。</span><span class="sxs-lookup"><span data-stu-id="5725c-207">However, sometimes you need to work with a class that isn't in a namespace that's automatically imported for you.</span></span> <span data-ttu-id="5725c-208">在這種情況下，您可以使用該類別的完整名稱，也可以手動匯入包含類別的命名空間。</span><span class="sxs-lookup"><span data-stu-id="5725c-208">In that case, you can either use that class's fully-qualified name, or you can manually import the namespace that contains the class.</span></span> <span data-ttu-id="5725c-209">若要匯入命名空間，您可以使用 `using` 語句（Visual Basic 中的`import`），如您在先前的範例中所見。</span><span class="sxs-lookup"><span data-stu-id="5725c-209">To import a namespace, you use the `using` statement (`import` in Visual Basic), as you saw in an example earlier the article.</span></span>
> 
> <span data-ttu-id="5725c-210">例如，`DataSet` 類別是在 `System.Data` 命名空間中。</span><span class="sxs-lookup"><span data-stu-id="5725c-210">For example, the `DataSet` class is in the `System.Data` namespace.</span></span> <span data-ttu-id="5725c-211">`System.Data` 的命名空間不會自動用於 ASP.NET Razor 頁面。</span><span class="sxs-lookup"><span data-stu-id="5725c-211">The `System.Data` namespace is not automatically available to ASP.NET Razor pages.</span></span> <span data-ttu-id="5725c-212">因此，若要使用其完整名稱來處理 `DataSet` 類別，您可以使用如下的程式碼：</span><span class="sxs-lookup"><span data-stu-id="5725c-212">Therefore, to work with the `DataSet` class using its fully qualified name, you can use code like this:</span></span>
> 
> `var dataSet = new System.Data.DataSet();`
> 
> <span data-ttu-id="5725c-213">如果您必須重複使用 `DataSet` 類別，您可以像這樣匯入命名空間，然後在程式碼中只使用類別名稱：</span><span class="sxs-lookup"><span data-stu-id="5725c-213">If you have to use the `DataSet` class repeatedly you can import a namespace like this and then use just the class name in code:</span></span>
> 
> [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample8.cshtml)]
> 
> <span data-ttu-id="5725c-214">您可以為任何其他您想要參考的 .NET Framework 命名空間加入 `using` 語句。</span><span class="sxs-lookup"><span data-stu-id="5725c-214">You can add `using` statements for any other .NET Framework namespaces that you want to reference.</span></span> <span data-ttu-id="5725c-215">不過，如上所述，您不需要經常這麼做，因為您所使用的大部分類別都是在 ASP.NET 自動匯入的命名空間中，以用於 *. cshtml*和*vbhtml*頁面。</span><span class="sxs-lookup"><span data-stu-id="5725c-215">However, as noted, you won't need to do this often, because most of the classes that you'll work with are in namespaces that are imported automatically by ASP.NET for use in *.cshtml* and *.vbhtml* pages.</span></span>

<a id="Displaying_Charts"></a>
## <a name="displaying-charts-inside-a-web-page"></a><span data-ttu-id="5725c-216">在網頁內顯示圖表</span><span class="sxs-lookup"><span data-stu-id="5725c-216">Displaying Charts Inside a Web Page</span></span>

<span data-ttu-id="5725c-217">在您到目前為止所看到的範例中，您會建立圖表，然後圖表會以圖形的形式直接轉譯至瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="5725c-217">In the examples you've seen so far, you create a chart and then the chart is rendered directly to the browser as a graphic.</span></span> <span data-ttu-id="5725c-218">不過，在許多情況下，您會想要將圖表顯示為頁面的一部分，而不只是在瀏覽器中。</span><span class="sxs-lookup"><span data-stu-id="5725c-218">In many cases, though, you want to display a chart as part of a page, not just by itself in the browser.</span></span> <span data-ttu-id="5725c-219">若要這麼做，需要兩個步驟的處理常式。</span><span class="sxs-lookup"><span data-stu-id="5725c-219">To do that requires a two-step process.</span></span> <span data-ttu-id="5725c-220">第一個步驟是建立可產生圖表的頁面，如同您已見過的。</span><span class="sxs-lookup"><span data-stu-id="5725c-220">The first step is to create a page that generates the chart, as you've already seen.</span></span>

<span data-ttu-id="5725c-221">第二個步驟是在另一個頁面中顯示產生的影像。</span><span class="sxs-lookup"><span data-stu-id="5725c-221">The second step is to display the resulting image in another page.</span></span> <span data-ttu-id="5725c-222">若要顯示影像，請使用 HTML `<img>` 專案，就像顯示任何影像一樣。</span><span class="sxs-lookup"><span data-stu-id="5725c-222">To display the image, you use an HTML `<img>` element, in the same way you would to display any image.</span></span> <span data-ttu-id="5725c-223">不過，`<img>` 專案會參考包含建立圖表之 `Chart` 協助程式的*cshtml*檔案，而不是參考 *.jpg*或 *.png*檔案。</span><span class="sxs-lookup"><span data-stu-id="5725c-223">However, instead of referencing a *.jpg* or *.png* file, the `<img>` element references the *.cshtml* file that contains the `Chart` helper that creates the chart.</span></span> <span data-ttu-id="5725c-224">當顯示頁面執行時，`<img>` 元素會取得 `Chart` helper 的輸出，並呈現圖表。</span><span class="sxs-lookup"><span data-stu-id="5725c-224">When the display page runs, the `<img>` element gets the output of the `Chart` helper and renders the chart.</span></span>

![](7-displaying-data-in-a-chart/_static/image11.jpg)

1. <span data-ttu-id="5725c-225">建立名為*ShowChart*的檔案。</span><span class="sxs-lookup"><span data-stu-id="5725c-225">Create a file named *ShowChart.cshtml*.</span></span>
2. <span data-ttu-id="5725c-226">以下列內容取代現有的內容：</span><span class="sxs-lookup"><span data-stu-id="5725c-226">Replace the existing content with the following:</span></span> 

    [!code-html[Main](7-displaying-data-in-a-chart/samples/sample9.html)]

    <span data-ttu-id="5725c-227">程式碼會使用 `<img>` 元素來顯示您稍早在*ChartArrayBasic*中建立的圖表。</span><span class="sxs-lookup"><span data-stu-id="5725c-227">The code uses the `<img>` element to display the chart that you created earlier in the *ChartArrayBasic.cshtml* file.</span></span>
3. <span data-ttu-id="5725c-228">在瀏覽器中執行網頁。</span><span class="sxs-lookup"><span data-stu-id="5725c-228">Run the web page in a browser.</span></span> <span data-ttu-id="5725c-229">*ShowChart*檔會根據*ChartArrayBasic*中包含的程式碼顯示圖表影像。</span><span class="sxs-lookup"><span data-stu-id="5725c-229">The *ShowChart.cshtml* file displays the chart image based on the code contained in the *ChartArrayBasic.cshtml* file.</span></span>

<a id="Styling_a_Chart"></a>
## <a name="styling-a-chart"></a><span data-ttu-id="5725c-230">設定圖表的樣式</span><span class="sxs-lookup"><span data-stu-id="5725c-230">Styling a Chart</span></span>

<span data-ttu-id="5725c-231">`Chart` helper 支援大量選項，可讓您自訂圖表的外觀。</span><span class="sxs-lookup"><span data-stu-id="5725c-231">The `Chart` helper supports a large number of options that let you customize the appearance of the chart.</span></span> <span data-ttu-id="5725c-232">您可以設定色彩、字型、框線等等。</span><span class="sxs-lookup"><span data-stu-id="5725c-232">You can set colors, fonts, borders, and so on.</span></span> <span data-ttu-id="5725c-233">自訂圖表外觀的簡單方法是使用*主題*。</span><span class="sxs-lookup"><span data-stu-id="5725c-233">An easy way to customize the appearance of a chart is to use a *theme*.</span></span> <span data-ttu-id="5725c-234">佈景主題是指定如何使用字型、色彩、標籤、調色盤、框線和效果來呈現圖表的資訊集合。</span><span class="sxs-lookup"><span data-stu-id="5725c-234">Themes are collections of information that specify how to render a chart using fonts, colors, labels, palettes, borders, and effects.</span></span> <span data-ttu-id="5725c-235">（請注意，圖表的樣式並不表示圖表的類型）。</span><span class="sxs-lookup"><span data-stu-id="5725c-235">(Note that the style of a chart does not indicate the type of chart.)</span></span>

<span data-ttu-id="5725c-236">下表列出內建主題。</span><span class="sxs-lookup"><span data-stu-id="5725c-236">The following table lists built-in themes.</span></span>

| <span data-ttu-id="5725c-237">佈景主題</span><span class="sxs-lookup"><span data-stu-id="5725c-237">Theme</span></span> | <span data-ttu-id="5725c-238">說明</span><span class="sxs-lookup"><span data-stu-id="5725c-238">Description</span></span> |
| --- | --- |
| `Vanilla` | <span data-ttu-id="5725c-239">在白色背景上顯示紅色資料行。</span><span class="sxs-lookup"><span data-stu-id="5725c-239">Displays red columns on a white background.</span></span> |
| `Blue` | <span data-ttu-id="5725c-240">在藍色漸層背景上顯示藍色資料行。</span><span class="sxs-lookup"><span data-stu-id="5725c-240">Displays blue columns on a blue gradient background.</span></span> |
| `Green` | <span data-ttu-id="5725c-241">在綠色漸層背景上顯示藍色資料行。</span><span class="sxs-lookup"><span data-stu-id="5725c-241">Displays blue columns on a green gradient background.</span></span> |
| `Yellow` | <span data-ttu-id="5725c-242">在黃色漸層背景上顯示橙色資料行。</span><span class="sxs-lookup"><span data-stu-id="5725c-242">Displays orange columns on a yellow gradient background.</span></span> |
| `Vanilla3D` | <span data-ttu-id="5725c-243">在白色背景上顯示立體紅色資料行。</span><span class="sxs-lookup"><span data-stu-id="5725c-243">Displays 3-D red columns on a white background.</span></span> |

<span data-ttu-id="5725c-244">您可以指定要在建立新圖表時使用的主題。</span><span class="sxs-lookup"><span data-stu-id="5725c-244">You can specify the theme to use when you create a new chart.</span></span>

1. <span data-ttu-id="5725c-245">建立名為*ChartStyleGreen*的新檔案。</span><span class="sxs-lookup"><span data-stu-id="5725c-245">Create a new file named *ChartStyleGreen.cshtml*.</span></span>
2. <span data-ttu-id="5725c-246">將頁面中的現有內容取代為下列內容：</span><span class="sxs-lookup"><span data-stu-id="5725c-246">Replace the existing content in the page with the following:</span></span>

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample10.cshtml)]

    <span data-ttu-id="5725c-247">這段程式碼與先前使用資料庫來進行資料的範例相同，但會在建立 `Chart` 物件時加入 `theme` 參數。</span><span class="sxs-lookup"><span data-stu-id="5725c-247">This code is the same as the earlier example that uses the database for data, but adds the `theme` parameter when it creates the `Chart` object.</span></span> <span data-ttu-id="5725c-248">以下顯示已變更的程式碼：</span><span class="sxs-lookup"><span data-stu-id="5725c-248">The following shows the changed code:</span></span>

    [!code-csharp[Main](7-displaying-data-in-a-chart/samples/sample11.cs)]
3. <span data-ttu-id="5725c-249">在瀏覽器中執行頁面。</span><span class="sxs-lookup"><span data-stu-id="5725c-249">Run the page in a browser.</span></span> <span data-ttu-id="5725c-250">您會看到與之前相同的資料，但圖表看起來更美觀：</span><span class="sxs-lookup"><span data-stu-id="5725c-250">You see the same data as before, but the chart looks more polished:</span></span> 

    ![](7-displaying-data-in-a-chart/_static/image12.jpg)

<a id="Saving_a_Chart"></a>
## <a name="saving-a-chart"></a><span data-ttu-id="5725c-251">儲存圖表</span><span class="sxs-lookup"><span data-stu-id="5725c-251">Saving a Chart</span></span>

<span data-ttu-id="5725c-252">當您使用這篇文章中所見到的 `Chart` helper 時，協助專家會在每次叫用時從頭重新建立圖表。</span><span class="sxs-lookup"><span data-stu-id="5725c-252">When you use the `Chart` helper as you've seen so far in this article, the helper re-creates the chart from scratch each time it's invoked.</span></span> <span data-ttu-id="5725c-253">如有必要，圖表的程式碼也會重新查詢資料庫，或重新讀取 XML 檔案以取得資料。</span><span class="sxs-lookup"><span data-stu-id="5725c-253">If necessary, the code for the chart also re-queries the database or re-reads the XML file to get the data.</span></span> <span data-ttu-id="5725c-254">在某些情況下，執行這項作業可能是一項複雜的作業，例如，如果您查詢的資料庫很大，或 XML 檔案包含大量資料。</span><span class="sxs-lookup"><span data-stu-id="5725c-254">In some cases, doing this can be a complex operation, such as if the database that you're querying is large, or if the XML file contains a lot of data.</span></span> <span data-ttu-id="5725c-255">即使圖表不包含大量資料，以動態方式建立影像的程式還是會佔用伺服器資源，如果有許多人要求顯示圖表的頁面，可能會影響網站的效能。</span><span class="sxs-lookup"><span data-stu-id="5725c-255">Even if the chart doesn't involve a lot of data, the process of dynamically creating an image takes up server resources, and if many people request the page or pages that display the chart, there can be an impact on the performance of your website.</span></span>

<span data-ttu-id="5725c-256">為了協助您減少建立圖表的潛在效能影響，您可以在第一次需要時建立圖表，然後加以儲存。</span><span class="sxs-lookup"><span data-stu-id="5725c-256">To help you reduce the potential performance impact of creating a chart, you can create a chart the first time you need it and then save it.</span></span> <span data-ttu-id="5725c-257">再次需要圖表時，您可以直接提取已儲存的版本，然後再進行轉譯，而不是重新產生。</span><span class="sxs-lookup"><span data-stu-id="5725c-257">When the chart is needed again, rather than regenerating it, you can just fetch the saved version and render that.</span></span>

<span data-ttu-id="5725c-258">您可以使用下列方式來儲存圖表：</span><span class="sxs-lookup"><span data-stu-id="5725c-258">You can save a chart in these ways:</span></span>

- <span data-ttu-id="5725c-259">將圖表快取在電腦記憶體中（在伺服器上）。</span><span class="sxs-lookup"><span data-stu-id="5725c-259">Cache the chart in computer memory (on the server).</span></span>
- <span data-ttu-id="5725c-260">將圖表儲存為影像檔案。</span><span class="sxs-lookup"><span data-stu-id="5725c-260">Save the chart as an image file.</span></span>
- <span data-ttu-id="5725c-261">將圖表儲存為 XML 檔案。</span><span class="sxs-lookup"><span data-stu-id="5725c-261">Save the chart as an XML file.</span></span> <span data-ttu-id="5725c-262">此選項可讓您在儲存圖表之前先加以修改。</span><span class="sxs-lookup"><span data-stu-id="5725c-262">This option lets you modify the chart before you save it.</span></span>

### <a name="caching-a-chart"></a><span data-ttu-id="5725c-263">快取圖表</span><span class="sxs-lookup"><span data-stu-id="5725c-263">Caching a Chart</span></span>

<span data-ttu-id="5725c-264">建立圖表之後，您就可以快取它。</span><span class="sxs-lookup"><span data-stu-id="5725c-264">After you've created a chart, you can cache it.</span></span> <span data-ttu-id="5725c-265">快取圖表表示如果需要再次顯示，則不需要重新建立。</span><span class="sxs-lookup"><span data-stu-id="5725c-265">Caching a chart means that it doesn't have to be re-created if it needs to be displayed again.</span></span> <span data-ttu-id="5725c-266">當您將圖表儲存在快取中時，您可以為它提供一個對該圖表而言必須是唯一的索引鍵。</span><span class="sxs-lookup"><span data-stu-id="5725c-266">When you save a chart in the cache, you give it a key that must be unique to that chart.</span></span>

<span data-ttu-id="5725c-267">如果伺服器的記憶體不足，可能會移除儲存至快取的圖表。</span><span class="sxs-lookup"><span data-stu-id="5725c-267">Charts saved to the cache might be removed if the server runs low on memory.</span></span> <span data-ttu-id="5725c-268">此外，如果您的應用程式因為任何原因而重新開機，則會清除快取。</span><span class="sxs-lookup"><span data-stu-id="5725c-268">In addition, the cache is cleared if your application restarts for any reason.</span></span> <span data-ttu-id="5725c-269">因此，使用快取圖表的標準方式是一律先檢查它是否可在快取中使用，如果沒有，則建立或重新建立。</span><span class="sxs-lookup"><span data-stu-id="5725c-269">Therefore, the standard way to work with a cached chart is to always check first whether it's available in the cache, and if not, then to create or re-create it.</span></span>

1. <span data-ttu-id="5725c-270">在您網站的根目錄中，建立名為*ShowCachedChart*的檔案。</span><span class="sxs-lookup"><span data-stu-id="5725c-270">At the root of your website, create a file named *ShowCachedChart.cshtml*.</span></span>
2. <span data-ttu-id="5725c-271">以下列內容取代現有的內容：</span><span class="sxs-lookup"><span data-stu-id="5725c-271">Replace the existing content with the following:</span></span> 

    [!code-html[Main](7-displaying-data-in-a-chart/samples/sample12.html)]

    <span data-ttu-id="5725c-272">`<img>` 標記包含指向*ChartSaveToCache*的 `src` 屬性，並將金鑰當做查詢字串傳遞至頁面。</span><span class="sxs-lookup"><span data-stu-id="5725c-272">The `<img>` tag includes a `src` attribute that points to the *ChartSaveToCache.cshtml* file and passes a key to the page as a query string.</span></span> <span data-ttu-id="5725c-273">此索引鍵包含 &quot;myChartKey&quot;的值。</span><span class="sxs-lookup"><span data-stu-id="5725c-273">The key contains the value &quot;myChartKey&quot;.</span></span> <span data-ttu-id="5725c-274">*ChartSaveToCache*檔案包含建立圖表的 `Chart` helper。</span><span class="sxs-lookup"><span data-stu-id="5725c-274">The *ChartSaveToCache.cshtml* file contains the `Chart` helper that creates the chart.</span></span> <span data-ttu-id="5725c-275">您稍後會建立此頁面。</span><span class="sxs-lookup"><span data-stu-id="5725c-275">You'll create this page in a moment.</span></span>

    <span data-ttu-id="5725c-276">頁面結尾有一個名為*ClearCache*的頁面連結。</span><span class="sxs-lookup"><span data-stu-id="5725c-276">At the end of the page there's a link to a page named *ClearCache.cshtml*.</span></span> <span data-ttu-id="5725c-277">這也是您很快就會建立的頁面。</span><span class="sxs-lookup"><span data-stu-id="5725c-277">That's a page that you'll also create shortly.</span></span> <span data-ttu-id="5725c-278">在此範例中，您只需要使用*ClearCache*來測試快取，這不是您在使用快取圖表時通常會包含的連結或頁面。</span><span class="sxs-lookup"><span data-stu-id="5725c-278">You need the *ClearCache.cshtml* only to test caching for this example — it's not a link or page that you'd normally include when working with cached charts.</span></span>
3. <span data-ttu-id="5725c-279">在您網站的根目錄中，建立名為*ChartSaveToCache*的新檔案。</span><span class="sxs-lookup"><span data-stu-id="5725c-279">At the root of your website, create a new file named *ChartSaveToCache.cshtml*.</span></span>
4. <span data-ttu-id="5725c-280">以下列內容取代現有的內容：</span><span class="sxs-lookup"><span data-stu-id="5725c-280">Replace the existing content with the following:</span></span>

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample13.cshtml)]

    <span data-ttu-id="5725c-281">程式碼會先檢查是否已將任何內容當做索引鍵值傳遞至查詢字串中。</span><span class="sxs-lookup"><span data-stu-id="5725c-281">The code first checks whether anything was passed as the key value in the query string.</span></span> <span data-ttu-id="5725c-282">若是如此，程式碼就會呼叫 `GetFromCache` 方法並傳遞金鑰給它，以嘗試從快取讀取圖表。</span><span class="sxs-lookup"><span data-stu-id="5725c-282">If so, the code tries to read a chart out of the cache by calling the `GetFromCache` method and passing it the key.</span></span> <span data-ttu-id="5725c-283">如果快取中沒有該索引鍵下的任何內容（這會在第一次要求圖表時發生），則程式碼會如往常般建立圖表。</span><span class="sxs-lookup"><span data-stu-id="5725c-283">If it turns out that there's nothing in the cache under that key (which would happen the first time that the chart is requested), the code creates the chart as usual.</span></span> <span data-ttu-id="5725c-284">當圖表完成時，程式碼會藉由呼叫 `SaveToCache`，將它儲存至快取。</span><span class="sxs-lookup"><span data-stu-id="5725c-284">When the chart is finished, the code saves it to the cache by calling `SaveToCache`.</span></span> <span data-ttu-id="5725c-285">該方法需要金鑰（如此一來，您可以稍後再要求圖表）和圖表儲存在快取中的時間量。</span><span class="sxs-lookup"><span data-stu-id="5725c-285">That method requires a key (so the chart can be requested later), and the amount of time that the chart should be saved in the cache.</span></span> <span data-ttu-id="5725c-286">（您快取圖表的確切時間取決於您認為它所代表的資料可能會變更的頻率）。如果這是設定為 true，`SaveToCache` &#8212;方法也需要 `slidingExpiration` 參數，則每次存取圖表時，就會重設 timeout 計數器。</span><span class="sxs-lookup"><span data-stu-id="5725c-286">(The exact time you'd cache a chart would depend on how often you thought the data it represents might change.) The `SaveToCache` method also requires a `slidingExpiration` parameter &#8212; if this is set to true, the timeout counter is reset each time the chart is accessed.</span></span> <span data-ttu-id="5725c-287">在此情況下，其作用表示圖表的快取專案會在上一次有人存取圖表之後的2分鐘後到期。</span><span class="sxs-lookup"><span data-stu-id="5725c-287">In this case, it in effect means that the chart's cache entry expires 2 minutes after the last time someone accessed the chart.</span></span> <span data-ttu-id="5725c-288">（滑動到期的替代方案為絕對到期日，這表示快取專案在放入快取後的2分鐘內就會剛好過期，無論存取的頻率為何）。</span><span class="sxs-lookup"><span data-stu-id="5725c-288">(The alternative to sliding expiration is absolute expiration, meaning that the cache entry would expire exactly 2 minutes after it was put into the cache, no matter how often it had been accessed.)</span></span>

    <span data-ttu-id="5725c-289">最後，程式碼會使用 `WriteFromCache` 方法，從快取中提取並轉譯圖表。</span><span class="sxs-lookup"><span data-stu-id="5725c-289">Finally, the code uses the `WriteFromCache` method to fetch and render the chart from the cache.</span></span> <span data-ttu-id="5725c-290">請注意，這個方法是在檢查快取的 `if` 區塊外，因為它會從快取中取得圖表，無論圖表是從何處開始，還是必須產生並儲存在快取中。</span><span class="sxs-lookup"><span data-stu-id="5725c-290">Note that this method is outside the `if` block that checks the cache, because it will get the chart from the cache whether the chart was there to begin with or had to be generated and saved in the cache.</span></span>

    <span data-ttu-id="5725c-291">請注意，在此範例中，`AddTitle` 方法包含時間戳記。</span><span class="sxs-lookup"><span data-stu-id="5725c-291">Notice that in the example, the `AddTitle` method includes a timestamp.</span></span> <span data-ttu-id="5725c-292">（它會將目前的日期和&#8212;時間&#8212; `DateTime.Now` 新增至標題）。</span><span class="sxs-lookup"><span data-stu-id="5725c-292">(It adds the current date and time &#8212; `DateTime.Now` &#8212; to the title.)</span></span>
5. <span data-ttu-id="5725c-293">建立名為*ClearCache*的新頁面，並將其內容取代為下列內容：</span><span class="sxs-lookup"><span data-stu-id="5725c-293">Create a new page named *ClearCache.cshtml* and replace its content with the following:</span></span>

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample14.cshtml)]

    <span data-ttu-id="5725c-294">此頁面會使用 `WebCache` helper 來移除*ChartSaveToCache*中快取的圖表。</span><span class="sxs-lookup"><span data-stu-id="5725c-294">This page uses the `WebCache` helper to remove the chart that's cached in *ChartSaveToCache.cshtml*.</span></span> <span data-ttu-id="5725c-295">如先前所述，您通常不需要像這樣的頁面。</span><span class="sxs-lookup"><span data-stu-id="5725c-295">As noted earlier, you don't normally have to have a page like this.</span></span> <span data-ttu-id="5725c-296">您只需要在這裡建立，就能更輕鬆地測試快取。</span><span class="sxs-lookup"><span data-stu-id="5725c-296">You're creating it here only to make it easier to test caching.</span></span>
6. <span data-ttu-id="5725c-297">在瀏覽器中執行*ShowCachedChart。*</span><span class="sxs-lookup"><span data-stu-id="5725c-297">Run the *ShowCachedChart.cshtml* web page in a browser.</span></span> <span data-ttu-id="5725c-298">頁面會根據*ChartSaveToCache*中包含的程式碼顯示圖表影像。</span><span class="sxs-lookup"><span data-stu-id="5725c-298">The page displays the chart image based on the code contained in the *ChartSaveToCache.cshtml* file.</span></span> <span data-ttu-id="5725c-299">記下 [圖表標題] 中的時間戳記。</span><span class="sxs-lookup"><span data-stu-id="5725c-299">Take note of what the timestamp says in the chart title.</span></span> 

    ![描述：圖表標題中包含時間戳記之基本圖表的圖片](7-displaying-data-in-a-chart/_static/image13.jpg)
7. <span data-ttu-id="5725c-301">關閉瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="5725c-301">Close the browser.</span></span>
8. <span data-ttu-id="5725c-302">再次執行*ShowCachedChart* 。</span><span class="sxs-lookup"><span data-stu-id="5725c-302">Run the *ShowCachedChart.cshtml* again.</span></span> <span data-ttu-id="5725c-303">請注意，時間戳記與之前相同，這表示圖表並未重新產生，而是改為從快取讀取。</span><span class="sxs-lookup"><span data-stu-id="5725c-303">Notice that the timestamp is the same as before, which indicates that the chart was not regenerated, but was instead read from the cache.</span></span>
9. <span data-ttu-id="5725c-304">在 [ *ShowCachedChart*] 中，按一下 [**清除**快取] 連結。</span><span class="sxs-lookup"><span data-stu-id="5725c-304">In *ShowCachedChart.cshtml*, click the **Clear cache** link.</span></span> <span data-ttu-id="5725c-305">這會帶您前往*ClearCache*，這會報告快取已清除。</span><span class="sxs-lookup"><span data-stu-id="5725c-305">This takes you to *ClearCache.cshtml*, which reports that the cache has been cleared.</span></span>
10. <span data-ttu-id="5725c-306">按一下 [**返回 ShowCachedChart** ] 連結，或從 WebMatrix 重新執行*ShowCachedChart。*</span><span class="sxs-lookup"><span data-stu-id="5725c-306">Click the **Return to ShowCachedChart.cshtml** link, or re-run *ShowCachedChart.cshtml* from WebMatrix.</span></span> <span data-ttu-id="5725c-307">請注意，這次時間戳記已變更，因為快取已清除。</span><span class="sxs-lookup"><span data-stu-id="5725c-307">Notice that this time the timestamp has changed, because the cache has been cleared.</span></span> <span data-ttu-id="5725c-308">因此，程式碼必須重新產生圖表，並將它放回快取中。</span><span class="sxs-lookup"><span data-stu-id="5725c-308">Therefore, the code had to regenerate the chart and put it back into the cache.</span></span>

### <a name="saving-a-chart-as-an-image-file"></a><span data-ttu-id="5725c-309">將圖表儲存為影像檔案</span><span class="sxs-lookup"><span data-stu-id="5725c-309">Saving a Chart as an Image File</span></span>

<span data-ttu-id="5725c-310">您也可以在伺服器上將圖表儲存為影像檔案（例如，做為 *.jpg*檔案）。</span><span class="sxs-lookup"><span data-stu-id="5725c-310">You can also save a chart as an image file (for example, as a *.jpg* file) on the server.</span></span> <span data-ttu-id="5725c-311">接著，您可以用您對任何影像的方式來使用影像檔案。</span><span class="sxs-lookup"><span data-stu-id="5725c-311">You can then use the image file the way you would any image.</span></span> <span data-ttu-id="5725c-312">其優點是儲存檔案，而不是儲存至暫時快取。</span><span class="sxs-lookup"><span data-stu-id="5725c-312">The advantage is the file is stored rather than saved to a temporary cache.</span></span> <span data-ttu-id="5725c-313">您可以在不同的時間儲存新的圖表影像（例如，每小時），然後保留一段時間後所發生變更的永久記錄。</span><span class="sxs-lookup"><span data-stu-id="5725c-313">You can save a new chart image at different times (for example, every hour) and then keep a permanent record of the changes that occur over time.</span></span> <span data-ttu-id="5725c-314">請注意，您必須確定您的 web 應用程式有許可權將檔案儲存至您要放置影像檔的伺服器上的資料夾。</span><span class="sxs-lookup"><span data-stu-id="5725c-314">Note that you must make sure that your web application has permission to save a file to the folder on the server where you want to put the image file.</span></span>

1. <span data-ttu-id="5725c-315">在您網站的根目錄中，建立名為 *\_ChartFiles*的資料夾（如果尚未存在的話）。</span><span class="sxs-lookup"><span data-stu-id="5725c-315">At the root of your website, create a folder named *\_ChartFiles* if it does not already exist.</span></span>
2. <span data-ttu-id="5725c-316">在您網站的根目錄中，建立名為*ChartSave*的新檔案。</span><span class="sxs-lookup"><span data-stu-id="5725c-316">At the root of your website, create a new file named *ChartSave.cshtml*.</span></span>
3. <span data-ttu-id="5725c-317">以下列內容取代現有的內容：</span><span class="sxs-lookup"><span data-stu-id="5725c-317">Replace the existing content with the following:</span></span>

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample15.cshtml)]

    <span data-ttu-id="5725c-318">程式碼會先藉由呼叫 `File.Exists` 方法，檢查 *.jpg*檔案是否存在。</span><span class="sxs-lookup"><span data-stu-id="5725c-318">The code first checks to see whether the *.jpg* file exists by calling the `File.Exists` method.</span></span> <span data-ttu-id="5725c-319">如果檔案不存在，則程式碼會從陣列建立新的 `Chart`。</span><span class="sxs-lookup"><span data-stu-id="5725c-319">If the file does not exist, the code creates a new `Chart` from an array.</span></span> <span data-ttu-id="5725c-320">此時，程式碼會呼叫 `Save` 方法並傳遞 `path` 參數，以指定要儲存圖表之位置的檔案路徑和檔案名。</span><span class="sxs-lookup"><span data-stu-id="5725c-320">This time, the code calls the `Save` method and passes the `path` parameter to specify the file path and file name of where to save the chart.</span></span> <span data-ttu-id="5725c-321">在頁面主體中，`<img>` 元素會使用路徑指向要顯示的 *.jpg*檔案。</span><span class="sxs-lookup"><span data-stu-id="5725c-321">In the body of the page, an `<img>` element uses the path to point to the *.jpg* file to display.</span></span>
4. <span data-ttu-id="5725c-322">執行*ChartSave。*</span><span class="sxs-lookup"><span data-stu-id="5725c-322">Run the *ChartSave.cshtml* file.</span></span>
5. <span data-ttu-id="5725c-323">返回 WebMatrix。</span><span class="sxs-lookup"><span data-stu-id="5725c-323">Return to WebMatrix.</span></span> <span data-ttu-id="5725c-324">請注意，名為*chart01*的影像檔已經儲存在 *\_ChartFiles*資料夾中。</span><span class="sxs-lookup"><span data-stu-id="5725c-324">Notice that an image file named *chart01.jpg* has been saved in the *\_ChartFiles* folder.</span></span>

### <a name="saving-a-chart-as-an-xml-file"></a><span data-ttu-id="5725c-325">將圖表儲存為 XML 檔案</span><span class="sxs-lookup"><span data-stu-id="5725c-325">Saving a Chart as an XML File</span></span>

<span data-ttu-id="5725c-326">最後，您可以將圖表儲存為伺服器上的 XML 檔案。</span><span class="sxs-lookup"><span data-stu-id="5725c-326">Finally, you can save a chart as an XML file on the server.</span></span> <span data-ttu-id="5725c-327">使用此方法來快取圖表或將圖表儲存至檔案的優點是，您可以在需要時修改 XML，然後才顯示圖表。</span><span class="sxs-lookup"><span data-stu-id="5725c-327">An advantage of using this method over caching the chart or saving the chart to a file is that you could modify the XML before displaying the chart if you wanted to.</span></span> <span data-ttu-id="5725c-328">您的應用程式必須具有您要放置影像檔之伺服器上資料夾的讀取/寫入權限。</span><span class="sxs-lookup"><span data-stu-id="5725c-328">Your application has to have read/write permissions for the folder on the server where you want to put the image file.</span></span>

1. <span data-ttu-id="5725c-329">在您網站的根目錄中，建立名為*ChartSaveXml*的新檔案。</span><span class="sxs-lookup"><span data-stu-id="5725c-329">At the root of your website, create a new file named *ChartSaveXml.cshtml*.</span></span>
2. <span data-ttu-id="5725c-330">以下列內容取代現有的內容：</span><span class="sxs-lookup"><span data-stu-id="5725c-330">Replace the existing content with the following:</span></span>

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample16.cshtml)]

    <span data-ttu-id="5725c-331">此程式碼類似于您稍早在快取中儲存圖表所看到的程式碼，但它使用 XML 檔案。</span><span class="sxs-lookup"><span data-stu-id="5725c-331">This code is similar to the code that you saw earlier for storing a chart in the cache, except that it uses an XML file.</span></span> <span data-ttu-id="5725c-332">程式碼會先藉由呼叫 `File.Exists` 方法，檢查 XML 檔案是否存在。</span><span class="sxs-lookup"><span data-stu-id="5725c-332">The code first checks to see whether the XML file exists by calling the `File.Exists` method.</span></span> <span data-ttu-id="5725c-333">如果檔案存在，則程式碼會建立新的 `Chart` 物件，並將檔案名當做 `themePath` 參數傳遞。</span><span class="sxs-lookup"><span data-stu-id="5725c-333">If the file does exist, the code creates a new `Chart` object and passes the file name as the `themePath` parameter.</span></span> <span data-ttu-id="5725c-334">這會根據 XML 檔案中的任何內容來建立圖表。</span><span class="sxs-lookup"><span data-stu-id="5725c-334">This creates the chart based on whatever's in the XML file.</span></span> <span data-ttu-id="5725c-335">如果 XML 檔案尚未存在，則程式碼會建立類似一般的圖表，然後呼叫 `SaveXml` 加以儲存。</span><span class="sxs-lookup"><span data-stu-id="5725c-335">If the XML file doesn't already exist, the code creates a chart like normal and then calls `SaveXml` to save it.</span></span> <span data-ttu-id="5725c-336">圖表是使用 `Write` 方法來呈現，如先前所見。</span><span class="sxs-lookup"><span data-stu-id="5725c-336">The chart is rendered using the `Write` method, as you've seen before.</span></span>

    <span data-ttu-id="5725c-337">如同顯示快取的頁面，此程式碼會在圖表標題中包含時間戳記。</span><span class="sxs-lookup"><span data-stu-id="5725c-337">As with the page that showed caching, this code includes a timestamp in the chart title.</span></span>
3. <span data-ttu-id="5725c-338">建立名為*ChartDisplayXMLChart*的新頁面，並在其中加入下列標記：</span><span class="sxs-lookup"><span data-stu-id="5725c-338">Create a new page named *ChartDisplayXMLChart.cshtml* and add the following markup to it:</span></span> 

    [!code-html[Main](7-displaying-data-in-a-chart/samples/sample17.html)]
4. <span data-ttu-id="5725c-339">執行 [ *ChartDisplayXMLChart* ] 頁面。</span><span class="sxs-lookup"><span data-stu-id="5725c-339">Run the *ChartDisplayXMLChart.cshtml* page.</span></span> <span data-ttu-id="5725c-340">圖表隨即顯示。</span><span class="sxs-lookup"><span data-stu-id="5725c-340">The chart is displayed.</span></span> <span data-ttu-id="5725c-341">記下圖表標題中的時間戳記。</span><span class="sxs-lookup"><span data-stu-id="5725c-341">Take note of the timestamp in the chart's title.</span></span>
5. <span data-ttu-id="5725c-342">關閉瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="5725c-342">Close the browser.</span></span>
6. <span data-ttu-id="5725c-343">在 WebMatrix 中，以滑鼠右鍵按一下 [ *\_ChartFiles* ] 資料夾 **，按一下 [** 重新整理]，然後開啟資料夾。</span><span class="sxs-lookup"><span data-stu-id="5725c-343">In WebMatrix, right-click the *\_ChartFiles* folder, click **Refresh**, and then open the folder.</span></span> <span data-ttu-id="5725c-344">此資料夾中的*XMLChart*是由 `Chart` helper 所建立。</span><span class="sxs-lookup"><span data-stu-id="5725c-344">The *XMLChart.xml* file in this folder was created by the `Chart` helper.</span></span> 

    ![描述：顯示圖表協助程式所建立之 XMLChart 的 [_ChartFiles] 資料夾。](7-displaying-data-in-a-chart/_static/image14.jpg)
7. <span data-ttu-id="5725c-346">再次執行 [ *ChartDisplayXMLChart* ] 頁面。</span><span class="sxs-lookup"><span data-stu-id="5725c-346">Run the *ChartDisplayXMLChart.cshtml* page again.</span></span> <span data-ttu-id="5725c-347">圖表會顯示與您第一次執行頁面時相同的時間戳記。</span><span class="sxs-lookup"><span data-stu-id="5725c-347">The chart shows the same timestamp as the first time you ran the page.</span></span> <span data-ttu-id="5725c-348">這是因為圖表是從您稍早儲存的 XML 產生的。</span><span class="sxs-lookup"><span data-stu-id="5725c-348">That's because the chart is being generated from the XML you saved earlier.</span></span>
8. <span data-ttu-id="5725c-349">在 WebMatrix 中，開啟 [ *\_ChartFiles* ] 資料夾，並刪除*XMLChart*檔案。</span><span class="sxs-lookup"><span data-stu-id="5725c-349">In WebMatrix, open the *\_ChartFiles* folder and delete the *XMLChart.xml* file.</span></span>
9. <span data-ttu-id="5725c-350">再次執行*ChartDisplayXMLChart*一頁。</span><span class="sxs-lookup"><span data-stu-id="5725c-350">Run the *ChartDisplayXMLChart.cshtml* page once more.</span></span> <span data-ttu-id="5725c-351">此時，時間戳記會更新，因為 `Chart` helper 必須重新建立 XML 檔案。</span><span class="sxs-lookup"><span data-stu-id="5725c-351">This time, the timestamp is updated, because the `Chart` helper had to recreate the XML file.</span></span> <span data-ttu-id="5725c-352">如果您想要的話，請檢查 *\_ChartFiles*資料夾，並注意 XML 檔案已回傳。</span><span class="sxs-lookup"><span data-stu-id="5725c-352">If you want, check the *\_ChartFiles* folder and notice that the XML file is back.</span></span>

<a id="Additional_Resources"></a>
## <a name="additional-resources"></a><span data-ttu-id="5725c-353">其他資源</span><span class="sxs-lookup"><span data-stu-id="5725c-353">Additional Resources</span></span>

- [<span data-ttu-id="5725c-354">在 ASP.NET Web Pages 網站中使用資料庫的簡介</span><span class="sxs-lookup"><span data-stu-id="5725c-354">Introduction to Working with a Database in ASP.NET Web Pages Sites</span></span>](https://go.microsoft.com/fwlink/?LinkId=202893)
- [<span data-ttu-id="5725c-355">在 ASP.NET Web Pages 的網站中使用快取來改善效能</span><span class="sxs-lookup"><span data-stu-id="5725c-355">Using Caching in ASP.NET Web Pages Sites to Improve Performance</span></span>](https://go.microsoft.com/fwlink/?LinkId=202903)
- <span data-ttu-id="5725c-356">[圖表類別](https://msdn.microsoft.com/library/system.web.helpers.chart(v=vs.99))（MSDN 上的 ASP.NET Web Pages API 參考）</span><span class="sxs-lookup"><span data-stu-id="5725c-356">[Chart Class](https://msdn.microsoft.com/library/system.web.helpers.chart(v=vs.99)) (ASP.NET Web Pages API reference on MSDN)</span></span>
