---
uid: web-forms/overview/data-access/filtering-scenarios-with-the-datalist-and-repeater/master-detail-filtering-acess-two-pages-datalist-cs
title: 跨兩個頁面的主要/詳細C#資料篩選（） |Microsoft Docs
author: rick-anderson
description: 在本教學課程中，我們將探討如何跨兩個頁面分隔主要/詳細資料包表。 在 [主要] 頁面中，我們使用重複項控制項來呈現 categ 的清單 。
ms.author: riande
ms.date: 10/30/2010
ms.assetid: 68b8c023-92fa-4df6-9563-1764e16e4b04
msc.legacyurl: /web-forms/overview/data-access/filtering-scenarios-with-the-datalist-and-repeater/master-detail-filtering-acess-two-pages-datalist-cs
msc.type: authoredcontent
ms.openlocfilehash: 545b24a66476c55aff88ac62d3a6528105fea6c0
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/06/2020
ms.locfileid: "78607076"
---
# <a name="masterdetail-filtering-across-two-pages-c"></a><span data-ttu-id="5f878-104">跨兩個頁面進行主要/詳細資料篩選 (C#)</span><span class="sxs-lookup"><span data-stu-id="5f878-104">Master/Detail Filtering Across Two Pages (C#)</span></span>

<span data-ttu-id="5f878-105">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="5f878-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="5f878-106">[下載範例應用程式](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_34_CS.exe)或[下載 PDF](master-detail-filtering-acess-two-pages-datalist-cs/_static/datatutorial34cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="5f878-106">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_34_CS.exe) or [Download PDF](master-detail-filtering-acess-two-pages-datalist-cs/_static/datatutorial34cs1.pdf)</span></span>

> <span data-ttu-id="5f878-107">在本教學課程中，我們將探討如何跨兩個頁面分隔主要/詳細資料包表。</span><span class="sxs-lookup"><span data-stu-id="5f878-107">In this tutorial we look at how to separate a master/detail report across two pages.</span></span> <span data-ttu-id="5f878-108">在 [主要] 頁面中，我們使用「中繼器」控制項來轉譯類別目錄清單，當按下時，會將使用者帶到「詳細資料」頁面，其中的兩個數據行 DataList 會顯示屬於所選類別目錄的產品。</span><span class="sxs-lookup"><span data-stu-id="5f878-108">In the "master" page we use a Repeater control to render a list of categories that, when clicked, will take the user to the "details" page where a two-column DataList shows those products belonging to the selected category.</span></span>

## <a name="introduction"></a><span data-ttu-id="5f878-109">簡介</span><span class="sxs-lookup"><span data-stu-id="5f878-109">Introduction</span></span>

<span data-ttu-id="5f878-110">在[先前的教學](master-detail-filtering-with-a-dropdownlist-datalist-cs.md)課程中，我們已瞭解如何在單一網頁中顯示主要/詳細資料包表，使用 dropdownlist 進行來顯示「主要」記錄和 DataList 來顯示「詳細資料」。</span><span class="sxs-lookup"><span data-stu-id="5f878-110">In the [preceding tutorial](master-detail-filtering-with-a-dropdownlist-datalist-cs.md) we saw how to display master/detail reports in a single web page using DropDownLists to display the "master" records and a DataList to display the "details."</span></span> <span data-ttu-id="5f878-111">主要/詳細資料包表使用的另一個常見模式是在一個網頁上擁有主要記錄，並在另一個頁面上提供詳細資料。</span><span class="sxs-lookup"><span data-stu-id="5f878-111">Another common pattern used for master/detail reports is to have the master records on one web page and the details on another.</span></span> <span data-ttu-id="5f878-112">在先前[跨兩頁的主要/詳細資料篩選](../masterdetail/master-detail-filtering-across-two-pages-cs.md)教學課程中，我們使用 GridView 來檢查此模式，以顯示系統中的所有供應商。</span><span class="sxs-lookup"><span data-stu-id="5f878-112">In the earlier [Master/Detail Filtering Across Two Pages](../masterdetail/master-detail-filtering-across-two-pages-cs.md) tutorial, we examined this pattern using a GridView to display all of the suppliers in the system.</span></span> <span data-ttu-id="5f878-113">這個 GridView 包含一個 HyperLinkField，它會轉譯為第二頁的連結，並沿著 querystring 中的 `SupplierID` 傳遞。</span><span class="sxs-lookup"><span data-stu-id="5f878-113">This GridView included a HyperLinkField, which rendered as a link to a second page, passing along the `SupplierID` in the querystring.</span></span> <span data-ttu-id="5f878-114">第二個頁面會使用 GridView 列出所選供應商所提供的產品。</span><span class="sxs-lookup"><span data-stu-id="5f878-114">The second page used a GridView to list those products provided by the selected supplier.</span></span>

<span data-ttu-id="5f878-115">這類的兩頁主要/詳細資料包表也可以使用 DataList 和重複項控制項來完成。</span><span class="sxs-lookup"><span data-stu-id="5f878-115">Such two-page master/detail reports can be accomplished using DataList and Repeater controls as well.</span></span> <span data-ttu-id="5f878-116">唯一的差別在於，DataList 和中繼器都不會提供 HyperLinkField 控制項的支援。</span><span class="sxs-lookup"><span data-stu-id="5f878-116">The only difference is that neither the DataList nor the Repeater provides support for the HyperLinkField control.</span></span> <span data-ttu-id="5f878-117">相反地，我們必須在控制項的 `ItemTemplate`內加入超連結 Web 控制項或錨點 HTML 元素（`<a>`）。</span><span class="sxs-lookup"><span data-stu-id="5f878-117">Instead, we must add a HyperLink Web control or an anchor HTML element (`<a>`) within the control's `ItemTemplate`.</span></span> <span data-ttu-id="5f878-118">超連結的 `NavigateUrl` 屬性或錨點的 `href` 屬性可以使用宣告式或程式設計方式進行自訂。</span><span class="sxs-lookup"><span data-stu-id="5f878-118">The HyperLink's `NavigateUrl` property or the anchor's `href` attribute can then be customized using declarative or programmatic approaches.</span></span>

<span data-ttu-id="5f878-119">在本教學課程中，我們將探討一個範例，其中會使用重複項控制項來列出一頁上項目符號清單中的分類。</span><span class="sxs-lookup"><span data-stu-id="5f878-119">In this tutorial we'll explore an example that lists the categories in a bulleted list on one page using a Repeater control.</span></span> <span data-ttu-id="5f878-120">每個清單專案都會包含分類的名稱和描述，而類別目錄名稱會顯示為第二頁的連結。</span><span class="sxs-lookup"><span data-stu-id="5f878-120">Each list item will include the category's name and description, with the category name displayed as a link to a second page.</span></span> <span data-ttu-id="5f878-121">按一下此連結會將使用者 whisk 到第二個頁面，其中 DataList 會顯示屬於所選類別目錄的產品。</span><span class="sxs-lookup"><span data-stu-id="5f878-121">Clicking on this link will whisk the user to the second page, where a DataList will show those products that belong to the selected category.</span></span>

## <a name="step-1-displaying-the-categories-in-a-bulleted-list"></a><span data-ttu-id="5f878-122">步驟1：在項目符號清單中顯示類別</span><span class="sxs-lookup"><span data-stu-id="5f878-122">Step 1: Displaying the Categories in a Bulleted List</span></span>

<span data-ttu-id="5f878-123">建立任何主要/詳細資料包表的第一個步驟，是從顯示「主要」記錄開始。</span><span class="sxs-lookup"><span data-stu-id="5f878-123">The first step in creating any master/detail report is to start by displaying the "master" records.</span></span> <span data-ttu-id="5f878-124">因此，我們的第一項工作是在 [主要] 頁面中顯示類別目錄。</span><span class="sxs-lookup"><span data-stu-id="5f878-124">Therefore, our first task is to display the categories in the "master" page.</span></span> <span data-ttu-id="5f878-125">開啟 [`DataListRepeaterFiltering`] 資料夾中的 [`CategoryListMaster.aspx`] 頁面，新增 [中繼器] 控制項，然後從智慧標籤加入宣告新的 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="5f878-125">Open the `CategoryListMaster.aspx` page in the `DataListRepeaterFiltering` folder, add a Repeater control, and, from the smart tag, opt to add a new ObjectDataSource.</span></span> <span data-ttu-id="5f878-126">設定新的 ObjectDataSource，使其從 `CategoriesBLL` 類別的 `GetCategories` 方法存取其資料（請參閱 [圖 1]）。</span><span class="sxs-lookup"><span data-stu-id="5f878-126">Configure the new ObjectDataSource so that it accesses its data from the `CategoriesBLL` class's `GetCategories` method (see Figure 1).</span></span>

<span data-ttu-id="5f878-127">[![將 ObjectDataSource 設定為使用 CategoriesBLL 類別的 GetCategories 方法](master-detail-filtering-acess-two-pages-datalist-cs/_static/image2.png)](master-detail-filtering-acess-two-pages-datalist-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="5f878-127">[![Configure the ObjectDataSource to Use the CategoriesBLL Class's GetCategories Method](master-detail-filtering-acess-two-pages-datalist-cs/_static/image2.png)](master-detail-filtering-acess-two-pages-datalist-cs/_static/image1.png)</span></span>

<span data-ttu-id="5f878-128">**圖 1**：設定 ObjectDataSource 使用 `CategoriesBLL` 類別的 `GetCategories` 方法（[按一下以查看完整大小的影像](master-detail-filtering-acess-two-pages-datalist-cs/_static/image3.png)）</span><span class="sxs-lookup"><span data-stu-id="5f878-128">**Figure 1**: Configure the ObjectDataSource to Use the `CategoriesBLL` Class's `GetCategories` Method ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-cs/_static/image3.png))</span></span>

<span data-ttu-id="5f878-129">接下來，定義中繼器的範本，讓它將每個類別目錄名稱和描述顯示為項目符號清單中的專案。</span><span class="sxs-lookup"><span data-stu-id="5f878-129">Next, define the Repeater's templates such that it displays each category name and description as an item in a bulleted list.</span></span> <span data-ttu-id="5f878-130">讓我們不用擔心每個類別都會連結到詳細資料頁面。</span><span class="sxs-lookup"><span data-stu-id="5f878-130">Let's not yet worry about having each category link to the details page.</span></span> <span data-ttu-id="5f878-131">以下顯示中繼器和 ObjectDataSource 的宣告式標記：</span><span class="sxs-lookup"><span data-stu-id="5f878-131">The following shows the declarative markup for the Repeater and ObjectDataSource:</span></span>

[!code-aspx[Main](master-detail-filtering-acess-two-pages-datalist-cs/samples/sample1.aspx)]

<span data-ttu-id="5f878-132">完成此標記之後，請花一點時間透過瀏覽器來查看進度。</span><span class="sxs-lookup"><span data-stu-id="5f878-132">With this markup complete, take a moment to view our progress through a browser.</span></span> <span data-ttu-id="5f878-133">如 [圖 2] 所示，中繼器會轉譯為項目符號清單，其中會顯示每個類別的名稱和描述。</span><span class="sxs-lookup"><span data-stu-id="5f878-133">As Figure 2 shows, the Repeater renders as a bulleted list showing each category's name and description.</span></span>

<span data-ttu-id="5f878-134">[![每個類別都會顯示為項目符號清單專案](master-detail-filtering-acess-two-pages-datalist-cs/_static/image5.png)](master-detail-filtering-acess-two-pages-datalist-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="5f878-134">[![Each Category is Displayed as a Bulleted List Item](master-detail-filtering-acess-two-pages-datalist-cs/_static/image5.png)](master-detail-filtering-acess-two-pages-datalist-cs/_static/image4.png)</span></span>

<span data-ttu-id="5f878-135">**圖 2**：每個類別都會顯示為項目符號清單專案（[按一下以查看完整大小的影像](master-detail-filtering-acess-two-pages-datalist-cs/_static/image6.png)）</span><span class="sxs-lookup"><span data-stu-id="5f878-135">**Figure 2**: Each Category is Displayed as a Bulleted List Item ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-cs/_static/image6.png))</span></span>

## <a name="step-2-turning-the-category-name-into-a-link-to-the-details-page"></a><span data-ttu-id="5f878-136">步驟2：將類別目錄名稱轉換成詳細資料頁面的連結</span><span class="sxs-lookup"><span data-stu-id="5f878-136">Step 2: Turning the Category Name into a Link to the Details Page</span></span>

<span data-ttu-id="5f878-137">若要允許使用者顯示指定分類的「詳細資料」資訊，我們需要新增每個項目符號清單專案的連結，按一下之後，就會將使用者帶到第二頁（`ProductsForCategoryDetails.aspx`）。</span><span class="sxs-lookup"><span data-stu-id="5f878-137">To allow a user to display the "details" information for a given category, we need to add a link to each bulleted list item that, when clicked, will take the user to the second page (`ProductsForCategoryDetails.aspx`).</span></span> <span data-ttu-id="5f878-138">第二頁接著會使用 DataList 來顯示所選類別的產品。</span><span class="sxs-lookup"><span data-stu-id="5f878-138">This second page will then display the products for the selected category using a DataList.</span></span> <span data-ttu-id="5f878-139">為了判斷已按下連結的類別，我們需要透過某種機制，將按下的分類 `CategoryID` 傳遞至第二頁。</span><span class="sxs-lookup"><span data-stu-id="5f878-139">In order to determine the category whose link was clicked, we need to pass the clicked category's `CategoryID` to the second page through some mechanism.</span></span> <span data-ttu-id="5f878-140">將純量資料從一頁傳輸到另一個頁面的最簡單且最直接的方式，是透過 querystring，這是我們將在本教學課程中使用的選項。</span><span class="sxs-lookup"><span data-stu-id="5f878-140">The simplest, most straightforward way to transfer scalar data from one page to another is through the querystring, which is the option we'll use in this tutorial.</span></span> <span data-ttu-id="5f878-141">特別的是，`ProductsForCategoryDetails.aspx` 頁面會預期選取的 *`categoryID`* 值會透過名為 `CategoryID`的 querystring 欄位傳遞。</span><span class="sxs-lookup"><span data-stu-id="5f878-141">In particular, the `ProductsForCategoryDetails.aspx` page will expect the selected *`categoryID`* value to be passed through a querystring field named `CategoryID`.</span></span> <span data-ttu-id="5f878-142">例如，若要查看飲料分類的產品，其 `CategoryID` 為1，使用者會造訪 `ProductsForCategoryDetails.aspx?CategoryID=1`。</span><span class="sxs-lookup"><span data-stu-id="5f878-142">For example, to view the products for the Beverages category, which has a `CategoryID` of 1, a user would visit `ProductsForCategoryDetails.aspx?CategoryID=1`.</span></span>

<span data-ttu-id="5f878-143">若要為中繼器中的每個項目符號清單專案建立超連結，我們需要將超連結 Web 控制項或 HTML 錨點專案（`<a>`）新增至 `ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="5f878-143">To create a hyperlink for each bulleted list item in the Repeater we need to either add a HyperLink Web control or an HTML anchor element (`<a>`) to the `ItemTemplate`.</span></span> <span data-ttu-id="5f878-144">在每個資料列的超連結顯示相同的情況下，這兩種方法都是足夠的。</span><span class="sxs-lookup"><span data-stu-id="5f878-144">In scenarios where the hyperlink is displayed the same for each row, either approach will suffice.</span></span> <span data-ttu-id="5f878-145">針對中繼器，我偏好使用錨定元素。</span><span class="sxs-lookup"><span data-stu-id="5f878-145">For Repeaters, I prefer using the anchor element.</span></span> <span data-ttu-id="5f878-146">若要使用錨點元素，請將中繼器的 ItemTemplate 更新為：</span><span class="sxs-lookup"><span data-stu-id="5f878-146">To use the anchor element, update the Repeater's ItemTemplate to:</span></span>

[!code-aspx[Main](master-detail-filtering-acess-two-pages-datalist-cs/samples/sample2.aspx)]

<span data-ttu-id="5f878-147">請注意，`CategoryID` 可以直接插入錨點元素的 `href` 屬性中;不過，若要這麼做，請務必將 `href` 屬性的值與單引號（和附注引號）分隔，因為 `href` 屬性內的 `Eval` 方法會以引號分隔其字串（`"CategoryID"`）。</span><span class="sxs-lookup"><span data-stu-id="5f878-147">Note that the `CategoryID` can be injected directly within the anchor element's `href` attribute; however, to do so be certain to delimit the `href` attribute's value with apostrophes (and note quotation marks) since the `Eval` method within the `href` attribute delimits its string (`"CategoryID"`) with quotation marks.</span></span> <span data-ttu-id="5f878-148">或者，您也可以改用超連結 Web 控制項：</span><span class="sxs-lookup"><span data-stu-id="5f878-148">Alternatively, a HyperLink Web control can be used instead:</span></span>

[!code-aspx[Main](master-detail-filtering-acess-two-pages-datalist-cs/samples/sample3.aspx)]

<span data-ttu-id="5f878-149">請注意，在使用字串串連的資料系結語法中，如何直接將 URL 的靜態部分（`ProductsForCategoryDetails.aspx?CategoryID`）附加至 `Eval("CategoryID")` 的結果。</span><span class="sxs-lookup"><span data-stu-id="5f878-149">Note how the static portion of the URL — `ProductsForCategoryDetails.aspx?CategoryID` — is appended to the result of `Eval("CategoryID")` directly within the databinding syntax using string concatenation.</span></span>

<span data-ttu-id="5f878-150">使用超連結控制項的其中一個優點是，它可以在必要時，以程式設計方式從中繼器的 `ItemDataBound` 事件處理常式中存取。</span><span class="sxs-lookup"><span data-stu-id="5f878-150">One benefit of using the HyperLink control is that it can be programmatically accessed from the Repeater's `ItemDataBound` event handler, if needed.</span></span> <span data-ttu-id="5f878-151">例如，您可能會想要將類別名稱顯示為文字，而不是與沒有相關聯產品的類別連結。</span><span class="sxs-lookup"><span data-stu-id="5f878-151">For example, you might want to display the category name as text rather than as a link for categories with no associated products.</span></span> <span data-ttu-id="5f878-152">這類檢查可以透過程式設計方式在 `ItemDataBound` 事件處理常式中執行;針對沒有相關聯產品的類別目錄，可以將超連結的 `NavigateUrl` 屬性設定為空白字串，因而導致該特定分類名稱轉譯為純文字（而不是連結）。</span><span class="sxs-lookup"><span data-stu-id="5f878-152">Such a check could be programmatically performed in the `ItemDataBound` event handler; for categories with no associated products, the HyperLink's `NavigateUrl` property could be set to a blank string, thereby resulting in that particular category name rendering as plain text (rather than as a link).</span></span> <span data-ttu-id="5f878-153">如需有關根據程式設計 `ItemDataBound` 邏輯來格式化 DataList 和中繼器內容的詳細資訊，請參閱根據資料來格式化 datalist[和中繼器](../displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-cs.md)教學課程。</span><span class="sxs-lookup"><span data-stu-id="5f878-153">Refer back to the [Formatting the DataList and Repeater Based Upon Data](../displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-cs.md) tutorial for more information on formatting the DataList and Repeater's contents based on programmatic logic through the `ItemDataBound` event handler.</span></span>

<span data-ttu-id="5f878-154">如果您遵循，請隨意在頁面中使用錨定元素或超連結控制項方法。</span><span class="sxs-lookup"><span data-stu-id="5f878-154">If you are following along, feel free to use either the anchor element or HyperLink control approach in your page.</span></span> <span data-ttu-id="5f878-155">不論何種方法，在瀏覽器中查看時，每個類別目錄名稱都應該轉譯為 `ProductsForCategoryDetails.aspx`的連結，並傳入適用的 `CategoryID` 值（請參閱 [圖 3]）。</span><span class="sxs-lookup"><span data-stu-id="5f878-155">Regardless of the approach, when viewing the page through a browser each category name should be rendered as a link to `ProductsForCategoryDetails.aspx`, passing in the applicable `CategoryID` value (see Figure 3).</span></span>

<span data-ttu-id="5f878-156">[![現在類別目錄名稱連結至 ProductsForCategoryDetails .aspx](master-detail-filtering-acess-two-pages-datalist-cs/_static/image8.png)](master-detail-filtering-acess-two-pages-datalist-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="5f878-156">[![The Category Names Now Link to ProductsForCategoryDetails.aspx](master-detail-filtering-acess-two-pages-datalist-cs/_static/image8.png)](master-detail-filtering-acess-two-pages-datalist-cs/_static/image7.png)</span></span>

<span data-ttu-id="5f878-157">**圖 3**：分類名稱現在會連結至 `ProductsForCategoryDetails.aspx` （[按一下以觀看完整大小的影像](master-detail-filtering-acess-two-pages-datalist-cs/_static/image9.png)）</span><span class="sxs-lookup"><span data-stu-id="5f878-157">**Figure 3**: The Category Names Now Link to `ProductsForCategoryDetails.aspx` ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-cs/_static/image9.png))</span></span>

## <a name="step-3-listing-the-products-that-belong-to-the-selected-category"></a><span data-ttu-id="5f878-158">步驟3：列出屬於所選類別的產品</span><span class="sxs-lookup"><span data-stu-id="5f878-158">Step 3: Listing the Products that Belong to the Selected Category</span></span>

<span data-ttu-id="5f878-159">在 [`CategoryListMaster.aspx`] 頁面完成後，我們就準備好將注意力轉換成「詳細資料」頁面，`ProductsForCategoryDetails.aspx`。</span><span class="sxs-lookup"><span data-stu-id="5f878-159">With the `CategoryListMaster.aspx` page complete, we're ready to turn our attention to implementing the "details" page, `ProductsForCategoryDetails.aspx`.</span></span> <span data-ttu-id="5f878-160">開啟此頁面，從 [工具箱] 將 [DataList] 拖曳至設計工具，並將其 [`ID`] 屬性設定為 [`ProductsInCategory`]。</span><span class="sxs-lookup"><span data-stu-id="5f878-160">Open this page, drag a DataList from the Toolbox onto the Designer, and set its `ID` property to `ProductsInCategory`.</span></span> <span data-ttu-id="5f878-161">接下來，從 DataList 的智慧標籤選擇將新的 ObjectDataSource 加入至頁面，並將它命名為 `ProductsInCategoryDataSource`。</span><span class="sxs-lookup"><span data-stu-id="5f878-161">Next, from the DataList's smart tag choose to add a new ObjectDataSource to the page, naming it `ProductsInCategoryDataSource`.</span></span> <span data-ttu-id="5f878-162">設定它，使其呼叫 `ProductsBLL` 類別的 `GetProductsByCategoryID(categoryID)` 方法;將 [插入]、[更新] 和 [刪除] 索引標籤中的下拉式清單設定為 [（無）]。</span><span class="sxs-lookup"><span data-stu-id="5f878-162">Configure it such that it calls the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method; set the drop-down lists in the INSERT, UPDATE, and DELETE tabs to (None).</span></span>

<span data-ttu-id="5f878-163">[![將 ObjectDataSource 設定為使用 ProductsBLL 類別的 GetProductsByCategoryID （類別 Id）方法](master-detail-filtering-acess-two-pages-datalist-cs/_static/image11.png)](master-detail-filtering-acess-two-pages-datalist-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="5f878-163">[![Configure the ObjectDataSource to Use the ProductsBLL Class's GetProductsByCategoryID(categoryID) Method](master-detail-filtering-acess-two-pages-datalist-cs/_static/image11.png)](master-detail-filtering-acess-two-pages-datalist-cs/_static/image10.png)</span></span>

<span data-ttu-id="5f878-164">**圖 4**：設定 ObjectDataSource 使用 `ProductsBLL` 類別的 `GetProductsByCategoryID(categoryID)` 方法（[按一下以查看完整大小的影像](master-detail-filtering-acess-two-pages-datalist-cs/_static/image12.png)）</span><span class="sxs-lookup"><span data-stu-id="5f878-164">**Figure 4**: Configure the ObjectDataSource to Use the `ProductsBLL` Class's `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-cs/_static/image12.png))</span></span>

<span data-ttu-id="5f878-165">由於 `GetProductsByCategoryID(categoryID)` 方法會接受輸入參數（ *`categoryID`* ），因此，[選擇資料來源] 會讓我們有機會指定參數的來源。</span><span class="sxs-lookup"><span data-stu-id="5f878-165">Since the `GetProductsByCategoryID(categoryID)` method accepts an input parameter (*`categoryID`*), the Choose Data Source wizard offers us an opportunity to specify the parameter's source.</span></span> <span data-ttu-id="5f878-166">使用 QueryStringField `CategoryID`，將參數來源設定為 QueryString。</span><span class="sxs-lookup"><span data-stu-id="5f878-166">Set the parameter source to QueryString using the QueryStringField `CategoryID`.</span></span>

<span data-ttu-id="5f878-167">[![使用 Querystring 欄位類別 Id 做為參數的來源](master-detail-filtering-acess-two-pages-datalist-cs/_static/image14.png)](master-detail-filtering-acess-two-pages-datalist-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="5f878-167">[![Use the Querystring Field CategoryID as the Parameter's Source](master-detail-filtering-acess-two-pages-datalist-cs/_static/image14.png)](master-detail-filtering-acess-two-pages-datalist-cs/_static/image13.png)</span></span>

<span data-ttu-id="5f878-168">**圖 5**：使用 Querystring 欄位 `CategoryID` 做為參數的來源（[按一下以查看完整大小的影像](master-detail-filtering-acess-two-pages-datalist-cs/_static/image15.png)）</span><span class="sxs-lookup"><span data-stu-id="5f878-168">**Figure 5**: Use the Querystring Field `CategoryID` as the Parameter's Source ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-cs/_static/image15.png))</span></span>

<span data-ttu-id="5f878-169">如我們在先前的教學課程中所見，完成 [選擇資料來源] wizard 之後，Visual Studio 會自動建立 DataList 的 `ItemTemplate`，其中列出每個資料欄位名稱和值。</span><span class="sxs-lookup"><span data-stu-id="5f878-169">As we've seen in previous tutorials, after completing the Choose Data Source wizard, Visual Studio automatically creates an `ItemTemplate` for the DataList that lists each data field name and value.</span></span> <span data-ttu-id="5f878-170">將此範本取代為只會列出產品名稱、供應商和價格的範本。</span><span class="sxs-lookup"><span data-stu-id="5f878-170">Replace this template with one that lists only the product's name, supplier, and price.</span></span> <span data-ttu-id="5f878-171">此外，將 DataList 的 `RepeatColumns` 屬性設定為2。</span><span class="sxs-lookup"><span data-stu-id="5f878-171">Also, set the DataList's `RepeatColumns` property to 2.</span></span> <span data-ttu-id="5f878-172">這些變更之後，您的 DataList 和 ObjectDataSource 的宣告式標記看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="5f878-172">After these changes, your DataList and ObjectDataSource's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](master-detail-filtering-acess-two-pages-datalist-cs/samples/sample4.aspx)]

<span data-ttu-id="5f878-173">若要觀看此頁面的作用，請從 [`CategoryListMaster.aspx`] 頁面啟動;接下來，按一下分類項目符號清單中的連結。</span><span class="sxs-lookup"><span data-stu-id="5f878-173">To view this page in action, start from the `CategoryListMaster.aspx` page; next, click on a link in the categories bulleted list.</span></span> <span data-ttu-id="5f878-174">這麼做會將您帶到 `ProductsForCategoryDetails.aspx`，並透過 querystring 傳遞 `CategoryID`。</span><span class="sxs-lookup"><span data-stu-id="5f878-174">Doing so will take you to `ProductsForCategoryDetails.aspx`, passing along the `CategoryID` through the querystring.</span></span> <span data-ttu-id="5f878-175">`ProductsForCategoryDetails.aspx` 中的 `ProductsInCategoryDataSource` ObjectDataSource 會接著取得指定分類的那些產品，並將其顯示在 DataList 中，這會呈現每個資料列的兩個產品。</span><span class="sxs-lookup"><span data-stu-id="5f878-175">The `ProductsInCategoryDataSource` ObjectDataSource in `ProductsForCategoryDetails.aspx` will then get just those products for the specified category and display them in the DataList, which renders two products per row.</span></span> <span data-ttu-id="5f878-176">[圖 6] 顯示觀看飲料時 `ProductsForCategoryDetails.aspx` 的螢幕擷取畫面。</span><span class="sxs-lookup"><span data-stu-id="5f878-176">Figure 6 shows a screenshot of `ProductsForCategoryDetails.aspx` when viewing the Beverages.</span></span>

<span data-ttu-id="5f878-177">[![顯示飲料，每個資料列兩個](master-detail-filtering-acess-two-pages-datalist-cs/_static/image17.png)](master-detail-filtering-acess-two-pages-datalist-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="5f878-177">[![The Beverages are Displayed, Two per Row](master-detail-filtering-acess-two-pages-datalist-cs/_static/image17.png)](master-detail-filtering-acess-two-pages-datalist-cs/_static/image16.png)</span></span>

<span data-ttu-id="5f878-178">**圖 6**：顯示飲料，每個資料列兩個（[按一下以觀看完整大小的影像](master-detail-filtering-acess-two-pages-datalist-cs/_static/image18.png)）</span><span class="sxs-lookup"><span data-stu-id="5f878-178">**Figure 6**: The Beverages are Displayed, Two per Row ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-cs/_static/image18.png))</span></span>

## <a name="step-4-displaying-category-information-on-productsforcategorydetailsaspx"></a><span data-ttu-id="5f878-179">步驟4：在 ProductsForCategoryDetails 上顯示類別資訊</span><span class="sxs-lookup"><span data-stu-id="5f878-179">Step 4: Displaying Category Information on ProductsForCategoryDetails.aspx</span></span>

<span data-ttu-id="5f878-180">當使用者按一下 `CategoryListMaster.aspx`中的類別時，系統會將他們納入 `ProductsForCategoryDetails.aspx`，並顯示屬於所選類別目錄的產品。</span><span class="sxs-lookup"><span data-stu-id="5f878-180">When a user clicks on a category in `CategoryListMaster.aspx`, they are taken to `ProductsForCategoryDetails.aspx` and shown the products that belong to the selected category.</span></span> <span data-ttu-id="5f878-181">不過，在 `ProductsForCategoryDetails.aspx` 不會有所選類別的視覺提示。</span><span class="sxs-lookup"><span data-stu-id="5f878-181">However, in `ProductsForCategoryDetails.aspx` there are no visual cues as to what category was selected.</span></span> <span data-ttu-id="5f878-182">若使用者要按一下 [飲料]，但不小心按一下 [Condiments]，就無法在到達 `ProductsForCategoryDetails.aspx`時發現錯誤。</span><span class="sxs-lookup"><span data-stu-id="5f878-182">A user that meant to click Beverages, but accidentally clicked Condiments, has no way of realizing their mistake once they reach `ProductsForCategoryDetails.aspx`.</span></span> <span data-ttu-id="5f878-183">為了減輕這個潛在問題，我們可以在 `ProductsForCategoryDetails.aspx` 頁面的頂端顯示所選類別的相關資訊（其名稱和描述）。</span><span class="sxs-lookup"><span data-stu-id="5f878-183">To alleviate this potential problem, we can display information about the selected category — its name and description — at the top of the `ProductsForCategoryDetails.aspx` page.</span></span>

<span data-ttu-id="5f878-184">若要完成這項操作，請在 `ProductsForCategoryDetails.aspx`的 [中繼器] 控制項上方新增 FormView。</span><span class="sxs-lookup"><span data-stu-id="5f878-184">To accomplish this, add a FormView above the Repeater control in `ProductsForCategoryDetails.aspx`.</span></span> <span data-ttu-id="5f878-185">接下來，從名為 `CategoryDataSource` 的 FormView 智慧標籤，將新的 ObjectDataSource 加入至頁面，並將它設定為使用 `CategoriesBLL` 類別的 `GetCategoryByCategoryID(categoryID)` 方法。</span><span class="sxs-lookup"><span data-stu-id="5f878-185">Next, add a new ObjectDataSource to the page from the FormView's smart tag named `CategoryDataSource` and configure it to use the `CategoriesBLL` class's `GetCategoryByCategoryID(categoryID)` method.</span></span>

<span data-ttu-id="5f878-186">[透過 CategoriesBLL 類別的 GetCategoryByCategoryID （類別目錄）方法，![存取類別的相關資訊](master-detail-filtering-acess-two-pages-datalist-cs/_static/image20.png)](master-detail-filtering-acess-two-pages-datalist-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="5f878-186">[![Access Information about the Category through the CategoriesBLL Class's GetCategoryByCategoryID(categoryID) Method](master-detail-filtering-acess-two-pages-datalist-cs/_static/image20.png)](master-detail-filtering-acess-two-pages-datalist-cs/_static/image19.png)</span></span>

<span data-ttu-id="5f878-187">**圖 7**：透過 `CategoriesBLL` 類別的 `GetCategoryByCategoryID(categoryID)` 方法存取類別的相關資訊（[按一下以查看完整大小的影像](master-detail-filtering-acess-two-pages-datalist-cs/_static/image21.png)）</span><span class="sxs-lookup"><span data-stu-id="5f878-187">**Figure 7**: Access Information about the Category through the `CategoriesBLL` Class's `GetCategoryByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-cs/_static/image21.png))</span></span>

<span data-ttu-id="5f878-188">如同步驟3中新增的 `ProductsInCategoryDataSource` ObjectDataSource，`CategoryDataSource`的 [設定資料來源] wizard 會提示我們輸入 `GetCategoryByCategoryID(categoryID)` 方法之輸入參數的來源。</span><span class="sxs-lookup"><span data-stu-id="5f878-188">As with the `ProductsInCategoryDataSource` ObjectDataSource added in Step 3, the `CategoryDataSource`'s Configure Data Source wizard prompts us for a source for the `GetCategoryByCategoryID(categoryID)` method's input parameter.</span></span> <span data-ttu-id="5f878-189">使用與之前完全相同的設定，將參數來源設定為 QueryString，並將 QueryStringField 值設為 `CategoryID` （請參閱 [圖 5]）。</span><span class="sxs-lookup"><span data-stu-id="5f878-189">Use the exact same settings as before, setting the parameter source to QueryString and the QueryStringField value to `CategoryID` (refer back to Figure 5).</span></span>

<span data-ttu-id="5f878-190">完成 wizard 之後，Visual Studio 會自動建立 FormView 的 `ItemTemplate`、`EditItemTemplate`和 `InsertItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="5f878-190">After completing the wizard, Visual Studio automatically creates an `ItemTemplate`, `EditItemTemplate`, and `InsertItemTemplate` for the FormView.</span></span> <span data-ttu-id="5f878-191">因為我們提供了唯讀介面，所以您可以隨意移除 `EditItemTemplate` 和 `InsertItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="5f878-191">Since we're providing a read-only interface, feel free to remove the `EditItemTemplate` and `InsertItemTemplate`.</span></span> <span data-ttu-id="5f878-192">此外，您可以隨意自訂 FormView 的 `ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="5f878-192">Also, feel free to customize the FormView's `ItemTemplate`.</span></span> <span data-ttu-id="5f878-193">移除多餘的範本並自訂 ItemTemplate 之後，您的 FormView 和 ObjectDataSource 的宣告式標記看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="5f878-193">After removing the superfluous templates and customizing the ItemTemplate, your FormView and ObjectDataSource's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](master-detail-filtering-acess-two-pages-datalist-cs/samples/sample5.aspx)]

<span data-ttu-id="5f878-194">[圖 8] 顯示透過瀏覽器來觀看此頁面時的螢幕擷取畫面。</span><span class="sxs-lookup"><span data-stu-id="5f878-194">Figure 8 shows a screen shot when viewing this page through a browser.</span></span>

> [!NOTE]
> <span data-ttu-id="5f878-195">除了 FormView 外，我也在 FormView 上方加入了超連結控制項，讓使用者回到分類清單（`CategoryListMaster.aspx`）。</span><span class="sxs-lookup"><span data-stu-id="5f878-195">In addition to the FormView, I've also added a HyperLink control above the FormView that will take the user back to the list of categories (`CategoryListMaster.aspx`).</span></span> <span data-ttu-id="5f878-196">請隨意將此連結放在別處，或完全省略。</span><span class="sxs-lookup"><span data-stu-id="5f878-196">Feel free to place this link elsewhere or to omit it altogether.</span></span>

<span data-ttu-id="5f878-197">[![類別目錄資訊現在會顯示在頁面頂端](master-detail-filtering-acess-two-pages-datalist-cs/_static/image23.png)](master-detail-filtering-acess-two-pages-datalist-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="5f878-197">[![Category Information is Now Displayed at the Top of the Page](master-detail-filtering-acess-two-pages-datalist-cs/_static/image23.png)](master-detail-filtering-acess-two-pages-datalist-cs/_static/image22.png)</span></span>

<span data-ttu-id="5f878-198">**圖 8**：類別目錄資訊現在會顯示在頁面頂端（[按一下以觀看完整大小的影像](master-detail-filtering-acess-two-pages-datalist-cs/_static/image24.png)）</span><span class="sxs-lookup"><span data-stu-id="5f878-198">**Figure 8**: Category Information is Now Displayed at the Top of the Page ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-cs/_static/image24.png))</span></span>

## <a name="step-5-displaying-a-message-if-no-products-belong-to-the-selected-category"></a><span data-ttu-id="5f878-199">步驟5：如果沒有產品屬於選取的類別，則顯示訊息</span><span class="sxs-lookup"><span data-stu-id="5f878-199">Step 5: Displaying a Message if No Products Belong to the Selected Category</span></span>

<span data-ttu-id="5f878-200">[`CategoryListMaster.aspx`] 頁面會列出系統中的所有類別，而不論是否有任何相關聯的產品。</span><span class="sxs-lookup"><span data-stu-id="5f878-200">The `CategoryListMaster.aspx` page lists all categories in the system, regardless of whether there are any associated products.</span></span> <span data-ttu-id="5f878-201">如果使用者按一下沒有相關聯產品的類別，將不會轉譯 `ProductsForCategoryDetails.aspx` 中的 DataList，因為它的資料來源不會有任何專案。</span><span class="sxs-lookup"><span data-stu-id="5f878-201">If a user clicks on a category with no associated products, the DataList in `ProductsForCategoryDetails.aspx` will not be rendered, as its data source will not have any items.</span></span> <span data-ttu-id="5f878-202">如我們在過去的教學課程中所見，GridView 提供了一個 `EmptyDataText` 屬性，可用於指定在資料來源中沒有任何記錄時所要顯示的文字訊息。</span><span class="sxs-lookup"><span data-stu-id="5f878-202">As we've seen in past tutorials, the GridView provides an `EmptyDataText` property that can be used to specify a text message to display if there are no records in its data source.</span></span> <span data-ttu-id="5f878-203">可惜的是，DataList 和中繼器都不會有這類屬性。</span><span class="sxs-lookup"><span data-stu-id="5f878-203">Unfortunately, neither the DataList nor Repeater has such a property.</span></span>

<span data-ttu-id="5f878-204">若要顯示訊息，通知使用者所選類別沒有符合的產品，我們需要將標籤控制項新增至頁面，其 `Text` 屬性會被指派要在沒有相符產品的事件中顯示的訊息。</span><span class="sxs-lookup"><span data-stu-id="5f878-204">In order to display a message informing the user that there are no matching products for the selected category, we need to add a Label control to the page whose `Text` property is assigned the message to display in the event that there are no matching products.</span></span> <span data-ttu-id="5f878-205">然後，我們需要根據 DataList 是否包含任何專案，以程式設計方式設定其 `Visible` 屬性。</span><span class="sxs-lookup"><span data-stu-id="5f878-205">We then need to programmatically set its `Visible` property based on whether or not the DataList contains any items.</span></span>

<span data-ttu-id="5f878-206">若要完成這項操作，請從在 DataList 底下新增標籤開始。</span><span class="sxs-lookup"><span data-stu-id="5f878-206">To accomplish this, start by adding a Label beneath the DataList.</span></span> <span data-ttu-id="5f878-207">將其 [`ID`] 屬性設定為 [`NoProductsMessage`]，並將其 [`Text`] 屬性設為 [沒有任何產品可供選取的類別 ...]接下來，我們需要根據是否有任何資料系結至 `ProductsInCategory` DataList，以程式設計方式設定此標籤的 `Visible` 屬性。</span><span class="sxs-lookup"><span data-stu-id="5f878-207">Set its `ID` property to `NoProductsMessage` and its `Text` property to "There are no products for the selected category…" Next, we need to programmatically set this Label's `Visible` property based on whether or not any data was bound to the `ProductsInCategory` DataList.</span></span> <span data-ttu-id="5f878-208">此指派必須在資料已系結至 DataList 後進行。</span><span class="sxs-lookup"><span data-stu-id="5f878-208">This assignment must be made after the data has been bound to the DataList.</span></span> <span data-ttu-id="5f878-209">針對 GridView、DetailsView 和 FormView，我們可以建立控制項的 `DataBound` 事件的事件處理常式，這會在資料系結完成後引發。</span><span class="sxs-lookup"><span data-stu-id="5f878-209">For the GridView, DetailsView, and FormView, we could create an event handler for the control's `DataBound` event, which fires after databinding has completed.</span></span> <span data-ttu-id="5f878-210">不過，DataList 和中繼器都沒有可用的 `DataBound` 事件。</span><span class="sxs-lookup"><span data-stu-id="5f878-210">However, neither the DataList nor the Repeater has a `DataBound` event available.</span></span>

<span data-ttu-id="5f878-211">在此特定範例中，我們可以在 `Page_Load` 事件處理常式中指派標籤的 `Visible` 屬性，因為資料會在頁面的 `Load` 事件之前指派給 DataList。</span><span class="sxs-lookup"><span data-stu-id="5f878-211">For this particular example we can assign the Label's `Visible` property in the `Page_Load` event handler, since the data will have been assigned to the DataList prior to the page's `Load` event.</span></span> <span data-ttu-id="5f878-212">不過，這種方法在一般情況下無法正常執行，因為 ObjectDataSource 的資料可能會在頁面生命週期的稍後系結至 DataList。</span><span class="sxs-lookup"><span data-stu-id="5f878-212">However, this approach would not work in the general case, as the data from the ObjectDataSource might be bound to the DataList later in the page's lifecycle.</span></span> <span data-ttu-id="5f878-213">例如，如果顯示的資料是以另一個控制項中的值為基礎，例如在使用 DropDownList 來保存「主要」記錄時顯示主要/詳細報表，則資料可能不會重新系結至資料 Web 控制項，直到頁面生命週期中的 `PreRender` 階段為止。</span><span class="sxs-lookup"><span data-stu-id="5f878-213">For example, if the displayed data is based upon the value in another control, such as it is when displaying a master/detail report using a DropDownList to hold the "master" records, the data may not rebound to the data Web control until the `PreRender` stage in the page's life cycle.</span></span>

<span data-ttu-id="5f878-214">所有情況下都適用的一個解決方案，就是在系結 `Item` 或 `AlternatingItem`的專案類型時，將 `Visible` 屬性指派給 DataList 的 `ItemDataBound` （或 `ItemCreated`）事件處理常式中的 `False`。</span><span class="sxs-lookup"><span data-stu-id="5f878-214">One solution which will work for all cases is to assign the `Visible` property to `False` in the DataList's `ItemDataBound` (or `ItemCreated`) event handler when binding an item type of `Item` or `AlternatingItem`.</span></span> <span data-ttu-id="5f878-215">在這種情況下，我們知道資料來源中至少有一個資料項目，因此可以隱藏 `NoProductsMessage` 標籤。</span><span class="sxs-lookup"><span data-stu-id="5f878-215">In such a case we know that there is at least one data item in the data source and therefore can hide the `NoProductsMessage` Label.</span></span> <span data-ttu-id="5f878-216">除了這個事件處理常式之外，我們也需要 DataList 的 `DataBinding` 事件的事件處理常式，我們會將標籤的 `Visible` 屬性初始化為 `True`。</span><span class="sxs-lookup"><span data-stu-id="5f878-216">In addition to this event handler, we also need an event handler for the DataList's `DataBinding` event, where we initialize the Label's `Visible` property to `True`.</span></span> <span data-ttu-id="5f878-217">因為 `DataBinding` 事件會在 `ItemDataBound` 事件之前引發，所以標籤的 `Visible` 屬性一開始會設定為 `True`;但是，如果有任何資料項目，則會設定為 `False`。</span><span class="sxs-lookup"><span data-stu-id="5f878-217">Since the `DataBinding` event fires before the `ItemDataBound` events, the Label's `Visible` property will initially be set to `True`; if there are any data items, however, it will be set to `False`.</span></span> <span data-ttu-id="5f878-218">下列程式碼會實行此邏輯：</span><span class="sxs-lookup"><span data-stu-id="5f878-218">The following code implements this logic:</span></span>

[!code-csharp[Main](master-detail-filtering-acess-two-pages-datalist-cs/samples/sample6.cs)]

<span data-ttu-id="5f878-219">Northwind 資料庫中的所有類別都與一或多個產品相關聯。</span><span class="sxs-lookup"><span data-stu-id="5f878-219">All of the categories in the Northwind database are associated with one or more products.</span></span> <span data-ttu-id="5f878-220">為了測試這項功能，我手動調整了本教學課程的 Northwind 資料庫，將所有與產生分類（`CategoryID` = 7）相關聯的產品重新指派給 [海鮮] 類別（`CategoryID` = 8）。</span><span class="sxs-lookup"><span data-stu-id="5f878-220">To test this feature, I've manually adjusted the Northwind database for this tutorial, reassigning all products associated with the Produce category (`CategoryID` = 7) to the Seafood category (`CategoryID` = 8).</span></span> <span data-ttu-id="5f878-221">這可以透過選擇 [新增查詢] 並使用下列 `UPDATE` 語句，從伺服器總管完成：</span><span class="sxs-lookup"><span data-stu-id="5f878-221">This can be accomplished from the Server Explorer by choosing New Query and using the following `UPDATE` statement:</span></span>

[!code-sql[Main](master-detail-filtering-acess-two-pages-datalist-cs/samples/sample7.sql)]

<span data-ttu-id="5f878-222">據以更新資料庫之後，請返回 [`CategoryListMaster.aspx`] 頁面，然後按一下 [產生] 連結。</span><span class="sxs-lookup"><span data-stu-id="5f878-222">After updating the database accordingly, return to the `CategoryListMaster.aspx` page and click on the Produce link.</span></span> <span data-ttu-id="5f878-223">因為已不再有任何產品屬於 [產生] 分類，所以您應該會看到「選取的類別沒有產品 ...」訊息，如 [圖 9] 所示。</span><span class="sxs-lookup"><span data-stu-id="5f878-223">Since there are no longer any products belonging to the Produce category, you should see the "There are no products for the selected category…" message, as shown in Figure 9.</span></span>

<span data-ttu-id="5f878-224">[如果沒有任何產品屬於選取的類別，就會顯示 ![訊息](master-detail-filtering-acess-two-pages-datalist-cs/_static/image26.png)](master-detail-filtering-acess-two-pages-datalist-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="5f878-224">[![A Message is Displayed if there are No Products Belonging to the Selected Category](master-detail-filtering-acess-two-pages-datalist-cs/_static/image26.png)](master-detail-filtering-acess-two-pages-datalist-cs/_static/image25.png)</span></span>

<span data-ttu-id="5f878-225">**圖 9**：如果沒有任何產品屬於選取的類別，就會顯示訊息（[按一下以查看完整大小的影像](master-detail-filtering-acess-two-pages-datalist-cs/_static/image27.png)）</span><span class="sxs-lookup"><span data-stu-id="5f878-225">**Figure 9**: A Message is Displayed if there are No Products Belonging to the Selected Category ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-cs/_static/image27.png))</span></span>

## <a name="summary"></a><span data-ttu-id="5f878-226">總結</span><span class="sxs-lookup"><span data-stu-id="5f878-226">Summary</span></span>

<span data-ttu-id="5f878-227">雖然主要/詳細資料包表可以在單一頁面上顯示主要和詳細資料記錄，但在許多網站中，它們會分成兩個網頁。</span><span class="sxs-lookup"><span data-stu-id="5f878-227">While master/detail reports can display both the master and detail records on a single page, in many websites they are separated out across two web pages.</span></span> <span data-ttu-id="5f878-228">在本教學課程中，我們探討了如何使用「主要」網頁中的重複項和 [詳細資料] 頁面中列出的相關聯產品，讓類別目錄列在項目符號清單中，以執行這類主要/詳細資料包告。</span><span class="sxs-lookup"><span data-stu-id="5f878-228">In this tutorial we looked at how to implement such a master/detail report by having the categories listed in a bulleted list using a Repeater in the "master" web page and the associated products listed in the "details" page.</span></span> <span data-ttu-id="5f878-229">主要網頁中的每個清單專案都包含 [詳細資料] 頁面的連結，這些資訊會沿著資料列的 `CategoryID` 值傳遞。</span><span class="sxs-lookup"><span data-stu-id="5f878-229">Each list item in the master web page contained a link to the details page that passed along the row's `CategoryID` value.</span></span>

<span data-ttu-id="5f878-230">在詳細資料頁面中，您可以透過 `ProductsBLL` 類別的 `GetProductsByCategoryID(categoryID)` 方法，針對指定的供應商來取得這些產品。</span><span class="sxs-lookup"><span data-stu-id="5f878-230">In the details page retrieving those products for the specified supplier was accomplished through the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="5f878-231">*`categoryID`* 參數值是使用 `CategoryID` querystring 值做為參數來源，以宣告方式指定。</span><span class="sxs-lookup"><span data-stu-id="5f878-231">The *`categoryID`* parameter value was specified declaratively using the `CategoryID` querystring value as the parameter source.</span></span> <span data-ttu-id="5f878-232">我們也探討了如何使用 FormView 在詳細資料頁面中顯示類別目錄詳細資料，以及如果沒有任何產品屬於選取的類別，如何顯示訊息。</span><span class="sxs-lookup"><span data-stu-id="5f878-232">We also looked at how to display category details in the details page using a FormView and how to display a message if there were no products belonging to the selected category.</span></span>

<span data-ttu-id="5f878-233">快樂的程式設計！</span><span class="sxs-lookup"><span data-stu-id="5f878-233">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="5f878-234">關於作者</span><span class="sxs-lookup"><span data-stu-id="5f878-234">About the Author</span></span>

<span data-ttu-id="5f878-235">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，自1998起，有七個 ASP/ASP. NET 書籍和創辦人的[4GuysFromRolla.com](http://www.4guysfromrolla.com)。</span><span class="sxs-lookup"><span data-stu-id="5f878-235">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="5f878-236">Scott 以獨立的顧問、訓練員和作者的身分運作。</span><span class="sxs-lookup"><span data-stu-id="5f878-236">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="5f878-237">他的最新著作是[*在24小時內讓自己的 ASP.NET 2.0*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="5f878-237">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="5f878-238">他可以在mitchell@4GuysFromRolla.com觸達[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="5f878-238">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="5f878-239">或者透過他的 blog，可以在[http://ScottOnWriting.NET](http://ScottOnWriting.NET)找到。</span><span class="sxs-lookup"><span data-stu-id="5f878-239">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="5f878-240">特別感謝 。</span><span class="sxs-lookup"><span data-stu-id="5f878-240">Special Thanks To…</span></span>

<span data-ttu-id="5f878-241">本教學課程系列已由許多有用的審核者所審查。</span><span class="sxs-lookup"><span data-stu-id="5f878-241">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="5f878-242">本教學課程的領導審查者為 Zack，Liz Shulok。</span><span class="sxs-lookup"><span data-stu-id="5f878-242">Lead reviewers for this tutorial were Zack Jones and Liz Shulok.</span></span> <span data-ttu-id="5f878-243">有興趣複習我即將發行的 MSDN 文章嗎？</span><span class="sxs-lookup"><span data-stu-id="5f878-243">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="5f878-244">若是如此，請在mitchell@4GuysFromRolla.com的那一行下拉式[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="5f878-244">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="5f878-245">[上一頁](master-detail-filtering-with-a-dropdownlist-datalist-cs.md)
> [下一頁](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md)</span><span class="sxs-lookup"><span data-stu-id="5f878-245">[Previous](master-detail-filtering-with-a-dropdownlist-datalist-cs.md)
[Next](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md)</span></span>
