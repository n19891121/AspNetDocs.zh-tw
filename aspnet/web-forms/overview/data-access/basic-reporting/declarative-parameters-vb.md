---
uid: web-forms/overview/data-access/basic-reporting/declarative-parameters-vb
title: 宣告式參數（VB） |Microsoft Docs
author: rick-anderson
description: 在本教學課程中，我們將說明如何使用設定為硬式編碼值的參數，以選取要在 DetailsView 控制項中顯示的資料。
ms.author: riande
ms.date: 03/31/2010
ms.assetid: dc1234a3-114f-4c9a-8d25-50ca03cc8e8e
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/declarative-parameters-vb
msc.type: authoredcontent
ms.openlocfilehash: cdc42752fc78d18366af037a81fe4ebe5a1646ef
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/28/2019
ms.locfileid: "74612658"
---
# <a name="declarative-parameters-vb"></a><span data-ttu-id="45655-103">宣告式參數 (VB)</span><span class="sxs-lookup"><span data-stu-id="45655-103">Declarative Parameters (VB)</span></span>

<span data-ttu-id="45655-104">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="45655-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="45655-105">[下載範例應用程式](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_5_VB.exe)或[下載 PDF](declarative-parameters-vb/_static/datatutorial05vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="45655-105">[Download Sample App](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_5_VB.exe) or [Download PDF](declarative-parameters-vb/_static/datatutorial05vb1.pdf)</span></span>

> <span data-ttu-id="45655-106">在本教學課程中，我們將說明如何使用設定為硬式編碼值的參數，以選取要在 DetailsView 控制項中顯示的資料。</span><span class="sxs-lookup"><span data-stu-id="45655-106">In this tutorial we'll illustrate how to use a parameter set to a hard-coded value to select the data to display in a DetailsView control.</span></span>

## <a name="introduction"></a><span data-ttu-id="45655-107">簡介</span><span class="sxs-lookup"><span data-stu-id="45655-107">Introduction</span></span>

<span data-ttu-id="45655-108">在[上一個教學](displaying-data-with-the-objectdatasource-vb.md)課程中，我們探討了如何使用 GridView、DetailsView 和 FormView 控制項（系結至從 `ProductsBLL` 類別叫用 `GetProducts()` 方法的 ObjectDataSource 控制項）來顯示資料。</span><span class="sxs-lookup"><span data-stu-id="45655-108">In the [last tutorial](displaying-data-with-the-objectdatasource-vb.md) we looked at displaying data with the GridView, DetailsView, and FormView controls bound to an ObjectDataSource control that invoked the `GetProducts()` method from the `ProductsBLL` class.</span></span> <span data-ttu-id="45655-109">`GetProducts()` 方法會傳回已填入 Northwind 資料庫之 `Products` 資料表中所有記錄的強型別 DataTable。</span><span class="sxs-lookup"><span data-stu-id="45655-109">The `GetProducts()` method returns a strongly-typed DataTable populated with all of the records from the Northwind database's `Products` table.</span></span> <span data-ttu-id="45655-110">`ProductsBLL` 類別包含的其他方法，只會傳回產品的子集-`GetProductByProductID(productID)`、`GetProductsByCategoryID(categoryID)`和 `GetProductsBySupplierID(supplierID)`。</span><span class="sxs-lookup"><span data-stu-id="45655-110">The `ProductsBLL` class contains additional methods for returning just subsets of the products - `GetProductByProductID(productID)`, `GetProductsByCategoryID(categoryID)`, and `GetProductsBySupplierID(supplierID)`.</span></span> <span data-ttu-id="45655-111">這三種方法預期會有一個輸入參數，指出如何篩選傳回的產品資訊。</span><span class="sxs-lookup"><span data-stu-id="45655-111">These three methods expect an input parameter indicating how to filter the returned product information.</span></span>

<span data-ttu-id="45655-112">ObjectDataSource 可以用來叫用預期輸入參數的方法，但為了這麼做，我們必須指定這些參數的值來自何處。</span><span class="sxs-lookup"><span data-stu-id="45655-112">The ObjectDataSource can be used to invoke methods that expect input parameters, but in order to do so we must specify where the values for these parameters come from.</span></span> <span data-ttu-id="45655-113">參數值可以硬式編碼，也可以來自各種動態來源，包括： querystring 值、會話變數、網頁上 Web 控制項的屬性值，或其他專案。</span><span class="sxs-lookup"><span data-stu-id="45655-113">The parameter values can be hard-coded or can come from a variety of dynamic sources, including: querystring values, Session variables, the property value of a Web control on the page, or others.</span></span>

<span data-ttu-id="45655-114">在本教學課程中，讓我們先說明如何使用設定為硬式編碼值的參數。</span><span class="sxs-lookup"><span data-stu-id="45655-114">For this tutorial let's start by illustrating how to use a parameter set to a hard-coded value.</span></span> <span data-ttu-id="45655-115">具體而言，我們將探討如何將 DetailsView 新增至頁面，以顯示特定產品的相關資訊，亦即 Chef Anton 的 Gumbo Mix，其 `ProductID` 為5。</span><span class="sxs-lookup"><span data-stu-id="45655-115">Specifically, we'll look at adding a DetailsView to the page that displays information about a specific product, namely Chef Anton's Gumbo Mix, which has a `ProductID` of 5.</span></span> <span data-ttu-id="45655-116">接下來，我們將瞭解如何根據 Web 控制項設定參數值。</span><span class="sxs-lookup"><span data-stu-id="45655-116">Next, we'll see how to set the parameter value based on a Web control.</span></span> <span data-ttu-id="45655-117">特別是，我們將使用 TextBox 讓使用者輸入國家/地區，然後按一下按鈕即可查看位於該國家/地區的供應商清單。</span><span class="sxs-lookup"><span data-stu-id="45655-117">In particular, we'll use a TextBox to let the user type in a country, after which they can click a Button to see the list of suppliers that reside in that country.</span></span>

## <a name="using-a-hard-coded-parameter-value"></a><span data-ttu-id="45655-118">使用硬式編碼的參數值</span><span class="sxs-lookup"><span data-stu-id="45655-118">Using a Hard-Coded Parameter Value</span></span>

<span data-ttu-id="45655-119">針對第一個範例，請從將 DetailsView 控制項新增至 [`BasicReporting`] 資料夾中的 [`DeclarativeParams.aspx`] 頁面開始。</span><span class="sxs-lookup"><span data-stu-id="45655-119">For the first example, start by adding a DetailsView control to the `DeclarativeParams.aspx` page in the `BasicReporting` folder.</span></span> <span data-ttu-id="45655-120">從 DetailsView 的智慧標籤中，選取下拉式清單中的 [&lt;新增資料來源&gt;]，然後加入宣告 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="45655-120">From the DetailsView's smart tag, select &lt;New data source&gt; from the drop-down list and choose to add an ObjectDataSource.</span></span>

<span data-ttu-id="45655-121">[![將 ObjectDataSource 新增至頁面](declarative-parameters-vb/_static/image2.png)](declarative-parameters-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="45655-121">[![Add an ObjectDataSource to the Page](declarative-parameters-vb/_static/image2.png)](declarative-parameters-vb/_static/image1.png)</span></span>

<span data-ttu-id="45655-122">**圖 1**：將 ObjectDataSource 新增至頁面（[按一下以查看完整大小的影像](declarative-parameters-vb/_static/image3.png)）</span><span class="sxs-lookup"><span data-stu-id="45655-122">**Figure 1**: Add an ObjectDataSource to the Page ([Click to view full-size image](declarative-parameters-vb/_static/image3.png))</span></span>

<span data-ttu-id="45655-123">這會自動啟動 ObjectDataSource 控制項的 [選擇資料來源]。</span><span class="sxs-lookup"><span data-stu-id="45655-123">This will automatically start the ObjectDataSource control's Choose Data Source wizard.</span></span> <span data-ttu-id="45655-124">從嚮導的第一個畫面中選取 [`ProductsBLL`] 類別。</span><span class="sxs-lookup"><span data-stu-id="45655-124">Select the `ProductsBLL` class from the first screen of the wizard.</span></span>

<span data-ttu-id="45655-125">[![選取 ProductsBLL 類別](declarative-parameters-vb/_static/image5.png)](declarative-parameters-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="45655-125">[![Select the ProductsBLL Class](declarative-parameters-vb/_static/image5.png)](declarative-parameters-vb/_static/image4.png)</span></span>

<span data-ttu-id="45655-126">**圖 2**：選取 [`ProductsBLL`] 類別（[按一下以查看完整大小的影像](declarative-parameters-vb/_static/image6.png)）</span><span class="sxs-lookup"><span data-stu-id="45655-126">**Figure 2**: Select the `ProductsBLL` Class ([Click to view full-size image](declarative-parameters-vb/_static/image6.png))</span></span>

<span data-ttu-id="45655-127">因為我們想要顯示特定產品的相關資訊，所以我們想要使用 `GetProductByProductID(productID)` 方法。</span><span class="sxs-lookup"><span data-stu-id="45655-127">Since we want to display information about a particular product we want to use the `GetProductByProductID(productID)` method.</span></span>

<span data-ttu-id="45655-128">[![選擇 GetProductByProductID （productID）方法](declarative-parameters-vb/_static/image8.png)](declarative-parameters-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="45655-128">[![Choose the GetProductByProductID(productID) method](declarative-parameters-vb/_static/image8.png)](declarative-parameters-vb/_static/image7.png)</span></span>

<span data-ttu-id="45655-129">**圖 3**：選擇 [`GetProductByProductID(productID)`] 方法（[按一下以查看完整大小的影像](declarative-parameters-vb/_static/image9.png)）</span><span class="sxs-lookup"><span data-stu-id="45655-129">**Figure 3**: Choose the `GetProductByProductID(productID)` method ([Click to view full-size image](declarative-parameters-vb/_static/image9.png))</span></span>

<span data-ttu-id="45655-130">因為我們選取的方法包含參數，所以會有一個畫面供 wizard 使用，而我們會要求您定義要用於參數的值。</span><span class="sxs-lookup"><span data-stu-id="45655-130">Since the method we selected includes a parameter, there's one more screen for the wizard, where we're asked to define the value to be used for the parameter.</span></span> <span data-ttu-id="45655-131">左邊的清單會顯示所選方法的所有參數。</span><span class="sxs-lookup"><span data-stu-id="45655-131">The list on the left shows all of the parameters for the selected method.</span></span> <span data-ttu-id="45655-132">`GetProductByProductID(productID)` 只有一個 `productID`。</span><span class="sxs-lookup"><span data-stu-id="45655-132">For `GetProductByProductID(productID)` there's only one `productID`.</span></span> <span data-ttu-id="45655-133">在右側，我們可以指定所選取參數的值。</span><span class="sxs-lookup"><span data-stu-id="45655-133">On the right we can specify the value for the selected parameter.</span></span> <span data-ttu-id="45655-134">[參數來源] 下拉式清單會列舉參數值的各種可能來源。</span><span class="sxs-lookup"><span data-stu-id="45655-134">The parameter source drop-down list enumerates the various possible sources for the parameter value.</span></span> <span data-ttu-id="45655-135">因為我們想要為 `productID` 參數指定硬式編碼的值5，請將參數來源保留為 [無]，並在 [DefaultValue] 文字方塊中輸入5。</span><span class="sxs-lookup"><span data-stu-id="45655-135">Since we want to specify a hard-coded value of 5 for the `productID` parameter, leave the Parameter source as None and enter 5 into the DefaultValue textbox.</span></span>

<span data-ttu-id="45655-136">[![硬式編碼參數值5將用於 productID 參數](declarative-parameters-vb/_static/image11.png)](declarative-parameters-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="45655-136">[![A Hard-Coded Parameter Value of 5 Will Be Used for the productID Parameter](declarative-parameters-vb/_static/image11.png)](declarative-parameters-vb/_static/image10.png)</span></span>

<span data-ttu-id="45655-137">**圖 4**：以硬式編碼的參數值5將用於 `productID` 參數（[按一下以查看完整大小的影像](declarative-parameters-vb/_static/image12.png)）</span><span class="sxs-lookup"><span data-stu-id="45655-137">**Figure 4**: A Hard-Coded Parameter Value of 5 Will Be Used for the `productID` Parameter ([Click to view full-size image](declarative-parameters-vb/_static/image12.png))</span></span>

<span data-ttu-id="45655-138">完成 [設定資料來源] wizard 之後，ObjectDataSource 控制項的宣告式標記會在 `SelectParameters` 集合中，針對 `SelectMethod` 屬性中定義的方法所預期的每個輸入參數，包含一個 `Parameter` 物件。</span><span class="sxs-lookup"><span data-stu-id="45655-138">After completing the Configure Data Source wizard, the ObjectDataSource control's declarative markup includes a `Parameter` object in the `SelectParameters` collection for each of the input parameters expected by the method defined in the `SelectMethod` property.</span></span> <span data-ttu-id="45655-139">因為我們在此範例中使用的方法只需要單一輸入參數，`parameterID`，所以這裡只有一個專案。</span><span class="sxs-lookup"><span data-stu-id="45655-139">Since the method we're using in this example expects just a single input parameter, `parameterID`, there's only one entry here.</span></span> <span data-ttu-id="45655-140">`SelectParameters` 集合可以包含從 `System.Web.UI.WebControls` 命名空間中的 `Parameter` 類別衍生的任何類別。</span><span class="sxs-lookup"><span data-stu-id="45655-140">The `SelectParameters` collection can contain any class that derives from the `Parameter` class in the `System.Web.UI.WebControls` namespace.</span></span> <span data-ttu-id="45655-141">針對硬式編碼參數值，會使用基底 `Parameter` 類別，但針對其他參數來源選項，則會使用衍生的 `Parameter` 類別;如有需要，您也可以建立自己的[自訂參數類型](http://www.leftslipper.com/ShowFaq.aspx?FaqId=11)。</span><span class="sxs-lookup"><span data-stu-id="45655-141">For hard-coded parameter values the base `Parameter` class is used, but for the other parameter source options a derived `Parameter` class is used; you can also create your own [custom parameter types](http://www.leftslipper.com/ShowFaq.aspx?FaqId=11), if needed.</span></span>

[!code-aspx[Main](declarative-parameters-vb/samples/sample1.aspx)]

> [!NOTE]
> <span data-ttu-id="45655-142">如果您在自己的電腦上執行，此時您看到的宣告式標記可能包括 `InsertMethod`、`UpdateMethod`和 `DeleteMethod` 屬性的值，以及 `DeleteParameters`。</span><span class="sxs-lookup"><span data-stu-id="45655-142">If you're following along on your own computer the declarative markup you see at this point may include values for the `InsertMethod`, `UpdateMethod`, and `DeleteMethod` properties, as well as `DeleteParameters`.</span></span> <span data-ttu-id="45655-143">ObjectDataSource 的 [選擇資料來源] 嚮導會自動指定 `ProductBLL` 中用來進行插入、更新和刪除的方法，因此除非您明確地清除它們，否則會將它們包含在上述標記中。</span><span class="sxs-lookup"><span data-stu-id="45655-143">The ObjectDataSource's Choose Data Source wizard automatically specifies the methods from the `ProductBLL` to use for inserting, updating, and deleting, so unless you explicitly cleared those out, they'll be included in the markup above.</span></span>

<span data-ttu-id="45655-144">流覽此頁面時，資料 Web 控制項將會叫用 ObjectDataSource 的 `Select` 方法，這會針對 `productID` 輸入參數，使用硬式編碼值5來呼叫 `ProductsBLL` 類別的 `GetProductByProductID(productID)` 方法。</span><span class="sxs-lookup"><span data-stu-id="45655-144">When visiting this page, the data Web control will invoke the ObjectDataSource's `Select` method, which will call the `ProductsBLL` class's `GetProductByProductID(productID)` method using the hard-coded value of 5 for the `productID` input parameter.</span></span> <span data-ttu-id="45655-145">方法會傳回強型別 `ProductDataTable` 物件，其中包含單一資料列，其中含有 Chef Anton 的 Gumbo 混合（產品具有 `ProductID` 5）的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="45655-145">The method will return a strongly-typed `ProductDataTable` object that contains a single row with information about Chef Anton's Gumbo Mix (the product with `ProductID` 5).</span></span>

<span data-ttu-id="45655-146">[會顯示 Chef Anton 的 Gumbo 混合 ![相關資訊](declarative-parameters-vb/_static/image14.png)](declarative-parameters-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="45655-146">[![Information About Chef Anton's Gumbo Mix are Displayed](declarative-parameters-vb/_static/image14.png)](declarative-parameters-vb/_static/image13.png)</span></span>

<span data-ttu-id="45655-147">**圖 5**：顯示 Chef Anton 的 Gumbo 混合相關資訊（[按一下以觀看完整大小的影像](declarative-parameters-vb/_static/image15.png)）</span><span class="sxs-lookup"><span data-stu-id="45655-147">**Figure 5**: Information About Chef Anton's Gumbo Mix are Displayed ([Click to view full-size image](declarative-parameters-vb/_static/image15.png))</span></span>

## <a name="setting-the-parameter-value-to-the-property-value-of-a-web-control"></a><span data-ttu-id="45655-148">將參數值設定為 Web 控制項的屬性值</span><span class="sxs-lookup"><span data-stu-id="45655-148">Setting the Parameter Value to the Property Value of a Web Control</span></span>

<span data-ttu-id="45655-149">您也可以根據頁面上 Web 控制項的值來設定 ObjectDataSource 的參數值。</span><span class="sxs-lookup"><span data-stu-id="45655-149">The ObjectDataSource's parameter values can also be set based on the value of a Web control on the page.</span></span> <span data-ttu-id="45655-150">為了說明這一點，讓我們有一個 GridView，其中列出的所有供應商都位於使用者所指定的國家/地區。</span><span class="sxs-lookup"><span data-stu-id="45655-150">To illustrate this, let's have a GridView that lists all of the suppliers that are located in a country specified by the user.</span></span> <span data-ttu-id="45655-151">若要完成這項工作，請先將 TextBox 新增至使用者可以在其中輸入國家/地區名稱的頁面。</span><span class="sxs-lookup"><span data-stu-id="45655-151">To accomplish this start by adding a TextBox to the page into which the user can enter a country name.</span></span> <span data-ttu-id="45655-152">將此 TextBox 控制項的 `ID` 屬性設定為 [`CountryName`]。</span><span class="sxs-lookup"><span data-stu-id="45655-152">Set this TextBox control's `ID` property to `CountryName`.</span></span> <span data-ttu-id="45655-153">同時新增按鈕 Web 控制項。</span><span class="sxs-lookup"><span data-stu-id="45655-153">Also add a Button Web control.</span></span>

<span data-ttu-id="45655-154">[![將文字方塊新增至識別碼為 CountryName 的頁面](declarative-parameters-vb/_static/image17.png)](declarative-parameters-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="45655-154">[![Add a TextBox to the Page with ID CountryName](declarative-parameters-vb/_static/image17.png)](declarative-parameters-vb/_static/image16.png)</span></span>

<span data-ttu-id="45655-155">**圖 6**：使用 `ID` `CountryName` 在頁面中新增文字方塊（[按一下以觀看完整大小的影像](declarative-parameters-vb/_static/image18.png)）</span><span class="sxs-lookup"><span data-stu-id="45655-155">**Figure 6**: Add a TextBox to the Page with `ID` `CountryName` ([Click to view full-size image](declarative-parameters-vb/_static/image18.png))</span></span>

<span data-ttu-id="45655-156">接下來，將 GridView 新增至頁面，並從智慧標籤中加入宣告新的 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="45655-156">Next, add a GridView to the page and, from the smart tag, choose to add a new ObjectDataSource.</span></span> <span data-ttu-id="45655-157">因為我們想要顯示供應商資訊，請從嚮導的第一個畫面中選取 [`SuppliersBLL`] 類別。</span><span class="sxs-lookup"><span data-stu-id="45655-157">Since we want to display supplier information select the `SuppliersBLL` class from the wizard's first screen.</span></span> <span data-ttu-id="45655-158">從第二個畫面中，挑選 `GetSuppliersByCountry(country)` 方法。</span><span class="sxs-lookup"><span data-stu-id="45655-158">From the second screen, pick the `GetSuppliersByCountry(country)` method.</span></span>

<span data-ttu-id="45655-159">[![選擇 GetSuppliersByCountry （國家）方法](declarative-parameters-vb/_static/image20.png)](declarative-parameters-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="45655-159">[![Choose the GetSuppliersByCountry(country) Method](declarative-parameters-vb/_static/image20.png)](declarative-parameters-vb/_static/image19.png)</span></span>

<span data-ttu-id="45655-160">**圖 7**：選擇 [`GetSuppliersByCountry(country)`] 方法（[按一下以查看完整大小的影像](declarative-parameters-vb/_static/image21.png)）</span><span class="sxs-lookup"><span data-stu-id="45655-160">**Figure 7**: Choose the `GetSuppliersByCountry(country)` Method ([Click to view full-size image](declarative-parameters-vb/_static/image21.png))</span></span>

<span data-ttu-id="45655-161">由於 `GetSuppliersByCountry(country)` 方法具有輸入參數，因此 wizard 再次包含選擇參數值的最後一個畫面。</span><span class="sxs-lookup"><span data-stu-id="45655-161">Since the `GetSuppliersByCountry(country)` method has an input parameter, the wizard once again includes a final screen for choosing the parameter value.</span></span> <span data-ttu-id="45655-162">這次，請將參數來源設定為 [控制]。</span><span class="sxs-lookup"><span data-stu-id="45655-162">This time, set the Parameter source to Control.</span></span> <span data-ttu-id="45655-163">這會在 [ControlID] 下拉式清單中填入頁面上的控制項名稱;從清單中選取 [`CountryName`] 控制項。</span><span class="sxs-lookup"><span data-stu-id="45655-163">This will populate the ControlID drop-down list with the names of the controls on the page; select the `CountryName` control from the list.</span></span> <span data-ttu-id="45655-164">第一次造訪網頁時，`CountryName` TextBox 會是空白的，因此不會傳回任何結果，也不會顯示任何內容。</span><span class="sxs-lookup"><span data-stu-id="45655-164">When the page is first visited the `CountryName` TextBox will be blank, so no results are returned and nothing is displayed.</span></span> <span data-ttu-id="45655-165">如果您想要依預設顯示某些結果，請據以設定 [DefaultValue] 文字方塊。</span><span class="sxs-lookup"><span data-stu-id="45655-165">If you want to display some results by default, set the DefaultValue textbox accordingly.</span></span>

<span data-ttu-id="45655-166">[![將參數值設定為 CountryName 控制項值](declarative-parameters-vb/_static/image23.png)](declarative-parameters-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="45655-166">[![Set the Parameter Value to the CountryName Control Value](declarative-parameters-vb/_static/image23.png)](declarative-parameters-vb/_static/image22.png)</span></span>

<span data-ttu-id="45655-167">**圖 8**：將參數值設定為 `CountryName` 控制項值（[按一下以查看完整大小的影像](declarative-parameters-vb/_static/image24.png)）</span><span class="sxs-lookup"><span data-stu-id="45655-167">**Figure 8**: Set the Parameter Value to the `CountryName` Control Value ([Click to view full-size image](declarative-parameters-vb/_static/image24.png))</span></span>

<span data-ttu-id="45655-168">ObjectDataSource 的宣告式標記與我們的第一個範例稍有不同，而是使用[ControlParameter](https://msdn.microsoft.com/library/system.web.ui.webcontrols.controlparameter.aspx) ，而不是標準 `Parameter` 物件。</span><span class="sxs-lookup"><span data-stu-id="45655-168">The ObjectDataSource's declarative markup differs slightly from our first example, using a [ControlParameter](https://msdn.microsoft.com/library/system.web.ui.webcontrols.controlparameter.aspx) instead of the standard `Parameter` object.</span></span> <span data-ttu-id="45655-169">`ControlParameter` 具有額外的屬性，可指定 Web 控制項的 `ID`，以及用於參數的屬性值（`PropertyName`）。</span><span class="sxs-lookup"><span data-stu-id="45655-169">A `ControlParameter` has additional properties to specify the `ID` of the Web control and the property value to use for the parameter (`PropertyName`).</span></span> <span data-ttu-id="45655-170">[設定資料來源] wizard 非常聰明，可判斷文字方塊中，我們可能會想要使用參數值的 [`Text`] 屬性。</span><span class="sxs-lookup"><span data-stu-id="45655-170">The Configure Data Source wizard was smart enough to determine that, for a TextBox, we'll likely want to use the `Text` property for the parameter value.</span></span> <span data-ttu-id="45655-171">不過，如果您想要從 Web 控制項使用不同的屬性值，您可以在此變更 `PropertyName` 值，或按一下 wizard 中的 [顯示 advanced properties] 連結。</span><span class="sxs-lookup"><span data-stu-id="45655-171">If, however, you want to use a different property value from the Web control you can change the `PropertyName` value here or by clicking the "Show advanced properties" link in the wizard.</span></span>

[!code-aspx[Main](declarative-parameters-vb/samples/sample2.aspx)]

<span data-ttu-id="45655-172">第一次流覽頁面時，[`CountryName`] 文字方塊是空的。</span><span class="sxs-lookup"><span data-stu-id="45655-172">When visiting the page for the first time the `CountryName` TextBox is empty.</span></span> <span data-ttu-id="45655-173">ObjectDataSource 的 `Select` 方法仍由 GridView 叫用，但 `Nothing` 的值會傳遞至 `GetSuppliersByCountry(country)` 方法。</span><span class="sxs-lookup"><span data-stu-id="45655-173">The ObjectDataSource's `Select` method is still invoked by the GridView, but a value of `Nothing` is passed into the `GetSuppliersByCountry(country)` method.</span></span> <span data-ttu-id="45655-174">TableAdapter 會將 `Nothing` 轉換成資料庫 `NULL` 值（`DBNull.Value`），但是 `GetSuppliersByCountry(country)` 方法所使用的查詢會被寫入，讓 `NULL` 參數的 `@CategoryID` 值指定時，不會傳回任何值。</span><span class="sxs-lookup"><span data-stu-id="45655-174">The TableAdapter converts the `Nothing` into a database `NULL` value (`DBNull.Value`), but the query used by the `GetSuppliersByCountry(country)` method is written such that it doesn't return any values when a `NULL` value is specified for the `@CategoryID` parameter.</span></span> <span data-ttu-id="45655-175">簡言之，不會傳回任何供應商。</span><span class="sxs-lookup"><span data-stu-id="45655-175">In short, no suppliers are returned.</span></span>

<span data-ttu-id="45655-176">但是一旦訪客進入某個國家/地區，然後按一下 [顯示供應商] 按鈕以進行回傳，就會重新查詢 ObjectDataSource 的 `Select` 方法，並傳入 TextBox 控制項的 `Text` 值做為 `country` 參數。</span><span class="sxs-lookup"><span data-stu-id="45655-176">Once the visitor enters in a country, however, and clicks the Show Suppliers button to cause a postback, the ObjectDataSource's `Select` method is requeried, passing in the TextBox control's `Text` value as the `country` parameter.</span></span>

<span data-ttu-id="45655-177">[顯示來自加拿大的供應商 ![](declarative-parameters-vb/_static/image26.png)](declarative-parameters-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="45655-177">[![Those Suppliers from Canada are Shown](declarative-parameters-vb/_static/image26.png)](declarative-parameters-vb/_static/image25.png)</span></span>

<span data-ttu-id="45655-178">**圖 9**：顯示來自加拿大的供應商（[按一下以觀看完整大小的影像](declarative-parameters-vb/_static/image27.png)）</span><span class="sxs-lookup"><span data-stu-id="45655-178">**Figure 9**: Those Suppliers from Canada are Shown ([Click to view full-size image](declarative-parameters-vb/_static/image27.png))</span></span>

## <a name="showing-all-suppliers-by-default"></a><span data-ttu-id="45655-179">預設顯示所有供應商</span><span class="sxs-lookup"><span data-stu-id="45655-179">Showing All Suppliers By Default</span></span>

<span data-ttu-id="45655-180">我們可能會想要先顯示*所有*供應商，而不是顯示任何供應商，而是在文字方塊中輸入國家/地區名稱，讓使用者向下削減清單。</span><span class="sxs-lookup"><span data-stu-id="45655-180">Rather than show none of the suppliers when first viewing the page we may want to show *all* suppliers at first, allowing the user to pare down the list by entering a country name in the TextBox.</span></span> <span data-ttu-id="45655-181">當文字方塊是空的時，`SuppliersBLL` 類別的 `GetSuppliersByCountry(country)` 方法會在其 *`country`* 輸入參數的 `Nothing` 中傳遞。</span><span class="sxs-lookup"><span data-stu-id="45655-181">When the TextBox is empty, the `SuppliersBLL` class's `GetSuppliersByCountry(country)` method is passed in `Nothing` for its *`country`* input parameter.</span></span> <span data-ttu-id="45655-182">這個 `Nothing` 值接著會向下傳遞至 DAL 的 `GetSupplierByCountry(country)` 方法，其中會將它轉譯成下列查詢中 `@Country` 參數的資料庫 `NULL` 值：</span><span class="sxs-lookup"><span data-stu-id="45655-182">This `Nothing` value is then passed down into the DAL's `GetSupplierByCountry(country)` method, where it's translated to a database `NULL` value for the `@Country` parameter in the following query:</span></span>

[!code-sql[Main](declarative-parameters-vb/samples/sample3.sql)]

<span data-ttu-id="45655-183">運算式 `Country = NULL` 一律會傳回 False，即使是 `Country` 的資料行具有 `NULL` 值的記錄也一樣。因此，不會傳回任何記錄。</span><span class="sxs-lookup"><span data-stu-id="45655-183">The expression `Country = NULL` always returns False, even for records whose `Country` column has a `NULL` value; therefore, no records are returned.</span></span>

<span data-ttu-id="45655-184">若要在 [國家/地區] 文字方塊空白時傳回*所有*供應商，我們可以在 BLL 中增加 `GetSuppliersByCountry(country)` 方法，以在 `Nothing` country 參數時叫用 `GetSuppliers()` 方法，否則呼叫 DAL 的 `GetSuppliersByCountry(country)` 方法。</span><span class="sxs-lookup"><span data-stu-id="45655-184">To return *all* suppliers when the country TextBox is empty, we can augment the `GetSuppliersByCountry(country)` method in the BLL to invoke the `GetSuppliers()` method when its country parameter is `Nothing` and to call the DAL's `GetSuppliersByCountry(country)` method otherwise.</span></span> <span data-ttu-id="45655-185">當您未指定任何國家/地區，且包含 country 參數時，這會有傳回所有供應商的效果。</span><span class="sxs-lookup"><span data-stu-id="45655-185">This will have the effect of returning all suppliers when no country is specified and the appropriate subset of suppliers when the country parameter is included.</span></span>

<span data-ttu-id="45655-186">將 `SuppliersBLL` 類別中的 `GetSuppliersByCountry(country)` 方法變更為下列內容：</span><span class="sxs-lookup"><span data-stu-id="45655-186">Change the `GetSuppliersByCountry(country)` method in the `SuppliersBLL` class to the following:</span></span>

[!code-vb[Main](declarative-parameters-vb/samples/sample4.vb)]

<span data-ttu-id="45655-187">使用這項變更時，[`DeclarativeParams.aspx`] 頁面會顯示第一次造訪時的所有供應商（或每次 [`CountryName`] 文字方塊是空的）。</span><span class="sxs-lookup"><span data-stu-id="45655-187">With this change the `DeclarativeParams.aspx` page shows all of the suppliers when first visited (or whenever the `CountryName` TextBox is empty).</span></span>

<span data-ttu-id="45655-188">[![現在預設會顯示所有供應商](declarative-parameters-vb/_static/image29.png)](declarative-parameters-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="45655-188">[![All Suppliers are Now Shown by Default](declarative-parameters-vb/_static/image29.png)](declarative-parameters-vb/_static/image28.png)</span></span>

<span data-ttu-id="45655-189">**圖 10**：現在預設會顯示所有供應商（[按一下以觀看完整大小的影像](declarative-parameters-vb/_static/image30.png)）</span><span class="sxs-lookup"><span data-stu-id="45655-189">**Figure 10**: All Suppliers are Now Shown by Default ([Click to view full-size image](declarative-parameters-vb/_static/image30.png))</span></span>

## <a name="summary"></a><span data-ttu-id="45655-190">總結</span><span class="sxs-lookup"><span data-stu-id="45655-190">Summary</span></span>

<span data-ttu-id="45655-191">若要使用具有輸入參數的方法，我們必須在 ObjectDataSource 的 `SelectParameters` 集合中指定參數的值。</span><span class="sxs-lookup"><span data-stu-id="45655-191">In order to use methods with input parameters, we need to specify the values for the parameters in the ObjectDataSource's `SelectParameters` collection.</span></span> <span data-ttu-id="45655-192">不同類型的參數允許從不同的來源取得參數值。</span><span class="sxs-lookup"><span data-stu-id="45655-192">Different types of parameters allow for the parameter value to be obtained from different sources.</span></span> <span data-ttu-id="45655-193">預設參數類型會使用硬式編碼的值，但如同簡單（而且不含一行程式碼），參數值可以從 querystring、會話變數、cookie，甚至是使用者輸入的值，從頁面上的 Web 控制項取得。</span><span class="sxs-lookup"><span data-stu-id="45655-193">The default parameter type uses a hard-coded value, but just as easily (and without a line of code) parameter values can be obtained from the querystring, Session variables, cookies, and even user-entered values from Web controls on the page.</span></span>

<span data-ttu-id="45655-194">我們在本教學課程中探討的範例說明如何使用宣告式參數值。</span><span class="sxs-lookup"><span data-stu-id="45655-194">The examples we looked at in this tutorial illustrated how to use declarative parameter values.</span></span> <span data-ttu-id="45655-195">不過，有時候我們可能需要使用無法使用的參數來源，例如目前的日期和時間，或者，如果我們的網站使用的是成員資格，則是訪客的使用者識別碼。</span><span class="sxs-lookup"><span data-stu-id="45655-195">However, there may be times when we need to use a parameter source that's not available, such as the current date and time, or, if our site was using Membership, the User ID of the visitor.</span></span> <span data-ttu-id="45655-196">在這種情況下，我們可以在 ObjectDataSource 叫用其基礎物件的方法之前，以程式設計方式設定參數值。</span><span class="sxs-lookup"><span data-stu-id="45655-196">For such scenarios we can set the parameter values programmatically prior to the ObjectDataSource invoking its underlying object's method.</span></span> <span data-ttu-id="45655-197">我們會在[下一個教學](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)課程中瞭解如何完成這項操作。</span><span class="sxs-lookup"><span data-stu-id="45655-197">We'll see how to accomplish this in the [next tutorial](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md).</span></span>

<span data-ttu-id="45655-198">快樂的程式設計！</span><span class="sxs-lookup"><span data-stu-id="45655-198">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="45655-199">關於作者</span><span class="sxs-lookup"><span data-stu-id="45655-199">About the Author</span></span>

<span data-ttu-id="45655-200">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，自1998起，有七個 ASP/ASP. NET 書籍和創辦人的[4GuysFromRolla.com](http://www.4guysfromrolla.com)。</span><span class="sxs-lookup"><span data-stu-id="45655-200">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="45655-201">Scott 以獨立的顧問、訓練員和作者的身分運作。</span><span class="sxs-lookup"><span data-stu-id="45655-201">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="45655-202">他的最新著作是[*在24小時內讓自己的 ASP.NET 2.0*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="45655-202">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="45655-203">他可以在mitchell@4GuysFromRolla.com觸達[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="45655-203">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="45655-204">或者透過他的 blog，可以在[http://ScottOnWriting.NET](http://ScottOnWriting.NET)找到。</span><span class="sxs-lookup"><span data-stu-id="45655-204">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="45655-205">特別感謝</span><span class="sxs-lookup"><span data-stu-id="45655-205">Special Thanks To</span></span>

<span data-ttu-id="45655-206">本教學課程系列已由許多有用的審核者所審查。</span><span class="sxs-lookup"><span data-stu-id="45655-206">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="45655-207">本教學課程的領導審查者為 Hilton Giesenow。</span><span class="sxs-lookup"><span data-stu-id="45655-207">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="45655-208">有興趣複習我即將發行的 MSDN 文章嗎？</span><span class="sxs-lookup"><span data-stu-id="45655-208">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="45655-209">若是如此，請在mitchell@4GuysFromRolla.com的那一行下拉式[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="45655-209">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="45655-210">[上一頁](displaying-data-with-the-objectdatasource-vb.md)
> [下一頁](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)</span><span class="sxs-lookup"><span data-stu-id="45655-210">[Previous](displaying-data-with-the-objectdatasource-vb.md)
[Next](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)</span></span>
