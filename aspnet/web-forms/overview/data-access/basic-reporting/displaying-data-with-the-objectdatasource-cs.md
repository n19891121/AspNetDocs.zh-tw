---
uid: web-forms/overview/data-access/basic-reporting/displaying-data-with-the-objectdatasource-cs
title: 使用 ObjectDataSource （C#）顯示資料 |Microsoft Docs
author: rick-anderson
description: 本教學課程會查看使用此控制項的 ObjectDataSource 控制項您可以系結從上一個教學課程中建立的 BLL 抓取的資料，而不需要 havi 。
ms.author: riande
ms.date: 03/31/2010
ms.assetid: af882aef-56f5-4e9a-8f95-3977fde20e74
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/displaying-data-with-the-objectdatasource-cs
msc.type: authoredcontent
ms.openlocfilehash: 9419504ace15b39c35a034dda22f2700ee720157
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/28/2019
ms.locfileid: "74608916"
---
# <a name="displaying-data-with-the-objectdatasource-c"></a><span data-ttu-id="42b62-103">使用 ObjectDataSource 顯示資料 (C#)</span><span class="sxs-lookup"><span data-stu-id="42b62-103">Displaying Data With the ObjectDataSource (C#)</span></span>

<span data-ttu-id="42b62-104">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="42b62-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="42b62-105">[下載範例應用程式](https://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_4_CS.exe)或[下載 PDF](displaying-data-with-the-objectdatasource-cs/_static/datatutorial04cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="42b62-105">[Download Sample App](https://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_4_CS.exe) or [Download PDF](displaying-data-with-the-objectdatasource-cs/_static/datatutorial04cs1.pdf)</span></span>

> <span data-ttu-id="42b62-106">本教學課程探討使用此控制項的 ObjectDataSource 控制項您可以系結從上一個教學課程中建立的 BLL 抓取的資料，而不需要撰寫一行程式碼！</span><span class="sxs-lookup"><span data-stu-id="42b62-106">This tutorial looks at the ObjectDataSource control Using this control you can bind data retrieved from the BLL created in the previous tutorial without having to write a line of code!</span></span>

## <a name="introduction"></a><span data-ttu-id="42b62-107">簡介</span><span class="sxs-lookup"><span data-stu-id="42b62-107">Introduction</span></span>

<span data-ttu-id="42b62-108">當我們的應用程式架構和網站頁面配置完成後，我們就準備好開始探索如何完成各種常見的資料和報告相關工作。</span><span class="sxs-lookup"><span data-stu-id="42b62-108">With our application architecture and website page layout complete, we're ready to start exploring how to accomplish a variety of common data- and reporting-related tasks.</span></span> <span data-ttu-id="42b62-109">在先前的教學課程中，我們已瞭解如何以程式設計方式，將資料從 DAL 和 BLL 系結至 ASP.NET 網頁中的資料 Web 控制項。</span><span class="sxs-lookup"><span data-stu-id="42b62-109">In the previous tutorials we've seen how to programmatically bind data from the DAL and BLL to a data Web control in an ASP.NET page.</span></span> <span data-ttu-id="42b62-110">這個語法會將資料 Web 控制項的 `DataSource` 屬性指派給要顯示的資料，然後呼叫控制項的 `DataBind()` 方法是 ASP.NET 1.x 應用程式中所使用的模式，而且可以繼續在2.0 應用程式中使用。</span><span class="sxs-lookup"><span data-stu-id="42b62-110">This syntax assigning the data Web control's `DataSource` property to the data to display and then calling the control's `DataBind()` method was the pattern used in ASP.NET 1.x applications, and can continue to be used in your 2.0 applications.</span></span> <span data-ttu-id="42b62-111">不過，ASP.NET 2.0 的新資料來源控制項提供宣告式方式來處理資料。</span><span class="sxs-lookup"><span data-stu-id="42b62-111">However, ASP.NET 2.0's new data source controls offer a declarative way to work with data.</span></span> <span data-ttu-id="42b62-112">使用這些控制項，您可以系結從[上一個教學](../introduction/creating-a-business-logic-layer-cs.md)課程中建立的 BLL 抓取的資料，而不需要撰寫一行程式碼！</span><span class="sxs-lookup"><span data-stu-id="42b62-112">Using these controls you can bind data retrieved from the BLL created in the [previous tutorial](../introduction/creating-a-business-logic-layer-cs.md) without having to write a line of code!</span></span>

<span data-ttu-id="42b62-113">ASP.NET 2.0 隨附五個內建的資料來源控制項[SqlDataSource](https://msdn.microsoft.com/library/dz12d98w(vs.80).aspx)、 [AccessDataSource](https://msdn.microsoft.com/library/8e5545e1.aspx)、 [ObjectDataSource](https://msdn.microsoft.com/library/9a4kyhcx.aspx)、 [XmlDataSource](https://msdn.microsoft.com/library/e8d8587a(en-US,VS.80).aspx)和[SiteMapDataSource](https://msdn.microsoft.com/library/5ex9t96x(en-US,VS.80).aspx) ，不過您可以視需要建立自己的[自訂資料來源控制項](https://msdn.microsoft.com/library/default.asp?url=/library/dnvs05/html/DataSourceCon1.asp)。</span><span class="sxs-lookup"><span data-stu-id="42b62-113">ASP.NET 2.0 ships with five built-in data source controls [SqlDataSource](https://msdn.microsoft.com/library/dz12d98w(vs.80).aspx), [AccessDataSource](https://msdn.microsoft.com/library/8e5545e1.aspx), [ObjectDataSource](https://msdn.microsoft.com/library/9a4kyhcx.aspx), [XmlDataSource](https://msdn.microsoft.com/library/e8d8587a(en-US,VS.80).aspx), and [SiteMapDataSource](https://msdn.microsoft.com/library/5ex9t96x(en-US,VS.80).aspx) although you can build your own [custom data source controls](https://msdn.microsoft.com/library/default.asp?url=/library/dnvs05/html/DataSourceCon1.asp), if needed.</span></span> <span data-ttu-id="42b62-114">由於我們已開發教學課程應用程式的架構，因此我們將針對 BLL 類別使用 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="42b62-114">Since we have developed an architecture for our tutorial application, we'll be using the ObjectDataSource against our BLL classes.</span></span>

![ASP.NET 2.0 包含五個內建的資料來源控制項](displaying-data-with-the-objectdatasource-cs/_static/image1.png)

<span data-ttu-id="42b62-116">**圖 1**： ASP.NET 2.0 包含五個內建的資料來源控制項</span><span class="sxs-lookup"><span data-stu-id="42b62-116">**Figure 1**: ASP.NET 2.0 Includes Five Built-In Data Source Controls</span></span>

<span data-ttu-id="42b62-117">ObjectDataSource 做為使用其他物件的 proxy。</span><span class="sxs-lookup"><span data-stu-id="42b62-117">The ObjectDataSource serves as a proxy for working with some other object.</span></span> <span data-ttu-id="42b62-118">若要設定 ObjectDataSource，我們會指定此基礎物件，以及其方法如何對應至 ObjectDataSource 的 `Select`、`Insert`、`Update`和 `Delete` 方法。</span><span class="sxs-lookup"><span data-stu-id="42b62-118">To configure the ObjectDataSource we specify this underlying object and how its methods map to the ObjectDataSource's `Select`, `Insert`, `Update`, and `Delete` methods.</span></span> <span data-ttu-id="42b62-119">一旦指定此基礎物件，並將其方法對應至 ObjectDataSource 的之後，我們就可以將 ObjectDataSource 系結至資料 Web 控制項。</span><span class="sxs-lookup"><span data-stu-id="42b62-119">Once this underlying object has been specified and its methods mapped to the ObjectDataSource's, we can then bind the ObjectDataSource to a data Web control.</span></span> <span data-ttu-id="42b62-120">ASP.NET 隨附許多資料 Web 控制項，包括 GridView、DetailsView、RadioButtonList 和 DropDownList，還有其他。</span><span class="sxs-lookup"><span data-stu-id="42b62-120">ASP.NET ships with many data Web controls, including the GridView, DetailsView, RadioButtonList, and DropDownList, among others.</span></span> <span data-ttu-id="42b62-121">在頁面生命週期期間，資料 Web 控制項可能需要存取其所系結的資料，這會藉由叫用其 ObjectDataSource 的 `Select` 方法來完成。如果資料 Web 控制項支援插入、更新或刪除，則可能會對其 ObjectDataSource 的 `Insert`、`Update`或 `Delete` 方法進行呼叫。</span><span class="sxs-lookup"><span data-stu-id="42b62-121">During the page lifecycle, the data Web control may need to access the data it's bound to, which it will accomplish by invoking its ObjectDataSource's `Select` method; if the data Web control supports inserting, updating, or deleting, calls may be made to its ObjectDataSource's `Insert`, `Update`, or `Delete` methods.</span></span> <span data-ttu-id="42b62-122">然後，ObjectDataSource 會將這些呼叫路由至適當的基礎物件方法，如下圖所示。</span><span class="sxs-lookup"><span data-stu-id="42b62-122">These calls are then routed by the ObjectDataSource to the appropriate underlying object's methods as the following diagram illustrates.</span></span>

<span data-ttu-id="42b62-123">[![ObjectDataSource 作為 Proxy](displaying-data-with-the-objectdatasource-cs/_static/image3.png)](displaying-data-with-the-objectdatasource-cs/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="42b62-123">[![The ObjectDataSource Serves as a Proxy](displaying-data-with-the-objectdatasource-cs/_static/image3.png)](displaying-data-with-the-objectdatasource-cs/_static/image2.png)</span></span>

<span data-ttu-id="42b62-124">**圖 2**： ObjectDataSource 作為 Proxy （[按一下以查看完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image4.png)）</span><span class="sxs-lookup"><span data-stu-id="42b62-124">**Figure 2**: The ObjectDataSource Serves as a Proxy ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image4.png))</span></span>

<span data-ttu-id="42b62-125">雖然 ObjectDataSource 可用來叫用插入、更新或刪除資料的方法，但讓我們只著重于傳回資料。未來的教學課程將使用可修改資料的 ObjectDataSource 和資料 Web 控制項來進行探索。</span><span class="sxs-lookup"><span data-stu-id="42b62-125">While the ObjectDataSource can be used to invoke methods for inserting, updating, or deleting data, let's just focus on returning data; future tutorials will explore using the ObjectDataSource and data Web controls that modify data.</span></span>

## <a name="step-1-adding-and-configuring-the-objectdatasource-control"></a><span data-ttu-id="42b62-126">步驟1：新增和設定 ObjectDataSource 控制項</span><span class="sxs-lookup"><span data-stu-id="42b62-126">Step 1: Adding and Configuring the ObjectDataSource Control</span></span>

<span data-ttu-id="42b62-127">首先，開啟 [`BasicReporting`] 資料夾中的 [`SimpleDisplay.aspx`] 頁面，切換至 [設計檢視]，然後將 [ObjectDataSource] 控制項從 [工具箱] 拖曳至頁面的設計介面上。</span><span class="sxs-lookup"><span data-stu-id="42b62-127">Start by opening the `SimpleDisplay.aspx` page in the `BasicReporting` folder, switch to Design view, and then drag an ObjectDataSource control from the Toolbox onto the page's design surface.</span></span> <span data-ttu-id="42b62-128">ObjectDataSource 會在設計介面上顯示為灰色方塊，因為它不會產生任何標記;它只會從指定的物件叫用方法來存取資料。</span><span class="sxs-lookup"><span data-stu-id="42b62-128">The ObjectDataSource appears as a gray box on the design surface because it does not produce any markup; it simply accesses data by invoking a method from a specified object.</span></span> <span data-ttu-id="42b62-129">ObjectDataSource 所傳回的資料可以由資料 Web 控制項（例如 GridView、DetailsView、FormView 等等）顯示。</span><span class="sxs-lookup"><span data-stu-id="42b62-129">The data returned by an ObjectDataSource can be displayed by a data Web control, such as the GridView, DetailsView, FormView, and so on.</span></span>

> [!NOTE]
> <span data-ttu-id="42b62-130">或者，您可以先將資料 Web 控制項加入至頁面，然後從其智慧標籤，選擇下拉式清單中的 [&lt;新資料來源&gt;] 選項。</span><span class="sxs-lookup"><span data-stu-id="42b62-130">Alternatively, you may first add the data Web control to the page and then, from its smart tag, choose the &lt;New data source&gt; option from the drop-down list.</span></span>

<span data-ttu-id="42b62-131">若要指定 ObjectDataSource 的基礎物件，以及該物件的方法如何對應到 ObjectDataSource，請按一下 ObjectDataSource 的智慧標籤中的 [設定資料來源] 連結。</span><span class="sxs-lookup"><span data-stu-id="42b62-131">To specify the ObjectDataSource's underlying object and how that object's methods map to the ObjectDataSource's, click on the Configure Data Source link from the ObjectDataSource's smart tag.</span></span>

<span data-ttu-id="42b62-132">[![按一下智慧標籤中的 [設定資料來源] 連結](displaying-data-with-the-objectdatasource-cs/_static/image6.png)](displaying-data-with-the-objectdatasource-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="42b62-132">[![Click the Configure Data Source Link from the Smart Tag](displaying-data-with-the-objectdatasource-cs/_static/image6.png)](displaying-data-with-the-objectdatasource-cs/_static/image5.png)</span></span>

<span data-ttu-id="42b62-133">**圖 3**：按一下智慧標籤中的 [設定資料來源] 連結（[按一下以查看完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image7.png)）</span><span class="sxs-lookup"><span data-stu-id="42b62-133">**Figure 3**: Click the Configure Data Source Link from the Smart Tag ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image7.png))</span></span>

<span data-ttu-id="42b62-134">這會顯示 [設定資料來源] wizard。</span><span class="sxs-lookup"><span data-stu-id="42b62-134">This brings up the Configure Data Source wizard.</span></span> <span data-ttu-id="42b62-135">首先，我們必須指定 ObjectDataSource 要使用的物件。</span><span class="sxs-lookup"><span data-stu-id="42b62-135">First, we must specify the object the ObjectDataSource is to work with.</span></span> <span data-ttu-id="42b62-136">如果已核取 [只顯示資料元件] 核取方塊，則此畫面上的下拉式清單只會列出已使用 `DataObject` 屬性裝飾的物件。</span><span class="sxs-lookup"><span data-stu-id="42b62-136">If the "Show only data components" checkbox is checked, the drop-down list on this screen lists only those objects that have been decorated with the `DataObject` attribute.</span></span> <span data-ttu-id="42b62-137">目前，我們的清單包含具類型資料集的 Tableadapter，以及我們在上一個教學課程中建立的 BLL 類別。</span><span class="sxs-lookup"><span data-stu-id="42b62-137">Currently our list includes the TableAdapters in the Typed DataSet and the BLL classes we created in the previous tutorial.</span></span> <span data-ttu-id="42b62-138">如果您忘記將 `DataObject` 屬性新增到商務邏輯層類別，就不會在這份清單中看到它們。</span><span class="sxs-lookup"><span data-stu-id="42b62-138">If you forgot to add the `DataObject` attribute to the Business Logic Layer classes you won't see them in this list.</span></span> <span data-ttu-id="42b62-139">在這種情況下，請取消核取 [只顯示資料元件] 核取方塊，以查看所有物件，其中應包含 BLL 類別（以及 Datatable、Datarow 等等的具類型資料集內的其他類別）。</span><span class="sxs-lookup"><span data-stu-id="42b62-139">In that case, uncheck the "Show only data components" checkbox to view all objects, which should include the BLL classes (along with the other classes in the Typed DataSet the DataTables, DataRows, and so on).</span></span>

<span data-ttu-id="42b62-140">在第一個畫面上，從下拉式清單中選擇 [`ProductsBLL`] 類別，然後按 [下一步]。</span><span class="sxs-lookup"><span data-stu-id="42b62-140">From this first screen choose the `ProductsBLL` class from the drop-down list and click Next.</span></span>

<span data-ttu-id="42b62-141">[![指定要搭配 ObjectDataSource 控制項使用的物件](displaying-data-with-the-objectdatasource-cs/_static/image9.png)](displaying-data-with-the-objectdatasource-cs/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="42b62-141">[![Specify the Object to Use with the ObjectDataSource Control](displaying-data-with-the-objectdatasource-cs/_static/image9.png)](displaying-data-with-the-objectdatasource-cs/_static/image8.png)</span></span>

<span data-ttu-id="42b62-142">**圖 4**：指定要搭配 ObjectDataSource 控制項使用的物件（[按一下以查看完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image10.png)）</span><span class="sxs-lookup"><span data-stu-id="42b62-142">**Figure 4**: Specify the Object to Use with the ObjectDataSource Control ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image10.png))</span></span>

<span data-ttu-id="42b62-143">Wizard 中的下一個畫面會提示您選取 ObjectDataSource 應叫用的方法。</span><span class="sxs-lookup"><span data-stu-id="42b62-143">The next screen in the wizard prompts you to select what method the ObjectDataSource should invoke.</span></span> <span data-ttu-id="42b62-144">下拉式清單會列出從上一個畫面中選取的物件中傳回資料的方法。</span><span class="sxs-lookup"><span data-stu-id="42b62-144">The drop-down lists those methods that return data in the object selected from the previous screen.</span></span> <span data-ttu-id="42b62-145">在這裡，我們會看到 `GetProductByProductID`、`GetProducts`、`GetProductsByCategoryID`和 `GetProductsBySupplierID`。</span><span class="sxs-lookup"><span data-stu-id="42b62-145">Here we see `GetProductByProductID`, `GetProducts`, `GetProductsByCategoryID`, and `GetProductsBySupplierID`.</span></span> <span data-ttu-id="42b62-146">從下拉式清單中選取 [`GetProducts`] 方法，然後按一下 [完成] （如果您已將 `DataObjectMethodAttribute` 新增至 `ProductBLL`的方法（如先前的教學課程所示），則預設會選取此選項）。</span><span class="sxs-lookup"><span data-stu-id="42b62-146">Select the `GetProducts` method from the drop-down list and click Finish (if you added the `DataObjectMethodAttribute` to the `ProductBLL`'s methods as shown in the previous tutorial, this option will be selected by default).</span></span>

<span data-ttu-id="42b62-147">[![選擇從 [選取] 索引標籤傳回資料的方法](displaying-data-with-the-objectdatasource-cs/_static/image12.png)](displaying-data-with-the-objectdatasource-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="42b62-147">[![Choose the Method for Returning Data from the SELECT Tab](displaying-data-with-the-objectdatasource-cs/_static/image12.png)](displaying-data-with-the-objectdatasource-cs/_static/image11.png)</span></span>

<span data-ttu-id="42b62-148">**圖 5**：選擇從 [選取] 索引標籤傳回資料的方法（[按一下以查看完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image13.png)）</span><span class="sxs-lookup"><span data-stu-id="42b62-148">**Figure 5**: Choose the Method for Returning Data from the SELECT Tab ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image13.png))</span></span>

## <a name="configure-the-objectdatasource-manually"></a><span data-ttu-id="42b62-149">手動設定 ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="42b62-149">Configure the ObjectDataSource Manually</span></span>

<span data-ttu-id="42b62-150">ObjectDataSource 的 [設定資料來源] wizard 提供快速的方法來指定它所使用的物件，以及關聯要叫用的物件方法。</span><span class="sxs-lookup"><span data-stu-id="42b62-150">The ObjectDataSource's Configure Data Source wizard offers a quick way to specify the object it uses and to associate what methods of the object are invoked.</span></span> <span data-ttu-id="42b62-151">不過，您可以透過屬性視窗或直接在宣告式標記中，透過其屬性來設定 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="42b62-151">You can, however, configure the ObjectDataSource through its properties, either through the Properties window or directly in the declarative markup.</span></span> <span data-ttu-id="42b62-152">只需將 `TypeName` 屬性設為要使用之基礎物件的類型，並將 `SelectMethod` 設定為要在抓取資料時叫用的方法。</span><span class="sxs-lookup"><span data-stu-id="42b62-152">Simply set the `TypeName` property to the type of the underlying object to be used, and the `SelectMethod` to the method to invoke when retrieving data.</span></span>

[!code-aspx[Main](displaying-data-with-the-objectdatasource-cs/samples/sample1.aspx)]

<span data-ttu-id="42b62-153">即使您偏好使用 [設定資料來源]，也可能需要手動設定 ObjectDataSource，因為 wizard 只會列出開發人員所建立的類別。</span><span class="sxs-lookup"><span data-stu-id="42b62-153">Even if you prefer the Configure Data Source wizard there may be times when you need to manually configure the ObjectDataSource, as the wizard only lists developer-created classes.</span></span> <span data-ttu-id="42b62-154">如果您想要將 ObjectDataSource 系結至 .NET Framework 中的類別，例如[成員資格類別](https://msdn.microsoft.com/library/system.web.security.membership.aspx)、存取使用者帳戶資訊，或使用[目錄類別](https://msdn.microsoft.com/library/system.io.directory.aspx)來處理檔案系統資訊，您將需要手動設定 ObjectDataSource 的屬性。</span><span class="sxs-lookup"><span data-stu-id="42b62-154">If you want to bind the ObjectDataSource to a class in the .NET Framework such as the [Membership class](https://msdn.microsoft.com/library/system.web.security.membership.aspx), to access user account information, or the [Directory class](https://msdn.microsoft.com/library/system.io.directory.aspx) to work with file system information you'll need to manually set the ObjectDataSource's properties.</span></span>

## <a name="step-2-adding-a-data-web-control-and-binding-it-to-the-objectdatasource"></a><span data-ttu-id="42b62-155">步驟2：加入資料 Web 控制項並將它系結至 ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="42b62-155">Step 2: Adding a Data Web Control and Binding it to the ObjectDataSource</span></span>

<span data-ttu-id="42b62-156">一旦將 ObjectDataSource 新增至頁面並設定之後，我們就可以將資料 Web 控制項加入至頁面，以顯示 ObjectDataSource 的 `Select` 方法所傳回的資料。</span><span class="sxs-lookup"><span data-stu-id="42b62-156">Once the ObjectDataSource has been added to the page and configured, we're ready to add data Web controls to the page to display the data returned by the ObjectDataSource's `Select` method.</span></span> <span data-ttu-id="42b62-157">任何資料 Web 控制項都可以系結至 ObjectDataSource;讓我們看看如何在 GridView、DetailsView 和 FormView 中顯示 ObjectDataSource 的資料。</span><span class="sxs-lookup"><span data-stu-id="42b62-157">Any data Web control can be bound to an ObjectDataSource; let's look at displaying the ObjectDataSource's data in a GridView, DetailsView, and FormView.</span></span>

## <a name="binding-a-gridview-to-the-objectdatasource"></a><span data-ttu-id="42b62-158">將 GridView 系結至 ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="42b62-158">Binding a GridView to the ObjectDataSource</span></span>

<span data-ttu-id="42b62-159">從 [工具箱] 將 GridView 控制項新增至 `SimpleDisplay.aspx`的設計介面。</span><span class="sxs-lookup"><span data-stu-id="42b62-159">Add a GridView control from the Toolbox to `SimpleDisplay.aspx`'s design surface.</span></span> <span data-ttu-id="42b62-160">從 GridView 的智慧標籤中，選擇我們在步驟1中新增的 ObjectDataSource 控制項。</span><span class="sxs-lookup"><span data-stu-id="42b62-160">From the GridView's smart tag, choose the ObjectDataSource control we added in Step 1.</span></span> <span data-ttu-id="42b62-161">這會在 GridView 中針對資料從 ObjectDataSource 的 `Select` 方法（也就是 Products DataTable 所定義的屬性）傳回的每個屬性，自動建立一個 BoundField。</span><span class="sxs-lookup"><span data-stu-id="42b62-161">This will automatically create a BoundField in the GridView for each property returned by the data from the ObjectDataSource's `Select` method (namely, the properties defined by the Products DataTable).</span></span>

<span data-ttu-id="42b62-162">[![GridView 已加入至頁面，並系結至 ObjectDataSource](displaying-data-with-the-objectdatasource-cs/_static/image15.png)](displaying-data-with-the-objectdatasource-cs/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="42b62-162">[![A GridView Has Been Added to the Page and Bound to the ObjectDataSource](displaying-data-with-the-objectdatasource-cs/_static/image15.png)](displaying-data-with-the-objectdatasource-cs/_static/image14.png)</span></span>

<span data-ttu-id="42b62-163">**圖 6**： GridView 已加入至頁面，並系結至 ObjectDataSource （[按一下以查看完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image16.png)）</span><span class="sxs-lookup"><span data-stu-id="42b62-163">**Figure 6**: A GridView Has Been Added to the Page and Bound to the ObjectDataSource ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image16.png))</span></span>

<span data-ttu-id="42b62-164">接著，您可以從智慧標籤按一下 [編輯資料行] 選項，以自訂、重新排列或移除 GridView 的 BoundFields。</span><span class="sxs-lookup"><span data-stu-id="42b62-164">You can then customize, rearrange, or remove the GridView's BoundFields by clicking the Edit Columns option from the smart tag.</span></span>

<span data-ttu-id="42b62-165">[![透過 [編輯資料行] 對話方塊來管理 GridView 的 BoundFields](displaying-data-with-the-objectdatasource-cs/_static/image18.png)](displaying-data-with-the-objectdatasource-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="42b62-165">[![Manage the GridView's BoundFields Through the Edit Columns Dialog Box](displaying-data-with-the-objectdatasource-cs/_static/image18.png)](displaying-data-with-the-objectdatasource-cs/_static/image17.png)</span></span>

<span data-ttu-id="42b62-166">**圖 7**：透過 [編輯資料行] 對話方塊來管理 GridView 的 BoundFields （[按一下以查看完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image19.png)）</span><span class="sxs-lookup"><span data-stu-id="42b62-166">**Figure 7**: Manage the GridView's BoundFields Through the Edit Columns Dialog Box ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image19.png))</span></span>

<span data-ttu-id="42b62-167">請花一些時間修改 GridView 的 BoundFields，移除 `ProductID`、`SupplierID`、`CategoryID`、`QuantityPerUnit`、`UnitsInStock`、`UnitsOnOrder`和 `ReorderLevel` BoundFields。</span><span class="sxs-lookup"><span data-stu-id="42b62-167">Take a moment to modify the GridView's BoundFields, removing the `ProductID`, `SupplierID`, `CategoryID`, `QuantityPerUnit`, `UnitsInStock`, `UnitsOnOrder`, and `ReorderLevel` BoundFields.</span></span> <span data-ttu-id="42b62-168">只要從左下方的清單中選取 [BoundField]，然後按一下 [刪除] 按鈕（紅色 X）來移除它們。</span><span class="sxs-lookup"><span data-stu-id="42b62-168">Simply select the BoundField from the list in the bottom left and click the delete button (the red X) to remove them.</span></span> <span data-ttu-id="42b62-169">接下來，重新排列 BoundFields，讓 `CategoryName` 和 `SupplierName` BoundFields 在 `UnitPrice` BoundField 前面選取這些 BoundFields，然後按一下向上箭號。</span><span class="sxs-lookup"><span data-stu-id="42b62-169">Next, Rearrange the BoundFields so that the `CategoryName` and `SupplierName` BoundFields precede the `UnitPrice` BoundField by selecting these BoundFields and clicking the up arrow.</span></span> <span data-ttu-id="42b62-170">將其餘 BoundFields 的 `HeaderText` 屬性分別設定為 `Products`、`Category`、`Supplier`和 `Price`。</span><span class="sxs-lookup"><span data-stu-id="42b62-170">Set the `HeaderText` properties of the remaining BoundFields to `Products`, `Category`, `Supplier`, and `Price`, respectively.</span></span> <span data-ttu-id="42b62-171">接下來，將 BoundField 的 [`HtmlEncode`] 屬性設為 False，並將其 `DataFormatString` 屬性設定為 [`{0:c}`]，以將 `Price` BoundField 格式化為貨幣。</span><span class="sxs-lookup"><span data-stu-id="42b62-171">Next, have the `Price` BoundField formatted as a currency by setting the BoundField's `HtmlEncode` property to False and its `DataFormatString` property to `{0:c}`.</span></span> <span data-ttu-id="42b62-172">最後，透過 [`ItemStyle`/`HorizontalAlign`] 屬性，水準對齊 `Price` 和中心的 [`Discontinued`] 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="42b62-172">Finally, horizontally align the `Price` to the right and the `Discontinued` checkbox in the center via the `ItemStyle`/`HorizontalAlign` property.</span></span>

[!code-aspx[Main](displaying-data-with-the-objectdatasource-cs/samples/sample2.aspx)]

<span data-ttu-id="42b62-173">[![GridView 的 BoundFields 已自訂](displaying-data-with-the-objectdatasource-cs/_static/image21.png)](displaying-data-with-the-objectdatasource-cs/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="42b62-173">[![The GridView's BoundFields Have Been Customized](displaying-data-with-the-objectdatasource-cs/_static/image21.png)](displaying-data-with-the-objectdatasource-cs/_static/image20.png)</span></span>

<span data-ttu-id="42b62-174">**圖 8**： GridView 的 BoundFields 已經過自訂（[按一下以觀看完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image22.png)）</span><span class="sxs-lookup"><span data-stu-id="42b62-174">**Figure 8**: The GridView's BoundFields Have Been Customized ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image22.png))</span></span>

## <a name="using-themes-for-a-consistent-look"></a><span data-ttu-id="42b62-175">使用主題進行一致的外觀</span><span class="sxs-lookup"><span data-stu-id="42b62-175">Using Themes for a Consistent Look</span></span>

<span data-ttu-id="42b62-176">這些教學課程致力於移除任何控制層級的樣式設定，而不是盡可能使用外部檔案中定義的級聯樣式表。</span><span class="sxs-lookup"><span data-stu-id="42b62-176">These tutorials strive to remove any control-level style settings, instead using cascading style sheets defined in an external file whenever possible.</span></span> <span data-ttu-id="42b62-177">`Styles.css` 檔案包含 `DataWebControlStyle`、`HeaderStyle`、`RowStyle`和 `AlternatingRowStyle` CSS 類別，這些類別應該用來指定這些教學課程中所使用之資料 Web 控制項的外觀。</span><span class="sxs-lookup"><span data-stu-id="42b62-177">The `Styles.css` file contains `DataWebControlStyle`, `HeaderStyle`, `RowStyle`, and `AlternatingRowStyle` CSS classes that should be used to dictate the appearance of the data Web controls used in these tutorials.</span></span> <span data-ttu-id="42b62-178">為了達成此目的，我們可以將 GridView 的 `CssClass` 屬性設定為 `DataWebControlStyle`，並據此將其 `HeaderStyle`、`RowStyle`和 `AlternatingRowStyle` 屬性的 `CssClass` 屬性。</span><span class="sxs-lookup"><span data-stu-id="42b62-178">To accomplish this, we could set the GridView's `CssClass` property to `DataWebControlStyle`, and its `HeaderStyle`, `RowStyle`, and `AlternatingRowStyle` properties' `CssClass` properties accordingly.</span></span>

<span data-ttu-id="42b62-179">如果我們在 Web 控制項上設定這些 `CssClass` 屬性，我們必須記得針對新增至教學課程的每一個資料 Web 控制項，明確設定這些屬性值。</span><span class="sxs-lookup"><span data-stu-id="42b62-179">If we set these `CssClass` properties at the Web control we'd need to remember to explicitly set these property values for each and every data Web control added to our tutorials.</span></span> <span data-ttu-id="42b62-180">更容易管理的方法，是使用主題來定義 GridView、DetailsView 和 FormView 控制項的預設 CSS 相關屬性。</span><span class="sxs-lookup"><span data-stu-id="42b62-180">A more manageable approach is to define the default CSS-related properties for the GridView, DetailsView, and FormView controls using a Theme.</span></span> <span data-ttu-id="42b62-181">主題是控制項層級屬性設定、影像和 CSS 類別的集合，可套用至網站上的頁面，以強制執行常見的外觀與風格。</span><span class="sxs-lookup"><span data-stu-id="42b62-181">A Theme is a collection of control-level property settings, images, and CSS classes that can be applied to pages across a site to enforce a common look and feel.</span></span>

<span data-ttu-id="42b62-182">我們的主題不會包含任何影像或 CSS 檔案（我們會在 web 應用程式的根資料夾中定義樣式表單 `Styles.css`，但會包含兩個外觀）。</span><span class="sxs-lookup"><span data-stu-id="42b62-182">Our Theme won't include any images or CSS files (we'll leave the stylesheet `Styles.css` as-is, defined in the root folder of the web application), but will include two Skins.</span></span> <span data-ttu-id="42b62-183">「面板」是一種檔案，可定義 Web 控制項的預設屬性。</span><span class="sxs-lookup"><span data-stu-id="42b62-183">A Skin is a file that defines the default properties for a Web control.</span></span> <span data-ttu-id="42b62-184">具體而言，我們會有 GridView 和 DetailsView 控制項的面板檔案，表示預設 `CssClass`相關的屬性。</span><span class="sxs-lookup"><span data-stu-id="42b62-184">Specifically, we'll have a Skin file for the GridView and DetailsView controls, indicating the default `CssClass`-related properties.</span></span>

<span data-ttu-id="42b62-185">首先，在 方案總管中的專案名稱上按一下滑鼠右鍵，然後選擇 加入新專案，以將新的面板檔案新增至名為 `GridView.skin` 的專案。</span><span class="sxs-lookup"><span data-stu-id="42b62-185">Start by adding a new Skin File to your project named `GridView.skin` by right-clicking on the project name in the Solution Explorer and choosing Add New Item.</span></span>

<span data-ttu-id="42b62-186">[![新增名為 GridView 的外觀檔](displaying-data-with-the-objectdatasource-cs/_static/image24.png)](displaying-data-with-the-objectdatasource-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="42b62-186">[![Add a Skin File Named GridView.skin](displaying-data-with-the-objectdatasource-cs/_static/image24.png)](displaying-data-with-the-objectdatasource-cs/_static/image23.png)</span></span>

<span data-ttu-id="42b62-187">**圖 9**：新增名為 `GridView.skin` 的面板檔案（[按一下以觀看完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image25.png)）</span><span class="sxs-lookup"><span data-stu-id="42b62-187">**Figure 9**: Add a Skin File Named `GridView.skin` ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image25.png))</span></span>

<span data-ttu-id="42b62-188">面板檔案必須放在位於 [`App_Themes`] 資料夾中的主題中。</span><span class="sxs-lookup"><span data-stu-id="42b62-188">Skin files need to be placed in a Theme, which are located in the `App_Themes` folder.</span></span> <span data-ttu-id="42b62-189">因為我們還沒有這類資料夾，所以當您新增第一個面板時，Visual Studio 會提供給我們。</span><span class="sxs-lookup"><span data-stu-id="42b62-189">Since we don't yet have such a folder, Visual Studio will kindly offer to create one for us when adding our first Skin.</span></span> <span data-ttu-id="42b62-190">按一下 [是] 建立 `App_Theme` 資料夾，並將新的 `GridView.skin` 檔案放到該處。</span><span class="sxs-lookup"><span data-stu-id="42b62-190">Click Yes to create the `App_Theme` folder and place the new `GridView.skin` file there.</span></span>

<span data-ttu-id="42b62-191">[![讓 Visual Studio 建立 App_Theme 資料夾](displaying-data-with-the-objectdatasource-cs/_static/image27.png)](displaying-data-with-the-objectdatasource-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="42b62-191">[![Let Visual Studio Create the App_Theme Folder](displaying-data-with-the-objectdatasource-cs/_static/image27.png)](displaying-data-with-the-objectdatasource-cs/_static/image26.png)</span></span>

<span data-ttu-id="42b62-192">**圖 10**：讓 Visual Studio 建立 `App_Theme` 資料夾（[按一下以查看完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image28.png)）</span><span class="sxs-lookup"><span data-stu-id="42b62-192">**Figure 10**: Let Visual Studio Create the `App_Theme` Folder ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image28.png))</span></span>

<span data-ttu-id="42b62-193">這會在名為 GridView 的 `App_Themes` 資料夾中，使用面板檔案 `GridView.skin`建立新的主題。</span><span class="sxs-lookup"><span data-stu-id="42b62-193">This will create a new Theme in the `App_Themes` folder named GridView with the Skin file `GridView.skin`.</span></span>

![GridView 主題已新增至 [App_Theme] 資料夾](displaying-data-with-the-objectdatasource-cs/_static/image29.png)

<span data-ttu-id="42b62-195">**圖 11**： GridView 主題已新增至 [`App_Theme`] 資料夾</span><span class="sxs-lookup"><span data-stu-id="42b62-195">**Figure 11**: The GridView Theme has Been Added to the `App_Theme` Folder</span></span>

<span data-ttu-id="42b62-196">將 GridView 主題重新命名為 DataWebControls （以滑鼠右鍵按一下 [`App_Theme`] 資料夾中的 [GridView] 資料夾，然後選擇 [重新命名]）。</span><span class="sxs-lookup"><span data-stu-id="42b62-196">Rename the GridView Theme to DataWebControls (right-click on the GridView folder in the `App_Theme` folder and choose Rename).</span></span> <span data-ttu-id="42b62-197">接下來，在 `GridView.skin` 檔案中輸入下列標記：</span><span class="sxs-lookup"><span data-stu-id="42b62-197">Next, enter the following markup into the `GridView.skin` file:</span></span>

[!code-aspx[Main](displaying-data-with-the-objectdatasource-cs/samples/sample3.aspx)]

<span data-ttu-id="42b62-198">這會在任何使用 DataWebControls 主題的頁面中，為任何 GridView 定義 `CssClass`相關屬性的預設屬性。</span><span class="sxs-lookup"><span data-stu-id="42b62-198">This defines the default properties for the `CssClass`-related properties for any GridView in any page that uses the DataWebControls Theme.</span></span> <span data-ttu-id="42b62-199">讓我們為 DetailsView 新增另一個外觀，這是我們很快就會用到的資料 Web 控制項。</span><span class="sxs-lookup"><span data-stu-id="42b62-199">Let's add another Skin for the DetailsView, a data Web control that we'll be using shortly.</span></span> <span data-ttu-id="42b62-200">將新的外觀新增至名為 `DetailsView.skin` 的 DataWebControls 主題，並新增下列標記：</span><span class="sxs-lookup"><span data-stu-id="42b62-200">Add a new Skin to the DataWebControls Theme named `DetailsView.skin` and add the following markup:</span></span>

[!code-aspx[Main](displaying-data-with-the-objectdatasource-cs/samples/sample4.aspx)]

<span data-ttu-id="42b62-201">定義主題之後，最後一個步驟是將主題套用至我們的 ASP.NET 網頁。</span><span class="sxs-lookup"><span data-stu-id="42b62-201">With our Theme defined, the last step is to apply the Theme to our ASP.NET page.</span></span> <span data-ttu-id="42b62-202">主題可以逐頁或網站中的所有網頁來套用。</span><span class="sxs-lookup"><span data-stu-id="42b62-202">A Theme can be applied on a page-by-page basis or for all pages in a website.</span></span> <span data-ttu-id="42b62-203">讓我們將此主題用於網站中的所有頁面。</span><span class="sxs-lookup"><span data-stu-id="42b62-203">Let's use this theme for all pages in the website.</span></span> <span data-ttu-id="42b62-204">若要完成這項操作，請將下列標記新增至 `Web.config`的 `<system.web>` 區段：</span><span class="sxs-lookup"><span data-stu-id="42b62-204">To accomplish this, add the following markup to `Web.config`'s `<system.web>` section:</span></span>

[!code-xml[Main](displaying-data-with-the-objectdatasource-cs/samples/sample5.xml)]

<span data-ttu-id="42b62-205">這樣就全部完成了！</span><span class="sxs-lookup"><span data-stu-id="42b62-205">That's all there is to it!</span></span> <span data-ttu-id="42b62-206">`styleSheetTheme` 設定表示主題中指定的屬性*不*應該覆寫在控制項層級指定的屬性。</span><span class="sxs-lookup"><span data-stu-id="42b62-206">The `styleSheetTheme` setting indicates that the properties specified in the Theme should *not* override the properties specified at the control level.</span></span> <span data-ttu-id="42b62-207">若要指定主題設定應該王牌控制設定，請使用 `theme` 屬性來取代 `styleSheetTheme`;可惜的是，透過 `theme` 屬性指定的主題設定不會出現在 Visual Studio 設計檢視中。</span><span class="sxs-lookup"><span data-stu-id="42b62-207">To specify that Theme settings should trump control settings, use the `theme` attribute in place of `styleSheetTheme`; unfortunately, Theme settings specified via the `theme` attribute do not appear in the Visual Studio Design view.</span></span> <span data-ttu-id="42b62-208">如需主題和外觀的詳細資訊，請參閱[ASP.NET 主題和麵板總覽](https://msdn.microsoft.com/library/ykzx33wh.aspx)和[伺服器端樣式](https://quickstarts.asp.net/quickstartv20/aspnet/doc/themes/stylesheettheme.aspx)。如需設定頁面以使用主題的詳細資訊，請參閱 how [To： Apply ASP.NET 主題](https://msdn.microsoft.com/library/0yy5hxdk(VS.80).aspx)。</span><span class="sxs-lookup"><span data-stu-id="42b62-208">Refer to [ASP.NET Themes and Skins Overview](https://msdn.microsoft.com/library/ykzx33wh.aspx) and [Server-Side Styles Using Themes](https://quickstarts.asp.net/quickstartv20/aspnet/doc/themes/stylesheettheme.aspx) for more information on Themes and Skins; see [How To: Apply ASP.NET Themes](https://msdn.microsoft.com/library/0yy5hxdk(VS.80).aspx) for more on configuring a page to use a theme.</span></span>

<span data-ttu-id="42b62-209">[![GridView 會顯示產品的名稱、類別、供應商、價格和已停止的資訊](displaying-data-with-the-objectdatasource-cs/_static/image31.png)](displaying-data-with-the-objectdatasource-cs/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="42b62-209">[![The GridView Displays the Product's Name, Category, Supplier, Price, and Discontinued Information](displaying-data-with-the-objectdatasource-cs/_static/image31.png)](displaying-data-with-the-objectdatasource-cs/_static/image30.png)</span></span>

<span data-ttu-id="42b62-210">**圖 12**： GridView 會顯示產品的名稱、類別、供應商、價格和已停止的資訊（[按一下以查看完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image32.png)）</span><span class="sxs-lookup"><span data-stu-id="42b62-210">**Figure 12**: The GridView Displays the Product's Name, Category, Supplier, Price, and Discontinued Information ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image32.png))</span></span>

## <a name="displaying-one-record-at-a-time-in-the-detailsview"></a><span data-ttu-id="42b62-211">在 DetailsView 中一次顯示一筆記錄</span><span class="sxs-lookup"><span data-stu-id="42b62-211">Displaying One Record at a Time in the DetailsView</span></span>

<span data-ttu-id="42b62-212">GridView 會針對其所系結的資料來源控制項所傳回的每一筆記錄，各顯示一個資料列。</span><span class="sxs-lookup"><span data-stu-id="42b62-212">The GridView displays one row for each record returned by the data source control to which it's bound.</span></span> <span data-ttu-id="42b62-213">不過，有時候我們可能會想要一次顯示一筆記錄，或只顯示一筆記錄。</span><span class="sxs-lookup"><span data-stu-id="42b62-213">There are times, however, when we may want to display a sole record or just one record at a time.</span></span> <span data-ttu-id="42b62-214">[DetailsView 控制項](https://msdn.microsoft.com/library/s3w1w7t4.aspx)提供這項功能，並以 HTML `<table>` 呈現，其中包含兩個數據行，以及一個資料列代表系結至控制項的每個資料行或屬性。</span><span class="sxs-lookup"><span data-stu-id="42b62-214">The [DetailsView control](https://msdn.microsoft.com/library/s3w1w7t4.aspx) offers this functionality, rendering as an HTML `<table>` with two columns and one row for each column or property bound to the control.</span></span> <span data-ttu-id="42b62-215">您可以將 DetailsView 視為具有旋轉90度之單一記錄的 GridView。</span><span class="sxs-lookup"><span data-stu-id="42b62-215">You can think of the DetailsView as a GridView with a single record rotated 90 degrees.</span></span>

<span data-ttu-id="42b62-216">一開始請先在 `SimpleDisplay.aspx`的 GridView*上方*新增 DetailsView 控制項。</span><span class="sxs-lookup"><span data-stu-id="42b62-216">Start by adding a DetailsView control *above* the GridView in `SimpleDisplay.aspx`.</span></span> <span data-ttu-id="42b62-217">接下來，將它系結至與 GridView 相同的 ObjectDataSource 控制項。</span><span class="sxs-lookup"><span data-stu-id="42b62-217">Next, bind it to the same ObjectDataSource control as the GridView.</span></span> <span data-ttu-id="42b62-218">就像 GridView 一樣，BoundField 會針對 ObjectDataSource 的 `Select` 方法所傳回之物件中的每個屬性加入 DetailsView。</span><span class="sxs-lookup"><span data-stu-id="42b62-218">Like with the GridView, a BoundField will be added to the DetailsView for each property in the object returned by the ObjectDataSource's `Select` method.</span></span> <span data-ttu-id="42b62-219">唯一的差別在於 DetailsView 的 BoundFields 是以水準方式配置，而不是垂直版面配置。</span><span class="sxs-lookup"><span data-stu-id="42b62-219">The only difference is that the DetailsView's BoundFields are laid out horizontally rather than vertically.</span></span>

<span data-ttu-id="42b62-220">[![將 DetailsView 新增至頁面，並將其系結至 ObjectDataSource](displaying-data-with-the-objectdatasource-cs/_static/image34.png)](displaying-data-with-the-objectdatasource-cs/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="42b62-220">[![Add a DetailsView to the Page and Bind it to the ObjectDataSource](displaying-data-with-the-objectdatasource-cs/_static/image34.png)](displaying-data-with-the-objectdatasource-cs/_static/image33.png)</span></span>

<span data-ttu-id="42b62-221">**圖 13**：將 DetailsView 新增至頁面，並將它系結至 ObjectDataSource （[按一下以觀看完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image35.png)）</span><span class="sxs-lookup"><span data-stu-id="42b62-221">**Figure 13**: Add a DetailsView to the Page and Bind it to the ObjectDataSource ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image35.png))</span></span>

<span data-ttu-id="42b62-222">就像 GridView 一樣，DetailsView 的 BoundFields 可以調整，以提供更自訂的 ObjectDataSource 所傳回資料的顯示。</span><span class="sxs-lookup"><span data-stu-id="42b62-222">Like the GridView, the DetailsView's BoundFields can be tweaked to provide a more customized display of the data returned by the ObjectDataSource.</span></span> <span data-ttu-id="42b62-223">[圖 14] 顯示 BoundFields 之後的 DetailsView，並已設定 `CssClass` 屬性，使其外觀與 GridView 範例類似。</span><span class="sxs-lookup"><span data-stu-id="42b62-223">Figure 14 shows the DetailsView after its BoundFields and `CssClass` properties have been configured to make its appearance similar to the GridView example.</span></span>

<span data-ttu-id="42b62-224">[![DetailsView 顯示單一記錄](displaying-data-with-the-objectdatasource-cs/_static/image37.png)](displaying-data-with-the-objectdatasource-cs/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="42b62-224">[![The DetailsView Shows a Single Record](displaying-data-with-the-objectdatasource-cs/_static/image37.png)](displaying-data-with-the-objectdatasource-cs/_static/image36.png)</span></span>

<span data-ttu-id="42b62-225">**圖 14**： DetailsView 顯示單一記錄（[按一下以查看完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image38.png)）</span><span class="sxs-lookup"><span data-stu-id="42b62-225">**Figure 14**: The DetailsView Shows a Single Record ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image38.png))</span></span>

<span data-ttu-id="42b62-226">請注意，DetailsView 只會顯示其資料來源所傳回的第一筆記錄。</span><span class="sxs-lookup"><span data-stu-id="42b62-226">Note that the DetailsView only displays the first record returned by its data source.</span></span> <span data-ttu-id="42b62-227">若要讓使用者一次逐步執行所有記錄，我們必須啟用 DetailsView 的分頁。</span><span class="sxs-lookup"><span data-stu-id="42b62-227">To allow the user to step through all of the records, one at a time, we must enable paging for the DetailsView.</span></span> <span data-ttu-id="42b62-228">若要這麼做，請返回 Visual Studio，然後勾選 DetailsView 的智慧標籤中的 [啟用分頁] 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="42b62-228">To do so, return to Visual Studio and check the Enable Paging checkbox in the DetailsView's smart tag.</span></span>

<span data-ttu-id="42b62-229">[![在 DetailsView 控制項中啟用分頁](displaying-data-with-the-objectdatasource-cs/_static/image40.png)](displaying-data-with-the-objectdatasource-cs/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="42b62-229">[![Enable Paging in the DetailsView Control](displaying-data-with-the-objectdatasource-cs/_static/image40.png)](displaying-data-with-the-objectdatasource-cs/_static/image39.png)</span></span>

<span data-ttu-id="42b62-230">**圖 15**：啟用 DetailsView 控制項中的分頁功能（[按一下以查看完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image41.png)）</span><span class="sxs-lookup"><span data-stu-id="42b62-230">**Figure 15**: Enable Paging in the DetailsView Control ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image41.png))</span></span>

<span data-ttu-id="42b62-231">[已啟用分頁的 ![，DetailsView 可讓使用者查看任何產品](displaying-data-with-the-objectdatasource-cs/_static/image43.png)](displaying-data-with-the-objectdatasource-cs/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="42b62-231">[![With Paging Enabled, the DetailsView Allows the User to View Any of the Products](displaying-data-with-the-objectdatasource-cs/_static/image43.png)](displaying-data-with-the-objectdatasource-cs/_static/image42.png)</span></span>

<span data-ttu-id="42b62-232">**圖 16**：啟用分頁時，DetailsView 可讓使用者查看任何產品（[按一下以觀看完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image44.png)）</span><span class="sxs-lookup"><span data-stu-id="42b62-232">**Figure 16**: With Paging Enabled, the DetailsView Allows the User to View Any of the Products ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image44.png))</span></span>

<span data-ttu-id="42b62-233">我們將在未來的教學課程中進一步討論分頁。</span><span class="sxs-lookup"><span data-stu-id="42b62-233">We'll talk more about paging in future tutorials.</span></span>

## <a name="a-more-flexible-layout-for-showing-one-record-at-a-time"></a><span data-ttu-id="42b62-234">一次顯示一筆記錄的彈性版面配置</span><span class="sxs-lookup"><span data-stu-id="42b62-234">A More Flexible Layout for Showing One Record at a Time</span></span>

<span data-ttu-id="42b62-235">DetailsView 會非常嚴格地顯示從 ObjectDataSource 傳回的每一筆記錄。</span><span class="sxs-lookup"><span data-stu-id="42b62-235">The DetailsView is pretty rigid in how it displays each record returned from the ObjectDataSource.</span></span> <span data-ttu-id="42b62-236">我們可能會想要更有彈性的資料檢視。</span><span class="sxs-lookup"><span data-stu-id="42b62-236">We may want a more flexible view of the data.</span></span> <span data-ttu-id="42b62-237">例如，不會在個別的資料列上顯示產品的名稱、類別、供應商、價格和已停止的資訊，我們可能會想要在 `<h4>` 標題中顯示產品名稱和價格，並以較小的字型大小在名稱和價格底下顯示 [類別] 和 [供應商] 資訊。</span><span class="sxs-lookup"><span data-stu-id="42b62-237">For example, rather than showing the product's name, category, supplier, price, and discontinued information each on a separate row, we may want to show the product name and price in an `<h4>` heading, with the category and supplier information appearing below the name and price in a smaller font size.</span></span> <span data-ttu-id="42b62-238">而且，我們可能不在意在值旁邊顯示內容名稱（Product、Category 等等）。</span><span class="sxs-lookup"><span data-stu-id="42b62-238">And we may not care to show the property names (Product, Category, and so on) next to the values.</span></span>

<span data-ttu-id="42b62-239">[FormView 控制項](https://msdn.microsoft.com/library/fyf1dk77.aspx)提供此層級的自訂。</span><span class="sxs-lookup"><span data-stu-id="42b62-239">The [FormView control](https://msdn.microsoft.com/library/fyf1dk77.aspx) provides this level of customization.</span></span> <span data-ttu-id="42b62-240">FormView 不會使用欄位（例如 GridView 和 DetailsView），而是使用範本，允許混合 Web 控制項、靜態 HTML 和資料系結[語法](http://www.15seconds.com/issue/040630.htm)。</span><span class="sxs-lookup"><span data-stu-id="42b62-240">Rather than using fields (like the GridView and DetailsView do), the FormView uses templates, which allow for a mix of Web controls, static HTML, and [databinding syntax](http://www.15seconds.com/issue/040630.htm).</span></span> <span data-ttu-id="42b62-241">如果您熟悉 ASP.NET 1.x 的中繼器控制項，您可以將 FormView 視為用於顯示單一記錄的中繼器。</span><span class="sxs-lookup"><span data-stu-id="42b62-241">If you are familiar with the Repeater control from ASP.NET 1.x, you can think of the FormView as the Repeater for showing a single record.</span></span>

<span data-ttu-id="42b62-242">將 FormView 控制項加入至 `SimpleDisplay.aspx` 頁面的設計介面。</span><span class="sxs-lookup"><span data-stu-id="42b62-242">Add a FormView control to the `SimpleDisplay.aspx` page's design surface.</span></span> <span data-ttu-id="42b62-243">一開始，FormView 會顯示為灰色區塊，通知我們至少需要提供控制項的 `ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="42b62-243">Initially the FormView displays as a gray block, informing us that we need to provide, at minimum, the control's `ItemTemplate`.</span></span>

<span data-ttu-id="42b62-244">[![FormView 必須包含 ItemTemplate](displaying-data-with-the-objectdatasource-cs/_static/image46.png)](displaying-data-with-the-objectdatasource-cs/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="42b62-244">[![The FormView Must Include an ItemTemplate](displaying-data-with-the-objectdatasource-cs/_static/image46.png)](displaying-data-with-the-objectdatasource-cs/_static/image45.png)</span></span>

<span data-ttu-id="42b62-245">**圖 17**： FormView 必須包含 `ItemTemplate` （[按一下以觀看完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image47.png)）</span><span class="sxs-lookup"><span data-stu-id="42b62-245">**Figure 17**: The FormView Must Include an `ItemTemplate` ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image47.png))</span></span>

<span data-ttu-id="42b62-246">您可以透過 FormView 的智慧標籤，將 FormView 直接系結至資料來源控制項，如果已設定 ObjectDataSource 控制項的 `InsertMethod` 和 `UpdateMethod` 屬性，則會自動建立預設 `ItemTemplate` （連同 `EditItemTemplate` 並 `InsertItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="42b62-246">You can bind the FormView directly to a data source control through the FormView's smart tag, which will create a default `ItemTemplate` automatically (along with an `EditItemTemplate` and `InsertItemTemplate`, if the ObjectDataSource control's `InsertMethod` and `UpdateMethod` properties are set).</span></span> <span data-ttu-id="42b62-247">不過，在此範例中，讓我們將資料系結至 FormView，並手動指定其 `ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="42b62-247">However, for this example let's bind the data to the FormView and specify its `ItemTemplate` manually.</span></span> <span data-ttu-id="42b62-248">首先，將 FormView 的 `DataSourceID` 屬性設定為 ObjectDataSource 控制項的 `ID`，`ObjectDataSource1`。</span><span class="sxs-lookup"><span data-stu-id="42b62-248">Start by setting the FormView's `DataSourceID` property to the `ID` of the ObjectDataSource control, `ObjectDataSource1`.</span></span> <span data-ttu-id="42b62-249">接下來，建立 `ItemTemplate`，讓它在 `<h4>` 專案中顯示產品的名稱和價格，並在較小的字型大小中顯示其底下的類別和貨主名稱。</span><span class="sxs-lookup"><span data-stu-id="42b62-249">Next, create the `ItemTemplate` so that it displays the product's name and price in an `<h4>` element and the category and shipper names beneath that in a smaller font size.</span></span>

[!code-aspx[Main](displaying-data-with-the-objectdatasource-cs/samples/sample6.aspx)]

<span data-ttu-id="42b62-250">[![第一個產品（Chai）會以自訂格式顯示](displaying-data-with-the-objectdatasource-cs/_static/image49.png)](displaying-data-with-the-objectdatasource-cs/_static/image48.png)</span><span class="sxs-lookup"><span data-stu-id="42b62-250">[![The First Product (Chai) is Displayed in a Custom Format](displaying-data-with-the-objectdatasource-cs/_static/image49.png)](displaying-data-with-the-objectdatasource-cs/_static/image48.png)</span></span>

<span data-ttu-id="42b62-251">**圖 18**：第一個產品（Chai）會以自訂格式顯示（[按一下以觀看完整大小的影像](displaying-data-with-the-objectdatasource-cs/_static/image50.png)）</span><span class="sxs-lookup"><span data-stu-id="42b62-251">**Figure 18**: The First Product (Chai) is Displayed in a Custom Format ([Click to view full-size image](displaying-data-with-the-objectdatasource-cs/_static/image50.png))</span></span>

<span data-ttu-id="42b62-252">`<%# Eval(propertyName) %>` 是資料系結語法。</span><span class="sxs-lookup"><span data-stu-id="42b62-252">The `<%# Eval(propertyName) %>` is the databinding syntax.</span></span> <span data-ttu-id="42b62-253">`Eval` 方法會傳回目前物件系結至 FormView 控制項之指定屬性的值。</span><span class="sxs-lookup"><span data-stu-id="42b62-253">The `Eval` method returns the value of the specified property for the current object being bound to the FormView control.</span></span> <span data-ttu-id="42b62-254">如需資料系結的細節和詳細資訊，請參閱 Alex Homer 的文章[中的簡化和擴充的資料系結語法 ASP.NET 2.0](http://www.15seconds.com/issue/040630.htm) 。</span><span class="sxs-lookup"><span data-stu-id="42b62-254">Check out Alex Homer's article [Simplified and Extended Data Binding Syntax in ASP.NET 2.0](http://www.15seconds.com/issue/040630.htm) for more information on the ins and outs of databinding.</span></span>

<span data-ttu-id="42b62-255">就像 DetailsView 一樣，FormView 只會顯示從 ObjectDataSource 傳回的第一筆記錄。</span><span class="sxs-lookup"><span data-stu-id="42b62-255">Like the DetailsView, the FormView only shows the first record returned from the ObjectDataSource.</span></span> <span data-ttu-id="42b62-256">您可以在 FormView 中啟用分頁功能，讓訪客一次逐步執行一項產品。</span><span class="sxs-lookup"><span data-stu-id="42b62-256">You can enable paging in the FormView to allow visitors to step through the products one at a time.</span></span>

## <a name="summary"></a><span data-ttu-id="42b62-257">總結</span><span class="sxs-lookup"><span data-stu-id="42b62-257">Summary</span></span>

<span data-ttu-id="42b62-258">從商務邏輯層存取和顯示資料，不需要撰寫任何程式碼就能完成，而是感謝 ASP.NET 2.0 的 ObjectDataSource 控制項。</span><span class="sxs-lookup"><span data-stu-id="42b62-258">Accessing and displaying data from a Business Logic Layer can be accomplished without writing a line of code thanks to ASP.NET 2.0's ObjectDataSource control.</span></span> <span data-ttu-id="42b62-259">ObjectDataSource 會叫用類別的指定方法，並傳回結果。</span><span class="sxs-lookup"><span data-stu-id="42b62-259">The ObjectDataSource invokes a specified method of a class and returns the results.</span></span> <span data-ttu-id="42b62-260">這些結果可以在系結至 ObjectDataSource 的資料 Web 控制項中顯示。</span><span class="sxs-lookup"><span data-stu-id="42b62-260">These results can be displayed in a data Web control that's bound to the ObjectDataSource.</span></span> <span data-ttu-id="42b62-261">在本教學課程中，我們探討了如何將 GridView、DetailsView 和 FormView 控制項系結至 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="42b62-261">In this tutorial we looked at binding the GridView, DetailsView, and FormView controls to the ObjectDataSource.</span></span>

<span data-ttu-id="42b62-262">到目前為止，我們只看過如何使用 ObjectDataSource 叫用無參數的方法，但如果我們想要叫用需要輸入參數的方法（例如 `ProductBLL` 類別的 `GetProductsByCategoryID(categoryID)`），該怎麼辦？</span><span class="sxs-lookup"><span data-stu-id="42b62-262">So far we've only seen how to use the ObjectDataSource to invoke a parameter-less method, but what if we want to invoke a method that expects input parameters, such as the `ProductBLL` class's `GetProductsByCategoryID(categoryID)`?</span></span> <span data-ttu-id="42b62-263">為了呼叫需要一或多個參數的方法，我們必須設定 ObjectDataSource 來指定這些參數的值。</span><span class="sxs-lookup"><span data-stu-id="42b62-263">In order to call a method that expects one or more parameters we must configure the ObjectDataSource to specify the values for these parameters.</span></span> <span data-ttu-id="42b62-264">我們會在[下一個教學](declarative-parameters-cs.md)課程中瞭解如何完成這項操作。</span><span class="sxs-lookup"><span data-stu-id="42b62-264">We'll see how to accomplish this in our [next tutorial](declarative-parameters-cs.md).</span></span>

<span data-ttu-id="42b62-265">快樂的程式設計！</span><span class="sxs-lookup"><span data-stu-id="42b62-265">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="42b62-266">進一步閱讀</span><span class="sxs-lookup"><span data-stu-id="42b62-266">Further Reading</span></span>

<span data-ttu-id="42b62-267">如需本教學課程中所討論之主題的詳細資訊，請參閱下列資源：</span><span class="sxs-lookup"><span data-stu-id="42b62-267">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="42b62-268">建立您自己的資料來源控制項</span><span class="sxs-lookup"><span data-stu-id="42b62-268">Create Your Own Data Source Controls</span></span>](https://msdn.microsoft.com/library/ms364049.aspx)
- [<span data-ttu-id="42b62-269">ASP.NET 2.0 的 GridView 範例</span><span class="sxs-lookup"><span data-stu-id="42b62-269">GridView Examples for ASP.NET 2.0</span></span>](https://msdn.microsoft.com/library/aa479339.aspx)
- [<span data-ttu-id="42b62-270">ASP.NET 2.0 中簡化和擴充的資料系結語法</span><span class="sxs-lookup"><span data-stu-id="42b62-270">Simplified and Extended Data Binding Syntax in ASP.NET 2.0</span></span>](http://www.15seconds.com/issue/040630.htm)
- [<span data-ttu-id="42b62-271">ASP.NET 2.0 中的主題</span><span class="sxs-lookup"><span data-stu-id="42b62-271">Themes in ASP.NET 2.0</span></span>](http://www.odetocode.com/Articles/423.aspx)
- [<span data-ttu-id="42b62-272">使用主題的伺服器端樣式</span><span class="sxs-lookup"><span data-stu-id="42b62-272">Server-Side Styles Using Themes</span></span>](https://quickstarts.asp.net/quickstartv20/aspnet/doc/themes/stylesheettheme.aspx)
- [<span data-ttu-id="42b62-273">如何：以程式設計方式套用 ASP.NET 主題</span><span class="sxs-lookup"><span data-stu-id="42b62-273">How To: Apply ASP.NET Themes Programmatically</span></span>](https://msdn.microsoft.com/library/tx35bd89.aspx)

## <a name="about-the-author"></a><span data-ttu-id="42b62-274">關於作者</span><span class="sxs-lookup"><span data-stu-id="42b62-274">About the Author</span></span>

<span data-ttu-id="42b62-275">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，自1998起，有七個 ASP/ASP. NET 書籍和創辦人的[4GuysFromRolla.com](http://www.4guysfromrolla.com)。</span><span class="sxs-lookup"><span data-stu-id="42b62-275">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="42b62-276">Scott 以獨立的顧問、訓練員和作者的身分運作。</span><span class="sxs-lookup"><span data-stu-id="42b62-276">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="42b62-277">他的最新著作是[*在24小時內讓自己的 ASP.NET 2.0*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="42b62-277">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="42b62-278">他可以在mitchell@4GuysFromRolla.com觸達[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="42b62-278">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="42b62-279">或者透過他的 blog，可以在[http://ScottOnWriting.NET](http://ScottOnWriting.NET)找到。</span><span class="sxs-lookup"><span data-stu-id="42b62-279">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="42b62-280">特別感謝</span><span class="sxs-lookup"><span data-stu-id="42b62-280">Special Thanks To</span></span>

<span data-ttu-id="42b62-281">本教學課程系列已由許多有用的審核者所審查。</span><span class="sxs-lookup"><span data-stu-id="42b62-281">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="42b62-282">本教學課程的領導審查者為 Hilton Giesenow。</span><span class="sxs-lookup"><span data-stu-id="42b62-282">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="42b62-283">有興趣複習我即將發行的 MSDN 文章嗎？</span><span class="sxs-lookup"><span data-stu-id="42b62-283">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="42b62-284">若是如此，請在mitchell@4GuysFromRolla.com的那一行下拉式[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="42b62-284">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="42b62-285">下一步</span><span class="sxs-lookup"><span data-stu-id="42b62-285">Next</span></span>](declarative-parameters-cs.md)
