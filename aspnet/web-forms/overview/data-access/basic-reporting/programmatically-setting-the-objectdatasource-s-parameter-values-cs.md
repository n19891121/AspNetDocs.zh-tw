---
uid: web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs
title: 以程式設計方式設定 ObjectDataSource 的參數C#值（） |Microsoft Docs
author: rick-anderson
description: 在本教學課程中，我們將探討如何將方法新增至我們的 DAL 和 BLL，以接受單一輸入參數並傳回資料。 此範例會設定此參數 。
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 1c4588bb-255d-4088-b319-5208da756f4d
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs
msc.type: authoredcontent
ms.openlocfilehash: 8aa57172abcfc779fa74b128ad76d42c41dc5b98
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/28/2019
ms.locfileid: "74602120"
---
# <a name="programmatically-setting-the-objectdatasources-parameter-values-c"></a><span data-ttu-id="076c6-104">以程式設計方式設定 ObjectDataSource 的參數值 (C#)</span><span class="sxs-lookup"><span data-stu-id="076c6-104">Programmatically Setting the ObjectDataSource's Parameter Values (C#)</span></span>

<span data-ttu-id="076c6-105">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="076c6-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="076c6-106">[下載範例應用程式](https://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_6_CS.exe)或[下載 PDF](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/datatutorial06cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="076c6-106">[Download Sample App](https://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_6_CS.exe) or [Download PDF](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/datatutorial06cs1.pdf)</span></span>

> <span data-ttu-id="076c6-107">在本教學課程中，我們將探討如何將方法新增至我們的 DAL 和 BLL，以接受單一輸入參數並傳回資料。</span><span class="sxs-lookup"><span data-stu-id="076c6-107">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter and returns data.</span></span> <span data-ttu-id="076c6-108">此範例會以程式設計方式設定此參數。</span><span class="sxs-lookup"><span data-stu-id="076c6-108">The example will set this parameter programmatically.</span></span>

## <a name="introduction"></a><span data-ttu-id="076c6-109">簡介</span><span class="sxs-lookup"><span data-stu-id="076c6-109">Introduction</span></span>

<span data-ttu-id="076c6-110">如[先前的教學](declarative-parameters-cs.md)課程中所見，有許多選項可用於以宣告方式將參數值傳遞給 ObjectDataSource 的方法。</span><span class="sxs-lookup"><span data-stu-id="076c6-110">As we saw in the [previous tutorial](declarative-parameters-cs.md), a number of options are available for declaratively passing parameter values to the ObjectDataSource's methods.</span></span> <span data-ttu-id="076c6-111">如果參數值為硬式編碼，則來自網頁上的 Web 控制項，或位於資料來源 `Parameter` 物件可讀取的任何其他來源中，例如，該值可以系結至輸入參數，而不需要撰寫任何一行程式碼。</span><span class="sxs-lookup"><span data-stu-id="076c6-111">If the parameter value is hard-coded, comes from a Web control on the page, or is in any other source that is readable by a data source `Parameter` object, for example, that value can be bound to the input parameter without writing a line of code.</span></span>

<span data-ttu-id="076c6-112">不過有時候，當參數值來自某個內建資料來源 `Parameter` 物件的部分來源時，就可能會發生此情況。</span><span class="sxs-lookup"><span data-stu-id="076c6-112">There may be times, however, when the parameter value comes from some source not already accounted for by one of the built-in data source `Parameter` objects.</span></span> <span data-ttu-id="076c6-113">如果我們的網站支援的使用者帳戶，我們可能會想要根據目前登入的訪客使用者識別碼來設定參數。</span><span class="sxs-lookup"><span data-stu-id="076c6-113">If our site supported user accounts we might want to set the parameter based on the currently logged in visitor's User ID.</span></span> <span data-ttu-id="076c6-114">或者，我們可能需要自訂參數值，然後再將它傳送給 ObjectDataSource 的基礎物件的方法。</span><span class="sxs-lookup"><span data-stu-id="076c6-114">Or we may need to customize the parameter value before sending it along to the ObjectDataSource's underlying object's method.</span></span>

<span data-ttu-id="076c6-115">每當叫用 ObjectDataSource 的 `Select` 方法時，ObjectDataSource 就會先引發其[選取的事件](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx)。</span><span class="sxs-lookup"><span data-stu-id="076c6-115">Whenever the ObjectDataSource's `Select` method is invoked the ObjectDataSource first raises its [Selecting event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx).</span></span> <span data-ttu-id="076c6-116">接著會叫用 ObjectDataSource 的基礎物件的方法。</span><span class="sxs-lookup"><span data-stu-id="076c6-116">The ObjectDataSource's underlying object's method is then invoked.</span></span> <span data-ttu-id="076c6-117">一旦完成，ObjectDataSource 的[選取事件](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx)就會引發（[圖 1] 說明這一系列的事件）。</span><span class="sxs-lookup"><span data-stu-id="076c6-117">Once that completes the ObjectDataSource's [Selected event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx) fires (Figure 1 illustrates this sequence of events).</span></span> <span data-ttu-id="076c6-118">您可以在 `Selecting` 事件的事件處理常式中，設定或自訂傳遞至 ObjectDataSource 基礎物件之方法的參數值。</span><span class="sxs-lookup"><span data-stu-id="076c6-118">The parameter values passed into the ObjectDataSource's underlying object's method can be set or customized in an event handler for the `Selecting` event.</span></span>

<span data-ttu-id="076c6-119">[![ObjectDataSource 的選取和選取的事件會在其基礎物件的方法叫用前後引發](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="076c6-119">[![The ObjectDataSource's Selected and Selecting Events Fire Before and After Its Underlying Object's Method is Invoked](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image1.png)</span></span>

<span data-ttu-id="076c6-120">**圖 1**： ObjectDataSource 的 `Selected` 和 `Selecting` 事件會在其基礎物件的方法被叫用前後引發（[按一下以查看完整大小的影像](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image3.png)）</span><span class="sxs-lookup"><span data-stu-id="076c6-120">**Figure 1**: The ObjectDataSource's `Selected` and `Selecting` Events Fire Before and After Its Underlying Object's Method is Invoked ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image3.png))</span></span>

<span data-ttu-id="076c6-121">在本教學課程中，我們將探討如何將方法新增至我們的 DAL 和 BLL，以接受 `Month``int` 類型的單一輸入參數，並傳回 `EmployeesDataTable` 物件，並在指定的 `Month`中，填入其雇用周年的員工。</span><span class="sxs-lookup"><span data-stu-id="076c6-121">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter `Month`, of type `int` and returns an `EmployeesDataTable` object populated with those employees that have their hiring anniversary in the specified `Month`.</span></span> <span data-ttu-id="076c6-122">我們的範例會根據目前月份以程式設計方式設定此參數，並顯示「本月員工周年紀念日」的清單。</span><span class="sxs-lookup"><span data-stu-id="076c6-122">Our example will set this parameter programmatically based on the current month, showing a list of "Employee Anniversaries This Month."</span></span>

<span data-ttu-id="076c6-123">讓我們開始吧！</span><span class="sxs-lookup"><span data-stu-id="076c6-123">Let's get started!</span></span>

## <a name="step-1-adding-a-method-toemployeestableadapter"></a><span data-ttu-id="076c6-124">步驟1：將方法加入至`EmployeesTableAdapter`</span><span class="sxs-lookup"><span data-stu-id="076c6-124">Step 1: Adding a Method to`EmployeesTableAdapter`</span></span>

<span data-ttu-id="076c6-125">在第一個範例中，我們需要新增一種方法來抓取 `HireDate` 在指定月份中發生的員工。</span><span class="sxs-lookup"><span data-stu-id="076c6-125">For our first example we need to add a means to retrieve those employees whose `HireDate` occurred in a specified month.</span></span> <span data-ttu-id="076c6-126">為了根據我們的架構提供這項功能，我們必須先在 `EmployeesTableAdapter` 中建立對應至適當 SQL 語句的方法。</span><span class="sxs-lookup"><span data-stu-id="076c6-126">To provide this functionality in accordance with our architecture we need to first create a method in `EmployeesTableAdapter` that maps to the proper SQL statement.</span></span> <span data-ttu-id="076c6-127">若要完成這項操作，請從開啟 Northwind 類型資料集開始。</span><span class="sxs-lookup"><span data-stu-id="076c6-127">To accomplish this, start by opening the Northwind Typed DataSet.</span></span> <span data-ttu-id="076c6-128">以滑鼠右鍵按一下 [`EmployeesTableAdapter`] 標籤，然後選擇 [加入查詢]。</span><span class="sxs-lookup"><span data-stu-id="076c6-128">Right-click on the `EmployeesTableAdapter` label and choose Add Query.</span></span>

<span data-ttu-id="076c6-129">[![將新的查詢加入至 EmployeesTableAdapter](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="076c6-129">[![Add a New Query to the EmployeesTableAdapter](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image4.png)</span></span>

<span data-ttu-id="076c6-130">**圖 2**：將新的查詢加入至 `EmployeesTableAdapter` （[按一下以查看完整大小的影像](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image6.png)）</span><span class="sxs-lookup"><span data-stu-id="076c6-130">**Figure 2**: Add a New Query to the `EmployeesTableAdapter` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image6.png))</span></span>

<span data-ttu-id="076c6-131">加入宣告會傳回資料列的 SQL 語句。</span><span class="sxs-lookup"><span data-stu-id="076c6-131">Choose to add a SQL statement that returns rows.</span></span> <span data-ttu-id="076c6-132">當您到達 [指定 `SELECT` 語句] 畫面時，`EmployeesTableAdapter` 的預設 `SELECT` 語句就已載入。</span><span class="sxs-lookup"><span data-stu-id="076c6-132">When you reach the Specify a `SELECT` Statement screen the default `SELECT` statement for the `EmployeesTableAdapter` will already be loaded.</span></span> <span data-ttu-id="076c6-133">只要在 `WHERE` 子句中新增： `WHERE DATEPART(m, HireDate) = @Month`。</span><span class="sxs-lookup"><span data-stu-id="076c6-133">Simply add in the `WHERE` clause: `WHERE DATEPART(m, HireDate) = @Month`.</span></span> <span data-ttu-id="076c6-134">[DATEPART](https://msdn.microsoft.com/library/ms174420.aspx)是一個 t-sql 函數，會傳回 `datetime` 類型的特定日期部分;在此情況下，我們會使用 `DATEPART` 來傳回 `HireDate` 資料行的月份。</span><span class="sxs-lookup"><span data-stu-id="076c6-134">[DATEPART](https://msdn.microsoft.com/library/ms174420.aspx) is a T-SQL function that returns a particular date portion of a `datetime` type; in this case we're using `DATEPART` to return the month of the `HireDate` column.</span></span>

<span data-ttu-id="076c6-135">[![只傳回 [雇用日期] 資料行小於或等於 @HiredBeforeDate 參數的資料列](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="076c6-135">[![Return Only Those Rows Where the HireDate Column is Less Than or Equal to the @HiredBeforeDate Parameter](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image7.png)</span></span>

<span data-ttu-id="076c6-136">**圖 3**：只傳回 `HireDate` 資料行小於或等於 `@HiredBeforeDate` 參數的資料列（[按一下以查看完整大小的影像](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image9.png)）</span><span class="sxs-lookup"><span data-stu-id="076c6-136">**Figure 3**: Return Only Those Rows Where the `HireDate` Column is Less Than or Equal to the `@HiredBeforeDate` Parameter ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image9.png))</span></span>

<span data-ttu-id="076c6-137">最後，將 `FillBy` 和 `GetDataBy` 方法名稱分別變更為 `FillByHiredDateMonth` 和 `GetEmployeesByHiredDateMonth`。</span><span class="sxs-lookup"><span data-stu-id="076c6-137">Finally, change the `FillBy` and `GetDataBy` method names to `FillByHiredDateMonth` and `GetEmployeesByHiredDateMonth`, respectively.</span></span>

<span data-ttu-id="076c6-138">[![選擇比 FillBy 和 GetDataBy 更適當的方法名稱](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="076c6-138">[![Choose More Appropriate Method Names Than FillBy and GetDataBy](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image10.png)</span></span>

<span data-ttu-id="076c6-139">**圖 4**：選擇更適當的方法名稱，而不是 `FillBy` 和 `GetDataBy` （[按一下以查看完整大小的影像](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image12.png)）</span><span class="sxs-lookup"><span data-stu-id="076c6-139">**Figure 4**: Choose More Appropriate Method Names Than `FillBy` and `GetDataBy` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image12.png))</span></span>

<span data-ttu-id="076c6-140">按一下 [完成] 以完成嚮導，並返回資料集的設計介面。</span><span class="sxs-lookup"><span data-stu-id="076c6-140">Click Finish to complete the wizard and return to the DataSet's design surface.</span></span> <span data-ttu-id="076c6-141">`EmployeesTableAdapter` 現在應包含一組新的方法，供您存取在指定月份雇用的員工。</span><span class="sxs-lookup"><span data-stu-id="076c6-141">The `EmployeesTableAdapter` should now include a new set of methods for accessing employees hired in a specified month.</span></span>

<span data-ttu-id="076c6-142">[![新方法會出現在資料集的 Design Surface](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="076c6-142">[![The New Methods Appear in the DataSet's Design Surface](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image13.png)</span></span>

<span data-ttu-id="076c6-143">**圖 5**：新的方法會出現在資料集的 Design Surface 中（[按一下以查看完整大小的影像](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image15.png)）</span><span class="sxs-lookup"><span data-stu-id="076c6-143">**Figure 5**: The New Methods Appear in the DataSet's Design Surface ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image15.png))</span></span>

## <a name="step-2-adding-thegetemployeesbyhireddatemonthmonthmethod-to-the-business-logic-layer"></a><span data-ttu-id="076c6-144">步驟2：將`GetEmployeesByHiredDateMonth(month)`方法加入至商務邏輯層</span><span class="sxs-lookup"><span data-stu-id="076c6-144">Step 2: Adding the`GetEmployeesByHiredDateMonth(month)`Method to the Business Logic Layer</span></span>

<span data-ttu-id="076c6-145">因為我們的應用程式架構會針對商務邏輯和資料存取邏輯使用不同的層級，所以我們需要將方法新增至我們的 BLL，以向下呼叫 DAL，以取出在指定日期之前雇用的員工。</span><span class="sxs-lookup"><span data-stu-id="076c6-145">Since our application architecture uses a separate layer for the business logic and data access logic, we need to add a method to our BLL that calls down to the DAL to retrieve employees hired before a specified date.</span></span> <span data-ttu-id="076c6-146">開啟 `EmployeesBLL.cs` 檔案，並新增下列方法：</span><span class="sxs-lookup"><span data-stu-id="076c6-146">Open the `EmployeesBLL.cs` file and add the following method:</span></span>

[!code-csharp[Main](programmatically-setting-the-objectdatasource-s-parameter-values-cs/samples/sample1.cs)]

<span data-ttu-id="076c6-147">就像這個類別中的其他方法一樣，`GetEmployeesByHiredDateMonth(month)` 只是向下呼叫 DAL 並傳回結果。</span><span class="sxs-lookup"><span data-stu-id="076c6-147">As with our other methods in this class, `GetEmployeesByHiredDateMonth(month)` simply calls down into the DAL and returns the results.</span></span>

## <a name="step-3-displaying-employees-whose-hiring-anniversary-is-this-month"></a><span data-ttu-id="076c6-148">步驟3：顯示此月份雇用周年年度的員工</span><span class="sxs-lookup"><span data-stu-id="076c6-148">Step 3: Displaying Employees Whose Hiring Anniversary Is This Month</span></span>

<span data-ttu-id="076c6-149">此範例的最後一個步驟，是顯示在本月雇用周年的員工。</span><span class="sxs-lookup"><span data-stu-id="076c6-149">Our final step for this example is to display those employees whose hiring anniversary is this month.</span></span> <span data-ttu-id="076c6-150">首先，將 GridView 新增至 [`BasicReporting`] 資料夾中的 [`ProgrammaticParams.aspx`] 頁面，並加入新的 ObjectDataSource 作為其資料來源。</span><span class="sxs-lookup"><span data-stu-id="076c6-150">Start by adding a GridView to the `ProgrammaticParams.aspx` page in the `BasicReporting` folder and add a new ObjectDataSource as its data source.</span></span> <span data-ttu-id="076c6-151">將 ObjectDataSource 設定為使用 `EmployeesBLL` 類別，並將 `SelectMethod` 設為 `GetEmployeesByHiredDateMonth(month)`。</span><span class="sxs-lookup"><span data-stu-id="076c6-151">Configure the ObjectDataSource to use the `EmployeesBLL` class with the `SelectMethod` set to `GetEmployeesByHiredDateMonth(month)`.</span></span>

<span data-ttu-id="076c6-152">[![使用 EmployeesBLL 類別](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="076c6-152">[![Use the EmployeesBLL Class](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image16.png)</span></span>

<span data-ttu-id="076c6-153">**圖 6**：使用 `EmployeesBLL` 類別（[按一下以觀看完整大小的影像](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image18.png)）</span><span class="sxs-lookup"><span data-stu-id="076c6-153">**Figure 6**: Use the `EmployeesBLL` Class ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image18.png))</span></span>

<span data-ttu-id="076c6-154">[![從 GetEmployeesByHiredDateMonth （month）方法選取](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="076c6-154">[![Select From the GetEmployeesByHiredDateMonth(month) method](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image19.png)</span></span>

<span data-ttu-id="076c6-155">**圖 7**：從 `GetEmployeesByHiredDateMonth(month)` 方法中選取（[按一下以查看完整大小的影像](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image21.png)）</span><span class="sxs-lookup"><span data-stu-id="076c6-155">**Figure 7**: Select From the `GetEmployeesByHiredDateMonth(month)` method ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image21.png))</span></span>

<span data-ttu-id="076c6-156">最後一個畫面會要求我們提供 `month` 參數值的來源。</span><span class="sxs-lookup"><span data-stu-id="076c6-156">The final screen asks us to provide the `month` parameter value's source.</span></span> <span data-ttu-id="076c6-157">因為我們將以程式設計方式設定此值，所以請將參數來源設定為預設值 None 選項，然後按一下 [完成]。</span><span class="sxs-lookup"><span data-stu-id="076c6-157">Since we'll set this value programmatically, leave the Parameter source set to the default None option and click Finish.</span></span>

<span data-ttu-id="076c6-158">[![讓參數來源設定為 [無]](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="076c6-158">[![Leave the Parameter Source Set to None](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image22.png)</span></span>

<span data-ttu-id="076c6-159">**圖 8**：將 [參數來源] 設定為 [無] （[按一下以查看完整大小的影像](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image24.png)）</span><span class="sxs-lookup"><span data-stu-id="076c6-159">**Figure 8**: Leave the Parameter Source Set to None ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image24.png))</span></span>

<span data-ttu-id="076c6-160">這會在 ObjectDataSource 的 `SelectParameters` 集合中建立未指定值的 `Parameter` 物件。</span><span class="sxs-lookup"><span data-stu-id="076c6-160">This will create a `Parameter` object in the ObjectDataSource's `SelectParameters` collection that does not have a value specified.</span></span>

[!code-aspx[Main](programmatically-setting-the-objectdatasource-s-parameter-values-cs/samples/sample2.aspx)]

<span data-ttu-id="076c6-161">若要以程式設計方式設定這個值，我們需要為 ObjectDataSource 的 `Selecting` 事件建立事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="076c6-161">To set this value programmatically, we need to create an event handler for the ObjectDataSource's `Selecting` event.</span></span> <span data-ttu-id="076c6-162">若要完成此動作，請移至設計檢視，然後按兩下 [ObjectDataSource]。</span><span class="sxs-lookup"><span data-stu-id="076c6-162">To accomplish this, go to the Design view and double-click the ObjectDataSource.</span></span> <span data-ttu-id="076c6-163">或者，選取 [ObjectDataSource]，移至 [屬性視窗]，然後按一下閃電圖示。</span><span class="sxs-lookup"><span data-stu-id="076c6-163">Alternatively, select the ObjectDataSource, go to the Properties window, and click the lightning bolt icon.</span></span> <span data-ttu-id="076c6-164">接下來，在 [`Selecting`] 事件旁邊的文字方塊中按兩下，或輸入您要使用的事件處理常式名稱。</span><span class="sxs-lookup"><span data-stu-id="076c6-164">Next, either double-click in the textbox next to the `Selecting` event or type in the name of the event handler you want to use.</span></span>

![按一下 [屬性] 視窗中的閃電圖示，以列出 Web 控制項的事件](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image25.png)

<span data-ttu-id="076c6-166">**圖 9**：按一下 [屬性] 視窗中的閃電圖示，以列出 Web 控制項的事件</span><span class="sxs-lookup"><span data-stu-id="076c6-166">**Figure 9**: Click on the Lightning Bolt Icon in the Properties Window to List a Web Control's Events</span></span>

<span data-ttu-id="076c6-167">這兩種方法都會將 ObjectDataSource 的 `Selecting` 事件的新事件處理常式加入至頁面的程式碼後置類別。</span><span class="sxs-lookup"><span data-stu-id="076c6-167">Both approaches add a new event handler for the ObjectDataSource's `Selecting` event to the page's code-behind class.</span></span> <span data-ttu-id="076c6-168">在這個事件處理常式中，我們可以使用 `e.InputParameters[parameterName]`來讀取和寫入參數值，其中 *`parameterName`* 是 `<asp:Parameter>` 標記中 `Name` 屬性的值（`InputParameters` 集合也可以編制索引序數，如同 `e.InputParameters[index]`）。</span><span class="sxs-lookup"><span data-stu-id="076c6-168">In this event handler we can read and write to the parameter values using `e.InputParameters[parameterName]`, where *`parameterName`* is the value of the `Name` attribute in the `<asp:Parameter>` tag (the `InputParameters` collection can also be indexed ordinally, as in `e.InputParameters[index]`).</span></span> <span data-ttu-id="076c6-169">若要將 `month` 參數設定為當月，請將下列專案新增至 `Selecting` 事件處理常式：</span><span class="sxs-lookup"><span data-stu-id="076c6-169">To set the `month` parameter to the current month, add the following to the `Selecting` event handler:</span></span>

[!code-csharp[Main](programmatically-setting-the-objectdatasource-s-parameter-values-cs/samples/sample3.cs)]

<span data-ttu-id="076c6-170">透過瀏覽器造訪此頁面時，我們可以看到，只有一位員工在本月（3月）劉娜 Callahan，這是自1994起的公司。</span><span class="sxs-lookup"><span data-stu-id="076c6-170">When visiting this page through a browser we can see that only one employee was hired this month (March) Laura Callahan, who's been with the company since 1994.</span></span>

<span data-ttu-id="076c6-171">[![顯示此月份周年紀念日的員工](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="076c6-171">[![Those Employees Whose Anniversaries This Month Are Shown](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image26.png)</span></span>

<span data-ttu-id="076c6-172">[**圖 10**] 顯示此月份周年紀念日的員工（[按一下以觀看完整大小的影像](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image28.png)）</span><span class="sxs-lookup"><span data-stu-id="076c6-172">**Figure 10**: Those Employees Whose Anniversaries This Month Are Shown ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image28.png))</span></span>

## <a name="summary"></a><span data-ttu-id="076c6-173">總結</span><span class="sxs-lookup"><span data-stu-id="076c6-173">Summary</span></span>

<span data-ttu-id="076c6-174">雖然 ObjectDataSource 的參數值通常可以透過宣告方式設定，而不需要一行程式碼，但很容易就能以程式設計方式設定參數值。</span><span class="sxs-lookup"><span data-stu-id="076c6-174">While the ObjectDataSource's parameters' values can typically be set declaratively, without requiring a line of code, it's easy to set the parameter values programmatically.</span></span> <span data-ttu-id="076c6-175">我們只需要建立 ObjectDataSource 的 `Selecting` 事件的事件處理常式，這會在叫用基礎物件的方法之前引發，並透過 `InputParameters` 集合手動設定一或多個參數的值。</span><span class="sxs-lookup"><span data-stu-id="076c6-175">All we need to do is create an event handler for the ObjectDataSource's `Selecting` event, which fires before the underlying object's method is invoked, and manually set the values for one or more parameters via the `InputParameters` collection.</span></span>

<span data-ttu-id="076c6-176">本教學課程會結束 [基本報告] 區段。</span><span class="sxs-lookup"><span data-stu-id="076c6-176">This tutorial concludes the Basic Reporting section.</span></span> <span data-ttu-id="076c6-177">[下一個教學](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md)課程會開始進行篩選和主版-詳細資料案例一節，我們將在其中探討允許造訪者篩選資料，並向下切入至詳細報表的技術。</span><span class="sxs-lookup"><span data-stu-id="076c6-177">The [next tutorial](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) kicks off the Filtering and Master-Details Scenarios section, in which we'll look at techniques for allowing the visitor to filter data and drill down from a master report into a details report.</span></span>

<span data-ttu-id="076c6-178">快樂的程式設計！</span><span class="sxs-lookup"><span data-stu-id="076c6-178">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="076c6-179">關於作者</span><span class="sxs-lookup"><span data-stu-id="076c6-179">About the Author</span></span>

<span data-ttu-id="076c6-180">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，自1998起，有七個 ASP/ASP. NET 書籍和創辦人的[4GuysFromRolla.com](http://www.4guysfromrolla.com)。</span><span class="sxs-lookup"><span data-stu-id="076c6-180">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="076c6-181">Scott 以獨立的顧問、訓練員和作者的身分運作。</span><span class="sxs-lookup"><span data-stu-id="076c6-181">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="076c6-182">他的最新著作是[*在24小時內讓自己的 ASP.NET 2.0*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="076c6-182">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="076c6-183">他可以在mitchell@4GuysFromRolla.com觸達[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="076c6-183">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="076c6-184">或者透過他的 blog，可以在[http://ScottOnWriting.NET](http://ScottOnWriting.NET)找到。</span><span class="sxs-lookup"><span data-stu-id="076c6-184">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="076c6-185">特別感謝</span><span class="sxs-lookup"><span data-stu-id="076c6-185">Special Thanks To</span></span>

<span data-ttu-id="076c6-186">本教學課程系列已由許多有用的審核者所審查。</span><span class="sxs-lookup"><span data-stu-id="076c6-186">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="076c6-187">本教學課程的領導審查者為 Hilton Giesenow。</span><span class="sxs-lookup"><span data-stu-id="076c6-187">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="076c6-188">有興趣複習我即將發行的 MSDN 文章嗎？</span><span class="sxs-lookup"><span data-stu-id="076c6-188">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="076c6-189">若是如此，請在mitchell@4GuysFromRolla.com的那一行下拉式[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="076c6-189">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="076c6-190">[上一頁](declarative-parameters-cs.md)
> [下一頁](displaying-data-with-the-objectdatasource-vb.md)</span><span class="sxs-lookup"><span data-stu-id="076c6-190">[Previous](declarative-parameters-cs.md)
[Next](displaying-data-with-the-objectdatasource-vb.md)</span></span>
