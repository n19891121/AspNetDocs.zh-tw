---
uid: web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/sorting-data-in-a-datalist-or-repeater-control-cs
title: 排序資料 DataList 或 Repeater 控制項 (C#) |Microsoft Docs
author: rick-anderson
description: 在本教學課程中，我們將檢驗如何納入排序 DataList 和 Repeater 中, 支援，以及如何建構資料可以 DataList 或 Repeater...
ms.author: riande
ms.date: 11/13/2006
ms.assetid: f52c302a-1b7c-46fe-8a13-8412c95cbf6d
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/sorting-data-in-a-datalist-or-repeater-control-cs
msc.type: authoredcontent
ms.openlocfilehash: 05fbc51d5341a4d3d634cbbc05c0e66a827b0394
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/01/2019
ms.locfileid: "57042505"
---
<a name="sorting-data-in-a-datalist-or-repeater-control-c"></a><span data-ttu-id="dcb7a-103">DataList 或重複項控制項中的排序資料 (C#)</span><span class="sxs-lookup"><span data-stu-id="dcb7a-103">Sorting Data in a DataList or Repeater Control (C#)</span></span>
====================
<span data-ttu-id="dcb7a-104">藉由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="dcb7a-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="dcb7a-105">[下載範例應用程式](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_45_CS.exe)或[下載 PDF](sorting-data-in-a-datalist-or-repeater-control-cs/_static/datatutorial45cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="dcb7a-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_45_CS.exe) or [Download PDF](sorting-data-in-a-datalist-or-repeater-control-cs/_static/datatutorial45cs1.pdf)</span></span>

> <span data-ttu-id="dcb7a-106">在本教學課程中，我們將檢驗如何納入排序 DataList 和 Repeater 中, 支援，以及如何建構 DataList 或 Repeater 可以分頁和排序資料。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-106">In this tutorial we'll examine how to include sorting support in the DataList and Repeater, as well as how to construct a DataList or Repeater whose data can be paged and sorted.</span></span>


## <a name="introduction"></a><span data-ttu-id="dcb7a-107">簡介</span><span class="sxs-lookup"><span data-stu-id="dcb7a-107">Introduction</span></span>

<span data-ttu-id="dcb7a-108">在 [先前的教學課程](paging-report-data-in-a-datalist-or-repeater-control-cs.md)我們檢查如何將分頁支援新增至 DataList。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-108">In the [previous tutorial](paging-report-data-in-a-datalist-or-repeater-control-cs.md) we examined how to add paging support to a DataList.</span></span> <span data-ttu-id="dcb7a-109">我們建立中的新方法`ProductsBLL`類別 (`GetProductsAsPagedDataSource`) 傳回`PagedDataSource`物件。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-109">We created a new method in the `ProductsBLL` class (`GetProductsAsPagedDataSource`) that returned a `PagedDataSource` object.</span></span> <span data-ttu-id="dcb7a-110">當繫結至 DataList 或 Repeater、 DataList 或 Repeater 會顯示只是要求的頁面顯示的資料。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-110">When bound to a DataList or Repeater, the DataList or Repeater would display just the requested page of data.</span></span> <span data-ttu-id="dcb7a-111">這個技術非常類似於用在內部 GridView、 DetailsView 和 FormView 控制項來提供他們的內建的預設分頁功能。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-111">This technique is similar to what is used internally by the GridView, DetailsView, and FormView controls to provide their built-in default paging functionality.</span></span>

<span data-ttu-id="dcb7a-112">除了提供分頁支援，GridView 也包含內建排序支援。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-112">In addition to offering paging support, the GridView also includes out of the box sorting support.</span></span> <span data-ttu-id="dcb7a-113">DataList 或 Repeater 都不會提供內建排序功能;不過，排序功能可以使用新增的程式碼。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-113">Neither the DataList nor Repeater provides built-in sorting functionality; however, sorting features can be added with a bit of code.</span></span> <span data-ttu-id="dcb7a-114">在本教學課程中，我們將檢驗如何納入排序 DataList 和 Repeater 中, 支援，以及如何建構 DataList 或 Repeater 可以分頁和排序資料。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-114">In this tutorial we'll examine how to include sorting support in the DataList and Repeater, as well as how to construct a DataList or Repeater whose data can be paged and sorted.</span></span>

## <a name="a-review-of-sorting"></a><span data-ttu-id="dcb7a-115">檢閱排序</span><span class="sxs-lookup"><span data-stu-id="dcb7a-115">A Review of Sorting</span></span>

<span data-ttu-id="dcb7a-116">如我們在中所見[分頁和排序報表資料](../paging-and-sorting/paging-and-sorting-report-data-cs.md)教學課程中，提供現成的排序支援的 GridView 控制項。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-116">As we saw in the [Paging and Sorting Report Data](../paging-and-sorting/paging-and-sorting-report-data-cs.md) tutorial, the GridView control provides out of the box sorting support.</span></span> <span data-ttu-id="dcb7a-117">每個 GridView 欄位可以有相關聯`SortExpression`，表示資料欄位，用來排序資料。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-117">Each GridView field can have an associated `SortExpression`, which indicates the data field by which to sort the data.</span></span> <span data-ttu-id="dcb7a-118">當 GridView s`AllowSorting`屬性設定為`true`，有每個 GridView 欄位`SortExpression`屬性值已轉譯為 LinkButton 標頭。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-118">When the GridView s `AllowSorting` property is set to `true`, each GridView field that has a `SortExpression` property value has its header rendered as a LinkButton.</span></span> <span data-ttu-id="dcb7a-119">當使用者按一下特定的 GridView 欄位 s 標頭時，就會發生回傳和資料根據按下 [s] 欄位排序`SortExpression`。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-119">When a user clicks a particular GridView field s header, a postback occurs and the data is sorted according to the clicked field s `SortExpression`.</span></span>

<span data-ttu-id="dcb7a-120">GridView 控制項具有`SortExpression`屬性，它會儲存`SortExpression`[GridView] 欄位的資料會依照。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-120">The GridView control has a `SortExpression` property as well, which stores the `SortExpression` of the GridView field the data is sorted by.</span></span> <span data-ttu-id="dcb7a-121">此外，`SortDirection`屬性會指出資料是否以遞增或遞減順序 （如果使用者按一下，就會切換為特定 GridView 的欄位標頭中的連結兩次連續，排序順序） 排序。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-121">Additionally, a `SortDirection` property indicates whether the data is to be sorted in ascending or descending order (if a user clicks a particular GridView field s header link twice in succession, the sort order is toggled).</span></span>

<span data-ttu-id="dcb7a-122">在其資料來源控制項繫結 GridView，它將其`SortExpression`和`SortDirection`屬性的資料來源控制項。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-122">When the GridView is bound to its data source control, it hands off its `SortExpression` and `SortDirection` properties to the data source control.</span></span> <span data-ttu-id="dcb7a-123">資料來源控制項擷取資料，並加以根據所提供排序`SortExpression`和`SortDirection`屬性。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-123">The data source control retrieves the data and then sorts it according to the supplied `SortExpression` and `SortDirection` properties.</span></span> <span data-ttu-id="dcb7a-124">完成排序之後的資料，資料來源控制項它傳回至 GridView。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-124">After sorting the data, the data source control returns it to the GridView.</span></span>

<span data-ttu-id="dcb7a-125">若要複寫的 DataList 或 Repeater 控制項的這項功能，我們必須：</span><span class="sxs-lookup"><span data-stu-id="dcb7a-125">To replicate this functionality with the DataList or Repeater controls, we must:</span></span>

- <span data-ttu-id="dcb7a-126">建立排序的介面</span><span class="sxs-lookup"><span data-stu-id="dcb7a-126">Create a sorting interface</span></span>
- <span data-ttu-id="dcb7a-127">請記住要排序的資料欄位，以及是否要以遞增或遞減順序排序</span><span class="sxs-lookup"><span data-stu-id="dcb7a-127">Remember the data field to sort by and whether to sort in ascending or descending order</span></span>
- <span data-ttu-id="dcb7a-128">指示要依特定資料欄位排序資料的 ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="dcb7a-128">Instruct the ObjectDataSource to sort the data by a particular data field</span></span>

<span data-ttu-id="dcb7a-129">我們將會處理這些步驟 3 和 4 中的三個工作。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-129">We'll tackle these three tasks in steps 3 and 4.</span></span> <span data-ttu-id="dcb7a-130">接下來，我們將檢驗如何包含分頁和排序中 DataList 或 Repeater 的支援。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-130">Following that, we'll examine how to include both paging and sorting support in a DataList or Repeater.</span></span>

## <a name="step-2-displaying-the-products-in-a-repeater"></a><span data-ttu-id="dcb7a-131">步驟 2：顯示產品中</span><span class="sxs-lookup"><span data-stu-id="dcb7a-131">Step 2: Displaying the Products in a Repeater</span></span>

<span data-ttu-id="dcb7a-132">我們會擔心實作任何排序相關的功能之前，讓開始要先列出的產品在中繼器控制項中的 s。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-132">Before we worry about implementing any of the sorting-related functionality, let s start by listing the products in a Repeater control.</span></span> <span data-ttu-id="dcb7a-133">首先開啟`Sorting.aspx`頁面中`PagingSortingDataListRepeater`資料夾。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-133">Start by opening the `Sorting.aspx` page in the `PagingSortingDataListRepeater` folder.</span></span> <span data-ttu-id="dcb7a-134">將重複項控制項新增至網頁上，設定其`ID`屬性設`SortableProducts`。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-134">Add a Repeater control to the web page, setting its `ID` property to `SortableProducts`.</span></span> <span data-ttu-id="dcb7a-135">從 Repeater s 智慧標籤，建立名為新 ObjectDataSource`ProductsDataSource`並將它設定為從中擷取資料`ProductsBLL`類別的`GetProducts()`方法。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-135">From the Repeater s smart tag, create a new ObjectDataSource named `ProductsDataSource` and configure it to retrieve data from the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="dcb7a-136">選取 （無） 選項從下拉式清單中，在 INSERT、 UPDATE 和 DELETE 的索引標籤中。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-136">Select the (None) option from the drop-down lists in the INSERT, UPDATE, and DELETE tabs.</span></span>


<span data-ttu-id="dcb7a-137">[![建立 ObjectDataSource，並將它設定為使用 GetProductsAsPagedDataSource() 方法](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image2.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="dcb7a-137">[![Create an ObjectDataSource and Configure it to Use the GetProductsAsPagedDataSource() Method](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image2.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image1.png)</span></span>

<span data-ttu-id="dcb7a-138">**圖 1**:建立 ObjectDataSource，並將它設定為使用`GetProductsAsPagedDataSource()`方法 ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="dcb7a-138">**Figure 1**: Create an ObjectDataSource and Configure it to Use the `GetProductsAsPagedDataSource()` Method ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image3.png))</span></span>


<span data-ttu-id="dcb7a-139">[![設定下拉式清單中更新、 插入和刪除索引標籤為 （無）](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image5.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="dcb7a-139">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image5.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image4.png)</span></span>

<span data-ttu-id="dcb7a-140">**圖 2**:設定下拉式清單中更新、 插入和刪除索引標籤為 （無） ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="dcb7a-140">**Figure 2**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None) ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image6.png))</span></span>


<span data-ttu-id="dcb7a-141">不同於與，Visual Studio 不會自動建立`ItemTemplate`Repeater 控制項繫結至資料來源之後。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-141">Unlike with the DataList, Visual Studio does not automatically create an `ItemTemplate` for the Repeater control after binding it to a data source.</span></span> <span data-ttu-id="dcb7a-142">此外，我們必須將此新增`ItemTemplate`以宣告方式，如 Repeater 控制項 s 智慧標籤缺少 DataList s 中找到的 [編輯範本] 選項。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-142">Furthermore, we must add this `ItemTemplate` declaratively, as the Repeater control s smart tag lacks the Edit Templates option found in the DataList s.</span></span> <span data-ttu-id="dcb7a-143">可讓 s 使用相同`ItemTemplate`從上一個教學課程中，其中顯示 s 產品名稱、 供應商和類別目錄。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-143">Let s use the same `ItemTemplate` from the previous tutorial, which displayed the product s name, supplier, and category.</span></span>

<span data-ttu-id="dcb7a-144">在新增之後`ItemTemplate`，Repeater 和 ObjectDataSource s 宣告式標記看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="dcb7a-144">After adding the `ItemTemplate`, the Repeater and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample1.aspx)]

<span data-ttu-id="dcb7a-145">圖 3 顯示此頁面上，當透過瀏覽器檢視。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-145">Figure 3 shows this page when viewed through a browser.</span></span>


<span data-ttu-id="dcb7a-146">[![會顯示每項產品 s 的名稱，供應商和類別目錄](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image8.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="dcb7a-146">[![Each Product s Name, Supplier, and Category is Displayed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image8.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image7.png)</span></span>

<span data-ttu-id="dcb7a-147">**圖 3**:顯示每個產品名稱、 供應商和類別目錄 ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="dcb7a-147">**Figure 3**: Each Product s Name, Supplier, and Category is Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image9.png))</span></span>


## <a name="step-3-instructing-the-objectdatasource-to-sort-the-data"></a><span data-ttu-id="dcb7a-148">步驟 3：指示排序資料的 ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="dcb7a-148">Step 3: Instructing the ObjectDataSource to Sort the Data</span></span>

<span data-ttu-id="dcb7a-149">若要排序顯示中繼器中的資料，我們必須通知 ObjectDataSource 的資料應該排序的排序運算式。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-149">To sort the data displayed in the Repeater, we need to inform the ObjectDataSource of the sort expression by which the data should be sorted.</span></span> <span data-ttu-id="dcb7a-150">ObjectDataSource 擷取其資料之前，它首先會引發其[`Selecting`事件](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting.aspx)，可讓我們指定的排序運算式。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-150">Before the ObjectDataSource retrieves its data, it first fires its [`Selecting` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting.aspx), which provides an opportunity for us to specify a sort expression.</span></span> <span data-ttu-id="dcb7a-151">`Selecting`事件處理常式傳遞類型的物件[ `ObjectDataSourceSelectingEventArgs` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.aspx)，其中包含一個名為屬性[ `Arguments` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.arguments.aspx)型別的[ `DataSourceSelectArguments` ](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx)。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-151">The `Selecting` event handler is passed an object of type [`ObjectDataSourceSelectingEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.aspx), which has a property named [`Arguments`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.arguments.aspx) of type [`DataSourceSelectArguments`](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx).</span></span> <span data-ttu-id="dcb7a-152">`DataSourceSelectArguments`類別設計來將資料相關的要求資料的取用者從傳遞至資料來源控制項，並包含[`SortExpression`屬性](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.sortexpression.aspx)。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-152">The `DataSourceSelectArguments` class is designed to pass data-related requests from a consumer of data to the data source control, and includes a [`SortExpression` property](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.sortexpression.aspx).</span></span>

<span data-ttu-id="dcb7a-153">若要從 ASP.NET 網頁的排序資訊傳遞到 ObjectDataSource 中，建立 事件處理常式`Selecting`事件並使用下列程式碼：</span><span class="sxs-lookup"><span data-stu-id="dcb7a-153">To pass sorting information from the ASP.NET page to the ObjectDataSource, create an event handler for the `Selecting` event and use the following code:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample2.cs)]

<span data-ttu-id="dcb7a-154">*SortExpression*應將值指派要排序的資料 （例如產品名稱） 的資料欄位的名稱。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-154">The *sortExpression* value should be assigned the name of the data field to sort the data by (such as ProductName ).</span></span> <span data-ttu-id="dcb7a-155">沒有任何排序方向相關屬性，因此如果您想要排序的資料，以遞減順序，將字串附加 DESC 來*sortExpression*值 （例如 ProductName DESC)。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-155">There is no sort direction-related property, so if you want to sort the data in descending order, append the string DESC to the *sortExpression* value (such as ProductName DESC ).</span></span>

<span data-ttu-id="dcb7a-156">請繼續並嘗試一些不同硬式編碼的值為*sortExpression*和瀏覽器中測試的結果。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-156">Go ahead and try some different hard-coded values for *sortExpression* and test the results in a browser.</span></span> <span data-ttu-id="dcb7a-157">如 圖 4 所示，使用做為 ProductName DESC 時*sortExpression*，產品會依其名稱以反向字母順序排序。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-157">As Figure 4 shows, when using ProductName DESC as the *sortExpression*, the products are sorted by their name in reverse alphabetical order.</span></span>


<span data-ttu-id="dcb7a-158">[![產品會依其名稱以反向字母順序排序](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image11.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="dcb7a-158">[![The Products are Sorted by their Name in Reverse Alphabetical Order](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image11.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image10.png)</span></span>

<span data-ttu-id="dcb7a-159">**圖 4**:產品會依其名稱以反向字母順序排序 ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="dcb7a-159">**Figure 4**: The Products are Sorted by their Name in Reverse Alphabetical Order ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image12.png))</span></span>


## <a name="step-4-creating-the-sorting-interface-and-remembering-the-sort-expression-and-direction"></a><span data-ttu-id="dcb7a-160">步驟 4：建立介面，排序與記住的排序運算式和方向</span><span class="sxs-lookup"><span data-stu-id="dcb7a-160">Step 4: Creating the Sorting Interface and Remembering the Sort Expression and Direction</span></span>

<span data-ttu-id="dcb7a-161">開啟排序 GridView 裡的支援會將每個排序欄位 s 標頭文字轉換成 LinkButton，按一下時，排序的資料依此。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-161">Turning on sorting support in the GridView converts each sortable field s header text into a LinkButton that, when clicked, sorts the data accordingly.</span></span> <span data-ttu-id="dcb7a-162">這類排序的介面的合理 gridview，其中資料整齊的版面配置資料行。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-162">Such a sorting interface makes sense for the GridView, where its data is neatly laid out in columns.</span></span> <span data-ttu-id="dcb7a-163">DataList 與重複項控制項中，不過，不同的排序介面需要。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-163">For the DataList and Repeater controls, however, a different sorting interface is needed.</span></span> <span data-ttu-id="dcb7a-164">排序的通用介面，取得一份資料 （而不是資料方格的），是提供資料可以排序依據的欄位的下拉式清單。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-164">A common sorting interface for a list of data (as opposed to a grid of data), is a drop-down list that provides the fields by which the data can be sorted.</span></span> <span data-ttu-id="dcb7a-165">可讓 s 本教學課程中實作這類介面。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-165">Let s implement such an interface for this tutorial.</span></span>

<span data-ttu-id="dcb7a-166">新增上述的 DropDownList Web 控制項`SortableProducts`Repeater 並將其`ID`屬性設`SortBy`。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-166">Add a DropDownList Web control above the `SortableProducts` Repeater and set its `ID` property to `SortBy`.</span></span> <span data-ttu-id="dcb7a-167">從 [屬性] 視窗中，按一下省略符號，`Items`顯示 ListItem 集合編輯器的屬性。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-167">From the Properties window, click the ellipses in the `Items` property to bring up the ListItem Collection Editor.</span></span> <span data-ttu-id="dcb7a-168">新增`ListItem`來排序資料所`ProductName`， `CategoryName`，和`SupplierName`欄位。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-168">Add `ListItem` s to sort the data by the `ProductName`, `CategoryName`, and `SupplierName` fields.</span></span> <span data-ttu-id="dcb7a-169">也將新增`ListItem`依其名稱以反向字母順序排序的產品。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-169">Also add a `ListItem` to sort the products by their name in reverse alphabetical order.</span></span>

<span data-ttu-id="dcb7a-170">`ListItem` `Text`屬性可以設定為任何值 （例如名稱），但`Value`屬性必須設定為資料欄位的名稱 （例如產品名稱）。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-170">The `ListItem` `Text` properties can be set to any value (such as Name ), but the `Value` properties must be set to the name of the data field (such as ProductName ).</span></span> <span data-ttu-id="dcb7a-171">若要排序的結果以遞減順序，將字串附加 DESC 的資料欄位名稱，例如 ProductName DESC。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-171">To sort the results in descending order, append the string DESC to the data field name, like ProductName DESC .</span></span>


![每個可排序的資料欄位中新增清單項目](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image13.png)

<span data-ttu-id="dcb7a-173">**圖 5**:新增`ListItem`每個可排序的資料欄位</span><span class="sxs-lookup"><span data-stu-id="dcb7a-173">**Figure 5**: Add a `ListItem` for Each of the Sortable Data Fields</span></span>


<span data-ttu-id="dcb7a-174">最後，新增按鈕 Web 控制項右邊的 DropDownList。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-174">Finally, add a Button Web control to the right of the DropDownList.</span></span> <span data-ttu-id="dcb7a-175">設定其`ID`要`RefreshRepeater`及其`Text`屬性，以重新整理。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-175">Set its `ID` to `RefreshRepeater` and its `Text` property to Refresh .</span></span>

<span data-ttu-id="dcb7a-176">在建立之後`ListItem`s，新增 [重新整理] 按鈕的 DropDownList 和按鈕 s 宣告式語法看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="dcb7a-176">After creating the `ListItem` s and adding the Refresh button, the DropDownList and Button s declarative syntax should look similar to the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample3.aspx)]

<span data-ttu-id="dcb7a-177">使用排序下拉式清單中完成，我們接下來需要更新 ObjectDataSource s`Selecting`事件處理常式，因此它會使用所選`SortBy``ListItem`s`Value`屬性，而不是硬式編碼的排序運算式。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-177">With the sorting DropDownList complete, we next need to update the ObjectDataSource s `Selecting` event handler so that it uses the selected `SortBy``ListItem` s `Value` property as opposed to a hard-coded sort expression.</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample4.cs)]

<span data-ttu-id="dcb7a-178">在第一次造訪網頁時，此點產品會一開始依`ProductName`資料欄位，因為它 s `SortBy` `ListItem`預設選取 （請參閱 圖 6）。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-178">At this point when first visiting the page the products will initially be sorted by the `ProductName` data field, as it s the `SortBy` `ListItem` selected by default (see Figure 6).</span></span> <span data-ttu-id="dcb7a-179">選取不同的排序選項，例如類別和按一下 重新整理將會導致回傳，並重新排序資料分類名稱，如 圖 7 所示。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-179">Selecting a different sorting option such as Category and clicking Refresh will cause a postback and re-sort the data by the category name, as Figure 7 shows.</span></span>


<span data-ttu-id="dcb7a-180">[![產品現已依其名稱一開始排序](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image15.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="dcb7a-180">[![The Products are Initially Sorted by their Name](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image15.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image14.png)</span></span>

<span data-ttu-id="dcb7a-181">**圖 6**:產品是一開始會依其名稱 ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="dcb7a-181">**Figure 6**: The Products are Initially Sorted by their Name ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image16.png))</span></span>


<span data-ttu-id="dcb7a-182">[![現在依類別排序的產品現已](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image18.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="dcb7a-182">[![The Products are Now Sorted by Category](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image18.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image17.png)</span></span>

<span data-ttu-id="dcb7a-183">**圖 7**:產品現已現在依類別排序 ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="dcb7a-183">**Figure 7**: The Products are Now Sorted by Category ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image19.png))</span></span>


> [!NOTE]
> <span data-ttu-id="dcb7a-184">按一下 [重新整理] 按鈕會導致資料自動重新排序因為 Repeater 的檢視狀態已停用，因而導致重新繫結至它在每次回傳的資料來源的重複項。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-184">Clicking the Refresh button causes the data to automatically be re-sorted because the Repeater s view state has been disabled, thereby causing the Repeater to rebind to its data source on every postback.</span></span> <span data-ttu-id="dcb7a-185">如果您已保留重複項的檢視狀態已啟用，變更排序下拉式清單贏得 t 的清單會有任何影響的排序次序。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-185">If you ve left the Repeater s view state enabled, changing the sorting drop-down list won t have any affect on the sort order.</span></span> <span data-ttu-id="dcb7a-186">若要解決此問題，建立 [重新整理] 按鈕 s 的事件處理常式`Click`事件，並重新繫結至其資料來源的重複項 (藉由呼叫 Repeater 的`DataBind()`方法)。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-186">To remedy this, create an event handler for the Refresh Button s `Click` event and rebind the Repeater to its data source (by calling the Repeater s `DataBind()` method).</span></span>


## <a name="remembering-the-sort-expression-and-direction"></a><span data-ttu-id="dcb7a-187">記住的排序運算式和方向</span><span class="sxs-lookup"><span data-stu-id="dcb7a-187">Remembering the Sort Expression and Direction</span></span>

<span data-ttu-id="dcb7a-188">建立非排序相關，可能會發生回傳時，在頁面上的可排序的 DataList 或 Repeater 時它 s 命令式的排序運算式和方向會記住在回傳之間。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-188">When creating a sortable DataList or Repeater on a page where non-sort related postbacks may occur, it s imperative that the sort expression and direction be remembered across postbacks.</span></span> <span data-ttu-id="dcb7a-189">例如，假設我們在本教學課程，以包含每種產品的 [刪除] 按鈕，更新 Repeater。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-189">For example, imagine that we updated the Repeater in this tutorial to include a Delete button with each product.</span></span> <span data-ttu-id="dcb7a-190">當使用者按一下 [刪除] 按鈕 d 我們執行一些程式碼來刪除選取的產品，然後重新繫結之資料的重複項。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-190">When the user clicks the Delete button we d run some code to delete the selected product and then rebind the data to the Repeater.</span></span> <span data-ttu-id="dcb7a-191">如果排序詳細資料不會保存在回傳中，螢幕上顯示的資料將會還原成原始的排序順序。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-191">If the sort details are not persisted across postback, the data displayed on screen will revert to the original sort order.</span></span>

<span data-ttu-id="dcb7a-192">本教學課程中，DropDownList 以隱含方式儲存排序運算式和方向其檢視狀態中我們。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-192">For this tutorial, the DropDownList implicitly saves the sort expression and direction in its view state for us.</span></span> <span data-ttu-id="dcb7a-193">如果我們使用不同的排序介面其中一個使用所提供的各種不同的排序選項的說，Linkbutton d 我們要請務必記得在回傳之間的排序順序。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-193">If we were using a different sorting interface one with, say, LinkButtons that provided the various sorting options we d need to take care to remember the sort order across postbacks.</span></span> <span data-ttu-id="dcb7a-194">這可藉由在頁面的檢視狀態中，儲存排序的參數，藉由在查詢字串，或透過一些其他的狀態持續性技術，包括排序參數。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-194">This could be accomplished by storing the sorting parameters in the page s view state, by including the sort parameter in the querystring, or through some other state persistence technique.</span></span>

<span data-ttu-id="dcb7a-195">未來的範例，在本教學課程會探討如何保存頁面的檢視狀態中的排序詳細資料。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-195">Future examples in this tutorial explore how to persist the sorting details in the page s view state.</span></span>

## <a name="step-5-adding-sorting-support-to-a-datalist-that-uses-default-paging"></a><span data-ttu-id="dcb7a-196">步驟 5：加入排序支援，以使用預設的分頁 DataList</span><span class="sxs-lookup"><span data-stu-id="dcb7a-196">Step 5: Adding Sorting Support to a DataList that Uses Default Paging</span></span>

<span data-ttu-id="dcb7a-197">在 [前述教學課程](paging-report-data-in-a-datalist-or-repeater-control-cs.md)我們檢查如何實作具有 DataList 的預設分頁。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-197">In the [preceding tutorial](paging-report-data-in-a-datalist-or-repeater-control-cs.md) we examined how to implement default paging with a DataList.</span></span> <span data-ttu-id="dcb7a-198">可讓 s 延伸此先前的範例，以包含要排序的分頁的資料的能力。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-198">Let s extend this previous example to include the ability to sort the paged data.</span></span> <span data-ttu-id="dcb7a-199">首先開啟`SortingWithDefaultPaging.aspx`並`Paging.aspx`中的分頁`PagingSortingDataListRepeater`資料夾。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-199">Start by opening the `SortingWithDefaultPaging.aspx` and `Paging.aspx` pages in the `PagingSortingDataListRepeater` folder.</span></span> <span data-ttu-id="dcb7a-200">從`Paging.aspx`頁面上，按一下 [來源] 按鈕，以檢視 [s] 頁面的宣告式標記。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-200">From the `Paging.aspx` page, click on the Source button to view the page s declarative markup.</span></span> <span data-ttu-id="dcb7a-201">複製選取的文字 （請參閱 圖 8） 並將它貼到的宣告式標記`SortingWithDefaultPaging.aspx`之間`<asp:Content>`標記。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-201">Copy the selected text (see Figure 8) and paste it into the declarative markup of `SortingWithDefaultPaging.aspx` between the `<asp:Content>` tags.</span></span>


<span data-ttu-id="dcb7a-202">[![複寫中的宣告式標記&lt;asp: Content&gt; Paging.aspx SortingWithDefaultPaging.aspx 的標記](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image21.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="dcb7a-202">[![Replicate the Declarative Markup in the &lt;asp:Content&gt; Tags from Paging.aspx to SortingWithDefaultPaging.aspx](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image21.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image20.png)</span></span>

<span data-ttu-id="dcb7a-203">**圖 8**:複寫中的宣告式標記`<asp:Content>`標籤`Paging.aspx`要`SortingWithDefaultPaging.aspx`([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="dcb7a-203">**Figure 8**: Replicate the Declarative Markup in the `<asp:Content>` Tags from `Paging.aspx` to `SortingWithDefaultPaging.aspx` ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image22.png))</span></span>


<span data-ttu-id="dcb7a-204">複製之後宣告式標記，請將複製的方法和屬性中的`Paging.aspx`頁面上的程式碼後置類別 s 程式碼後置類別`SortingWithDefaultPaging.aspx`。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-204">After copying the declarative markup, copy the methods and properties in the `Paging.aspx` page s code-behind class to the code-behind class for `SortingWithDefaultPaging.aspx`.</span></span> <span data-ttu-id="dcb7a-205">接下來，請花一點時間檢視`SortingWithDefaultPaging.aspx`瀏覽器中的頁面。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-205">Next, take a moment to view the `SortingWithDefaultPaging.aspx` page in a browser.</span></span> <span data-ttu-id="dcb7a-206">它應該會表現相同的功能和外觀`Paging.aspx`。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-206">It should exhibit the same functionality and appearance as `Paging.aspx`.</span></span>

## <a name="enhancing-productsbll-to-include-a-default-paging-and-sorting-method"></a><span data-ttu-id="dcb7a-207">增強 ProductsBLL 包含預設的分頁和排序方法</span><span class="sxs-lookup"><span data-stu-id="dcb7a-207">Enhancing ProductsBLL to Include a Default Paging and Sorting Method</span></span>

<span data-ttu-id="dcb7a-208">我們在上一個教學課程中建立`GetProductsAsPagedDataSource(pageIndex, pageSize)`方法中的`ProductsBLL`類別傳回`PagedDataSource`物件。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-208">In the previous tutorial we created a `GetProductsAsPagedDataSource(pageIndex, pageSize)` method in the `ProductsBLL` class that returned a `PagedDataSource` object.</span></span> <span data-ttu-id="dcb7a-209">這`PagedDataSource`物件已填入*所有*的產品 (經由 BLL s`GetProducts()`方法)，但是當繫結至 DataList 對應到指定的記錄*pageIndex*並*pageSize*顯示輸入的參數。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-209">This `PagedDataSource` object was populated with *all* of the products (via the BLL s `GetProducts()` method), but when bound to the DataList only those records corresponding to the specified *pageIndex* and *pageSize* input parameters were displayed.</span></span>

<span data-ttu-id="dcb7a-210">稍早在本教學課程中加入排序支援藉由指定的排序運算式，從 ObjectDataSource 的`Selecting`事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-210">Earlier in this tutorial we added sorting support by specifying the sort expression from the ObjectDataSource s `Selecting` event handler.</span></span> <span data-ttu-id="dcb7a-211">這非常適合 ObjectDataSource 時傳回的物件，可以進行排序，例如`ProductsDataTable`所傳回`GetProducts()`方法。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-211">This works well when the ObjectDataSource is returned an object that can be sorted, like the `ProductsDataTable` returned by the `GetProducts()` method.</span></span> <span data-ttu-id="dcb7a-212">不過，`PagedDataSource`所傳回的物件`GetProductsAsPagedDataSource`方法不支援其內部資料來源的排序。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-212">However, the `PagedDataSource` object returned by the `GetProductsAsPagedDataSource` method does not support sorting of its inner data source.</span></span> <span data-ttu-id="dcb7a-213">相反地，我們需要從傳回的結果進行排序`GetProducts()`方法*之前*我們將它放`PagedDataSource`。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-213">Instead, we need to sort the results returned from the `GetProducts()` method *before* we put it in the `PagedDataSource`.</span></span>

<span data-ttu-id="dcb7a-214">若要達成此目的，建立新的方法，在`ProductsBLL`類別， `GetProductsSortedAsPagedDataSource(sortExpression, pageIndex, pageSize)`。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-214">To accomplish this, create a new method in the `ProductsBLL` class, `GetProductsSortedAsPagedDataSource(sortExpression, pageIndex, pageSize)`.</span></span> <span data-ttu-id="dcb7a-215">若要排序`ProductsDataTable`所傳回`GetProducts()`方法，指定`Sort`屬性，其預設的`DataTableView`:</span><span class="sxs-lookup"><span data-stu-id="dcb7a-215">To sort the `ProductsDataTable` returned by the `GetProducts()` method, specify the `Sort` property of its default `DataTableView`:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample5.cs)]

<span data-ttu-id="dcb7a-216">`GetProductsSortedAsPagedDataSource`方法只會稍微不同從`GetProductsAsPagedDataSource`在上一個教學課程中建立的方法。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-216">The `GetProductsSortedAsPagedDataSource` method differs only slightly from the `GetProductsAsPagedDataSource` method created in the previous tutorial.</span></span> <span data-ttu-id="dcb7a-217">特別是，`GetProductsSortedAsPagedDataSource`接受額外的輸入的參數`sortExpression`，並將指派此值可`Sort`屬性`ProductDataTable`s `DefaultView`。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-217">In particular, `GetProductsSortedAsPagedDataSource` accepts an additional input parameter `sortExpression` and assigns this value to the `Sort` property of the `ProductDataTable` s `DefaultView`.</span></span> <span data-ttu-id="dcb7a-218">幾行程式碼更新版本中，`PagedDataSource`指派給物件 s 資料來源`ProductDataTable`s `DefaultView`。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-218">A few lines of code later, the `PagedDataSource` object s DataSource is assigned the `ProductDataTable` s `DefaultView`.</span></span>

## <a name="calling-the-getproductssortedaspageddatasource-method-and-specifying-the-value-for-the-sortexpression-input-parameter"></a><span data-ttu-id="dcb7a-219">呼叫 GetProductsSortedAsPagedDataSource 方法並指定 SortExpression 輸入參數的值</span><span class="sxs-lookup"><span data-stu-id="dcb7a-219">Calling the GetProductsSortedAsPagedDataSource Method and Specifying the Value for the SortExpression Input Parameter</span></span>

<span data-ttu-id="dcb7a-220">使用`GetProductsSortedAsPagedDataSource`方法完成下, 一個步驟是為此參數提供值。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-220">With the `GetProductsSortedAsPagedDataSource` method complete, the next step is to provide the value for this parameter.</span></span> <span data-ttu-id="dcb7a-221">內的 ObjectDataSource`SortingWithDefaultPaging.aspx`目前設定為呼叫`GetProductsAsPagedDataSource`方法，並透過其兩個的兩個輸入參數中傳遞`QueryStringParameters`，指定在`SelectParameters`集合。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-221">The ObjectDataSource in `SortingWithDefaultPaging.aspx` is currently configured to call the `GetProductsAsPagedDataSource` method and passes in the two input parameters through its two `QueryStringParameters`, which are specified in the `SelectParameters` collection.</span></span> <span data-ttu-id="dcb7a-222">這兩個`QueryStringParameters`表示的來源`GetProductsAsPagedDataSource`方法 s *pageIndex*並*pageSize*參數來自的 querystring 欄位`pageIndex`和`pageSize`。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-222">These two `QueryStringParameters` indicate that the source for the `GetProductsAsPagedDataSource` method s *pageIndex* and *pageSize* parameters come from the querystring fields `pageIndex` and `pageSize`.</span></span>

<span data-ttu-id="dcb7a-223">更新 ObjectDataSource s`SelectMethod`屬性，因此它會叫用新`GetProductsSortedAsPagedDataSource`方法。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-223">Update the ObjectDataSource s `SelectMethod` property so that it invokes the new `GetProductsSortedAsPagedDataSource` method.</span></span> <span data-ttu-id="dcb7a-224">然後，新增`QueryStringParameter`如此*sortExpression*輸入的參數從查詢字串欄位存取`sortExpression`。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-224">Then, add a new `QueryStringParameter` so that the *sortExpression* input parameter is accessed from the querystring field `sortExpression`.</span></span> <span data-ttu-id="dcb7a-225">設定`QueryStringParameter`s`DefaultValue`到 ProductName。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-225">Set the `QueryStringParameter` s `DefaultValue` to ProductName .</span></span>

<span data-ttu-id="dcb7a-226">這些變更之後，請 ObjectDataSource s 宣告式標記看起來應該類似：</span><span class="sxs-lookup"><span data-stu-id="dcb7a-226">After these changes, the ObjectDataSource s declarative markup should look like:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample6.aspx)]

<span data-ttu-id="dcb7a-227">此時，`SortingWithDefaultPaging.aspx`頁面會依字母順序排序其結果，依產品名稱 （請參閱 圖 9）。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-227">At this point, the `SortingWithDefaultPaging.aspx` page will sort its results alphabetically by the product name (see Figure 9).</span></span> <span data-ttu-id="dcb7a-228">這是因為根據預設，產品名稱的值會當做傳入`GetProductsSortedAsPagedDataSource`方法 s *sortExpression*參數。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-228">This is because, by default, a value of ProductName is passed in as the `GetProductsSortedAsPagedDataSource` method s *sortExpression* parameter.</span></span>


<span data-ttu-id="dcb7a-229">[![根據預設，結果會按照產品名稱](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image24.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="dcb7a-229">[![By Default, the Results are Sorted by ProductName](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image24.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image23.png)</span></span>

<span data-ttu-id="dcb7a-230">**圖 9**:根據預設，結果會依照`ProductName`([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="dcb7a-230">**Figure 9**: By Default, the Results are Sorted by `ProductName` ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image25.png))</span></span>


<span data-ttu-id="dcb7a-231">如果您手動新增`sortExpression`這類的 querystring 欄位`SortingWithDefaultPaging.aspx?sortExpression=CategoryName`將排序結果所指定`sortExpression`。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-231">If you manually add a `sortExpression` querystring field such as `SortingWithDefaultPaging.aspx?sortExpression=CategoryName` the results will be sorted by the specified `sortExpression`.</span></span> <span data-ttu-id="dcb7a-232">不過，這`sortExpression`移至不同的資料頁時，查詢字串中不包含參數。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-232">However, this `sortExpression` parameter is not included in the querystring when moving to a different page of data.</span></span> <span data-ttu-id="dcb7a-233">事實上，按一下下一步] 或 [最後一個頁面上的按鈕會讓我們回到`Paging.aspx`！</span><span class="sxs-lookup"><span data-stu-id="dcb7a-233">In fact, clicking on the Next or Last page buttons takes us back to `Paging.aspx`!</span></span> <span data-ttu-id="dcb7a-234">此外，有 s 目前未排序的介面。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-234">Furthermore, there s currently no sorting interface.</span></span> <span data-ttu-id="dcb7a-235">使用者可以變更分頁的資料的排序次序的唯一方法是藉由直接操作查詢字串。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-235">The only way a user can change the sort order of the paged data is by manipulating the querystring directly.</span></span>

## <a name="creating-the-sorting-interface"></a><span data-ttu-id="dcb7a-236">建立排序的介面</span><span class="sxs-lookup"><span data-stu-id="dcb7a-236">Creating the Sorting Interface</span></span>

<span data-ttu-id="dcb7a-237">我們必須先更新`RedirectUser`方法，將傳送至使用者`SortingWithDefaultPaging.aspx`(而非`Paging.aspx`)，以及包含`sortExpression`於 querystring 中的值。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-237">We first need to update the `RedirectUser` method to send the user to `SortingWithDefaultPaging.aspx` (instead of `Paging.aspx`) and to include the `sortExpression` value in the querystring.</span></span> <span data-ttu-id="dcb7a-238">我們也應該新增唯讀、 頁面層級名為`SortExpression`屬性。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-238">We should also add a read-only, page-level named `SortExpression` property.</span></span> <span data-ttu-id="dcb7a-239">此屬性，類似於`PageIndex`並`PageSize`先前的教學課程中建立的屬性傳回的值`sortExpression`查詢字串欄位，如果存在，而且預設值 (ProductName) 否則。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-239">This property, similar to the `PageIndex` and `PageSize` properties created in the previous tutorial, returns the value of the `sortExpression` querystring field if it exists, and the default value ( ProductName ) otherwise.</span></span>

<span data-ttu-id="dcb7a-240">目前`RedirectUser`方法會接受只有一個輸入的參數來顯示頁面的索引。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-240">Currently the `RedirectUser` method accepts only a single input parameter the index of the page to display.</span></span> <span data-ttu-id="dcb7a-241">不過，可能是我們想要將使用者重新導向到特定的頁面，使用查詢字串中指定何種 s 以外的排序運算式的資料。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-241">However, there may be times when we want to redirect the user to a particular page of data using a sort expression other than what s specified in the querystring.</span></span> <span data-ttu-id="dcb7a-242">稍後我們將建立此頁面上，其中包含一系列按鈕 Web 控制項所指定的資料行排序資料的排序介面。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-242">In a moment we'll create the sorting interface for this page, which will include a series of Button Web controls for sorting the data by a specified column.</span></span> <span data-ttu-id="dcb7a-243">按一下其中一個這些按鈕時，我們想要傳入適當的排序運算式的值將使用者重新導向。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-243">When one of those Buttons is clicked, we want to redirect the user passing in the appropriate sort expression value.</span></span> <span data-ttu-id="dcb7a-244">若要提供這項功能，建立兩個版本`RedirectUser`方法。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-244">To provide this functionality, create two versions of the `RedirectUser` method.</span></span> <span data-ttu-id="dcb7a-245">第一個應該接受頁面索引顯示，而第二個可接受的頁面索引和排序運算式。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-245">The first one should accept just the page index to display, while the second one accepts the page index and sort expression.</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample7.cs)]

<span data-ttu-id="dcb7a-246">在本教學課程的第一個範例，我們會建立使用 dropdownlist 進行排序介面。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-246">In the first example in this tutorial, we created a sorting interface using a DropDownList.</span></span> <span data-ttu-id="dcb7a-247">此範例中，讓 s 使用上述其中一個 DataList 定位排序的三個按鈕 Web 控制項`ProductName`，下列其中一個用於`CategoryName`，，另一個用於`SupplierName`。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-247">For this example, let s use three Button Web controls positioned above the DataList one for sorting by `ProductName`, one for `CategoryName`, and one for `SupplierName`.</span></span> <span data-ttu-id="dcb7a-248">新增三個按鈕 Web 控制項、 設定其`ID`和`Text`屬性適當地：</span><span class="sxs-lookup"><span data-stu-id="dcb7a-248">Add the three Button Web controls, setting their `ID` and `Text` properties appropriately:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample8.aspx)]

<span data-ttu-id="dcb7a-249">接下來，建立`Click`每個事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-249">Next, create a `Click` event handler for each.</span></span> <span data-ttu-id="dcb7a-250">事件處理常式應該呼叫`RedirectUser`方法，以使用適當的排序運算式的第一頁已註冊的使用者。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-250">The event handlers should call the `RedirectUser` method, returning the user to the first page using the appropriate sort expression.</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample9.cs)]

<span data-ttu-id="dcb7a-251">當第一次瀏覽的頁面，資料會依產品名稱依字母順序排序 （請參閱上一步 圖 9）。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-251">When first visiting the page, the data is sorted by the product name alphabetically (refer back to Figure 9).</span></span> <span data-ttu-id="dcb7a-252">按一下 下一步 按鈕，前進到第二個資料頁，然後按一下 依類別目錄按鈕的 排序。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-252">Click the Next button to advance to the second page of data and then click the Sort by Category button.</span></span> <span data-ttu-id="dcb7a-253">這會傳回我們的資料，依照類別目錄名稱的第一頁 （請參閱 圖 10）。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-253">This returns us to the first page of data, sorted by category name (see Figure 10).</span></span> <span data-ttu-id="dcb7a-254">同樣地，由供應商 按鈕按一下排序會排序從資料的第一頁的供應商提供的資料。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-254">Likewise, clicking the Sort by Supplier button sorts the data by supplier starting from the first page of data.</span></span> <span data-ttu-id="dcb7a-255">因為資料透過分頁，會記住排序選擇。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-255">The sort choice is remembered as the data is paged through.</span></span> <span data-ttu-id="dcb7a-256">圖 11 顯示後依分類排序，然後逐步引導到第十三個資料頁的頁面。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-256">Figure 11 shows the page after sorting by category and then advancing to the thirteenth page of data.</span></span>


<span data-ttu-id="dcb7a-257">[![產品會依類別排序](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image27.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="dcb7a-257">[![The Products are Sorted by Category](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image27.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image26.png)</span></span>

<span data-ttu-id="dcb7a-258">**圖 10**:產品會依類別排序 ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="dcb7a-258">**Figure 10**: The Products are Sorted by Category ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image28.png))</span></span>


<span data-ttu-id="dcb7a-259">[![排序運算式會記住分頁透過資料的時間](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image30.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="dcb7a-259">[![The Sort Expression is Remembered When Paging Through the Data](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image30.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image29.png)</span></span>

<span data-ttu-id="dcb7a-260">**圖 11**:排序運算式會記住分頁透過資料的時間 ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="dcb7a-260">**Figure 11**: The Sort Expression is Remembered When Paging Through the Data ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image31.png))</span></span>


## <a name="step-6-custom-paging-through-records-in-a-repeater"></a><span data-ttu-id="dcb7a-261">步驟 6：透過記錄中的自訂分頁</span><span class="sxs-lookup"><span data-stu-id="dcb7a-261">Step 6: Custom Paging Through Records in a Repeater</span></span>

<span data-ttu-id="dcb7a-262">DataList 範例會檢查在步驟 5 的頁面，透過使用效率不佳的預設分頁技術及其資料。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-262">The DataList example examined in step 5 pages through its data using the inefficient default paging technique.</span></span> <span data-ttu-id="dcb7a-263">當夠大量的資料進行分頁，務必使用自訂分頁。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-263">When paging through sufficiently large amounts of data, it is imperative that custom paging be used.</span></span> <span data-ttu-id="dcb7a-264">回到[有效率地透過大型數量的資料分頁](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-cs.md)並[排序自訂的分頁資料](../paging-and-sorting/sorting-custom-paged-data-cs.md)教學課程中，我們會檢查的 BLL 預設和自訂分頁與建立的方法之間的差異使用自訂的分頁和排序自訂分頁的資料。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-264">Back in the [Efficiently Paging Through Large Amounts of Data](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-cs.md) and [Sorting Custom Paged Data](../paging-and-sorting/sorting-custom-paged-data-cs.md) tutorials, we examined the differences between default and custom paging and created methods in the BLL for utilizing custom paging and sorting custom paged data.</span></span> <span data-ttu-id="dcb7a-265">特別是，這些兩個先前的教學課程中我們加入下列三種方法`ProductsBLL`類別：</span><span class="sxs-lookup"><span data-stu-id="dcb7a-265">In particular, in these two previous tutorials we added the following three methods to the `ProductsBLL` class:</span></span>

- <span data-ttu-id="dcb7a-266">`GetProductsPaged(startRowIndex, maximumRows)` 傳回開始記錄的特定子集*startRowIndex*並不超過*maximumRows*。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-266">`GetProductsPaged(startRowIndex, maximumRows)` returns a particular subset of records starting at *startRowIndex* and not exceeding *maximumRows*.</span></span>
- <span data-ttu-id="dcb7a-267">`GetProductsPagedAndSorted(sortExpression, startRowIndex, maximumRows)` 傳回排序所指定的記錄的特定子集*sortExpression*輸入的參數。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-267">`GetProductsPagedAndSorted(sortExpression, startRowIndex, maximumRows)` returns a particular subset of records sorted by the specified *sortExpression* input parameter.</span></span>
- <span data-ttu-id="dcb7a-268">`TotalNumberOfProducts()` 提供在中的記錄總數`Products`資料庫資料表。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-268">`TotalNumberOfProducts()` provides the total number of records in the `Products` database table.</span></span>

<span data-ttu-id="dcb7a-269">這些方法可用來有效率地頁面上，並使用 DataList 或 Repeater 控制項的資料進行排序。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-269">These methods can be used to efficiently page and sort through data using a DataList or Repeater control.</span></span> <span data-ttu-id="dcb7a-270">為了說明這點，讓開始使用自訂的分頁支援; 建立 Repeater 控制項的 s然後，我們將新增排序功能。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-270">To illustrate this, let s start by creating a Repeater control with custom paging support; we'll then add sorting capabilities.</span></span>

<span data-ttu-id="dcb7a-271">開啟`SortingWithCustomPaging.aspx`頁面中`PagingSortingDataListRepeater`資料夾，並將重複項新增至頁面上，設定其`ID`屬性設`Products`。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-271">Open the `SortingWithCustomPaging.aspx` page in the `PagingSortingDataListRepeater` folder and add a Repeater to the page, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="dcb7a-272">從 Repeater s 智慧標籤，建立名為新 ObjectDataSource `ProductsDataSource`。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-272">From the Repeater s smart tag, create a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="dcb7a-273">設定以選取資料的來源`ProductsBLL`類別的`GetProductsPaged`方法。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-273">Configure it to select its data from the `ProductsBLL` class s `GetProductsPaged` method.</span></span>


<span data-ttu-id="dcb7a-274">[![設定為使用 ProductsBLL 類別的 GetProductsPaged 方法的 ObjectDataSource](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image33.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="dcb7a-274">[![Configure the ObjectDataSource to Use the ProductsBLL Class s GetProductsPaged Method](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image33.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image32.png)</span></span>

<span data-ttu-id="dcb7a-275">**圖 12**:設定要使用 ObjectDataSource`ProductsBLL`類別 s`GetProductsPaged`方法 ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="dcb7a-275">**Figure 12**: Configure the ObjectDataSource to Use the `ProductsBLL` Class s `GetProductsPaged` Method ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image34.png))</span></span>


<span data-ttu-id="dcb7a-276">設定下拉式清單中更新、 插入和刪除為 [（無）] 索引標籤，然後按 [下一步] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-276">Set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) and then click the Next button.</span></span> <span data-ttu-id="dcb7a-277">設定資料來源精靈現在會提示輸入的來源`GetProductsPaged`方法 s *startRowIndex*並*maximumRows*輸入參數。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-277">The Configure Data Source wizard now prompts for the sources of the `GetProductsPaged` method s *startRowIndex* and *maximumRows* input parameters.</span></span> <span data-ttu-id="dcb7a-278">實際上，會忽略這些輸入的參數。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-278">In actuality, these input parameters are ignored.</span></span> <span data-ttu-id="dcb7a-279">相反地， *startRowIndex*並*maximumRows*的值將會在傳遞給`Arguments`中之 ObjectDataSource 的屬性`Selecting`事件處理常式，就像我們所指定的方式*sortExpression*在此教學課程 s 第一個示範。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-279">Instead, the *startRowIndex* and *maximumRows* values will be passed in through the `Arguments` property in the ObjectDataSource s `Selecting` event handler, just like how we specified the *sortExpression* in this tutorial s first demo.</span></span> <span data-ttu-id="dcb7a-280">因此，保留參數來源下拉式清單，在精靈中設定為 None。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-280">Therefore, leave the parameter source drop-down lists in the wizard set at None .</span></span>


<span data-ttu-id="dcb7a-281">[![保留參數的 [來源] 設定為 None](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image36.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="dcb7a-281">[![Leave the Parameter Sources Set to None](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image36.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image35.png)</span></span>

<span data-ttu-id="dcb7a-282">**圖 13**:將參數的來源設定為 None ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="dcb7a-282">**Figure 13**: Leave the Parameter Sources Set to None ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image37.png))</span></span>


> [!NOTE]
> <span data-ttu-id="dcb7a-283">請勿*未*設定 ObjectDataSource s`EnablePaging`屬性設`true`。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-283">Do *not* set the ObjectDataSource s `EnablePaging` property to `true`.</span></span> <span data-ttu-id="dcb7a-284">這會自動包含它自己的 ObjectDataSource *startRowIndex*並*maximumRows*參數`SelectMethod`s 現有的參數清單。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-284">This will cause the ObjectDataSource to automatically include its own *startRowIndex* and *maximumRows* parameters to the `SelectMethod` s existing parameter list.</span></span> <span data-ttu-id="dcb7a-285">`EnablePaging`屬性時，繫結自訂分頁至 GridView、 DetailsView 或 FormView 控制項的資料，因為這些控制項預期從 ObjectDataSource s 特定行為僅適用於當`EnablePaging`屬性是`true`。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-285">The `EnablePaging` property is useful when binding custom paged data to a GridView, DetailsView, or FormView control because these controls expect certain behavior from the ObjectDataSource that s only available when `EnablePaging` property is `true`.</span></span> <span data-ttu-id="dcb7a-286">因為我們必須以手動方式新增 DataList 與重複項分頁支援，保留這個屬性設定為`false`（預設值），因為我們將直接在我們的 ASP.NET 頁面內試吃中所需的功能。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-286">Since we have to manually add the paging support for the DataList and Repeater, leave this property set to `false` (the default), as we'll bake in the needed functionality directly within our ASP.NET page.</span></span>


<span data-ttu-id="dcb7a-287">最後，定義 Repeater 的`ItemTemplate`以便顯示 s 產品名稱、 類別和供應商。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-287">Finally, define the Repeater s `ItemTemplate` so that the product s name, category, and supplier are shown.</span></span> <span data-ttu-id="dcb7a-288">這些變更之後，請重複項與 ObjectDataSource s 宣告式語法看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="dcb7a-288">After these changes, the Repeater and ObjectDataSource s declarative syntax should look similar to the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample10.aspx)]

<span data-ttu-id="dcb7a-289">請花一點時間瀏覽的頁面，透過瀏覽器，並記下會傳回任何記錄。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-289">Take a moment to visit the page through a browser and note that no records are returned.</span></span> <span data-ttu-id="dcb7a-290">這是因為我們尚未以指定 ve *startRowIndex*並*maximumRows*參數值; 因此，值為 0 會傳入兩個。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-290">This is because we ve yet to specify the *startRowIndex* and *maximumRows* parameter values; therefore, values of 0 are being passed in for both.</span></span> <span data-ttu-id="dcb7a-291">若要指定這些值，建立事件處理常式 ObjectDataSource s`Selecting`事件及設定這些參數值以程式設計方式將值硬式編碼的 0 到 5，分別：</span><span class="sxs-lookup"><span data-stu-id="dcb7a-291">To specify these values, create an event handler for the ObjectDataSource s `Selecting` event and set these parameters values programmatically to hard-coded values of 0 and 5, respectively:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample11.cs)]

<span data-ttu-id="dcb7a-292">透過這項變更，頁面上，當透過瀏覽器中，檢視會顯示前五個產品。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-292">With this change, the page, when viewed through a browser, shows the first five products.</span></span>


<span data-ttu-id="dcb7a-293">[![會顯示前五筆記錄](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image39.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="dcb7a-293">[![The First Five Records are Displayed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image39.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image38.png)</span></span>

<span data-ttu-id="dcb7a-294">**圖 14**:會顯示前五筆記錄 ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="dcb7a-294">**Figure 14**: The First Five Records are Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image40.png))</span></span>


> [!NOTE]
> <span data-ttu-id="dcb7a-295">[圖 14] 中所列出之產品剛好排序依產品名稱，因為`GetProductsPaged`會執行有效率的自訂分頁查詢的預存程序來排序結果所`ProductName`。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-295">The products listed in Figure 14 happen to be sorted by product name because the `GetProductsPaged` stored procedure that performs the efficient custom paging query orders the results by `ProductName`.</span></span>


<span data-ttu-id="dcb7a-296">若要讓使用者逐步進行頁面，我們要追蹤的起始資料列索引和最大的資料列，並記得在回傳之間的這些值。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-296">In order to allow the user to step through the pages, we need to keep track of the start row index and maximum rows and remember these values across postbacks.</span></span> <span data-ttu-id="dcb7a-297">預設分頁範例中使用查詢字串欄位來保存這些值;此示範中，讓保存這項資訊頁面的檢視狀態中的 s。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-297">In the default paging example we used querystring fields to persist these values; for this demo, let s persist this information in the page s view state.</span></span> <span data-ttu-id="dcb7a-298">建立下列兩個屬性：</span><span class="sxs-lookup"><span data-stu-id="dcb7a-298">Create the following two properties:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample12.cs)]

<span data-ttu-id="dcb7a-299">接下來，更新選取的事件處理常式中的程式碼，使其使用`StartRowIndex`和`MaximumRows`屬性，而不是 0 到 5 的硬式編碼值：</span><span class="sxs-lookup"><span data-stu-id="dcb7a-299">Next, update the code in the Selecting event handler so that it uses the `StartRowIndex` and `MaximumRows` properties instead of the hard-coded values of 0 and 5:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample13.cs)]

<span data-ttu-id="dcb7a-300">此時我們網頁仍會顯示前五個的記錄。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-300">At this point our page still shows just the first five records.</span></span> <span data-ttu-id="dcb7a-301">不過，具有下列屬性的位置，我們準備好建立我們的分頁介面。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-301">However, with these properties in place, we re ready to create our paging interface.</span></span>

## <a name="adding-the-paging-interface"></a><span data-ttu-id="dcb7a-302">新增分頁介面</span><span class="sxs-lookup"><span data-stu-id="dcb7a-302">Adding the Paging Interface</span></span>

<span data-ttu-id="dcb7a-303">可讓的使用相同的第一個、 上一步，接下來，最後一個分頁介面用於預設分頁範例中，包括在檢視會顯示哪些資料頁的控制項的標籤 Web 和多少的總頁數存在。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-303">Let s use the same First, Previous, Next, Last paging interface used in the default paging example, including the Label Web control that displays what page of data is being viewed and how many total pages exist.</span></span> <span data-ttu-id="dcb7a-304">新增四個按鈕 Web 控制項和 Repeater 下方的標籤。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-304">Add the four Button Web controls and Label below the Repeater.</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample14.aspx)]

<span data-ttu-id="dcb7a-305">接下來，建立`Click`的四個按鈕的事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-305">Next, create `Click` event handlers for the four Buttons.</span></span> <span data-ttu-id="dcb7a-306">按一下其中一個按鈕時，我們需要更新`StartRowIndex`和重新繫結之資料的重複項。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-306">When one of these Buttons is clicked, we need to update the `StartRowIndex` and rebind the data to the Repeater.</span></span> <span data-ttu-id="dcb7a-307">[名字]、 [上一個] 和 [下一步] 按鈕的程式碼相當簡單，但最後一個按鈕執行我們如何判斷資料的最後一頁開始的資料列索引嗎？</span><span class="sxs-lookup"><span data-stu-id="dcb7a-307">The code for the First, Previous, and Next buttons is simple enough, but for the Last button how do we determine the start row index for the last page of data?</span></span> <span data-ttu-id="dcb7a-308">若要計算此索引，以及能夠判斷是否應該啟用下一步] 和 [最後一個按鈕我們需要知道總共的多少筆記錄會透過已分頁。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-308">To compute this index as well as being able to determine whether the Next and Last buttons should be enabled we need to know how many records in total are being paged through.</span></span> <span data-ttu-id="dcb7a-309">我們可以呼叫來判斷這`ProductsBLL`類別的`TotalNumberOfProducts()`方法。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-309">We can determine this by calling the `ProductsBLL` class s `TotalNumberOfProducts()` method.</span></span> <span data-ttu-id="dcb7a-310">建立名為唯讀、 頁面層級屬性，可讓 s`TotalRowCount`傳回的結果`TotalNumberOfProducts()`方法：</span><span class="sxs-lookup"><span data-stu-id="dcb7a-310">Let s create a read-only, page-level property named `TotalRowCount` that returns the results of the `TotalNumberOfProducts()` method:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample15.cs)]

<span data-ttu-id="dcb7a-311">與這個屬性，我們現在可以判斷的最後一個頁面的起始資料列索引。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-311">With this property we can now determine the last page s start row index.</span></span> <span data-ttu-id="dcb7a-312">具體來說，它 s 整數結果的`TotalRowCount`減 1 除以`MaximumRows`乘以`MaximumRows`。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-312">Specifically, it s the integer result of the `TotalRowCount` minus 1 divided by `MaximumRows`, multiplied by `MaximumRows`.</span></span> <span data-ttu-id="dcb7a-313">現在我們可以撰寫`Click`四個分頁介面按鈕的事件處理常式：</span><span class="sxs-lookup"><span data-stu-id="dcb7a-313">We can now write the `Click` event handlers for the four paging interface buttons:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample16.cs)]

<span data-ttu-id="dcb7a-314">最後，我們需要時檢視資料 和 下一頁 和 最後一個 按鈕的第一頁，檢視的最後一頁時，停用分頁介面中的第一個 和 上一頁 按鈕。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-314">Finally, we need to disable the First and Previous buttons in the paging interface when viewing the first page of data and the Next and Last buttons when viewing the last page.</span></span> <span data-ttu-id="dcb7a-315">若要這麼做，請將下列程式碼新增至 ObjectDataSource 的`Selecting`事件處理常式：</span><span class="sxs-lookup"><span data-stu-id="dcb7a-315">To accomplish this, add the following code to the ObjectDataSource s `Selecting` event handler:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample17.cs)]

<span data-ttu-id="dcb7a-316">新增這些之後`Click`事件處理常式和程式碼，以啟用或停用介面分頁的項目已根據目前的起始資料列索引，測試網頁瀏覽器中。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-316">After adding these `Click` event handlers and the code to enable or disable the paging interface elements based on the current start row index, test the page in a browser.</span></span> <span data-ttu-id="dcb7a-317">如 [圖 15 所示，當第一次瀏覽頁面的第一個和上一步] 按鈕將會停用。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-317">As Figure 15 illustrates, when first visiting the page the First and Previous buttons will are disabled.</span></span> <span data-ttu-id="dcb7a-318">按一下 [下一步] 顯示的資料，第二個頁面，而按一下最後一個會顯示最後一頁 （請參閱圖 16，17）。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-318">Clicking Next shows the second page of data, while clicking Last displays the final page (see Figures 16 and 17).</span></span> <span data-ttu-id="dcb7a-319">檢視資料的最後一頁時就會停用 下一步 和 最後一個按鈕。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-319">When viewing the last page of data both the Next and Last buttons are disabled.</span></span>


<span data-ttu-id="dcb7a-320">[![[上一步] 和 最後一個按鈕就會停用檢視第一個頁面的產品](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image42.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="dcb7a-320">[![The Previous and Last Buttons are Disabled When Viewing the First Page of Products](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image42.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image41.png)</span></span>

<span data-ttu-id="dcb7a-321">**圖 15**:[上一步] 和 最後一個按鈕就會停用檢視第一個頁面的產品 ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image43.png))</span><span class="sxs-lookup"><span data-stu-id="dcb7a-321">**Figure 15**: The Previous and Last Buttons are Disabled When Viewing the First Page of Products ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image43.png))</span></span>


<span data-ttu-id="dcb7a-322">[![第二個頁面的產品現已 Dispalyed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image45.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image44.png)</span><span class="sxs-lookup"><span data-stu-id="dcb7a-322">[![The Second Page of Products are Dispalyed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image45.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image44.png)</span></span>

<span data-ttu-id="dcb7a-323">**圖 16**:第二個頁面的產品現已 Dispalyed ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image46.png))</span><span class="sxs-lookup"><span data-stu-id="dcb7a-323">**Figure 16**: The Second Page of Products are Dispalyed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image46.png))</span></span>


<span data-ttu-id="dcb7a-324">[![按一下最後一個顯示資料的最後一頁](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image48.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image47.png)</span><span class="sxs-lookup"><span data-stu-id="dcb7a-324">[![Clicking Last Displays the Final Page of Data](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image48.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image47.png)</span></span>

<span data-ttu-id="dcb7a-325">**圖 17**:按一下最後一個會顯示最後的頁面上的資料 ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image49.png))</span><span class="sxs-lookup"><span data-stu-id="dcb7a-325">**Figure 17**: Clicking Last Displays the Final Page of Data ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image49.png))</span></span>


## <a name="step-7-including-sorting-support-with-the-custom-paged-repeater"></a><span data-ttu-id="dcb7a-326">步驟 7：包括排序支援，以自訂分頁 Repeater</span><span class="sxs-lookup"><span data-stu-id="dcb7a-326">Step 7: Including Sorting Support with the Custom Paged Repeater</span></span>

<span data-ttu-id="dcb7a-327">既然已實作自訂分頁，我們準備好要包含排序支援。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-327">Now that custom paging has been implemented, we re ready to include sorting support.</span></span> <span data-ttu-id="dcb7a-328">`ProductsBLL`類別 s`GetProductsPagedAndSorted`方法具有相同*startRowIndex*並*maximumRows*輸入做為參數`GetProductsPaged`，但允許其他*sortExpression*輸入的參數。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-328">The `ProductsBLL` class s `GetProductsPagedAndSorted` method has the same *startRowIndex* and *maximumRows* input parameters as `GetProductsPaged`, but permits an additional *sortExpression* input parameter.</span></span> <span data-ttu-id="dcb7a-329">若要使用`GetProductsPagedAndSorted`方法從`SortingWithCustomPaging.aspx`，我們需要執行下列步驟：</span><span class="sxs-lookup"><span data-stu-id="dcb7a-329">To use the `GetProductsPagedAndSorted` method from `SortingWithCustomPaging.aspx`, we need to perform the following steps:</span></span>

1. <span data-ttu-id="dcb7a-330">變更 ObjectDataSource s`SelectMethod`屬性從`GetProductsPaged`至`GetProductsPagedAndSorted`。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-330">Change the ObjectDataSource s `SelectMethod` property from `GetProductsPaged` to `GetProductsPagedAndSorted`.</span></span>
2. <span data-ttu-id="dcb7a-331">新增*sortExpression* `Parameter`物件的 ObjectDataSource s`SelectParameters`集合。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-331">Add a *sortExpression* `Parameter` object to the ObjectDataSource s `SelectParameters` collection.</span></span>
3. <span data-ttu-id="dcb7a-332">建立私用的頁面層級`SortExpression`在透過 [s] 頁面檢視狀態的回傳之間保存其值的屬性。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-332">Create a private, page-level `SortExpression` property that persists its value across postbacks through the page s view state.</span></span>
4. <span data-ttu-id="dcb7a-333">更新 ObjectDataSource s`Selecting`事件處理常式來指派 ObjectDataSource s *sortExpression*參數的值的頁面層級`SortExpression`屬性。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-333">Update the ObjectDataSource s `Selecting` event handler to assign the ObjectDataSource s *sortExpression* parameter the value of the page-level `SortExpression` property.</span></span>
5. <span data-ttu-id="dcb7a-334">建立排序的介面。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-334">Create the sorting interface.</span></span>

<span data-ttu-id="dcb7a-335">藉由更新 ObjectDataSource s 開始`SelectMethod`屬性，並新增*sortExpression* `Parameter`。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-335">Start by updating the ObjectDataSource s `SelectMethod` property and adding a *sortExpression* `Parameter`.</span></span> <span data-ttu-id="dcb7a-336">請確定*sortExpression* `Parameter` s`Type`屬性設定為`String`。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-336">Make sure that the *sortExpression* `Parameter` s `Type` property is set to `String`.</span></span> <span data-ttu-id="dcb7a-337">完成前兩項工作之後, ObjectDataSource s 宣告式標記看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="dcb7a-337">After completing these first two tasks, the ObjectDataSource s declarative markup should look like the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample18.aspx)]

<span data-ttu-id="dcb7a-338">接下來，我們需要的頁面層級`SortExpression`其值序列化至檢視狀態的屬性。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-338">Next, we need a page-level `SortExpression` property whose value is serialized to view state.</span></span> <span data-ttu-id="dcb7a-339">如果尚未設定任何排序運算式的值，使用產品名稱做為預設值：</span><span class="sxs-lookup"><span data-stu-id="dcb7a-339">If no sort expression value has been set, use ProductName as the default:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample19.cs)]

<span data-ttu-id="dcb7a-340">ObjectDataSource 會叫用之前`GetProductsPagedAndSorted`方法，我們需要設定*sortExpression* `Parameter`的值`SortExpression`屬性。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-340">Before the ObjectDataSource invokes the `GetProductsPagedAndSorted` method we need to set the *sortExpression* `Parameter` to the value of the `SortExpression` property.</span></span> <span data-ttu-id="dcb7a-341">在 `Selecting`事件處理常式，加入下列程式碼行：</span><span class="sxs-lookup"><span data-stu-id="dcb7a-341">In the `Selecting` event handler, add the following line of code:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample20.cs)]

<span data-ttu-id="dcb7a-342">所有剩下就是實作排序的介面。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-342">All that remains is to implement the sorting interface.</span></span> <span data-ttu-id="dcb7a-343">如同我們在上一個範例，可讓 s 已實作 依產品名稱、 類別或供應商的 使用三個按鈕 Web 控制項可讓使用者排序結果的排序介面。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-343">As we did in the last example, let s have the sorting interface implemented using three Button Web controls that allow the user to sort the results by product name, category, or supplier.</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample21.aspx)]

<span data-ttu-id="dcb7a-344">建立`Click`這三個按鈕控制項的事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-344">Create `Click` event handlers for these three Button controls.</span></span> <span data-ttu-id="dcb7a-345">在事件處理常式中，重設`StartRowIndex`設成 0，設定`SortExpression`適當的值，並重新繫結至 Repeater 資料：</span><span class="sxs-lookup"><span data-stu-id="dcb7a-345">In the event handler, reset the `StartRowIndex` to 0, set the `SortExpression` to the appropriate value, and rebind the data to the Repeater:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample22.cs)]

<span data-ttu-id="dcb7a-346">S 就是這麼簡單 ！</span><span class="sxs-lookup"><span data-stu-id="dcb7a-346">That s all there is to it!</span></span> <span data-ttu-id="dcb7a-347">儘管有幾個步驟，以取得自訂的分頁和排序實作，步驟都非常類似於所需的預設分頁。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-347">While there were a number of steps to get custom paging and sorting implemented, the steps were very similar to those needed for default paging.</span></span> <span data-ttu-id="dcb7a-348">圖 18.顯示產品，檢視依類別排序的資料的最後一頁時。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-348">Figure 18 shows the products when viewing the last page of data when sorted by category.</span></span>


<span data-ttu-id="dcb7a-349">[![顯示資料的最後一個頁面上，依類別排序](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image51.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="dcb7a-349">[![The Last Page of Data, Sorted by Category, is Displayed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image51.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image50.png)</span></span>

<span data-ttu-id="dcb7a-350">**圖 18**:顯示資料的最後一個頁面上，依類別排序 ([按一下以檢視完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image52.png))</span><span class="sxs-lookup"><span data-stu-id="dcb7a-350">**Figure 18**: The Last Page of Data, Sorted by Category, is Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image52.png))</span></span>


> [!NOTE]
> <span data-ttu-id="dcb7a-351">在上一個範例中，請依供應商供應商名稱當做排序運算式排序時。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-351">In previous examples, when sorting by the supplier SupplierName was used as the sort expression.</span></span> <span data-ttu-id="dcb7a-352">不過，自訂的分頁實作中，我們需要使用公司名稱。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-352">However, for the custom paging implementation, we need to use CompanyName.</span></span> <span data-ttu-id="dcb7a-353">這是因為預存程序負責實作自訂分頁`GetProductsPagedAndSorted`傳遞到排序運算式`ROW_NUMBER()`關鍵字，`ROW_NUMBER()`關鍵字需要實際的資料行名稱，而不是別名。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-353">This is because the stored procedure responsible for implementing custom paging `GetProductsPagedAndSorted` passes the sort expression into the `ROW_NUMBER()` keyword, The `ROW_NUMBER()` keyword requires the actual column name rather than an alias.</span></span> <span data-ttu-id="dcb7a-354">因此，我們必須使用`CompanyName`(在資料行名稱`Suppliers`資料表) 而不是使用中的別名`SELECT`查詢 (`SupplierName`) 的排序運算式。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-354">Therefore, we must use `CompanyName` (the name of the column in the `Suppliers` table) rather than the alias used in the `SELECT` query (`SupplierName`) for the sort expression.</span></span>


## <a name="summary"></a><span data-ttu-id="dcb7a-355">總結</span><span class="sxs-lookup"><span data-stu-id="dcb7a-355">Summary</span></span>

<span data-ttu-id="dcb7a-356">既不 DataList 或 Repeater 提供內建的排序支援，但可加入一些程式碼和自訂的排序介面，這類功能。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-356">Neither the DataList nor Repeater offer built-in sorting support, but with a bit of code and a custom sorting interface, such functionality can be added.</span></span> <span data-ttu-id="dcb7a-357">在實作排序，但不是會進行分頁時，可以透過指定的排序運算式`DataSourceSelectArguments`物件傳遞到 ObjectDataSource 的`Select`方法。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-357">When implementing sorting, but not paging, the sort expression can be specified through the `DataSourceSelectArguments` object passed into the ObjectDataSource s `Select` method.</span></span> <span data-ttu-id="dcb7a-358">這`DataSourceSelectArguments`物件 s`SortExpression`屬性中之 ObjectDataSource 指派`Selecting`事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-358">This `DataSourceSelectArguments` object s `SortExpression` property can be assigned in the ObjectDataSource s `Selecting` event handler.</span></span>

<span data-ttu-id="dcb7a-359">若要將排序功能新增至 DataList 或 Repeater 已提供分頁支援，最簡單的方法是自訂商務邏輯層，以納入方法可接受的排序運算式。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-359">To add sorting capabilities to a DataList or Repeater that already provides paging support, the easiest approach is to customize the Business Logic Layer to include a method that accepts a sort expression.</span></span> <span data-ttu-id="dcb7a-360">這項資訊可以傳入透過 ObjectDataSource s 中的參數`SelectParameters`。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-360">This information can then be passed in through a parameter in the ObjectDataSource s `SelectParameters`.</span></span>

<span data-ttu-id="dcb7a-361">本教學課程中完成我們的分頁和排序的 DataList 與重複項控制項的檢查。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-361">This tutorial completes our examination of paging and sorting with the DataList and Repeater controls.</span></span> <span data-ttu-id="dcb7a-362">我們的下一個和最後一個教學課程將探討如何將按鈕 Web 控制項新增至 DataList 與重複項的 「 s 」 範本，以提供每個項目為基礎的一些自訂的使用者啟動的功能。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-362">Our next and final tutorial will examine how to add Button Web controls to the DataList and Repeater s templates in order to provide some custom, user-initiated functionality on a per-item basis.</span></span>

<span data-ttu-id="dcb7a-363">快樂地寫程式 ！</span><span class="sxs-lookup"><span data-stu-id="dcb7a-363">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="dcb7a-364">關於作者</span><span class="sxs-lookup"><span data-stu-id="dcb7a-364">About the Author</span></span>

<span data-ttu-id="dcb7a-365">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，作者的七個 ASP 書籍和的創辦人[4GuysFromRolla.com](http://www.4guysfromrolla.com)，自 1998 年從事 Microsoft Web 技術工作。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-365">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="dcb7a-366">Scott 會擔任獨立的顧問、 培訓講師和作家。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-366">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="dcb7a-367">他最新的著作是[ *Sams 教導您自己 ASP.NET 2.0 在 24 小時內*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-367">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="dcb7a-368">他可以在觸達[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="dcb7a-368">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="dcb7a-369">或透過他的部落格，這位於 [http://ScottOnWriting.NET](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-369">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="dcb7a-370">特別感謝</span><span class="sxs-lookup"><span data-stu-id="dcb7a-370">Special Thanks To</span></span>

<span data-ttu-id="dcb7a-371">本教學課程系列是由許多實用的檢閱者檢閱。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-371">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="dcb7a-372">本教學課程中的潛在客戶檢閱者為 David Suru。</span><span class="sxs-lookup"><span data-stu-id="dcb7a-372">Lead reviewer for this tutorial was David Suru.</span></span> <span data-ttu-id="dcb7a-373">有興趣檢閱我即將推出的 MSDN 文章嗎？</span><span class="sxs-lookup"><span data-stu-id="dcb7a-373">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="dcb7a-374">如果是這樣，psychic 在[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="dcb7a-374">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="dcb7a-375">[上一頁](paging-report-data-in-a-datalist-or-repeater-control-cs.md)
> [下一頁](paging-report-data-in-a-datalist-or-repeater-control-vb.md)</span><span class="sxs-lookup"><span data-stu-id="dcb7a-375">[Previous](paging-report-data-in-a-datalist-or-repeater-control-cs.md)
[Next](paging-report-data-in-a-datalist-or-repeater-control-vb.md)</span></span>
