---
uid: web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/sorting-data-in-a-datalist-or-repeater-control-cs
title: 在 DataList 或重複項控制項中排序資料C#（） |Microsoft Docs
author: rick-anderson
description: 在本教學課程中，我們將探討如何在 DataList 和重複項中包含排序支援，以及如何建立其資料可以的 DataList 或中繼器 。
ms.author: riande
ms.date: 11/13/2006
ms.assetid: f52c302a-1b7c-46fe-8a13-8412c95cbf6d
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/sorting-data-in-a-datalist-or-repeater-control-cs
msc.type: authoredcontent
ms.openlocfilehash: 66a09c637d33c812b39e0ce85a552bd71665a2e1
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/28/2019
ms.locfileid: "74634655"
---
# <a name="sorting-data-in-a-datalist-or-repeater-control-c"></a><span data-ttu-id="ab640-103">DataList 或重複項控制項中的排序資料 (C#)</span><span class="sxs-lookup"><span data-stu-id="ab640-103">Sorting Data in a DataList or Repeater Control (C#)</span></span>

<span data-ttu-id="ab640-104">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="ab640-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="ab640-105">[下載範例應用程式](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_45_CS.exe)或[下載 PDF](sorting-data-in-a-datalist-or-repeater-control-cs/_static/datatutorial45cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="ab640-105">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_45_CS.exe) or [Download PDF](sorting-data-in-a-datalist-or-repeater-control-cs/_static/datatutorial45cs1.pdf)</span></span>

> <span data-ttu-id="ab640-106">在本教學課程中，我們將探討如何在 DataList 和中繼器中包含排序支援，以及如何建立可分頁和排序其資料的 DataList 或中繼器。</span><span class="sxs-lookup"><span data-stu-id="ab640-106">In this tutorial we'll examine how to include sorting support in the DataList and Repeater, as well as how to construct a DataList or Repeater whose data can be paged and sorted.</span></span>

## <a name="introduction"></a><span data-ttu-id="ab640-107">簡介</span><span class="sxs-lookup"><span data-stu-id="ab640-107">Introduction</span></span>

<span data-ttu-id="ab640-108">在[上一個教學](paging-report-data-in-a-datalist-or-repeater-control-cs.md)課程中，我們探討了如何將分頁支援新增至 DataList。</span><span class="sxs-lookup"><span data-stu-id="ab640-108">In the [previous tutorial](paging-report-data-in-a-datalist-or-repeater-control-cs.md) we examined how to add paging support to a DataList.</span></span> <span data-ttu-id="ab640-109">我們已在傳回 `PagedDataSource` 物件的 `ProductsBLL` 類別（`GetProductsAsPagedDataSource`）中建立新的方法。</span><span class="sxs-lookup"><span data-stu-id="ab640-109">We created a new method in the `ProductsBLL` class (`GetProductsAsPagedDataSource`) that returned a `PagedDataSource` object.</span></span> <span data-ttu-id="ab640-110">當系結至 DataList 或中繼器時，DataList 或中繼器只會顯示所要求的資料頁面。</span><span class="sxs-lookup"><span data-stu-id="ab640-110">When bound to a DataList or Repeater, the DataList or Repeater would display just the requested page of data.</span></span> <span data-ttu-id="ab640-111">這項技術與 GridView、DetailsView 和 FormView 控制項內部使用的類似，以提供其內建的預設分頁功能。</span><span class="sxs-lookup"><span data-stu-id="ab640-111">This technique is similar to what is used internally by the GridView, DetailsView, and FormView controls to provide their built-in default paging functionality.</span></span>

<span data-ttu-id="ab640-112">除了提供分頁支援外，GridView 也包含現成的排序支援。</span><span class="sxs-lookup"><span data-stu-id="ab640-112">In addition to offering paging support, the GridView also includes out of the box sorting support.</span></span> <span data-ttu-id="ab640-113">DataList 和中繼器都不會提供內建的排序功能;不過，您可以使用一些程式碼來加入排序功能。</span><span class="sxs-lookup"><span data-stu-id="ab640-113">Neither the DataList nor Repeater provides built-in sorting functionality; however, sorting features can be added with a bit of code.</span></span> <span data-ttu-id="ab640-114">在本教學課程中，我們將探討如何在 DataList 和中繼器中包含排序支援，以及如何建立可分頁和排序其資料的 DataList 或中繼器。</span><span class="sxs-lookup"><span data-stu-id="ab640-114">In this tutorial we'll examine how to include sorting support in the DataList and Repeater, as well as how to construct a DataList or Repeater whose data can be paged and sorted.</span></span>

## <a name="a-review-of-sorting"></a><span data-ttu-id="ab640-115">排序的審查</span><span class="sxs-lookup"><span data-stu-id="ab640-115">A Review of Sorting</span></span>

<span data-ttu-id="ab640-116">如我們在[分頁和排序報表資料](../paging-and-sorting/paging-and-sorting-report-data-cs.md)教學課程中所見，GridView 控制項提供現成的排序支援。</span><span class="sxs-lookup"><span data-stu-id="ab640-116">As we saw in the [Paging and Sorting Report Data](../paging-and-sorting/paging-and-sorting-report-data-cs.md) tutorial, the GridView control provides out of the box sorting support.</span></span> <span data-ttu-id="ab640-117">每個 GridView 欄位都可以有相關聯的 `SortExpression`，表示用來排序資料的資料欄位。</span><span class="sxs-lookup"><span data-stu-id="ab640-117">Each GridView field can have an associated `SortExpression`, which indicates the data field by which to sort the data.</span></span> <span data-ttu-id="ab640-118">當 GridView 的 `AllowSorting` 屬性設定為 `true`時，具有 `SortExpression` 屬性值的每個 GridView 欄位都會將其標頭轉譯為 LinkButton。</span><span class="sxs-lookup"><span data-stu-id="ab640-118">When the GridView s `AllowSorting` property is set to `true`, each GridView field that has a `SortExpression` property value has its header rendered as a LinkButton.</span></span> <span data-ttu-id="ab640-119">當使用者按一下特定的 GridView 欄位標頭時，就會發生回傳，並根據按下的欄位 `SortExpression`來排序資料。</span><span class="sxs-lookup"><span data-stu-id="ab640-119">When a user clicks a particular GridView field s header, a postback occurs and the data is sorted according to the clicked field s `SortExpression`.</span></span>

<span data-ttu-id="ab640-120">GridView 控制項也有 `SortExpression` 屬性，它會儲存 GridView 欄位的 `SortExpression` 以排序資料。</span><span class="sxs-lookup"><span data-stu-id="ab640-120">The GridView control has a `SortExpression` property as well, which stores the `SortExpression` of the GridView field the data is sorted by.</span></span> <span data-ttu-id="ab640-121">此外，`SortDirection` 屬性會指出是否要以遞增或遞減順序來排序資料（如果使用者連續按一下特定的 GridView 欄位標題連結兩次，則會切換排序次序）。</span><span class="sxs-lookup"><span data-stu-id="ab640-121">Additionally, a `SortDirection` property indicates whether the data is to be sorted in ascending or descending order (if a user clicks a particular GridView field s header link twice in succession, the sort order is toggled).</span></span>

<span data-ttu-id="ab640-122">當 GridView 系結至其資料來源控制項時，它會將其 `SortExpression` 和 `SortDirection` 屬性交給資料來源控制項。</span><span class="sxs-lookup"><span data-stu-id="ab640-122">When the GridView is bound to its data source control, it hands off its `SortExpression` and `SortDirection` properties to the data source control.</span></span> <span data-ttu-id="ab640-123">資料來源控制項會抓取資料，然後根據提供的 `SortExpression` 和 `SortDirection` 屬性加以排序。</span><span class="sxs-lookup"><span data-stu-id="ab640-123">The data source control retrieves the data and then sorts it according to the supplied `SortExpression` and `SortDirection` properties.</span></span> <span data-ttu-id="ab640-124">排序資料之後，資料來源控制項會將它傳回給 GridView。</span><span class="sxs-lookup"><span data-stu-id="ab640-124">After sorting the data, the data source control returns it to the GridView.</span></span>

<span data-ttu-id="ab640-125">若要使用 DataList 或重複項控制項來複寫這項功能，我們必須：</span><span class="sxs-lookup"><span data-stu-id="ab640-125">To replicate this functionality with the DataList or Repeater controls, we must:</span></span>

- <span data-ttu-id="ab640-126">建立排序介面</span><span class="sxs-lookup"><span data-stu-id="ab640-126">Create a sorting interface</span></span>
- <span data-ttu-id="ab640-127">請記住要排序的資料欄位，以及是否要以遞增或遞減順序排序</span><span class="sxs-lookup"><span data-stu-id="ab640-127">Remember the data field to sort by and whether to sort in ascending or descending order</span></span>
- <span data-ttu-id="ab640-128">指示 ObjectDataSource 依特定資料欄位排序資料</span><span class="sxs-lookup"><span data-stu-id="ab640-128">Instruct the ObjectDataSource to sort the data by a particular data field</span></span>

<span data-ttu-id="ab640-129">我們將在步驟3和4中解決這三項工作。</span><span class="sxs-lookup"><span data-stu-id="ab640-129">We'll tackle these three tasks in steps 3 and 4.</span></span> <span data-ttu-id="ab640-130">接下來，我們將探討如何在 DataList 或中繼器中包含分頁和排序支援。</span><span class="sxs-lookup"><span data-stu-id="ab640-130">Following that, we'll examine how to include both paging and sorting support in a DataList or Repeater.</span></span>

## <a name="step-2-displaying-the-products-in-a-repeater"></a><span data-ttu-id="ab640-131">步驟2：在中繼器中顯示產品</span><span class="sxs-lookup"><span data-stu-id="ab640-131">Step 2: Displaying the Products in a Repeater</span></span>

<span data-ttu-id="ab640-132">在我們擔心如何執行任何排序相關的功能之前，請先讓我們先在中繼器控制項中列出產品。</span><span class="sxs-lookup"><span data-stu-id="ab640-132">Before we worry about implementing any of the sorting-related functionality, let s start by listing the products in a Repeater control.</span></span> <span data-ttu-id="ab640-133">從開啟 [`PagingSortingDataListRepeater`] 資料夾中的 [`Sorting.aspx`] 頁面開始。</span><span class="sxs-lookup"><span data-stu-id="ab640-133">Start by opening the `Sorting.aspx` page in the `PagingSortingDataListRepeater` folder.</span></span> <span data-ttu-id="ab640-134">將 [中繼器] 控制項新增至網頁，並將其 `ID` 屬性設定為 [`SortableProducts`]。</span><span class="sxs-lookup"><span data-stu-id="ab640-134">Add a Repeater control to the web page, setting its `ID` property to `SortableProducts`.</span></span> <span data-ttu-id="ab640-135">從 [中繼器] 智慧標籤中，建立名為 `ProductsDataSource` 的新 ObjectDataSource，並將其設定為從 `ProductsBLL` 類別 s `GetProducts()` 方法中取出資料。</span><span class="sxs-lookup"><span data-stu-id="ab640-135">From the Repeater s smart tag, create a new ObjectDataSource named `ProductsDataSource` and configure it to retrieve data from the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="ab640-136">從 [插入]、[更新] 和 [刪除] 索引標籤的下拉式清單中，選取 [（無）] 選項。</span><span class="sxs-lookup"><span data-stu-id="ab640-136">Select the (None) option from the drop-down lists in the INSERT, UPDATE, and DELETE tabs.</span></span>

<span data-ttu-id="ab640-137">[![建立 ObjectDataSource 並將其設定為使用 GetProductsAsPagedDataSource （）方法](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image2.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="ab640-137">[![Create an ObjectDataSource and Configure it to Use the GetProductsAsPagedDataSource() Method](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image2.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image1.png)</span></span>

<span data-ttu-id="ab640-138">**圖 1**：建立 ObjectDataSource 並將其設定為使用 `GetProductsAsPagedDataSource()` 方法（[按一下以查看完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image3.png)）</span><span class="sxs-lookup"><span data-stu-id="ab640-138">**Figure 1**: Create an ObjectDataSource and Configure it to Use the `GetProductsAsPagedDataSource()` Method ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image3.png))</span></span>

<span data-ttu-id="ab640-139">[![將 [更新]、[插入] 和 [刪除] 索引標籤中的下拉式清單設定為 [（無）]](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image5.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="ab640-139">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image5.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image4.png)</span></span>

<span data-ttu-id="ab640-140">**圖 2**：將 [更新]、[插入] 和 [刪除] 索引標籤中的下拉式清單設定為 [（無）] （[按一下以查看完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image6.png)）</span><span class="sxs-lookup"><span data-stu-id="ab640-140">**Figure 2**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None) ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image6.png))</span></span>

<span data-ttu-id="ab640-141">不同于 DataList，Visual Studio 不會在系結至資料來源之後，自動建立中繼器控制項的 `ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="ab640-141">Unlike with the DataList, Visual Studio does not automatically create an `ItemTemplate` for the Repeater control after binding it to a data source.</span></span> <span data-ttu-id="ab640-142">此外，我們必須以宣告方式新增此 `ItemTemplate`，因為「中繼器控制項」智慧標籤缺少 DataList s 中的 [編輯範本] 選項。</span><span class="sxs-lookup"><span data-stu-id="ab640-142">Furthermore, we must add this `ItemTemplate` declaratively, as the Repeater control s smart tag lacks the Edit Templates option found in the DataList s.</span></span> <span data-ttu-id="ab640-143">讓我們使用上一個教學課程中的相同 `ItemTemplate`，這會顯示產品的名稱、供應商和類別目錄。</span><span class="sxs-lookup"><span data-stu-id="ab640-143">Let s use the same `ItemTemplate` from the previous tutorial, which displayed the product s name, supplier, and category.</span></span>

<span data-ttu-id="ab640-144">新增 `ItemTemplate`之後，中繼器和 ObjectDataSource 的宣告式標記看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="ab640-144">After adding the `ItemTemplate`, the Repeater and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample1.aspx)]

<span data-ttu-id="ab640-145">[圖 3] 顯示透過瀏覽器觀看的此頁面。</span><span class="sxs-lookup"><span data-stu-id="ab640-145">Figure 3 shows this page when viewed through a browser.</span></span>

<span data-ttu-id="ab640-146">[會顯示每個產品的名稱、供應商和類別 ![](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image8.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="ab640-146">[![Each Product s Name, Supplier, and Category is Displayed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image8.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image7.png)</span></span>

<span data-ttu-id="ab640-147">**圖 3**：會顯示每個產品的名稱、供應商和類別（[按一下以觀看完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image9.png)）</span><span class="sxs-lookup"><span data-stu-id="ab640-147">**Figure 3**: Each Product s Name, Supplier, and Category is Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image9.png))</span></span>

## <a name="step-3-instructing-the-objectdatasource-to-sort-the-data"></a><span data-ttu-id="ab640-148">步驟3：指示 ObjectDataSource 排序資料</span><span class="sxs-lookup"><span data-stu-id="ab640-148">Step 3: Instructing the ObjectDataSource to Sort the Data</span></span>

<span data-ttu-id="ab640-149">若要排序在中繼器中顯示的資料，我們必須通知資料應該排序之排序運算式的 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="ab640-149">To sort the data displayed in the Repeater, we need to inform the ObjectDataSource of the sort expression by which the data should be sorted.</span></span> <span data-ttu-id="ab640-150">在 ObjectDataSource 抓取其資料之前，它會先引發它的[`Selecting` 事件](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting.aspx)，讓我們有機會指定排序運算式。</span><span class="sxs-lookup"><span data-stu-id="ab640-150">Before the ObjectDataSource retrieves its data, it first fires its [`Selecting` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting.aspx), which provides an opportunity for us to specify a sort expression.</span></span> <span data-ttu-id="ab640-151">`Selecting` 事件處理常式會傳遞[`ObjectDataSourceSelectingEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.aspx)類型的物件，其具有名為[`Arguments`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.arguments.aspx)類型[`DataSourceSelectArguments`](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx)的屬性。</span><span class="sxs-lookup"><span data-stu-id="ab640-151">The `Selecting` event handler is passed an object of type [`ObjectDataSourceSelectingEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.aspx), which has a property named [`Arguments`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.arguments.aspx) of type [`DataSourceSelectArguments`](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx).</span></span> <span data-ttu-id="ab640-152">`DataSourceSelectArguments` 類別的設計目的是要將資料相關的要求從資料取用者傳遞到資料來源控制項，並包含[`SortExpression` 屬性](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.sortexpression.aspx)。</span><span class="sxs-lookup"><span data-stu-id="ab640-152">The `DataSourceSelectArguments` class is designed to pass data-related requests from a consumer of data to the data source control, and includes a [`SortExpression` property](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.sortexpression.aspx).</span></span>

<span data-ttu-id="ab640-153">若要將排序資訊從 ASP.NET 網頁傳遞至 ObjectDataSource，請建立 `Selecting` 事件的事件處理常式，並使用下列程式碼：</span><span class="sxs-lookup"><span data-stu-id="ab640-153">To pass sorting information from the ASP.NET page to the ObjectDataSource, create an event handler for the `Selecting` event and use the following code:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample2.cs)]

<span data-ttu-id="ab640-154">應將資料欄位的名稱指派給*sortExpression*值，以排序資料（例如 ProductName）。</span><span class="sxs-lookup"><span data-stu-id="ab640-154">The *sortExpression* value should be assigned the name of the data field to sort the data by (such as ProductName ).</span></span> <span data-ttu-id="ab640-155">沒有排序方向相關的屬性，因此如果您想要以遞減順序排序資料，請將字串 DESC 附加至*sortExpression*值（例如 ProductName DESC）。</span><span class="sxs-lookup"><span data-stu-id="ab640-155">There is no sort direction-related property, so if you want to sort the data in descending order, append the string DESC to the *sortExpression* value (such as ProductName DESC ).</span></span>

<span data-ttu-id="ab640-156">請繼續嘗試一些不同的硬式編碼值，以在瀏覽器中*sortExpression*和測試結果。</span><span class="sxs-lookup"><span data-stu-id="ab640-156">Go ahead and try some different hard-coded values for *sortExpression* and test the results in a browser.</span></span> <span data-ttu-id="ab640-157">如 [圖 4] 所示，使用 ProductName DESC 做為*sortExpression*時，產品會依其名稱以反向字母順序排序。</span><span class="sxs-lookup"><span data-stu-id="ab640-157">As Figure 4 shows, when using ProductName DESC as the *sortExpression*, the products are sorted by their name in reverse alphabetical order.</span></span>

<span data-ttu-id="ab640-158">[![產品依其名稱以反向字母順序排序](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image11.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="ab640-158">[![The Products are Sorted by their Name in Reverse Alphabetical Order](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image11.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image10.png)</span></span>

<span data-ttu-id="ab640-159">**圖 4**：產品依其名稱以相反的字母順序排序（[按一下以觀看完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image12.png)）</span><span class="sxs-lookup"><span data-stu-id="ab640-159">**Figure 4**: The Products are Sorted by their Name in Reverse Alphabetical Order ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image12.png))</span></span>

## <a name="step-4-creating-the-sorting-interface-and-remembering-the-sort-expression-and-direction"></a><span data-ttu-id="ab640-160">步驟4：建立排序介面，並記住排序運算式和方向</span><span class="sxs-lookup"><span data-stu-id="ab640-160">Step 4: Creating the Sorting Interface and Remembering the Sort Expression and Direction</span></span>

<span data-ttu-id="ab640-161">開啟 GridView 中的排序支援時，會將每個可排序的欄位 s 標頭文字轉換成 LinkButton，當按下該按鈕時，會據以排序資料。</span><span class="sxs-lookup"><span data-stu-id="ab640-161">Turning on sorting support in the GridView converts each sortable field s header text into a LinkButton that, when clicked, sorts the data accordingly.</span></span> <span data-ttu-id="ab640-162">這類排序介面對 GridView 很有意義，因為它的資料會在資料行中整齊地配置。</span><span class="sxs-lookup"><span data-stu-id="ab640-162">Such a sorting interface makes sense for the GridView, where its data is neatly laid out in columns.</span></span> <span data-ttu-id="ab640-163">不過，對於 DataList 和中繼器控制項，則需要不同的排序介面。</span><span class="sxs-lookup"><span data-stu-id="ab640-163">For the DataList and Repeater controls, however, a different sorting interface is needed.</span></span> <span data-ttu-id="ab640-164">資料清單的一般排序介面（相對於資料格線）是下拉式清單，提供可供排序資料的欄位使用。</span><span class="sxs-lookup"><span data-stu-id="ab640-164">A common sorting interface for a list of data (as opposed to a grid of data), is a drop-down list that provides the fields by which the data can be sorted.</span></span> <span data-ttu-id="ab640-165">在本教學課程中，我們將會執行此類介面。</span><span class="sxs-lookup"><span data-stu-id="ab640-165">Let s implement such an interface for this tutorial.</span></span>

<span data-ttu-id="ab640-166">將 DropDownList Web 控制項新增至 `SortableProducts` 中繼器上方，並將其 `ID` 屬性設定為 [`SortBy`]。</span><span class="sxs-lookup"><span data-stu-id="ab640-166">Add a DropDownList Web control above the `SortableProducts` Repeater and set its `ID` property to `SortBy`.</span></span> <span data-ttu-id="ab640-167">從屬性視窗按一下 [`Items`] 屬性中的省略號，以顯示 [出現內容集合編輯器]。</span><span class="sxs-lookup"><span data-stu-id="ab640-167">From the Properties window, click the ellipses in the `Items` property to bring up the ListItem Collection Editor.</span></span> <span data-ttu-id="ab640-168">加入 `ListItem`，以依據 `ProductName`、`CategoryName`和 `SupplierName` 欄位排序資料。</span><span class="sxs-lookup"><span data-stu-id="ab640-168">Add `ListItem` s to sort the data by the `ProductName`, `CategoryName`, and `SupplierName` fields.</span></span> <span data-ttu-id="ab640-169">此外，也請新增 `ListItem`，依其名稱以反向字母順序排序產品。</span><span class="sxs-lookup"><span data-stu-id="ab640-169">Also add a `ListItem` to sort the products by their name in reverse alphabetical order.</span></span>

<span data-ttu-id="ab640-170">`ListItem` `Text` 屬性可以設定為任何值（例如 [名稱]），但 `Value` 屬性必須設定為資料欄位的名稱（例如 ProductName）。</span><span class="sxs-lookup"><span data-stu-id="ab640-170">The `ListItem` `Text` properties can be set to any value (such as Name ), but the `Value` properties must be set to the name of the data field (such as ProductName ).</span></span> <span data-ttu-id="ab640-171">若要以遞減順序排序結果，請將字串 DESC 附加至資料欄位名稱，例如 ProductName DESC。</span><span class="sxs-lookup"><span data-stu-id="ab640-171">To sort the results in descending order, append the string DESC to the data field name, like ProductName DESC .</span></span>

![為每個可排序的資料欄位新增資料列](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image13.png)

<span data-ttu-id="ab640-173">**圖 5**：為每個可排序的資料欄位加入 `ListItem`</span><span class="sxs-lookup"><span data-stu-id="ab640-173">**Figure 5**: Add a `ListItem` for Each of the Sortable Data Fields</span></span>

<span data-ttu-id="ab640-174">最後，在 DropDownList 的右側新增按鈕 Web 控制項。</span><span class="sxs-lookup"><span data-stu-id="ab640-174">Finally, add a Button Web control to the right of the DropDownList.</span></span> <span data-ttu-id="ab640-175">將其 `ID` 設為 `RefreshRepeater`，並將其 `Text` 屬性設定為 [重新整理]。</span><span class="sxs-lookup"><span data-stu-id="ab640-175">Set its `ID` to `RefreshRepeater` and its `Text` property to Refresh .</span></span>

<span data-ttu-id="ab640-176">建立 `ListItem` 並新增 [重新整理] 按鈕後，DropDownList 和按鈕的宣告式語法看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="ab640-176">After creating the `ListItem` s and adding the Refresh button, the DropDownList and Button s declarative syntax should look similar to the following:</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample3.aspx)]

<span data-ttu-id="ab640-177">當排序 DropDownList 完成時，我們接下來需要更新 ObjectDataSource s `Selecting` 事件處理常式，使其使用所選取的 `SortBy``ListItem` s `Value` 屬性，而不是硬式編碼的排序運算式。</span><span class="sxs-lookup"><span data-stu-id="ab640-177">With the sorting DropDownList complete, we next need to update the ObjectDataSource s `Selecting` event handler so that it uses the selected `SortBy``ListItem` s `Value` property as opposed to a hard-coded sort expression.</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample4.cs)]

<span data-ttu-id="ab640-178">此時，第一次流覽頁面時，產品一開始會依照 [`ProductName` 資料] 欄位進行排序，因為 `SortBy` 預設 `ListItem` 選取（請參閱 [圖 6]）。</span><span class="sxs-lookup"><span data-stu-id="ab640-178">At this point when first visiting the page the products will initially be sorted by the `ProductName` data field, as it s the `SortBy` `ListItem` selected by default (see Figure 6).</span></span> <span data-ttu-id="ab640-179">選取不同的排序選項（例如分類和按一下 [重新整理]）將會導致回傳，並依類別目錄名稱重新排序資料，如 [圖 7] 所示。</span><span class="sxs-lookup"><span data-stu-id="ab640-179">Selecting a different sorting option such as Category and clicking Refresh will cause a postback and re-sort the data by the category name, as Figure 7 shows.</span></span>

<span data-ttu-id="ab640-180">[![產品一開始依其名稱排序](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image15.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="ab640-180">[![The Products are Initially Sorted by their Name](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image15.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image14.png)</span></span>

<span data-ttu-id="ab640-181">**圖 6**：產品一開始依其名稱排序（[按一下以觀看完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image16.png)）</span><span class="sxs-lookup"><span data-stu-id="ab640-181">**Figure 6**: The Products are Initially Sorted by their Name ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image16.png))</span></span>

<span data-ttu-id="ab640-182">[![產品現在依類別目錄排序](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image18.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="ab640-182">[![The Products are Now Sorted by Category](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image18.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image17.png)</span></span>

<span data-ttu-id="ab640-183">**圖 7**：產品現在依類別排序（[按一下以觀看完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image19.png)）</span><span class="sxs-lookup"><span data-stu-id="ab640-183">**Figure 7**: The Products are Now Sorted by Category ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image19.png))</span></span>

> [!NOTE]
> <span data-ttu-id="ab640-184">按一下 [重新整理] 按鈕會導致資料自動重新排序，因為已停用中繼器的 view 狀態，因此會導致中繼器在每次回傳時重新系結至其資料來源。</span><span class="sxs-lookup"><span data-stu-id="ab640-184">Clicking the Refresh button causes the data to automatically be re-sorted because the Repeater s view state has been disabled, thereby causing the Repeater to rebind to its data source on every postback.</span></span> <span data-ttu-id="ab640-185">如果您已啟用 [中繼器 s view] 狀態，變更 [排序] 下拉式清單將不會影響排序次序。</span><span class="sxs-lookup"><span data-stu-id="ab640-185">If you ve left the Repeater s view state enabled, changing the sorting drop-down list won't have any affect on the sort order.</span></span> <span data-ttu-id="ab640-186">若要解決此問題，請為 [重新整理] 按鈕 `Click` 事件建立事件處理常式，並將中繼器重新系結至其資料來源（藉由呼叫 Repeater 的 `DataBind()` 方法）。</span><span class="sxs-lookup"><span data-stu-id="ab640-186">To remedy this, create an event handler for the Refresh Button s `Click` event and rebind the Repeater to its data source (by calling the Repeater s `DataBind()` method).</span></span>

## <a name="remembering-the-sort-expression-and-direction"></a><span data-ttu-id="ab640-187">記住排序運算式和方向</span><span class="sxs-lookup"><span data-stu-id="ab640-187">Remembering the Sort Expression and Direction</span></span>

<span data-ttu-id="ab640-188">在可能發生非排序相關回傳的頁面上建立可排序的 DataList 或中繼器時，必須在回傳之間記住排序運算式和方向。</span><span class="sxs-lookup"><span data-stu-id="ab640-188">When creating a sortable DataList or Repeater on a page where non-sort related postbacks may occur, it s imperative that the sort expression and direction be remembered across postbacks.</span></span> <span data-ttu-id="ab640-189">例如，假設我們已更新本教學課程中的中繼器，以包含每個產品的 [刪除] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="ab640-189">For example, imagine that we updated the Repeater in this tutorial to include a Delete button with each product.</span></span> <span data-ttu-id="ab640-190">當使用者按一下 [刪除] 按鈕時，我們會執行一些程式碼來刪除選取的產品，然後將資料重新系結至重複項。</span><span class="sxs-lookup"><span data-stu-id="ab640-190">When the user clicks the Delete button we d run some code to delete the selected product and then rebind the data to the Repeater.</span></span> <span data-ttu-id="ab640-191">如果未在回傳期間保存排序詳細資料，螢幕上顯示的資料就會還原成原始排序次序。</span><span class="sxs-lookup"><span data-stu-id="ab640-191">If the sort details are not persisted across postback, the data displayed on screen will revert to the original sort order.</span></span>

<span data-ttu-id="ab640-192">在本教學課程中，DropDownList 會隱含地將排序運算式和方向儲存在其檢視狀態中。</span><span class="sxs-lookup"><span data-stu-id="ab640-192">For this tutorial, the DropDownList implicitly saves the sort expression and direction in its view state for us.</span></span> <span data-ttu-id="ab640-193">如果我們使用不同的排序介面，例如，LinkButtons 提供了各種排序選項，我們就必須小心記住在回傳之間的排序次序。</span><span class="sxs-lookup"><span data-stu-id="ab640-193">If we were using a different sorting interface one with, say, LinkButtons that provided the various sorting options we d need to take care to remember the sort order across postbacks.</span></span> <span data-ttu-id="ab640-194">做法是將排序參數儲存在頁面的 view 狀態中，方法是在 querystring 中包含 sort 參數，或透過一些其他狀態持續性技術來完成這項作業。</span><span class="sxs-lookup"><span data-stu-id="ab640-194">This could be accomplished by storing the sorting parameters in the page s view state, by including the sort parameter in the querystring, or through some other state persistence technique.</span></span>

<span data-ttu-id="ab640-195">本教學課程中的未來範例會探索如何在頁面 s 檢視狀態中保存排序詳細資料。</span><span class="sxs-lookup"><span data-stu-id="ab640-195">Future examples in this tutorial explore how to persist the sorting details in the page s view state.</span></span>

## <a name="step-5-adding-sorting-support-to-a-datalist-that-uses-default-paging"></a><span data-ttu-id="ab640-196">步驟5：將排序支援新增至使用預設分頁的 DataList</span><span class="sxs-lookup"><span data-stu-id="ab640-196">Step 5: Adding Sorting Support to a DataList that Uses Default Paging</span></span>

<span data-ttu-id="ab640-197">在[先前的教學](paging-report-data-in-a-datalist-or-repeater-control-cs.md)課程中，我們探討了如何使用 DataList 來執行預設分頁。</span><span class="sxs-lookup"><span data-stu-id="ab640-197">In the [preceding tutorial](paging-report-data-in-a-datalist-or-repeater-control-cs.md) we examined how to implement default paging with a DataList.</span></span> <span data-ttu-id="ab640-198">讓 s 擴充這個先前的範例，以包含排序分頁資料的能力。</span><span class="sxs-lookup"><span data-stu-id="ab640-198">Let s extend this previous example to include the ability to sort the paged data.</span></span> <span data-ttu-id="ab640-199">一開始先開啟 [`SortingWithDefaultPaging.aspx`]，然後 `Paging.aspx` [`PagingSortingDataListRepeater`] 資料夾中的頁面。</span><span class="sxs-lookup"><span data-stu-id="ab640-199">Start by opening the `SortingWithDefaultPaging.aspx` and `Paging.aspx` pages in the `PagingSortingDataListRepeater` folder.</span></span> <span data-ttu-id="ab640-200">從 [`Paging.aspx`] 頁面上，按一下 [來源] 按鈕，以查看頁面的宣告式標記。</span><span class="sxs-lookup"><span data-stu-id="ab640-200">From the `Paging.aspx` page, click on the Source button to view the page s declarative markup.</span></span> <span data-ttu-id="ab640-201">複製選取的文字（請參閱 [圖 8]），並將它貼到 `<asp:Content>` 標記之間的 `SortingWithDefaultPaging.aspx` 宣告式標記中。</span><span class="sxs-lookup"><span data-stu-id="ab640-201">Copy the selected text (see Figure 8) and paste it into the declarative markup of `SortingWithDefaultPaging.aspx` between the `<asp:Content>` tags.</span></span>

<span data-ttu-id="ab640-202">[![將 &lt;asp： Content&gt; 標記中的宣告式標記，從 default.aspx 分頁複製到 SortingWithDefaultPaging .aspx](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image21.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="ab640-202">[![Replicate the Declarative Markup in the &lt;asp:Content&gt; Tags from Paging.aspx to SortingWithDefaultPaging.aspx](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image21.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image20.png)</span></span>

<span data-ttu-id="ab640-203">**圖 8**：將 `<asp:Content>` 標記中的宣告式標記從 `Paging.aspx` 複寫至 `SortingWithDefaultPaging.aspx` （[按一下以查看完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image22.png)）</span><span class="sxs-lookup"><span data-stu-id="ab640-203">**Figure 8**: Replicate the Declarative Markup in the `<asp:Content>` Tags from `Paging.aspx` to `SortingWithDefaultPaging.aspx` ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image22.png))</span></span>

<span data-ttu-id="ab640-204">複製宣告式標記之後，將 `Paging.aspx` 頁 s 程式碼後置類別中的方法和屬性，複製到 `SortingWithDefaultPaging.aspx`的程式碼後置類別。</span><span class="sxs-lookup"><span data-stu-id="ab640-204">After copying the declarative markup, copy the methods and properties in the `Paging.aspx` page s code-behind class to the code-behind class for `SortingWithDefaultPaging.aspx`.</span></span> <span data-ttu-id="ab640-205">接下來，請花一點時間查看瀏覽器中的 [`SortingWithDefaultPaging.aspx`] 頁面。</span><span class="sxs-lookup"><span data-stu-id="ab640-205">Next, take a moment to view the `SortingWithDefaultPaging.aspx` page in a browser.</span></span> <span data-ttu-id="ab640-206">它應該會呈現與 `Paging.aspx`相同的功能和外觀。</span><span class="sxs-lookup"><span data-stu-id="ab640-206">It should exhibit the same functionality and appearance as `Paging.aspx`.</span></span>

## <a name="enhancing-productsbll-to-include-a-default-paging-and-sorting-method"></a><span data-ttu-id="ab640-207">增強 ProductsBLL 以包含預設分頁和排序方法</span><span class="sxs-lookup"><span data-stu-id="ab640-207">Enhancing ProductsBLL to Include a Default Paging and Sorting Method</span></span>

<span data-ttu-id="ab640-208">在上一個教學課程中，我們在傳回 `PagedDataSource` 物件的 `ProductsBLL` 類別中建立了 `GetProductsAsPagedDataSource(pageIndex, pageSize)` 方法。</span><span class="sxs-lookup"><span data-stu-id="ab640-208">In the previous tutorial we created a `GetProductsAsPagedDataSource(pageIndex, pageSize)` method in the `ProductsBLL` class that returned a `PagedDataSource` object.</span></span> <span data-ttu-id="ab640-209">這個 `PagedDataSource` 物件已填入*所有*產品（透過 BLL 的 `GetProducts()` 方法），但系結至 DataList 時，只會顯示對應于指定*pageIndex*和*pageSize*輸入參數的記錄。</span><span class="sxs-lookup"><span data-stu-id="ab640-209">This `PagedDataSource` object was populated with *all* of the products (via the BLL s `GetProducts()` method), but when bound to the DataList only those records corresponding to the specified *pageIndex* and *pageSize* input parameters were displayed.</span></span>

<span data-ttu-id="ab640-210">稍早在本教學課程中，我們新增了排序支援，方法是指定 ObjectDataSource s `Selecting` 事件處理常式的排序運算式。</span><span class="sxs-lookup"><span data-stu-id="ab640-210">Earlier in this tutorial we added sorting support by specifying the sort expression from the ObjectDataSource s `Selecting` event handler.</span></span> <span data-ttu-id="ab640-211">當 ObjectDataSource 傳回可排序的物件（例如 `GetProducts()` 方法所傳回的 `ProductsDataTable`）時，這項功能就很好用。</span><span class="sxs-lookup"><span data-stu-id="ab640-211">This works well when the ObjectDataSource is returned an object that can be sorted, like the `ProductsDataTable` returned by the `GetProducts()` method.</span></span> <span data-ttu-id="ab640-212">不過，`GetProductsAsPagedDataSource` 方法所傳回的 `PagedDataSource` 物件不支援排序其內部資料來源。</span><span class="sxs-lookup"><span data-stu-id="ab640-212">However, the `PagedDataSource` object returned by the `GetProductsAsPagedDataSource` method does not support sorting of its inner data source.</span></span> <span data-ttu-id="ab640-213">相反地，我們需要先排序從 `GetProducts()` 方法傳回的結果，*然後才*將它放入 `PagedDataSource`中。</span><span class="sxs-lookup"><span data-stu-id="ab640-213">Instead, we need to sort the results returned from the `GetProducts()` method *before* we put it in the `PagedDataSource`.</span></span>

<span data-ttu-id="ab640-214">若要完成這項操作，請在 `ProductsBLL` 類別中建立新方法，`GetProductsSortedAsPagedDataSource(sortExpression, pageIndex, pageSize)`。</span><span class="sxs-lookup"><span data-stu-id="ab640-214">To accomplish this, create a new method in the `ProductsBLL` class, `GetProductsSortedAsPagedDataSource(sortExpression, pageIndex, pageSize)`.</span></span> <span data-ttu-id="ab640-215">若要排序 `GetProducts()` 方法所傳回的 `ProductsDataTable`，請指定其預設 `DataTableView`的 `Sort` 屬性：</span><span class="sxs-lookup"><span data-stu-id="ab640-215">To sort the `ProductsDataTable` returned by the `GetProducts()` method, specify the `Sort` property of its default `DataTableView`:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample5.cs)]

<span data-ttu-id="ab640-216">`GetProductsSortedAsPagedDataSource` 方法與在上一個教學課程中建立的 `GetProductsAsPagedDataSource` 方法稍有不同。</span><span class="sxs-lookup"><span data-stu-id="ab640-216">The `GetProductsSortedAsPagedDataSource` method differs only slightly from the `GetProductsAsPagedDataSource` method created in the previous tutorial.</span></span> <span data-ttu-id="ab640-217">特別是，`GetProductsSortedAsPagedDataSource` 會接受額外的輸入參數 `sortExpression`，並將此值指派給 `ProductDataTable` s `DefaultView`的 `Sort` 屬性。</span><span class="sxs-lookup"><span data-stu-id="ab640-217">In particular, `GetProductsSortedAsPagedDataSource` accepts an additional input parameter `sortExpression` and assigns this value to the `Sort` property of the `ProductDataTable` s `DefaultView`.</span></span> <span data-ttu-id="ab640-218">幾行程式碼之後，`PagedDataSource` 物件 s DataSource 會被指派 `ProductDataTable` s `DefaultView`。</span><span class="sxs-lookup"><span data-stu-id="ab640-218">A few lines of code later, the `PagedDataSource` object s DataSource is assigned the `ProductDataTable` s `DefaultView`.</span></span>

## <a name="calling-the-getproductssortedaspageddatasource-method-and-specifying-the-value-for-the-sortexpression-input-parameter"></a><span data-ttu-id="ab640-219">呼叫 GetProductsSortedAsPagedDataSource 方法，並指定 SortExpression 輸入參數的值</span><span class="sxs-lookup"><span data-stu-id="ab640-219">Calling the GetProductsSortedAsPagedDataSource Method and Specifying the Value for the SortExpression Input Parameter</span></span>

<span data-ttu-id="ab640-220">完成 `GetProductsSortedAsPagedDataSource` 方法之後，下一步就是提供此參數的值。</span><span class="sxs-lookup"><span data-stu-id="ab640-220">With the `GetProductsSortedAsPagedDataSource` method complete, the next step is to provide the value for this parameter.</span></span> <span data-ttu-id="ab640-221">`SortingWithDefaultPaging.aspx` 中的 ObjectDataSource 目前設定為呼叫 `GetProductsAsPagedDataSource` 方法，並透過它在 `SelectParameters` 集合中指定的兩個 `QueryStringParameters`傳遞兩個輸入參數。</span><span class="sxs-lookup"><span data-stu-id="ab640-221">The ObjectDataSource in `SortingWithDefaultPaging.aspx` is currently configured to call the `GetProductsAsPagedDataSource` method and passes in the two input parameters through its two `QueryStringParameters`, which are specified in the `SelectParameters` collection.</span></span> <span data-ttu-id="ab640-222">這兩個 `QueryStringParameters` 表示 `GetProductsAsPagedDataSource` 方法 s *pageIndex*和*pageSize*參數的來源來自 `pageIndex` 和 `pageSize`的 querystring 欄位。</span><span class="sxs-lookup"><span data-stu-id="ab640-222">These two `QueryStringParameters` indicate that the source for the `GetProductsAsPagedDataSource` method s *pageIndex* and *pageSize* parameters come from the querystring fields `pageIndex` and `pageSize`.</span></span>

<span data-ttu-id="ab640-223">更新 ObjectDataSource s `SelectMethod` 屬性，使其叫用新的 `GetProductsSortedAsPagedDataSource` 方法。</span><span class="sxs-lookup"><span data-stu-id="ab640-223">Update the ObjectDataSource s `SelectMethod` property so that it invokes the new `GetProductsSortedAsPagedDataSource` method.</span></span> <span data-ttu-id="ab640-224">然後，加入新的 `QueryStringParameter`，以便從 querystring 欄位 `sortExpression`存取*sortExpression*輸入參數。</span><span class="sxs-lookup"><span data-stu-id="ab640-224">Then, add a new `QueryStringParameter` so that the *sortExpression* input parameter is accessed from the querystring field `sortExpression`.</span></span> <span data-ttu-id="ab640-225">將 `QueryStringParameter` s `DefaultValue` 設定為 [ProductName]。</span><span class="sxs-lookup"><span data-stu-id="ab640-225">Set the `QueryStringParameter` s `DefaultValue` to ProductName .</span></span>

<span data-ttu-id="ab640-226">這些變更之後，ObjectDataSource 的宣告式標記看起來應該像這樣：</span><span class="sxs-lookup"><span data-stu-id="ab640-226">After these changes, the ObjectDataSource s declarative markup should look like:</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample6.aspx)]

<span data-ttu-id="ab640-227">此時，[`SortingWithDefaultPaging.aspx`] 頁面會依產品名稱的字母順序排序其結果（請參閱 [圖 9]）。</span><span class="sxs-lookup"><span data-stu-id="ab640-227">At this point, the `SortingWithDefaultPaging.aspx` page will sort its results alphabetically by the product name (see Figure 9).</span></span> <span data-ttu-id="ab640-228">這是因為根據預設，ProductName 的值會傳入做為 `GetProductsSortedAsPagedDataSource` 方法 s *sortExpression*參數。</span><span class="sxs-lookup"><span data-stu-id="ab640-228">This is because, by default, a value of ProductName is passed in as the `GetProductsSortedAsPagedDataSource` method s *sortExpression* parameter.</span></span>

<span data-ttu-id="ab640-229">[![根據預設，結果會依 ProductName 排序](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image24.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="ab640-229">[![By Default, the Results are Sorted by ProductName](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image24.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image23.png)</span></span>

<span data-ttu-id="ab640-230">**圖 9**：根據預設，結果會依 `ProductName` 排序（[按一下以查看完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image25.png)）</span><span class="sxs-lookup"><span data-stu-id="ab640-230">**Figure 9**: By Default, the Results are Sorted by `ProductName` ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image25.png))</span></span>

<span data-ttu-id="ab640-231">如果您手動加入 `sortExpression` querystring 欄位（例如 `SortingWithDefaultPaging.aspx?sortExpression=CategoryName`），結果就會依照指定的 `sortExpression`排序。</span><span class="sxs-lookup"><span data-stu-id="ab640-231">If you manually add a `sortExpression` querystring field such as `SortingWithDefaultPaging.aspx?sortExpression=CategoryName` the results will be sorted by the specified `sortExpression`.</span></span> <span data-ttu-id="ab640-232">不過，在移至不同的資料頁面時，querystring 不會包含這個 `sortExpression` 參數。</span><span class="sxs-lookup"><span data-stu-id="ab640-232">However, this `sortExpression` parameter is not included in the querystring when moving to a different page of data.</span></span> <span data-ttu-id="ab640-233">事實上，按一下 [下一步] 或 [最後一頁] 按鈕會讓我們回到 `Paging.aspx`！</span><span class="sxs-lookup"><span data-stu-id="ab640-233">In fact, clicking on the Next or Last page buttons takes us back to `Paging.aspx`!</span></span> <span data-ttu-id="ab640-234">此外，目前沒有排序介面。</span><span class="sxs-lookup"><span data-stu-id="ab640-234">Furthermore, there s currently no sorting interface.</span></span> <span data-ttu-id="ab640-235">使用者可以變更分頁資料之排序次序的唯一方式，就是直接操作 querystring。</span><span class="sxs-lookup"><span data-stu-id="ab640-235">The only way a user can change the sort order of the paged data is by manipulating the querystring directly.</span></span>

## <a name="creating-the-sorting-interface"></a><span data-ttu-id="ab640-236">建立排序介面</span><span class="sxs-lookup"><span data-stu-id="ab640-236">Creating the Sorting Interface</span></span>

<span data-ttu-id="ab640-237">我們必須先更新 `RedirectUser` 方法，以將使用者傳送至 `SortingWithDefaultPaging.aspx` （而不是 `Paging.aspx`），並將 `sortExpression` 值包含在查詢字串中。</span><span class="sxs-lookup"><span data-stu-id="ab640-237">We first need to update the `RedirectUser` method to send the user to `SortingWithDefaultPaging.aspx` (instead of `Paging.aspx`) and to include the `sortExpression` value in the querystring.</span></span> <span data-ttu-id="ab640-238">我們也應新增名為 `SortExpression` 屬性的唯讀頁面層級。</span><span class="sxs-lookup"><span data-stu-id="ab640-238">We should also add a read-only, page-level named `SortExpression` property.</span></span> <span data-ttu-id="ab640-239">這個屬性類似于在上一個教學課程中建立的 `PageIndex` 和 `PageSize` 屬性，會傳回 `sortExpression` querystring 欄位的值（如果有的話），否則會傳回預設值（ProductName）。</span><span class="sxs-lookup"><span data-stu-id="ab640-239">This property, similar to the `PageIndex` and `PageSize` properties created in the previous tutorial, returns the value of the `sortExpression` querystring field if it exists, and the default value ( ProductName ) otherwise.</span></span>

<span data-ttu-id="ab640-240">`RedirectUser` 的方法目前只接受單一輸入參數，即要顯示的頁面索引。</span><span class="sxs-lookup"><span data-stu-id="ab640-240">Currently the `RedirectUser` method accepts only a single input parameter the index of the page to display.</span></span> <span data-ttu-id="ab640-241">不過，有時候我們會想要使用 querystring 中指定的排序運算式，將使用者重新導向至特定的資料頁面。</span><span class="sxs-lookup"><span data-stu-id="ab640-241">However, there may be times when we want to redirect the user to a particular page of data using a sort expression other than what s specified in the querystring.</span></span> <span data-ttu-id="ab640-242">我們稍後會建立此頁面的排序介面，其中包含一系列的按鈕 Web 控制項，可依指定的資料行來排序資料。</span><span class="sxs-lookup"><span data-stu-id="ab640-242">In a moment we'll create the sorting interface for this page, which will include a series of Button Web controls for sorting the data by a specified column.</span></span> <span data-ttu-id="ab640-243">當按下其中一個按鈕時，我們會想要重新導向傳遞適當排序運算式值的使用者。</span><span class="sxs-lookup"><span data-stu-id="ab640-243">When one of those Buttons is clicked, we want to redirect the user passing in the appropriate sort expression value.</span></span> <span data-ttu-id="ab640-244">若要提供這項功能，請建立兩個版本的 `RedirectUser` 方法。</span><span class="sxs-lookup"><span data-stu-id="ab640-244">To provide this functionality, create two versions of the `RedirectUser` method.</span></span> <span data-ttu-id="ab640-245">第一個只應接受要顯示的頁面索引，而第二個則接受頁面索引和排序運算式。</span><span class="sxs-lookup"><span data-stu-id="ab640-245">The first one should accept just the page index to display, while the second one accepts the page index and sort expression.</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample7.cs)]

<span data-ttu-id="ab640-246">在本教學課程的第一個範例中，我們使用 DropDownList 建立排序介面。</span><span class="sxs-lookup"><span data-stu-id="ab640-246">In the first example in this tutorial, we created a sorting interface using a DropDownList.</span></span> <span data-ttu-id="ab640-247">在此範例中，讓我們使用位於 DataList 一個上方的三個按鈕 Web 控制項，依 `ProductName`進行排序，一個用於 `CategoryName`，另一個用於 `SupplierName`。</span><span class="sxs-lookup"><span data-stu-id="ab640-247">For this example, let s use three Button Web controls positioned above the DataList one for sorting by `ProductName`, one for `CategoryName`, and one for `SupplierName`.</span></span> <span data-ttu-id="ab640-248">新增三個按鈕 Web 控制項，適當地設定其 `ID` 和 `Text` 屬性：</span><span class="sxs-lookup"><span data-stu-id="ab640-248">Add the three Button Web controls, setting their `ID` and `Text` properties appropriately:</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample8.aspx)]

<span data-ttu-id="ab640-249">接下來，為每個建立一個 `Click` 事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="ab640-249">Next, create a `Click` event handler for each.</span></span> <span data-ttu-id="ab640-250">事件處理常式應該呼叫 `RedirectUser` 方法，並使用適當的排序運算式將使用者傳回第一頁。</span><span class="sxs-lookup"><span data-stu-id="ab640-250">The event handlers should call the `RedirectUser` method, returning the user to the first page using the appropriate sort expression.</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample9.cs)]

<span data-ttu-id="ab640-251">第一次造訪網頁時，資料會依產品名稱的字母順序排序（請參閱 [圖 9]）。</span><span class="sxs-lookup"><span data-stu-id="ab640-251">When first visiting the page, the data is sorted by the product name alphabetically (refer back to Figure 9).</span></span> <span data-ttu-id="ab640-252">按 [下一步] 按鈕，前進到第二頁的資料，然後按一下 [依分類排序] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="ab640-252">Click the Next button to advance to the second page of data and then click the Sort by Category button.</span></span> <span data-ttu-id="ab640-253">這會讓我們回到第一頁的資料，依類別目錄名稱排序（請參閱 [圖 10]）。</span><span class="sxs-lookup"><span data-stu-id="ab640-253">This returns us to the first page of data, sorted by category name (see Figure 10).</span></span> <span data-ttu-id="ab640-254">同樣地，按一下 [依供應商排序] 按鈕會根據供應商從資料的第一頁開始排序資料。</span><span class="sxs-lookup"><span data-stu-id="ab640-254">Likewise, clicking the Sort by Supplier button sorts the data by supplier starting from the first page of data.</span></span> <span data-ttu-id="ab640-255">當資料經過分頁處理時，會記住排序選擇。</span><span class="sxs-lookup"><span data-stu-id="ab640-255">The sort choice is remembered as the data is paged through.</span></span> <span data-ttu-id="ab640-256">[圖 11] 顯示依類別排序之後的頁面，然後前進到第十三頁的資料。</span><span class="sxs-lookup"><span data-stu-id="ab640-256">Figure 11 shows the page after sorting by category and then advancing to the thirteenth page of data.</span></span>

<span data-ttu-id="ab640-257">[![產品依類別排序](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image27.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="ab640-257">[![The Products are Sorted by Category](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image27.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image26.png)</span></span>

<span data-ttu-id="ab640-258">**圖 10**：產品依類別排序（[按一下以觀看完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image28.png)）</span><span class="sxs-lookup"><span data-stu-id="ab640-258">**Figure 10**: The Products are Sorted by Category ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image28.png))</span></span>

<span data-ttu-id="ab640-259">[![分頁流覽資料時，會記住排序運算式](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image30.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="ab640-259">[![The Sort Expression is Remembered When Paging Through the Data](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image30.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image29.png)</span></span>

<span data-ttu-id="ab640-260">**圖 11**：分頁流覽資料時，會記住排序運算式（[按一下以查看完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image31.png)）</span><span class="sxs-lookup"><span data-stu-id="ab640-260">**Figure 11**: The Sort Expression is Remembered When Paging Through the Data ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image31.png))</span></span>

## <a name="step-6-custom-paging-through-records-in-a-repeater"></a><span data-ttu-id="ab640-261">步驟6：透過重複項中的記錄自訂分頁</span><span class="sxs-lookup"><span data-stu-id="ab640-261">Step 6: Custom Paging Through Records in a Repeater</span></span>

<span data-ttu-id="ab640-262">DataList 範例會使用沒有效率的預設分頁技術，在步驟5頁面中檢查其資料。</span><span class="sxs-lookup"><span data-stu-id="ab640-262">The DataList example examined in step 5 pages through its data using the inefficient default paging technique.</span></span> <span data-ttu-id="ab640-263">當逐頁查看大量資料時，請務必使用自訂分頁。</span><span class="sxs-lookup"><span data-stu-id="ab640-263">When paging through sufficiently large amounts of data, it is imperative that custom paging be used.</span></span> <span data-ttu-id="ab640-264">回到有效率的[分頁處理大量資料](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-cs.md)，並[排序自訂的分頁資料](../paging-and-sorting/sorting-custom-paged-data-cs.md)教學課程，我們已檢查了在使用自訂分頁和排序自訂分頁資料的 BLL 中，預設和自訂分頁與已建立方法之間的差異。</span><span class="sxs-lookup"><span data-stu-id="ab640-264">Back in the [Efficiently Paging Through Large Amounts of Data](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-cs.md) and [Sorting Custom Paged Data](../paging-and-sorting/sorting-custom-paged-data-cs.md) tutorials, we examined the differences between default and custom paging and created methods in the BLL for utilizing custom paging and sorting custom paged data.</span></span> <span data-ttu-id="ab640-265">特別是在這兩個先前的教學課程中，我們將下列三種方法新增至 `ProductsBLL` 類別：</span><span class="sxs-lookup"><span data-stu-id="ab640-265">In particular, in these two previous tutorials we added the following three methods to the `ProductsBLL` class:</span></span>

- <span data-ttu-id="ab640-266">`GetProductsPaged(startRowIndex, maximumRows)` 會傳回從*startRowIndex*開始且不超過*maximumRows*的特定記錄子集。</span><span class="sxs-lookup"><span data-stu-id="ab640-266">`GetProductsPaged(startRowIndex, maximumRows)` returns a particular subset of records starting at *startRowIndex* and not exceeding *maximumRows*.</span></span>
- <span data-ttu-id="ab640-267">`GetProductsPagedAndSorted(sortExpression, startRowIndex, maximumRows)` 會傳回依指定的*sortExpression*輸入參數排序之記錄的特定子集。</span><span class="sxs-lookup"><span data-stu-id="ab640-267">`GetProductsPagedAndSorted(sortExpression, startRowIndex, maximumRows)` returns a particular subset of records sorted by the specified *sortExpression* input parameter.</span></span>
- <span data-ttu-id="ab640-268">`TotalNumberOfProducts()` 提供 `Products` 資料庫資料表中的記錄總數。</span><span class="sxs-lookup"><span data-stu-id="ab640-268">`TotalNumberOfProducts()` provides the total number of records in the `Products` database table.</span></span>

<span data-ttu-id="ab640-269">這些方法可用來有效率地使用 DataList 或重複項控制項來進行資料的分頁和排序。</span><span class="sxs-lookup"><span data-stu-id="ab640-269">These methods can be used to efficiently page and sort through data using a DataList or Repeater control.</span></span> <span data-ttu-id="ab640-270">為了說明這一點，讓我們從建立具有自訂分頁支援的中繼器控制項開始著手;接著，我們會新增排序功能。</span><span class="sxs-lookup"><span data-stu-id="ab640-270">To illustrate this, let s start by creating a Repeater control with custom paging support; we'll then add sorting capabilities.</span></span>

<span data-ttu-id="ab640-271">開啟 [`PagingSortingDataListRepeater`] 資料夾中的 [`SortingWithCustomPaging.aspx`] 頁面，並在頁面中新增中繼器，將其 `ID` 屬性設定為 [`Products`]。</span><span class="sxs-lookup"><span data-stu-id="ab640-271">Open the `SortingWithCustomPaging.aspx` page in the `PagingSortingDataListRepeater` folder and add a Repeater to the page, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="ab640-272">從 [中繼器] 智慧標籤中，建立名為 `ProductsDataSource`的新 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="ab640-272">From the Repeater s smart tag, create a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="ab640-273">將它設定為從 `ProductsBLL` 類別的 `GetProductsPaged` 方法中選取其資料。</span><span class="sxs-lookup"><span data-stu-id="ab640-273">Configure it to select its data from the `ProductsBLL` class s `GetProductsPaged` method.</span></span>

<span data-ttu-id="ab640-274">[![將 ObjectDataSource 設定為使用 ProductsBLL 類別的 GetProductsPaged 方法](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image33.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="ab640-274">[![Configure the ObjectDataSource to Use the ProductsBLL Class s GetProductsPaged Method](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image33.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image32.png)</span></span>

<span data-ttu-id="ab640-275">**圖 12**：設定 ObjectDataSource 使用 `ProductsBLL` 類別的 `GetProductsPaged` 方法（[按一下以查看完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image34.png)）</span><span class="sxs-lookup"><span data-stu-id="ab640-275">**Figure 12**: Configure the ObjectDataSource to Use the `ProductsBLL` Class s `GetProductsPaged` Method ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image34.png))</span></span>

<span data-ttu-id="ab640-276">將 [更新]、[插入] 和 [刪除] 索引標籤中的下拉式清單設定為 [（無）]，然後按 [下一步] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="ab640-276">Set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) and then click the Next button.</span></span> <span data-ttu-id="ab640-277">[設定資料來源] wizard 現在會提示您輸入 `GetProductsPaged` 方法*startRowIndex*和*maximumRows*輸入參數的來源。</span><span class="sxs-lookup"><span data-stu-id="ab640-277">The Configure Data Source wizard now prompts for the sources of the `GetProductsPaged` method s *startRowIndex* and *maximumRows* input parameters.</span></span> <span data-ttu-id="ab640-278">實際上，這些輸入參數會被忽略。</span><span class="sxs-lookup"><span data-stu-id="ab640-278">In actuality, these input parameters are ignored.</span></span> <span data-ttu-id="ab640-279">相反地， *startRowIndex*和*maximumRows*值會透過 ObjectDataSource s `Selecting` 事件處理常式中的 `Arguments` 屬性傳入，就像我們在本教學課程中指定*sortExpression*的第一個示範一樣。</span><span class="sxs-lookup"><span data-stu-id="ab640-279">Instead, the *startRowIndex* and *maximumRows* values will be passed in through the `Arguments` property in the ObjectDataSource s `Selecting` event handler, just like how we specified the *sortExpression* in this tutorial s first demo.</span></span> <span data-ttu-id="ab640-280">因此，請將 wizard 中的 [參數來源] 下拉式清單保留為 [無]。</span><span class="sxs-lookup"><span data-stu-id="ab640-280">Therefore, leave the parameter source drop-down lists in the wizard set at None .</span></span>

<span data-ttu-id="ab640-281">[![保持參數來源設定為 [無]](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image36.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="ab640-281">[![Leave the Parameter Sources Set to None](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image36.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image35.png)</span></span>

<span data-ttu-id="ab640-282">**圖 13**：讓 [參數來源] 設定為 [無] （[按一下以查看完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image37.png)）</span><span class="sxs-lookup"><span data-stu-id="ab640-282">**Figure 13**: Leave the Parameter Sources Set to None ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image37.png))</span></span>

> [!NOTE]
> <span data-ttu-id="ab640-283">請勿將 ObjectDataSource s `EnablePaging`*屬性設為*`true`。</span><span class="sxs-lookup"><span data-stu-id="ab640-283">Do *not* set the ObjectDataSource s `EnablePaging` property to `true`.</span></span> <span data-ttu-id="ab640-284">這會導致 ObjectDataSource 自動將自己的*startRowIndex*和*maximumRows*參數包含在 `SelectMethod` 的現有參數清單中。</span><span class="sxs-lookup"><span data-stu-id="ab640-284">This will cause the ObjectDataSource to automatically include its own *startRowIndex* and *maximumRows* parameters to the `SelectMethod` s existing parameter list.</span></span> <span data-ttu-id="ab640-285">將自訂分頁資料系結至 GridView、DetailsView 或 FormView 控制項時，`EnablePaging` 屬性會很有用，因為這些控制項會預期只有在 `true``EnablePaging` 屬性時，才可以使用該類型的特定行為。</span><span class="sxs-lookup"><span data-stu-id="ab640-285">The `EnablePaging` property is useful when binding custom paged data to a GridView, DetailsView, or FormView control because these controls expect certain behavior from the ObjectDataSource that s only available when `EnablePaging` property is `true`.</span></span> <span data-ttu-id="ab640-286">因為我們必須手動新增 DataList 和中繼器的分頁支援，所以將此屬性設定為 `false` （預設值），因為我們會直接在 ASP.NET 網頁中製作所需的功能。</span><span class="sxs-lookup"><span data-stu-id="ab640-286">Since we have to manually add the paging support for the DataList and Repeater, leave this property set to `false` (the default), as we'll bake in the needed functionality directly within our ASP.NET page.</span></span>

<span data-ttu-id="ab640-287">最後，定義中繼器 `ItemTemplate`，以便顯示產品的名稱、類別和供應商。</span><span class="sxs-lookup"><span data-stu-id="ab640-287">Finally, define the Repeater s `ItemTemplate` so that the product s name, category, and supplier are shown.</span></span> <span data-ttu-id="ab640-288">這些變更之後，中繼器和 ObjectDataSource 的宣告式語法看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="ab640-288">After these changes, the Repeater and ObjectDataSource s declarative syntax should look similar to the following:</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample10.aspx)]

<span data-ttu-id="ab640-289">請花點時間透過瀏覽器造訪頁面，並注意不會傳回任何記錄。</span><span class="sxs-lookup"><span data-stu-id="ab640-289">Take a moment to visit the page through a browser and note that no records are returned.</span></span> <span data-ttu-id="ab640-290">這是因為我們尚未指定*startRowIndex*和*maximumRows*參數值;因此，會針對兩者傳入0的值。</span><span class="sxs-lookup"><span data-stu-id="ab640-290">This is because we ve yet to specify the *startRowIndex* and *maximumRows* parameter values; therefore, values of 0 are being passed in for both.</span></span> <span data-ttu-id="ab640-291">若要指定這些值，請建立 ObjectDataSource s `Selecting` 事件的事件處理常式，並以程式設計方式將這些參數值設定為0和5的硬式編碼值：</span><span class="sxs-lookup"><span data-stu-id="ab640-291">To specify these values, create an event handler for the ObjectDataSource s `Selecting` event and set these parameters values programmatically to hard-coded values of 0 and 5, respectively:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample11.cs)]

<span data-ttu-id="ab640-292">透過這種變更，頁面在瀏覽器中查看時，會顯示前五個產品。</span><span class="sxs-lookup"><span data-stu-id="ab640-292">With this change, the page, when viewed through a browser, shows the first five products.</span></span>

<span data-ttu-id="ab640-293">[顯示前五筆記錄 ![](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image39.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="ab640-293">[![The First Five Records are Displayed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image39.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image38.png)</span></span>

<span data-ttu-id="ab640-294">**圖 14**：顯示前五筆記錄（[按一下以觀看完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image40.png)）</span><span class="sxs-lookup"><span data-stu-id="ab640-294">**Figure 14**: The First Five Records are Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image40.png))</span></span>

> [!NOTE]
> <span data-ttu-id="ab640-295">[圖 14] 中所列的產品是依產品名稱排序，因為執行有效率的自訂分頁查詢的 `GetProductsPaged` 預存程式，會 `ProductName`來依排序結果。</span><span class="sxs-lookup"><span data-stu-id="ab640-295">The products listed in Figure 14 happen to be sorted by product name because the `GetProductsPaged` stored procedure that performs the efficient custom paging query orders the results by `ProductName`.</span></span>

<span data-ttu-id="ab640-296">為了讓使用者可以逐步執行頁面，我們必須追蹤開始列索引和最大資料列，並在回傳之間記住這些值。</span><span class="sxs-lookup"><span data-stu-id="ab640-296">In order to allow the user to step through the pages, we need to keep track of the start row index and maximum rows and remember these values across postbacks.</span></span> <span data-ttu-id="ab640-297">在預設分頁範例中，我們使用 querystring 欄位來保存這些值;在此示範中，讓我們將這項資訊保存在頁面 s 檢視狀態。</span><span class="sxs-lookup"><span data-stu-id="ab640-297">In the default paging example we used querystring fields to persist these values; for this demo, let s persist this information in the page s view state.</span></span> <span data-ttu-id="ab640-298">建立下列兩個屬性：</span><span class="sxs-lookup"><span data-stu-id="ab640-298">Create the following two properties:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample12.cs)]

<span data-ttu-id="ab640-299">接下來，更新選取事件處理常式中的程式碼，使其使用 `StartRowIndex` 並 `MaximumRows` 屬性，而不是硬式編碼值0和5：</span><span class="sxs-lookup"><span data-stu-id="ab640-299">Next, update the code in the Selecting event handler so that it uses the `StartRowIndex` and `MaximumRows` properties instead of the hard-coded values of 0 and 5:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample13.cs)]

<span data-ttu-id="ab640-300">此時，我們的頁面仍然只會顯示前五筆記錄。</span><span class="sxs-lookup"><span data-stu-id="ab640-300">At this point our page still shows just the first five records.</span></span> <span data-ttu-id="ab640-301">不過，在這些屬性準備就緒之後，我們就可以開始建立分頁介面。</span><span class="sxs-lookup"><span data-stu-id="ab640-301">However, with these properties in place, we re ready to create our paging interface.</span></span>

## <a name="adding-the-paging-interface"></a><span data-ttu-id="ab640-302">新增分頁介面</span><span class="sxs-lookup"><span data-stu-id="ab640-302">Adding the Paging Interface</span></span>

<span data-ttu-id="ab640-303">讓我們使用預設分頁範例中使用的相同第一個、上一個、下一個、最後一個分頁介面，包括標籤 Web 控制項，可顯示要查看的資料頁，以及有多少總頁數。</span><span class="sxs-lookup"><span data-stu-id="ab640-303">Let s use the same First, Previous, Next, Last paging interface used in the default paging example, including the Label Web control that displays what page of data is being viewed and how many total pages exist.</span></span> <span data-ttu-id="ab640-304">在中繼器底下新增四個按鈕 Web 控制項和標籤。</span><span class="sxs-lookup"><span data-stu-id="ab640-304">Add the four Button Web controls and Label below the Repeater.</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample14.aspx)]

<span data-ttu-id="ab640-305">接下來，建立四個按鈕 `Click` 事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="ab640-305">Next, create `Click` event handlers for the four Buttons.</span></span> <span data-ttu-id="ab640-306">當按下其中一個按鈕時，我們需要更新 `StartRowIndex`，並將資料重新系結至中繼器。</span><span class="sxs-lookup"><span data-stu-id="ab640-306">When one of these Buttons is clicked, we need to update the `StartRowIndex` and rebind the data to the Repeater.</span></span> <span data-ttu-id="ab640-307">[第一個]、[上一個] 和 [下一步] 按鈕的程式碼很簡單，但最後一個按鈕如何判斷最後一頁數據的開始列索引？</span><span class="sxs-lookup"><span data-stu-id="ab640-307">The code for the First, Previous, and Next buttons is simple enough, but for the Last button how do we determine the start row index for the last page of data?</span></span> <span data-ttu-id="ab640-308">若要計算此索引，以及判斷是否應該啟用 [下一步] 和 [最後一個] 按鈕，我們需要知道總共有多少筆記錄正在進行分頁。</span><span class="sxs-lookup"><span data-stu-id="ab640-308">To compute this index as well as being able to determine whether the Next and Last buttons should be enabled we need to know how many records in total are being paged through.</span></span> <span data-ttu-id="ab640-309">我們可以藉由呼叫 `ProductsBLL` 類別的 `TotalNumberOfProducts()` 方法來判斷這一點。</span><span class="sxs-lookup"><span data-stu-id="ab640-309">We can determine this by calling the `ProductsBLL` class s `TotalNumberOfProducts()` method.</span></span> <span data-ttu-id="ab640-310">讓 s 建立一個唯讀的頁面層級屬性，名為 `TotalRowCount`，以傳回 `TotalNumberOfProducts()` 方法的結果：</span><span class="sxs-lookup"><span data-stu-id="ab640-310">Let s create a read-only, page-level property named `TotalRowCount` that returns the results of the `TotalNumberOfProducts()` method:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample15.cs)]

<span data-ttu-id="ab640-311">我們現在可以使用這個屬性來判斷最後一頁的開始資料列索引。</span><span class="sxs-lookup"><span data-stu-id="ab640-311">With this property we can now determine the last page s start row index.</span></span> <span data-ttu-id="ab640-312">具體來說，它是 `TotalRowCount` 的整數結果減去1除以 `MaximumRows`，乘以 `MaximumRows`。</span><span class="sxs-lookup"><span data-stu-id="ab640-312">Specifically, it s the integer result of the `TotalRowCount` minus 1 divided by `MaximumRows`, multiplied by `MaximumRows`.</span></span> <span data-ttu-id="ab640-313">我們現在可以為四個分頁介面按鈕撰寫 `Click` 事件處理常式：</span><span class="sxs-lookup"><span data-stu-id="ab640-313">We can now write the `Click` event handlers for the four paging interface buttons:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample16.cs)]

<span data-ttu-id="ab640-314">最後，當您在流覽最後一頁時，必須停用分頁介面中的第一個和上一個按鈕，而在觀看最後一頁時，則是 [下一個] 和 [最後一個] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="ab640-314">Finally, we need to disable the First and Previous buttons in the paging interface when viewing the first page of data and the Next and Last buttons when viewing the last page.</span></span> <span data-ttu-id="ab640-315">若要完成這項操作，請將下列程式碼新增至 ObjectDataSource s `Selecting` 事件處理常式：</span><span class="sxs-lookup"><span data-stu-id="ab640-315">To accomplish this, add the following code to the ObjectDataSource s `Selecting` event handler:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample17.cs)]

<span data-ttu-id="ab640-316">加入這些 `Click` 事件處理常式和程式碼，以根據目前的開始資料列索引來啟用或停用分頁介面元素之後，請在瀏覽器中測試頁面。</span><span class="sxs-lookup"><span data-stu-id="ab640-316">After adding these `Click` event handlers and the code to enable or disable the paging interface elements based on the current start row index, test the page in a browser.</span></span> <span data-ttu-id="ab640-317">如 [圖 15] 所示，第一次造訪網頁時，會停用第一個和上一個按鈕。</span><span class="sxs-lookup"><span data-stu-id="ab640-317">As Figure 15 illustrates, when first visiting the page the First and Previous buttons will are disabled.</span></span> <span data-ttu-id="ab640-318">按 [下一步] 會顯示第二頁的資料，而按一下 [上次] 則會顯示最後一頁（請參閱圖16和17）。</span><span class="sxs-lookup"><span data-stu-id="ab640-318">Clicking Next shows the second page of data, while clicking Last displays the final page (see Figures 16 and 17).</span></span> <span data-ttu-id="ab640-319">當觀看最後一頁的資料時，會停用 [下一步] 和 [最後一個] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="ab640-319">When viewing the last page of data both the Next and Last buttons are disabled.</span></span>

<span data-ttu-id="ab640-320">[![在觀看產品的第一頁時，已停用前一個和最後一個按鈕](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image42.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="ab640-320">[![The Previous and Last Buttons are Disabled When Viewing the First Page of Products](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image42.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image41.png)</span></span>

<span data-ttu-id="ab640-321">**圖 15**：觀看產品的第一頁時，已停用上一個和最後一個按鈕（[按一下以觀看完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image43.png)）</span><span class="sxs-lookup"><span data-stu-id="ab640-321">**Figure 15**: The Previous and Last Buttons are Disabled When Viewing the First Page of Products ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image43.png))</span></span>

<span data-ttu-id="ab640-322">[顯示產品的第二頁 ![](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image45.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image44.png)</span><span class="sxs-lookup"><span data-stu-id="ab640-322">[![The Second Page of Products are Displayed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image45.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image44.png)</span></span>

<span data-ttu-id="ab640-323">**圖 16**：顯示產品的第二頁（[按一下以觀看完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image46.png)）</span><span class="sxs-lookup"><span data-stu-id="ab640-323">**Figure 16**: The Second Page of Products are Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image46.png))</span></span>

<span data-ttu-id="ab640-324">[![按一下 [上一步] 會顯示最後一頁的資料](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image48.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image47.png)</span><span class="sxs-lookup"><span data-stu-id="ab640-324">[![Clicking Last Displays the Final Page of Data](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image48.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image47.png)</span></span>

<span data-ttu-id="ab640-325">**圖 17**：按一下 [上一步] 會顯示最後一頁的資料（[按一下以查看完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image49.png)）</span><span class="sxs-lookup"><span data-stu-id="ab640-325">**Figure 17**: Clicking Last Displays the Final Page of Data ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image49.png))</span></span>

## <a name="step-7-including-sorting-support-with-the-custom-paged-repeater"></a><span data-ttu-id="ab640-326">步驟7：包含使用自訂分頁中繼器的排序支援</span><span class="sxs-lookup"><span data-stu-id="ab640-326">Step 7: Including Sorting Support with the Custom Paged Repeater</span></span>

<span data-ttu-id="ab640-327">既然自訂分頁已經完成，我們就準備好加入排序支援。</span><span class="sxs-lookup"><span data-stu-id="ab640-327">Now that custom paging has been implemented, we re ready to include sorting support.</span></span> <span data-ttu-id="ab640-328">`ProductsBLL` 類別的 `GetProductsPagedAndSorted` 方法與 `GetProductsPaged`具有相同的*startRowIndex*和*maximumRows*輸入參數，但允許額外的*sortExpression*輸入參數。</span><span class="sxs-lookup"><span data-stu-id="ab640-328">The `ProductsBLL` class s `GetProductsPagedAndSorted` method has the same *startRowIndex* and *maximumRows* input parameters as `GetProductsPaged`, but permits an additional *sortExpression* input parameter.</span></span> <span data-ttu-id="ab640-329">若要使用 `SortingWithCustomPaging.aspx`的 `GetProductsPagedAndSorted` 方法，我們需要執行下列步驟：</span><span class="sxs-lookup"><span data-stu-id="ab640-329">To use the `GetProductsPagedAndSorted` method from `SortingWithCustomPaging.aspx`, we need to perform the following steps:</span></span>

1. <span data-ttu-id="ab640-330">將 [ObjectDataSource s `SelectMethod`] 屬性從 `GetProductsPaged` 變更為 [`GetProductsPagedAndSorted`]。</span><span class="sxs-lookup"><span data-stu-id="ab640-330">Change the ObjectDataSource s `SelectMethod` property from `GetProductsPaged` to `GetProductsPagedAndSorted`.</span></span>
2. <span data-ttu-id="ab640-331">將*sortExpression* `Parameter` 物件新增至 ObjectDataSource s `SelectParameters` 集合。</span><span class="sxs-lookup"><span data-stu-id="ab640-331">Add a *sortExpression* `Parameter` object to the ObjectDataSource s `SelectParameters` collection.</span></span>
3. <span data-ttu-id="ab640-332">建立私用頁面層級 `SortExpression` 屬性，以透過頁面 s 檢視狀態在回傳期間保存其值。</span><span class="sxs-lookup"><span data-stu-id="ab640-332">Create a private, page-level `SortExpression` property that persists its value across postbacks through the page s view state.</span></span>
4. <span data-ttu-id="ab640-333">更新 ObjectDataSource s `Selecting` 事件處理常式，將頁面層級 `SortExpression` 屬性的值指派給 ObjectDataSource s *sortExpression*參數。</span><span class="sxs-lookup"><span data-stu-id="ab640-333">Update the ObjectDataSource s `Selecting` event handler to assign the ObjectDataSource s *sortExpression* parameter the value of the page-level `SortExpression` property.</span></span>
5. <span data-ttu-id="ab640-334">建立排序介面。</span><span class="sxs-lookup"><span data-stu-id="ab640-334">Create the sorting interface.</span></span>

<span data-ttu-id="ab640-335">從更新 ObjectDataSource s `SelectMethod` 屬性，並新增*sortExpression* `Parameter`開始。</span><span class="sxs-lookup"><span data-stu-id="ab640-335">Start by updating the ObjectDataSource s `SelectMethod` property and adding a *sortExpression* `Parameter`.</span></span> <span data-ttu-id="ab640-336">請確定 [ *sortExpression* `Parameter` s `Type`] 屬性已設定為 [`String`]。</span><span class="sxs-lookup"><span data-stu-id="ab640-336">Make sure that the *sortExpression* `Parameter` s `Type` property is set to `String`.</span></span> <span data-ttu-id="ab640-337">完成前兩個工作之後，ObjectDataSource 的宣告式標記看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="ab640-337">After completing these first two tasks, the ObjectDataSource s declarative markup should look like the following:</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample18.aspx)]

<span data-ttu-id="ab640-338">接下來，我們需要頁面層級 `SortExpression` 屬性，其值會序列化為 view 狀態。</span><span class="sxs-lookup"><span data-stu-id="ab640-338">Next, we need a page-level `SortExpression` property whose value is serialized to view state.</span></span> <span data-ttu-id="ab640-339">如果未設定排序運算式值，請使用 ProductName 做為預設值：</span><span class="sxs-lookup"><span data-stu-id="ab640-339">If no sort expression value has been set, use ProductName as the default:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample19.cs)]

<span data-ttu-id="ab640-340">在 ObjectDataSource 叫用 `GetProductsPagedAndSorted` 方法之前，我們需要將*sortExpression* `Parameter` 設定為 `SortExpression` 屬性的值。</span><span class="sxs-lookup"><span data-stu-id="ab640-340">Before the ObjectDataSource invokes the `GetProductsPagedAndSorted` method we need to set the *sortExpression* `Parameter` to the value of the `SortExpression` property.</span></span> <span data-ttu-id="ab640-341">在 `Selecting` 事件處理常式中，新增下列程式程式碼：</span><span class="sxs-lookup"><span data-stu-id="ab640-341">In the `Selecting` event handler, add the following line of code:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample20.cs)]

<span data-ttu-id="ab640-342">剩下的就是執行排序介面。</span><span class="sxs-lookup"><span data-stu-id="ab640-342">All that remains is to implement the sorting interface.</span></span> <span data-ttu-id="ab640-343">就像我們在上一個範例中所做的一樣，讓我們使用三個按鈕 Web 控制項來實作為排序介面，讓使用者依產品名稱、類別或供應商來排序結果。</span><span class="sxs-lookup"><span data-stu-id="ab640-343">As we did in the last example, let s have the sorting interface implemented using three Button Web controls that allow the user to sort the results by product name, category, or supplier.</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample21.aspx)]

<span data-ttu-id="ab640-344">建立這三個按鈕控制項的 `Click` 事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="ab640-344">Create `Click` event handlers for these three Button controls.</span></span> <span data-ttu-id="ab640-345">在事件處理常式中，將 `StartRowIndex` 重設為0，將 `SortExpression` 設定為適當的值，並將資料重新系結至中繼器：</span><span class="sxs-lookup"><span data-stu-id="ab640-345">In the event handler, reset the `StartRowIndex` to 0, set the `SortExpression` to the appropriate value, and rebind the data to the Repeater:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample22.cs)]

<span data-ttu-id="ab640-346">這樣就大功告成了！</span><span class="sxs-lookup"><span data-stu-id="ab640-346">That s all there is to it!</span></span> <span data-ttu-id="ab640-347">雖然有幾個步驟可取得自訂分頁和排序，但這些步驟與預設分頁所需的步驟非常類似。</span><span class="sxs-lookup"><span data-stu-id="ab640-347">While there were a number of steps to get custom paging and sorting implemented, the steps were very similar to those needed for default paging.</span></span> <span data-ttu-id="ab640-348">[圖 18] 顯示依類別目錄排序時，觀看最後一頁數據的產品。</span><span class="sxs-lookup"><span data-stu-id="ab640-348">Figure 18 shows the products when viewing the last page of data when sorted by category.</span></span>

<span data-ttu-id="ab640-349">[會顯示 ![最後一頁的資料，依分類排序](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image51.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="ab640-349">[![The Last Page of Data, Sorted by Category, is Displayed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image51.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image50.png)</span></span>

<span data-ttu-id="ab640-350">**圖 18**：顯示最後一頁的資料，依分類排序（[按一下以觀看完整大小的影像](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image52.png)）</span><span class="sxs-lookup"><span data-stu-id="ab640-350">**Figure 18**: The Last Page of Data, Sorted by Category, is Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image52.png))</span></span>

> [!NOTE]
> <span data-ttu-id="ab640-351">在先前的範例中，由供應商廠商進行排序時，會使用做為排序運算式。</span><span class="sxs-lookup"><span data-stu-id="ab640-351">In previous examples, when sorting by the supplier SupplierName was used as the sort expression.</span></span> <span data-ttu-id="ab640-352">不過，針對自訂分頁執行，我們需要使用 [公司名稱]。</span><span class="sxs-lookup"><span data-stu-id="ab640-352">However, for the custom paging implementation, we need to use CompanyName.</span></span> <span data-ttu-id="ab640-353">這是因為負責執行自訂分頁 `GetProductsPagedAndSorted` 將排序運算式傳遞至 `ROW_NUMBER()` 關鍵字的預存程式，`ROW_NUMBER()` 關鍵字需要實際的資料行名稱，而不是別名。</span><span class="sxs-lookup"><span data-stu-id="ab640-353">This is because the stored procedure responsible for implementing custom paging `GetProductsPagedAndSorted` passes the sort expression into the `ROW_NUMBER()` keyword, The `ROW_NUMBER()` keyword requires the actual column name rather than an alias.</span></span> <span data-ttu-id="ab640-354">因此，我們必須使用 `CompanyName` （`Suppliers` 資料表中的資料行名稱），而不是排序運算式的 `SELECT` 查詢（`SupplierName`）中所使用的別名。</span><span class="sxs-lookup"><span data-stu-id="ab640-354">Therefore, we must use `CompanyName` (the name of the column in the `Suppliers` table) rather than the alias used in the `SELECT` query (`SupplierName`) for the sort expression.</span></span>

## <a name="summary"></a><span data-ttu-id="ab640-355">總結</span><span class="sxs-lookup"><span data-stu-id="ab640-355">Summary</span></span>

<span data-ttu-id="ab640-356">DataList 和中繼器都不提供內建的排序支援，但有一些程式碼和自訂排序介面，因此可以加入這類功能。</span><span class="sxs-lookup"><span data-stu-id="ab640-356">Neither the DataList nor Repeater offer built-in sorting support, but with a bit of code and a custom sorting interface, such functionality can be added.</span></span> <span data-ttu-id="ab640-357">在執行排序（但不分頁）時，可以透過傳遞至 ObjectDataSource s `Select` 方法的 `DataSourceSelectArguments` 物件來指定排序運算式。</span><span class="sxs-lookup"><span data-stu-id="ab640-357">When implementing sorting, but not paging, the sort expression can be specified through the `DataSourceSelectArguments` object passed into the ObjectDataSource s `Select` method.</span></span> <span data-ttu-id="ab640-358">這個 `DataSourceSelectArguments` 物件 `SortExpression` 屬性可以在 ObjectDataSource s `Selecting` 事件處理常式中指派。</span><span class="sxs-lookup"><span data-stu-id="ab640-358">This `DataSourceSelectArguments` object s `SortExpression` property can be assigned in the ObjectDataSource s `Selecting` event handler.</span></span>

<span data-ttu-id="ab640-359">若要將排序功能加入至已提供分頁支援的 DataList 或重複項，最簡單的方法是自訂商務邏輯層，以包含接受排序運算式的方法。</span><span class="sxs-lookup"><span data-stu-id="ab640-359">To add sorting capabilities to a DataList or Repeater that already provides paging support, the easiest approach is to customize the Business Logic Layer to include a method that accepts a sort expression.</span></span> <span data-ttu-id="ab640-360">這項資訊接著可以透過 ObjectDataSource s `SelectParameters`中的參數傳遞。</span><span class="sxs-lookup"><span data-stu-id="ab640-360">This information can then be passed in through a parameter in the ObjectDataSource s `SelectParameters`.</span></span>

<span data-ttu-id="ab640-361">本教學課程使用 DataList 和重複項控制項，完成分頁和排序的檢查。</span><span class="sxs-lookup"><span data-stu-id="ab640-361">This tutorial completes our examination of paging and sorting with the DataList and Repeater controls.</span></span> <span data-ttu-id="ab640-362">我們的下一個和最後一個教學課程將探討如何將按鈕 Web 控制項新增至 DataList 和 Repeater 的範本，以便為每個專案提供一些自訂、以使用者為基礎的功能。</span><span class="sxs-lookup"><span data-stu-id="ab640-362">Our next and final tutorial will examine how to add Button Web controls to the DataList and Repeater s templates in order to provide some custom, user-initiated functionality on a per-item basis.</span></span>

<span data-ttu-id="ab640-363">快樂的程式設計！</span><span class="sxs-lookup"><span data-stu-id="ab640-363">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="ab640-364">關於作者</span><span class="sxs-lookup"><span data-stu-id="ab640-364">About the Author</span></span>

<span data-ttu-id="ab640-365">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，自1998起，有七個 ASP/ASP. NET 書籍和創辦人的[4GuysFromRolla.com](http://www.4guysfromrolla.com)。</span><span class="sxs-lookup"><span data-stu-id="ab640-365">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="ab640-366">Scott 以獨立的顧問、訓練員和作者的身分運作。</span><span class="sxs-lookup"><span data-stu-id="ab640-366">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="ab640-367">他的最新著作是[*在24小時內讓自己的 ASP.NET 2.0*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="ab640-367">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="ab640-368">他可以在mitchell@4GuysFromRolla.com觸達[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="ab640-368">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="ab640-369">或者透過他的 blog，可以在[http://ScottOnWriting.NET](http://ScottOnWriting.NET)找到。</span><span class="sxs-lookup"><span data-stu-id="ab640-369">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="ab640-370">特別感謝</span><span class="sxs-lookup"><span data-stu-id="ab640-370">Special Thanks To</span></span>

<span data-ttu-id="ab640-371">本教學課程系列已由許多有用的審核者所審查。</span><span class="sxs-lookup"><span data-stu-id="ab640-371">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="ab640-372">本教學課程的領導審查者是 David Suru。</span><span class="sxs-lookup"><span data-stu-id="ab640-372">Lead reviewer for this tutorial was David Suru.</span></span> <span data-ttu-id="ab640-373">有興趣複習我即將發行的 MSDN 文章嗎？</span><span class="sxs-lookup"><span data-stu-id="ab640-373">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="ab640-374">若是如此，請在mitchell@4GuysFromRolla.com的那一行下拉式[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="ab640-374">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="ab640-375">[上一頁](paging-report-data-in-a-datalist-or-repeater-control-cs.md)
> [下一頁](paging-report-data-in-a-datalist-or-repeater-control-vb.md)</span><span class="sxs-lookup"><span data-stu-id="ab640-375">[Previous](paging-report-data-in-a-datalist-or-repeater-control-cs.md)
[Next](paging-report-data-in-a-datalist-or-repeater-control-vb.md)</span></span>
