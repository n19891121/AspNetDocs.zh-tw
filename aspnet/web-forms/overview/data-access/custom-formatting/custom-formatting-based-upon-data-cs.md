---
uid: web-forms/overview/data-access/custom-formatting/custom-formatting-based-upon-data-cs
title: 以資料為基礎的自C#定義格式（） |Microsoft Docs
author: rick-anderson
description: 根據系結的資料來調整 GridView、DetailsView 或 FormView 的格式，可以透過多種方式來完成。 在本教學課程中，我們將 。
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 871a4574-f89c-4214-b786-79253ed3653b
msc.legacyurl: /web-forms/overview/data-access/custom-formatting/custom-formatting-based-upon-data-cs
msc.type: authoredcontent
ms.openlocfilehash: d8f3fa337eda0ceed041475ecb52f8b378b9fbba
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/28/2019
ms.locfileid: "74600770"
---
# <a name="custom-formatting-based-upon-data-c"></a><span data-ttu-id="84f8f-104">根據資料自訂格式設定 (C#)</span><span class="sxs-lookup"><span data-stu-id="84f8f-104">Custom Formatting Based Upon Data (C#)</span></span>

<span data-ttu-id="84f8f-105">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="84f8f-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="84f8f-106">[下載範例應用程式](https://download.microsoft.com/download/9/6/9/969e5c94-dfb6-4e47-9570-d6d9e704c3c1/ASPNET_Data_Tutorial_11_CS.exe)或[下載 PDF](custom-formatting-based-upon-data-cs/_static/datatutorial11cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="84f8f-106">[Download Sample App](https://download.microsoft.com/download/9/6/9/969e5c94-dfb6-4e47-9570-d6d9e704c3c1/ASPNET_Data_Tutorial_11_CS.exe) or [Download PDF](custom-formatting-based-upon-data-cs/_static/datatutorial11cs1.pdf)</span></span>

> <span data-ttu-id="84f8f-107">根據系結的資料來調整 GridView、DetailsView 或 FormView 的格式，可以透過多種方式來完成。</span><span class="sxs-lookup"><span data-stu-id="84f8f-107">Adjusting the format of the GridView, DetailsView, or FormView based upon the data bound to it can be accomplished in multiple ways.</span></span> <span data-ttu-id="84f8f-108">在本教學課程中，我們將探討如何透過使用資料系結和 RowDataBound 事件處理常式來完成資料系結格式設定。</span><span class="sxs-lookup"><span data-stu-id="84f8f-108">In this tutorial we'll look at how to accomplish data bound formatting through the use of the DataBound and RowDataBound event handlers.</span></span>

## <a name="introduction"></a><span data-ttu-id="84f8f-109">簡介</span><span class="sxs-lookup"><span data-stu-id="84f8f-109">Introduction</span></span>

<span data-ttu-id="84f8f-110">GridView、DetailsView 和 FormView 控制項的外觀，可以透過許多與樣式相關的屬性來自訂。</span><span class="sxs-lookup"><span data-stu-id="84f8f-110">The appearance of the GridView, DetailsView, and FormView controls can be customized through a myriad of style-related properties.</span></span> <span data-ttu-id="84f8f-111">`CssClass`、`Font`、`BorderWidth`、`BorderStyle`、`BorderColor`、`Width`和 `Height`等屬性會指示呈現控制項的一般外觀。</span><span class="sxs-lookup"><span data-stu-id="84f8f-111">Properties like `CssClass`, `Font`, `BorderWidth`, `BorderStyle`, `BorderColor`, `Width`, and `Height`, among others, dictate the general appearance of the rendered control.</span></span> <span data-ttu-id="84f8f-112">包括 `HeaderStyle`、`RowStyle`、`AlternatingRowStyle`和其他屬性，都允許將這些相同的樣式設定套用到特定區段。</span><span class="sxs-lookup"><span data-stu-id="84f8f-112">Properties including `HeaderStyle`, `RowStyle`, `AlternatingRowStyle`, and others allow these same style settings to be applied to particular sections.</span></span> <span data-ttu-id="84f8f-113">同樣地，您也可以在欄位層級套用這些樣式設定。</span><span class="sxs-lookup"><span data-stu-id="84f8f-113">Likewise, these style settings can be applied at the field level.</span></span>

<span data-ttu-id="84f8f-114">不過，在許多情況下，格式化需求取決於所顯示資料的值。</span><span class="sxs-lookup"><span data-stu-id="84f8f-114">In many scenarios though, the formatting requirements depend upon the value of the displayed data.</span></span> <span data-ttu-id="84f8f-115">例如，若要將注意力吸引出存貨產品，列出產品資訊的報表可能會將 `UnitsInStock` 和 `UnitsOnOrder` 欄位都等於0的產品的背景色彩設定為黃色。</span><span class="sxs-lookup"><span data-stu-id="84f8f-115">For example, to draw attention to out of stock products, a report listing product information might set the background color to yellow for those products whose `UnitsInStock` and `UnitsOnOrder` fields are both equal to 0.</span></span> <span data-ttu-id="84f8f-116">為了強調較昂貴的產品，我們可能會想要以粗體字型顯示這些產品的價格超過 $75.00 的成本。</span><span class="sxs-lookup"><span data-stu-id="84f8f-116">To highlight the more expensive products, we may want to display the prices of those products costing more than $75.00 in a bold font.</span></span>

<span data-ttu-id="84f8f-117">根據系結的資料來調整 GridView、DetailsView 或 FormView 的格式，可以透過多種方式來完成。</span><span class="sxs-lookup"><span data-stu-id="84f8f-117">Adjusting the format of the GridView, DetailsView, or FormView based upon the data bound to it can be accomplished in multiple ways.</span></span> <span data-ttu-id="84f8f-118">在本教學課程中，我們將探討如何使用 `DataBound` 和 `RowDataBound` 事件處理常式來完成資料系結格式設定。</span><span class="sxs-lookup"><span data-stu-id="84f8f-118">In this tutorial we'll look at how to accomplish data bound formatting through the use of the `DataBound` and `RowDataBound` event handlers.</span></span> <span data-ttu-id="84f8f-119">在下一個教學課程中，我們將探討另一種方法。</span><span class="sxs-lookup"><span data-stu-id="84f8f-119">In the next tutorial we'll explore an alternative approach.</span></span>

## <a name="using-the-detailsview-controlsdataboundevent-handler"></a><span data-ttu-id="84f8f-120">使用 DetailsView 控制項的`DataBound`事件處理常式</span><span class="sxs-lookup"><span data-stu-id="84f8f-120">Using the DetailsView Control's`DataBound`Event Handler</span></span>

<span data-ttu-id="84f8f-121">當資料系結至 DetailsView 時（從資料來源控制項，或透過程式設計方式將資料指派給控制項的 `DataSource` 屬性並呼叫其 `DataBind()` 方法），會發生下列一系列的步驟：</span><span class="sxs-lookup"><span data-stu-id="84f8f-121">When data is bound to a DetailsView, either from a data source control or through programmatically assigning data to the control's `DataSource` property and calling its `DataBind()` method, the following sequence of steps occur:</span></span>

1. <span data-ttu-id="84f8f-122">會引發資料 Web 控制項的 `DataBinding` 事件。</span><span class="sxs-lookup"><span data-stu-id="84f8f-122">The data Web control's `DataBinding` event fires.</span></span>
2. <span data-ttu-id="84f8f-123">資料會系結至資料 Web 控制項。</span><span class="sxs-lookup"><span data-stu-id="84f8f-123">The data is bound to the data Web control.</span></span>
3. <span data-ttu-id="84f8f-124">會引發資料 Web 控制項的 `DataBound` 事件。</span><span class="sxs-lookup"><span data-stu-id="84f8f-124">The data Web control's `DataBound` event fires.</span></span>

<span data-ttu-id="84f8f-125">自訂邏輯可以緊接在步驟1和3之後，透過事件處理常式插入。</span><span class="sxs-lookup"><span data-stu-id="84f8f-125">Custom logic can be injected immediately after steps 1 and 3 through an event handler.</span></span> <span data-ttu-id="84f8f-126">藉由建立 `DataBound` 事件的事件處理常式，我們可以程式設計方式判斷已系結至資料 Web 控制項的資料，並視需要調整格式。</span><span class="sxs-lookup"><span data-stu-id="84f8f-126">By creating an event handler for the `DataBound` event we can programmatically determine the data that has been bound to the data Web control and adjust the formatting as needed.</span></span> <span data-ttu-id="84f8f-127">為了說明這一點，讓我們建立一個 DetailsView，其中會列出產品的一般資訊，但會以***粗體的斜體字型***顯示 `UnitPrice` 值（如果超過 $75.00）。</span><span class="sxs-lookup"><span data-stu-id="84f8f-127">To illustrate this let's create a DetailsView that will list general information about a product, but will display the `UnitPrice` value in a ***bold, italic font*** if it exceeds $75.00.</span></span>

## <a name="step-1-displaying-the-product-information-in-a-detailsview"></a><span data-ttu-id="84f8f-128">步驟1：在 DetailsView 中顯示產品資訊</span><span class="sxs-lookup"><span data-stu-id="84f8f-128">Step 1: Displaying the Product Information in a DetailsView</span></span>

<span data-ttu-id="84f8f-129">開啟 [`CustomFormatting`] 資料夾中的 [`CustomColors.aspx`] 頁面，將 [DetailsView] 控制項從 [工具箱] 拖曳至設計工具，將其 [`ID`] 屬性值設定為 [`ExpensiveProductsPriceInBoldItalic`]，並將它系結至叫用 `ProductsBLL` 類別之 `GetProducts()` 方法的新 ObjectDataSource 控制項。</span><span class="sxs-lookup"><span data-stu-id="84f8f-129">Open the `CustomColors.aspx` page in the `CustomFormatting` folder, drag a DetailsView control from the Toolbox onto the Designer, set its `ID` property value to `ExpensiveProductsPriceInBoldItalic`, and bind it to a new ObjectDataSource control that invokes the `ProductsBLL` class's `GetProducts()` method.</span></span> <span data-ttu-id="84f8f-130">為了簡單起見，我們在此省略了完成這項操作的詳細步驟，因為我們會在先前的教學課程中詳細地檢查它們。</span><span class="sxs-lookup"><span data-stu-id="84f8f-130">The detailed steps for accomplishing this are omitted here for brevity since we examined them in detail in previous tutorials.</span></span>

<span data-ttu-id="84f8f-131">將 ObjectDataSource 系結至 DetailsView 之後，請花一點時間修改欄位清單。</span><span class="sxs-lookup"><span data-stu-id="84f8f-131">Once you've bound the ObjectDataSource to the DetailsView, take a moment to modify the field list.</span></span> <span data-ttu-id="84f8f-132">我選擇移除 `ProductID`、`SupplierID`、`CategoryID`、`UnitsInStock`、`UnitsOnOrder`、`ReorderLevel`和 `Discontinued` BoundFields，然後重新命名並重新格式化其餘 BoundFields。</span><span class="sxs-lookup"><span data-stu-id="84f8f-132">I've opted to remove the `ProductID`, `SupplierID`, `CategoryID`, `UnitsInStock`, `UnitsOnOrder`, `ReorderLevel`, and `Discontinued` BoundFields and renamed and reformatted the remaining BoundFields.</span></span> <span data-ttu-id="84f8f-133">我也清除了 `Width` 並 `Height` 設定。</span><span class="sxs-lookup"><span data-stu-id="84f8f-133">I also cleared out the `Width` and `Height` settings.</span></span> <span data-ttu-id="84f8f-134">因為 DetailsView 只會顯示一筆記錄，所以我們需要啟用分頁，才能讓終端使用者查看所有產品。</span><span class="sxs-lookup"><span data-stu-id="84f8f-134">Since the DetailsView displays only a single record, we need to enable paging in order to allow the end user to view all of the products.</span></span> <span data-ttu-id="84f8f-135">若要這麼做，請勾選 DetailsView 的智慧標籤中的 [啟用分頁] 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="84f8f-135">Do so by checking the Enable Paging checkbox in the DetailsView's smart tag.</span></span>

<span data-ttu-id="84f8f-136">[![核取 DetailsView 的智慧標籤中的 [啟用分頁] 核取方塊](custom-formatting-based-upon-data-cs/_static/image2.png)](custom-formatting-based-upon-data-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="84f8f-136">[![Check the Enable Paging Checkbox in the DetailsView's Smart Tag](custom-formatting-based-upon-data-cs/_static/image2.png)](custom-formatting-based-upon-data-cs/_static/image1.png)</span></span>

<span data-ttu-id="84f8f-137">**圖 1**：核取 DetailsView 的智慧標籤中的 [啟用分頁] 核取方塊（[按一下以查看完整大小的影像](custom-formatting-based-upon-data-cs/_static/image3.png)）</span><span class="sxs-lookup"><span data-stu-id="84f8f-137">**Figure 1**: Check the Enable Paging Checkbox in the DetailsView's Smart Tag ([Click to view full-size image](custom-formatting-based-upon-data-cs/_static/image3.png))</span></span>

<span data-ttu-id="84f8f-138">這些變更之後，DetailsView 標記會是：</span><span class="sxs-lookup"><span data-stu-id="84f8f-138">After these changes, the DetailsView markup will be:</span></span>

[!code-aspx[Main](custom-formatting-based-upon-data-cs/samples/sample1.aspx)]

<span data-ttu-id="84f8f-139">請花點時間在瀏覽器中測試此頁面。</span><span class="sxs-lookup"><span data-stu-id="84f8f-139">Take a moment to test out this page in your browser.</span></span>

<span data-ttu-id="84f8f-140">[![DetailsView 控制項一次顯示一項產品](custom-formatting-based-upon-data-cs/_static/image5.png)](custom-formatting-based-upon-data-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="84f8f-140">[![The DetailsView Control Displays One Product at a Time](custom-formatting-based-upon-data-cs/_static/image5.png)](custom-formatting-based-upon-data-cs/_static/image4.png)</span></span>

<span data-ttu-id="84f8f-141">**圖 2**： DetailsView 控制項一次顯示一項產品（[按一下以觀看完整大小的影像](custom-formatting-based-upon-data-cs/_static/image6.png)）</span><span class="sxs-lookup"><span data-stu-id="84f8f-141">**Figure 2**: The DetailsView Control Displays One Product at a Time ([Click to view full-size image](custom-formatting-based-upon-data-cs/_static/image6.png))</span></span>

## <a name="step-2-programmatically-determining-the-value-of-the-data-in-the-databound-event-handler"></a><span data-ttu-id="84f8f-142">步驟2：在資料系結事件處理常式中以程式設計方式決定資料的值</span><span class="sxs-lookup"><span data-stu-id="84f8f-142">Step 2: Programmatically Determining the Value of the Data in the DataBound Event Handler</span></span>

<span data-ttu-id="84f8f-143">為了以粗體、斜體字型顯示其 `UnitPrice` 值超過 $75.00 的價格，我們必須先能夠以程式設計方式判斷 `UnitPrice` 值。</span><span class="sxs-lookup"><span data-stu-id="84f8f-143">In order to display the price in a bold, italic font for those products whose `UnitPrice` value exceeds $75.00, we need to first be able to programmatically determine the `UnitPrice` value.</span></span> <span data-ttu-id="84f8f-144">針對 DetailsView，可以在 `DataBound` 事件處理常式中完成這項作業。</span><span class="sxs-lookup"><span data-stu-id="84f8f-144">For the DetailsView, this can be accomplished in the `DataBound` event handler.</span></span> <span data-ttu-id="84f8f-145">若要建立事件處理常式，請在設計工具中按一下 [DetailsView]，然後流覽至 [屬性視窗]。</span><span class="sxs-lookup"><span data-stu-id="84f8f-145">To create the event handler click on the DetailsView in the Designer then navigate to the Properties window.</span></span> <span data-ttu-id="84f8f-146">如果看不到，請按 F4，或移至 [View] 功能表，然後選取 [屬性視窗] 功能表選項。</span><span class="sxs-lookup"><span data-stu-id="84f8f-146">Press F4 to bring it up, if it's not visible, or go to the View menu and select the Properties Window menu option.</span></span> <span data-ttu-id="84f8f-147">從 屬性視窗中，按一下閃電圖示來列出 DetailsView 的事件。</span><span class="sxs-lookup"><span data-stu-id="84f8f-147">From the Properties window, click on the lightning bolt icon to list the DetailsView's events.</span></span> <span data-ttu-id="84f8f-148">接下來，按兩下 [`DataBound`] 事件，或輸入您想要建立的事件處理常式名稱。</span><span class="sxs-lookup"><span data-stu-id="84f8f-148">Next, either double-click the `DataBound` event or type in the name of the event handler you want to create.</span></span>

![建立資料系結事件的事件處理常式](custom-formatting-based-upon-data-cs/_static/image7.png)

<span data-ttu-id="84f8f-150">**圖 3**：建立 `DataBound` 事件的事件處理常式</span><span class="sxs-lookup"><span data-stu-id="84f8f-150">**Figure 3**: Create an Event Handler for the `DataBound` Event</span></span>

<span data-ttu-id="84f8f-151">這麼做會自動建立事件處理常式，並帶您前往已加入它的程式碼部分。</span><span class="sxs-lookup"><span data-stu-id="84f8f-151">Doing so will automatically create the event handler and take you to the code portion where it has been added.</span></span> <span data-ttu-id="84f8f-152">此時您會看到：</span><span class="sxs-lookup"><span data-stu-id="84f8f-152">At this point you will see:</span></span>

[!code-csharp[Main](custom-formatting-based-upon-data-cs/samples/sample2.cs)]

<span data-ttu-id="84f8f-153">系結至 DetailsView 的資料可以透過 `DataItem` 屬性來存取。</span><span class="sxs-lookup"><span data-stu-id="84f8f-153">The data bound to the DetailsView can be accessed via the `DataItem` property.</span></span> <span data-ttu-id="84f8f-154">回想一下，我們會將控制項系結至強型別 DataTable，這是由強型別 DataRow 實例的集合所組成。</span><span class="sxs-lookup"><span data-stu-id="84f8f-154">Recall that we are binding our controls to a strongly-typed DataTable, which is composed of a collection of strongly-typed DataRow instances.</span></span> <span data-ttu-id="84f8f-155">當 DataTable 系結至 DetailsView 時，DataTable 中的第一個 DataRow 會指派給 DetailsView 的 `DataItem` 屬性。</span><span class="sxs-lookup"><span data-stu-id="84f8f-155">When the DataTable is bound to the DetailsView, the first DataRow in the DataTable is assigned to the DetailsView's `DataItem` property.</span></span> <span data-ttu-id="84f8f-156">具體而言，`DataItem` 屬性會指派 `DataRowView` 物件。</span><span class="sxs-lookup"><span data-stu-id="84f8f-156">Specifically, the `DataItem` property is assigned a `DataRowView` object.</span></span> <span data-ttu-id="84f8f-157">我們可以使用 `DataRowView`的 `Row` 屬性來取得基礎 DataRow 物件的存取權，這實際上是 `ProductsRow` 實例。</span><span class="sxs-lookup"><span data-stu-id="84f8f-157">We can use the `DataRowView`'s `Row` property to get access to the underlying DataRow object, which is actually a `ProductsRow` instance.</span></span> <span data-ttu-id="84f8f-158">一旦有了這個 `ProductsRow` 實例，我們就可以直接檢查物件的屬性值來做出決定。</span><span class="sxs-lookup"><span data-stu-id="84f8f-158">Once we have this `ProductsRow` instance we can make our decision by simply inspecting the object's property values.</span></span>

<span data-ttu-id="84f8f-159">下列程式碼說明如何判斷系結至 DetailsView 控制項的 `UnitPrice` 值是否大於 $75.00：</span><span class="sxs-lookup"><span data-stu-id="84f8f-159">The following code illustrates how to determine whether the `UnitPrice` value bound to the DetailsView control is greater than $75.00:</span></span>

[!code-csharp[Main](custom-formatting-based-upon-data-cs/samples/sample3.cs)]

> [!NOTE]
> <span data-ttu-id="84f8f-160">由於 `UnitPrice` 在資料庫中可以有 `NULL` 值，因此我們會先檢查並確定我們不會處理 `NULL` 值，然後才存取 `ProductsRow`的 `UnitPrice` 屬性。</span><span class="sxs-lookup"><span data-stu-id="84f8f-160">Since `UnitPrice` can have a `NULL` value in the database, we first check to make sure that we're not dealing with a `NULL` value before accessing the `ProductsRow`'s `UnitPrice` property.</span></span> <span data-ttu-id="84f8f-161">這項檢查很重要，因為如果我們在具有 `NULL` 值時嘗試存取 `UnitPrice` 屬性，`ProductsRow` 物件將會擲回[system.data.strongtypingexception 例外](https://msdn.microsoft.com/library/system.data.strongtypingexception.aspx)狀況。</span><span class="sxs-lookup"><span data-stu-id="84f8f-161">This check is important because if we attempt to access the `UnitPrice` property when it has a `NULL` value the `ProductsRow` object will throw a [StrongTypingException exception](https://msdn.microsoft.com/library/system.data.strongtypingexception.aspx).</span></span>

## <a name="step-3-formatting-the-unitprice-value-in-the-detailsview"></a><span data-ttu-id="84f8f-162">步驟3：格式化 DetailsView 中的單價值</span><span class="sxs-lookup"><span data-stu-id="84f8f-162">Step 3: Formatting the UnitPrice Value in the DetailsView</span></span>

<span data-ttu-id="84f8f-163">此時，我們可以判斷系結至 DetailsView 的 `UnitPrice` 值是否有超過 $75.00 的值，但我們還不知道如何以程式設計方式調整 DetailsView 的格式。</span><span class="sxs-lookup"><span data-stu-id="84f8f-163">At this point we can determine whether the `UnitPrice` value bound to the DetailsView has a value that exceeds $75.00, but we've yet to see how to programmatically adjust the DetailsView's formatting accordingly.</span></span> <span data-ttu-id="84f8f-164">若要修改 DetailsView 中整個資料列的格式，請使用 `DetailsViewID.Rows[index]`以程式設計方式存取資料列。若要修改特定的資料格，請使用 `DetailsViewID.Rows[index].Cells[index]`的存取權。</span><span class="sxs-lookup"><span data-stu-id="84f8f-164">To modify the formatting of an entire row in the DetailsView, programmatically access the row using `DetailsViewID.Rows[index]`; to modify a particular cell, access use `DetailsViewID.Rows[index].Cells[index]`.</span></span> <span data-ttu-id="84f8f-165">一旦有了資料列或資料格的參考之後，就可以藉由設定其樣式相關的屬性來調整其外觀。</span><span class="sxs-lookup"><span data-stu-id="84f8f-165">Once we have a reference to the row or cell we can then adjust its appearance by setting its style-related properties.</span></span>

<span data-ttu-id="84f8f-166">以程式設計方式存取資料列時，您必須知道資料列的索引，其開頭為0。</span><span class="sxs-lookup"><span data-stu-id="84f8f-166">Accessing a row programmatically requires that you know the row's index, which starts at 0.</span></span> <span data-ttu-id="84f8f-167">`UnitPrice` 的資料列是 DetailsView 中的第五個數據列，並提供索引4，讓它以程式設計方式使用 `ExpensiveProductsPriceInBoldItalic.Rows[4]`來存取。</span><span class="sxs-lookup"><span data-stu-id="84f8f-167">The `UnitPrice` row is the fifth row in the DetailsView, giving it an index of 4 and making it programmatically accessible using `ExpensiveProductsPriceInBoldItalic.Rows[4]`.</span></span> <span data-ttu-id="84f8f-168">此時，我們可以使用下列程式碼，以粗體的斜體字型顯示整個資料列的內容：</span><span class="sxs-lookup"><span data-stu-id="84f8f-168">At this point we could have the entire row's content displayed in a bold, italic font by using the following code:</span></span>

[!code-csharp[Main](custom-formatting-based-upon-data-cs/samples/sample4.cs)]

<span data-ttu-id="84f8f-169">不過，這會讓標籤（價格）和*值為粗體*和斜體。</span><span class="sxs-lookup"><span data-stu-id="84f8f-169">However, this will make *both* the label (Price) and the value bold and italic.</span></span> <span data-ttu-id="84f8f-170">如果我們只想要將值設為粗體和斜體，我們必須將此格式套用到資料列中的第二個數據格，這可以使用下列方式來完成：</span><span class="sxs-lookup"><span data-stu-id="84f8f-170">If we want to make just the value bold and italic we need to apply this formatting to the second cell in the row, which can be accomplished using the following:</span></span>

[!code-csharp[Main](custom-formatting-based-upon-data-cs/samples/sample5.cs)]

<span data-ttu-id="84f8f-171">由於我們的教學課程已經使用樣式表單來維護轉譯的標記和樣式相關資訊之間的清楚分隔，而不是設定特定樣式屬性（如上所示），而是改用 CSS 類別。</span><span class="sxs-lookup"><span data-stu-id="84f8f-171">Since our tutorials thus far have used stylesheets to maintain a clean separation between the rendered markup and style-related information, rather than setting the specific style properties as shown above let's instead use a CSS class.</span></span> <span data-ttu-id="84f8f-172">開啟 `Styles.css` 樣式表單，並使用下列定義加入名為 `ExpensivePriceEmphasis` 的新 CSS 類別：</span><span class="sxs-lookup"><span data-stu-id="84f8f-172">Open the `Styles.css` stylesheet and add a new CSS class named `ExpensivePriceEmphasis` with the following definition:</span></span>

[!code-css[Main](custom-formatting-based-upon-data-cs/samples/sample6.css)]

<span data-ttu-id="84f8f-173">然後，在 `DataBound` 事件處理常式中，將儲存格的 `CssClass` 屬性設定為 [`ExpensivePriceEmphasis`]。</span><span class="sxs-lookup"><span data-stu-id="84f8f-173">Then, in the `DataBound` event handler, set the cell's `CssClass` property to `ExpensivePriceEmphasis`.</span></span> <span data-ttu-id="84f8f-174">下列程式碼會顯示完整的 `DataBound` 事件處理常式：</span><span class="sxs-lookup"><span data-stu-id="84f8f-174">The following code shows the `DataBound` event handler in its entirety:</span></span>

[!code-csharp[Main](custom-formatting-based-upon-data-cs/samples/sample7.cs)]

<span data-ttu-id="84f8f-175">當您觀看 Chai （成本低於 $75.00）時，價格會以一般字型顯示（請參閱 [圖 4]）。</span><span class="sxs-lookup"><span data-stu-id="84f8f-175">When viewing Chai, which costs less than $75.00, the price is displayed in a normal font (see Figure 4).</span></span> <span data-ttu-id="84f8f-176">不過，當您在 Mishi Kobe Niku （其價格為 $97.00）時，價格會以粗體的斜體字型顯示（請參閱 [圖 5]）。</span><span class="sxs-lookup"><span data-stu-id="84f8f-176">However, when viewing Mishi Kobe Niku, which has a price of $97.00, the price is displayed in a bold, italic font (see Figure 5).</span></span>

<span data-ttu-id="84f8f-177">[低於 $75.00 的 ![價格會以一般字型顯示](custom-formatting-based-upon-data-cs/_static/image9.png)](custom-formatting-based-upon-data-cs/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="84f8f-177">[![Prices Less than $75.00 are Displayed in a Normal Font](custom-formatting-based-upon-data-cs/_static/image9.png)](custom-formatting-based-upon-data-cs/_static/image8.png)</span></span>

<span data-ttu-id="84f8f-178">**圖 4**：小於 $75.00 的價格會以一般字型顯示（[按一下以觀看完整大小的影像](custom-formatting-based-upon-data-cs/_static/image10.png)）</span><span class="sxs-lookup"><span data-stu-id="84f8f-178">**Figure 4**: Prices Less than $75.00 are Displayed in a Normal Font ([Click to view full-size image](custom-formatting-based-upon-data-cs/_static/image10.png))</span></span>

<span data-ttu-id="84f8f-179">[![昂貴的產品價格會以粗體的斜體字型顯示](custom-formatting-based-upon-data-cs/_static/image12.png)](custom-formatting-based-upon-data-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="84f8f-179">[![Expensive Products' Prices are Displayed in a Bold, Italic Font](custom-formatting-based-upon-data-cs/_static/image12.png)](custom-formatting-based-upon-data-cs/_static/image11.png)</span></span>

<span data-ttu-id="84f8f-180">**圖 5**：昂貴的產品價格會以粗體的斜體字型顯示（[按一下以觀看完整大小的影像](custom-formatting-based-upon-data-cs/_static/image13.png)）</span><span class="sxs-lookup"><span data-stu-id="84f8f-180">**Figure 5**: Expensive Products' Prices are Displayed in a Bold, Italic Font ([Click to view full-size image](custom-formatting-based-upon-data-cs/_static/image13.png))</span></span>

## <a name="using-the-formview-controlsdataboundevent-handler"></a><span data-ttu-id="84f8f-181">使用 FormView 控制項的`DataBound`事件處理常式</span><span class="sxs-lookup"><span data-stu-id="84f8f-181">Using the FormView Control's`DataBound`Event Handler</span></span>

<span data-ttu-id="84f8f-182">判斷系結至 FormView 之基礎資料的步驟，與 DetailsView 建立 `DataBound` 事件處理常式、將 `DataItem` 屬性轉換成系結至控制項的適當物件類型，以及決定如何繼續。</span><span class="sxs-lookup"><span data-stu-id="84f8f-182">The steps for determining the underlying data bound to a FormView are identical to those for a DetailsView create a `DataBound` event handler, cast the `DataItem` property to the appropriate object type bound to the control, and determine how to proceed.</span></span> <span data-ttu-id="84f8f-183">不過，FormView 和 DetailsView 在其使用者介面外觀的更新方式上有所不同。</span><span class="sxs-lookup"><span data-stu-id="84f8f-183">The FormView and DetailsView differ, however, in how their user interface's appearance is updated.</span></span>

<span data-ttu-id="84f8f-184">FormView 不包含任何 BoundFields，因此缺少 `Rows` 集合。</span><span class="sxs-lookup"><span data-stu-id="84f8f-184">The FormView does not contain any BoundFields and therefore lacks the `Rows` collection.</span></span> <span data-ttu-id="84f8f-185">取而代之的是，FormView 是由樣板組成，這些範本可以混合使用靜態 HTML、Web 控制項和資料系結語法。</span><span class="sxs-lookup"><span data-stu-id="84f8f-185">Instead, a FormView is composed of templates, which can contain a mix of static HTML, Web controls, and databinding syntax.</span></span> <span data-ttu-id="84f8f-186">調整 FormView 的樣式通常牽涉到調整 FormView 範本內一個或多個 Web 控制項的樣式。</span><span class="sxs-lookup"><span data-stu-id="84f8f-186">Adjusting the style of a FormView typically involves adjusting the style of one or more of the Web controls within the FormView's templates.</span></span>

<span data-ttu-id="84f8f-187">為了說明這一點，讓我們使用 FormView 來列出上述範例中的產品，但這次讓我們只顯示產品名稱和庫存單位，其中包含以紅色字型顯示的單位（如果小於或等於10）。</span><span class="sxs-lookup"><span data-stu-id="84f8f-187">To illustrate this, let's use a FormView to list products like in the previous example, but this time let's display just the product name and units in stock with the units in stock displayed in a red font if it is less than or equal to 10.</span></span>

## <a name="step-4-displaying-the-product-information-in-a-formview"></a><span data-ttu-id="84f8f-188">步驟4：在 FormView 中顯示產品資訊</span><span class="sxs-lookup"><span data-stu-id="84f8f-188">Step 4: Displaying the Product Information in a FormView</span></span>

<span data-ttu-id="84f8f-189">將 FormView 加入至 DetailsView 底下的 [`CustomColors.aspx`] 頁面，並將其 [`ID`] 屬性設定為 [`LowStockedProductsInRed`]。</span><span class="sxs-lookup"><span data-stu-id="84f8f-189">Add a FormView to the `CustomColors.aspx` page beneath the DetailsView and set its `ID` property to `LowStockedProductsInRed`.</span></span> <span data-ttu-id="84f8f-190">將 FormView 系結至上一個步驟所建立的 ObjectDataSource 控制項。</span><span class="sxs-lookup"><span data-stu-id="84f8f-190">Bind the FormView to the ObjectDataSource control created from the previous step.</span></span> <span data-ttu-id="84f8f-191">這會建立 FormView 的 `ItemTemplate`、`EditItemTemplate`和 `InsertItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="84f8f-191">This will create an `ItemTemplate`, `EditItemTemplate`, and `InsertItemTemplate` for the FormView.</span></span> <span data-ttu-id="84f8f-192">移除 `EditItemTemplate` 並 `InsertItemTemplate` 並簡化 `ItemTemplate`，使其僅包含 `ProductName` 和 `UnitsInStock` 值，每個都在各自適當命名的標籤控制項中。</span><span class="sxs-lookup"><span data-stu-id="84f8f-192">Remove the `EditItemTemplate` and `InsertItemTemplate` and simplify the `ItemTemplate` to include just the `ProductName` and `UnitsInStock` values, each in their own appropriately-named Label controls.</span></span> <span data-ttu-id="84f8f-193">如同先前範例中的 DetailsView，另請核取 FormView 的智慧標籤中的 [啟用分頁] 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="84f8f-193">As with the DetailsView from the earlier example, also check the Enable Paging checkbox in the FormView's smart tag.</span></span>

<span data-ttu-id="84f8f-194">在這些編輯之後，您的 FormView 標記看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="84f8f-194">After these edits your FormView's markup should look similar to the following:</span></span>

[!code-aspx[Main](custom-formatting-based-upon-data-cs/samples/sample8.aspx)]

<span data-ttu-id="84f8f-195">請注意，`ItemTemplate` 包含：</span><span class="sxs-lookup"><span data-stu-id="84f8f-195">Note that the `ItemTemplate` contains:</span></span>

- <span data-ttu-id="84f8f-196">**靜態 HTML** ：「產品：」和「庫存中的單位」文字，以及 `<br />` 和 `<b>` 元素。</span><span class="sxs-lookup"><span data-stu-id="84f8f-196">**Static HTML** the text "Product:" and "Units In Stock:" along with the `<br />` and `<b>` elements.</span></span>
- <span data-ttu-id="84f8f-197">**Web 控制**兩個標籤控制項，`ProductNameLabel` 和 `UnitsInStockLabel`。</span><span class="sxs-lookup"><span data-stu-id="84f8f-197">**Web controls** the two Label controls, `ProductNameLabel` and `UnitsInStockLabel`.</span></span>
- <span data-ttu-id="84f8f-198">**資料**系結語法： `<%# Bind("ProductName") %>` 和 `<%# Bind("UnitsInStock") %>` 語法，會將這些欄位中的值指派給 Label 控制項的 `Text` 屬性。</span><span class="sxs-lookup"><span data-stu-id="84f8f-198">**Databinding syntax** the `<%# Bind("ProductName") %>` and `<%# Bind("UnitsInStock") %>` syntax, which assigns the values from these fields to the Label controls' `Text` properties.</span></span>

## <a name="step-5-programmatically-determining-the-value-of-the-data-in-the-databound-event-handler"></a><span data-ttu-id="84f8f-199">步驟5：在資料系結事件處理常式中以程式設計方式決定資料的值</span><span class="sxs-lookup"><span data-stu-id="84f8f-199">Step 5: Programmatically Determining the Value of the Data in the DataBound Event Handler</span></span>

<span data-ttu-id="84f8f-200">完成 FormView 的標記後，下一個步驟是以程式設計方式判斷 `UnitsInStock` 值是否小於或等於10。</span><span class="sxs-lookup"><span data-stu-id="84f8f-200">With the FormView's markup complete, the next step is to programmatically determine if the `UnitsInStock` value is less than or equal to 10.</span></span> <span data-ttu-id="84f8f-201">這是以 FormView 的相同方式來完成，如同使用 DetailsView 一樣。</span><span class="sxs-lookup"><span data-stu-id="84f8f-201">This is accomplished in the exact same manner with the FormView as it was with the DetailsView.</span></span> <span data-ttu-id="84f8f-202">首先，建立 FormView 的 `DataBound` 事件的事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="84f8f-202">Start by creating an event handler for the FormView's `DataBound` event.</span></span>

![建立資料系結事件處理常式](custom-formatting-based-upon-data-cs/_static/image14.png)

<span data-ttu-id="84f8f-204">**圖 6**：建立 `DataBound` 事件處理常式</span><span class="sxs-lookup"><span data-stu-id="84f8f-204">**Figure 6**: Create the `DataBound` Event Handler</span></span>

<span data-ttu-id="84f8f-205">在事件處理常式中，將 FormView 的 `DataItem` 屬性轉換成 `ProductsRow` 實例，並判斷 `UnitsInPrice` 值是否需要以紅色字型顯示。</span><span class="sxs-lookup"><span data-stu-id="84f8f-205">In the event handler cast the FormView's `DataItem` property to a `ProductsRow` instance and determine whether the `UnitsInPrice` value is such that we need to display it in a red font.</span></span>

[!code-csharp[Main](custom-formatting-based-upon-data-cs/samples/sample9.cs)]

## <a name="step-6-formatting-the-unitsinstocklabel-label-control-in-the-formviews-itemtemplate"></a><span data-ttu-id="84f8f-206">步驟6：格式化 FormView 的 ItemTemplate 中的 UnitsInStockLabel Label 控制項</span><span class="sxs-lookup"><span data-stu-id="84f8f-206">Step 6: Formatting the UnitsInStockLabel Label Control in the FormView's ItemTemplate</span></span>

<span data-ttu-id="84f8f-207">最後一個步驟是將顯示的 `UnitsInStock` 值格式化為紅色字型（如果值小於或等於10）。</span><span class="sxs-lookup"><span data-stu-id="84f8f-207">The final step is to format the displayed `UnitsInStock` value in a red font if the value is 10 or less.</span></span> <span data-ttu-id="84f8f-208">若要完成這項操作，我們需要以程式設計方式存取 `ItemTemplate` 中的 `UnitsInStockLabel` 控制項，並設定其樣式屬性，使其文字以紅色顯示。</span><span class="sxs-lookup"><span data-stu-id="84f8f-208">To accomplish this we need to programmatically access the `UnitsInStockLabel` control in the `ItemTemplate` and set its style properties so that its text is displayed in red.</span></span> <span data-ttu-id="84f8f-209">若要存取範本中的 Web 控制項，請使用 `FindControl("controlID")` 方法，如下所示：</span><span class="sxs-lookup"><span data-stu-id="84f8f-209">To access a Web control in a template, use the `FindControl("controlID")` method like this:</span></span>

[!code-csharp[Main](custom-formatting-based-upon-data-cs/samples/sample10.cs)]

<span data-ttu-id="84f8f-210">在我們的範例中，我們想要存取 `ID` 值 `UnitsInStockLabel`的標籤控制項，因此我們將使用：</span><span class="sxs-lookup"><span data-stu-id="84f8f-210">For our example we want to access a Label control whose `ID` value is `UnitsInStockLabel`, so we'd use:</span></span>

[!code-csharp[Main](custom-formatting-based-upon-data-cs/samples/sample11.cs)]

<span data-ttu-id="84f8f-211">一旦有了 Web 控制項的程式設計參考，我們就可以視需要修改其樣式相關的屬性。</span><span class="sxs-lookup"><span data-stu-id="84f8f-211">Once we have a programmatic reference to the Web control, we can modify its style-related properties as needed.</span></span> <span data-ttu-id="84f8f-212">如同先前的範例，我已在名為 `LowUnitsInStockEmphasis`的 `Styles.css` 中建立 CSS 類別。</span><span class="sxs-lookup"><span data-stu-id="84f8f-212">As with the earlier example, I've created a CSS class in `Styles.css` named `LowUnitsInStockEmphasis`.</span></span> <span data-ttu-id="84f8f-213">若要將此樣式套用至標籤 Web 控制項，請據以設定其 `CssClass` 屬性。</span><span class="sxs-lookup"><span data-stu-id="84f8f-213">To apply this style to the Label Web control, set its `CssClass` property accordingly.</span></span>

[!code-csharp[Main](custom-formatting-based-upon-data-cs/samples/sample12.cs)]

> [!NOTE]
> <span data-ttu-id="84f8f-214">在 DetailsView 或 GridView 控制項中使用[TemplateFields](https://msdn.microsoft.com/library/system.web.ui.webcontrols.templatefield(VS.80).aspx)時，也可以使用以程式設計方式來格式化範本，並使用 `FindControl("controlID")` 然後設定其樣式相關屬性的語法。</span><span class="sxs-lookup"><span data-stu-id="84f8f-214">The syntax for formatting a template programmatically accessing the Web control using `FindControl("controlID")` and then setting its style-related properties can also be used when using [TemplateFields](https://msdn.microsoft.com/library/system.web.ui.webcontrols.templatefield(VS.80).aspx) in the DetailsView or GridView controls.</span></span> <span data-ttu-id="84f8f-215">我們會在下一個教學課程中檢查 TemplateFields。</span><span class="sxs-lookup"><span data-stu-id="84f8f-215">We'll examine TemplateFields in our next tutorial.</span></span>

<span data-ttu-id="84f8f-216">[圖 7] 顯示 FormView 在觀看產品時，其 `UnitsInStock` 值大於10，而 [圖 8] 中的產品值小於10。</span><span class="sxs-lookup"><span data-stu-id="84f8f-216">Figures 7 shows the FormView when viewing a product whose `UnitsInStock` value is greater than 10, while the product in Figure 8 has its value less than 10.</span></span>

<span data-ttu-id="84f8f-217">[![在庫存中具有夠大單位的產品，則不會套用任何自訂格式](custom-formatting-based-upon-data-cs/_static/image16.png)](custom-formatting-based-upon-data-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="84f8f-217">[![For Products With a Sufficiently Large Units In Stock, No Custom Formatting is Applied](custom-formatting-based-upon-data-cs/_static/image16.png)](custom-formatting-based-upon-data-cs/_static/image15.png)</span></span>

<span data-ttu-id="84f8f-218">**圖 7**：對於具有足夠大單位庫存的產品，不會套用任何自訂格式（[按一下以觀看完整大小的影像](custom-formatting-based-upon-data-cs/_static/image17.png)）</span><span class="sxs-lookup"><span data-stu-id="84f8f-218">**Figure 7**: For Products With a Sufficiently Large Units In Stock, No Custom Formatting is Applied ([Click to view full-size image](custom-formatting-based-upon-data-cs/_static/image17.png))</span></span>

<span data-ttu-id="84f8f-219">[![值為10（含）以下的產品的庫存號碼單位會以紅色顯示](custom-formatting-based-upon-data-cs/_static/image19.png)](custom-formatting-based-upon-data-cs/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="84f8f-219">[![The Units in Stock Number is Shown in Red for Those Products With Values of 10 or Less](custom-formatting-based-upon-data-cs/_static/image19.png)](custom-formatting-based-upon-data-cs/_static/image18.png)</span></span>

<span data-ttu-id="84f8f-220">**圖 8**：庫存號碼中的單位會以紅色顯示，這些產品的值為10或更小（[按一下以觀看完整大小的影像](custom-formatting-based-upon-data-cs/_static/image20.png)）</span><span class="sxs-lookup"><span data-stu-id="84f8f-220">**Figure 8**: The Units in Stock Number is Shown in Red for Those Products With Values of 10 or Less ([Click to view full-size image](custom-formatting-based-upon-data-cs/_static/image20.png))</span></span>

## <a name="formatting-with-the-gridviewsrowdataboundevent"></a><span data-ttu-id="84f8f-221">使用 GridView 的`RowDataBound`事件進行格式設定</span><span class="sxs-lookup"><span data-stu-id="84f8f-221">Formatting with the GridView's`RowDataBound`Event</span></span>

<span data-ttu-id="84f8f-222">我們稍早在資料系結期間檢查了 DetailsView 和 FormView 控制進度的步驟順序。</span><span class="sxs-lookup"><span data-stu-id="84f8f-222">Earlier we examined the sequence of steps the DetailsView and FormView controls progress through during databinding.</span></span> <span data-ttu-id="84f8f-223">讓我們再次檢查一下這些步驟，做為重新整理程式。</span><span class="sxs-lookup"><span data-stu-id="84f8f-223">Let's look over these steps once again as a refresher.</span></span>

1. <span data-ttu-id="84f8f-224">會引發資料 Web 控制項的 `DataBinding` 事件。</span><span class="sxs-lookup"><span data-stu-id="84f8f-224">The data Web control's `DataBinding` event fires.</span></span>
2. <span data-ttu-id="84f8f-225">資料會系結至資料 Web 控制項。</span><span class="sxs-lookup"><span data-stu-id="84f8f-225">The data is bound to the data Web control.</span></span>
3. <span data-ttu-id="84f8f-226">會引發資料 Web 控制項的 `DataBound` 事件。</span><span class="sxs-lookup"><span data-stu-id="84f8f-226">The data Web control's `DataBound` event fires.</span></span>

<span data-ttu-id="84f8f-227">這三個簡單的步驟就足以進行 DetailsView 和 FormView，因為它們只會顯示一筆記錄。</span><span class="sxs-lookup"><span data-stu-id="84f8f-227">These three simple steps are sufficient for the DetailsView and FormView because they display only a single record.</span></span> <span data-ttu-id="84f8f-228">針對 GridView，會顯示系結至它的*所有*記錄（而不只是第一個），步驟2則比較複雜。</span><span class="sxs-lookup"><span data-stu-id="84f8f-228">For the GridView, which displays *all* records bound to it (not just the first), step 2 is a bit more involved.</span></span>

<span data-ttu-id="84f8f-229">在步驟2中，GridView 會列舉資料來源，而針對每一筆記錄，會建立一個 `GridViewRow` 實例，並將目前的記錄系結至它。</span><span class="sxs-lookup"><span data-stu-id="84f8f-229">In step 2 the GridView enumerates the data source and, for each record, creates a `GridViewRow` instance and binds the current record to it.</span></span> <span data-ttu-id="84f8f-230">針對加入至 GridView 的每個 `GridViewRow`，會引發兩個事件：</span><span class="sxs-lookup"><span data-stu-id="84f8f-230">For each `GridViewRow` added to the GridView, two events are raised:</span></span>

- <span data-ttu-id="84f8f-231">建立 `GridViewRow` 之後， **`RowCreated`** 引發</span><span class="sxs-lookup"><span data-stu-id="84f8f-231">**`RowCreated`** fires after the `GridViewRow` has been created</span></span>
- <span data-ttu-id="84f8f-232">**`RowDataBound`** 在目前的記錄已系結至 `GridViewRow`之後引發。</span><span class="sxs-lookup"><span data-stu-id="84f8f-232">**`RowDataBound`** fires after the current record has been bound to the `GridViewRow`.</span></span>

<span data-ttu-id="84f8f-233">就 GridView 而言，資料系結會更準確地由下列一系列的步驟來描述：</span><span class="sxs-lookup"><span data-stu-id="84f8f-233">For the GridView, then, data binding is more accurately described by the following sequence of steps:</span></span>

1. <span data-ttu-id="84f8f-234">GridView 的 `DataBinding` 事件會引發。</span><span class="sxs-lookup"><span data-stu-id="84f8f-234">The GridView's `DataBinding` event fires.</span></span>
2. <span data-ttu-id="84f8f-235">資料會系結至 GridView。</span><span class="sxs-lookup"><span data-stu-id="84f8f-235">The data is bound to the GridView.</span></span>   
  
   <span data-ttu-id="84f8f-236">針對資料來源中的每筆記錄</span><span class="sxs-lookup"><span data-stu-id="84f8f-236">For each record in the data source</span></span> 

    1. <span data-ttu-id="84f8f-237">建立 `GridViewRow` 物件</span><span class="sxs-lookup"><span data-stu-id="84f8f-237">Create a `GridViewRow` object</span></span>
    2. <span data-ttu-id="84f8f-238">引發 `RowCreated` 事件</span><span class="sxs-lookup"><span data-stu-id="84f8f-238">Fire the `RowCreated` event</span></span>
    3. <span data-ttu-id="84f8f-239">將記錄系結至 `GridViewRow`</span><span class="sxs-lookup"><span data-stu-id="84f8f-239">Bind the record to the `GridViewRow`</span></span>
    4. <span data-ttu-id="84f8f-240">引發 `RowDataBound` 事件</span><span class="sxs-lookup"><span data-stu-id="84f8f-240">Fire the `RowDataBound` event</span></span>
    5. <span data-ttu-id="84f8f-241">將 `GridViewRow` 新增至 `Rows` 集合</span><span class="sxs-lookup"><span data-stu-id="84f8f-241">Add the `GridViewRow` to the `Rows` collection</span></span>
3. <span data-ttu-id="84f8f-242">GridView 的 `DataBound` 事件會引發。</span><span class="sxs-lookup"><span data-stu-id="84f8f-242">The GridView's `DataBound` event fires.</span></span>

<span data-ttu-id="84f8f-243">若要自訂 GridView 個別記錄的格式，我們必須建立 `RowDataBound` 事件的事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="84f8f-243">To customize the format of the GridView's individual records, then, we need to create an event handler for the `RowDataBound` event.</span></span> <span data-ttu-id="84f8f-244">為了說明這一點，讓我們將 GridView 新增至 [`CustomColors.aspx`] 頁面，其中列出每個產品的名稱、類別和價格，並以黃色的背景色彩反白顯示價格小於 $10.00 的產品。</span><span class="sxs-lookup"><span data-stu-id="84f8f-244">To illustrate this, let's add a GridView to the `CustomColors.aspx` page that lists the name, category, and price for each product, highlighting those products whose price is less than $10.00 with a yellow background color.</span></span>

## <a name="step-7-displaying-product-information-in-a-gridview"></a><span data-ttu-id="84f8f-245">步驟7：在 GridView 中顯示產品資訊</span><span class="sxs-lookup"><span data-stu-id="84f8f-245">Step 7: Displaying Product Information in a GridView</span></span>

<span data-ttu-id="84f8f-246">在先前範例中的 FormView 底下新增 GridView，並將其 `ID` 屬性設為 `HighlightCheapProducts`。</span><span class="sxs-lookup"><span data-stu-id="84f8f-246">Add a GridView beneath the FormView from the previous example and set its `ID` property to `HighlightCheapProducts`.</span></span> <span data-ttu-id="84f8f-247">因為我們已經有一個會傳回頁面上所有產品的 ObjectDataSource，所以請將 GridView 系結至該頁面。</span><span class="sxs-lookup"><span data-stu-id="84f8f-247">Since we already have an ObjectDataSource that returns all products on the page, bind the GridView to that.</span></span> <span data-ttu-id="84f8f-248">最後，編輯 GridView 的 BoundFields，只包含產品的名稱、類別和價格。</span><span class="sxs-lookup"><span data-stu-id="84f8f-248">Finally, edit the GridView's BoundFields to include just the products' names, categories, and prices.</span></span> <span data-ttu-id="84f8f-249">在這些編輯之後，GridView 的標記看起來應該像這樣：</span><span class="sxs-lookup"><span data-stu-id="84f8f-249">After these edits the GridView's markup should look like:</span></span>

[!code-aspx[Main](custom-formatting-based-upon-data-cs/samples/sample13.aspx)]

<span data-ttu-id="84f8f-250">[圖 9] 顯示透過瀏覽器觀看此點的進度。</span><span class="sxs-lookup"><span data-stu-id="84f8f-250">Figure 9 shows our progress to this point when viewed through a browser.</span></span>

<span data-ttu-id="84f8f-251">[![GridView 會列出每個產品的名稱、類別和價格](custom-formatting-based-upon-data-cs/_static/image22.png)](custom-formatting-based-upon-data-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="84f8f-251">[![The GridView Lists the Name, Category, and Price For Each Product](custom-formatting-based-upon-data-cs/_static/image22.png)](custom-formatting-based-upon-data-cs/_static/image21.png)</span></span>

<span data-ttu-id="84f8f-252">**圖 9**： GridView 會列出每個產品的名稱、類別和價格（[按一下以查看完整大小的影像](custom-formatting-based-upon-data-cs/_static/image23.png)）</span><span class="sxs-lookup"><span data-stu-id="84f8f-252">**Figure 9**: The GridView Lists the Name, Category, and Price For Each Product ([Click to view full-size image](custom-formatting-based-upon-data-cs/_static/image23.png))</span></span>

## <a name="step-8-programmatically-determining-the-value-of-the-data-in-the-rowdatabound-event-handler"></a><span data-ttu-id="84f8f-253">步驟8：以程式設計方式判斷 RowDataBound 事件處理常式中的資料值</span><span class="sxs-lookup"><span data-stu-id="84f8f-253">Step 8: Programmatically Determining the Value of the Data in the RowDataBound Event Handler</span></span>

<span data-ttu-id="84f8f-254">當 `ProductsDataTable` 系結至 GridView 時，會列舉其 `ProductsRow` 實例，並針對每個 `ProductsRow` 建立 `GridViewRow`。</span><span class="sxs-lookup"><span data-stu-id="84f8f-254">When the `ProductsDataTable` is bound to the GridView its `ProductsRow` instances are enumerated and for each `ProductsRow` a `GridViewRow` is created.</span></span> <span data-ttu-id="84f8f-255">`GridViewRow`的 `DataItem` 屬性會指派給特定的 `ProductRow`，在此之後，會引發 GridView 的 `RowDataBound` 事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="84f8f-255">The `GridViewRow`'s `DataItem` property is assigned to the particular `ProductRow`, after which the GridView's `RowDataBound` event handler is raised.</span></span> <span data-ttu-id="84f8f-256">若要判斷系結至 GridView 之每個產品的 `UnitPrice` 值，則需要為 GridView 的 `RowDataBound` 事件建立事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="84f8f-256">To determine the `UnitPrice` value for each product bound to the GridView, then, we need to create an event handler for the GridView's `RowDataBound` event.</span></span> <span data-ttu-id="84f8f-257">在這個事件處理常式中，我們可以檢查目前 `GridViewRow` 的 `UnitPrice` 值，並針對該資料列進行格式設定決策。</span><span class="sxs-lookup"><span data-stu-id="84f8f-257">In this event handler we can inspect the `UnitPrice` value for the current `GridViewRow` and make a formatting decision for that row.</span></span>

<span data-ttu-id="84f8f-258">您可以使用與 FormView 和 DetailsView 相同的一系列步驟來建立這個事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="84f8f-258">This event handler can be created using the same series of steps as with the FormView and DetailsView.</span></span>

![建立 GridView RowDataBound 事件的事件處理常式](custom-formatting-based-upon-data-cs/_static/image24.png)

<span data-ttu-id="84f8f-260">**圖 10**：為 GridView 的 `RowDataBound` 事件建立事件處理常式</span><span class="sxs-lookup"><span data-stu-id="84f8f-260">**Figure 10**: Create an Event Handler for the GridView's `RowDataBound` Event</span></span>

<span data-ttu-id="84f8f-261">以這種方式建立事件處理常式，會將下列程式碼自動新增至 ASP.NET 網頁的程式碼部分：</span><span class="sxs-lookup"><span data-stu-id="84f8f-261">Creating the event handler in this manner will cause the following code to be automatically added to the ASP.NET page's code portion:</span></span>

[!code-csharp[Main](custom-formatting-based-upon-data-cs/samples/sample14.cs)]

<span data-ttu-id="84f8f-262">當 `RowDataBound` 事件引發時，事件處理常式會當做第二個參數類型的物件傳遞 `GridViewRowEventArgs`，其具有名為 `Row`的屬性。</span><span class="sxs-lookup"><span data-stu-id="84f8f-262">When the `RowDataBound` event fires, the event handler is passed as its second parameter an object of type `GridViewRowEventArgs`, which has a property named `Row`.</span></span> <span data-ttu-id="84f8f-263">這個屬性會傳回只是資料系結之 `GridViewRow` 的參考。</span><span class="sxs-lookup"><span data-stu-id="84f8f-263">This property returns a reference to the `GridViewRow` that was just data bound.</span></span> <span data-ttu-id="84f8f-264">若要存取系結至 `GridViewRow` 的 `ProductsRow` 實例，我們使用 `DataItem` 屬性，如下所示：</span><span class="sxs-lookup"><span data-stu-id="84f8f-264">To access the `ProductsRow` instance bound to the `GridViewRow` we use the `DataItem` property like so:</span></span>

[!code-csharp[Main](custom-formatting-based-upon-data-cs/samples/sample15.cs)]

<span data-ttu-id="84f8f-265">使用 `RowDataBound` 事件處理常式時，請務必記住 GridView 是由不同類型的資料列所組成，而且會針對*所有*資料列類型引發此事件。</span><span class="sxs-lookup"><span data-stu-id="84f8f-265">When working with the `RowDataBound` event handler it is important to keep in mind that the GridView is composed of different types of rows and that this event is fired for *all* row types.</span></span> <span data-ttu-id="84f8f-266">`GridViewRow`的型別可以透過其 `RowType` 屬性來決定，而且可以有其中一個可能的值：</span><span class="sxs-lookup"><span data-stu-id="84f8f-266">A `GridViewRow`'s type can be determined by its `RowType` property, and can have one of the possible values:</span></span>

- <span data-ttu-id="84f8f-267">`DataRow` 從 GridView 的 `DataSource` 系結至記錄的資料列</span><span class="sxs-lookup"><span data-stu-id="84f8f-267">`DataRow` a row that is bound to a record from the GridView's `DataSource`</span></span>
- <span data-ttu-id="84f8f-268">`EmptyDataRow` GridView 的 `DataSource` 為空白時所顯示的資料列</span><span class="sxs-lookup"><span data-stu-id="84f8f-268">`EmptyDataRow` the row displayed if the GridView's `DataSource` is empty</span></span>
- <span data-ttu-id="84f8f-269">`Footer` 頁尾資料列;當 GridView 的 `ShowFooter` 屬性設定為時顯示 `true`</span><span class="sxs-lookup"><span data-stu-id="84f8f-269">`Footer` the footer row; shown if the GridView's `ShowFooter` property is set to `true`</span></span>
- <span data-ttu-id="84f8f-270">`Header` 標頭資料列;如果 GridView 的 ShowHeader 屬性設定為 `true` （預設值），則會顯示</span><span class="sxs-lookup"><span data-stu-id="84f8f-270">`Header` the header row; shown if the GridView's ShowHeader property is set to `true` (the default)</span></span>
- <span data-ttu-id="84f8f-271">適用于執行分頁之 GridView 的 `Pager`，顯示分頁介面的資料列</span><span class="sxs-lookup"><span data-stu-id="84f8f-271">`Pager` for GridView's that implement paging, the row that displays the paging interface</span></span>
- <span data-ttu-id="84f8f-272">`Separator` 不是用於 GridView，而是由 DataList 和重複項控制項的 `RowType` 屬性使用，我們將在未來的教學課程中討論兩個數據 Web 控制項</span><span class="sxs-lookup"><span data-stu-id="84f8f-272">`Separator` not used for the GridView, but used by the `RowType` properties for the DataList and Repeater controls, two data Web controls we'll discuss in future tutorials</span></span>

<span data-ttu-id="84f8f-273">由於 `EmptyDataRow`、`Header`、`Footer`和 `Pager` 資料列不會與 `DataSource` 記錄相關聯，因此它們的 `null` 屬性一律會有 `DataItem` 的值。</span><span class="sxs-lookup"><span data-stu-id="84f8f-273">Since the `EmptyDataRow`, `Header`, `Footer`, and `Pager` rows aren't associated with a `DataSource` record, they will always have a `null` value for their `DataItem` property.</span></span> <span data-ttu-id="84f8f-274">基於這個理由，在嘗試使用目前 `GridViewRow`的 `DataItem` 屬性之前，我們必須先確定我們正在處理 `DataRow`。</span><span class="sxs-lookup"><span data-stu-id="84f8f-274">For this reason, before attempting to work with the current `GridViewRow`'s `DataItem` property, we first must make sure that we're dealing with a `DataRow`.</span></span> <span data-ttu-id="84f8f-275">這可以藉由檢查 `GridViewRow`的 `RowType` 屬性來完成，如下所示：</span><span class="sxs-lookup"><span data-stu-id="84f8f-275">This can be accomplished by checking the `GridViewRow`'s `RowType` property like so:</span></span>

[!code-csharp[Main](custom-formatting-based-upon-data-cs/samples/sample16.cs)]

## <a name="step-9-highlighting-the-row-yellow-when-the-unitprice-value-is-less-than-1000"></a><span data-ttu-id="84f8f-276">步驟9：當單價值小於 $10.00 時，將資料列反白顯示為黃色</span><span class="sxs-lookup"><span data-stu-id="84f8f-276">Step 9: Highlighting the Row Yellow When the UnitPrice Value is Less than $10.00</span></span>

<span data-ttu-id="84f8f-277">最後一個步驟是，如果該資料列的 `UnitPrice` 值小於 $10.00，以程式設計方式反白顯示整個 `GridViewRow`。</span><span class="sxs-lookup"><span data-stu-id="84f8f-277">The last step is to programmatically highlight the entire `GridViewRow` if the `UnitPrice` value for that row is less than $10.00.</span></span> <span data-ttu-id="84f8f-278">存取 GridView 的資料列或資料格的語法與 DetailsView `GridViewID.Rows[index]` 用來存取整個資料列，`GridViewID.Rows[index].Cells[index]` 存取特定的資料格。</span><span class="sxs-lookup"><span data-stu-id="84f8f-278">The syntax for accessing a GridView's rows or cells is the same as with the DetailsView `GridViewID.Rows[index]` to access the entire row, `GridViewID.Rows[index].Cells[index]` to access a particular cell.</span></span> <span data-ttu-id="84f8f-279">不過，當 `RowDataBound` 事件處理常式引發資料系結 `GridViewRow` 尚未加入 GridView 的 `Rows` 集合。</span><span class="sxs-lookup"><span data-stu-id="84f8f-279">However, when the `RowDataBound` event handler fires the data bound `GridViewRow` has yet to be added to the GridView's `Rows` collection.</span></span> <span data-ttu-id="84f8f-280">因此，您無法使用 Rows 集合，從 `RowDataBound` 事件處理常式存取目前的 `GridViewRow` 實例。</span><span class="sxs-lookup"><span data-stu-id="84f8f-280">Therefore you cannot access the current `GridViewRow` instance from the `RowDataBound` event handler using the Rows collection.</span></span>

<span data-ttu-id="84f8f-281">我們可以使用 `e.Row`來參考 `RowDataBound` 事件處理常式中目前的 `GridViewRow` 實例，而不是 `GridViewID.Rows[index]`。</span><span class="sxs-lookup"><span data-stu-id="84f8f-281">Instead of `GridViewID.Rows[index]`, we can reference the current `GridViewRow` instance in the `RowDataBound` event handler using `e.Row`.</span></span> <span data-ttu-id="84f8f-282">也就是說，若要從我們要使用的 `RowDataBound` 事件處理常式中反白顯示目前的 `GridViewRow` 實例：</span><span class="sxs-lookup"><span data-stu-id="84f8f-282">That is, in order to highlight the current `GridViewRow` instance from the `RowDataBound` event handler we would use:</span></span>

[!code-csharp[Main](custom-formatting-based-upon-data-cs/samples/sample17.cs)]

<span data-ttu-id="84f8f-283">我們不會直接設定 `GridViewRow`的 `BackColor` 屬性，而是使用 CSS 類別。</span><span class="sxs-lookup"><span data-stu-id="84f8f-283">Rather than set the `GridViewRow`'s `BackColor` property directly, let's stick with using CSS classes.</span></span> <span data-ttu-id="84f8f-284">我建立了一個名為 `AffordablePriceEmphasis` 的 CSS 類別，將背景色彩設定為黃色。</span><span class="sxs-lookup"><span data-stu-id="84f8f-284">I've created a CSS class named `AffordablePriceEmphasis` that sets the background color to yellow.</span></span> <span data-ttu-id="84f8f-285">完成的 `RowDataBound` 事件處理常式如下：</span><span class="sxs-lookup"><span data-stu-id="84f8f-285">The completed `RowDataBound` event handler follows:</span></span>

[!code-csharp[Main](custom-formatting-based-upon-data-cs/samples/sample18.cs)]

<span data-ttu-id="84f8f-286">[![最實惠的產品會以黃色反白顯示](custom-formatting-based-upon-data-cs/_static/image26.png)](custom-formatting-based-upon-data-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="84f8f-286">[![The Most Affordable Products are Highlighted Yellow](custom-formatting-based-upon-data-cs/_static/image26.png)](custom-formatting-based-upon-data-cs/_static/image25.png)</span></span>

<span data-ttu-id="84f8f-287">**圖 11**：最經濟實惠的產品會以黃色反白顯示（[按一下以觀看完整大小的影像](custom-formatting-based-upon-data-cs/_static/image27.png)）</span><span class="sxs-lookup"><span data-stu-id="84f8f-287">**Figure 11**: The Most Affordable Products are Highlighted Yellow ([Click to view full-size image](custom-formatting-based-upon-data-cs/_static/image27.png))</span></span>

## <a name="summary"></a><span data-ttu-id="84f8f-288">總結</span><span class="sxs-lookup"><span data-stu-id="84f8f-288">Summary</span></span>

<span data-ttu-id="84f8f-289">在本教學課程中，我們已瞭解如何根據系結至控制項的資料來格式化 GridView、DetailsView 和 FormView。</span><span class="sxs-lookup"><span data-stu-id="84f8f-289">In this tutorial we saw how to format the GridView, DetailsView, and FormView based on the data bound to the control.</span></span> <span data-ttu-id="84f8f-290">為了達成此目的，我們建立了 `DataBound` 或 `RowDataBound` 事件的事件處理常式，其中基礎資料會與格式變更一起檢查（如有需要）。</span><span class="sxs-lookup"><span data-stu-id="84f8f-290">To accomplish this we created an event handler for the `DataBound` or `RowDataBound` events, where the underlying data was examined along with a formatting change, if needed.</span></span> <span data-ttu-id="84f8f-291">若要存取系結至 DetailsView 或 FormView 的資料，我們會在 `DataBound` 事件處理常式中使用 `DataItem` 屬性;就 GridView 而言，每個 `GridViewRow` 實例的 `DataItem` 屬性都會包含系結至該資料列的資料，而這可在 `RowDataBound` 事件處理常式中使用。</span><span class="sxs-lookup"><span data-stu-id="84f8f-291">To access the data bound to a DetailsView or FormView, we use the `DataItem` property in the `DataBound` event handler; for a GridView, each `GridViewRow` instance's `DataItem` property contains the data bound to that row, which is available in the `RowDataBound` event handler.</span></span>

<span data-ttu-id="84f8f-292">以程式設計方式調整資料 Web 控制項的格式的語法，取決於 Web 控制項以及如何顯示要格式化的資料。</span><span class="sxs-lookup"><span data-stu-id="84f8f-292">The syntax for programmatically adjusting the data Web control's formatting depends upon the Web control and how the data to be formatted is displayed.</span></span> <span data-ttu-id="84f8f-293">對於 DetailsView 和 GridView 控制項，資料列和資料格可以透過序數索引來存取。</span><span class="sxs-lookup"><span data-stu-id="84f8f-293">For DetailsView and GridView controls, the rows and cells can be accessed by an ordinal index.</span></span> <span data-ttu-id="84f8f-294">針對使用範本的 FormView，`FindControl("controlID")` 方法通常用來從範本內尋找 Web 控制項。</span><span class="sxs-lookup"><span data-stu-id="84f8f-294">For the FormView, which uses templates, the `FindControl("controlID")` method is commonly used to locate a Web control from within the template.</span></span>

<span data-ttu-id="84f8f-295">在下一個教學課程中，我們將探討如何使用具有 GridView 和 DetailsView 的範本。</span><span class="sxs-lookup"><span data-stu-id="84f8f-295">In the next tutorial we'll look at how to use templates with the GridView and DetailsView.</span></span> <span data-ttu-id="84f8f-296">此外，我們還會看到另一項技術，可讓您根據基礎資料自訂格式。</span><span class="sxs-lookup"><span data-stu-id="84f8f-296">Additionally, we'll see another technique for customizing the formatting based on the underlying data.</span></span>

<span data-ttu-id="84f8f-297">快樂的程式設計！</span><span class="sxs-lookup"><span data-stu-id="84f8f-297">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="84f8f-298">關於作者</span><span class="sxs-lookup"><span data-stu-id="84f8f-298">About the Author</span></span>

<span data-ttu-id="84f8f-299">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，自1998起，有七個 ASP/ASP. NET 書籍和創辦人的[4GuysFromRolla.com](http://www.4guysfromrolla.com)。</span><span class="sxs-lookup"><span data-stu-id="84f8f-299">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="84f8f-300">Scott 以獨立的顧問、訓練員和作者的身分運作。</span><span class="sxs-lookup"><span data-stu-id="84f8f-300">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="84f8f-301">他的最新著作是[*在24小時內讓自己的 ASP.NET 2.0*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="84f8f-301">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="84f8f-302">他可以在mitchell@4GuysFromRolla.com觸達[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="84f8f-302">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="84f8f-303">或者透過他的 blog，可以在[http://ScottOnWriting.NET](http://ScottOnWriting.NET)找到。</span><span class="sxs-lookup"><span data-stu-id="84f8f-303">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="84f8f-304">特別感謝</span><span class="sxs-lookup"><span data-stu-id="84f8f-304">Special Thanks To</span></span>

<span data-ttu-id="84f8f-305">本教學課程系列已由許多有用的審核者所審查。</span><span class="sxs-lookup"><span data-stu-id="84f8f-305">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="84f8f-306">本教學課程的潛在客戶審核者已 E.R。</span><span class="sxs-lookup"><span data-stu-id="84f8f-306">Lead reviewers for this tutorial were E.R.</span></span> <span data-ttu-id="84f8f-307">Gilmore、Dennis Patterson 和 Dan Jagers。</span><span class="sxs-lookup"><span data-stu-id="84f8f-307">Gilmore, Dennis Patterson, and Dan Jagers.</span></span> <span data-ttu-id="84f8f-308">有興趣複習我即將發行的 MSDN 文章嗎？</span><span class="sxs-lookup"><span data-stu-id="84f8f-308">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="84f8f-309">若是如此，請在mitchell@4GuysFromRolla.com的那一行下拉式[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="84f8f-309">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="84f8f-310">下一步</span><span class="sxs-lookup"><span data-stu-id="84f8f-310">Next</span></span>](using-templatefields-in-the-gridview-control-cs.md)
