---
uid: web-forms/overview/data-access/custom-formatting/using-templatefields-in-the-gridview-control-vb
title: 在 GridView 控制項中使用 TemplateFields （VB） |Microsoft Docs
author: rick-anderson
description: 為了提供彈性，GridView 提供了使用範本呈現的 TemplateField。 範本可以混合使用靜態 HTML、Web 控制項和 。
ms.author: riande
ms.date: 03/31/2010
ms.assetid: a92cd6ed-609a-4e40-ad23-004b54afd436
msc.legacyurl: /web-forms/overview/data-access/custom-formatting/using-templatefields-in-the-gridview-control-vb
msc.type: authoredcontent
ms.openlocfilehash: 3c090dbf65d9acbcc0e343cda5e8da7fff2d35d3
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/06/2020
ms.locfileid: "78531476"
---
# <a name="using-templatefields-in-the-gridview-control-vb"></a><span data-ttu-id="86755-104">在 GridView 控制項中使用 TemplateFields (VB)</span><span class="sxs-lookup"><span data-stu-id="86755-104">Using TemplateFields in the GridView Control (VB)</span></span>

<span data-ttu-id="86755-105">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="86755-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="86755-106">[下載範例應用程式](https://download.microsoft.com/download/5/7/0/57084608-dfb3-4781-991c-407d086e2adc/ASPNET_Data_Tutorial_12_VB.exe)或[下載 PDF](using-templatefields-in-the-gridview-control-vb/_static/datatutorial12vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="86755-106">[Download Sample App](https://download.microsoft.com/download/5/7/0/57084608-dfb3-4781-991c-407d086e2adc/ASPNET_Data_Tutorial_12_VB.exe) or [Download PDF](using-templatefields-in-the-gridview-control-vb/_static/datatutorial12vb1.pdf)</span></span>

> <span data-ttu-id="86755-107">為了提供彈性，GridView 提供了使用範本呈現的 TemplateField。</span><span class="sxs-lookup"><span data-stu-id="86755-107">To provide flexibility, the GridView offers the TemplateField, which renders using a template.</span></span> <span data-ttu-id="86755-108">範本可以混合使用靜態 HTML、Web 控制項和資料系結語法。</span><span class="sxs-lookup"><span data-stu-id="86755-108">A template can include a mix of static HTML, Web controls, and databinding syntax.</span></span> <span data-ttu-id="86755-109">在本教學課程中，我們將探討如何使用 TemplateField，透過 GridView 控制項達成更高程度的自訂。</span><span class="sxs-lookup"><span data-stu-id="86755-109">In this tutorial we'll examine how to use the TemplateField to achieve a greater degree of customization with the GridView control.</span></span>

## <a name="introduction"></a><span data-ttu-id="86755-110">簡介</span><span class="sxs-lookup"><span data-stu-id="86755-110">Introduction</span></span>

<span data-ttu-id="86755-111">GridView 是由一組欄位所組成，其中指出要包含在轉譯輸出中的 `DataSource` 屬性以及資料的顯示方式。</span><span class="sxs-lookup"><span data-stu-id="86755-111">The GridView is composed of a set of fields that indicate what properties from the `DataSource` are to be included in the rendered output along with how the data will be displayed.</span></span> <span data-ttu-id="86755-112">最簡單的欄位類型是 BoundField，它會將資料值顯示為文字。</span><span class="sxs-lookup"><span data-stu-id="86755-112">The simplest field type is the BoundField, which displays a data value as text.</span></span> <span data-ttu-id="86755-113">其他欄位類型會使用其他 HTML 元素來顯示資料。</span><span class="sxs-lookup"><span data-stu-id="86755-113">Other field types display the data using alternate HTML elements.</span></span> <span data-ttu-id="86755-114">例如，CheckBoxField 會轉譯為 checkbox，其已核取狀態取決於指定之資料欄位的值。ImageField 會呈現影像，其影像來源是以指定的資料欄位為基礎。</span><span class="sxs-lookup"><span data-stu-id="86755-114">The CheckBoxField, for example, renders as a checkbox whose checked state depends on the value of a specified data field; the ImageField renders an image whose image source is based upon a specified data field.</span></span> <span data-ttu-id="86755-115">您可以使用 HyperLinkField 和 ButtonField 欄位類型來轉譯狀態相依于基礎資料欄值的超連結和按鈕。</span><span class="sxs-lookup"><span data-stu-id="86755-115">Hyperlinks and buttons whose state depends on an underlying data field value can be rendered using the HyperLinkField and ButtonField field types.</span></span>

<span data-ttu-id="86755-116">雖然 [CheckBoxField]、[ImageField]、[HyperLinkField] 和 [ButtonField] 欄位類型允許資料的替代視圖，但它們的格式仍然相當有限。</span><span class="sxs-lookup"><span data-stu-id="86755-116">While the CheckBoxField, ImageField, HyperLinkField, and ButtonField field types allow for an alternate view of the data, they still are fairly limited with respect to formatting.</span></span> <span data-ttu-id="86755-117">CheckBoxField 只能顯示單一核取方塊，而 ImageField 只能顯示單一影像。</span><span class="sxs-lookup"><span data-stu-id="86755-117">A CheckBoxField can only display a single checkbox, whereas an ImageField can only display a single image.</span></span> <span data-ttu-id="86755-118">如果特定欄位需要顯示某些文字、核取方塊*和*影像，全都以不同的資料欄值為基礎呢？</span><span class="sxs-lookup"><span data-stu-id="86755-118">What if a particular field needs to display some text, a checkbox, *and* an image, all based upon different data field values?</span></span> <span data-ttu-id="86755-119">或者，如果我們想要使用 [] 核取方塊、[影像]、[超連結] 或 [按鈕] 以外的 Web 控制項來顯示資料呢？</span><span class="sxs-lookup"><span data-stu-id="86755-119">Or what if we wanted to display the data using a Web control other than the CheckBox, Image, HyperLink, or Button?</span></span> <span data-ttu-id="86755-120">此外，BoundField 會將其顯示限制為單一資料欄位。</span><span class="sxs-lookup"><span data-stu-id="86755-120">Furthermore, the BoundField limits its display to a single data field.</span></span> <span data-ttu-id="86755-121">如果我們想要在單一 GridView 資料行中顯示兩個或多個資料欄值呢？</span><span class="sxs-lookup"><span data-stu-id="86755-121">What if we wanted to show two or more data field values in a single GridView column?</span></span>

<span data-ttu-id="86755-122">為了配合此彈性層級，GridView 提供了使用*範本*來呈現的 TemplateField。</span><span class="sxs-lookup"><span data-stu-id="86755-122">To accommodate this level of flexibility the GridView offers the TemplateField, which renders using a *template*.</span></span> <span data-ttu-id="86755-123">範本可以混合使用靜態 HTML、Web 控制項和資料系結語法。</span><span class="sxs-lookup"><span data-stu-id="86755-123">A template can include a mix of static HTML, Web controls, and databinding syntax.</span></span> <span data-ttu-id="86755-124">此外，TemplateField 也有各種範本，可用來自訂不同情況的呈現。</span><span class="sxs-lookup"><span data-stu-id="86755-124">Furthermore, the TemplateField has a variety of templates that can be used to customize the rendering for different situations.</span></span> <span data-ttu-id="86755-125">例如，預設會使用 `ItemTemplate` 來呈現每個資料列的儲存格，但 `EditItemTemplate` 範本可在編輯資料時用來自訂介面。</span><span class="sxs-lookup"><span data-stu-id="86755-125">For example, the `ItemTemplate` is used by default to render the cell for each row, but the `EditItemTemplate` template can be used to customize the interface when editing data.</span></span>

<span data-ttu-id="86755-126">在本教學課程中，我們將探討如何使用 TemplateField，透過 GridView 控制項達成更高程度的自訂。</span><span class="sxs-lookup"><span data-stu-id="86755-126">In this tutorial we'll examine how to use the TemplateField to achieve a greater degree of customization with the GridView control.</span></span> <span data-ttu-id="86755-127">在[先前的教學](custom-formatting-based-upon-data-vb.md)課程中，我們已瞭解如何使用 `DataBound` 和 `RowDataBound` 事件處理常式，根據基礎資料自訂格式。</span><span class="sxs-lookup"><span data-stu-id="86755-127">In the [preceding tutorial](custom-formatting-based-upon-data-vb.md) we saw how to customize the formatting based on the underlying data using the `DataBound` and `RowDataBound` event handlers.</span></span> <span data-ttu-id="86755-128">根據基礎資料自訂格式的另一種方式是從範本內呼叫格式化方法。</span><span class="sxs-lookup"><span data-stu-id="86755-128">Another way to customize the formatting based on the underlying data is by calling formatting methods from within a template.</span></span> <span data-ttu-id="86755-129">我們也會在本教學課程中探討這項技術。</span><span class="sxs-lookup"><span data-stu-id="86755-129">We'll look at this technique in this tutorial as well.</span></span>

<span data-ttu-id="86755-130">在本教學課程中，我們將使用 TemplateFields 來自訂員工清單的外觀。</span><span class="sxs-lookup"><span data-stu-id="86755-130">For this tutorial we will use TemplateFields to customize the appearance of a list of employees.</span></span> <span data-ttu-id="86755-131">具體來說，我們會列出所有員工，但會將員工的名字和姓氏顯示在一個資料行中、其在行事曆控制項中的雇用日期，以及一個狀態資料行，指出他們在公司使用了多少天。</span><span class="sxs-lookup"><span data-stu-id="86755-131">Specifically, we'll list all of the employees, but will display the employee's first and last names in one column, their hire date in a Calendar control, and a status column that indicates how many days they've been employed at the company.</span></span>

<span data-ttu-id="86755-132">[![三個 TemplateFields 用於自訂顯示](using-templatefields-in-the-gridview-control-vb/_static/image2.png)](using-templatefields-in-the-gridview-control-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="86755-132">[![Three TemplateFields are Used to Customize the Display](using-templatefields-in-the-gridview-control-vb/_static/image2.png)](using-templatefields-in-the-gridview-control-vb/_static/image1.png)</span></span>

<span data-ttu-id="86755-133">**圖 1**：三個 TemplateFields 用於自訂顯示（[按一下以觀看完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image3.png)）</span><span class="sxs-lookup"><span data-stu-id="86755-133">**Figure 1**: Three TemplateFields are Used to Customize the Display ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image3.png))</span></span>

## <a name="step-1-binding-the-data-to-the-gridview"></a><span data-ttu-id="86755-134">步驟1：將資料系結至 GridView</span><span class="sxs-lookup"><span data-stu-id="86755-134">Step 1: Binding the Data to the GridView</span></span>

<span data-ttu-id="86755-135">在您需要使用 TemplateFields 來自訂外觀的報告案例中，我發現最簡單的方法是先建立一個只包含 BoundFields 的 GridView 控制項，然後再加入新的 TemplateFields，或是將現有的 BoundFields 轉換成視需要 TemplateFields。</span><span class="sxs-lookup"><span data-stu-id="86755-135">In reporting scenarios where you need to use TemplateFields to customize the appearance, I find it easiest to start by creating a GridView control that contains just BoundFields first and then to add new TemplateFields or convert the existing BoundFields to TemplateFields as needed.</span></span> <span data-ttu-id="86755-136">因此，讓我們開始本教學課程，方法是透過設計工具將 GridView 新增至頁面，並將它系結至會傳回員工清單的 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="86755-136">Therefore, let's start this tutorial by adding a GridView to the page through the Designer and binding it to an ObjectDataSource that returns the list of employees.</span></span> <span data-ttu-id="86755-137">這些步驟將會為每個員工欄位建立具有 BoundFields 的 GridView。</span><span class="sxs-lookup"><span data-stu-id="86755-137">These steps will create a GridView with BoundFields for each of the employee fields.</span></span>

<span data-ttu-id="86755-138">開啟 [`GridViewTemplateField.aspx`] 頁面，並將 GridView 從 [工具箱] 拖曳至設計工具。</span><span class="sxs-lookup"><span data-stu-id="86755-138">Open the `GridViewTemplateField.aspx` page and drag a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="86755-139">從 GridView 的智慧標籤加入宣告新的 ObjectDataSource 控制項，叫用 `EmployeesBLL` 類別的 `GetEmployees()` 方法。</span><span class="sxs-lookup"><span data-stu-id="86755-139">From the GridView's smart tag choose to add a new ObjectDataSource control that invokes the `EmployeesBLL` class's `GetEmployees()` method.</span></span>

<span data-ttu-id="86755-140">[![加入新的 ObjectDataSource 控制項來叫用 GetEmployees （）方法](using-templatefields-in-the-gridview-control-vb/_static/image5.png)](using-templatefields-in-the-gridview-control-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="86755-140">[![Add a New ObjectDataSource Control that Invokes the GetEmployees() Method](using-templatefields-in-the-gridview-control-vb/_static/image5.png)](using-templatefields-in-the-gridview-control-vb/_static/image4.png)</span></span>

<span data-ttu-id="86755-141">**圖 2**：加入新的 ObjectDataSource 控制項來叫用 `GetEmployees()` 方法（[按一下以查看完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image6.png)）</span><span class="sxs-lookup"><span data-stu-id="86755-141">**Figure 2**: Add a New ObjectDataSource Control that Invokes the `GetEmployees()` Method ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image6.png))</span></span>

<span data-ttu-id="86755-142">以這種方式系結 GridView，會自動為每個 employee 屬性加入 BoundField： `EmployeeID`、`LastName`、`FirstName`、`Title`、`HireDate`、`ReportsTo`和 `Country`。</span><span class="sxs-lookup"><span data-stu-id="86755-142">Binding the GridView in this manner will automatically add a BoundField for each of the employee properties: `EmployeeID`, `LastName`, `FirstName`, `Title`, `HireDate`, `ReportsTo`, and `Country`.</span></span> <span data-ttu-id="86755-143">在此報表中，我們不會使用顯示 `EmployeeID`、`ReportsTo`或 `Country` 屬性。</span><span class="sxs-lookup"><span data-stu-id="86755-143">For this report let's not bother with displaying the `EmployeeID`, `ReportsTo`, or `Country` properties.</span></span> <span data-ttu-id="86755-144">若要移除這些 BoundFields，您可以：</span><span class="sxs-lookup"><span data-stu-id="86755-144">To remove these BoundFields you can:</span></span>

- <span data-ttu-id="86755-145">使用 [欄位] 對話方塊按一下 GridView 智慧標籤中的 [編輯資料行] 連結，以顯示此對話方塊。</span><span class="sxs-lookup"><span data-stu-id="86755-145">Use the Fields dialog box click on the Edit Columns link from the GridView's smart tag to bring up this dialog box.</span></span> <span data-ttu-id="86755-146">接下來，從左下方清單中選取 BoundFields，然後按一下紅色 X 按鈕來移除 BoundField。</span><span class="sxs-lookup"><span data-stu-id="86755-146">Next, select the BoundFields from the lower left list and click the red X button to remove the BoundField.</span></span>
- <span data-ttu-id="86755-147">以手動方式從來源視圖編輯 GridView 的宣告式語法，並刪除您想要移除之 BoundField 的 `<asp:BoundField>` 元素。</span><span class="sxs-lookup"><span data-stu-id="86755-147">Edit the GridView's declarative syntax by hand from the Source view, delete the `<asp:BoundField>` element for the BoundField you wish to remove.</span></span>

<span data-ttu-id="86755-148">移除 `EmployeeID`、`ReportsTo`和 `Country` BoundFields 之後，GridView 的標記應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="86755-148">After you have removed the `EmployeeID`, `ReportsTo`, and `Country` BoundFields, your GridView's markup should look like:</span></span>

[!code-aspx[Main](using-templatefields-in-the-gridview-control-vb/samples/sample1.aspx)]

<span data-ttu-id="86755-149">花點時間在瀏覽器中觀看進度。</span><span class="sxs-lookup"><span data-stu-id="86755-149">Take a moment to view our progress in a browser.</span></span> <span data-ttu-id="86755-150">此時，您應該會看到一個資料表，其中包含每個員工的記錄和四個數據行：一個用於員工的姓氏、一個用於名字、一個用於其職稱，另一個用於員工的姓名。</span><span class="sxs-lookup"><span data-stu-id="86755-150">At this point you should see a table with a record for each employee and four columns: one for the employee's last name, one for their first name, one for their title, and one for their hire date.</span></span>

<span data-ttu-id="86755-151">[![會顯示每個員工的姓氏、名字、標題和雇用日期欄位](using-templatefields-in-the-gridview-control-vb/_static/image8.png)](using-templatefields-in-the-gridview-control-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="86755-151">[![The LastName, FirstName, Title, and HireDate Fields are Displayed for Each Employee](using-templatefields-in-the-gridview-control-vb/_static/image8.png)](using-templatefields-in-the-gridview-control-vb/_static/image7.png)</span></span>

<span data-ttu-id="86755-152">**圖 3**：每個員工都會顯示 [`LastName`]、[`FirstName`]、[`Title`] 和 [`HireDate`] 欄位（[按一下以查看完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image9.png)）</span><span class="sxs-lookup"><span data-stu-id="86755-152">**Figure 3**: The `LastName`, `FirstName`, `Title`, and `HireDate` Fields are Displayed for Each Employee ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image9.png))</span></span>

## <a name="step-2-displaying-the-first-and-last-names-in-a-single-column"></a><span data-ttu-id="86755-153">步驟2：在單一資料行中顯示第一個和最後一個名稱</span><span class="sxs-lookup"><span data-stu-id="86755-153">Step 2: Displaying the First and Last Names in a Single Column</span></span>

<span data-ttu-id="86755-154">目前，每個員工的名字和姓氏都會顯示在個別的資料行中。</span><span class="sxs-lookup"><span data-stu-id="86755-154">Currently, each employee's first and last names are displayed in a separate column.</span></span> <span data-ttu-id="86755-155">將它們結合成單一資料行可能是很好的方法。</span><span class="sxs-lookup"><span data-stu-id="86755-155">It might be nice to combine them into a single column instead.</span></span> <span data-ttu-id="86755-156">為了達成此目的，我們需要使用 TemplateField。</span><span class="sxs-lookup"><span data-stu-id="86755-156">To accomplish this we need to use a TemplateField.</span></span> <span data-ttu-id="86755-157">我們可以加入新的 TemplateField、將其新增至所需的標記和資料系結語法，然後刪除 `FirstName` 並 `LastName` BoundFields，或者我們可以將 `FirstName` BoundField 轉換成 TemplateField，編輯 TemplateField 以包含 `LastName` 值，然後移除 `LastName` BoundField。</span><span class="sxs-lookup"><span data-stu-id="86755-157">We can either add a new TemplateField, add to it the needed markup and databinding syntax, and then delete the `FirstName` and `LastName` BoundFields, or we can convert the `FirstName` BoundField into a TemplateField, edit the TemplateField to include the `LastName` value, and then remove the `LastName` BoundField.</span></span>

<span data-ttu-id="86755-158">這兩種方法都有相同的結果，但我個人還是會在可能的情況下將 BoundFields 轉換成 TemplateFields，因為轉換會自動加入 `ItemTemplate`，`EditItemTemplate` 並使用 Web 控制項和資料系結語法來模擬 BoundField 的外觀和功能。</span><span class="sxs-lookup"><span data-stu-id="86755-158">Both approaches net the same result, but personally I like converting BoundFields to TemplateFields when possible because the conversion automatically adds an `ItemTemplate` and `EditItemTemplate` with Web controls and databinding syntax to mimic the appearance and functionality of the BoundField.</span></span> <span data-ttu-id="86755-159">其優點是，我們需要對 TemplateField 執行較少的工作，因為轉換程式會為我們執行一些工作。</span><span class="sxs-lookup"><span data-stu-id="86755-159">The benefit is that we'll need to do less work with the TemplateField as the conversion process will have performed some of the work for us.</span></span>

<span data-ttu-id="86755-160">若要將現有的 BoundField 轉換成 TemplateField，請按一下 GridView 的智慧標籤中的 [編輯資料行] 連結，並帶出 [欄位] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="86755-160">To convert an existing BoundField into a TemplateField, click on the Edit Columns link from the GridView's smart tag, bringing up the Fields dialog box.</span></span> <span data-ttu-id="86755-161">從左下角的清單中選取要轉換的 BoundField，然後按一下右下角的 [將此欄位轉換成 TemplateField] 連結。</span><span class="sxs-lookup"><span data-stu-id="86755-161">Select the BoundField to convert from the list in the lower left corner and then click the "Convert this field into a TemplateField" link in the bottom right corner.</span></span>

<span data-ttu-id="86755-162">[![從 [欄位] 對話方塊將 BoundField 轉換為 TemplateField](using-templatefields-in-the-gridview-control-vb/_static/image11.png)](using-templatefields-in-the-gridview-control-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="86755-162">[![Convert a BoundField Into a TemplateField from the Fields Dialog Box](using-templatefields-in-the-gridview-control-vb/_static/image11.png)](using-templatefields-in-the-gridview-control-vb/_static/image10.png)</span></span>

<span data-ttu-id="86755-163">**圖 4**：從 [欄位] 對話方塊將 BoundField 轉換為 TemplateField （[按一下以查看完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image12.png)）</span><span class="sxs-lookup"><span data-stu-id="86755-163">**Figure 4**: Convert a BoundField Into a TemplateField from the Fields Dialog Box ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image12.png))</span></span>

<span data-ttu-id="86755-164">繼續進行，並將 `FirstName` BoundField 轉換成 TemplateField。</span><span class="sxs-lookup"><span data-stu-id="86755-164">Go ahead and convert the `FirstName` BoundField into a TemplateField.</span></span> <span data-ttu-id="86755-165">在這項變更之後，設計工具中不會有任何得的差異。</span><span class="sxs-lookup"><span data-stu-id="86755-165">After this change there's no perceptive difference in the Designer.</span></span> <span data-ttu-id="86755-166">這是因為將 BoundField 轉換成 TemplateField 時，會建立一個 TemplateField 來維護 BoundField 的外觀與風格。</span><span class="sxs-lookup"><span data-stu-id="86755-166">This is because converting the BoundField into a TemplateField creates a TemplateField that maintains the look and feel of the BoundField.</span></span> <span data-ttu-id="86755-167">雖然設計工具中目前沒有任何視覺差異，但此轉換程式已取代 BoundField 的宣告式語法 `<asp:BoundField DataField="FirstName" HeaderText="FirstName" SortExpression="FirstName" />`-使用下列 TemplateField 語法：</span><span class="sxs-lookup"><span data-stu-id="86755-167">Despite there being no visual difference at this point in the Designer, this conversion process has replaced the BoundField's declarative syntax - `<asp:BoundField DataField="FirstName" HeaderText="FirstName" SortExpression="FirstName" />` - with the following TemplateField syntax:</span></span>

[!code-aspx[Main](using-templatefields-in-the-gridview-control-vb/samples/sample2.aspx)]

<span data-ttu-id="86755-168">如您所見，TemplateField 是由兩個樣板組成 `ItemTemplate`，其中有一個標籤的 `Text` 屬性設定為 `FirstName` 資料欄位的值，另一個 `EditItemTemplate` 的 TextBox 控制項，其 `Text` 屬性也設定為 `FirstName` 資料欄位。</span><span class="sxs-lookup"><span data-stu-id="86755-168">As you can see, the TemplateField consists of two templates an `ItemTemplate` that has a Label whose `Text` property is set to the value of the `FirstName` data field, and an `EditItemTemplate` with a TextBox control whose `Text` property is also set to the `FirstName` data field.</span></span> <span data-ttu-id="86755-169">資料系結語法-`<%# Bind("fieldName") %>`-表示 *`fieldName`* 的資料欄位系結至指定的 Web 控制項屬性。</span><span class="sxs-lookup"><span data-stu-id="86755-169">The databinding syntax - `<%# Bind("fieldName") %>` - indicates that the data field *`fieldName`* is bound to the specified Web control property.</span></span>

<span data-ttu-id="86755-170">若要將 `LastName` 資料欄值加入此 TemplateField，我們需要在 `ItemTemplate` 中新增另一個標籤 Web 控制項，並將其 `Text` 屬性系結至 `LastName`。</span><span class="sxs-lookup"><span data-stu-id="86755-170">To add the `LastName` data field value to this TemplateField we need to add another Label Web control in the `ItemTemplate` and bind its `Text` property to `LastName`.</span></span> <span data-ttu-id="86755-171">您可以手動或透過設計工具來完成這項作業。</span><span class="sxs-lookup"><span data-stu-id="86755-171">This can be accomplished either by hand or through the Designer.</span></span> <span data-ttu-id="86755-172">若要手動執行，只需將適當的宣告式語法新增至 `ItemTemplate`：</span><span class="sxs-lookup"><span data-stu-id="86755-172">To do it by hand, simply add the appropriate declarative syntax to the `ItemTemplate`:</span></span>

[!code-aspx[Main](using-templatefields-in-the-gridview-control-vb/samples/sample3.aspx)]

<span data-ttu-id="86755-173">若要透過設計工具新增它，請按一下 GridView 智慧標籤中的 [編輯範本] 連結。</span><span class="sxs-lookup"><span data-stu-id="86755-173">To add it through the Designer, click on the Edit Templates link from the GridView's smart tag.</span></span> <span data-ttu-id="86755-174">這會顯示 GridView 的範本編輯介面。</span><span class="sxs-lookup"><span data-stu-id="86755-174">This will display the GridView's template editing interface.</span></span> <span data-ttu-id="86755-175">在此介面的智慧標籤中，是 GridView 中的範本清單。</span><span class="sxs-lookup"><span data-stu-id="86755-175">In this interface's smart tag is a list of the templates in the GridView.</span></span> <span data-ttu-id="86755-176">由於目前只有一個 TemplateField，因此下拉式清單中唯一列出的範本是 `FirstName` TemplateField 的範本，以及 `EmptyDataTemplate` 和 `PagerTemplate`。</span><span class="sxs-lookup"><span data-stu-id="86755-176">Since we only have one TemplateField at this point, the only templates listed in the drop-down list are those templates for the `FirstName` TemplateField along with the `EmptyDataTemplate` and `PagerTemplate`.</span></span> <span data-ttu-id="86755-177">如果已指定，`EmptyDataTemplate` 範本會用來轉譯 GridView 的輸出（如果資料沒有系結至 GridView 的結果）。如有指定，則會使用 `PagerTemplate`來呈現支援分頁之 GridView 的分頁介面。</span><span class="sxs-lookup"><span data-stu-id="86755-177">The `EmptyDataTemplate` template, if specified, is used to render the GridView's output if there are no results in the data bound to the GridView; the `PagerTemplate`, if specified, is used to render the paging interface for a GridView that supports paging.</span></span>

<span data-ttu-id="86755-178">[![GridView 的範本可以透過設計工具編輯](using-templatefields-in-the-gridview-control-vb/_static/image14.png)](using-templatefields-in-the-gridview-control-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="86755-178">[![The GridView's Templates Can Be Edited Through the Designer](using-templatefields-in-the-gridview-control-vb/_static/image14.png)](using-templatefields-in-the-gridview-control-vb/_static/image13.png)</span></span>

<span data-ttu-id="86755-179">**圖 5**： GridView 的範本可以透過設計工具編輯（[按一下以觀看完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image15.png)）</span><span class="sxs-lookup"><span data-stu-id="86755-179">**Figure 5**: The GridView's Templates Can Be Edited Through the Designer ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image15.png))</span></span>

<span data-ttu-id="86755-180">若要同時在 [`FirstName`] TemplateField 中顯示 `LastName`，請將 [標籤] 控制項從 [工具箱] 拖曳至 GridView 範本編輯介面中 `FirstName` TemplateField 的 `ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="86755-180">To also display the `LastName` in the `FirstName` TemplateField drag the Label control from the Toolbox into the `FirstName` TemplateField's `ItemTemplate` in the GridView's template editing interface.</span></span>

<span data-ttu-id="86755-181">[![將標籤 Web 控制項新增至 FirstName TemplateField 的 ItemTemplate](using-templatefields-in-the-gridview-control-vb/_static/image17.png)](using-templatefields-in-the-gridview-control-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="86755-181">[![Add a Label Web Control to the FirstName TemplateField's ItemTemplate](using-templatefields-in-the-gridview-control-vb/_static/image17.png)](using-templatefields-in-the-gridview-control-vb/_static/image16.png)</span></span>

<span data-ttu-id="86755-182">**圖 6**：將標籤 Web 控制項新增至 `FirstName` TemplateField 的 ItemTemplate （[按一下以查看完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image18.png)）</span><span class="sxs-lookup"><span data-stu-id="86755-182">**Figure 6**: Add a Label Web Control to the `FirstName` TemplateField's ItemTemplate ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image18.png))</span></span>

<span data-ttu-id="86755-183">此時，新增至 TemplateField 的標籤 Web 控制項，其 `Text` 屬性會設定為「標籤」。</span><span class="sxs-lookup"><span data-stu-id="86755-183">At this point the Label Web control added to the TemplateField has its `Text` property set to "Label".</span></span> <span data-ttu-id="86755-184">我們需要變更此屬性，讓這個屬性改為系結至 `LastName` 資料欄位的值。</span><span class="sxs-lookup"><span data-stu-id="86755-184">We need to change this so that this property is bound to the value of the `LastName` data field instead.</span></span> <span data-ttu-id="86755-185">若要完成這項操作，請按一下 [標籤] 控制項的智慧標籤，然後選擇 [編輯系結] 選項。</span><span class="sxs-lookup"><span data-stu-id="86755-185">To accomplish this click on the Label control's smart tag and choose the Edit DataBindings option.</span></span>

<span data-ttu-id="86755-186">[![從標籤的智慧標籤中選擇 [編輯系結] 選項](using-templatefields-in-the-gridview-control-vb/_static/image20.png)](using-templatefields-in-the-gridview-control-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="86755-186">[![Choose the Edit DataBindings Option from the Label's Smart Tag](using-templatefields-in-the-gridview-control-vb/_static/image20.png)](using-templatefields-in-the-gridview-control-vb/_static/image19.png)</span></span>

<span data-ttu-id="86755-187">**圖 7**：從標籤的智慧標籤選擇 [編輯系結] 選項（[按一下以查看完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image21.png)）</span><span class="sxs-lookup"><span data-stu-id="86755-187">**Figure 7**: Choose the Edit DataBindings Option from the Label's Smart Tag ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image21.png))</span></span>

<span data-ttu-id="86755-188">這會顯示 [系結] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="86755-188">This will bring up the DataBindings dialog box.</span></span> <span data-ttu-id="86755-189">在這裡，您可以從左側清單中選取要參與資料系結的屬性，然後從右邊的下拉式清單中選擇要系結資料的欄位。</span><span class="sxs-lookup"><span data-stu-id="86755-189">From here you can select the property to participate in databinding from the list on the left and choose the field to bind the data to from the drop-down list on the right.</span></span> <span data-ttu-id="86755-190">選擇左側的 [`Text`] 屬性和右邊的 [`LastName`] 欄位，然後按一下 [確定]。</span><span class="sxs-lookup"><span data-stu-id="86755-190">Choose the `Text` property from the left and the `LastName` field from the right and click OK.</span></span>

<span data-ttu-id="86755-191">[![將 Text 屬性系結至 LastName 資料欄位](using-templatefields-in-the-gridview-control-vb/_static/image23.png)](using-templatefields-in-the-gridview-control-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="86755-191">[![Bind the Text Property to the LastName Data Field](using-templatefields-in-the-gridview-control-vb/_static/image23.png)](using-templatefields-in-the-gridview-control-vb/_static/image22.png)</span></span>

<span data-ttu-id="86755-192">**圖 8**：將 [`Text`] 屬性系結至 [`LastName` 資料] 欄位（[按一下以查看完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image24.png)）</span><span class="sxs-lookup"><span data-stu-id="86755-192">**Figure 8**: Bind the `Text` Property to the `LastName` Data Field ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image24.png))</span></span>

> [!NOTE]
> <span data-ttu-id="86755-193">[資料系結] 對話方塊可讓您指出是否要執行雙向資料系結。</span><span class="sxs-lookup"><span data-stu-id="86755-193">The DataBindings dialog box allows you to indicate whether to perform two-way databinding.</span></span> <span data-ttu-id="86755-194">如果您將此項取消核取，將會使用資料系結語法 `<%# Eval("LastName")%>`，而不是 `<%# Bind("LastName")%>`。</span><span class="sxs-lookup"><span data-stu-id="86755-194">If you leave this unchecked, the databinding syntax `<%# Eval("LastName")%>` will be used instead of `<%# Bind("LastName")%>`.</span></span> <span data-ttu-id="86755-195">這兩種方法都適用于本教學課程。</span><span class="sxs-lookup"><span data-stu-id="86755-195">Either approach is fine for this tutorial.</span></span> <span data-ttu-id="86755-196">當插入和編輯資料時，雙向資料系結會變得很重要。</span><span class="sxs-lookup"><span data-stu-id="86755-196">Two-way databinding becomes important when inserting and editing data.</span></span> <span data-ttu-id="86755-197">不過，只要顯示資料，這兩種方法的運作方式都一樣。</span><span class="sxs-lookup"><span data-stu-id="86755-197">For simply displaying data, however, either approach will work equally well.</span></span> <span data-ttu-id="86755-198">我們將在未來的教學課程中詳細討論雙向資料系結。</span><span class="sxs-lookup"><span data-stu-id="86755-198">We'll discuss two-way databinding in detail in future tutorials.</span></span>

<span data-ttu-id="86755-199">請花點時間透過瀏覽器觀看此頁面。</span><span class="sxs-lookup"><span data-stu-id="86755-199">Take a moment to view this page through a browser.</span></span> <span data-ttu-id="86755-200">如您所見，GridView 仍然包含四個數據行;不過，`FirstName` 資料行現在會*同時*列出 `FirstName` 和 `LastName` 的資料欄值。</span><span class="sxs-lookup"><span data-stu-id="86755-200">As you can see, the GridView still includes four columns; however, the `FirstName` column now lists *both* the `FirstName` and `LastName` data field values.</span></span>

<span data-ttu-id="86755-201">[![FirstName 和 LastName 值都會顯示在單一資料行中](using-templatefields-in-the-gridview-control-vb/_static/image26.png)](using-templatefields-in-the-gridview-control-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="86755-201">[![Both the FirstName and LastName Values are Shown in a Single Column](using-templatefields-in-the-gridview-control-vb/_static/image26.png)](using-templatefields-in-the-gridview-control-vb/_static/image25.png)</span></span>

<span data-ttu-id="86755-202">**圖 9**： `FirstName` 和 `LastName` 值都會顯示在單一資料行中（[按一下以查看完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image27.png)）</span><span class="sxs-lookup"><span data-stu-id="86755-202">**Figure 9**: Both the `FirstName` and `LastName` Values are Shown in a Single Column ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image27.png))</span></span>

<span data-ttu-id="86755-203">若要完成第一個步驟，請移除 `LastName` BoundField，並將 `FirstName` TemplateField 的 `HeaderText` 屬性重新命名為 "Name"。</span><span class="sxs-lookup"><span data-stu-id="86755-203">To complete this first step, remove the `LastName` BoundField and rename the `FirstName` TemplateField's `HeaderText` property to "Name".</span></span> <span data-ttu-id="86755-204">這些變更之後，GridView 的宣告式標記看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="86755-204">After these changes the GridView's declarative markup should look like the following:</span></span>

[!code-aspx[Main](using-templatefields-in-the-gridview-control-vb/samples/sample4.aspx)]

<span data-ttu-id="86755-205">[![每個員工的名字和姓氏都會顯示在一個資料行中](using-templatefields-in-the-gridview-control-vb/_static/image29.png)](using-templatefields-in-the-gridview-control-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="86755-205">[![Each Employee's First and Last Names are Displayed in One Column](using-templatefields-in-the-gridview-control-vb/_static/image29.png)](using-templatefields-in-the-gridview-control-vb/_static/image28.png)</span></span>

<span data-ttu-id="86755-206">**圖 10**：每位員工的名字和姓氏都會顯示在一個資料行中（[按一下以查看完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image30.png)）</span><span class="sxs-lookup"><span data-stu-id="86755-206">**Figure 10**: Each Employee's First and Last Names are Displayed in One Column ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image30.png))</span></span>

## <a name="step-3-using-the-calendar-control-to-display-thehireddatefield"></a><span data-ttu-id="86755-207">步驟3：使用行事曆控制項顯示 [`HiredDate`] 欄位</span><span class="sxs-lookup"><span data-stu-id="86755-207">Step 3: Using the Calendar Control to Display the`HiredDate`Field</span></span>

<span data-ttu-id="86755-208">將資料欄位值顯示為 GridView 中的文字，就像使用 BoundField 一樣簡單。</span><span class="sxs-lookup"><span data-stu-id="86755-208">Displaying a data field value as text in a GridView is as simple as using a BoundField.</span></span> <span data-ttu-id="86755-209">不過，在某些情況下，最好使用特定的 Web 控制項，而不只是文字來表示資料。</span><span class="sxs-lookup"><span data-stu-id="86755-209">For certain scenarios, however, the data is best expressed using a particular Web control instead of just text.</span></span> <span data-ttu-id="86755-210">您可以使用 TemplateFields 來自訂資料的顯示。</span><span class="sxs-lookup"><span data-stu-id="86755-210">Such customization of the display of data is possible with TemplateFields.</span></span> <span data-ttu-id="86755-211">例如，不是將員工的雇用日期顯示為文字，而是顯示行事曆（使用行事[曆控制項](https://msdn.microsoft.com/library/system.web.ui.webcontrols.calendar(VS.80).aspx)）並反白顯示其雇用日期。</span><span class="sxs-lookup"><span data-stu-id="86755-211">For example, rather than display the employee's hire date as text, we could show a calendar (using [the Calendar control](https://msdn.microsoft.com/library/system.web.ui.webcontrols.calendar(VS.80).aspx)) with their hire date highlighted.</span></span>

<span data-ttu-id="86755-212">若要完成這項工作，請先將 `HiredDate` BoundField 轉換成 TemplateField。</span><span class="sxs-lookup"><span data-stu-id="86755-212">To accomplish this, start by converting the `HiredDate` BoundField into a TemplateField.</span></span> <span data-ttu-id="86755-213">只要移至 GridView 的智慧標籤，然後按一下 [編輯資料行] 連結，就會出現 [欄位] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="86755-213">Simply go to the GridView's smart tag and click the Edit Columns link, bringing up the Fields dialog box.</span></span> <span data-ttu-id="86755-214">選取 [`HiredDate`] BoundField，然後按一下 [將此欄位轉換成 TemplateField]。</span><span class="sxs-lookup"><span data-stu-id="86755-214">Select the `HiredDate` BoundField and click "Convert this field into a TemplateField."</span></span>

<span data-ttu-id="86755-215">[![將 HiredDate BoundField 轉換為 TemplateField](using-templatefields-in-the-gridview-control-vb/_static/image32.png)](using-templatefields-in-the-gridview-control-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="86755-215">[![Convert the HiredDate BoundField Into a TemplateField](using-templatefields-in-the-gridview-control-vb/_static/image32.png)](using-templatefields-in-the-gridview-control-vb/_static/image31.png)</span></span>

<span data-ttu-id="86755-216">**圖 11**：將 `HiredDate` BoundField 轉換成 TemplateField （[按一下以查看完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image33.png)）</span><span class="sxs-lookup"><span data-stu-id="86755-216">**Figure 11**: Convert the `HiredDate` BoundField Into a TemplateField ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image33.png))</span></span>

<span data-ttu-id="86755-217">如我們在步驟2中所見，這會將 BoundField 取代為包含 `ItemTemplate` 的 TemplateField，並將其 `Text` 屬性會使用資料系結語法 `<%# Bind("HiredDate")%>`系結至 `HiredDate` 值的標籤和文字方塊 `EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="86755-217">As we saw in Step 2, this will replace the BoundField with a TemplateField that contains an `ItemTemplate` and `EditItemTemplate` with a Label and TextBox whose `Text` properties are bound to the `HiredDate` value using the databinding syntax `<%# Bind("HiredDate")%>`.</span></span>

<span data-ttu-id="86755-218">若要將文字取代為 Calendar 控制項，請藉由移除標籤並加入行事曆控制項來編輯範本。</span><span class="sxs-lookup"><span data-stu-id="86755-218">To replace the text with a Calendar control, edit the template by removing the Label and adding a Calendar control.</span></span> <span data-ttu-id="86755-219">從設計工具中，選取 GridView 智慧標籤中的 [編輯範本]，然後從下拉式清單中選擇 `HireDate` TemplateField 的 `ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="86755-219">From the Designer, select Edit Templates from the GridView's smart tag and choose the `HireDate` TemplateField's `ItemTemplate` from the drop-down list.</span></span> <span data-ttu-id="86755-220">接下來，刪除標籤控制項，並將行事曆控制項從 [工具箱] 拖曳至範本編輯介面。</span><span class="sxs-lookup"><span data-stu-id="86755-220">Next, delete the Label control and drag a Calendar control from the Toolbox into the template editing interface.</span></span>

<span data-ttu-id="86755-221">[![將行事曆控制項加入至雇用 TemplateField 的 ItemTemplate](using-templatefields-in-the-gridview-control-vb/_static/image35.png)](using-templatefields-in-the-gridview-control-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="86755-221">[![Add a Calendar Control to the HireDate TemplateField's ItemTemplate](using-templatefields-in-the-gridview-control-vb/_static/image35.png)](using-templatefields-in-the-gridview-control-vb/_static/image34.png)</span></span>

<span data-ttu-id="86755-222">**圖 12**：將行事曆控制項加入至 `HireDate` TemplateField 的 `ItemTemplate` （[按一下以觀看完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image36.png)）</span><span class="sxs-lookup"><span data-stu-id="86755-222">**Figure 12**: Add a Calendar Control to the `HireDate` TemplateField's `ItemTemplate` ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image36.png))</span></span>

<span data-ttu-id="86755-223">此時，GridView 中的每個資料列都會在其 `HiredDate` TemplateField 中包含行事曆控制項。</span><span class="sxs-lookup"><span data-stu-id="86755-223">At this point each row in the GridView will contain a Calendar control in its `HiredDate` TemplateField.</span></span> <span data-ttu-id="86755-224">不過，員工的實際 `HiredDate` 值不會設定在行事曆控制項中的任何位置，導致每個行事曆控制項預設為顯示目前的月份和日期。</span><span class="sxs-lookup"><span data-stu-id="86755-224">However, the employee's actual `HiredDate` value is not set anywhere in the Calendar control, causing each Calendar control to default to showing the current month and date.</span></span> <span data-ttu-id="86755-225">若要解決此問題，我們必須將每個員工的 `HiredDate` 指派給行事曆控制項的[SelectedDate](https://msdn.microsoft.com/library/system.web.ui.webcontrols.calendar.selecteddate(VS.80).aspx)和[VisibleDate](https://msdn.microsoft.com/library/system.web.ui.webcontrols.calendar.visibledate(VS.80).aspx)屬性。</span><span class="sxs-lookup"><span data-stu-id="86755-225">To remedy this, we need to assign each employee's `HiredDate` to the Calendar control's [SelectedDate](https://msdn.microsoft.com/library/system.web.ui.webcontrols.calendar.selecteddate(VS.80).aspx) and [VisibleDate](https://msdn.microsoft.com/library/system.web.ui.webcontrols.calendar.visibledate(VS.80).aspx) properties.</span></span>

<span data-ttu-id="86755-226">從行事曆控制項的智慧標籤中，選擇 [編輯系結]。</span><span class="sxs-lookup"><span data-stu-id="86755-226">From the Calendar control's smart tag, choose Edit DataBindings.</span></span> <span data-ttu-id="86755-227">接下來，將 `SelectedDate` 和 `VisibleDate` 屬性系結至 `HiredDate` 的資料欄位。</span><span class="sxs-lookup"><span data-stu-id="86755-227">Next, bind both `SelectedDate` and `VisibleDate` properties to the `HiredDate` data field.</span></span>

<span data-ttu-id="86755-228">[![將 SelectedDate 和 VisibleDate 屬性系結至 HiredDate 資料欄位](using-templatefields-in-the-gridview-control-vb/_static/image38.png)](using-templatefields-in-the-gridview-control-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="86755-228">[![Bind the SelectedDate and VisibleDate Properties to the HiredDate Data Field](using-templatefields-in-the-gridview-control-vb/_static/image38.png)](using-templatefields-in-the-gridview-control-vb/_static/image37.png)</span></span>

<span data-ttu-id="86755-229">**圖 13**：將 `SelectedDate` 和 `VisibleDate` 屬性系結至 `HiredDate` 資料欄位（[按一下以查看完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image39.png)）</span><span class="sxs-lookup"><span data-stu-id="86755-229">**Figure 13**: Bind the `SelectedDate` and `VisibleDate` Properties to the `HiredDate` Data Field ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image39.png))</span></span>

> [!NOTE]
> <span data-ttu-id="86755-230">行事曆控制項的選取日期不一定是可見的。</span><span class="sxs-lookup"><span data-stu-id="86755-230">The Calendar control's selected date need not necessarily be visible.</span></span> <span data-ttu-id="86755-231">例如，行事曆可能會有8月1日<sup>聖</sup>1999 做為選取的日期，但會顯示目前的月份和年份。</span><span class="sxs-lookup"><span data-stu-id="86755-231">For example, a Calendar may have August 1<sup>st</sup>, 1999 as the selected date, but be showing the current month and year.</span></span> <span data-ttu-id="86755-232">選取的日期和可見日期是由行事曆控制項的 `SelectedDate` 和 `VisibleDate` 屬性所指定。</span><span class="sxs-lookup"><span data-stu-id="86755-232">The selected date and visible date are specified by the Calendar control's `SelectedDate` and `VisibleDate` properties.</span></span> <span data-ttu-id="86755-233">因為我們想要選取員工的 `HiredDate`，並確定已顯示，所以我們需要將這兩個屬性系結至 [`HireDate` 資料] 欄位。</span><span class="sxs-lookup"><span data-stu-id="86755-233">Since we want to both select the employee's `HiredDate` and make sure that it's shown we need to bind both of these properties to the `HireDate` data field.</span></span>

<span data-ttu-id="86755-234">在瀏覽器中觀看頁面時，行事曆現在會顯示員工雇用日期的月份，並選取該特定日期。</span><span class="sxs-lookup"><span data-stu-id="86755-234">When viewing the page in a browser, the calendar now shows the month of the employee's hired date and selects that particular date.</span></span>

<span data-ttu-id="86755-235">[![員工的 HiredDate 顯示在行事曆控制項中](using-templatefields-in-the-gridview-control-vb/_static/image41.png)](using-templatefields-in-the-gridview-control-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="86755-235">[![The Employee's HiredDate is Shown in the Calendar Control](using-templatefields-in-the-gridview-control-vb/_static/image41.png)](using-templatefields-in-the-gridview-control-vb/_static/image40.png)</span></span>

<span data-ttu-id="86755-236">**圖 14**：員工的 `HiredDate` 會顯示在行事曆控制項中（[按一下以查看完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image42.png)）</span><span class="sxs-lookup"><span data-stu-id="86755-236">**Figure 14**: The Employee's `HiredDate` is Shown in the Calendar Control ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image42.png))</span></span>

> [!NOTE]
> <span data-ttu-id="86755-237">相反地，我們在本教學課程中看到的所有範例，我們並未*將此*GridView 的 `EnableViewState` 屬性設定為 `False`。</span><span class="sxs-lookup"><span data-stu-id="86755-237">Contrary to all the examples we've seen thus far, for this tutorial we did *not* set `EnableViewState` property to `False` for this GridView.</span></span> <span data-ttu-id="86755-238">這項決策的原因是因為按一下行事曆控制項的日期會導致回傳，將行事曆的選取日期設定為剛才按下的日期。</span><span class="sxs-lookup"><span data-stu-id="86755-238">The reason for this decision is because clicking the dates of the Calendar control causes a postback, setting the Calendar's selected date to the date just clicked.</span></span> <span data-ttu-id="86755-239">不過，如果 GridView 的 view 狀態已停用，則 GridView 的資料會重新系結至其基礎資料來源，這會導致行事曆的選取日期設定*回*員工的 `HireDate`，並覆寫使用者選擇的日期。</span><span class="sxs-lookup"><span data-stu-id="86755-239">If the GridView's view state is disabled, however, on each postback the GridView's data is rebound to its underlying data source, which causes the Calendar's selected date to be set *back* to the employee's `HireDate`, overwriting the date chosen by the user.</span></span>

<span data-ttu-id="86755-240">在本教學課程中，這是想法的討論，因為使用者無法更新員工的 `HireDate`。</span><span class="sxs-lookup"><span data-stu-id="86755-240">For this tutorial this is a moot discussion since the user is not able to update the employee's `HireDate`.</span></span> <span data-ttu-id="86755-241">最好是設定 Calendar 控制項，使其日期無法選取。</span><span class="sxs-lookup"><span data-stu-id="86755-241">It would probably be best to configure the Calendar control so that its dates are not selectable.</span></span> <span data-ttu-id="86755-242">不論如何，本教學課程會顯示在某些情況下，必須啟用狀態，才能提供特定功能。</span><span class="sxs-lookup"><span data-stu-id="86755-242">Regardless, this tutorial shows that in some circumstances view state must be enabled in order to provide certain functionality.</span></span>

## <a name="step-4-showing-the-number-of-days-the-employee-has-worked-for-the-company"></a><span data-ttu-id="86755-243">步驟4：顯示員工為公司工作的天數</span><span class="sxs-lookup"><span data-stu-id="86755-243">Step 4: Showing the Number of Days the Employee Has Worked for the Company</span></span>

<span data-ttu-id="86755-244">到目前為止，我們已經看過 TemplateFields 的兩個應用程式：</span><span class="sxs-lookup"><span data-stu-id="86755-244">So far we have seen two applications of TemplateFields:</span></span>

- <span data-ttu-id="86755-245">將兩個或多個資料欄值結合成一個資料行，以及</span><span class="sxs-lookup"><span data-stu-id="86755-245">Combining two or more data field values into one column, and</span></span>
- <span data-ttu-id="86755-246">使用 Web 控制項（而非文字）來表示資料欄位值</span><span class="sxs-lookup"><span data-stu-id="86755-246">Expressing a data field value using a Web control instead of text</span></span>

<span data-ttu-id="86755-247">TemplateFields 的第三個用法是顯示 GridView 基礎資料的中繼資料。</span><span class="sxs-lookup"><span data-stu-id="86755-247">A third use of TemplateFields is in displaying metadata about the GridView's underlying data.</span></span> <span data-ttu-id="86755-248">例如，除了顯示員工的雇用日期以外，我們可能也會想要有一個資料行顯示他們在工作上的總天數。</span><span class="sxs-lookup"><span data-stu-id="86755-248">In addition to showing the employees' hire dates, for example, we might also want to have a column that displays how many total days they've been on the job.</span></span>

<span data-ttu-id="86755-249">另一個使用 TemplateFields 的情況，是在基礎資料需要以不同的方式顯示在網頁報表中，而不是儲存在資料庫中的格式。</span><span class="sxs-lookup"><span data-stu-id="86755-249">Yet another use of TemplateFields arises in scenarios when the underlying data needs to be displayed differently in the web page report than in the format it's stored in the database.</span></span> <span data-ttu-id="86755-250">假設 `Employees` 資料表有一個 `Gender` 欄位，其中儲存了字元 `M` 或 `F` 以指出員工的性別。</span><span class="sxs-lookup"><span data-stu-id="86755-250">Imagine that the `Employees` table had a `Gender` field that stored the character `M` or `F` to indicate the sex of the employee.</span></span> <span data-ttu-id="86755-251">在網頁中顯示此資訊時，我們可能會想要將性別顯示為「男」或「女性」，而不只是 "M" 或 "F"。</span><span class="sxs-lookup"><span data-stu-id="86755-251">When displaying this information in a web page we might want to show the gender as either "Male" or "Female", as opposed to just "M" or "F".</span></span>

<span data-ttu-id="86755-252">這兩種情況都可以藉由在 ASP.NET 網頁的程式碼後置類別中建立*格式方法*來處理（或是在個別的類別庫中，並實作為 `Shared` 方法），以從範本叫用。</span><span class="sxs-lookup"><span data-stu-id="86755-252">Both of these scenarios can be handled by creating a *formatting method* in the ASP.NET page's code-behind class (or in a separate class library, implemented as a `Shared` method) that is invoked from the template.</span></span> <span data-ttu-id="86755-253">這類格式化方法是使用稍早所見的相同資料系結語法，從範本叫用。</span><span class="sxs-lookup"><span data-stu-id="86755-253">Such a formatting method is invoked from the template using the same databinding syntax seen earlier.</span></span> <span data-ttu-id="86755-254">格式化方法可以接受任意數目的參數，但必須傳回字串。</span><span class="sxs-lookup"><span data-stu-id="86755-254">The formatting method can take in any number of parameters, but must return a string.</span></span> <span data-ttu-id="86755-255">這個傳回的字串是插入範本中的 HTML。</span><span class="sxs-lookup"><span data-stu-id="86755-255">This returned string is the HTML that is injected into the template.</span></span>

<span data-ttu-id="86755-256">為了說明這個概念，讓我們來擴充教學課程，以顯示一個資料行，其中列出員工在工作上的總天數。</span><span class="sxs-lookup"><span data-stu-id="86755-256">To illustrate this concept, let's augment our tutorial to show a column that lists the total number of days an employee has been on the job.</span></span> <span data-ttu-id="86755-257">此格式化方法會採用 `Northwind.EmployeesRow` 物件，並傳回將員工作為字串使用的天數。</span><span class="sxs-lookup"><span data-stu-id="86755-257">This formatting method will take in a `Northwind.EmployeesRow` object and return the number of days the employee has been employed as a string.</span></span> <span data-ttu-id="86755-258">這個方法可以加入至 ASP.NET 網頁的程式碼後置類別，但*必須*標示為 `Protected` 或 `Public`，才能從範本存取。</span><span class="sxs-lookup"><span data-stu-id="86755-258">This method can be added to the ASP.NET page's code-behind class, but *must* be marked as `Protected` or `Public` in order to be accessible from the template.</span></span>

[!code-vb[Main](using-templatefields-in-the-gridview-control-vb/samples/sample5.vb)]

<span data-ttu-id="86755-259">由於 `HiredDate` 欄位可以包含 `NULL` 的資料庫值，因此我們必須先確定不 `NULL` 值，再繼續進行計算。</span><span class="sxs-lookup"><span data-stu-id="86755-259">Since the `HiredDate` field can contain `NULL` database values we must first ensure that the value is not `NULL` before proceeding with the calculation.</span></span> <span data-ttu-id="86755-260">如果 `NULL``HiredDate` 值，我們只會傳回字串 "Unknown";如果未 `NULL`，我們會計算目前時間與 `HiredDate` 值之間的差異，並傳回天數。</span><span class="sxs-lookup"><span data-stu-id="86755-260">If the `HiredDate` value is `NULL`, we simply return the string "Unknown"; if it is not `NULL`, we compute the difference between the current time and the `HiredDate` value and return the number of days.</span></span>

<span data-ttu-id="86755-261">若要利用這個方法，我們必須使用資料系結語法，從 GridView 中的 TemplateField 叫用它。</span><span class="sxs-lookup"><span data-stu-id="86755-261">To utilize this method we need to invoke it from a TemplateField in the GridView using the databinding syntax.</span></span> <span data-ttu-id="86755-262">首先，按一下 GridView 智慧標籤中的 [編輯資料行] 連結，然後加入新的 TemplateField，以將新的 TemplateField 加入 GridView。</span><span class="sxs-lookup"><span data-stu-id="86755-262">Start by adding a new TemplateField to the GridView by clicking on the Edit Columns link in the GridView's smart tag and adding a new TemplateField.</span></span>

<span data-ttu-id="86755-263">[![將新的 TemplateField 新增至 GridView](using-templatefields-in-the-gridview-control-vb/_static/image44.png)](using-templatefields-in-the-gridview-control-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="86755-263">[![Add a New TemplateField to the GridView](using-templatefields-in-the-gridview-control-vb/_static/image44.png)](using-templatefields-in-the-gridview-control-vb/_static/image43.png)</span></span>

<span data-ttu-id="86755-264">**圖 15**：將新的 TemplateField 加入 GridView （[按一下以觀看完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image45.png)）</span><span class="sxs-lookup"><span data-stu-id="86755-264">**Figure 15**: Add a New TemplateField to the GridView ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image45.png))</span></span>

<span data-ttu-id="86755-265">將這個新的 TemplateField 的 `HeaderText` 屬性設定為 [作業上的天數]，並將其 `ItemStyle`的 `HorizontalAlign` 屬性設為 `Center`。</span><span class="sxs-lookup"><span data-stu-id="86755-265">Set this new TemplateField's `HeaderText` property to "Days on the Job" and its `ItemStyle`'s `HorizontalAlign` property to `Center`.</span></span> <span data-ttu-id="86755-266">若要從範本呼叫 `DisplayDaysOnJob` 方法，請加入 `ItemTemplate` 並使用下列資料系結語法：</span><span class="sxs-lookup"><span data-stu-id="86755-266">To call the `DisplayDaysOnJob` method from the template, add an `ItemTemplate` and use the following databinding syntax:</span></span>

[!code-aspx[Main](using-templatefields-in-the-gridview-control-vb/samples/sample6.aspx)]

<span data-ttu-id="86755-267">`Container.DataItem` 會傳回與系結至 `GridViewRow`之 `DataSource` 記錄對應的 `DataRowView` 物件。</span><span class="sxs-lookup"><span data-stu-id="86755-267">`Container.DataItem` returns a `DataRowView` object corresponding to the `DataSource` record bound to the `GridViewRow`.</span></span> <span data-ttu-id="86755-268">其 `Row` 屬性會傳回強型別 `Northwind.EmployeesRow`，傳遞至 `DisplayDaysOnJob` 方法。</span><span class="sxs-lookup"><span data-stu-id="86755-268">Its `Row` property returns the strongly-typed `Northwind.EmployeesRow`, which is passed to the `DisplayDaysOnJob` method.</span></span> <span data-ttu-id="86755-269">這個資料系結語法可以直接出現在 `ItemTemplate` 中（如下面的宣告式語法所示），也可以指派給標籤 Web 控制項的 `Text` 屬性。</span><span class="sxs-lookup"><span data-stu-id="86755-269">This databinding syntax can appear directly in the `ItemTemplate` (as shown in the declarative syntax below) or can be assigned to the `Text` property of a Label Web control.</span></span>

> [!NOTE]
> <span data-ttu-id="86755-270">或者，我們可以使用 `<%# DisplayDaysOnJob(Eval("HireDate")) %>`來傳入 `HireDate` 值，而不是傳入 `EmployeesRow` 實例。</span><span class="sxs-lookup"><span data-stu-id="86755-270">Alternatively, instead of passing in an `EmployeesRow` instance, we could just pass in the `HireDate` value using `<%# DisplayDaysOnJob(Eval("HireDate")) %>`.</span></span> <span data-ttu-id="86755-271">不過，`Eval` 方法會傳回 `Object`，因此我們必須變更 `DisplayDaysOnJob` 方法簽章，改為接受 `Object`類型的輸入參數。</span><span class="sxs-lookup"><span data-stu-id="86755-271">However, the `Eval` method returns an `Object`, so we'd have to change our `DisplayDaysOnJob` method signature to accept an input parameter of type `Object`, instead.</span></span> <span data-ttu-id="86755-272">我們無法盲目地將 `Eval("HireDate")` 呼叫轉型為 `DateTime`，因為 `Employees` 資料表中的 `HireDate` 資料行可以包含 `NULL` 值。</span><span class="sxs-lookup"><span data-stu-id="86755-272">We can't blindly cast the `Eval("HireDate")` call to a `DateTime` because the `HireDate` column in the `Employees` table can contain `NULL` values.</span></span> <span data-ttu-id="86755-273">因此，我們必須接受 `Object` 做為 `DisplayDaysOnJob` 方法的輸入參數，並檢查它是否有資料庫 `NULL` 值（可以使用 `Convert.IsDBNull(objectToCheck)`來完成），然後再繼續進行。</span><span class="sxs-lookup"><span data-stu-id="86755-273">Therefore, we'd need to accept an `Object` as the input parameter for the `DisplayDaysOnJob` method, check to see if it had a database `NULL` value (which can be accomplished using `Convert.IsDBNull(objectToCheck)`), and then proceed accordingly.</span></span>

<span data-ttu-id="86755-274">由於這些微妙差異，我選擇傳入整個 `EmployeesRow` 實例。</span><span class="sxs-lookup"><span data-stu-id="86755-274">Due to these subtleties I've opted to pass in the entire `EmployeesRow` instance.</span></span> <span data-ttu-id="86755-275">在下一個教學課程中，我們會看到一個更適合的範例，說明如何使用 `Eval("columnName")` 語法將輸入參數傳遞至格式化方法。</span><span class="sxs-lookup"><span data-stu-id="86755-275">In the next tutorial we'll see a more fitting example for using the `Eval("columnName")` syntax for passing an input parameter into a formatting method.</span></span>

<span data-ttu-id="86755-276">以下顯示在加入 TemplateField 之後，GridView 的宣告式語法，以及從 `ItemTemplate`呼叫的 `DisplayDaysOnJob` 方法：</span><span class="sxs-lookup"><span data-stu-id="86755-276">The following shows the declarative syntax for our GridView after the TemplateField has been added and the `DisplayDaysOnJob` method called from the `ItemTemplate`:</span></span>

[!code-aspx[Main](using-templatefields-in-the-gridview-control-vb/samples/sample7.aspx)]

<span data-ttu-id="86755-277">[圖 16] 顯示透過瀏覽器觀看時完成的教學課程。</span><span class="sxs-lookup"><span data-stu-id="86755-277">Figure 16 shows the completed tutorial, when viewed through a browser.</span></span>

<span data-ttu-id="86755-278">[![顯示員工已在工作上的天數](using-templatefields-in-the-gridview-control-vb/_static/image47.png)](using-templatefields-in-the-gridview-control-vb/_static/image46.png)</span><span class="sxs-lookup"><span data-stu-id="86755-278">[![The Number of Days the Employee Has Been on the Job is Displayed](using-templatefields-in-the-gridview-control-vb/_static/image47.png)](using-templatefields-in-the-gridview-control-vb/_static/image46.png)</span></span>

<span data-ttu-id="86755-279">**圖 16**：顯示員工在工作上的天數（[按一下以觀看完整大小的影像](using-templatefields-in-the-gridview-control-vb/_static/image48.png)）</span><span class="sxs-lookup"><span data-stu-id="86755-279">**Figure 16**: The Number of Days the Employee Has Been on the Job is Displayed ([Click to view full-size image](using-templatefields-in-the-gridview-control-vb/_static/image48.png))</span></span>

## <a name="summary"></a><span data-ttu-id="86755-280">總結</span><span class="sxs-lookup"><span data-stu-id="86755-280">Summary</span></span>

<span data-ttu-id="86755-281">GridView 控制項中的 TemplateField 允許比其他欄位控制項提供更高的彈性來顯示資料。</span><span class="sxs-lookup"><span data-stu-id="86755-281">The TemplateField in the GridView control allows for a higher degree of flexibility in displaying data than is available with the other field controls.</span></span> <span data-ttu-id="86755-282">TemplateFields 適用于下列情況：</span><span class="sxs-lookup"><span data-stu-id="86755-282">TemplateFields are ideal for situations where:</span></span>

- <span data-ttu-id="86755-283">多個資料欄位必須顯示在一個 GridView 資料行中</span><span class="sxs-lookup"><span data-stu-id="86755-283">Multiple data fields need to be displayed in one GridView column</span></span>
- <span data-ttu-id="86755-284">資料最適合使用 Web 控制項而非純文字來表示</span><span class="sxs-lookup"><span data-stu-id="86755-284">The data is best expressed using a Web control rather than plain text</span></span>
- <span data-ttu-id="86755-285">輸出取決於基礎資料，例如顯示中繼資料或重新格式化資料</span><span class="sxs-lookup"><span data-stu-id="86755-285">The output depends on the underlying data, such as displaying metadata or in reformatting the data</span></span>

<span data-ttu-id="86755-286">除了自訂資料的顯示之外，TemplateFields 也會用來自訂用於編輯和插入資料的使用者介面，如我們在未來的教學課程中所見。</span><span class="sxs-lookup"><span data-stu-id="86755-286">In addition to customizing the display of data, TemplateFields are also used for customizing the user interfaces used for editing and inserting data, as we'll see in future tutorials.</span></span>

<span data-ttu-id="86755-287">接下來的兩個教學課程會繼續探索範本，一開始請先參閱在 DetailsView 中使用 TemplateFields。</span><span class="sxs-lookup"><span data-stu-id="86755-287">The next two tutorials continue exploring templates, starting with a look at using TemplateFields in a DetailsView.</span></span> <span data-ttu-id="86755-288">接下來，我們會轉變成 FormView，其使用範本代替欄位來提供資料版面配置和結構的更大彈性。</span><span class="sxs-lookup"><span data-stu-id="86755-288">Following that, we'll turn to the FormView, which uses templates in lieu of fields to provide greater flexibility in the layout and structure of the data.</span></span>

<span data-ttu-id="86755-289">快樂的程式設計！</span><span class="sxs-lookup"><span data-stu-id="86755-289">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="86755-290">關於作者</span><span class="sxs-lookup"><span data-stu-id="86755-290">About the Author</span></span>

<span data-ttu-id="86755-291">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，自1998起，有七個 ASP/ASP. NET 書籍和創辦人的[4GuysFromRolla.com](http://www.4guysfromrolla.com)。</span><span class="sxs-lookup"><span data-stu-id="86755-291">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="86755-292">Scott 以獨立的顧問、訓練員和作者的身分運作。</span><span class="sxs-lookup"><span data-stu-id="86755-292">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="86755-293">他的最新著作是[*在24小時內讓自己的 ASP.NET 2.0*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="86755-293">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="86755-294">他可以在mitchell@4GuysFromRolla.com觸達[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="86755-294">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="86755-295">或者透過他的 blog，可以在[http://ScottOnWriting.NET](http://ScottOnWriting.NET)找到。</span><span class="sxs-lookup"><span data-stu-id="86755-295">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="86755-296">特別感謝</span><span class="sxs-lookup"><span data-stu-id="86755-296">Special Thanks To</span></span>

<span data-ttu-id="86755-297">本教學課程系列已由許多有用的審核者所審查。</span><span class="sxs-lookup"><span data-stu-id="86755-297">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="86755-298">本教學課程的領導審查者為 Dan Jagers。</span><span class="sxs-lookup"><span data-stu-id="86755-298">Lead reviewer for this tutorial was Dan Jagers.</span></span> <span data-ttu-id="86755-299">有興趣複習我即將發行的 MSDN 文章嗎？</span><span class="sxs-lookup"><span data-stu-id="86755-299">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="86755-300">若是如此，請在mitchell@4GuysFromRolla.com的那一行下拉式[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="86755-300">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="86755-301">[上一頁](custom-formatting-based-upon-data-vb.md)
> [下一頁](using-templatefields-in-the-detailsview-control-vb.md)</span><span class="sxs-lookup"><span data-stu-id="86755-301">[Previous](custom-formatting-based-upon-data-vb.md)
[Next](using-templatefields-in-the-detailsview-control-vb.md)</span></span>
