---
uid: web-forms/overview/data-access/custom-formatting/using-templatefields-in-the-detailsview-control-vb
title: DetailsView 控制項 (VB) 中使用 TemplateFields |Microsoft Docs
author: rick-anderson
description: 使用 GridView，您可以使用相同的 TemplateFields 功能也可與 DetailsView 控制項。 在本教學課程中，我們會顯示一項產品...
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 0b91d5f8-127d-4f6a-b204-f2e2b35ef703
msc.legacyurl: /web-forms/overview/data-access/custom-formatting/using-templatefields-in-the-detailsview-control-vb
msc.type: authoredcontent
ms.openlocfilehash: 9a2f500206bbdc09d8007e10c0c7464f1ba384a3
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/09/2019
ms.locfileid: "59395065"
---
# <a name="using-templatefields-in-the-detailsview-control-vb"></a><span data-ttu-id="425ad-104">在 DetailsView 控制項中使用 TemplateFields (VB)</span><span class="sxs-lookup"><span data-stu-id="425ad-104">Using TemplateFields in the DetailsView Control (VB)</span></span>

<span data-ttu-id="425ad-105">藉由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="425ad-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="425ad-106">[下載範例應用程式](http://download.microsoft.com/download/5/7/0/57084608-dfb3-4781-991c-407d086e2adc/ASPNET_Data_Tutorial_13_VB.exe)或[下載 PDF](using-templatefields-in-the-detailsview-control-vb/_static/datatutorial13vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="425ad-106">[Download Sample App](http://download.microsoft.com/download/5/7/0/57084608-dfb3-4781-991c-407d086e2adc/ASPNET_Data_Tutorial_13_VB.exe) or [Download PDF](using-templatefields-in-the-detailsview-control-vb/_static/datatutorial13vb1.pdf)</span></span>

> <span data-ttu-id="425ad-107">使用 GridView，您可以使用相同的 TemplateFields 功能也可與 DetailsView 控制項。</span><span class="sxs-lookup"><span data-stu-id="425ad-107">The same TemplateFields capabilities available with the GridView are also available with the DetailsView control.</span></span> <span data-ttu-id="425ad-108">在本教學課程中，我們會顯示一項產品使用包含 TemplateFields DetailsView 一次。</span><span class="sxs-lookup"><span data-stu-id="425ad-108">In this tutorial we'll display one product at a time using a DetailsView containing TemplateFields.</span></span>


## <a name="introduction"></a><span data-ttu-id="425ad-109">簡介</span><span class="sxs-lookup"><span data-stu-id="425ad-109">Introduction</span></span>

<span data-ttu-id="425ad-110">TemplateField 提供較高的轉譯資料的彈性比 BoundField、 CheckBoxField、 HyperLinkField 和其他資料欄位的控制項。</span><span class="sxs-lookup"><span data-stu-id="425ad-110">The TemplateField offers a higher degree of flexibility in rendering data than the BoundField, CheckBoxField, HyperLinkField, and other data field controls.</span></span> <span data-ttu-id="425ad-111">在 [先前的教學課程](using-templatefields-in-the-gridview-control-vb.md)我們探討了 GridView，以在使用 TemplateField:</span><span class="sxs-lookup"><span data-stu-id="425ad-111">In the [previous tutorial](using-templatefields-in-the-gridview-control-vb.md) we looked at using the TemplateField in a GridView to:</span></span>

- <span data-ttu-id="425ad-112">顯示一個資料行中的多個資料欄位值。</span><span class="sxs-lookup"><span data-stu-id="425ad-112">Display multiple data field values in one column.</span></span> <span data-ttu-id="425ad-113">具體而言，兩者`FirstName`和`LastName`欄位已合併為一個 GridView 資料行。</span><span class="sxs-lookup"><span data-stu-id="425ad-113">Specifically, both the `FirstName` and `LastName` fields were combined into one GridView column.</span></span>
- <span data-ttu-id="425ad-114">您可以使用替代的 Web 控制項來表示資料欄位值。</span><span class="sxs-lookup"><span data-stu-id="425ad-114">Use an alternate Web control to express a data field value.</span></span> <span data-ttu-id="425ad-115">我們了解如何顯示`HiredDate`值使用日曆控制項。</span><span class="sxs-lookup"><span data-stu-id="425ad-115">We saw how to show the `HiredDate` value using a Calendar control.</span></span>
- <span data-ttu-id="425ad-116">顯示根據基礎資料的狀態資訊。</span><span class="sxs-lookup"><span data-stu-id="425ad-116">Show status information based on the underlying data.</span></span> <span data-ttu-id="425ad-117">雖然`Employees`資料表不包含傳回的員工已在工作的天數的資料行中，我們能夠使用 TemplateField 和格式化的方法與先前的教學課程中，這項資訊顯示在 GridView 範例。</span><span class="sxs-lookup"><span data-stu-id="425ad-117">While the `Employees` table does not contain a column that returns the number of days an employee has been on the job, we were able to display such information in the GridView example in the previous tutorial with the use of a TemplateField and formatting method.</span></span>

<span data-ttu-id="425ad-118">使用 GridView，您可以使用相同的 TemplateFields 功能也可與 DetailsView 控制項。</span><span class="sxs-lookup"><span data-stu-id="425ad-118">The same TemplateFields capabilities available with the GridView are also available with the DetailsView control.</span></span> <span data-ttu-id="425ad-119">在本教學課程中，我們會顯示一項產品使用包含兩個 TemplateFields DetailsView 一次。</span><span class="sxs-lookup"><span data-stu-id="425ad-119">In this tutorial we'll display one product at a time using a DetailsView that contains two TemplateFields.</span></span> <span data-ttu-id="425ad-120">將合併的第一個 TemplateField `UnitPrice`， `UnitsInStock`，和`UnitsOnOrder`進一 DetailsView 資料列的資料欄位。</span><span class="sxs-lookup"><span data-stu-id="425ad-120">The first TemplateField will combine the `UnitPrice`, `UnitsInStock`, and `UnitsOnOrder` data fields into one DetailsView row.</span></span> <span data-ttu-id="425ad-121">值會顯示第二個 TemplateField`Discontinued`欄位中，但會使用"YES"時，要顯示的格式化方法`Discontinued`是`True`，「 否 」 則。</span><span class="sxs-lookup"><span data-stu-id="425ad-121">The second TemplateField will display the value of the `Discontinued` field, but will use a formatting method to display "YES" if `Discontinued` is `True`, and "NO" otherwise.</span></span>


[![T<span data-ttu-id="425ad-122">wo TemplateFields 可用來自訂顯示]</span><span class="sxs-lookup"><span data-stu-id="425ad-122">wo TemplateFields are Used to Customize the Display]</span></span>(using-templatefields-in-the-detailsview-control-vb/_static/image2.png)](using-templatefields-in-the-detailsview-control-vb/_static/image1.png)

<span data-ttu-id="425ad-123">**圖 1**:可用來自訂顯示兩個 TemplateFields ([按一下以檢視完整大小的影像](using-templatefields-in-the-detailsview-control-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="425ad-123">**Figure 1**: Two TemplateFields are Used to Customize the Display ([Click to view full-size image](using-templatefields-in-the-detailsview-control-vb/_static/image3.png))</span></span>


<span data-ttu-id="425ad-124">讓我們開始吧 ！</span><span class="sxs-lookup"><span data-stu-id="425ad-124">Let's get started!</span></span>

## <a name="step-1-binding-the-data-to-the-detailsview"></a><span data-ttu-id="425ad-125">步驟 1：資料繫結至 DetailsView</span><span class="sxs-lookup"><span data-stu-id="425ad-125">Step 1: Binding the Data to the DetailsView</span></span>

<span data-ttu-id="425ad-126">所述在先前的教學課程中使用的 TemplateFields 通常是最簡單的方式著手建立 DetailsView 控制項，其中包含只 BoundFields 然後新增新的 TemplateFields 或現有 BoundFields 轉換為 TemplateFields 時所需.</span><span class="sxs-lookup"><span data-stu-id="425ad-126">As discussed in the previous tutorial, when working with TemplateFields it's often easiest to start by creating the DetailsView control that contains just BoundFields and then add new TemplateFields or convert the existing BoundFields to TemplateFields as needed.</span></span> <span data-ttu-id="425ad-127">因此，開始本教學課程將 DetailsView 新增至透過設計工具頁面，並繫結至 ObjectDataSource 會傳回產品的清單。</span><span class="sxs-lookup"><span data-stu-id="425ad-127">Therefore, start this tutorial by adding a DetailsView to the page through the Designer and binding it to an ObjectDataSource that returns the list of products.</span></span> <span data-ttu-id="425ad-128">這些步驟將會針對每個產品的非布林值欄位及其一個布林值欄位 (Discontinued)，以建立與 BoundFields DetailsView。</span><span class="sxs-lookup"><span data-stu-id="425ad-128">These steps will create a DetailsView with BoundFields for each of the product's non-Boolean value fields and a CheckBoxField for the one Boolean value field (Discontinued).</span></span>

<span data-ttu-id="425ad-129">開啟`DetailsViewTemplateField.aspx`頁面上，然後從 [工具箱] 拖曳至設計工具拖曳 DetailsView。</span><span class="sxs-lookup"><span data-stu-id="425ad-129">Open the `DetailsViewTemplateField.aspx` page and drag a DetailsView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="425ad-130">從 DetailsView 的智慧標籤選擇 加入新的 ObjectDataSource 控制項叫用`ProductsBLL`類別的`GetProducts()`方法。</span><span class="sxs-lookup"><span data-stu-id="425ad-130">From the DetailsView's smart tag choose to add a new ObjectDataSource control that invokes the `ProductsBLL` class's `GetProducts()` method.</span></span>


[![A<span data-ttu-id="425ad-131">dd GetProducts() 方法會叫用的新 ObjectDataSource 控制項]</span><span class="sxs-lookup"><span data-stu-id="425ad-131">dd a New ObjectDataSource Control that Invokes the GetProducts() Method]</span></span>(using-templatefields-in-the-detailsview-control-vb/_static/image5.png)](using-templatefields-in-the-detailsview-control-vb/_static/image4.png)

<span data-ttu-id="425ad-132">**圖 2**:加入新的 ObjectDataSource 控制項該 Invokes`GetProducts()`方法 ([按一下以檢視完整大小的影像](using-templatefields-in-the-detailsview-control-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="425ad-132">**Figure 2**: Add a New ObjectDataSource Control that Invokes the `GetProducts()` Method ([Click to view full-size image](using-templatefields-in-the-detailsview-control-vb/_static/image6.png))</span></span>


<span data-ttu-id="425ad-133">此報表中移除`ProductID`， `SupplierID`， `CategoryID`，和`ReorderLevel`BoundFields。</span><span class="sxs-lookup"><span data-stu-id="425ad-133">For this report remove the `ProductID`, `SupplierID`, `CategoryID`, and `ReorderLevel` BoundFields.</span></span> <span data-ttu-id="425ad-134">接下來，重新排列 BoundFields 以便`CategoryName`並`SupplierName`BoundFields 緊接`ProductName`BoundField。</span><span class="sxs-lookup"><span data-stu-id="425ad-134">Next, reorder the BoundFields so that the `CategoryName` and `SupplierName` BoundFields appear immediately after the `ProductName` BoundField.</span></span> <span data-ttu-id="425ad-135">您可以自由調整`HeaderText`適當屬性和您 BoundFields 的格式化屬性。</span><span class="sxs-lookup"><span data-stu-id="425ad-135">Feel free to adjust the `HeaderText` properties and formatting properties for the BoundFields as you see fit.</span></span> <span data-ttu-id="425ad-136">像是 GridView，透過 [欄位] 對話方塊 （可編輯欄位中的連結 DetailsView 的智慧標籤，即可存取） 或透過宣告式語法，可以執行這些 BoundField 層級編輯。</span><span class="sxs-lookup"><span data-stu-id="425ad-136">Like with the GridView, these BoundField-level edits can be performed through the Fields dialog box (accessible by clicking on the Edit Fields link in the DetailsView's smart tag) or through the declarative syntax.</span></span> <span data-ttu-id="425ad-137">最後，清除 DetailsView`Height`和`Width`屬性值，以便在 DetailsView 控制項加入展開根據顯示的資料，並檢查的智慧標籤的 啟用分頁核取方塊。</span><span class="sxs-lookup"><span data-stu-id="425ad-137">Lastly, clear out the DetailsView's `Height` and `Width` property values in order to allow the DetailsView control to expand based on the data displayed and check the Enable Paging checkbox in the smart tag.</span></span>

<span data-ttu-id="425ad-138">進行這些變更之後，您的 DetailsView 控制項宣告式標記看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="425ad-138">After making these changes, your DetailsView control's declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](using-templatefields-in-the-detailsview-control-vb/samples/sample1.aspx)]

<span data-ttu-id="425ad-139">請花一點時間檢視透過瀏覽器頁面。</span><span class="sxs-lookup"><span data-stu-id="425ad-139">Take a moment to view the page through a browser.</span></span> <span data-ttu-id="425ad-140">此時您應該看到列出單一的產品 (Chai) 與顯示的產品名稱、 類別、 供應商、 價格、 庫存單位數、 訂購，量和其已停止的狀態的資料列。</span><span class="sxs-lookup"><span data-stu-id="425ad-140">At this point you should see a single product listed (Chai) with rows showing the product's name, category, supplier, price, units in stock, units on order, and its discontinued status.</span></span>


[![T<span data-ttu-id="425ad-141">他的產品詳細資料會顯示使用 BoundFields 數列]</span><span class="sxs-lookup"><span data-stu-id="425ad-141">he Product's Details Are Shown Using a Series of BoundFields]</span></span>(using-templatefields-in-the-detailsview-control-vb/_static/image8.png)](using-templatefields-in-the-detailsview-control-vb/_static/image7.png)

<span data-ttu-id="425ad-142">**圖 3**:產品的詳細資料會顯示使用 BoundFields 系列 ([按一下以檢視完整大小的影像](using-templatefields-in-the-detailsview-control-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="425ad-142">**Figure 3**: The Product's Details Are Shown Using a Series of BoundFields ([Click to view full-size image](using-templatefields-in-the-detailsview-control-vb/_static/image9.png))</span></span>


## <a name="step-2-combining-the-price-units-in-stock-and-units-on-order-into-one-row"></a><span data-ttu-id="425ad-143">步驟 2：將價格、 庫存量和訂購量結合成一個資料列</span><span class="sxs-lookup"><span data-stu-id="425ad-143">Step 2: Combining the Price, Units In Stock, and Units On Order Into One Row</span></span>

<span data-ttu-id="425ad-144">DetailsView 有一個資料列`UnitPrice`， `UnitsInStock`，和`UnitsOnOrder`欄位。</span><span class="sxs-lookup"><span data-stu-id="425ad-144">The DetailsView has a row for the `UnitPrice`, `UnitsInStock`, and `UnitsOnOrder` fields.</span></span> <span data-ttu-id="425ad-145">我們可以結合這些資料欄位為單一資料列的 TemplateField 藉由新增新的 TemplateField 或藉由轉換其中一個現有`UnitPrice`， `UnitsInStock`，和`UnitsOnOrder`BoundFields TemplateField 到。</span><span class="sxs-lookup"><span data-stu-id="425ad-145">We can combine these data fields into a single row with a TemplateField either by adding a new TemplateField or by converting one of the existing `UnitPrice`, `UnitsInStock`, and `UnitsOnOrder` BoundFields into a TemplateField.</span></span> <span data-ttu-id="425ad-146">雖然我個人比較偏好轉換現有 BoundFields，讓我們加入新的 TemplateField 練習。</span><span class="sxs-lookup"><span data-stu-id="425ad-146">While I personally prefer converting existing BoundFields, let's practice by adding a new TemplateField.</span></span>

<span data-ttu-id="425ad-147">在 DetailsView 的智慧標籤，即可啟動 欄位 對話方塊中的 編輯欄位 連結上按一下 啟動。</span><span class="sxs-lookup"><span data-stu-id="425ad-147">Start by clicking on the Edit Fields link in the DetailsView's smart tag to bring up the Fields dialog box.</span></span> <span data-ttu-id="425ad-148">接下來，新增新的 TemplateField，並設定其`HeaderText`屬性設為 「 價格和清查 」 並移動新的 TemplateField 讓它位於上方`UnitPrice`BoundField。</span><span class="sxs-lookup"><span data-stu-id="425ad-148">Next, add a new TemplateField and set its `HeaderText` property to "Price and Inventory" and move the new TemplateField so that it is positioned above the `UnitPrice` BoundField.</span></span>


[![A<span data-ttu-id="425ad-149">dd DetailsView 控制項的新 TemplateField]</span><span class="sxs-lookup"><span data-stu-id="425ad-149">dd a New TemplateField to the DetailsView Control]</span></span>(using-templatefields-in-the-detailsview-control-vb/_static/image11.png)](using-templatefields-in-the-detailsview-control-vb/_static/image10.png)

<span data-ttu-id="425ad-150">**圖 4**:在 DetailsView 控制項中加入新的 TemplateField ([按一下以檢視完整大小的影像](using-templatefields-in-the-detailsview-control-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="425ad-150">**Figure 4**: Add a New TemplateField to the DetailsView Control ([Click to view full-size image](using-templatefields-in-the-detailsview-control-vb/_static/image12.png))</span></span>


<span data-ttu-id="425ad-151">因為這個新的 TemplateField 會包含在目前顯示的值`UnitPrice`， `UnitsInStock`，和`UnitsOnOrder`BoundFields，讓我們將它們移除。</span><span class="sxs-lookup"><span data-stu-id="425ad-151">Since this new TemplateField will contain the values currently displayed in the `UnitPrice`, `UnitsInStock`, and `UnitsOnOrder` BoundFields, let's remove them.</span></span>

<span data-ttu-id="425ad-152">此步驟中的最後一個工作是定義`ItemTemplate`價格和清查 TemplateField，它可以是標記來完成透過 DetailsView 中的樣板編輯介面設計工具中，或以手動方式透過控制項的宣告式語法。</span><span class="sxs-lookup"><span data-stu-id="425ad-152">The last task for this step is to define the `ItemTemplate` markup for the Price and Inventory TemplateField, which can be accomplished either through the DetailsView's template editing interface in the Designer or by hand through the control's declarative syntax.</span></span> <span data-ttu-id="425ad-153">如同 GridView、 DetailsView 的範本編輯介面可以存取中的智慧標籤的 [編輯範本] 連結上即可。</span><span class="sxs-lookup"><span data-stu-id="425ad-153">As with the GridView, the DetailsView's template editing interface can be accessed by clicking on the Edit Templates link in the smart tag.</span></span> <span data-ttu-id="425ad-154">從這裡您可以選取要從下拉式清單中編輯，然後從 [工具箱] 新增任何 Web 控制項的範本。</span><span class="sxs-lookup"><span data-stu-id="425ad-154">From here you can select the template to edit from the drop-down list and then add any Web controls from the Toolbox.</span></span>

<span data-ttu-id="425ad-155">本教學課程中，開始將標籤控制項新增至為價格與清查 TemplateField `ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="425ad-155">For this tutorial, start by adding a Label control to the Price and Inventory TemplateField's `ItemTemplate`.</span></span> <span data-ttu-id="425ad-156">接下來，按一下 [編輯資料繫結] 連結，從標籤 Web 控制項的智慧標籤，並繫結`Text`屬性設`UnitPrice`欄位。</span><span class="sxs-lookup"><span data-stu-id="425ad-156">Next, click on the Edit DataBindings link from the Label Web control's smart tag and bind the `Text` property to the `UnitPrice` field.</span></span>


[![B<span data-ttu-id="425ad-157">ind UnitPrice 資料標籤的 [文字] 屬性欄位]</span><span class="sxs-lookup"><span data-stu-id="425ad-157">ind the Label's Text Property to the UnitPrice Data Field]</span></span>(using-templatefields-in-the-detailsview-control-vb/_static/image14.png)](using-templatefields-in-the-detailsview-control-vb/_static/image13.png)

<span data-ttu-id="425ad-158">**圖 5**:繫結的標籤`Text`屬性，以`UnitPrice`資料欄位 ([按一下以檢視完整大小的影像](using-templatefields-in-the-detailsview-control-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="425ad-158">**Figure 5**: Bind the Label's `Text` Property to the `UnitPrice` Data Field ([Click to view full-size image](using-templatefields-in-the-detailsview-control-vb/_static/image15.png))</span></span>


## <a name="formatting-the-price-as-a-currency"></a><span data-ttu-id="425ad-159">格式化為貨幣的價格</span><span class="sxs-lookup"><span data-stu-id="425ad-159">Formatting the Price as a Currency</span></span>

<span data-ttu-id="425ad-160">此步驟中，標籤 Web 控制項的價格和清查 TemplateField 現在會顯示剛才所選產品的價格。</span><span class="sxs-lookup"><span data-stu-id="425ad-160">With this addition, the Label Web control Price and Inventory TemplateField will now display just the price for the selected product.</span></span> <span data-ttu-id="425ad-161">圖 6 顯示進度的螢幕擷取畫面到目前為止透過瀏覽器檢視時。</span><span class="sxs-lookup"><span data-stu-id="425ad-161">Figure 6 shows a screen shot of our progress thus far when viewed through a browser.</span></span>


[![T<span data-ttu-id="425ad-162">他的價格和清查 TemplateField 顯示的價格]</span><span class="sxs-lookup"><span data-stu-id="425ad-162">he Price and Inventory TemplateField Shows the Price]</span></span>(using-templatefields-in-the-detailsview-control-vb/_static/image17.png)](using-templatefields-in-the-detailsview-control-vb/_static/image16.png)

<span data-ttu-id="425ad-163">**圖 6**:價格與清查 TemplateField 顯示的價格 ([按一下以檢視完整大小的影像](using-templatefields-in-the-detailsview-control-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="425ad-163">**Figure 6**: The Price and Inventory TemplateField Shows the Price ([Click to view full-size image](using-templatefields-in-the-detailsview-control-vb/_static/image18.png))</span></span>


<span data-ttu-id="425ad-164">請注意，產品的價格不會格式化為貨幣。</span><span class="sxs-lookup"><span data-stu-id="425ad-164">Note that the product's price is not formatted as a currency.</span></span> <span data-ttu-id="425ad-165">BoundField 格式化是可以藉由設定`HtmlEncode`屬性，以`False`並`DataFormatString`屬性設`{0:formatSpecifier}`。</span><span class="sxs-lookup"><span data-stu-id="425ad-165">With a BoundField, formatting is possible by setting the `HtmlEncode` property to `False` and the `DataFormatString` property to `{0:formatSpecifier}`.</span></span> <span data-ttu-id="425ad-166">為 TemplateField，不過，任何格式化指示必須指定資料繫結語法中，或透過定義應用程式的程式碼 （例如 ASP.NET 頁面的程式碼後置類別中） 內的某處的格式化方法使用。</span><span class="sxs-lookup"><span data-stu-id="425ad-166">For a TemplateField, however, any formatting instructions must be specified in the databinding syntax or through the use of a formatting method defined somewhere within the application's code (such as in the ASP.NET page's code-behind class).</span></span>

<span data-ttu-id="425ad-167">若要指定標籤 Web 控制項中所使用的資料繫結語法的格式化，回到資料繫結 對話方塊中按一下中標籤的智慧標籤的 編輯資料繫結 連結。</span><span class="sxs-lookup"><span data-stu-id="425ad-167">To specify the formatting for the databinding syntax used in the Label Web control, return to the DataBindings dialog box by clicking on the Edit DataBindings link from the Label's smart tag.</span></span> <span data-ttu-id="425ad-168">您可以直接在 [格式] 下拉式清單中輸入的格式設定的指示，或選取其中一個定義的格式字串。</span><span class="sxs-lookup"><span data-stu-id="425ad-168">You can type the formatting instructions directly in the Format drop-down list or select one of the defined format strings.</span></span> <span data-ttu-id="425ad-169">如同 BoundField`DataFormatString`屬性，使用的格式指定`{0:formatSpecifier}`。</span><span class="sxs-lookup"><span data-stu-id="425ad-169">Like with the BoundField's `DataFormatString` property, the formatting is specified using `{0:formatSpecifier}`.</span></span>

<span data-ttu-id="425ad-170">針對`UnitPrice`欄位的使用貨幣格式指定選取適當的下拉式清單值，或輸入`{0:C}`以手動方式。</span><span class="sxs-lookup"><span data-stu-id="425ad-170">For the `UnitPrice` field use the currency formatting specified either by selecting the appropriate drop-down list value or by typing in `{0:C}` by hand.</span></span>


[![F<span data-ttu-id="425ad-171">ormat 貨幣的價格]</span><span class="sxs-lookup"><span data-stu-id="425ad-171">ormat the Price as a Currency]</span></span>(using-templatefields-in-the-detailsview-control-vb/_static/image20.png)](using-templatefields-in-the-detailsview-control-vb/_static/image19.png)

<span data-ttu-id="425ad-172">**圖 7**:格式化為貨幣的價格 ([按一下以檢視完整大小的影像](using-templatefields-in-the-detailsview-control-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="425ad-172">**Figure 7**: Format the Price as a Currency ([Click to view full-size image](using-templatefields-in-the-detailsview-control-vb/_static/image21.png))</span></span>


<span data-ttu-id="425ad-173">以宣告方式，在格式規格會表示為第二個參數插入`Bind`或`Eval`方法。</span><span class="sxs-lookup"><span data-stu-id="425ad-173">Declaratively, the formatting specification is indicated as a second parameter into the `Bind` or `Eval` methods.</span></span> <span data-ttu-id="425ad-174">只要透過設計工具結果，在下列資料繫結運算式中的宣告式標記中設定：</span><span class="sxs-lookup"><span data-stu-id="425ad-174">The settings just made through the Designer result in the following databinding expression in the declarative markup:</span></span>


[!code-aspx[Main](using-templatefields-in-the-detailsview-control-vb/samples/sample2.aspx)]

## <a name="adding-the-remaining-data-fields-to-the-templatefield"></a><span data-ttu-id="425ad-175">將其餘的資料欄位加入至 TemplateField</span><span class="sxs-lookup"><span data-stu-id="425ad-175">Adding the Remaining Data Fields to the TemplateField</span></span>

<span data-ttu-id="425ad-176">現在我們已顯示並格式化`UnitPrice`資料欄位中的價格和清查 TemplateField，但仍然需要顯示`UnitsInStock`和`UnitsOnOrder`欄位。</span><span class="sxs-lookup"><span data-stu-id="425ad-176">At this point we've displayed and formatted the `UnitPrice` data field in the Price and Inventory TemplateField, but still need to display the `UnitsInStock` and `UnitsOnOrder` fields.</span></span> <span data-ttu-id="425ad-177">讓我們來顯示這些該行下方價格和括號括住。</span><span class="sxs-lookup"><span data-stu-id="425ad-177">Let's display these on a line below the price and in parentheses.</span></span> <span data-ttu-id="425ad-178">從設計工具中的範本編輯介面，這類標記可以新增定位您在範本內的資料指標，然後只要輸入中要顯示的文字。</span><span class="sxs-lookup"><span data-stu-id="425ad-178">From the template editing interface in the Designer, such markup can be added by positioning your cursor within the template and simply typing in the text to be displayed.</span></span> <span data-ttu-id="425ad-179">或者，您可以輸入此標記，直接在宣告式語法中。</span><span class="sxs-lookup"><span data-stu-id="425ad-179">Alternatively, this markup can be entered directly in the declarative syntax.</span></span>

<span data-ttu-id="425ad-180">新增靜態標記標籤 Web 控制項，資料繫結語法，以便為價格與清查 TemplateField 顯示的價格和清查資訊就像這樣：</span><span class="sxs-lookup"><span data-stu-id="425ad-180">Add the static markup, Label Web controls, and databinding syntax so that the Price and Inventory TemplateField displays the price and inventory information like so:</span></span>

*<span data-ttu-id="425ad-181">UnitPrice</span><span class="sxs-lookup"><span data-stu-id="425ad-181">UnitPrice</span></span>*  
<span data-ttu-id="425ad-182">(\**庫存 / 順序：\*\*\*UnitsInStock* / *UnitsOnOrder*)</span><span class="sxs-lookup"><span data-stu-id="425ad-182">(**In Stock / On Order:** *UnitsInStock* / *UnitsOnOrder*)</span></span>

<span data-ttu-id="425ad-183">在執行這項工作之後 DetailsView 的宣告式標記看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="425ad-183">After performing this task your DetailsView's declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](using-templatefields-in-the-detailsview-control-vb/samples/sample3.aspx)]

<span data-ttu-id="425ad-184">經過這些變更中，我們已合併為單一的 DetailsView 資料列的價格和清查的資訊。</span><span class="sxs-lookup"><span data-stu-id="425ad-184">With these changes we've consolidated the price and inventory information into a single DetailsView row.</span></span>


[![T<span data-ttu-id="425ad-185">他的價格和清查資訊會顯示在單一資料列]</span><span class="sxs-lookup"><span data-stu-id="425ad-185">he Price and Inventory Information is Displayed in a Single Row]</span></span>(using-templatefields-in-the-detailsview-control-vb/_static/image23.png)](using-templatefields-in-the-detailsview-control-vb/_static/image22.png)

<span data-ttu-id="425ad-186">**圖 8**:價格和清查資訊會顯示在單一資料列 ([按一下以檢視完整大小的影像](using-templatefields-in-the-detailsview-control-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="425ad-186">**Figure 8**: The Price and Inventory Information is Displayed in a Single Row ([Click to view full-size image](using-templatefields-in-the-detailsview-control-vb/_static/image24.png))</span></span>


## <a name="step-3-customizing-the-discontinued-field-information"></a><span data-ttu-id="425ad-187">步驟 3：自訂已停止的欄位資訊</span><span class="sxs-lookup"><span data-stu-id="425ad-187">Step 3: Customizing the Discontinued Field Information</span></span>

<span data-ttu-id="425ad-188">`Products`資料表的`Discontinued`資料行是位元值，指出是否已停用產品。</span><span class="sxs-lookup"><span data-stu-id="425ad-188">The `Products` table's `Discontinued` column is a bit value that indicates whether the product has been discontinued.</span></span> <span data-ttu-id="425ad-189">布林值欄位中，當繫結資料來源控制項 DetailsView （或 GridView），像是`Discontinued`，而非布林值欄位，例如，會實作為 CheckBoxFields `ProductID`， `ProductName`，依此類推，實作為BoundFields。</span><span class="sxs-lookup"><span data-stu-id="425ad-189">When binding a DetailsView (or GridView) to a data source control, the Boolean value fields, like `Discontinued`, are implemented as CheckBoxFields whereas non-Boolean value fields, like `ProductID`, `ProductName`, and so on, are implemented as BoundFields.</span></span> <span data-ttu-id="425ad-190">CheckBoxField 轉譯成資料欄位的值是否為 True，然後取消核取否則簽入已停用核取方塊。</span><span class="sxs-lookup"><span data-stu-id="425ad-190">The CheckBoxField renders as a disabled checkbox that is checked if the data field's value is True and unchecked otherwise.</span></span>

<span data-ttu-id="425ad-191">而不是顯示 CheckBoxField 我們可能會想要改為顯示文字，指出產品已經停售。</span><span class="sxs-lookup"><span data-stu-id="425ad-191">Rather than display the CheckBoxField we may want to instead display text indicating whether or not the product is discontinued.</span></span> <span data-ttu-id="425ad-192">若要這麼做，我們無法移除 DetailsView CheckBoxField，然後加入 BoundField 其`DataField`屬性設定為`Discontinued`。</span><span class="sxs-lookup"><span data-stu-id="425ad-192">To accomplish this we could remove the CheckBoxField from the DetailsView and then add a BoundField whose `DataField` property was set to `Discontinued`.</span></span> <span data-ttu-id="425ad-193">請花一點時間來執行這項操作。</span><span class="sxs-lookup"><span data-stu-id="425ad-193">Take a moment to do this.</span></span> <span data-ttu-id="425ad-194">這項變更之後 DetailsView 顯示的文字"True"已停止的產品和"False"仍在作用中的產品。</span><span class="sxs-lookup"><span data-stu-id="425ad-194">After this change the DetailsView shows the text "True" for discontinued products and "False" for products that are still active.</span></span>


[![T<span data-ttu-id="425ad-195">使用他的字串，則為 True 和 False 顯示 Discontinued 狀態]</span><span class="sxs-lookup"><span data-stu-id="425ad-195">he Strings True and False Are Used to Display the Discontinued State]</span></span>(using-templatefields-in-the-detailsview-control-vb/_static/image26.png)](using-templatefields-in-the-detailsview-control-vb/_static/image25.png)

<span data-ttu-id="425ad-196">**圖 9**:字串，則為 True 和 False 是用來顯示 Discontinued 狀態 ([按一下以檢視完整大小的影像](using-templatefields-in-the-detailsview-control-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="425ad-196">**Figure 9**: The Strings True and False Are Used to Display the Discontinued State ([Click to view full-size image](using-templatefields-in-the-detailsview-control-vb/_static/image27.png))</span></span>


<span data-ttu-id="425ad-197">假設我們不想要使用"YES"和"NO"，但改為"True"或"False"字串。</span><span class="sxs-lookup"><span data-stu-id="425ad-197">Imagine that we didn't want the strings "True" or "False" to be used, but "YES" and "NO", instead.</span></span> <span data-ttu-id="425ad-198">利用 TemplateField 以及格式化的方法可以執行這類自訂。</span><span class="sxs-lookup"><span data-stu-id="425ad-198">Such customization can be performed with the aid of a TemplateField and a formatting method.</span></span> <span data-ttu-id="425ad-199">可以接受任意數目的輸入參數，以格式化方法，但是 （做為字串） 必須傳回的 HTML 插入範本。</span><span class="sxs-lookup"><span data-stu-id="425ad-199">A formatting method can take in any number of input parameters, but must return the HTML (as a string) to inject into the template.</span></span>

<span data-ttu-id="425ad-200">將格式化的方法，加入`DetailsViewTemplateField.aspx`頁面的程式碼後置類別名為`DisplayDiscontinuedAsYESorNO`它會接受`Northwind.ProductsRow`做為輸入參數的物件，並傳回字串。</span><span class="sxs-lookup"><span data-stu-id="425ad-200">Add a formatting method to the `DetailsViewTemplateField.aspx` page's code-behind class named `DisplayDiscontinuedAsYESorNO` that accepts a `Northwind.ProductsRow` object as an input parameter and returns a string.</span></span> <span data-ttu-id="425ad-201">在上一個教學課程中，這個方法中所述*必須*標示為`Protected`或`Public`才能存取從該範本。</span><span class="sxs-lookup"><span data-stu-id="425ad-201">As discussed in the previous tutorial, this method *must* be marked as `Protected` or `Public` in order to be accessible from the template.</span></span>


[!code-vb[Main](using-templatefields-in-the-detailsview-control-vb/samples/sample4.vb)]

<span data-ttu-id="425ad-202">這個方法會檢查輸入的參數 (`discontinued`)，並傳回"YES"，如果它是`True`，否則為 [否]。</span><span class="sxs-lookup"><span data-stu-id="425ad-202">This method checks the input parameter (`discontinued`) and returns "YES" if it is `True`, "NO" otherwise.</span></span>

> [!NOTE]
> <span data-ttu-id="425ad-203">檢查先前的教學課程回想一下，我們可能會包含資料欄位中所傳遞之格式化方法中`NULL`s，因此需要檢查是否員工`HiredDate`屬性值已有資料庫`NULL`值低於存取`EmployeesRow`的`HiredDate`屬性。</span><span class="sxs-lookup"><span data-stu-id="425ad-203">In the formatting method examined in the previous tutorial recall that we were passing in a data field that might contain `NULL` s and therefore needed to check if the employee's `HiredDate` property value had a database `NULL` value before accessing the `EmployeesRow`'s `HiredDate` property.</span></span> <span data-ttu-id="425ad-204">因為不需要這類的核取以下`Discontinued`資料行永遠不會有資料庫`NULL`指派的值。</span><span class="sxs-lookup"><span data-stu-id="425ad-204">Such a check is not needed here since the `Discontinued` column can never have database `NULL` values assigned.</span></span> <span data-ttu-id="425ad-205">此外，這就是為什麼方法接受布林值輸入參數，而不需要接受`ProductsRow`執行個體或類型參數的`Object`。</span><span class="sxs-lookup"><span data-stu-id="425ad-205">Moreover, this is why the method can accept a Boolean input parameter rather than having to accept a `ProductsRow` instance or a parameter of type `Object`.</span></span>


<span data-ttu-id="425ad-206">使用此完整的格式化方法，剩下的就是呼叫從 TemplateField `ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="425ad-206">With this formatting method complete, all that remains is to call it from the TemplateField's `ItemTemplate`.</span></span> <span data-ttu-id="425ad-207">若要建立 TemplateField 移除`Discontinued`BoundField 和新增新的 TemplateField，或轉換`Discontinued`BoundField TemplateField 到。</span><span class="sxs-lookup"><span data-stu-id="425ad-207">To create the TemplateField either remove the `Discontinued` BoundField and add a new TemplateField or convert the `Discontinued` BoundField into a TemplateField.</span></span> <span data-ttu-id="425ad-208">然後，從 [宣告式標記] 檢視中，編輯 TemplateField，使其包含只會叫用 ItemTemplate`DisplayDiscontinuedAsYESorNO`方法並傳入目前的值`ProductRow`執行個體的`Discontinued`屬性。</span><span class="sxs-lookup"><span data-stu-id="425ad-208">Then, from the declarative markup view, edit the TemplateField so that it contains just an ItemTemplate that invokes the `DisplayDiscontinuedAsYESorNO` method, passing in the value of the current `ProductRow` instance's `Discontinued` property.</span></span> <span data-ttu-id="425ad-209">這可以透過存取`Eval`方法。</span><span class="sxs-lookup"><span data-stu-id="425ad-209">This can be accessed via the `Eval` method.</span></span> <span data-ttu-id="425ad-210">具體來說，TemplateField 標記應該看起來像：</span><span class="sxs-lookup"><span data-stu-id="425ad-210">Specifically, the TemplateField's markup should look like:</span></span>


[!code-aspx[Main](using-templatefields-in-the-detailsview-control-vb/samples/sample5.aspx)]

<span data-ttu-id="425ad-211">這會導致`DisplayDiscontinuedAsYESorNO`轉譯 DetailsView 時要叫用方法並傳遞`ProductRow`執行個體的`Discontinued`值。</span><span class="sxs-lookup"><span data-stu-id="425ad-211">This will cause the `DisplayDiscontinuedAsYESorNO` method to be invoked when rendering the DetailsView, passing in the `ProductRow` instance's `Discontinued` value.</span></span> <span data-ttu-id="425ad-212">由於`Eval`方法會傳回類型的值`Object`，但`DisplayDiscontinuedAsYESorNO`方法所預期的輸入的參數的型別`Boolean`，我們轉換`Eval`方法會傳回值，以`Boolean`。</span><span class="sxs-lookup"><span data-stu-id="425ad-212">Since the `Eval` method returns a value of type `Object`, but the `DisplayDiscontinuedAsYESorNO` method expects an input parameter of type `Boolean`, we cast the `Eval` methods return value to `Boolean`.</span></span> <span data-ttu-id="425ad-213">`DisplayDiscontinuedAsYESorNO`方法接著會傳回"YES"或"NO"的值而定接收。</span><span class="sxs-lookup"><span data-stu-id="425ad-213">The `DisplayDiscontinuedAsYESorNO` method will then return "YES" or "NO" depending on the value it receives.</span></span> <span data-ttu-id="425ad-214">傳回的值是在此 DetailsView 中顯示的內容 （請參閱 圖 10） 的資料列。</span><span class="sxs-lookup"><span data-stu-id="425ad-214">The returned value is what is displayed in this DetailsView row (see Figure 10).</span></span>


[![Y<span data-ttu-id="425ad-215">ES 或 NO 值會現在顯示 Discontinued 資料列]</span><span class="sxs-lookup"><span data-stu-id="425ad-215">ES or NO Values are Now Shown in the Discontinued Row]</span></span>(using-templatefields-in-the-detailsview-control-vb/_static/image29.png)](using-templatefields-in-the-detailsview-control-vb/_static/image28.png)

<span data-ttu-id="425ad-216">**圖 10**:Yes 或 NO 的值為現在顯示 Discontinued 資料列 ([按一下以檢視完整大小的影像](using-templatefields-in-the-detailsview-control-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="425ad-216">**Figure 10**: YES or NO Values are Now Shown in the Discontinued Row ([Click to view full-size image](using-templatefields-in-the-detailsview-control-vb/_static/image30.png))</span></span>


## <a name="summary"></a><span data-ttu-id="425ad-217">總結</span><span class="sxs-lookup"><span data-stu-id="425ad-217">Summary</span></span>

<span data-ttu-id="425ad-218">在 DetailsView 控制項中的 TemplateField 允許較大程度的彈性比使用其他欄位控制項，並非常適合的情況下，顯示資料位置：</span><span class="sxs-lookup"><span data-stu-id="425ad-218">The TemplateField in the DetailsView control allows for a higher degree of flexibility in displaying data than is available with the other field controls and are ideal for situations where:</span></span>

- <span data-ttu-id="425ad-219">多個資料欄位需要一個 GridView 資料行中顯示</span><span class="sxs-lookup"><span data-stu-id="425ad-219">Multiple data fields need to be displayed in one GridView column</span></span>
- <span data-ttu-id="425ad-220">使用 Web 控制項，而不是純文字最能表示的資料</span><span class="sxs-lookup"><span data-stu-id="425ad-220">The data is best expressed using a Web control rather than plain text</span></span>
- <span data-ttu-id="425ad-221">輸出取決於基礎資料，例如顯示中繼資料或是在重新格式化資料</span><span class="sxs-lookup"><span data-stu-id="425ad-221">The output depends on the underlying data, such as displaying metadata or in reformatting the data</span></span>

<span data-ttu-id="425ad-222">雖然 TemplateFields 允許更高的 DetailsView 的基礎資料的呈現方式的彈性，DetailsView 輸出仍覺得有點 boxy 為每個欄位轉譯為 HTML 中的資料列`<table>`。</span><span class="sxs-lookup"><span data-stu-id="425ad-222">While TemplateFields allow for a greater degree of flexibility in the rendering of the DetailsView's underlying data, the DetailsView output still feels a bit boxy as each field is rendered as a row in an HTML `<table>`.</span></span>

<span data-ttu-id="425ad-223">FormView 控制項提供更高的彈性地設定轉譯的輸出。</span><span class="sxs-lookup"><span data-stu-id="425ad-223">The FormView control offers a greater degree of flexibility in configuring the rendered output.</span></span> <span data-ttu-id="425ad-224">FormView 不包含欄位，但只是一系列的範本 (`ItemTemplate`， `EditItemTemplate`，`HeaderTemplate`等等)。</span><span class="sxs-lookup"><span data-stu-id="425ad-224">The FormView does not contain fields but rather just a series of templates (`ItemTemplate`, `EditItemTemplate`, `HeaderTemplate`, and so on).</span></span> <span data-ttu-id="425ad-225">我們會看到如何使用 FormView 我們下一個教學課程中達成更多控制呈現的版面配置。</span><span class="sxs-lookup"><span data-stu-id="425ad-225">We'll see how to use the FormView to achieve even more control of the rendered layout in our next tutorial.</span></span>

<span data-ttu-id="425ad-226">快樂地寫程式 ！</span><span class="sxs-lookup"><span data-stu-id="425ad-226">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="425ad-227">關於作者</span><span class="sxs-lookup"><span data-stu-id="425ad-227">About the Author</span></span>

<span data-ttu-id="425ad-228">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，作者的七個 ASP 書籍和的創辦人[4GuysFromRolla.com](http://www.4guysfromrolla.com)，自 1998 年從事 Microsoft Web 技術工作。</span><span class="sxs-lookup"><span data-stu-id="425ad-228">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="425ad-229">Scott 會擔任獨立的顧問、 培訓講師和作家。</span><span class="sxs-lookup"><span data-stu-id="425ad-229">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="425ad-230">他最新的著作是[ *Sams 教導您自己 ASP.NET 2.0 在 24 小時內*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="425ad-230">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="425ad-231">他可以在觸達[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="425ad-231">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="425ad-232">或透過他的部落格，這位於 [http://ScottOnWriting.NET](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="425ad-232">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="425ad-233">特別感謝</span><span class="sxs-lookup"><span data-stu-id="425ad-233">Special Thanks To</span></span>

<span data-ttu-id="425ad-234">本教學課程系列是由許多實用的檢閱者檢閱。</span><span class="sxs-lookup"><span data-stu-id="425ad-234">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="425ad-235">本教學課程中的潛在客戶檢閱者已 Dan Jagers。</span><span class="sxs-lookup"><span data-stu-id="425ad-235">Lead reviewer for this tutorial was Dan Jagers.</span></span> <span data-ttu-id="425ad-236">有興趣檢閱我即將推出的 MSDN 文章嗎？</span><span class="sxs-lookup"><span data-stu-id="425ad-236">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="425ad-237">如果是這樣，psychic 在[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="425ad-237">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="425ad-238">[上一頁](using-templatefields-in-the-gridview-control-vb.md)
> [下一頁](using-the-formview-s-templates-vb.md)</span><span class="sxs-lookup"><span data-stu-id="425ad-238">[Previous](using-templatefields-in-the-gridview-control-vb.md)
[Next](using-the-formview-s-templates-vb.md)</span></span>
