---
uid: web-forms/overview/data-access/displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-vb
title: 格式化 DataList 和 Repeater 根據資料 (VB) |Microsoft Docs
author: rick-anderson
description: 在本教學課程，我們要逐步執行範例的我們如何格式化 DataList 和 Repeater 控制項，藉由使用具有格式設定函式的外觀...
ms.author: riande
ms.date: 09/13/2006
ms.assetid: e2f401ae-37bb-4b19-aa97-d6b385d40f88
msc.legacyurl: /web-forms/overview/data-access/displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-vb
msc.type: authoredcontent
ms.openlocfilehash: 8955e37aa084f339665bbd4dc0475f7be74f3b26
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/17/2019
ms.locfileid: "59421598"
---
# <a name="formatting-the-datalist-and-repeater-based-upon-data-vb"></a><span data-ttu-id="28040-103">根據資料格式化 DataList 和重複項 (VB)</span><span class="sxs-lookup"><span data-stu-id="28040-103">Formatting the DataList and Repeater Based Upon Data (VB)</span></span>

<span data-ttu-id="28040-104">藉由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="28040-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="28040-105">[下載範例應用程式](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_30_VB.exe)或[下載 PDF](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/datatutorial30vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="28040-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_30_VB.exe) or [Download PDF](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/datatutorial30vb1.pdf)</span></span>

> <span data-ttu-id="28040-106">在本教學課程，我們將逐步執行的我們如何格式化 DataList 和 Repeater 控制項，使用在範本內的格式化功能，或處理資料繫結事件的外觀範例。</span><span class="sxs-lookup"><span data-stu-id="28040-106">In this tutorial we'll step through examples of how we format the appearance of the DataList and Repeater controls, either by using formatting functions within templates or by handling the DataBound event.</span></span>


## <a name="introduction"></a><span data-ttu-id="28040-107">簡介</span><span class="sxs-lookup"><span data-stu-id="28040-107">Introduction</span></span>

<span data-ttu-id="28040-108">如我們所見在先前的教學課程中，DataList 會提供一些會影響其外觀的樣式相關屬性。</span><span class="sxs-lookup"><span data-stu-id="28040-108">As we saw in the preceding tutorial, the DataList offers a number of style-related properties that affect its appearance.</span></span> <span data-ttu-id="28040-109">特別是，我們了解如何將預設的 CSS 類別指派給 DataList s `HeaderStyle`， `ItemStyle`， `AlternatingItemStyle`，和`SelectedItemStyle`屬性。</span><span class="sxs-lookup"><span data-stu-id="28040-109">In particular, we saw how to assign default CSS classes to the DataList s `HeaderStyle`, `ItemStyle`, `AlternatingItemStyle`, and `SelectedItemStyle` properties.</span></span> <span data-ttu-id="28040-110">除了這四個屬性，DataList 包含數個其他樣式相關的屬性，例如`Font`， `ForeColor`， `BackColor`，和`BorderWidth`、 等等。</span><span class="sxs-lookup"><span data-stu-id="28040-110">In addition to these four properties, the DataList includes a number of other style-related properties, such as `Font`, `ForeColor`, `BackColor`, and `BorderWidth`, to name a few.</span></span> <span data-ttu-id="28040-111">在 Repeater 控制項不包含任何的樣式相關屬性。</span><span class="sxs-lookup"><span data-stu-id="28040-111">The Repeater control does not contain any style-related properties.</span></span> <span data-ttu-id="28040-112">直接在中繼器的範本中的標記內，都必須進行任何這類的樣式設定。</span><span class="sxs-lookup"><span data-stu-id="28040-112">Any such style settings must be made directly within the markup in the Repeater s templates.</span></span>

<span data-ttu-id="28040-113">通常，不過，格式化資料的方式取決於資料本身。</span><span class="sxs-lookup"><span data-stu-id="28040-113">Often, though, how data should be formatted depends on the data itself.</span></span> <span data-ttu-id="28040-114">比方說，列出產品時我們可能會想要以淺灰色字型色彩顯示產品資訊，它已停止，則我們可能想要反白顯示`UnitsInStock`值為零。</span><span class="sxs-lookup"><span data-stu-id="28040-114">For example, when listing products we might want to display the product information in a light gray font color if it is discontinued, or we may want to highlight the `UnitsInStock` value if it is zero.</span></span> <span data-ttu-id="28040-115">我們在先前的教學課程中所見的因為 GridView、 DetailsView 和 FormView 提供了兩個不同的方式，把它們根據其資料的外觀：</span><span class="sxs-lookup"><span data-stu-id="28040-115">As we saw in previous tutorials, the GridView, DetailsView, and FormView offer two distinct ways to format their appearance based on their data:</span></span>

- <span data-ttu-id="28040-116">**`DataBound`事件**建立適當的事件處理常式`DataBound`，所引發的事件資料已繫結至每個項目之後 (它是 gridview`RowDataBound`事件; DataList 與重複項對於`ItemDataBound`事件)。</span><span class="sxs-lookup"><span data-stu-id="28040-116">**The `DataBound` event** create an event handler for the appropriate `DataBound` event, which fires after the data has been bound to each item (for the GridView it was the `RowDataBound` event; for the DataList and Repeater it is the `ItemDataBound` event).</span></span> <span data-ttu-id="28040-117">在該事件處理常式，繫結的資料只要可以檢查進行格式化的決策。</span><span class="sxs-lookup"><span data-stu-id="28040-117">In that event handler, the data just bound can be examined and formatting decisions made.</span></span> <span data-ttu-id="28040-118">我們檢查此技巧[自訂格式化時資料](../custom-formatting/custom-formatting-based-upon-data-vb.md)教學課程。</span><span class="sxs-lookup"><span data-stu-id="28040-118">We examined this technique in the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-vb.md) tutorial.</span></span>
- <span data-ttu-id="28040-119">**格式函式範本中的**時 DetailsView 或 GridView 控制項或 FormView 控制項中的範本中使用 TemplateFields，我們可以將格式化函式新增至 ASP.NET 頁面 s 程式碼後置類別、 商務邏輯層，或任何可從 web 應用程式存取其他類別庫。</span><span class="sxs-lookup"><span data-stu-id="28040-119">**Formatting Functions in Templates** when using TemplateFields in the DetailsView or GridView controls, or a template in the FormView control, we can add a formatting function to the ASP.NET page s code-behind class, the Business Logic Layer, or any other class library that is accessible from the web application.</span></span> <span data-ttu-id="28040-120">此格式的函式可以接受任意數目的輸入參數，但必須傳回要在範本中所呈現之 HTML。</span><span class="sxs-lookup"><span data-stu-id="28040-120">This formatting function can accept an arbitrary number of input parameters, but must return the HTML to render in the template.</span></span> <span data-ttu-id="28040-121">格式函式第一次檢查[使用 GridView 控制項中的 TemplateFields](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md)教學課程。</span><span class="sxs-lookup"><span data-stu-id="28040-121">Formatting functions were first examined in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) tutorial.</span></span>

<span data-ttu-id="28040-122">這兩種格式的技術都可使用 DataList 與重複項控制項。</span><span class="sxs-lookup"><span data-stu-id="28040-122">Both of these formatting techniques are available with the DataList and Repeater controls.</span></span> <span data-ttu-id="28040-123">在本教學課程，我們將逐步執行這兩個控制項使用這兩種技巧的範例。</span><span class="sxs-lookup"><span data-stu-id="28040-123">In this tutorial we'll step through examples using both techniques for both controls.</span></span>

## <a name="using-theitemdataboundevent-handler"></a><span data-ttu-id="28040-124">使用`ItemDataBound`事件處理常式</span><span class="sxs-lookup"><span data-stu-id="28040-124">Using the`ItemDataBound`Event Handler</span></span>

<span data-ttu-id="28040-125">當資料繫結至 DataList 中，從資料來源控制項，或是透過程式設計方式將資料指派給控制項 s`DataSource`屬性，並呼叫其`DataBind()`方法中，DataList 的`DataBinding`事件引發時，資料來源列舉而且，每個資料記錄繫結至 DataList。</span><span class="sxs-lookup"><span data-stu-id="28040-125">When data is bound to a DataList, either from a data source control or through programmatically assigning data to the control s `DataSource` property and calling its `DataBind()` method, the DataList s `DataBinding` event fires, the data source enumerated, and each data record is bound to the DataList.</span></span> <span data-ttu-id="28040-126">資料來源中的每一筆記錄，建立 DataList [ `DataListItem` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.aspx)也就是物件，然後繫結至目前的記錄。</span><span class="sxs-lookup"><span data-stu-id="28040-126">For each record in the data source, the DataList creates a [`DataListItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.aspx) object that is then bound to the current record.</span></span> <span data-ttu-id="28040-127">在此過程中，DataList 會引發兩個事件：</span><span class="sxs-lookup"><span data-stu-id="28040-127">During this process, the DataList raises two events:</span></span>

- <span data-ttu-id="28040-128">**`ItemCreated`** 之後，就會引發`DataListItem`已建立</span><span class="sxs-lookup"><span data-stu-id="28040-128">**`ItemCreated`** fires after the `DataListItem` has been created</span></span>
- <span data-ttu-id="28040-129">**`ItemDataBound`** 已繫結至的目前記錄之後，就會引發 `DataListItem`</span><span class="sxs-lookup"><span data-stu-id="28040-129">**`ItemDataBound`** fires after the current record has been bound to the `DataListItem`</span></span>

<span data-ttu-id="28040-130">下列步驟概述 DataList 控制項的資料繫結程序。</span><span class="sxs-lookup"><span data-stu-id="28040-130">The following steps outline the data binding process for the DataList control.</span></span>

1. <span data-ttu-id="28040-131">DataList s [ `DataBinding`事件](https://msdn.microsoft.com/library/system.web.ui.control.databinding.aspx)引發</span><span class="sxs-lookup"><span data-stu-id="28040-131">The DataList s [`DataBinding` event](https://msdn.microsoft.com/library/system.web.ui.control.databinding.aspx) fires</span></span>
2. <span data-ttu-id="28040-132">資料繫結至 DataList</span><span class="sxs-lookup"><span data-stu-id="28040-132">The data is bound to the DataList</span></span>  
  
   <span data-ttu-id="28040-133">資料來源中的每一筆記錄</span><span class="sxs-lookup"><span data-stu-id="28040-133">For each record in the data source</span></span> 

    1. <span data-ttu-id="28040-134">建立`DataListItem`物件</span><span class="sxs-lookup"><span data-stu-id="28040-134">Create a `DataListItem` object</span></span>
    2. <span data-ttu-id="28040-135">火焰[`ItemCreated`事件](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemcreated.aspx)</span><span class="sxs-lookup"><span data-stu-id="28040-135">Fire the [`ItemCreated` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemcreated.aspx)</span></span>
    3. <span data-ttu-id="28040-136">繫結至資料錄 `DataListItem`</span><span class="sxs-lookup"><span data-stu-id="28040-136">Bind the record to the `DataListItem`</span></span>
    4. <span data-ttu-id="28040-137">火焰[`ItemDataBound`事件](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemdatabound.aspx)</span><span class="sxs-lookup"><span data-stu-id="28040-137">Fire the [`ItemDataBound` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemdatabound.aspx)</span></span>
    5. <span data-ttu-id="28040-138">新增`DataListItem`至`Items`集合</span><span class="sxs-lookup"><span data-stu-id="28040-138">Add the `DataListItem` to the `Items` collection</span></span>

<span data-ttu-id="28040-139">當資料繫結至 Repeater 控制項，在各步驟的確切的相同順序。</span><span class="sxs-lookup"><span data-stu-id="28040-139">When binding data to the Repeater control, it progresses through the exact same sequence of steps.</span></span> <span data-ttu-id="28040-140">唯一的差別在於，而不是`DataListItem`所建立的執行個體，會使用 Repeater [ `RepeaterItem` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeateritem(VS.80).aspx)s。</span><span class="sxs-lookup"><span data-stu-id="28040-140">The only difference is that instead of `DataListItem` instances being created, the Repeater uses [`RepeaterItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeateritem(VS.80).aspx)s.</span></span>

> [!NOTE]
> <span data-ttu-id="28040-141">精明的讀者可能已經發現的 DataList 與重複項繫結至資料與 GridView 繫結至資料時會的步驟順序之間的些微異常。</span><span class="sxs-lookup"><span data-stu-id="28040-141">The astute reader may have noticed a slight anomaly between the sequence of steps that transpire when the DataList and Repeater are bound to data versus when the GridView is bound to data.</span></span> <span data-ttu-id="28040-142">在資料繫結程序的結尾結束時，引發 GridView`DataBound`事件; 不過，收錄 DataList 或 Repeater 控制項有這類事件。</span><span class="sxs-lookup"><span data-stu-id="28040-142">At the tail end of the data binding process, the GridView raises the `DataBound` event; however, neither the DataList nor Repeater control have such an event.</span></span> <span data-ttu-id="28040-143">這是因為之前的前置和後置的層級的事件處理常式模式已成為一般在 ASP.NET 1.x 時間範圍內，建立 DataList 與重複項控制項。</span><span class="sxs-lookup"><span data-stu-id="28040-143">This is because the DataList and Repeater controls were created back in the ASP.NET 1.x timeframe, before the pre- and post-level event handler pattern had become common.</span></span>


<span data-ttu-id="28040-144">像是 GridView、 格式化以資料為依據的其中一個選項是建立的事件處理常式`ItemDataBound`事件。</span><span class="sxs-lookup"><span data-stu-id="28040-144">Like with the GridView, one option for formatting based on the data is to create an event handler for the `ItemDataBound` event.</span></span> <span data-ttu-id="28040-145">這個事件處理常式會檢查有只繫結到的資料`DataListItem`或`RepeaterItem`並且影響視控制項格式。</span><span class="sxs-lookup"><span data-stu-id="28040-145">This event handler would inspect the data that had just been bound to the `DataListItem` or `RepeaterItem` and affect the formatting of the control as needed.</span></span>

<span data-ttu-id="28040-146">DataList 控制項，格式為整個項目可以使用實作的變更`DataListItem`s 與樣式相關屬性，其中包含標準`Font`， `ForeColor`， `BackColor`， `CssClass`，依此類推。</span><span class="sxs-lookup"><span data-stu-id="28040-146">For the DataList control, formatting changes for the entire item can be implemented using the `DataListItem` s style-related properties, which include the standard `Font`, `ForeColor`, `BackColor`, `CssClass`, and so on.</span></span> <span data-ttu-id="28040-147">若要影響的 DataList 的範本內的特定 Web 控制項格式，我們需要以程式設計方式存取和修改這些 Web 控制項的樣式。</span><span class="sxs-lookup"><span data-stu-id="28040-147">To affect the formatting of particular Web controls within the DataList s template, we need to programmatically access and modify the style of those Web controls.</span></span> <span data-ttu-id="28040-148">我們了解如何完成此回溯*自訂格式化時資料*教學課程。</span><span class="sxs-lookup"><span data-stu-id="28040-148">We saw how to accomplish this back in the *Custom Formatting Based Upon Data* tutorial.</span></span> <span data-ttu-id="28040-149">例如中繼器控制項中，`RepeaterItem`類別有任何與樣式相關屬性; 因此，所有與樣式相關的變更會對`RepeaterItem`在`ItemDataBound`事件處理常式必須以程式設計方式存取及更新中的 Web 控制項範本中。</span><span class="sxs-lookup"><span data-stu-id="28040-149">Like the Repeater control, the `RepeaterItem` class has no style-related properties; therefore, all style-related changes made to a `RepeaterItem` in the `ItemDataBound` event handler must be done by programmatically accessing and updating Web controls within the template.</span></span>

<span data-ttu-id="28040-150">因為`ItemDataBound`格式化 DataList 和 Repeater 幾乎都相同，我們的範例著重於使用 DataList 項技術。</span><span class="sxs-lookup"><span data-stu-id="28040-150">Since the `ItemDataBound` formatting technique for the DataList and Repeater are virtually identical, our example will focus on using the DataList.</span></span>

## <a name="step-1-displaying-product-information-in-the-datalist"></a><span data-ttu-id="28040-151">步驟 1：DataList 中顯示的產品資訊</span><span class="sxs-lookup"><span data-stu-id="28040-151">Step 1: Displaying Product Information in the DataList</span></span>

<span data-ttu-id="28040-152">我們會擔心格式之前，讓 s 首先會建立用來顯示產品資訊的 DataList 的頁面。</span><span class="sxs-lookup"><span data-stu-id="28040-152">Before we worry about the formatting, let s first create a page that uses a DataList to display product information.</span></span> <span data-ttu-id="28040-153">在 [先前的教學課程](displaying-data-with-the-datalist-and-repeater-controls-vb.md)我們建立了 DataList 其`ItemTemplate`顯示每個產品的名稱、 類別、 供應商、 每個單位和價格的數量。</span><span class="sxs-lookup"><span data-stu-id="28040-153">In the [previous tutorial](displaying-data-with-the-datalist-and-repeater-controls-vb.md) we created a DataList whose `ItemTemplate` displayed each product s name, category, supplier, quantity per unit, and price.</span></span> <span data-ttu-id="28040-154">可讓重複這項功能在此本教學課程中的 s。</span><span class="sxs-lookup"><span data-stu-id="28040-154">Let s repeat this functionality here in this tutorial.</span></span> <span data-ttu-id="28040-155">若要這麼做，您可以 DataList 和其 ObjectDataSource 從頭情況下，可能是重新建立，或者您可以從先前的教學課程中建立的頁面複製這些控制項 (`Basics.aspx`) 將其貼到頁面中，在本教學課程 (`Formatting.aspx`)。</span><span class="sxs-lookup"><span data-stu-id="28040-155">To accomplish this, you can either recreate the DataList and its ObjectDataSource from scratch, or you can copy over those controls from the page created in the previous tutorial (`Basics.aspx`) and paste them into the page for this tutorial (`Formatting.aspx`).</span></span>

<span data-ttu-id="28040-156">一旦您已複寫的 DataList 與 ObjectDataSource 的功能，從`Basics.aspx`成`Formatting.aspx`，請花一點時間變更 DataList s`ID`屬性從`DataList1`以更具描述性`ItemDataBoundFormattingExample`。</span><span class="sxs-lookup"><span data-stu-id="28040-156">Once you have replicated the DataList and ObjectDataSource functionality from `Basics.aspx` into `Formatting.aspx`, take a moment to change the DataList s `ID` property from `DataList1` to a more descriptive `ItemDataBoundFormattingExample`.</span></span> <span data-ttu-id="28040-157">接下來，在瀏覽器中檢視 DataList。</span><span class="sxs-lookup"><span data-stu-id="28040-157">Next, view the DataList in a browser.</span></span> <span data-ttu-id="28040-158">如 [圖 1] 所示，唯一格式化每個產品之間的差別的背景色彩會交替出現。</span><span class="sxs-lookup"><span data-stu-id="28040-158">As Figure 1 shows, the only formatting difference between each product is that the background color alternates.</span></span>


<span data-ttu-id="28040-159">[![DataList 控制項中所列的產品](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image2.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="28040-159">[![The Products are Listed in the DataList Control](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image2.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image1.png)</span></span>

<span data-ttu-id="28040-160">**圖 1**:DataList 控制項中所列的產品 ([按一下以檢視完整大小的影像](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="28040-160">**Figure 1**: The Products are Listed in the DataList Control ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image3.png))</span></span>


<span data-ttu-id="28040-161">本教學課程中，讓格式化 DataList，使得標價小於 $ 20.00 美元的任何產品會有它的名稱，而單位價格反白顯示的黃色的 s。</span><span class="sxs-lookup"><span data-stu-id="28040-161">For this tutorial, let s format the DataList such that any products with a price less than $20.00 will have both its name and unit price highlighted yellow.</span></span>

## <a name="step-2-programmatically-determining-the-value-of-the-data-in-the-itemdatabound-event-handler"></a><span data-ttu-id="28040-162">步驟 2：以程式設計方式判斷 ItemDataBound 事件處理常式中的資料值</span><span class="sxs-lookup"><span data-stu-id="28040-162">Step 2: Programmatically Determining the Value of the Data in the ItemDataBound Event Handler</span></span>

<span data-ttu-id="28040-163">由於這些產品價格下 $ 20.00 美元會有套用的自訂格式，我們必須能夠判斷每個產品的價格。</span><span class="sxs-lookup"><span data-stu-id="28040-163">Since only those products with a price under $20.00 will have the custom formatting applied, we must be able to determine each product s price.</span></span> <span data-ttu-id="28040-164">當資料繫結至 DataList，DataList 列舉其資料來源中的記錄，然後針對每一筆記錄，會建立`DataListItem`執行個體，繫結至資料來源記錄`DataListItem`。</span><span class="sxs-lookup"><span data-stu-id="28040-164">When binding data to a DataList, the DataList enumerates the records in its data source and, for each record, creates a `DataListItem` instance, binding the data source record to the `DataListItem`.</span></span> <span data-ttu-id="28040-165">在特定的資料錄 s 後資料繫結至目前`DataListItem`物件，DataList 的`ItemDataBound`引發事件。</span><span class="sxs-lookup"><span data-stu-id="28040-165">After the particular record s data has been bound to the current `DataListItem` object, the DataList s `ItemDataBound` event is fired.</span></span> <span data-ttu-id="28040-166">我們可以建立這個事件，以查看目前的資料值的事件處理常式`DataListItem`並根據這些值，進行所需的任何格式的變更。</span><span class="sxs-lookup"><span data-stu-id="28040-166">We can create an event handler for this event to inspect the data values for the current `DataListItem` and, based upon those values, make any formatting changes necessary.</span></span>

<span data-ttu-id="28040-167">建立`ItemDataBound`DataList 的事件，並新增下列程式碼：</span><span class="sxs-lookup"><span data-stu-id="28040-167">Create an `ItemDataBound` event for the DataList and add the following code:</span></span>


[!code-vb[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample1.vb)]

<span data-ttu-id="28040-168">概念和 DataList s 背後的語意時`ItemDataBound`事件處理常式會與所使用的 GridView s 相同`RowDataBound`中的事件處理常式*自訂格式設定在資料*教學課程中，語法之間差異稍微。</span><span class="sxs-lookup"><span data-stu-id="28040-168">While the concept and semantics behind the DataList s `ItemDataBound` event handler are the same as those used by the GridView s `RowDataBound` event handler in the *Custom Formatting Based Upon Data* tutorial, the syntax differs slightly.</span></span> <span data-ttu-id="28040-169">當`ItemDataBound`事件引發時，`DataListItem`只是繫結至資料會傳遞至透過對應的事件處理常式`e.Item`(而非`e.Row`，就像使用 GridView 的`RowDataBound`事件處理常式)。</span><span class="sxs-lookup"><span data-stu-id="28040-169">When the `ItemDataBound` event fires, the `DataListItem` just bound to data is passed into corresponding event handler via `e.Item` (instead of `e.Row`, as with the GridView s `RowDataBound` event handler).</span></span> <span data-ttu-id="28040-170">DataList s`ItemDataBound`針對觸發的事件處理常式*每個*新增至 DataList 和包括標頭資料列，頁尾資料列分隔符號資料列的資料列。</span><span class="sxs-lookup"><span data-stu-id="28040-170">The DataList s `ItemDataBound` event handler fires for *each* row added to the DataList, including header rows, footer rows, and separator rows.</span></span> <span data-ttu-id="28040-171">不過，產品資訊只會繫結至資料列。</span><span class="sxs-lookup"><span data-stu-id="28040-171">However, the product information is only bound to the data rows.</span></span> <span data-ttu-id="28040-172">因此，當使用`ItemDataBound`事件，以檢查的資料繫結至 DataList 中，我們需要先確定我們重新處理資料的項目。</span><span class="sxs-lookup"><span data-stu-id="28040-172">Therefore, when using the `ItemDataBound` event to inspect the data bound to the DataList, we need to first ensure that we re working with a data item.</span></span> <span data-ttu-id="28040-173">這可藉由檢查`DataListItem`s [ `ItemType`屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.itemtype.aspx)，且可以包含的其中一個[下列八個值](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listitemtype.aspx):</span><span class="sxs-lookup"><span data-stu-id="28040-173">This can be accomplished by checking the `DataListItem` s [`ItemType` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.itemtype.aspx), which can have one of [the following eight values](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listitemtype.aspx):</span></span>

- `AlternatingItem`
- `EditItem`
- `Footer`
- `Header`
- `Item`
- `Pager`
- `SelectedItem`
- `Separator`

<span data-ttu-id="28040-174">兩者`Item`和`AlternatingItem``DataListItem`的結構 DataList s 中的資料項目。</span><span class="sxs-lookup"><span data-stu-id="28040-174">Both `Item` and `AlternatingItem``DataListItem` s makeup the DataList s data items.</span></span> <span data-ttu-id="28040-175">假設我們再次使用`Item`或是`AlternatingItem`，我們存取實際`ProductsRow`繫結至目前的執行個體`DataListItem`。</span><span class="sxs-lookup"><span data-stu-id="28040-175">Assuming we re working with an `Item` or `AlternatingItem`, we access the actual `ProductsRow` instance that was bound to the current `DataListItem`.</span></span> <span data-ttu-id="28040-176">`DataListItem` s [ `DataItem`屬性](https://msdn.microsoft.com/system.web.ui.webcontrols.datalistitem.dataitem.aspx)包含的參考`DataRowView`物件，其`Row`屬性提供的實際參考`ProductsRow`物件。</span><span class="sxs-lookup"><span data-stu-id="28040-176">The `DataListItem` s [`DataItem` property](https://msdn.microsoft.com/system.web.ui.webcontrols.datalistitem.dataitem.aspx) contains a reference to the `DataRowView` object, whose `Row` property provides a reference to the actual `ProductsRow` object.</span></span>

<span data-ttu-id="28040-177">接下來，我們會檢查`ProductsRow`執行個體的`UnitPrice`屬性。</span><span class="sxs-lookup"><span data-stu-id="28040-177">Next, we check the `ProductsRow` instance s `UnitPrice` property.</span></span> <span data-ttu-id="28040-178">因為產品資料表 s`UnitPrice`欄位可讓`NULL`值，然後再嘗試存取`UnitPrice`屬性我們應該先檢查以查看是否有`NULL`值使用`IsUnitPriceNull()`方法。</span><span class="sxs-lookup"><span data-stu-id="28040-178">Since the Products table s `UnitPrice` field allows `NULL` values, before attempting to access the `UnitPrice` property we should first check to see if it has a `NULL` value using the `IsUnitPriceNull()` method.</span></span> <span data-ttu-id="28040-179">如果`UnitPrice`值不是`NULL`，我們接著查看是否它 s 小於 $ 20.00 美元。</span><span class="sxs-lookup"><span data-stu-id="28040-179">If the `UnitPrice` value is not `NULL`, we then check to see if it s less than $20.00.</span></span> <span data-ttu-id="28040-180">如果它確實會在 $ 20.00 美元，我們需要套用自訂格式。</span><span class="sxs-lookup"><span data-stu-id="28040-180">If it is indeed under $20.00, we then need to apply the custom formatting.</span></span>

## <a name="step-3-highlighting-the-product-s-name-and-price"></a><span data-ttu-id="28040-181">步驟 3：反白顯示的產品名稱和價格</span><span class="sxs-lookup"><span data-stu-id="28040-181">Step 3: Highlighting the Product s Name and Price</span></span>

<span data-ttu-id="28040-182">一旦我們知道產品的價格是小於為 $ 20.00 美元，全都是反白顯示它的名稱和價格。</span><span class="sxs-lookup"><span data-stu-id="28040-182">Once we know that a product s price is less than $20.00, all that remains is to highlight its name and price.</span></span> <span data-ttu-id="28040-183">若要達成此目的，我們必須先以程式設計方式參考中的標籤控制項`ItemTemplate`，顯示產品的名稱和價格。</span><span class="sxs-lookup"><span data-stu-id="28040-183">To accomplish this, we must first programmatically reference the Label controls in the `ItemTemplate` that display the product s name and price.</span></span> <span data-ttu-id="28040-184">接下來，我們需要將它們顯示為黃色背景。</span><span class="sxs-lookup"><span data-stu-id="28040-184">Next, we need to have them display a yellow background.</span></span> <span data-ttu-id="28040-185">此格式的資訊可以直接修改標籤套用`BackColor`屬性 (`LabelID.BackColor = Color.Yellow`); 在理想情況下，不過，會透過階層式樣式表中表示所有顯示相關的事物。</span><span class="sxs-lookup"><span data-stu-id="28040-185">This formatting information can be applied by directly modifying the Labels `BackColor` properties (`LabelID.BackColor = Color.Yellow`); ideally, though, all display-related matters should be expressed through cascading stylesheets.</span></span> <span data-ttu-id="28040-186">事實上，我們已經有提供所要的格式中所定義的樣式表`Styles.css`  -  `AffordablePriceEmphasis`，已建立和討論*自訂格式化時資料*教學課程。</span><span class="sxs-lookup"><span data-stu-id="28040-186">In fact, we already have a stylesheet that provides the desired formatting defined in `Styles.css` - `AffordablePriceEmphasis`, which was created and discussed in the *Custom Formatting Based Upon Data* tutorial.</span></span>

<span data-ttu-id="28040-187">若要套用格式設定，請設定兩個 Label Web 控制項`CssClass`屬性，以`AffordablePriceEmphasis`，如下列程式碼所示：</span><span class="sxs-lookup"><span data-stu-id="28040-187">To apply the formatting, simply set the two Label Web controls `CssClass` properties to `AffordablePriceEmphasis`, as shown in the following code:</span></span>


[!code-vb[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample2.vb)]

<span data-ttu-id="28040-188">具有`ItemDataBound`事件處理常式已完成、 重新瀏覽`Formatting.aspx`瀏覽器中的頁面。</span><span class="sxs-lookup"><span data-stu-id="28040-188">With the `ItemDataBound` event handler completed, revisit the `Formatting.aspx` page in a browser.</span></span> <span data-ttu-id="28040-189">圖 2 所示，在 $ 20.00 美元價格的產品有其名稱 」 和 「 反白顯示的價格。</span><span class="sxs-lookup"><span data-stu-id="28040-189">As Figure 2 illustrates, those products with a price under $20.00 have both their name and price highlighted.</span></span>


<span data-ttu-id="28040-190">[![這些產品小於 $ 20.00 美元會反白顯示](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image5.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="28040-190">[![Those Products Less than $20.00 are Highlighted](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image5.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image4.png)</span></span>

<span data-ttu-id="28040-191">**圖 2**:這些產品小於 $ 20.00 美元會反白顯示 ([按一下以檢視完整大小的影像](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="28040-191">**Figure 2**: Those Products Less than $20.00 are Highlighted ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image6.png))</span></span>


> [!NOTE]
> <span data-ttu-id="28040-192">因為 DataList 會轉譯為 HTML `<table>`、 其`DataListItem`執行個體都可以將特定的樣式套用至整個項目設定的樣式相關屬性。</span><span class="sxs-lookup"><span data-stu-id="28040-192">Since the DataList is rendered as an HTML `<table>`, its `DataListItem` instances have style-related properties that can be set to apply a specific style to the entire item.</span></span> <span data-ttu-id="28040-193">比方說，如果我們想要反白顯示*整個*其價格的時間小於為 $ 20.00 美元，則項目黃色，我們可能已取代的程式碼參考的標籤，並將其`CssClass`具有下列程式碼行的屬性： `e.Item.CssClass = "AffordablePriceEmphasis"`（請參閱 圖 3）。</span><span class="sxs-lookup"><span data-stu-id="28040-193">For example, if we wanted to highlight the *entire* item yellow when its price was less than $20.00, we could have replaced the code that referenced the Labels and set their `CssClass` properties with the following line of code: `e.Item.CssClass = "AffordablePriceEmphasis"` (see Figure 3).</span></span>


<span data-ttu-id="28040-194">`RepeaterItem`構成 Repeater 控制項，不過，don t s 提供這類樣式層級屬性。</span><span class="sxs-lookup"><span data-stu-id="28040-194">The `RepeaterItem` s that make up the Repeater control, however, don t offer such style-level properties.</span></span> <span data-ttu-id="28040-195">因此，套用自訂格式 Repeater 需要應用程式樣式屬性的 Web 控制項 Repeater s 在範本內，就像我們在圖 2 中。</span><span class="sxs-lookup"><span data-stu-id="28040-195">Therefore, applying custom formatting to the Repeater requires the application of style properties to the Web controls within the Repeater s templates, just like we did in Figure 2.</span></span>


<span data-ttu-id="28040-196">[![整個產品項目會反白顯示的產品在 $ 20.00 美元](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image8.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="28040-196">[![The Entire Product Item is Highlighted for Products Under $20.00](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image8.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image7.png)</span></span>

<span data-ttu-id="28040-197">**圖 3**:整個產品項目會反白顯示的產品在 $ 20.00 美元 ([按一下以檢視完整大小的影像](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="28040-197">**Figure 3**: The Entire Product Item is Highlighted for Products Under $20.00 ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image9.png))</span></span>


## <a name="using-formatting-functions-from-within-the-template"></a><span data-ttu-id="28040-198">使用 從範本內的格式化功能</span><span class="sxs-lookup"><span data-stu-id="28040-198">Using Formatting Functions from Within the Template</span></span>

<span data-ttu-id="28040-199">在 *使用 GridView 控制項中的 TemplateFields*教學課程中我們了解如何使用 GridView TemplateField 內格式化函式來套用自訂格式，根據資料繫結至 GridView s 資料列。</span><span class="sxs-lookup"><span data-stu-id="28040-199">In the *Using TemplateFields in the GridView Control* tutorial we saw how to use a formatting function within a GridView TemplateField to apply custom formatting based upon the data bound to the GridView s rows.</span></span> <span data-ttu-id="28040-200">格式函式是方法，可以從範本中叫用，並傳回在其位置，就會發出 HTML。</span><span class="sxs-lookup"><span data-stu-id="28040-200">A formatting function is a method that can be invoked from a template and returns the HTML to be emitted in its place.</span></span> <span data-ttu-id="28040-201">格式函式可以位於 ASP.NET 頁面 s 程式碼後置類別，或可以集中式中的類別檔案到`App_Code`資料夾或個別的類別庫專案中。</span><span class="sxs-lookup"><span data-stu-id="28040-201">Formatting functions can reside in the ASP.NET page s code-behind class or can be centralized into class files in the `App_Code` folder or in a separate Class Library project.</span></span> <span data-ttu-id="28040-202">將格式化的函式，從 ASP.NET 頁面 s 程式碼後置類別移是理想，如果您計劃在多個 ASP.NET 網頁或其他 ASP.NET web 應用程式中使用相同的格式設定函式。</span><span class="sxs-lookup"><span data-stu-id="28040-202">Moving the formatting function out of the ASP.NET page s code-behind class is ideal if you plan on using the same formatting function in multiple ASP.NET pages or in other ASP.NET web applications.</span></span>

<span data-ttu-id="28040-203">為了示範格式化功能，可讓 s 有產品資訊包含產品的名稱旁邊的 [DISCONTINUED] 的文字，如果它已停止的 s。</span><span class="sxs-lookup"><span data-stu-id="28040-203">To demonstrate formatting functions, let s have the product information include the text [DISCONTINUED] next to the product s name if it s discontinued.</span></span> <span data-ttu-id="28040-204">此外，可讓 s 有價格反白顯示黃色如果它小於 $ 20.00 美元 s (如同我們在`ItemDataBound`事件處理常式範例); 如果價格是 $ 20.00 美元或更高版本，可讓 s 不會顯示實際的價格，但價格報價的文字，請改為呼叫。</span><span class="sxs-lookup"><span data-stu-id="28040-204">Also, let s have the price highlighted yellow if it s less than $20.00 (as we did in the `ItemDataBound` event handler example); if the price is $20.00 or higher, let s not display the actual price, but instead the text, Please call for a price quote.</span></span> <span data-ttu-id="28040-205">[圖 4] 顯示的螢幕擷取畫面列出套用這些格式化規則的產品。</span><span class="sxs-lookup"><span data-stu-id="28040-205">Figure 4 shows a screen shot of the products listing with these formatting rules applied.</span></span>


<span data-ttu-id="28040-206">[![適用於昂貴的產品，價格會取代文字，請呼叫價格報價](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image11.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="28040-206">[![For Expensive Products, the Price is Replaced with the Text, Please call for a price quote](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image11.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image10.png)</span></span>

<span data-ttu-id="28040-207">**圖 4**:適用於昂貴的產品，價格會取代文字，請呼叫價格報價 ([按一下以檢視完整大小的影像](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="28040-207">**Figure 4**: For Expensive Products, the Price is Replaced with the Text, Please call for a price quote ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image12.png))</span></span>


## <a name="step-1-create-the-formatting-functions"></a><span data-ttu-id="28040-208">步驟 1：建立格式化的函式</span><span class="sxs-lookup"><span data-stu-id="28040-208">Step 1: Create the Formatting Functions</span></span>

<span data-ttu-id="28040-209">此範例中我們需要兩種格式化函式，其中會顯示產品名稱與文字 [DISCONTINUED]，如有需要和另一個顯示其中一個反白顯示的價格，如果它小於 $ 20.00 美元或該文字，請呼叫價格報價，否則為 s。</span><span class="sxs-lookup"><span data-stu-id="28040-209">For this example we need two formatting functions, one that displays the product name along with the text [DISCONTINUED], if needed, and another that displays either a highlighted price if it s less than $20.00, or the text, Please call for a price quote otherwise.</span></span> <span data-ttu-id="28040-210">可讓 ASP.NET 頁面 s 程式碼後置類別中建立這些函數及它們的名稱`DisplayProductNameAndDiscontinuedStatus`和`DisplayPrice`。</span><span class="sxs-lookup"><span data-stu-id="28040-210">Let s create these functions in the ASP.NET page s code-behind class and name them `DisplayProductNameAndDiscontinuedStatus` and `DisplayPrice`.</span></span> <span data-ttu-id="28040-211">這兩種方法需要傳回的 HTML 字串形式呈現，而且兩者都必須標示`Protected`(或`Public`) 才能叫用從 ASP.NET 頁面 s 宣告式語法部分。</span><span class="sxs-lookup"><span data-stu-id="28040-211">Both methods need to return the HTML to render as a string and both need to be marked `Protected` (or `Public`) in order to be invoked from the ASP.NET page s declarative syntax portion.</span></span> <span data-ttu-id="28040-212">這兩種方法的程式碼如下：</span><span class="sxs-lookup"><span data-stu-id="28040-212">The code for these two methods follows:</span></span>


[!code-vb[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample3.vb)]

<span data-ttu-id="28040-213">請注意，`DisplayProductNameAndDiscontinuedStatus`方法可接受的值`productName`並`discontinued`資料欄位做為純量值，而`DisplayPrice`方法會接受`ProductsRow`執行個體 (而非`unitPrice`純量值)。</span><span class="sxs-lookup"><span data-stu-id="28040-213">Note that the `DisplayProductNameAndDiscontinuedStatus` method accepts the values of the `productName` and `discontinued` data fields as scalar values, whereas the `DisplayPrice` method accepts a `ProductsRow` instance (rather than a `unitPrice` scalar value).</span></span> <span data-ttu-id="28040-214">兩種方法將運作;不過，如果格式化的函式使用可以包含資料庫的純量值`NULL`值 (這類`UnitPrice`; 不`ProductName`也不`Discontinued`允許`NULL`值)，特別小心處理這些純量輸入。</span><span class="sxs-lookup"><span data-stu-id="28040-214">Either approach will work; however, if the formatting function is working with scalar values that can contain database `NULL` values (such as `UnitPrice`; neither `ProductName` nor `Discontinued` allow `NULL` values), special care must be taken in handling these scalar inputs.</span></span>

<span data-ttu-id="28040-215">特別是，輸入的參數必須屬於型別`Object`連入的值可能是因為`DBNull`而不是預期的資料類型的執行個體。</span><span class="sxs-lookup"><span data-stu-id="28040-215">In particular, the input parameter must be of type `Object` since the incoming value might be a `DBNull` instance instead of the expected data type.</span></span> <span data-ttu-id="28040-216">此外，必須進行檢查以判斷輸入的值是否為資料庫`NULL`值。</span><span class="sxs-lookup"><span data-stu-id="28040-216">Additionally, a check must be made to determine whether or not the incoming value is a database `NULL` value.</span></span> <span data-ttu-id="28040-217">也就是說，如果我們想`DisplayPrice`一定要使用下列程式碼的方法，以接受價格為純量值時，我們的 d:</span><span class="sxs-lookup"><span data-stu-id="28040-217">That is, if we wanted the `DisplayPrice` method to accept the price as a scalar value, we d have to use the following code:</span></span>


[!code-vb[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample4.vb)]

<span data-ttu-id="28040-218">請注意，`unitPrice`輸入的參數的類型是`Object`並已修改過的條件陳述式來確定如果`unitPrice`是`DBNull`與否。</span><span class="sxs-lookup"><span data-stu-id="28040-218">Note that the `unitPrice` input parameter is of type `Object` and that the conditional statement has been modified to ascertain if `unitPrice` is `DBNull` or not.</span></span> <span data-ttu-id="28040-219">此外，因為`unitPrice`當做傳入輸入的參數`Object`，必須將它轉換成十進位值。</span><span class="sxs-lookup"><span data-stu-id="28040-219">Furthermore, since the `unitPrice` input parameter is passed in as an `Object`, it must be cast to a decimal value.</span></span>

## <a name="step-2-calling-the-formatting-function-from-the-datalist-s-itemtemplate"></a><span data-ttu-id="28040-220">步驟 2：從 DataList 的 ItemTemplate 呼叫格式化函式</span><span class="sxs-lookup"><span data-stu-id="28040-220">Step 2: Calling the Formatting Function from the DataList s ItemTemplate</span></span>

<span data-ttu-id="28040-221">格式函式新增到 ASP.NET 頁面 s 程式碼後置類別中，剩下的就是叫用這些格式化 DataList s 函式`ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="28040-221">With the formatting functions added to our ASP.NET page s code-behind class, all that remains is to invoke these formatting functions from the DataList s `ItemTemplate`.</span></span> <span data-ttu-id="28040-222">若要從範本呼叫格式化函式，放入該函式呼叫內的資料繫結語法：</span><span class="sxs-lookup"><span data-stu-id="28040-222">To call a formatting function from a template, place the function call within the databinding syntax:</span></span>


[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample5.aspx)]

<span data-ttu-id="28040-223">在 DataList s `ItemTemplate` `ProductNameLabel` Label Web 控制項目前有顯示產品的名稱指派其`Text`屬性結果的`<%# Eval("ProductName") %>`。</span><span class="sxs-lookup"><span data-stu-id="28040-223">In the DataList s `ItemTemplate` the `ProductNameLabel` Label Web control currently displays the product s name by assigning its `Text` property the result of `<%# Eval("ProductName") %>`.</span></span> <span data-ttu-id="28040-224">為了讓它顯示名稱加上文字 [DISCONTINUED]，如有需要更新的宣告式語法，使它改為將指派`Text`屬性值的`DisplayProductNameAndDiscontinuedStatus`方法。</span><span class="sxs-lookup"><span data-stu-id="28040-224">In order to have it display the name plus the text [DISCONTINUED], if needed, update the declarative syntax so that it instead assigns the `Text` property the value of the `DisplayProductNameAndDiscontinuedStatus` method.</span></span> <span data-ttu-id="28040-225">當這麼做，我們必須傳遞 s 產品名稱和已停止使用的值`Eval("columnName")`語法。</span><span class="sxs-lookup"><span data-stu-id="28040-225">When doing so, we must pass in the product s name and discontinued values using the `Eval("columnName")` syntax.</span></span> <span data-ttu-id="28040-226">`Eval` 傳回值的型別`Object`，但`DisplayProductNameAndDiscontinuedStatus`方法預期的輸入的參數的型別`String`並`Boolean`; 因此，我們必須轉換所傳回的值`Eval`方法預期的輸入的參數類型，就像這樣：</span><span class="sxs-lookup"><span data-stu-id="28040-226">`Eval` returns a value of type `Object`, but the `DisplayProductNameAndDiscontinuedStatus` method expects input parameters of type `String` and `Boolean`; therefore, we must cast the values returned by the `Eval` method to the expected input parameter types, like so:</span></span>


[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample6.aspx)]

<span data-ttu-id="28040-227">若要顯示的價格，我們可以直接設定`UnitPriceLabel`標籤 s`Text`屬性所傳回的值為`DisplayPrice`方法，就像我們未顯示產品的名稱和 [停用] 文字。</span><span class="sxs-lookup"><span data-stu-id="28040-227">To display the price, we can simply set the `UnitPriceLabel` Label s `Text` property to the value returned by the `DisplayPrice` method, just like we did for displaying the product s name and [DISCONTINUED] text.</span></span> <span data-ttu-id="28040-228">不過，而不是傳入`UnitPrice`做為純量的輸入參數，我們改為傳入整個`ProductsRow`執行個體：</span><span class="sxs-lookup"><span data-stu-id="28040-228">However, instead of passing in the `UnitPrice` as a scalar input parameter, we instead pass in the entire `ProductsRow` instance:</span></span>


[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample7.aspx)]

<span data-ttu-id="28040-229">就地格式化函式呼叫，請花一點時間瀏覽器中檢視進度。</span><span class="sxs-lookup"><span data-stu-id="28040-229">With the calls to the formatting functions in place, take a moment to view our progress in a browser.</span></span> <span data-ttu-id="28040-230">您的畫面看起來應該類似 [圖 5 已停止的產品，包含文字 [DISCONTINUED] 而且成本超過 $ 20.00 美元具有其價格的產品以取代文字請價格報價的呼叫。</span><span class="sxs-lookup"><span data-stu-id="28040-230">Your screen should look similar to Figure 5, with the discontinued products including the text [DISCONTINUED] and those products costing more than $20.00 having their price replaced with the text Please call for a price quote .</span></span>


<span data-ttu-id="28040-231">[![適用於昂貴的產品，價格會取代文字，請呼叫價格報價](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image14.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="28040-231">[![For Expensive Products, the Price is Replaced with the Text, Please call for a price quote](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image14.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image13.png)</span></span>

<span data-ttu-id="28040-232">**圖 5**:適用於昂貴的產品，價格會取代文字，請呼叫價格報價 ([按一下以檢視完整大小的影像](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="28040-232">**Figure 5**: For Expensive Products, the Price is Replaced with the Text, Please call for a price quote ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image15.png))</span></span>


## <a name="summary"></a><span data-ttu-id="28040-233">總結</span><span class="sxs-lookup"><span data-stu-id="28040-233">Summary</span></span>

<span data-ttu-id="28040-234">格式化 DataList 或 Repeater 控制項資料為基礎的內容可以透過兩種技術。</span><span class="sxs-lookup"><span data-stu-id="28040-234">Formatting the contents of a DataList or Repeater control based upon the data can be accomplished using two techniques.</span></span> <span data-ttu-id="28040-235">第一個技巧是要建立的事件處理常式`ItemDataBound`引發的事件，因為資料來源中的每一筆記錄會繫結至新`DataListItem`或`RepeaterItem`。</span><span class="sxs-lookup"><span data-stu-id="28040-235">The first technique is to create an event handler for the `ItemDataBound` event, which fires as each record in the data source is bound to a new `DataListItem` or `RepeaterItem`.</span></span> <span data-ttu-id="28040-236">在 `ItemDataBound`事件處理常式，可檢查目前的項目的資料，然後格式化可以套用至內容的範本，或針對`DataListItem`s，整個項目本身。</span><span class="sxs-lookup"><span data-stu-id="28040-236">In the `ItemDataBound` event handler, the current item s data can be examined and then formatting can be applied to the contents of the template or, for `DataListItem` s, to the entire item itself.</span></span>

<span data-ttu-id="28040-237">或者，自訂格式可以實現透過格式設定函式。</span><span class="sxs-lookup"><span data-stu-id="28040-237">Alternatively, custom formatting can be realized through formatting functions.</span></span> <span data-ttu-id="28040-238">可以從 DataList 中叫用方法或 Repeater 的範本，傳回要在其位置中發出的 HTML 格式的函式。</span><span class="sxs-lookup"><span data-stu-id="28040-238">A formatting function is a method that can be invoked from the DataList or Repeater s templates that returns the HTML to emit in its place.</span></span> <span data-ttu-id="28040-239">格式函式所傳回的 HTML，通常取決於繫結至目前的項目值。</span><span class="sxs-lookup"><span data-stu-id="28040-239">Often, the HTML returned by a formatting function is determined by the values being bound to the current item.</span></span> <span data-ttu-id="28040-240">這些值可以傳遞到格式化的函式，做為純量值或傳遞整個物件繫結至項目 (例如`ProductsRow`執行個體)。</span><span class="sxs-lookup"><span data-stu-id="28040-240">These values can be passed into the formatting function, either as scalar values or by passing in the entire object being bound to the item (such as the `ProductsRow` instance).</span></span>

<span data-ttu-id="28040-241">快樂地寫程式 ！</span><span class="sxs-lookup"><span data-stu-id="28040-241">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="28040-242">關於作者</span><span class="sxs-lookup"><span data-stu-id="28040-242">About the Author</span></span>

<span data-ttu-id="28040-243">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，作者的七個 ASP 書籍和的創辦人[4GuysFromRolla.com](http://www.4guysfromrolla.com)，自 1998 年從事 Microsoft Web 技術工作。</span><span class="sxs-lookup"><span data-stu-id="28040-243">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="28040-244">Scott 會擔任獨立的顧問、 培訓講師和作家。</span><span class="sxs-lookup"><span data-stu-id="28040-244">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="28040-245">他最新的著作是[ *Sams 教導您自己 ASP.NET 2.0 在 24 小時內*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="28040-245">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="28040-246">他可以在觸達[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="28040-246">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="28040-247">或透過他的部落格，這位於 [http://ScottOnWriting.NET](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="28040-247">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="28040-248">特別感謝</span><span class="sxs-lookup"><span data-stu-id="28040-248">Special Thanks To</span></span>

<span data-ttu-id="28040-249">本教學課程系列是由許多實用的檢閱者檢閱。</span><span class="sxs-lookup"><span data-stu-id="28040-249">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="28040-250">本教學課程中的潛在客戶檢閱者已 Yaakov Ellis、 Randy Schmidt 和 Liz Shulok。</span><span class="sxs-lookup"><span data-stu-id="28040-250">Lead reviewers for this tutorial were Yaakov Ellis, Randy Schmidt, and Liz Shulok.</span></span> <span data-ttu-id="28040-251">有興趣檢閱我即將推出的 MSDN 文章嗎？</span><span class="sxs-lookup"><span data-stu-id="28040-251">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="28040-252">如果是這樣，psychic 在[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="28040-252">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="28040-253">[上一頁](displaying-data-with-the-datalist-and-repeater-controls-vb.md)
> [下一頁](showing-multiple-records-per-row-with-the-datalist-control-vb.md)</span><span class="sxs-lookup"><span data-stu-id="28040-253">[Previous](displaying-data-with-the-datalist-and-repeater-controls-vb.md)
[Next](showing-multiple-records-per-row-with-the-datalist-control-vb.md)</span></span>
