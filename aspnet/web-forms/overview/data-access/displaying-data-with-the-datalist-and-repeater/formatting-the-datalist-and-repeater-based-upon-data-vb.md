---
uid: web-forms/overview/data-access/displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-vb
title: 根據資料格式化 DataList 和重複項（VB） |Microsoft Docs
author: rick-anderson
description: 在本教學課程中，我們將逐步解說範例，說明如何使用格式化函數搭配 ... 來格式化 DataList 和中繼器控制項的外觀。
ms.author: riande
ms.date: 09/13/2006
ms.assetid: e2f401ae-37bb-4b19-aa97-d6b385d40f88
msc.legacyurl: /web-forms/overview/data-access/displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-vb
msc.type: authoredcontent
ms.openlocfilehash: c9b60e4dacd992962942034e84c01cb82e039c81
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/28/2019
ms.locfileid: "74636773"
---
# <a name="formatting-the-datalist-and-repeater-based-upon-data-vb"></a><span data-ttu-id="cb881-103">根據資料格式化 DataList 和重複項 (VB)</span><span class="sxs-lookup"><span data-stu-id="cb881-103">Formatting the DataList and Repeater Based Upon Data (VB)</span></span>

<span data-ttu-id="cb881-104">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="cb881-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="cb881-105">[下載範例應用程式](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_30_VB.exe)或[下載 PDF](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/datatutorial30vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="cb881-105">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_30_VB.exe) or [Download PDF](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/datatutorial30vb1.pdf)</span></span>

> <span data-ttu-id="cb881-106">在本教學課程中，我們將逐步解說範例，說明如何使用範本內的格式函數或藉由處理資料系結事件，來格式化 DataList 和中繼器控制項的外觀。</span><span class="sxs-lookup"><span data-stu-id="cb881-106">In this tutorial we'll step through examples of how we format the appearance of the DataList and Repeater controls, either by using formatting functions within templates or by handling the DataBound event.</span></span>

## <a name="introduction"></a><span data-ttu-id="cb881-107">簡介</span><span class="sxs-lookup"><span data-stu-id="cb881-107">Introduction</span></span>

<span data-ttu-id="cb881-108">如我們在先前的教學課程中所見，DataList 提供一些會影響其外觀的樣式相關屬性。</span><span class="sxs-lookup"><span data-stu-id="cb881-108">As we saw in the preceding tutorial, the DataList offers a number of style-related properties that affect its appearance.</span></span> <span data-ttu-id="cb881-109">特別是，我們已瞭解如何將預設 CSS 類別指派給 DataList s `HeaderStyle`、`ItemStyle`、`AlternatingItemStyle`和 `SelectedItemStyle` 屬性。</span><span class="sxs-lookup"><span data-stu-id="cb881-109">In particular, we saw how to assign default CSS classes to the DataList s `HeaderStyle`, `ItemStyle`, `AlternatingItemStyle`, and `SelectedItemStyle` properties.</span></span> <span data-ttu-id="cb881-110">除了這四個屬性以外，DataList 還包含一些其他樣式相關的屬性，例如 `Font`、`ForeColor`、`BackColor`和 `BorderWidth`等等。</span><span class="sxs-lookup"><span data-stu-id="cb881-110">In addition to these four properties, the DataList includes a number of other style-related properties, such as `Font`, `ForeColor`, `BackColor`, and `BorderWidth`, to name a few.</span></span> <span data-ttu-id="cb881-111">中繼器控制項不包含任何與樣式相關的屬性。</span><span class="sxs-lookup"><span data-stu-id="cb881-111">The Repeater control does not contain any style-related properties.</span></span> <span data-ttu-id="cb881-112">任何這類樣式設定都必須直接在「中繼器」範本的標記內進行。</span><span class="sxs-lookup"><span data-stu-id="cb881-112">Any such style settings must be made directly within the markup in the Repeater s templates.</span></span>

<span data-ttu-id="cb881-113">不過，通常資料的格式化方式取決於資料本身。</span><span class="sxs-lookup"><span data-stu-id="cb881-113">Often, though, how data should be formatted depends on the data itself.</span></span> <span data-ttu-id="cb881-114">例如，當列出產品時，我們可能會想要以淺灰色字型色彩來顯示產品資訊（如果已停用），或者，如果是零，我們可能會想要反白顯示 `UnitsInStock` 值。</span><span class="sxs-lookup"><span data-stu-id="cb881-114">For example, when listing products we might want to display the product information in a light gray font color if it is discontinued, or we may want to highlight the `UnitsInStock` value if it is zero.</span></span> <span data-ttu-id="cb881-115">如我們在先前的教學課程中所見，GridView、DetailsView 和 FormView 提供兩種不同的方式，根據其資料來格式化其外觀：</span><span class="sxs-lookup"><span data-stu-id="cb881-115">As we saw in previous tutorials, the GridView, DetailsView, and FormView offer two distinct ways to format their appearance based on their data:</span></span>

- <span data-ttu-id="cb881-116">**`DataBound` 事件**會為適當的 `DataBound` 事件建立事件處理常式，這會在資料系結至每個專案（針對 GridView 是 `RowDataBound` 事件時引發），而 DataList 和中繼器則是 `ItemDataBound` 事件）。</span><span class="sxs-lookup"><span data-stu-id="cb881-116">**The `DataBound` event** create an event handler for the appropriate `DataBound` event, which fires after the data has been bound to each item (for the GridView it was the `RowDataBound` event; for the DataList and Repeater it is the `ItemDataBound` event).</span></span> <span data-ttu-id="cb881-117">在該事件處理常式中，可以檢查剛系結的資料，並進行格式設定決策。</span><span class="sxs-lookup"><span data-stu-id="cb881-117">In that event handler, the data just bound can be examined and formatting decisions made.</span></span> <span data-ttu-id="cb881-118">我們已在[根據資料的自訂格式](../custom-formatting/custom-formatting-based-upon-data-vb.md)教學課程中檢查這項技術。</span><span class="sxs-lookup"><span data-stu-id="cb881-118">We examined this technique in the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-vb.md) tutorial.</span></span>
- <span data-ttu-id="cb881-119">使用 DetailsView 或 GridView 控制項中的 TemplateFields 或在 FormView 控制項中使用範本時，在**範本中格式化**函式，我們可以將格式化函式新增至 ASP.NET 網頁的程式碼後置類別、商務邏輯層，或可從 web 應用程式存取的任何其他類別庫。</span><span class="sxs-lookup"><span data-stu-id="cb881-119">**Formatting Functions in Templates** when using TemplateFields in the DetailsView or GridView controls, or a template in the FormView control, we can add a formatting function to the ASP.NET page s code-behind class, the Business Logic Layer, or any other class library that is accessible from the web application.</span></span> <span data-ttu-id="cb881-120">此格式化功能可以接受任意數目的輸入參數，但必須傳回 HTML 以在範本中轉譯。</span><span class="sxs-lookup"><span data-stu-id="cb881-120">This formatting function can accept an arbitrary number of input parameters, but must return the HTML to render in the template.</span></span> <span data-ttu-id="cb881-121">在 GridView 控制項教學課程中，[使用 TemplateFields](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md)先檢查格式函數。</span><span class="sxs-lookup"><span data-stu-id="cb881-121">Formatting functions were first examined in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) tutorial.</span></span>

<span data-ttu-id="cb881-122">這兩種格式化技術都可透過 DataList 和中繼器控制項來使用。</span><span class="sxs-lookup"><span data-stu-id="cb881-122">Both of these formatting techniques are available with the DataList and Repeater controls.</span></span> <span data-ttu-id="cb881-123">在本教學課程中，我們將逐步解說針對這兩個控制項使用這兩種技術的範例。</span><span class="sxs-lookup"><span data-stu-id="cb881-123">In this tutorial we'll step through examples using both techniques for both controls.</span></span>

## <a name="using-theitemdataboundevent-handler"></a><span data-ttu-id="cb881-124">使用`ItemDataBound`事件處理常式</span><span class="sxs-lookup"><span data-stu-id="cb881-124">Using the`ItemDataBound`Event Handler</span></span>

<span data-ttu-id="cb881-125">當資料系結至 DataList 時（從資料來源控制項，或透過程式設計方式將資料指派給控制項 `DataSource` 屬性並呼叫其 `DataBind()` 方法），會引發 DataList s `DataBinding` 事件、列舉的資料來源，而且每個資料記錄都會系結至 DataList。</span><span class="sxs-lookup"><span data-stu-id="cb881-125">When data is bound to a DataList, either from a data source control or through programmatically assigning data to the control s `DataSource` property and calling its `DataBind()` method, the DataList s `DataBinding` event fires, the data source enumerated, and each data record is bound to the DataList.</span></span> <span data-ttu-id="cb881-126">對於資料來源中的每筆記錄，DataList 會建立一個[`DataListItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.aspx)物件，然後系結至目前的記錄。</span><span class="sxs-lookup"><span data-stu-id="cb881-126">For each record in the data source, the DataList creates a [`DataListItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.aspx) object that is then bound to the current record.</span></span> <span data-ttu-id="cb881-127">在此過程中，DataList 會引發兩個事件：</span><span class="sxs-lookup"><span data-stu-id="cb881-127">During this process, the DataList raises two events:</span></span>

- <span data-ttu-id="cb881-128">建立 `DataListItem` 之後， **`ItemCreated`** 引發</span><span class="sxs-lookup"><span data-stu-id="cb881-128">**`ItemCreated`** fires after the `DataListItem` has been created</span></span>
- <span data-ttu-id="cb881-129">當目前的記錄已系結至 `DataListItem` 之後， **`ItemDataBound`** 引發</span><span class="sxs-lookup"><span data-stu-id="cb881-129">**`ItemDataBound`** fires after the current record has been bound to the `DataListItem`</span></span>

<span data-ttu-id="cb881-130">下列步驟概述 DataList 控制項的資料系結程式。</span><span class="sxs-lookup"><span data-stu-id="cb881-130">The following steps outline the data binding process for the DataList control.</span></span>

1. <span data-ttu-id="cb881-131">DataList s [`DataBinding` 事件](https://msdn.microsoft.com/library/system.web.ui.control.databinding.aspx)會引發</span><span class="sxs-lookup"><span data-stu-id="cb881-131">The DataList s [`DataBinding` event](https://msdn.microsoft.com/library/system.web.ui.control.databinding.aspx) fires</span></span>
2. <span data-ttu-id="cb881-132">資料會系結至 DataList</span><span class="sxs-lookup"><span data-stu-id="cb881-132">The data is bound to the DataList</span></span>  
  
   <span data-ttu-id="cb881-133">針對資料來源中的每筆記錄</span><span class="sxs-lookup"><span data-stu-id="cb881-133">For each record in the data source</span></span> 

    1. <span data-ttu-id="cb881-134">建立 `DataListItem` 物件</span><span class="sxs-lookup"><span data-stu-id="cb881-134">Create a `DataListItem` object</span></span>
    2. <span data-ttu-id="cb881-135">引發[`ItemCreated` 事件](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemcreated.aspx)</span><span class="sxs-lookup"><span data-stu-id="cb881-135">Fire the [`ItemCreated` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemcreated.aspx)</span></span>
    3. <span data-ttu-id="cb881-136">將記錄系結至 `DataListItem`</span><span class="sxs-lookup"><span data-stu-id="cb881-136">Bind the record to the `DataListItem`</span></span>
    4. <span data-ttu-id="cb881-137">引發[`ItemDataBound` 事件](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemdatabound.aspx)</span><span class="sxs-lookup"><span data-stu-id="cb881-137">Fire the [`ItemDataBound` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemdatabound.aspx)</span></span>
    5. <span data-ttu-id="cb881-138">將 `DataListItem` 新增至 `Items` 集合</span><span class="sxs-lookup"><span data-stu-id="cb881-138">Add the `DataListItem` to the `Items` collection</span></span>

<span data-ttu-id="cb881-139">當您將資料系結至中繼器控制項時，它會經歷完全相同的步驟順序。</span><span class="sxs-lookup"><span data-stu-id="cb881-139">When binding data to the Repeater control, it progresses through the exact same sequence of steps.</span></span> <span data-ttu-id="cb881-140">唯一的差別在於，重複項會使用[`RepeaterItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeateritem(VS.80).aspx)s，而不是建立 `DataListItem` 實例。</span><span class="sxs-lookup"><span data-stu-id="cb881-140">The only difference is that instead of `DataListItem` instances being created, the Repeater uses [`RepeaterItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeateritem(VS.80).aspx)s.</span></span>

> [!NOTE]
> <span data-ttu-id="cb881-141">精明讀取器可能已注意到當 DataList 和中繼器系結至資料時，與 GridView 系結至資料時，所發生的一系列步驟稍有異常。</span><span class="sxs-lookup"><span data-stu-id="cb881-141">The astute reader may have noticed a slight anomaly between the sequence of steps that transpire when the DataList and Repeater are bound to data versus when the GridView is bound to data.</span></span> <span data-ttu-id="cb881-142">在資料系結程式的結尾處，GridView 會引發 `DataBound` 事件;不過，DataList 和中繼器控制項都不會有這類事件。</span><span class="sxs-lookup"><span data-stu-id="cb881-142">At the tail end of the data binding process, the GridView raises the `DataBound` event; however, neither the DataList nor Repeater control have such an event.</span></span> <span data-ttu-id="cb881-143">這是因為在前置和後置層級事件處理常式模式變得很常見之前，會在 ASP.NET 1.x 的時間範圍內重新建立 DataList 和中繼器控制項。</span><span class="sxs-lookup"><span data-stu-id="cb881-143">This is because the DataList and Repeater controls were created back in the ASP.NET 1.x timeframe, before the pre- and post-level event handler pattern had become common.</span></span>

<span data-ttu-id="cb881-144">就像 GridView 一樣，根據資料進行格式化的一個選項是建立 `ItemDataBound` 事件的事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="cb881-144">Like with the GridView, one option for formatting based on the data is to create an event handler for the `ItemDataBound` event.</span></span> <span data-ttu-id="cb881-145">這個事件處理常式會檢查剛剛系結至 `DataListItem` 或 `RepeaterItem` 的資料，並視需要影響控制項的格式。</span><span class="sxs-lookup"><span data-stu-id="cb881-145">This event handler would inspect the data that had just been bound to the `DataListItem` or `RepeaterItem` and affect the formatting of the control as needed.</span></span>

<span data-ttu-id="cb881-146">對於 DataList 控制項，可以使用 `DataListItem` 的樣式相關屬性（包括標準 `Font`、`ForeColor`、`BackColor`、`CssClass`等等）來執行整個專案的格式化變更。</span><span class="sxs-lookup"><span data-stu-id="cb881-146">For the DataList control, formatting changes for the entire item can be implemented using the `DataListItem` s style-related properties, which include the standard `Font`, `ForeColor`, `BackColor`, `CssClass`, and so on.</span></span> <span data-ttu-id="cb881-147">為了影響 DataList s 範本內特定 Web 控制項的格式，我們需要以程式設計方式存取和修改這些 Web 控制項的樣式。</span><span class="sxs-lookup"><span data-stu-id="cb881-147">To affect the formatting of particular Web controls within the DataList s template, we need to programmatically access and modify the style of those Web controls.</span></span> <span data-ttu-id="cb881-148">我們已瞭解如何在*根據資料的自訂格式*教學課程中完成這項工作。</span><span class="sxs-lookup"><span data-stu-id="cb881-148">We saw how to accomplish this back in the *Custom Formatting Based Upon Data* tutorial.</span></span> <span data-ttu-id="cb881-149">如同重複項控制項，`RepeaterItem` 類別沒有與樣式相關的屬性;因此，在 `ItemDataBound` 事件處理常式中對 `RepeaterItem` 所做的所有樣式相關變更，都必須藉由以程式設計方式存取及更新範本內的 Web 控制項來完成。</span><span class="sxs-lookup"><span data-stu-id="cb881-149">Like the Repeater control, the `RepeaterItem` class has no style-related properties; therefore, all style-related changes made to a `RepeaterItem` in the `ItemDataBound` event handler must be done by programmatically accessing and updating Web controls within the template.</span></span>

<span data-ttu-id="cb881-150">由於 DataList 和中繼器的 `ItemDataBound` 格式化技巧幾乎完全相同，我們的範例將著重在使用 DataList。</span><span class="sxs-lookup"><span data-stu-id="cb881-150">Since the `ItemDataBound` formatting technique for the DataList and Repeater are virtually identical, our example will focus on using the DataList.</span></span>

## <a name="step-1-displaying-product-information-in-the-datalist"></a><span data-ttu-id="cb881-151">步驟1：在 DataList 中顯示產品資訊</span><span class="sxs-lookup"><span data-stu-id="cb881-151">Step 1: Displaying Product Information in the DataList</span></span>

<span data-ttu-id="cb881-152">在我們擔心格式化之前，先建立一個使用 DataList 來顯示產品資訊的頁面。</span><span class="sxs-lookup"><span data-stu-id="cb881-152">Before we worry about the formatting, let s first create a page that uses a DataList to display product information.</span></span> <span data-ttu-id="cb881-153">在[上一個教學](displaying-data-with-the-datalist-and-repeater-controls-vb.md)課程中，我們建立了一個 DataList，其 `ItemTemplate` 顯示每個產品的名稱、類別、供應商、每個單位的數量和價格。</span><span class="sxs-lookup"><span data-stu-id="cb881-153">In the [previous tutorial](displaying-data-with-the-datalist-and-repeater-controls-vb.md) we created a DataList whose `ItemTemplate` displayed each product s name, category, supplier, quantity per unit, and price.</span></span> <span data-ttu-id="cb881-154">讓我們在本教學課程中重複此功能。</span><span class="sxs-lookup"><span data-stu-id="cb881-154">Let s repeat this functionality here in this tutorial.</span></span> <span data-ttu-id="cb881-155">若要完成這項操作，您可以從頭開始重新建立 DataList 和其 ObjectDataSource，也可以從上一個教學課程中建立的頁面（`Basics.aspx`）複製這些控制項，然後將它們貼入本教學課程的頁面（`Formatting.aspx`）。</span><span class="sxs-lookup"><span data-stu-id="cb881-155">To accomplish this, you can either recreate the DataList and its ObjectDataSource from scratch, or you can copy over those controls from the page created in the previous tutorial (`Basics.aspx`) and paste them into the page for this tutorial (`Formatting.aspx`).</span></span>

<span data-ttu-id="cb881-156">將 DataList 和 ObjectDataSource 功能從 `Basics.aspx` 複寫到 `Formatting.aspx`之後，請花點時間將 DataList s `ID` 屬性從 `DataList1` 變更為更具描述性的 `ItemDataBoundFormattingExample`。</span><span class="sxs-lookup"><span data-stu-id="cb881-156">Once you have replicated the DataList and ObjectDataSource functionality from `Basics.aspx` into `Formatting.aspx`, take a moment to change the DataList s `ID` property from `DataList1` to a more descriptive `ItemDataBoundFormattingExample`.</span></span> <span data-ttu-id="cb881-157">接下來，在瀏覽器中查看 DataList。</span><span class="sxs-lookup"><span data-stu-id="cb881-157">Next, view the DataList in a browser.</span></span> <span data-ttu-id="cb881-158">如 [圖 1] 所示，每個產品的唯一格式差異在於背景色彩會替代。</span><span class="sxs-lookup"><span data-stu-id="cb881-158">As Figure 1 shows, the only formatting difference between each product is that the background color alternates.</span></span>

<span data-ttu-id="cb881-159">[![在 DataList 控制項中列出產品](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image2.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="cb881-159">[![The Products are Listed in the DataList Control](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image2.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image1.png)</span></span>

<span data-ttu-id="cb881-160">**圖 1**：產品會列在 DataList 控制項中（[按一下以查看完整大小的影像](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image3.png)）</span><span class="sxs-lookup"><span data-stu-id="cb881-160">**Figure 1**: The Products are Listed in the DataList Control ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image3.png))</span></span>

<span data-ttu-id="cb881-161">在本教學課程中，讓我們格式化 DataList，使價格小於 $20.00 的任何產品都以黃色反白顯示其名稱和單價。</span><span class="sxs-lookup"><span data-stu-id="cb881-161">For this tutorial, let s format the DataList such that any products with a price less than $20.00 will have both its name and unit price highlighted yellow.</span></span>

## <a name="step-2-programmatically-determining-the-value-of-the-data-in-the-itemdatabound-event-handler"></a><span data-ttu-id="cb881-162">步驟2：以程式設計方式判斷 ItemDataBound 事件處理常式中的資料值</span><span class="sxs-lookup"><span data-stu-id="cb881-162">Step 2: Programmatically Determining the Value of the Data in the ItemDataBound Event Handler</span></span>

<span data-ttu-id="cb881-163">因為只有價格低於 $20.00 的產品會套用自訂格式，所以我們必須能夠判斷每個產品的價格。</span><span class="sxs-lookup"><span data-stu-id="cb881-163">Since only those products with a price under $20.00 will have the custom formatting applied, we must be able to determine each product s price.</span></span> <span data-ttu-id="cb881-164">將資料系結至 DataList 時，DataList 會列舉其資料來源中的記錄，而針對每一筆記錄，會建立一個 `DataListItem` 實例，將資料來源記錄系結至 `DataListItem`。</span><span class="sxs-lookup"><span data-stu-id="cb881-164">When binding data to a DataList, the DataList enumerates the records in its data source and, for each record, creates a `DataListItem` instance, binding the data source record to the `DataListItem`.</span></span> <span data-ttu-id="cb881-165">將特定記錄的資料系結至目前的 `DataListItem` 物件之後，會引發 DataList s `ItemDataBound` 事件。</span><span class="sxs-lookup"><span data-stu-id="cb881-165">After the particular record s data has been bound to the current `DataListItem` object, the DataList s `ItemDataBound` event is fired.</span></span> <span data-ttu-id="cb881-166">我們可以為這個事件建立事件處理常式，以檢查目前 `DataListItem` 的資料值，並根據這些值，進行任何必要的格式變更。</span><span class="sxs-lookup"><span data-stu-id="cb881-166">We can create an event handler for this event to inspect the data values for the current `DataListItem` and, based upon those values, make any formatting changes necessary.</span></span>

<span data-ttu-id="cb881-167">建立 DataList 的 `ItemDataBound` 事件，並新增下列程式碼：</span><span class="sxs-lookup"><span data-stu-id="cb881-167">Create an `ItemDataBound` event for the DataList and add the following code:</span></span>

[!code-vb[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample1.vb)]

<span data-ttu-id="cb881-168">雖然 DataList s `ItemDataBound` 事件處理常式背後的概念和語義與 GridView 的 `RowDataBound` 事件處理常式所使用的不同，在*自訂的格式設定根據資料*教學課程中，語法稍有不同。</span><span class="sxs-lookup"><span data-stu-id="cb881-168">While the concept and semantics behind the DataList s `ItemDataBound` event handler are the same as those used by the GridView s `RowDataBound` event handler in the *Custom Formatting Based Upon Data* tutorial, the syntax differs slightly.</span></span> <span data-ttu-id="cb881-169">當 `ItemDataBound` 事件引發時，只系結至資料的 `DataListItem` 會透過 `e.Item` （而不是 `e.Row`，如同 GridView 的 `RowDataBound` 事件處理常式）傳遞至對應的事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="cb881-169">When the `ItemDataBound` event fires, the `DataListItem` just bound to data is passed into corresponding event handler via `e.Item` (instead of `e.Row`, as with the GridView s `RowDataBound` event handler).</span></span> <span data-ttu-id="cb881-170">DataList s `ItemDataBound` 事件處理常式會針對加入 DataList 中的*每個*資料列而引發，包括標題列、頁尾資料列和分隔資料列。</span><span class="sxs-lookup"><span data-stu-id="cb881-170">The DataList s `ItemDataBound` event handler fires for *each* row added to the DataList, including header rows, footer rows, and separator rows.</span></span> <span data-ttu-id="cb881-171">不過，產品資訊只會系結至資料列。</span><span class="sxs-lookup"><span data-stu-id="cb881-171">However, the product information is only bound to the data rows.</span></span> <span data-ttu-id="cb881-172">因此，當您使用 `ItemDataBound` 事件來檢查系結至 DataList 的資料時，我們必須先確定我們已重複處理資料項目目。</span><span class="sxs-lookup"><span data-stu-id="cb881-172">Therefore, when using the `ItemDataBound` event to inspect the data bound to the DataList, we need to first ensure that we re working with a data item.</span></span> <span data-ttu-id="cb881-173">這可以藉由檢查 `DataListItem` s [`ItemType` 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.itemtype.aspx)來完成，它可以有[下列八個值](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listitemtype.aspx)的其中一個：</span><span class="sxs-lookup"><span data-stu-id="cb881-173">This can be accomplished by checking the `DataListItem` s [`ItemType` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.itemtype.aspx), which can have one of [the following eight values](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listitemtype.aspx):</span></span>

- `AlternatingItem`
- `EditItem`
- `Footer`
- `Header`
- `Item`
- `Pager`
- `SelectedItem`
- `Separator`

<span data-ttu-id="cb881-174">`Item` 和 `AlternatingItem``DataListItem` 都構成 DataList 的資料項目。</span><span class="sxs-lookup"><span data-stu-id="cb881-174">Both `Item` and `AlternatingItem``DataListItem` s makeup the DataList s data items.</span></span> <span data-ttu-id="cb881-175">假設我們重新使用 `Item` 或 `AlternatingItem`，我們會存取系結至目前 `DataListItem`的實際 `ProductsRow` 實例。</span><span class="sxs-lookup"><span data-stu-id="cb881-175">Assuming we re working with an `Item` or `AlternatingItem`, we access the actual `ProductsRow` instance that was bound to the current `DataListItem`.</span></span> <span data-ttu-id="cb881-176">`DataListItem` s [`DataItem` 屬性](https://msdn.microsoft.com/system.web.ui.webcontrols.datalistitem.dataitem.aspx)包含 `DataRowView` 物件的參考，其 `Row` 屬性會提供實際 `ProductsRow` 物件的參考。</span><span class="sxs-lookup"><span data-stu-id="cb881-176">The `DataListItem` s [`DataItem` property](https://msdn.microsoft.com/system.web.ui.webcontrols.datalistitem.dataitem.aspx) contains a reference to the `DataRowView` object, whose `Row` property provides a reference to the actual `ProductsRow` object.</span></span>

<span data-ttu-id="cb881-177">接下來，我們會檢查 `ProductsRow` 實例的 `UnitPrice` 屬性。</span><span class="sxs-lookup"><span data-stu-id="cb881-177">Next, we check the `ProductsRow` instance s `UnitPrice` property.</span></span> <span data-ttu-id="cb881-178">因為 Products 資料表的 `UnitPrice` 欄位允許 `NULL` 值，所以在嘗試存取 `UnitPrice` 屬性之前，應該先使用 `IsUnitPriceNull()` 方法檢查是否有 `NULL` 值。</span><span class="sxs-lookup"><span data-stu-id="cb881-178">Since the Products table s `UnitPrice` field allows `NULL` values, before attempting to access the `UnitPrice` property we should first check to see if it has a `NULL` value using the `IsUnitPriceNull()` method.</span></span> <span data-ttu-id="cb881-179">如果未 `NULL``UnitPrice` 值，我們會接著檢查其是否小於 $20.00。</span><span class="sxs-lookup"><span data-stu-id="cb881-179">If the `UnitPrice` value is not `NULL`, we then check to see if it s less than $20.00.</span></span> <span data-ttu-id="cb881-180">如果確實低於 $20.00，則需要套用自訂格式。</span><span class="sxs-lookup"><span data-stu-id="cb881-180">If it is indeed under $20.00, we then need to apply the custom formatting.</span></span>

## <a name="step-3-highlighting-the-product-s-name-and-price"></a><span data-ttu-id="cb881-181">步驟3：反白顯示產品的名稱和價格</span><span class="sxs-lookup"><span data-stu-id="cb881-181">Step 3: Highlighting the Product s Name and Price</span></span>

<span data-ttu-id="cb881-182">一旦我們知道產品的價格小於 $20.00，剩下的就是反白顯示其名稱和價格。</span><span class="sxs-lookup"><span data-stu-id="cb881-182">Once we know that a product s price is less than $20.00, all that remains is to highlight its name and price.</span></span> <span data-ttu-id="cb881-183">若要完成這項工作，我們必須先以程式設計方式參考 `ItemTemplate` 中顯示產品名稱和價格的標籤控制項。</span><span class="sxs-lookup"><span data-stu-id="cb881-183">To accomplish this, we must first programmatically reference the Label controls in the `ItemTemplate` that display the product s name and price.</span></span> <span data-ttu-id="cb881-184">接下來，我們必須讓它們顯示黃色的背景。</span><span class="sxs-lookup"><span data-stu-id="cb881-184">Next, we need to have them display a yellow background.</span></span> <span data-ttu-id="cb881-185">您可以直接修改標籤 `BackColor` 屬性（`LabelID.BackColor = Color.Yellow`）來套用此格式資訊;不過，在理想的情況下，所有顯示相關的事物都應該透過級聯樣式表單來表示。</span><span class="sxs-lookup"><span data-stu-id="cb881-185">This formatting information can be applied by directly modifying the Labels `BackColor` properties (`LabelID.BackColor = Color.Yellow`); ideally, though, all display-related matters should be expressed through cascading stylesheets.</span></span> <span data-ttu-id="cb881-186">事實上，我們已經有一個樣式表單，提供在 `Styles.css` - `AffordablePriceEmphasis`中所定義的格式，這是在*根據資料的自訂格式*教學課程中建立和討論的。</span><span class="sxs-lookup"><span data-stu-id="cb881-186">In fact, we already have a stylesheet that provides the desired formatting defined in `Styles.css` - `AffordablePriceEmphasis`, which was created and discussed in the *Custom Formatting Based Upon Data* tutorial.</span></span>

<span data-ttu-id="cb881-187">若要套用格式，只需將兩個標籤 Web 控制項 `CssClass` 屬性設定為 `AffordablePriceEmphasis`，如下列程式碼所示：</span><span class="sxs-lookup"><span data-stu-id="cb881-187">To apply the formatting, simply set the two Label Web controls `CssClass` properties to `AffordablePriceEmphasis`, as shown in the following code:</span></span>

[!code-vb[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample2.vb)]

<span data-ttu-id="cb881-188">當 `ItemDataBound` 事件處理常式完成時，請在瀏覽器中重新流覽 `Formatting.aspx` 頁面。</span><span class="sxs-lookup"><span data-stu-id="cb881-188">With the `ItemDataBound` event handler completed, revisit the `Formatting.aspx` page in a browser.</span></span> <span data-ttu-id="cb881-189">如 [圖 2] 所示，價格低於 $20.00 的產品會反白顯示其名稱和價格。</span><span class="sxs-lookup"><span data-stu-id="cb881-189">As Figure 2 illustrates, those products with a price under $20.00 have both their name and price highlighted.</span></span>

<span data-ttu-id="cb881-190">[![小於 $20.00 的產品會反白顯示](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image5.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="cb881-190">[![Those Products Less than $20.00 are Highlighted](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image5.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image4.png)</span></span>

<span data-ttu-id="cb881-191">**圖 2**：小於 $20.00 的產品會反白顯示（[按一下以觀看完整大小的影像](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image6.png)）</span><span class="sxs-lookup"><span data-stu-id="cb881-191">**Figure 2**: Those Products Less than $20.00 are Highlighted ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image6.png))</span></span>

> [!NOTE]
> <span data-ttu-id="cb881-192">由於 DataList 會轉譯為 HTML `<table>`，因此其 `DataListItem` 實例具有樣式相關的屬性，可設定為將特定樣式套用至整個專案。</span><span class="sxs-lookup"><span data-stu-id="cb881-192">Since the DataList is rendered as an HTML `<table>`, its `DataListItem` instances have style-related properties that can be set to apply a specific style to the entire item.</span></span> <span data-ttu-id="cb881-193">例如，如果我們想要在價格小於 $20.00 時將*整個*專案反白顯示，我們可以取代參考標籤的程式碼，並使用下列程式程式碼來設定其 `CssClass` 屬性： `e.Item.CssClass = "AffordablePriceEmphasis"` （請參閱 [圖 3]）。</span><span class="sxs-lookup"><span data-stu-id="cb881-193">For example, if we wanted to highlight the *entire* item yellow when its price was less than $20.00, we could have replaced the code that referenced the Labels and set their `CssClass` properties with the following line of code: `e.Item.CssClass = "AffordablePriceEmphasis"` (see Figure 3).</span></span>

<span data-ttu-id="cb881-194">而組成中繼器控制項的 `RepeaterItem` 則不會提供這類的樣式層級屬性。</span><span class="sxs-lookup"><span data-stu-id="cb881-194">The `RepeaterItem` s that make up the Repeater control, however, don t offer such style-level properties.</span></span> <span data-ttu-id="cb881-195">因此，將自訂格式套用至中繼器時，需要將樣式屬性應用到 Repeater 範本內的 Web 控制項，就像我們在 [圖 2] 中所做的一樣。</span><span class="sxs-lookup"><span data-stu-id="cb881-195">Therefore, applying custom formatting to the Repeater requires the application of style properties to the Web controls within the Repeater s templates, just like we did in Figure 2.</span></span>

<span data-ttu-id="cb881-196">[![$20.00 下的產品會反白顯示整個產品專案](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image8.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="cb881-196">[![The Entire Product Item is Highlighted for Products Under $20.00](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image8.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image7.png)</span></span>

<span data-ttu-id="cb881-197">**圖 3**：針對 $20.00 底下的產品，將整個產品專案反白顯示（[按一下以觀看完整大小的影像](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image9.png)）</span><span class="sxs-lookup"><span data-stu-id="cb881-197">**Figure 3**: The Entire Product Item is Highlighted for Products Under $20.00 ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image9.png))</span></span>

## <a name="using-formatting-functions-from-within-the-template"></a><span data-ttu-id="cb881-198">從範本內使用格式化函數</span><span class="sxs-lookup"><span data-stu-id="cb881-198">Using Formatting Functions from Within the Template</span></span>

<span data-ttu-id="cb881-199">在 [在*Gridview 控制項中使用 TemplateFields* ] 教學課程中，我們已瞭解如何使用 gridview TemplateField 內的格式函數，根據系結至 GridView 的資料列來套用自訂格式。</span><span class="sxs-lookup"><span data-stu-id="cb881-199">In the *Using TemplateFields in the GridView Control* tutorial we saw how to use a formatting function within a GridView TemplateField to apply custom formatting based upon the data bound to the GridView s rows.</span></span> <span data-ttu-id="cb881-200">格式化函式是一種方法，可以從範本叫用，並傳回要在其位置發出的 HTML。</span><span class="sxs-lookup"><span data-stu-id="cb881-200">A formatting function is a method that can be invoked from a template and returns the HTML to be emitted in its place.</span></span> <span data-ttu-id="cb881-201">格式化函式可以位於 ASP.NET 網頁的程式碼後置類別中，也可以集中到 `App_Code` 資料夾或個別類別庫專案中的類別檔案。</span><span class="sxs-lookup"><span data-stu-id="cb881-201">Formatting functions can reside in the ASP.NET page s code-behind class or can be centralized into class files in the `App_Code` folder or in a separate Class Library project.</span></span> <span data-ttu-id="cb881-202">如果您計畫在多個 ASP.NET 網頁或其他 ASP.NET web 應用程式中使用相同的格式函式，則將格式函式從 ASP.NET 網頁的程式碼後置類別移出是理想的選擇。</span><span class="sxs-lookup"><span data-stu-id="cb881-202">Moving the formatting function out of the ASP.NET page s code-behind class is ideal if you plan on using the same formatting function in multiple ASP.NET pages or in other ASP.NET web applications.</span></span>

<span data-ttu-id="cb881-203">若要示範格式化函式，請讓產品資訊包含產品 s 名稱旁邊的 [已停用] 文字（如果已停止）。</span><span class="sxs-lookup"><span data-stu-id="cb881-203">To demonstrate formatting functions, let s have the product information include the text [DISCONTINUED] next to the product s name if it s discontinued.</span></span> <span data-ttu-id="cb881-204">此外，如果小於 $20.00，讓的價格反白顯示為黃色（如同我們在 `ItemDataBound` 事件處理常式範例中所做的）;如果價格是 $20.00 或更高，讓不會顯示實際價格，而是改為使用價格報價的文字。</span><span class="sxs-lookup"><span data-stu-id="cb881-204">Also, let s have the price highlighted yellow if it s less than $20.00 (as we did in the `ItemDataBound` event handler example); if the price is $20.00 or higher, let s not display the actual price, but instead the text, Please call for a price quote.</span></span> <span data-ttu-id="cb881-205">[圖 4] 顯示已套用這些格式規則之產品清單的螢幕擷取畫面。</span><span class="sxs-lookup"><span data-stu-id="cb881-205">Figure 4 shows a screen shot of the products listing with these formatting rules applied.</span></span>

<span data-ttu-id="cb881-206">[![昂貴的產品，價格會以文字取代，請撥打價格報價](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image11.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="cb881-206">[![For Expensive Products, the Price is Replaced with the Text, Please call for a price quote](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image11.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image10.png)</span></span>

<span data-ttu-id="cb881-207">**圖 4**：對於昂貴的產品，價格會以文字取代，請撥打價格報價（[按一下以查看完整大小的影像](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image12.png)）</span><span class="sxs-lookup"><span data-stu-id="cb881-207">**Figure 4**: For Expensive Products, the Price is Replaced with the Text, Please call for a price quote ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image12.png))</span></span>

## <a name="step-1-create-the-formatting-functions"></a><span data-ttu-id="cb881-208">步驟1：建立格式函數</span><span class="sxs-lookup"><span data-stu-id="cb881-208">Step 1: Create the Formatting Functions</span></span>

<span data-ttu-id="cb881-209">在此範例中，我們需要兩個格式化函式，其中一個會顯示產品名稱，連同文字 [已停止]，如有需要，另一個則顯示反白顯示的價格（如果小於 $20.00）或文字，請在其他情況下呼叫價格報價。</span><span class="sxs-lookup"><span data-stu-id="cb881-209">For this example we need two formatting functions, one that displays the product name along with the text [DISCONTINUED], if needed, and another that displays either a highlighted price if it s less than $20.00, or the text, Please call for a price quote otherwise.</span></span> <span data-ttu-id="cb881-210">讓我們在 ASP.NET 網頁的程式碼後置類別中建立這些函式，並將它們命名為 `DisplayProductNameAndDiscontinuedStatus` 和 `DisplayPrice`。</span><span class="sxs-lookup"><span data-stu-id="cb881-210">Let s create these functions in the ASP.NET page s code-behind class and name them `DisplayProductNameAndDiscontinuedStatus` and `DisplayPrice`.</span></span> <span data-ttu-id="cb881-211">這兩種方法都必須傳回 HTML 以轉譯為字串，而且兩者都必須標示 `Protected` （或 `Public`），才能從 ASP.NET 網頁的宣告式語法部分中叫用。</span><span class="sxs-lookup"><span data-stu-id="cb881-211">Both methods need to return the HTML to render as a string and both need to be marked `Protected` (or `Public`) in order to be invoked from the ASP.NET page s declarative syntax portion.</span></span> <span data-ttu-id="cb881-212">這兩種方法的程式碼如下所示：</span><span class="sxs-lookup"><span data-stu-id="cb881-212">The code for these two methods follows:</span></span>

[!code-vb[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample3.vb)]

<span data-ttu-id="cb881-213">請注意，`DisplayProductNameAndDiscontinuedStatus` 方法會接受 `productName` 的值，並將資料欄位 `discontinued` 為純量值，而 `DisplayPrice` 方法會接受 `ProductsRow` 實例（而不是 `unitPrice` 純量值）。</span><span class="sxs-lookup"><span data-stu-id="cb881-213">Note that the `DisplayProductNameAndDiscontinuedStatus` method accepts the values of the `productName` and `discontinued` data fields as scalar values, whereas the `DisplayPrice` method accepts a `ProductsRow` instance (rather than a `unitPrice` scalar value).</span></span> <span data-ttu-id="cb881-214">這兩種方法都可行;不過，如果格式化函式使用的純量值可以包含資料庫 `NULL` 值（例如 `UnitPrice`; `ProductName` 或 `Discontinued` 不允許 `NULL` 值），則必須特別小心處理這些純量輸入。</span><span class="sxs-lookup"><span data-stu-id="cb881-214">Either approach will work; however, if the formatting function is working with scalar values that can contain database `NULL` values (such as `UnitPrice`; neither `ProductName` nor `Discontinued` allow `NULL` values), special care must be taken in handling these scalar inputs.</span></span>

<span data-ttu-id="cb881-215">特別的是，輸入參數的類型必須是 `Object`，因為傳入的值可能是 `DBNull` 實例，而不是預期的資料類型。</span><span class="sxs-lookup"><span data-stu-id="cb881-215">In particular, the input parameter must be of type `Object` since the incoming value might be a `DBNull` instance instead of the expected data type.</span></span> <span data-ttu-id="cb881-216">此外，必須進行檢查，以判斷傳入值是否為資料庫 `NULL` 值。</span><span class="sxs-lookup"><span data-stu-id="cb881-216">Additionally, a check must be made to determine whether or not the incoming value is a database `NULL` value.</span></span> <span data-ttu-id="cb881-217">也就是說，如果我們想要 `DisplayPrice` 方法接受純量值的價格，我們必須使用下列程式碼：</span><span class="sxs-lookup"><span data-stu-id="cb881-217">That is, if we wanted the `DisplayPrice` method to accept the price as a scalar value, we d have to use the following code:</span></span>

[!code-vb[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample4.vb)]

<span data-ttu-id="cb881-218">請注意，`unitPrice` 輸入參數的類型是 `Object`，而且已修改條件陳述式，以確定 `unitPrice` 是否 `DBNull`。</span><span class="sxs-lookup"><span data-stu-id="cb881-218">Note that the `unitPrice` input parameter is of type `Object` and that the conditional statement has been modified to ascertain if `unitPrice` is `DBNull` or not.</span></span> <span data-ttu-id="cb881-219">此外，由於 `unitPrice` 輸入參數是以 `Object`的形式傳入，因此必須轉換成十進位值。</span><span class="sxs-lookup"><span data-stu-id="cb881-219">Furthermore, since the `unitPrice` input parameter is passed in as an `Object`, it must be cast to a decimal value.</span></span>

## <a name="step-2-calling-the-formatting-function-from-the-datalist-s-itemtemplate"></a><span data-ttu-id="cb881-220">步驟2：從 DataList s ItemTemplate 呼叫格式化函數</span><span class="sxs-lookup"><span data-stu-id="cb881-220">Step 2: Calling the Formatting Function from the DataList s ItemTemplate</span></span>

<span data-ttu-id="cb881-221">將格式化函式新增至 ASP.NET 網頁的程式碼後置類別後，剩下的工作就是從 DataList s `ItemTemplate`叫用這些格式函數。</span><span class="sxs-lookup"><span data-stu-id="cb881-221">With the formatting functions added to our ASP.NET page s code-behind class, all that remains is to invoke these formatting functions from the DataList s `ItemTemplate`.</span></span> <span data-ttu-id="cb881-222">若要從範本呼叫格式化函式，請將函式呼叫放在資料系結語法中：</span><span class="sxs-lookup"><span data-stu-id="cb881-222">To call a formatting function from a template, place the function call within the databinding syntax:</span></span>

[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample5.aspx)]

<span data-ttu-id="cb881-223">在 DataList s 中 `ItemTemplate` `ProductNameLabel` Label Web 控制項目前會藉由將 `<%# Eval("ProductName") %>`的結果指派給其 `Text` 屬性，來顯示產品的名稱。</span><span class="sxs-lookup"><span data-stu-id="cb881-223">In the DataList s `ItemTemplate` the `ProductNameLabel` Label Web control currently displays the product s name by assigning its `Text` property the result of `<%# Eval("ProductName") %>`.</span></span> <span data-ttu-id="cb881-224">若要讓它顯示名稱加上 [已停止] 文字，請視需要更新宣告式語法，使其改為指派 `Text` 屬性 `DisplayProductNameAndDiscontinuedStatus` 方法的值。</span><span class="sxs-lookup"><span data-stu-id="cb881-224">In order to have it display the name plus the text [DISCONTINUED], if needed, update the declarative syntax so that it instead assigns the `Text` property the value of the `DisplayProductNameAndDiscontinuedStatus` method.</span></span> <span data-ttu-id="cb881-225">當您這麼做時，必須使用 `Eval("columnName")` 語法來傳入產品的名稱和已停止的值。</span><span class="sxs-lookup"><span data-stu-id="cb881-225">When doing so, we must pass in the product s name and discontinued values using the `Eval("columnName")` syntax.</span></span> <span data-ttu-id="cb881-226">`Eval` 會傳回 `Object`類型的值，但 `DisplayProductNameAndDiscontinuedStatus` 方法需要 `String` 和 `Boolean`類型的輸入參數。因此，我們必須將 `Eval` 方法所傳回的值，轉換為預期的輸入參數類型，如下所示：</span><span class="sxs-lookup"><span data-stu-id="cb881-226">`Eval` returns a value of type `Object`, but the `DisplayProductNameAndDiscontinuedStatus` method expects input parameters of type `String` and `Boolean`; therefore, we must cast the values returned by the `Eval` method to the expected input parameter types, like so:</span></span>

[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample6.aspx)]

<span data-ttu-id="cb881-227">若要顯示價格，我們可以直接將 `UnitPriceLabel` 標籤 `Text` 屬性設定為 `DisplayPrice` 方法所傳回的值，就像我們用來顯示產品名稱和 [已停用] 的文字一樣。</span><span class="sxs-lookup"><span data-stu-id="cb881-227">To display the price, we can simply set the `UnitPriceLabel` Label s `Text` property to the value returned by the `DisplayPrice` method, just like we did for displaying the product s name and [DISCONTINUED] text.</span></span> <span data-ttu-id="cb881-228">不過，我們會改為傳入整個 `ProductsRow` 實例，而不是以純量輸入參數的形式傳入 `UnitPrice`：</span><span class="sxs-lookup"><span data-stu-id="cb881-228">However, instead of passing in the `UnitPrice` as a scalar input parameter, we instead pass in the entire `ProductsRow` instance:</span></span>

[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample7.aspx)]

<span data-ttu-id="cb881-229">在設定格式函式的呼叫之後，請花一點時間在瀏覽器中查看進度。</span><span class="sxs-lookup"><span data-stu-id="cb881-229">With the calls to the formatting functions in place, take a moment to view our progress in a browser.</span></span> <span data-ttu-id="cb881-230">您的畫面看起來應該像 [圖 5]，其中已淘汰的產品（包括 [已停止] 文字），而那些產品的價格超過 $20.00，而其價格已取代為「請撥打價格報價」的文字。</span><span class="sxs-lookup"><span data-stu-id="cb881-230">Your screen should look similar to Figure 5, with the discontinued products including the text [DISCONTINUED] and those products costing more than $20.00 having their price replaced with the text Please call for a price quote .</span></span>

<span data-ttu-id="cb881-231">[![昂貴的產品，價格會以文字取代，請撥打價格報價](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image14.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="cb881-231">[![For Expensive Products, the Price is Replaced with the Text, Please call for a price quote](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image14.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image13.png)</span></span>

<span data-ttu-id="cb881-232">**圖 5**：對於昂貴的產品，價格會以文字取代，請撥打價格報價（[按一下以查看完整大小的影像](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image15.png)）</span><span class="sxs-lookup"><span data-stu-id="cb881-232">**Figure 5**: For Expensive Products, the Price is Replaced with the Text, Please call for a price quote ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image15.png))</span></span>

## <a name="summary"></a><span data-ttu-id="cb881-233">總結</span><span class="sxs-lookup"><span data-stu-id="cb881-233">Summary</span></span>

<span data-ttu-id="cb881-234">根據資料來格式化 DataList 或重複項控制項的內容時，可以使用兩種方法來完成。</span><span class="sxs-lookup"><span data-stu-id="cb881-234">Formatting the contents of a DataList or Repeater control based upon the data can be accomplished using two techniques.</span></span> <span data-ttu-id="cb881-235">第一種方法是建立 `ItemDataBound` 事件的事件處理常式，當資料來源中的每筆記錄系結至新 `DataListItem` 或 `RepeaterItem`時，就會引發這個事件。</span><span class="sxs-lookup"><span data-stu-id="cb881-235">The first technique is to create an event handler for the `ItemDataBound` event, which fires as each record in the data source is bound to a new `DataListItem` or `RepeaterItem`.</span></span> <span data-ttu-id="cb881-236">在 `ItemDataBound` 事件處理常式中，可以檢查目前的專案資料，然後將格式設定套用至範本的內容，或在整個專案本身的 `DataListItem` s。</span><span class="sxs-lookup"><span data-stu-id="cb881-236">In the `ItemDataBound` event handler, the current item s data can be examined and then formatting can be applied to the contents of the template or, for `DataListItem` s, to the entire item itself.</span></span>

<span data-ttu-id="cb881-237">或者，您也可以透過格式化功能來實現自訂格式。</span><span class="sxs-lookup"><span data-stu-id="cb881-237">Alternatively, custom formatting can be realized through formatting functions.</span></span> <span data-ttu-id="cb881-238">格式化函式是一種方法，可以從 DataList 或 Repeater 的範本叫用，以傳回要在其位置發出的 HTML。</span><span class="sxs-lookup"><span data-stu-id="cb881-238">A formatting function is a method that can be invoked from the DataList or Repeater s templates that returns the HTML to emit in its place.</span></span> <span data-ttu-id="cb881-239">通常，格式化函式所傳回的 HTML 會由系結至目前專案的值決定。</span><span class="sxs-lookup"><span data-stu-id="cb881-239">Often, the HTML returned by a formatting function is determined by the values being bound to the current item.</span></span> <span data-ttu-id="cb881-240">這些值可以傳遞至格式化函式，可能是純量值，或傳入整個物件系結至專案（例如 `ProductsRow` 實例）。</span><span class="sxs-lookup"><span data-stu-id="cb881-240">These values can be passed into the formatting function, either as scalar values or by passing in the entire object being bound to the item (such as the `ProductsRow` instance).</span></span>

<span data-ttu-id="cb881-241">快樂的程式設計！</span><span class="sxs-lookup"><span data-stu-id="cb881-241">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="cb881-242">關於作者</span><span class="sxs-lookup"><span data-stu-id="cb881-242">About the Author</span></span>

<span data-ttu-id="cb881-243">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，自1998起，有七個 ASP/ASP. NET 書籍和創辦人的[4GuysFromRolla.com](http://www.4guysfromrolla.com)。</span><span class="sxs-lookup"><span data-stu-id="cb881-243">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="cb881-244">Scott 以獨立的顧問、訓練員和作者的身分運作。</span><span class="sxs-lookup"><span data-stu-id="cb881-244">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="cb881-245">他的最新著作是[*在24小時內讓自己的 ASP.NET 2.0*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="cb881-245">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="cb881-246">他可以在mitchell@4GuysFromRolla.com觸達[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="cb881-246">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="cb881-247">或者透過他的 blog，可以在[http://ScottOnWriting.NET](http://ScottOnWriting.NET)找到。</span><span class="sxs-lookup"><span data-stu-id="cb881-247">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="cb881-248">特別感謝</span><span class="sxs-lookup"><span data-stu-id="cb881-248">Special Thanks To</span></span>

<span data-ttu-id="cb881-249">本教學課程系列已由許多有用的審核者所審查。</span><span class="sxs-lookup"><span data-stu-id="cb881-249">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="cb881-250">本教學課程的領導審查者為 Yaakov Ellis、Randy Schmidt 和 Liz Shulok。</span><span class="sxs-lookup"><span data-stu-id="cb881-250">Lead reviewers for this tutorial were Yaakov Ellis, Randy Schmidt, and Liz Shulok.</span></span> <span data-ttu-id="cb881-251">有興趣複習我即將發行的 MSDN 文章嗎？</span><span class="sxs-lookup"><span data-stu-id="cb881-251">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="cb881-252">若是如此，請在mitchell@4GuysFromRolla.com的那一行下拉式[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="cb881-252">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="cb881-253">[上一頁](displaying-data-with-the-datalist-and-repeater-controls-vb.md)
> [下一頁](showing-multiple-records-per-row-with-the-datalist-control-vb.md)</span><span class="sxs-lookup"><span data-stu-id="cb881-253">[Previous](displaying-data-with-the-datalist-and-repeater-controls-vb.md)
[Next](showing-multiple-records-per-row-with-the-datalist-control-vb.md)</span></span>
