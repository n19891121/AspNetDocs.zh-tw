---
uid: web-forms/overview/data-access/introduction/master-pages-and-site-navigation-vb
title: 主版頁面和網站導覽（VB） |Microsoft Docs
author: rick-anderson
description: 方便使用的網站有一項常見的特性，就是他們擁有一致、全網站的頁面配置和流覽配置。 本教學課程探討 y 。
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 022801d8-a327-4d0c-8780-6094c9cee00d
msc.legacyurl: /web-forms/overview/data-access/introduction/master-pages-and-site-navigation-vb
msc.type: authoredcontent
ms.openlocfilehash: 4a2b5ba8c1781f1194f951a44661a8f7dd095f41
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/28/2019
ms.locfileid: "74578651"
---
# <a name="master-pages-and-site-navigation-vb"></a><span data-ttu-id="80705-104">主版頁面與網站導覽 (VB)</span><span class="sxs-lookup"><span data-stu-id="80705-104">Master Pages and Site Navigation (VB)</span></span>

<span data-ttu-id="80705-105">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="80705-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="80705-106">[下載範例應用程式](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_3_VB.exe)或[下載 PDF](master-pages-and-site-navigation-vb/_static/datatutorial03vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="80705-106">[Download Sample App](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_3_VB.exe) or [Download PDF](master-pages-and-site-navigation-vb/_static/datatutorial03vb1.pdf)</span></span>

> <span data-ttu-id="80705-107">方便使用的網站有一項常見的特性，就是他們擁有一致、全網站的頁面配置和流覽配置。</span><span class="sxs-lookup"><span data-stu-id="80705-107">One common characteristic of user-friendly websites is that they have a consistent, site-wide page layout and navigation scheme.</span></span> <span data-ttu-id="80705-108">本教學課程探討如何在可輕鬆更新的所有頁面上建立一致的外觀與風格。</span><span class="sxs-lookup"><span data-stu-id="80705-108">This tutorial looks at how you can create a consistent look and feel across all pages that can easily be updated.</span></span>

## <a name="introduction"></a><span data-ttu-id="80705-109">簡介</span><span class="sxs-lookup"><span data-stu-id="80705-109">Introduction</span></span>

<span data-ttu-id="80705-110">方便使用的網站有一項常見的特性，就是他們擁有一致、全網站的頁面配置和流覽配置。</span><span class="sxs-lookup"><span data-stu-id="80705-110">One common characteristic of user-friendly websites is that they have a consistent, site-wide page layout and navigation scheme.</span></span> <span data-ttu-id="80705-111">ASP.NET 2.0 引進兩項新功能，可大幅簡化整個網站的頁面配置和流覽配置：主版頁面和網站流覽。</span><span class="sxs-lookup"><span data-stu-id="80705-111">ASP.NET 2.0 introduces two new features that greatly simplify implementing both a site-wide page layout and navigation scheme: master pages and site navigation.</span></span> <span data-ttu-id="80705-112">主版頁面可讓開發人員使用指定的可編輯區域來建立全網站範本。</span><span class="sxs-lookup"><span data-stu-id="80705-112">Master pages allow for developers to create a site-wide template with designated editable regions.</span></span> <span data-ttu-id="80705-113">此範本可以套用至網站中的 ASP.NET 網頁。</span><span class="sxs-lookup"><span data-stu-id="80705-113">This template can then be applied to ASP.NET pages in the site.</span></span> <span data-ttu-id="80705-114">這類 ASP.NET 網頁只需要提供主版頁面指定之可編輯區域的內容，主版頁面中的所有其他標記在所有使用主版頁面的 ASP.NET 網頁上都相同。</span><span class="sxs-lookup"><span data-stu-id="80705-114">Such ASP.NET pages need only provide content for the master page's specified editable regions all other markup in the master page is identical across all ASP.NET pages that use the master page.</span></span> <span data-ttu-id="80705-115">此模型可讓開發人員定義和集中化全網站頁面配置，讓您更輕鬆地在可輕鬆更新的所有頁面上建立一致的外觀與風格。</span><span class="sxs-lookup"><span data-stu-id="80705-115">This model allows developers to define and centralize a site-wide page layout, thereby making it easier to create a consistent look and feel across all pages that can easily be updated.</span></span>

<span data-ttu-id="80705-116">[網站導覽系統](http://aspnet.4guysfromrolla.com/articles/111605-1.aspx)提供一種機制，可讓網頁開發人員定義網站地圖，並為該網站地圖建立 API 以程式設計方式查詢。</span><span class="sxs-lookup"><span data-stu-id="80705-116">The [site navigation system](http://aspnet.4guysfromrolla.com/articles/111605-1.aspx) provides both a mechanism for page developers to define a site map and an API for that site map to be programmatically queried.</span></span> <span data-ttu-id="80705-117">新的流覽 Web 控制項功能表、TreeView 和 SiteMapPath 可讓您輕鬆地在一般導覽使用者介面專案中呈現網站地圖的全部或部分。</span><span class="sxs-lookup"><span data-stu-id="80705-117">The new navigation Web controls the Menu, TreeView, and SiteMapPath make it easy to render all or part of the site map in a common navigation user interface element.</span></span> <span data-ttu-id="80705-118">我們將使用預設的網站流覽提供者，這表示我們的網站地圖將會定義在 XML 格式的檔案中。</span><span class="sxs-lookup"><span data-stu-id="80705-118">We'll be using the default site navigation provider, meaning that our site map will be defined in an XML-formatted file.</span></span>

<span data-ttu-id="80705-119">為了說明這些概念，並讓我們的教學課程網站更容易使用，讓我們花這堂課來定義全網站的頁面配置、執行網站地圖，以及新增導覽 UI。</span><span class="sxs-lookup"><span data-stu-id="80705-119">To illustrate these concepts and make our tutorials website more usable, let's spend this lesson defining a site-wide page layout, implementing a site map, and adding the navigation UI.</span></span> <span data-ttu-id="80705-120">在本教學課程結束時，我們將會有一份精美的網站設計，可供您建立教學課程網頁。</span><span class="sxs-lookup"><span data-stu-id="80705-120">By the end of this tutorial we'll have a polished website design for building our tutorial web pages.</span></span>

<span data-ttu-id="80705-121">[![本教學課程的最終結果](master-pages-and-site-navigation-vb/_static/image2.png)](master-pages-and-site-navigation-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="80705-121">[![The End Result of This Tutorial](master-pages-and-site-navigation-vb/_static/image2.png)](master-pages-and-site-navigation-vb/_static/image1.png)</span></span>

<span data-ttu-id="80705-122">**圖 1**：本教學課程的最終結果（[按一下以觀看完整大小的影像](master-pages-and-site-navigation-vb/_static/image3.png)）</span><span class="sxs-lookup"><span data-stu-id="80705-122">**Figure 1**: The End Result of This Tutorial ([Click to view full-size image](master-pages-and-site-navigation-vb/_static/image3.png))</span></span>

## <a name="step-1-creating-the-master-page"></a><span data-ttu-id="80705-123">步驟1：建立主版頁面</span><span class="sxs-lookup"><span data-stu-id="80705-123">Step 1: Creating the Master Page</span></span>

<span data-ttu-id="80705-124">第一個步驟是建立網站的主版頁面。</span><span class="sxs-lookup"><span data-stu-id="80705-124">The first step is to create the master page for the site.</span></span> <span data-ttu-id="80705-125">現在，我們的網站只包含具類型的資料集（`Northwind.xsd`、`App_Code` 資料夾中）、BLL 類別（`ProductsBLL.vb`、`CategoriesBLL.vb`等等、全部在 `App_Code` 資料夾中）、設定檔（`NORTHWND.MDF`），以及 CSS 樣式表單檔案（`App_Data`）。</span><span class="sxs-lookup"><span data-stu-id="80705-125">Right now our website consists of only the Typed DataSet (`Northwind.xsd`, in the `App_Code` folder), the BLL classes (`ProductsBLL.vb`, `CategoriesBLL.vb`, and so on, all in the `App_Code` folder), the database (`NORTHWND.MDF`, in the `App_Data` folder), the configuration file (`Web.config`), and a CSS stylesheet file (`Styles.css`).</span></span> <span data-ttu-id="80705-126">我從前兩個教學課程中，清除了使用 DAL 和 BLL 示範的頁面和檔案，因為我們將在未來的教學課程中更詳細地 reexamining 這些範例。</span><span class="sxs-lookup"><span data-stu-id="80705-126">I cleaned out those pages and files demonstrating using the DAL and BLL from the first two tutorials since we will be reexamining those examples in greater detail in future tutorials.</span></span>

![專案中的檔案](master-pages-and-site-navigation-vb/_static/image4.png)

<span data-ttu-id="80705-128">**圖 2**：專案中的檔案</span><span class="sxs-lookup"><span data-stu-id="80705-128">**Figure 2**: The Files in Our Project</span></span>

<span data-ttu-id="80705-129">若要建立主版頁面，請在 方案總管中的專案名稱上按一下滑鼠右鍵，然後選擇 加入新專案。</span><span class="sxs-lookup"><span data-stu-id="80705-129">To create a master page, right-click on the project name in the Solution Explorer and choose Add New Item.</span></span> <span data-ttu-id="80705-130">然後從範本清單中選取主版頁面類型，並將其命名為 `Site.master`。</span><span class="sxs-lookup"><span data-stu-id="80705-130">Then select the Master Page type from the list of templates and name it `Site.master`.</span></span>

<span data-ttu-id="80705-131">[![將新的主版頁面新增至網站](master-pages-and-site-navigation-vb/_static/image6.png)](master-pages-and-site-navigation-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="80705-131">[![Add a New Master Page to the Website](master-pages-and-site-navigation-vb/_static/image6.png)](master-pages-and-site-navigation-vb/_static/image5.png)</span></span>

<span data-ttu-id="80705-132">**圖 3**：將新的主版頁面新增至網站（[按一下以觀看完整大小的影像](master-pages-and-site-navigation-vb/_static/image7.png)）</span><span class="sxs-lookup"><span data-stu-id="80705-132">**Figure 3**: Add a New Master Page to the Website ([Click to view full-size image](master-pages-and-site-navigation-vb/_static/image7.png))</span></span>

<span data-ttu-id="80705-133">在主版頁面中定義整個網站的頁面配置。</span><span class="sxs-lookup"><span data-stu-id="80705-133">Define the site-wide page layout here in the master page.</span></span> <span data-ttu-id="80705-134">您可以使用設計檢視並新增您需要的任何版面配置或 Web 控制項，也可以手動在來源視圖中新增標記。</span><span class="sxs-lookup"><span data-stu-id="80705-134">You can use the Design view and add whatever Layout or Web controls you need, or you can manually add the markup by hand in the Source view.</span></span> <span data-ttu-id="80705-135">在我的主版頁面中，我使用[級聯樣式表](http://www.w3schools.com/css/default.asp)，搭配外部檔案 `Style.css`中定義的 CSS 設定來定位和樣式。</span><span class="sxs-lookup"><span data-stu-id="80705-135">In my master page I use [cascading style sheets](http://www.w3schools.com/css/default.asp) for positioning and styles with the CSS settings defined in the external file `Style.css`.</span></span> <span data-ttu-id="80705-136">雖然您無法從下面所示的標記中得知，但 CSS 規則的定義是讓導覽 `<div>`的內容絕對位置，使其顯示在左邊，且固定寬度為200圖元。</span><span class="sxs-lookup"><span data-stu-id="80705-136">While you cannot tell from the markup shown below, the CSS rules are defined such that the navigation `<div>`'s content is absolutely positioned so that it appears on the left and has a fixed width of 200 pixels.</span></span>

<span data-ttu-id="80705-137">網站. master</span><span class="sxs-lookup"><span data-stu-id="80705-137">Site.master</span></span>

[!code-aspx[Main](master-pages-and-site-navigation-vb/samples/sample1.aspx)]

<span data-ttu-id="80705-138">主版頁面會定義靜態頁面配置，以及可由使用主版頁面的 ASP.NET 網頁編輯的區域。</span><span class="sxs-lookup"><span data-stu-id="80705-138">A master page defines both the static page layout and the regions that can be edited by the ASP.NET pages that use the master page.</span></span> <span data-ttu-id="80705-139">這些可編輯的區域是由 ContentPlaceHolder 控制項所表示，您可以在內容 `<div>`中看到這些內容。</span><span class="sxs-lookup"><span data-stu-id="80705-139">These content editable regions are indicated by the ContentPlaceHolder control, which can be seen within the content `<div>`.</span></span> <span data-ttu-id="80705-140">我們的主版頁面具有單一 ContentPlaceHolder （`MainContent`），但主版頁面可能會有多個 ContentPlaceHolders。</span><span class="sxs-lookup"><span data-stu-id="80705-140">Our master page has a single ContentPlaceHolder (`MainContent`), but master page's may have multiple ContentPlaceHolders.</span></span>

<span data-ttu-id="80705-141">在上方輸入標記之後，切換到設計檢視會顯示主版頁面的版面配置。</span><span class="sxs-lookup"><span data-stu-id="80705-141">With the markup entered above, switching to the Design view shows the master page's layout.</span></span> <span data-ttu-id="80705-142">任何使用此主版頁面的 ASP.NET 網頁都將具有此統一版面配置，而且能夠指定 `MainContent` 區域的標記。</span><span class="sxs-lookup"><span data-stu-id="80705-142">Any ASP.NET pages that use this master page will have this uniform layout, with the ability to specify the markup for the `MainContent` region.</span></span>

<span data-ttu-id="80705-143">[![主版頁面（透過設計檢視查看時）](master-pages-and-site-navigation-vb/_static/image9.png)](master-pages-and-site-navigation-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="80705-143">[![The Master Page, When Viewed Through the Design View](master-pages-and-site-navigation-vb/_static/image9.png)](master-pages-and-site-navigation-vb/_static/image8.png)</span></span>

<span data-ttu-id="80705-144">**圖 4**：透過設計檢視查看主版頁面時（[按一下以觀看完整大小的影像](master-pages-and-site-navigation-vb/_static/image10.png)）</span><span class="sxs-lookup"><span data-stu-id="80705-144">**Figure 4**: The Master Page, When Viewed Through the Design View ([Click to view full-size image](master-pages-and-site-navigation-vb/_static/image10.png))</span></span>

## <a name="step-2-adding-a-homepage-to-the-website"></a><span data-ttu-id="80705-145">步驟2：將首頁新增至網站</span><span class="sxs-lookup"><span data-stu-id="80705-145">Step 2: Adding a Homepage to the Website</span></span>

<span data-ttu-id="80705-146">定義主版頁面之後，我們就可以開始新增網站的 ASP.NET 網頁。</span><span class="sxs-lookup"><span data-stu-id="80705-146">With the master page defined, we're ready to add the ASP.NET pages for the website.</span></span> <span data-ttu-id="80705-147">讓我們從新增 `Default.aspx`（我們的網站首頁）開始。</span><span class="sxs-lookup"><span data-stu-id="80705-147">Let's start by adding `Default.aspx`, our website's homepage.</span></span> <span data-ttu-id="80705-148">以滑鼠右鍵按一下 方案總管中的專案名稱，然後選擇 加入新專案。</span><span class="sxs-lookup"><span data-stu-id="80705-148">Right-click on the project name in the Solution Explorer and choose Add New Item.</span></span> <span data-ttu-id="80705-149">從 [範本] 清單中挑選 [Web 表單] 選項，並將檔案命名為 `Default.aspx`。</span><span class="sxs-lookup"><span data-stu-id="80705-149">Pick the Web Form option from the template list and name the file `Default.aspx`.</span></span> <span data-ttu-id="80705-150">此外，請核取 [選取主版頁面] 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="80705-150">Also, check the "Select master page" checkbox.</span></span>

<span data-ttu-id="80705-151">[![新增 Web 表單，請勾選 [選取主版頁面] 核取方塊](master-pages-and-site-navigation-vb/_static/image12.png)](master-pages-and-site-navigation-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="80705-151">[![Add a New Web Form, Checking the Select master page Checkbox](master-pages-and-site-navigation-vb/_static/image12.png)](master-pages-and-site-navigation-vb/_static/image11.png)</span></span>

<span data-ttu-id="80705-152">**圖 5**：加入新的 Web 表單，核取 [選取主版頁面] 核取方塊（[按一下以查看完整大小的影像](master-pages-and-site-navigation-vb/_static/image13.png)）</span><span class="sxs-lookup"><span data-stu-id="80705-152">**Figure 5**: Add a New Web Form, Checking the Select master page Checkbox ([Click to view full-size image](master-pages-and-site-navigation-vb/_static/image13.png))</span></span>

<span data-ttu-id="80705-153">按一下 [確定] 按鈕之後，我們會要求您選擇這個新的 ASP.NET 網頁應使用的主版頁面。</span><span class="sxs-lookup"><span data-stu-id="80705-153">After clicking the OK button, we're asked to choose what master page this new ASP.NET page should use.</span></span> <span data-ttu-id="80705-154">雖然您的專案中可以有多個主版頁面，但我們只有一個。</span><span class="sxs-lookup"><span data-stu-id="80705-154">While you can have multiple master pages in your project, we have only one.</span></span>

<span data-ttu-id="80705-155">[![選擇此 ASP.NET 網頁應使用的主版頁面](master-pages-and-site-navigation-vb/_static/image15.png)](master-pages-and-site-navigation-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="80705-155">[![Choose the Master Page this ASP.NET Page Should Use](master-pages-and-site-navigation-vb/_static/image15.png)](master-pages-and-site-navigation-vb/_static/image14.png)</span></span>

<span data-ttu-id="80705-156">**圖 6**：選擇此 ASP.NET 網頁應使用的主版頁面（[按一下以查看完整大小的影像](master-pages-and-site-navigation-vb/_static/image16.png)）</span><span class="sxs-lookup"><span data-stu-id="80705-156">**Figure 6**: Choose the Master Page this ASP.NET Page Should Use ([Click to view full-size image](master-pages-and-site-navigation-vb/_static/image16.png))</span></span>

<span data-ttu-id="80705-157">選取主版頁面之後，新的 ASP.NET 網頁會包含下列標記：</span><span class="sxs-lookup"><span data-stu-id="80705-157">After picking the master page, the new ASP.NET pages will contain the following markup:</span></span>

<span data-ttu-id="80705-158">Default.aspx</span><span class="sxs-lookup"><span data-stu-id="80705-158">Default.aspx</span></span>

[!code-aspx[Main](master-pages-and-site-navigation-vb/samples/sample2.aspx)]

<span data-ttu-id="80705-159">在 `@Page` 指示詞中，會參考使用的主版頁面檔案（`MasterPageFile="~/Site.master"`），而 ASP.NET 網頁的標記包含主版頁面中定義的每個 ContentPlaceHolder 控制項的內容控制項，而且控制項的 `ContentPlaceHolderID` 會將內容控制項對應至特定 ContentPlaceHolder。</span><span class="sxs-lookup"><span data-stu-id="80705-159">In the `@Page` directive there's a reference to the master page file used (`MasterPageFile="~/Site.master"`), and the ASP.NET page's markup contains a Content control for each of the ContentPlaceHolder controls defined in the master page, with the control's `ContentPlaceHolderID` mapping the Content control to a specific ContentPlaceHolder.</span></span> <span data-ttu-id="80705-160">內容控制項是您放置要在對應的 ContentPlaceHolder 中顯示之標記的位置。</span><span class="sxs-lookup"><span data-stu-id="80705-160">The Content control is where you place the markup you want to appear in the corresponding ContentPlaceHolder.</span></span> <span data-ttu-id="80705-161">將 [`@Page`] 指示詞的 [`Title`] 屬性設定為 [首頁]，並將一些歡迎內容新增至內容控制項：</span><span class="sxs-lookup"><span data-stu-id="80705-161">Set the `@Page` directive's `Title` attribute to Home and add some welcoming content to the Content control:</span></span>

<span data-ttu-id="80705-162">Default.aspx</span><span class="sxs-lookup"><span data-stu-id="80705-162">Default.aspx</span></span>

[!code-aspx[Main](master-pages-and-site-navigation-vb/samples/sample3.aspx)]

<span data-ttu-id="80705-163">`@Page` 指示詞中的 `Title` 屬性可讓我們從 ASP.NET 網頁設定頁面的標題，即使在主版頁面中定義了 `<title>` 元素也一樣。</span><span class="sxs-lookup"><span data-stu-id="80705-163">The `Title` attribute in the `@Page` directive allows us to set the page's title from the ASP.NET page, even though the `<title>` element is defined in the master page.</span></span> <span data-ttu-id="80705-164">我們也可以使用 `Page.Title`，以程式設計方式設定標題。</span><span class="sxs-lookup"><span data-stu-id="80705-164">We can also set the title programmatically, using `Page.Title`.</span></span> <span data-ttu-id="80705-165">另請注意，主版頁面的樣式表單參考（例如 `Style.css`）會自動更新，使其可在任何 ASP.NET 網頁中使用，不論 ASP.NET 網頁相對於主版頁面的目錄為何。</span><span class="sxs-lookup"><span data-stu-id="80705-165">Also note that the master page's references to stylesheets (such as `Style.css`) are automatically updated so that they work in any ASP.NET page, regardless of what directory the ASP.NET page is in relative to the master page.</span></span>

<span data-ttu-id="80705-166">切換到設計檢視我們可以看到頁面在瀏覽器中的外觀。</span><span class="sxs-lookup"><span data-stu-id="80705-166">Switching to the Design view we can see how our page will look in a browser.</span></span> <span data-ttu-id="80705-167">請注意，在 [ASP.NET] 頁面的設計檢視中，只有內容可編輯區域可供編輯，主版頁面中定義的非 ContentPlaceHolder 標記會變成灰色。</span><span class="sxs-lookup"><span data-stu-id="80705-167">Note that in the Design view for the ASP.NET page that only the content editable regions are editable the non-ContentPlaceHolder markup defined in the master page is grayed out.</span></span>

<span data-ttu-id="80705-168">[![[ASP.NET] 頁面的設計檢視會顯示可編輯和不可編輯的區域](master-pages-and-site-navigation-vb/_static/image18.png)](master-pages-and-site-navigation-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="80705-168">[![The Design View for the ASP.NET Page Shows Both the Editable and Non-Editable Regions](master-pages-and-site-navigation-vb/_static/image18.png)](master-pages-and-site-navigation-vb/_static/image17.png)</span></span>

<span data-ttu-id="80705-169">**圖 7**： [ASP.NET] 頁面的設計檢視會同時顯示可編輯和不可編輯的區域（[按一下以查看完整大小的影像](master-pages-and-site-navigation-vb/_static/image19.png)）</span><span class="sxs-lookup"><span data-stu-id="80705-169">**Figure 7**: The Design View for the ASP.NET Page Shows Both the Editable and Non-Editable Regions ([Click to view full-size image](master-pages-and-site-navigation-vb/_static/image19.png))</span></span>

<span data-ttu-id="80705-170">當瀏覽器造訪 [`Default.aspx`] 頁面時，ASP.NET 引擎會自動合併頁面的主版頁面內容和 ASP。NET 的內容，並將合併的內容轉譯成最後的 HTML，然後傳送到要求的瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="80705-170">When the `Default.aspx` page is visited by a browser, the ASP.NET engine automatically merges the page's master page content and the ASP.NET's content, and renders the merged content into the final HTML that is sent down to the requesting browser.</span></span> <span data-ttu-id="80705-171">當主版頁面的內容更新時，所有使用此主版頁面的 ASP.NET 網頁都會在下一次要求時，以新的主版頁面內容 remerged 其內容。</span><span class="sxs-lookup"><span data-stu-id="80705-171">When the master page's content is updated, all ASP.NET pages that use this master page will have their content remerged with the new master page content the next time they are requested.</span></span> <span data-ttu-id="80705-172">簡單來說，主版頁面模型允許定義單一頁面配置範本（主版頁面），其變更會立即反映在整個網站上。</span><span class="sxs-lookup"><span data-stu-id="80705-172">In short, the master page model allows for a single page layout template to be defined (the master page) whose changes are immediately reflected across the entire site.</span></span>

## <a name="adding-additional-aspnet-pages-to-the-website"></a><span data-ttu-id="80705-173">將其他 ASP.NET 網頁新增至網站</span><span class="sxs-lookup"><span data-stu-id="80705-173">Adding Additional ASP.NET Pages to the Website</span></span>

<span data-ttu-id="80705-174">讓我們花點時間將額外的 ASP.NET 網頁存根新增至網站，最終將會保存各種報告示範。</span><span class="sxs-lookup"><span data-stu-id="80705-174">Let's take a moment to add additional ASP.NET page stubs to the site that will eventually hold the various reporting demos.</span></span> <span data-ttu-id="80705-175">總共會有35個以上的示範，而不是建立所有的 stub 頁面，而只是建立前幾頁。</span><span class="sxs-lookup"><span data-stu-id="80705-175">There will be more than 35 demos in total, so rather than creating all of the stub pages let's just create the first few.</span></span> <span data-ttu-id="80705-176">由於也有許多示範的類別，因此若要更有效地管理示範，請新增類別目錄的資料夾。</span><span class="sxs-lookup"><span data-stu-id="80705-176">Since there will also be many categories of demos, to better manage the demos add a folder for the categories.</span></span> <span data-ttu-id="80705-177">現在新增下列三個資料夾：</span><span class="sxs-lookup"><span data-stu-id="80705-177">Add the following three folders for now:</span></span>

- `BasicReporting`
- `Filtering`
- `CustomFormatting`

<span data-ttu-id="80705-178">最後，新增檔案，如 [圖 8] 中的方案總管所示。</span><span class="sxs-lookup"><span data-stu-id="80705-178">Finally, add new files as shown in the Solution Explorer in Figure 8.</span></span> <span data-ttu-id="80705-179">新增每個檔案時，請記得勾選 [選取主版頁面] 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="80705-179">When adding each file, remember to check the "Select master page" checkbox.</span></span>

![新增下列檔案](master-pages-and-site-navigation-vb/_static/image20.png)

<span data-ttu-id="80705-181">**圖 8**：新增下列檔案</span><span class="sxs-lookup"><span data-stu-id="80705-181">**Figure 8**: Add the Following Files</span></span>

## <a name="step-2-creating-a-site-map"></a><span data-ttu-id="80705-182">步驟2：建立網站地圖</span><span class="sxs-lookup"><span data-stu-id="80705-182">Step 2: Creating a Site Map</span></span>

<span data-ttu-id="80705-183">管理由多個頁面組成的網站，其中一項挑戰是提供直接的方式讓訪客流覽網站。</span><span class="sxs-lookup"><span data-stu-id="80705-183">One of the challenges of managing a website composed of more than a handful of pages is providing a straightforward way for visitors to navigate through the site.</span></span> <span data-ttu-id="80705-184">首先，必須定義網站的導覽結構。</span><span class="sxs-lookup"><span data-stu-id="80705-184">To begin with, the site's navigational structure must be defined.</span></span> <span data-ttu-id="80705-185">接下來，此結構必須轉譯成可流覽的使用者介面元素，例如功能表或階層連結。</span><span class="sxs-lookup"><span data-stu-id="80705-185">Next, this structure must be translated into navigable user interface elements, such as menus or breadcrumbs.</span></span> <span data-ttu-id="80705-186">最後，這整個程式必須在新頁面新增至網站，且現有的網頁已移除時進行維護和更新。</span><span class="sxs-lookup"><span data-stu-id="80705-186">Finally, this whole process needs to be maintained and updated as new pages are added to the site and existing ones removed.</span></span> <span data-ttu-id="80705-187">在 ASP.NET 2.0 之前，開發人員會自行建立網站的導覽結構、維護它，並將它轉譯成可流覽的使用者介面專案。</span><span class="sxs-lookup"><span data-stu-id="80705-187">Prior to ASP.NET 2.0, developers were on their own for creating the site's navigational structure, maintaining it, and translating it into navigable user interface elements.</span></span> <span data-ttu-id="80705-188">不過，使用 ASP.NET 2.0 時，開發人員可以利用非常彈性的內建網站流覽系統。</span><span class="sxs-lookup"><span data-stu-id="80705-188">With ASP.NET 2.0, however, developers can utilize the very flexible built in site navigation system.</span></span>

<span data-ttu-id="80705-189">ASP.NET 2.0 site 導覽系統提供一種方法，讓開發人員定義網站地圖，然後透過程式設計的 API 來存取此資訊。</span><span class="sxs-lookup"><span data-stu-id="80705-189">The ASP.NET 2.0 site navigation system provides a means for a developer to define a site map and to then access this information through a programmatic API.</span></span> <span data-ttu-id="80705-190">ASP.NET 隨附的網站地圖提供者，需要將網站地圖資料儲存在以特定方式格式化的 XML 檔案中。</span><span class="sxs-lookup"><span data-stu-id="80705-190">ASP.NET ships with a site map provider that expects site map data to be stored in an XML file formatted in a particular way.</span></span> <span data-ttu-id="80705-191">但是，由於網站導覽系統是以[提供者模型](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx)為基礎，因此可以擴充，以支援序列化網站地圖資訊的替代方式。</span><span class="sxs-lookup"><span data-stu-id="80705-191">But, since the site navigation system is built on the [provider model](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx) it can be extended to support alternative ways for serializing the site map information.</span></span> <span data-ttu-id="80705-192">Jeff Prosise 的文章，[您所等待的 SQL 網站地圖提供者](https://msdn.microsoft.com/msdnmag/issues/06/02/WickedCode/default.aspx)示範如何建立網站地圖提供者，將網站地圖儲存在 SQL Server 資料庫中;另一個選項是建立以[檔案系統結構為基礎的網站地圖提供者](http://aspnet.4guysfromrolla.com/articles/020106-1.aspx)。</span><span class="sxs-lookup"><span data-stu-id="80705-192">Jeff Prosise's article, [The SQL Site Map Provider You've Been Waiting For](https://msdn.microsoft.com/msdnmag/issues/06/02/WickedCode/default.aspx) shows how to create a site map provider that stores the site map in a SQL Server database; another option is to create [a site map provider based on the file system structure](http://aspnet.4guysfromrolla.com/articles/020106-1.aspx).</span></span>

<span data-ttu-id="80705-193">不過，在本教學課程中，我們將使用隨附于 ASP.NET 2.0 的預設網站地圖提供者。</span><span class="sxs-lookup"><span data-stu-id="80705-193">For this tutorial, however, let's use the default site map provider that ships with ASP.NET 2.0.</span></span> <span data-ttu-id="80705-194">若要建立網站地圖，只要以滑鼠右鍵按一下 方案總管中的專案名稱，選擇 加入新專案，然後選擇 網站地圖 選項即可。</span><span class="sxs-lookup"><span data-stu-id="80705-194">To create the site map, simply right-click on the project name in the Solution Explorer, choose Add New Item, and choose the Site Map option.</span></span> <span data-ttu-id="80705-195">將名稱保留 `Web.sitemap`，然後按一下 [新增] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="80705-195">Leave the name as `Web.sitemap` and click the Add button.</span></span>

<span data-ttu-id="80705-196">[![將網站地圖新增至您的專案](master-pages-and-site-navigation-vb/_static/image22.png)](master-pages-and-site-navigation-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="80705-196">[![Add a Site Map to Your Project](master-pages-and-site-navigation-vb/_static/image22.png)](master-pages-and-site-navigation-vb/_static/image21.png)</span></span>

<span data-ttu-id="80705-197">**圖 9**：將網站地圖新增至您的專案（[按一下以觀看完整大小的影像](master-pages-and-site-navigation-vb/_static/image23.png)）</span><span class="sxs-lookup"><span data-stu-id="80705-197">**Figure 9**: Add a Site Map to Your Project ([Click to view full-size image](master-pages-and-site-navigation-vb/_static/image23.png))</span></span>

<span data-ttu-id="80705-198">網站地圖檔案是一個 XML 檔案。</span><span class="sxs-lookup"><span data-stu-id="80705-198">The site map file is an XML file.</span></span> <span data-ttu-id="80705-199">請注意，Visual Studio 會為網站地圖結構提供 IntelliSense。</span><span class="sxs-lookup"><span data-stu-id="80705-199">Note that Visual Studio provides IntelliSense for the site map structure.</span></span> <span data-ttu-id="80705-200">網站地圖檔案必須有 `<siteMap>` 節點做為其根節點，且必須精確包含一個 `<siteMapNode>` 子項目。</span><span class="sxs-lookup"><span data-stu-id="80705-200">The site map file must have the `<siteMap>` node as its root node, which must contain precisely one `<siteMapNode>` child element.</span></span> <span data-ttu-id="80705-201">第一個 `<siteMapNode>` 元素可以包含任意數目的子代 `<siteMapNode>` 元素。</span><span class="sxs-lookup"><span data-stu-id="80705-201">That first `<siteMapNode>` element can then contain an arbitrary number of descendent `<siteMapNode>` elements.</span></span>

<span data-ttu-id="80705-202">定義要模擬檔案系統結構的網站地圖。</span><span class="sxs-lookup"><span data-stu-id="80705-202">Define the site map to mimic the file system structure.</span></span> <span data-ttu-id="80705-203">也就是，針對這些資料夾中的每個 ASP.NET 網頁，新增三個資料夾和子 `<siteMapNode>` 元素的 `<siteMapNode>` 元素，如下所示：</span><span class="sxs-lookup"><span data-stu-id="80705-203">That is, add a `<siteMapNode>` element for each of the three folders, and child `<siteMapNode>` elements for each of the ASP.NET pages in those folders, like so:</span></span>

<span data-ttu-id="80705-204">Web. 網站地圖</span><span class="sxs-lookup"><span data-stu-id="80705-204">Web.sitemap</span></span>

[!code-xml[Main](master-pages-and-site-navigation-vb/samples/sample4.xml)]

<span data-ttu-id="80705-205">網站地圖會定義網站的導覽結構，這是描述網站各區段的階層。</span><span class="sxs-lookup"><span data-stu-id="80705-205">The site map defines the website's navigational structure, which is a hierarchy that describes the various sections of the site.</span></span> <span data-ttu-id="80705-206">`Web.sitemap` 中的每個 `<siteMapNode>` 元素都代表網站導覽結構中的一個區段。</span><span class="sxs-lookup"><span data-stu-id="80705-206">Each `<siteMapNode>` element in `Web.sitemap` represents a section in the site's navigational structure.</span></span>

<span data-ttu-id="80705-207">[![網站地圖代表階層式導覽結構](master-pages-and-site-navigation-vb/_static/image25.png)](master-pages-and-site-navigation-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="80705-207">[![The Site Map Represents a Hierarchical Navigational Structure](master-pages-and-site-navigation-vb/_static/image25.png)](master-pages-and-site-navigation-vb/_static/image24.png)</span></span>

<span data-ttu-id="80705-208">**圖 10**：網站地圖代表階層式導覽結構（[按一下以觀看完整大小的影像](master-pages-and-site-navigation-vb/_static/image26.png)）</span><span class="sxs-lookup"><span data-stu-id="80705-208">**Figure 10**: The Site Map Represents a Hierarchical Navigational Structure ([Click to view full-size image](master-pages-and-site-navigation-vb/_static/image26.png))</span></span>

<span data-ttu-id="80705-209">ASP.NET 會透過 .NET Framework 的[網站地圖類別](https://msdn.microsoft.com/library/system.web.sitemap.aspx)公開網站地圖的結構。</span><span class="sxs-lookup"><span data-stu-id="80705-209">ASP.NET exposes the site map's structure through the .NET Framework's [SiteMap class](https://msdn.microsoft.com/library/system.web.sitemap.aspx).</span></span> <span data-ttu-id="80705-210">這個類別具有 `CurrentNode` 屬性，它會傳回使用者目前造訪之區段的相關資訊;`RootNode` 屬性會傳回網站地圖（Home）在我們網站地圖中的根。</span><span class="sxs-lookup"><span data-stu-id="80705-210">This class has a `CurrentNode` property, which returns information about the section the user is currently visiting; the `RootNode` property returns the root of the site map (Home, in our site map).</span></span> <span data-ttu-id="80705-211">`CurrentNode` 和 `RootNode` 屬性都會傳回[SiteMapNode](https://msdn.microsoft.com/library/system.web.sitemapnode.aspx)實例，其具有如 `ParentNode`、`ChildNodes`、`NextSibling`、`PreviousSibling`等等的屬性，可讓網站地圖階層進行引導。</span><span class="sxs-lookup"><span data-stu-id="80705-211">Both the `CurrentNode` and `RootNode` properties return [SiteMapNode](https://msdn.microsoft.com/library/system.web.sitemapnode.aspx) instances, which have properties like `ParentNode`, `ChildNodes`, `NextSibling`, `PreviousSibling`, and so on, that allow for the site map hierarchy to be walked.</span></span>

## <a name="step-3-displaying-a-menu-based-on-the-site-map"></a><span data-ttu-id="80705-212">步驟3：顯示以網站地圖為基礎的功能表</span><span class="sxs-lookup"><span data-stu-id="80705-212">Step 3: Displaying a Menu Based on the Site Map</span></span>

<span data-ttu-id="80705-213">存取 ASP.NET 2.0 中的資料可透過程式設計方式完成，例如在 ASP.NET 1.x 中，或以宣告方式在新的[資料來源控制項](https://msdn.microsoft.com/library/ms227679.aspx)中執行。</span><span class="sxs-lookup"><span data-stu-id="80705-213">Accessing data in ASP.NET 2.0 can be accomplished programmatically, like in ASP.NET 1.x, or declaratively, through the new [data source controls](https://msdn.microsoft.com/library/ms227679.aspx).</span></span> <span data-ttu-id="80705-214">有數個內建的資料來源控制項，例如 SqlDataSource 控制項，用於存取關係資料庫資料、ObjectDataSource 控制項、用於存取類別的資料，以及其他專案。</span><span class="sxs-lookup"><span data-stu-id="80705-214">There are several built-in data source controls such as the SqlDataSource control, for accessing relational database data, the ObjectDataSource control, for accessing data from classes, and others.</span></span> <span data-ttu-id="80705-215">您甚至可以建立自己的[自訂資料來源控制項](https://msdn.microsoft.com/asp.net/reference/data/default.aspx?pull=/library/dnvs05/html/DataSourceCon1.asp)。</span><span class="sxs-lookup"><span data-stu-id="80705-215">You can even create your own [custom data source controls](https://msdn.microsoft.com/asp.net/reference/data/default.aspx?pull=/library/dnvs05/html/DataSourceCon1.asp).</span></span>

<span data-ttu-id="80705-216">資料來源控制項會當做 ASP.NET 網頁與基礎資料之間的 proxy。</span><span class="sxs-lookup"><span data-stu-id="80705-216">The data source controls serve as a proxy between your ASP.NET page and the underlying data.</span></span> <span data-ttu-id="80705-217">為了顯示資料來源控制項的抓取資料，我們通常會將另一個 Web 控制項加入至頁面，並將它系結至資料來源控制項。</span><span class="sxs-lookup"><span data-stu-id="80705-217">In order to display a data source control's retrieved data, we'll typically add another Web control to the page and bind it to the data source control.</span></span> <span data-ttu-id="80705-218">若要將 Web 控制項系結至資料來源控制項，只要將 Web 控制項的 `DataSourceID` 屬性設定為數據源控制項的 `ID` 屬性值即可。</span><span class="sxs-lookup"><span data-stu-id="80705-218">To bind a Web control to a data source control, simply set the Web control's `DataSourceID` property to the value of the data source control's `ID` property.</span></span>

<span data-ttu-id="80705-219">為了協助處理網站地圖的資料，ASP.NET 包含 SiteMapDataSource 控制項，可讓我們將 Web 控制項系結到我們網站的網站地圖。</span><span class="sxs-lookup"><span data-stu-id="80705-219">To aid in working with the site map's data, ASP.NET includes the SiteMapDataSource control, which allows us to bind a Web control against our website's site map.</span></span> <span data-ttu-id="80705-220">兩個 Web 控制項： TreeView 和功能表通常用來提供導覽使用者介面。</span><span class="sxs-lookup"><span data-stu-id="80705-220">Two Web controls the TreeView and Menu are commonly used to provide a navigation user interface.</span></span> <span data-ttu-id="80705-221">若要將網站地圖資料系結到這兩個控制項的其中一個，只要將 SiteMapDataSource 連同 TreeView 或 Menu 控制項（其 `DataSourceID` 屬性會據以設定）加入頁面。</span><span class="sxs-lookup"><span data-stu-id="80705-221">To bind the site map data to one of these two controls, simply add a SiteMapDataSource to the page along with a TreeView or Menu control whose `DataSourceID` property is set accordingly.</span></span> <span data-ttu-id="80705-222">例如，我們可以使用下列標記，將功能表控制項加入至主版頁面：</span><span class="sxs-lookup"><span data-stu-id="80705-222">For example, we could add a Menu control to the master page using the following markup:</span></span>

[!code-aspx[Main](master-pages-and-site-navigation-vb/samples/sample5.aspx)]

<span data-ttu-id="80705-223">若要對發出的 HTML 進行更精細的控制，我們可以將 SiteMapDataSource 控制項系結至中繼器控制項，如下所示：</span><span class="sxs-lookup"><span data-stu-id="80705-223">For a finer degree of control over the emitted HTML, we can bind the SiteMapDataSource control to the Repeater control, like so:</span></span>

[!code-aspx[Main](master-pages-and-site-navigation-vb/samples/sample6.aspx)]

<span data-ttu-id="80705-224">SiteMapDataSource 控制項會一次傳回一個層級的網站地圖階層，從根網站地圖節點（Home，在我們的網站地圖中）開始，然後是下一個層級（基礎報表、篩選報表和自訂格式）等等。</span><span class="sxs-lookup"><span data-stu-id="80705-224">The SiteMapDataSource control returns the site map hierarchy one level at a time, starting with the root site map node (Home, in our site map), then the next level (Basic Reporting, Filtering Reports, and Customized Formatting), and so on.</span></span> <span data-ttu-id="80705-225">將 SiteMapDataSource 系結至中繼器時，它會列舉傳回的第一個層級，並將該第一個層級中每個 `SiteMapNode` 實例的 `ItemTemplate` 具現化。</span><span class="sxs-lookup"><span data-stu-id="80705-225">When binding the SiteMapDataSource to a Repeater, it enumerates the first level returned and instantiates the `ItemTemplate` for each `SiteMapNode` instance in that first level.</span></span> <span data-ttu-id="80705-226">若要存取 `SiteMapNode`的特定屬性，我們可以使用 `Eval(propertyName)`，這就是我們取得每個 `SiteMapNode`的 `Url` 和超連結控制項 `Title` 屬性的方式。</span><span class="sxs-lookup"><span data-stu-id="80705-226">To access a particular property of the `SiteMapNode`, we can use `Eval(propertyName)`, which is how we get each `SiteMapNode`'s `Url` and `Title` properties for the HyperLink control.</span></span>

<span data-ttu-id="80705-227">上述的中繼器範例會轉譯下列標記：</span><span class="sxs-lookup"><span data-stu-id="80705-227">The Repeater example above will render the following markup:</span></span>

[!code-html[Main](master-pages-and-site-navigation-vb/samples/sample7.html)]

<span data-ttu-id="80705-228">這些網站地圖節點（基礎報表、篩選報表和自訂格式）組成所轉譯的*第二*層網站對應，而不是第一個階層。</span><span class="sxs-lookup"><span data-stu-id="80705-228">These site map nodes (Basic Reporting, Filtering Reports, and Customized Formatting) comprise the *second* level of the site map being rendered, not the first.</span></span> <span data-ttu-id="80705-229">這是因為 SiteMapDataSource 的 `ShowStartingNode` 屬性設定為 False，導致 SiteMapDataSource 略過根網站對應節點，而改為從網站地圖階層中的第二個層級開始。</span><span class="sxs-lookup"><span data-stu-id="80705-229">This is because the SiteMapDataSource's `ShowStartingNode` property is set to False, causing the SiteMapDataSource to bypass the root site map node and instead begin by returning the second level in the site map hierarchy.</span></span>

<span data-ttu-id="80705-230">若要顯示基本報告、篩選報表和自訂格式設定 `SiteMapNode` 的子系，我們可以將另一個中繼器新增至初始中繼器的 `ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="80705-230">To display the children for the Basic Reporting, Filtering Reports, and Customized Formatting `SiteMapNode` s, we can add another Repeater to the initial Repeater's `ItemTemplate`.</span></span> <span data-ttu-id="80705-231">第二個中繼器會系結至 `SiteMapNode` 實例的 `ChildNodes` 屬性，如下所示：</span><span class="sxs-lookup"><span data-stu-id="80705-231">This second Repeater will be bound to the `SiteMapNode` instance's `ChildNodes` property, like so:</span></span>

[!code-aspx[Main](master-pages-and-site-navigation-vb/samples/sample8.aspx)]

<span data-ttu-id="80705-232">這兩個中繼器會產生下列標記（為了簡潔起見，已移除某些標記）：</span><span class="sxs-lookup"><span data-stu-id="80705-232">These two Repeaters result in the following markup (some markup has been removed for brevity):</span></span>

[!code-html[Main](master-pages-and-site-navigation-vb/samples/sample9.html)]

<span data-ttu-id="80705-233">使用從[Rachel Andrew](http://www.rachelandrew.co.uk/)的書籍中選擇的 Css 樣式[Anthology：101基本秘訣、訣竅、&amp; 的駭客](https://www.amazon.com/gp/product/0957921888/qid=1137565739/sr=8-1/ref=pd_bbs_1/103-0562306-3386214?n=507846&amp;s=books&amp;v=glance)、`<ul>` 和 `<li>` 元素的樣式，讓標記產生下列視覺效果輸出：</span><span class="sxs-lookup"><span data-stu-id="80705-233">Using CSS styles chosen from [Rachel Andrew](http://www.rachelandrew.co.uk/)'s book [The CSS Anthology: 101 Essential Tips, Tricks, &amp; Hacks](https://www.amazon.com/gp/product/0957921888/qid=1137565739/sr=8-1/ref=pd_bbs_1/103-0562306-3386214?n=507846&amp;s=books&amp;v=glance), the `<ul>` and `<li>` elements are styled such that the markup produces the following visual output:</span></span>

![由兩個中繼器和一些 CSS 組成的功能表](master-pages-and-site-navigation-vb/_static/image27.png)

<span data-ttu-id="80705-235">**圖 11**：由兩個中繼器和一些 CSS 組成的功能表</span><span class="sxs-lookup"><span data-stu-id="80705-235">**Figure 11**: A Menu Composed from Two Repeaters and Some CSS</span></span>

<span data-ttu-id="80705-236">此功能表位於主版頁面中，並系結至 `Web.sitemap`中定義的網站地圖，這表示網站對應的任何變更都會立即反映在所有使用 `Site.master` 主版頁面的頁面上。</span><span class="sxs-lookup"><span data-stu-id="80705-236">This menu is in the master page and bound to the site map defined in `Web.sitemap`, meaning that any change to the site map will be immediately reflected on all pages that use the `Site.master` master page.</span></span>

## <a name="disabling-viewstate"></a><span data-ttu-id="80705-237">停用 ViewState</span><span class="sxs-lookup"><span data-stu-id="80705-237">Disabling ViewState</span></span>

<span data-ttu-id="80705-238">所有的 ASP.NET 控制項都可以選擇性地將其狀態保存到[view 狀態](https://msdn.microsoft.com/msdnmag/issues/03/02/CuttingEdge/)，這會在呈現的 HTML 中序列化為隱藏的表單欄位。</span><span class="sxs-lookup"><span data-stu-id="80705-238">All ASP.NET controls can optionally persist their state to the [view state](https://msdn.microsoft.com/msdnmag/issues/03/02/CuttingEdge/), which is serialized as a hidden form field in the rendered HTML.</span></span> <span data-ttu-id="80705-239">控制項會使用 View 狀態來記住其在回傳期間以程式設計方式變更的狀態，例如系結至資料 Web 控制項的資料。</span><span class="sxs-lookup"><span data-stu-id="80705-239">View state is used by controls to remember their programmatically-changed state across postbacks, such as the data bound to a data Web control.</span></span> <span data-ttu-id="80705-240">雖然 view 狀態允許在回傳期間記住資訊，但它會增加必須傳送至用戶端的標記大小，而且如果未受到嚴密監視，可能會導致嚴重的頁面膨脹。</span><span class="sxs-lookup"><span data-stu-id="80705-240">While view state permits information to be remembered across postbacks, it increases the size of the markup that must be sent to the client and can lead to severe page bloat if not closely monitored.</span></span> <span data-ttu-id="80705-241">資料 Web 控制項特別是 GridView 特別糟，可將數十個額外 kb 的標記新增至頁面。</span><span class="sxs-lookup"><span data-stu-id="80705-241">Data Web controls especially the GridView are particularly notorious for adding dozens of extra kilobytes of markup to a page.</span></span> <span data-ttu-id="80705-242">雖然寬頻或內部網路使用者的這類增加可能是可忽略的，但 view 狀態可能會在撥號使用者的來回行程中加上幾秒鐘。</span><span class="sxs-lookup"><span data-stu-id="80705-242">While such an increase may be negligible for broadband or intranet users, view state can add several seconds to the round trip for dial-up users.</span></span>

<span data-ttu-id="80705-243">若要查看 view 狀態的影響，請造訪瀏覽器中的頁面，然後查看網頁所傳送的來源（在 Internet Explorer 中，移至 [View] 功能表，然後選擇 [來源] 選項）。</span><span class="sxs-lookup"><span data-stu-id="80705-243">To see the impact of view state, visit a page in a browser and then view the source sent by the web page (in Internet Explorer, go to the View menu and choose the Source option).</span></span> <span data-ttu-id="80705-244">您也可以開啟[頁面追蹤](https://msdn.microsoft.com/library/sfbfw58f.aspx)，以查看頁面上每個控制項所使用的檢視狀態配置。</span><span class="sxs-lookup"><span data-stu-id="80705-244">You can also turn on [page tracing](https://msdn.microsoft.com/library/sfbfw58f.aspx) to see the view state allocation used by each of the controls on the page.</span></span> <span data-ttu-id="80705-245">檢視狀態資訊會在名為 `__VIEWSTATE`的隱藏表單欄位中序列化，此欄位位於開頭 `<form>` 標記之後的 `<div>` 元素中。</span><span class="sxs-lookup"><span data-stu-id="80705-245">The view state information is serialized in a hidden form field named `__VIEWSTATE`, located in a `<div>` element immediately after the opening `<form>` tag.</span></span> <span data-ttu-id="80705-246">只有在使用 Web 表單時，才會保存 View 狀態;如果您的 ASP.NET 網頁未在其宣告式語法中包含 `<form runat="server">`，呈現的標記中將不會有 `__VIEWSTATE` 隱藏的表單欄位。</span><span class="sxs-lookup"><span data-stu-id="80705-246">View state is only persisted when there is a Web Form being used; if your ASP.NET page does not include a `<form runat="server">` in its declarative syntax there won't be a `__VIEWSTATE` hidden form field in the rendered markup.</span></span>

<span data-ttu-id="80705-247">主版頁面所產生的 [`__VIEWSTATE` 表單] 欄位會在頁面產生的標記中新增大約1800個位元組。</span><span class="sxs-lookup"><span data-stu-id="80705-247">The `__VIEWSTATE` form field generated by the master page adds roughly 1,800 bytes to the page's generated markup.</span></span> <span data-ttu-id="80705-248">這項額外的膨脹主要是因重複項控制項的緣故，因為 SiteMapDataSource 控制項的內容會保存到 view 狀態。</span><span class="sxs-lookup"><span data-stu-id="80705-248">This extra bloat is due primarily to the Repeater control, as the contents of the SiteMapDataSource control are persisted to view state.</span></span> <span data-ttu-id="80705-249">雖然額外的1800位元組似乎不太可能會令人興奮，但當您使用具有許多欄位和記錄的 GridView 時，檢視狀態可以輕鬆地源源不絕10個以上的因素。</span><span class="sxs-lookup"><span data-stu-id="80705-249">While an extra 1,800 bytes may not seem like much to get excited about, when using a GridView with many fields and records, the view state can easily swell by a factor of 10 or more.</span></span>

<span data-ttu-id="80705-250">您可以在頁面或控制項層級停用檢視狀態，方法是將 [`EnableViewState`] 屬性設定為 [`False`]，藉此減少呈現的標記大小。</span><span class="sxs-lookup"><span data-stu-id="80705-250">View state can be disabled at the page or control level by setting the `EnableViewState` property to `False`, thereby reducing the size of the rendered markup.</span></span> <span data-ttu-id="80705-251">由於資料 Web 控制項的檢視狀態會將系結至資料 Web 控制項的資料保存在回傳中，因此，在停用資料 Web 控制項的檢視狀態時，必須在每個回傳上系結資料。</span><span class="sxs-lookup"><span data-stu-id="80705-251">Since the view state for a data Web control persists the data bound to the data Web control across postbacks, when disabling the view state for a data Web control the data must be bound on each and every postback.</span></span> <span data-ttu-id="80705-252">在 ASP.NET 1.x 版中，這項責任會落在網頁開發人員的肩膀上;不過，有了 ASP.NET 2.0，資料 Web 控制項就會在每次回傳時，視需要重新系結至其資料來源控制項。</span><span class="sxs-lookup"><span data-stu-id="80705-252">In ASP.NET version 1.x this responsibility fell on the shoulders of the page developer; with ASP.NET 2.0, however, the data Web controls will rebind to their data source control on each postback if needed.</span></span>

<span data-ttu-id="80705-253">若要減少頁面的檢視狀態，讓我們將重複項控制項的 `EnableViewState` 屬性設定為 [`False`]。</span><span class="sxs-lookup"><span data-stu-id="80705-253">To reduce the page's view state let's set the Repeater control's `EnableViewState` property to `False`.</span></span> <span data-ttu-id="80705-254">這可以透過設計工具中的屬性視窗來完成，或在原始檔視圖中以宣告方式執行。</span><span class="sxs-lookup"><span data-stu-id="80705-254">This can be done through the Properties window in the Designer or declaratively in the Source view.</span></span> <span data-ttu-id="80705-255">進行這項變更之後，中繼器的宣告式標記看起來應該像這樣：</span><span class="sxs-lookup"><span data-stu-id="80705-255">After making this change the Repeater's declarative markup should look like:</span></span>

[!code-aspx[Main](master-pages-and-site-navigation-vb/samples/sample10.aspx)]

<span data-ttu-id="80705-256">在這項變更之後，頁面的呈現檢視狀態大小已縮減為僅52個位元組，而在檢視狀態大小中，會節省97%！</span><span class="sxs-lookup"><span data-stu-id="80705-256">After this change, the page's rendered view state size has shrunk to a mere 52 bytes, a 97% savings in view state size!</span></span> <span data-ttu-id="80705-257">在這一系列的教學課程中，我們預設會停用資料 Web 控制項的檢視狀態，以縮減轉譯標記的大小。</span><span class="sxs-lookup"><span data-stu-id="80705-257">In the tutorials throughout this series we'll disable the view state of the data Web controls by default in order to reduce the size of the rendered markup.</span></span> <span data-ttu-id="80705-258">在大部分的範例中，`EnableViewState` 屬性會設定為 `False` 並在不提及的情況下完成。</span><span class="sxs-lookup"><span data-stu-id="80705-258">In the majority of the examples the `EnableViewState` property will be set to `False` and done so without mention.</span></span> <span data-ttu-id="80705-259">只有在必須啟用它的情況下，才會討論唯一的時間 view 狀態，才能讓資料 Web 控制項提供其預期的功能。</span><span class="sxs-lookup"><span data-stu-id="80705-259">The only time view state will be discussed is in scenarios where it must be enabled in order for the data Web control to provide its expected functionality.</span></span>

## <a name="step-4-adding-breadcrumb-navigation"></a><span data-ttu-id="80705-260">步驟4：新增階層連結導覽</span><span class="sxs-lookup"><span data-stu-id="80705-260">Step 4: Adding Breadcrumb Navigation</span></span>

<span data-ttu-id="80705-261">若要完成主版頁面，讓我們將階層式導覽 UI 元素新增至每個頁面。</span><span class="sxs-lookup"><span data-stu-id="80705-261">To complete the master page, let's add a breadcrumb navigation UI element to each page.</span></span> <span data-ttu-id="80705-262">階層連結會快速顯示使用者在網站階層中的目前位置。</span><span class="sxs-lookup"><span data-stu-id="80705-262">The breadcrumb quickly shows users their current position within the site hierarchy.</span></span> <span data-ttu-id="80705-263">在 ASP.NET 2.0 中新增階層連結很容易，只要將 SiteMapPath 控制項新增至頁面即可。不需要任何程式碼。</span><span class="sxs-lookup"><span data-stu-id="80705-263">Adding a breadcrumb in ASP.NET 2.0 is easy just add a SiteMapPath control to the page; no code is needed.</span></span>

<span data-ttu-id="80705-264">針對我們的網站，將此控制項新增至標頭 `<div>`：</span><span class="sxs-lookup"><span data-stu-id="80705-264">For our site, add this control to the header `<div>`:</span></span>

[!code-aspx[Main](master-pages-and-site-navigation-vb/samples/sample11.aspx)]

<span data-ttu-id="80705-265">階層連結會顯示使用者在網站地圖階層中造訪的目前頁面，以及該網站地圖節點的「上階」，一直到根目錄（在我們的網站地圖中）為止。</span><span class="sxs-lookup"><span data-stu-id="80705-265">The breadcrumb shows the current page the user is visiting in the site map hierarchy as well as that site map node's "ancestors," all the way up to the root (Home, in our site map).</span></span>

![階層連結會顯示目前頁面及其上階的網站地圖階層架構](master-pages-and-site-navigation-vb/_static/image28.png)

<span data-ttu-id="80705-267">**圖 12**：階層連結會顯示目前頁面及其在網站地圖階層架構中的祖系</span><span class="sxs-lookup"><span data-stu-id="80705-267">**Figure 12**: The Breadcrumb Displays the Current Page and its Ancestors in the Site Map Hierarchy</span></span>

## <a name="step-5-adding-the-default-page-for-each-section"></a><span data-ttu-id="80705-268">步驟5：新增每個區段的預設頁面</span><span class="sxs-lookup"><span data-stu-id="80705-268">Step 5: Adding the Default Page for Each Section</span></span>

<span data-ttu-id="80705-269">我們網站中的教學課程會細分成不同的類別，包括基礎報表、篩選、自訂格式等等，以及每個類別的資料夾和對應的教學課程，做為該資料夾內的 ASP.NET 網頁。</span><span class="sxs-lookup"><span data-stu-id="80705-269">The tutorials in our site are broken down into different categories Basic Reporting, Filtering, Custom Formatting, and so on with a folder for each category and the corresponding tutorials as ASP.NET pages within that folder.</span></span> <span data-ttu-id="80705-270">此外，每個資料夾都包含一個 `Default.aspx` 頁面。</span><span class="sxs-lookup"><span data-stu-id="80705-270">Additionally, each folder contains a `Default.aspx` page.</span></span> <span data-ttu-id="80705-271">在此預設頁面中，讓我們顯示目前區段的所有教學課程。</span><span class="sxs-lookup"><span data-stu-id="80705-271">For this default page, let's display all of the tutorials for the current section.</span></span> <span data-ttu-id="80705-272">也就是說，對於 `BasicReporting` 資料夾中的 `Default.aspx`，我們會有 `SimpleDisplay.aspx`、`DeclarativeParams.aspx`和 `ProgrammaticParams.aspx`的連結。</span><span class="sxs-lookup"><span data-stu-id="80705-272">That is, for the `Default.aspx` in the `BasicReporting` folder we'd have links to `SimpleDisplay.aspx`, `DeclarativeParams.aspx`, and `ProgrammaticParams.aspx`.</span></span> <span data-ttu-id="80705-273">同樣地，我們也可以使用 `SiteMap` 類別和資料 Web 控制項，根據 `Web.sitemap`中定義的網站地圖來顯示這項資訊。</span><span class="sxs-lookup"><span data-stu-id="80705-273">Here, again, we can use the `SiteMap` class and a data Web control to display this information based upon the site map defined in `Web.sitemap`.</span></span>

<span data-ttu-id="80705-274">讓我們再次使用中繼器來顯示未排序的清單，但這次我們會顯示教學課程的標題和描述。</span><span class="sxs-lookup"><span data-stu-id="80705-274">Let's display an unordered list using a Repeater again, but this time we'll display the title and description of the tutorials.</span></span> <span data-ttu-id="80705-275">因為要完成這項工作的標記和程式碼必須針對每個 `Default.aspx` 頁面重複，所以我們可以在[使用者控制項](https://msdn.microsoft.com/library/y6wb1a0e.aspx)中封裝此 UI 邏輯。</span><span class="sxs-lookup"><span data-stu-id="80705-275">Since the markup and code to accomplish this will need to be repeated for each `Default.aspx` page, we can encapsulate this UI logic in a [User Control](https://msdn.microsoft.com/library/y6wb1a0e.aspx).</span></span> <span data-ttu-id="80705-276">在名為 `UserControls` 的網站中建立資料夾，並將新增至類型為 [`SectionLevelTutorialListing.ascx`的 Web 使用者控制項] 的新專案，然後新增下列標記：</span><span class="sxs-lookup"><span data-stu-id="80705-276">Create a folder in the website called `UserControls` and add to that a new item of type Web User Control named `SectionLevelTutorialListing.ascx`, and add the following markup:</span></span>

<span data-ttu-id="80705-277">[![將新的 Web 使用者控制項加入至 Usercontrol 資料夾](master-pages-and-site-navigation-vb/_static/image30.png)](master-pages-and-site-navigation-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="80705-277">[![Add a New Web User Control to the UserControls Folder](master-pages-and-site-navigation-vb/_static/image30.png)](master-pages-and-site-navigation-vb/_static/image29.png)</span></span>

<span data-ttu-id="80705-278">**圖 13**：在 [`UserControls`] 資料夾中加入新的 Web 使用者控制項（[按一下以觀看完整大小的影像](master-pages-and-site-navigation-vb/_static/image31.png)）</span><span class="sxs-lookup"><span data-stu-id="80705-278">**Figure 13**: Add a New Web User Control to the `UserControls` Folder ([Click to view full-size image](master-pages-and-site-navigation-vb/_static/image31.png))</span></span>

<span data-ttu-id="80705-279">SectionLevelTutorialListing .ascx</span><span class="sxs-lookup"><span data-stu-id="80705-279">SectionLevelTutorialListing.ascx</span></span>

[!code-aspx[Main](master-pages-and-site-navigation-vb/samples/sample12.aspx)]

<span data-ttu-id="80705-280">SectionLevelTutorialListing .ascx</span><span class="sxs-lookup"><span data-stu-id="80705-280">SectionLevelTutorialListing.ascx.vb</span></span>

[!code-vb[Main](master-pages-and-site-navigation-vb/samples/sample13.vb)]

<span data-ttu-id="80705-281">在先前的中繼器範例中，我們以宣告方式將 `SiteMap` 資料系結至中繼器;不過，`SectionLevelTutorialListing` 的使用者控制項會以程式設計方式執行。</span><span class="sxs-lookup"><span data-stu-id="80705-281">In the previous Repeater example we bound the `SiteMap` data to the Repeater declaratively; the `SectionLevelTutorialListing` User Control, however, does so programmatically.</span></span> <span data-ttu-id="80705-282">在 `Page_Load` 事件處理常式中，會進行檢查以確保此頁面的 URL 會對應至網站地圖中的節點。</span><span class="sxs-lookup"><span data-stu-id="80705-282">In the `Page_Load` event handler, a check is made to ensure that this page s URL maps to a node in the site map.</span></span> <span data-ttu-id="80705-283">如果在沒有對應 `<siteMapNode>` 專案的頁面中使用此使用者控制項，`SiteMap.CurrentNode` 會傳回 `Nothing` 而且不會有任何資料系結至中繼器。</span><span class="sxs-lookup"><span data-stu-id="80705-283">If this User Control is used in a page that does not have a corresponding `<siteMapNode>` entry, `SiteMap.CurrentNode` will return `Nothing` and no data will be bound to the Repeater.</span></span> <span data-ttu-id="80705-284">假設我們有 `CurrentNode`，我們會將其 `ChildNodes` 集合系結至中繼器。</span><span class="sxs-lookup"><span data-stu-id="80705-284">Assuming we have a `CurrentNode`, we bind its `ChildNodes` collection to the Repeater.</span></span> <span data-ttu-id="80705-285">由於我們的網站地圖已設定好讓每個區段中的 [`Default.aspx`] 頁面是該區段中所有教學課程的父節點，因此此程式碼會顯示所有區段教學課程的連結和描述，如以下螢幕擷取畫面所示。</span><span class="sxs-lookup"><span data-stu-id="80705-285">Since our site map is set up such that the `Default.aspx` page in each section is the parent node of all of the tutorials within that section, this code will display links to and descriptions of all of the section's tutorials, as shown in the screen shot below.</span></span>

<span data-ttu-id="80705-286">建立此中繼器之後，請開啟每個資料夾中的 [`Default.aspx`] 頁面，移至 [設計檢視]，然後直接將使用者控制項從 [方案總管] 拖曳至您想要顯示教學課程清單的設計介面上。</span><span class="sxs-lookup"><span data-stu-id="80705-286">Once this Repeater has been created, open the `Default.aspx` pages in each of the folders, go to the Design view, and simply drag the User Control from the Solution Explorer onto the Design surface where you want the tutorial list to appear.</span></span>

<span data-ttu-id="80705-287">[![使用者控制項已加入至 default.aspx](master-pages-and-site-navigation-vb/_static/image33.png)](master-pages-and-site-navigation-vb/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="80705-287">[![The User Control has Been Added to Default.aspx](master-pages-and-site-navigation-vb/_static/image33.png)](master-pages-and-site-navigation-vb/_static/image32.png)</span></span>

<span data-ttu-id="80705-288">**圖 14**：使用者控制項已加入至 `Default.aspx` （[按一下以查看完整大小的影像](master-pages-and-site-navigation-vb/_static/image34.png)）</span><span class="sxs-lookup"><span data-stu-id="80705-288">**Figure 14**: The User Control has Been Added to `Default.aspx` ([Click to view full-size image](master-pages-and-site-navigation-vb/_static/image34.png))</span></span>

<span data-ttu-id="80705-289">[![列出基本的報告教學課程](master-pages-and-site-navigation-vb/_static/image36.png)](master-pages-and-site-navigation-vb/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="80705-289">[![The Basic Reporting Tutorials are Listed](master-pages-and-site-navigation-vb/_static/image36.png)](master-pages-and-site-navigation-vb/_static/image35.png)</span></span>

<span data-ttu-id="80705-290">**圖 15**：列出基本的報告教學課程（[按一下以觀看完整大小的影像](master-pages-and-site-navigation-vb/_static/image37.png)）</span><span class="sxs-lookup"><span data-stu-id="80705-290">**Figure 15**: The Basic Reporting Tutorials are Listed ([Click to view full-size image](master-pages-and-site-navigation-vb/_static/image37.png))</span></span>

## <a name="summary"></a><span data-ttu-id="80705-291">總結</span><span class="sxs-lookup"><span data-stu-id="80705-291">Summary</span></span>

<span data-ttu-id="80705-292">定義網站地圖並完成主版頁面之後，我們的資料相關教學課程現在具有一致的頁面配置和流覽配置。</span><span class="sxs-lookup"><span data-stu-id="80705-292">With the site map defined and the master page complete, we now have a consistent page layout and navigation scheme for our data-related tutorials.</span></span> <span data-ttu-id="80705-293">無論我們新增至網站的頁數有多少，更新全網站頁面配置或網站導覽資訊是快速且簡單的程式，因為這項資訊是集中式的。</span><span class="sxs-lookup"><span data-stu-id="80705-293">Regardless of how many pages we add to our site, updating the site-wide page layout or site navigation information is a quick and simple process due to this information being centralized.</span></span> <span data-ttu-id="80705-294">具體而言，頁面配置資訊是在主版頁面中定義的，`Site.master` 和 `Web.sitemap`中的網站地圖。</span><span class="sxs-lookup"><span data-stu-id="80705-294">Specifically, the page layout information is defined in the master page `Site.master` and the site map in `Web.sitemap`.</span></span> <span data-ttu-id="80705-295">我們不需要撰寫*任何*程式碼來達到這個全網站的頁面配置和流覽機制，而且我們會在 Visual Studio 中保留完整的 WYSIWYG 設計工具支援。</span><span class="sxs-lookup"><span data-stu-id="80705-295">We didn't need to write *any* code to achieve this site-wide page layout and navigation mechanism, and we retain full WYSIWYG designer support in Visual Studio.</span></span>

<span data-ttu-id="80705-296">完成資料存取層和商務邏輯層，並定義一致的頁面配置和網站導覽之後，我們就可以開始探索常見的報表模式。</span><span class="sxs-lookup"><span data-stu-id="80705-296">Having completed the Data Access Layer and Business Logic Layer and having a consistent page layout and site navigation defined, we're ready to begin exploring common reporting patterns.</span></span> <span data-ttu-id="80705-297">在接下來的三個教學課程中，我們將探討基本的報告工作，顯示從 GridView、DetailsView 和 FormView 控制項中的 BLL 取得的資料。</span><span class="sxs-lookup"><span data-stu-id="80705-297">In the next three tutorials we'll look at basic reporting tasks displaying data retrieved from the BLL in the GridView, DetailsView, and FormView controls.</span></span>

<span data-ttu-id="80705-298">快樂的程式設計！</span><span class="sxs-lookup"><span data-stu-id="80705-298">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="80705-299">進一步閱讀</span><span class="sxs-lookup"><span data-stu-id="80705-299">Further Reading</span></span>

<span data-ttu-id="80705-300">如需本教學課程中所討論之主題的詳細資訊，請參閱下列資源：</span><span class="sxs-lookup"><span data-stu-id="80705-300">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="80705-301">ASP.NET 主版頁面總覽</span><span class="sxs-lookup"><span data-stu-id="80705-301">ASP.NET Master Pages Overview</span></span>](https://msdn.microsoft.com/library/wtxbf3hh.aspx)
- [<span data-ttu-id="80705-302">ASP.NET 2.0 中的主版頁面</span><span class="sxs-lookup"><span data-stu-id="80705-302">Master Pages in ASP.NET 2.0</span></span>](http://odetocode.com/Articles/419.aspx)
- [<span data-ttu-id="80705-303">ASP.NET 2.0 設計範本</span><span class="sxs-lookup"><span data-stu-id="80705-303">ASP.NET 2.0 Design Templates</span></span>](https://msdn.microsoft.com/asp.net/reference/design/templates/default.aspx)
- [<span data-ttu-id="80705-304">ASP.NET 網站流覽總覽</span><span class="sxs-lookup"><span data-stu-id="80705-304">ASP.NET Site Navigation Overview</span></span>](https://msdn.microsoft.com/library/e468hxky.aspx)
- [<span data-ttu-id="80705-305">檢查 ASP.NET 2.0 的網站導覽</span><span class="sxs-lookup"><span data-stu-id="80705-305">Examining ASP.NET 2.0's Site Navigation</span></span>](http://aspnet.4guysfromrolla.com/articles/111605-1.aspx)
- [<span data-ttu-id="80705-306">ASP.NET 2.0 網站導覽功能</span><span class="sxs-lookup"><span data-stu-id="80705-306">ASP.NET 2.0 Site Navigation Features</span></span>](https://weblogs.asp.net/scottgu/archive/2005/11/20/431019.aspx)
- [<span data-ttu-id="80705-307">瞭解 ASP.NET 檢視狀態</span><span class="sxs-lookup"><span data-stu-id="80705-307">Understanding ASP.NET View State</span></span>](https://msdn.microsoft.com/library/default.asp?url=/library/dnaspp/html/viewstate.asp)
- [<span data-ttu-id="80705-308">如何：啟用 ASP.NET 網頁的追蹤</span><span class="sxs-lookup"><span data-stu-id="80705-308">How to: Enable Tracing for an ASP.NET Page</span></span>](https://msdn.microsoft.com/library/94c55d08%28VS.80%29.aspx)
- [<span data-ttu-id="80705-309">ASP.NET 使用者控制項</span><span class="sxs-lookup"><span data-stu-id="80705-309">ASP.NET User Controls</span></span>](https://msdn.microsoft.com/library/y6wb1a0e.aspx)

## <a name="about-the-author"></a><span data-ttu-id="80705-310">關於作者</span><span class="sxs-lookup"><span data-stu-id="80705-310">About the Author</span></span>

<span data-ttu-id="80705-311">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，自1998起，有七個 ASP/ASP. NET 書籍和創辦人的[4GuysFromRolla.com](http://www.4guysfromrolla.com)。</span><span class="sxs-lookup"><span data-stu-id="80705-311">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="80705-312">Scott 以獨立的顧問、訓練員和作者的身分運作。</span><span class="sxs-lookup"><span data-stu-id="80705-312">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="80705-313">他的最新著作是[*在24小時內讓自己的 ASP.NET 2.0*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="80705-313">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="80705-314">他可以在mitchell@4GuysFromRolla.com觸達[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="80705-314">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="80705-315">或者透過他的 blog，可以在[http://ScottOnWriting.NET](http://ScottOnWriting.NET)找到。</span><span class="sxs-lookup"><span data-stu-id="80705-315">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="80705-316">特別感謝</span><span class="sxs-lookup"><span data-stu-id="80705-316">Special Thanks To</span></span>

<span data-ttu-id="80705-317">本教學課程系列已由許多有用的審核者所審查。</span><span class="sxs-lookup"><span data-stu-id="80705-317">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="80705-318">本教學課程的領導審查者為 Liz Shulok、Dennis Patterson 和 Hilton Giesenow。</span><span class="sxs-lookup"><span data-stu-id="80705-318">Lead reviewers for this tutorial were Liz Shulok, Dennis Patterson, and Hilton Giesenow.</span></span> <span data-ttu-id="80705-319">有興趣複習我即將發行的 MSDN 文章嗎？</span><span class="sxs-lookup"><span data-stu-id="80705-319">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="80705-320">若是如此，請在mitchell@4GuysFromRolla.com的那一行下拉式[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="80705-320">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="80705-321">上一篇</span><span class="sxs-lookup"><span data-stu-id="80705-321">Previous</span></span>](creating-a-business-logic-layer-vb.md)
