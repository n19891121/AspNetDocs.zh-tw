---
uid: web-forms/overview/data-access/working-with-batched-data/batch-deleting-cs
title: 批次刪除C#（） |Microsoft Docs
author: rick-anderson
description: 瞭解如何在單一作業中刪除多個資料庫記錄。 在使用者介面層中，我們是以先前 tut 中建立的增強 GridView 為基礎 。
ms.author: riande
ms.date: 06/26/2007
ms.assetid: ac6916d0-a5ab-4218-9760-7ba9e72d258c
msc.legacyurl: /web-forms/overview/data-access/working-with-batched-data/batch-deleting-cs
msc.type: authoredcontent
ms.openlocfilehash: ed832c38b4972f440ab64c141e29c85f0a9df920
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/06/2020
ms.locfileid: "78589527"
---
# <a name="batch-deleting-c"></a><span data-ttu-id="2aa58-104">批次刪除 (C#)</span><span class="sxs-lookup"><span data-stu-id="2aa58-104">Batch Deleting (C#)</span></span>

<span data-ttu-id="2aa58-105">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="2aa58-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="2aa58-106">[下載程式代碼](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_65_CS.zip)或[下載 PDF](batch-deleting-cs/_static/datatutorial65cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="2aa58-106">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_65_CS.zip) or [Download PDF](batch-deleting-cs/_static/datatutorial65cs1.pdf)</span></span>

> <span data-ttu-id="2aa58-107">瞭解如何在單一作業中刪除多個資料庫記錄。</span><span class="sxs-lookup"><span data-stu-id="2aa58-107">Learn how to delete multiple database records in a single operation.</span></span> <span data-ttu-id="2aa58-108">在使用者介面層中，我們是以稍早教學課程中建立的增強 GridView 為基礎。</span><span class="sxs-lookup"><span data-stu-id="2aa58-108">In the User Interface Layer we build upon an enhanced GridView created in an earlier tutorial.</span></span> <span data-ttu-id="2aa58-109">在資料存取層中，我們會將多個刪除作業包裝在交易中，以確保所有刪除動作都會成功，或所有刪除動作都會復原。</span><span class="sxs-lookup"><span data-stu-id="2aa58-109">In the Data Access Layer we wrap the multiple Delete operations within a transaction to ensure that all deletions succeed or all deletions are rolled back.</span></span>

## <a name="introduction"></a><span data-ttu-id="2aa58-110">簡介</span><span class="sxs-lookup"><span data-stu-id="2aa58-110">Introduction</span></span>

<span data-ttu-id="2aa58-111">[先前的教學](batch-updating-cs.md)課程探索到如何使用可完全編輯的 GridView 來建立批次編輯介面。</span><span class="sxs-lookup"><span data-stu-id="2aa58-111">The [preceding tutorial](batch-updating-cs.md) explored how to create a batch editing interface using a fully-editable GridView.</span></span> <span data-ttu-id="2aa58-112">在使用者經常同時編輯許多記錄的情況下，批次編輯介面需要的回傳和鍵盤到滑鼠內容切換較少，因此可提高使用者的效率。</span><span class="sxs-lookup"><span data-stu-id="2aa58-112">In situations where users are commonly editing many records at once, a batch editing interface will require far fewer postbacks and keyboard-to-mouse context switches, thereby improving the end user s efficiency.</span></span> <span data-ttu-id="2aa58-113">這項技術同樣適用于使用者經常在一處刪除許多記錄的頁面。</span><span class="sxs-lookup"><span data-stu-id="2aa58-113">This technique is similarly useful for pages where it is common for users to delete many records in one go.</span></span>

<span data-ttu-id="2aa58-114">曾經使用線上電子郵件客戶程式的任何人，都已經熟悉其中一個最常見的批次刪除介面：格線中的每個資料列都有對應的 [刪除所有已檢查的專案] 按鈕（請參閱 [圖 1]）。</span><span class="sxs-lookup"><span data-stu-id="2aa58-114">Anyone who has used an online email client is already familiar with one of the most common batch deleting interfaces: a checkbox in each row in a grid with a corresponding Delete All Checked Items button (see Figure 1).</span></span> <span data-ttu-id="2aa58-115">本教學課程很簡單，因為我們已在先前的教學課程中，完成建立 web 型介面和方法將一系列記錄刪除為單一不可部分完成的作業。</span><span class="sxs-lookup"><span data-stu-id="2aa58-115">This tutorial is rather short because we ve already done all of the hard work in previous tutorials in creating both the web-based interface and a method to delete a series of records as a single atomic operation.</span></span> <span data-ttu-id="2aa58-116">在 [[新增 GridView 的核取方塊](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-cs.md)] 資料行教學課程中，我們建立了一個 GridView，其中包含一個核取方塊的[資料行](wrapping-database-modifications-within-a-transaction-cs.md)，而在交易教學課程中，我們已在 BLL 中建立一個方法，這會使用交易來刪除 `ProductID` 值的 `List<T>`。</span><span class="sxs-lookup"><span data-stu-id="2aa58-116">In the [Adding a GridView Column of Checkboxes](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-cs.md) tutorial we created a GridView with a column of checkboxes and in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-cs.md) tutorial we created a method in the BLL that would use a transaction to delete a `List<T>` of `ProductID` values.</span></span> <span data-ttu-id="2aa58-117">在本教學課程中，我們將建立併合並先前的體驗，以建立運作中的批次刪除範例。</span><span class="sxs-lookup"><span data-stu-id="2aa58-117">In this tutorial, we will build upon and merge our previous experiences to create a working batch deleting example.</span></span>

<span data-ttu-id="2aa58-118">[![每個資料列都包含一個核取方塊](batch-deleting-cs/_static/image1.gif)](batch-deleting-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="2aa58-118">[![Each Row Includes a Checkbox](batch-deleting-cs/_static/image1.gif)](batch-deleting-cs/_static/image1.png)</span></span>

<span data-ttu-id="2aa58-119">**圖 1**：每個資料列都包含一個核取方塊（[按一下以查看完整大小的影像](batch-deleting-cs/_static/image2.png)）</span><span class="sxs-lookup"><span data-stu-id="2aa58-119">**Figure 1**: Each Row Includes a Checkbox ([Click to view full-size image](batch-deleting-cs/_static/image2.png))</span></span>

## <a name="step-1-creating-the-batch-deleting-interface"></a><span data-ttu-id="2aa58-120">步驟1：建立批次刪除介面</span><span class="sxs-lookup"><span data-stu-id="2aa58-120">Step 1: Creating the Batch Deleting Interface</span></span>

<span data-ttu-id="2aa58-121">由於我們已在[新增 GridView 的核取方塊資料行](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-cs.md)教學課程中建立批次刪除介面，因此我們可以直接將它複製到 `BatchDelete.aspx`，而不是從頭建立。</span><span class="sxs-lookup"><span data-stu-id="2aa58-121">Since we already created the batch deleting interface in the [Adding a GridView Column of Checkboxes](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-cs.md) tutorial, we can simply copy it to `BatchDelete.aspx` rather than creating it from scratch.</span></span> <span data-ttu-id="2aa58-122">一開始請開啟 [`BatchData`] 資料夾中的 [`BatchDelete.aspx`] 頁面，並在 [`EnhancedGridView`] 資料夾的 [`CheckBoxField.aspx`] 頁面。</span><span class="sxs-lookup"><span data-stu-id="2aa58-122">Start by opening the `BatchDelete.aspx` page in the `BatchData` folder and the `CheckBoxField.aspx` page in the `EnhancedGridView` folder.</span></span> <span data-ttu-id="2aa58-123">從 [`CheckBoxField.aspx`] 頁面，移至 [來源] 視圖，並複製 `<asp:Content>` 標記之間的標記，如 [圖 2] 所示。</span><span class="sxs-lookup"><span data-stu-id="2aa58-123">From the `CheckBoxField.aspx` page, go to the Source view and copy the markup between the `<asp:Content>` tags as shown in Figure 2.</span></span>

<span data-ttu-id="2aa58-124">[![將 CheckBoxField 的宣告式標記複製到剪貼簿](batch-deleting-cs/_static/image2.gif)](batch-deleting-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="2aa58-124">[![Copy the Declarative Markup of CheckBoxField.aspx to the Clipboard](batch-deleting-cs/_static/image2.gif)](batch-deleting-cs/_static/image3.png)</span></span>

<span data-ttu-id="2aa58-125">**圖 2**：將 `CheckBoxField.aspx` 的宣告式標記複製到剪貼簿（[按一下以觀看完整大小的影像](batch-deleting-cs/_static/image4.png)）</span><span class="sxs-lookup"><span data-stu-id="2aa58-125">**Figure 2**: Copy the Declarative Markup of `CheckBoxField.aspx` to the Clipboard ([Click to view full-size image](batch-deleting-cs/_static/image4.png))</span></span>

<span data-ttu-id="2aa58-126">接下來，移至 `BatchDelete.aspx` 中的來源視圖，並在 `<asp:Content>` 標記中貼上剪貼簿的內容。</span><span class="sxs-lookup"><span data-stu-id="2aa58-126">Next, go to the Source view in `BatchDelete.aspx` and paste the contents of the clipboard within the `<asp:Content>` tags.</span></span> <span data-ttu-id="2aa58-127">此外，也會從 `CheckBoxField.aspx.cs` 的程式碼後置類別中，將程式碼複製並貼到 `BatchDelete.aspx.cs` 中的程式碼後置類別中（`DeleteSelectedProducts` 按鈕 s `Click` 事件處理常式、`ToggleCheckState` 方法，以及 `Click` 和 `CheckAll` 按鈕的 `UncheckAll` 事件處理常式）。</span><span class="sxs-lookup"><span data-stu-id="2aa58-127">Also copy and paste the code from within the code-behind class in `CheckBoxField.aspx.cs` to within the code-behind class in `BatchDelete.aspx.cs` (the `DeleteSelectedProducts` Button s `Click` event handler, the `ToggleCheckState` method, and the `Click` event handlers for the `CheckAll` and `UncheckAll` Buttons).</span></span> <span data-ttu-id="2aa58-128">複製此內容之後，`BatchDelete.aspx` page s 程式碼後置類別應該包含下列程式碼：</span><span class="sxs-lookup"><span data-stu-id="2aa58-128">After copying over this content, the `BatchDelete.aspx` page s code-behind class should contain the following code:</span></span>

[!code-csharp[Main](batch-deleting-cs/samples/sample1.cs)]

<span data-ttu-id="2aa58-129">複製宣告式標記和原始程式碼之後，請花點時間透過瀏覽器查看 `BatchDelete.aspx`。</span><span class="sxs-lookup"><span data-stu-id="2aa58-129">After copying over the declarative markup and source code, take a moment to test `BatchDelete.aspx` by viewing it through a browser.</span></span> <span data-ttu-id="2aa58-130">您應該會看到 GridView 列出 GridView 中的前10個產品，其中每個資料列都會列出產品的名稱、類別和價格，以及一個核取方塊。</span><span class="sxs-lookup"><span data-stu-id="2aa58-130">You should see a GridView listing the first ten products in a GridView with each row listing the product s name, category, and price along with a checkbox.</span></span> <span data-ttu-id="2aa58-131">應該會有三個按鈕： [全選]、[取消選取全部] 和 [刪除選取的產品]。</span><span class="sxs-lookup"><span data-stu-id="2aa58-131">There should be three buttons: Check All, Uncheck All, and Delete Selected Products.</span></span> <span data-ttu-id="2aa58-132">按一下 [全選] 按鈕會選取所有核取方塊，而 [取消選取全部] 則會清除所有核取方塊。</span><span class="sxs-lookup"><span data-stu-id="2aa58-132">Clicking the Check All button selects all checkboxes, while Uncheck All clears all checkboxes.</span></span> <span data-ttu-id="2aa58-133">按一下 [刪除選取的產品] 會顯示一則訊息，其中列出所選產品的 `ProductID` 值，但不會實際刪除產品。</span><span class="sxs-lookup"><span data-stu-id="2aa58-133">Clicking Delete Selected Products displays a message that lists the `ProductID` values of the selected products, but does not actually delete the products.</span></span>

<span data-ttu-id="2aa58-134">[從 CheckBoxField ![介面已移至 BatchDeleting](batch-deleting-cs/_static/image3.gif)](batch-deleting-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="2aa58-134">[![The Interface from CheckBoxField.aspx has been Moved to BatchDeleting.aspx](batch-deleting-cs/_static/image3.gif)](batch-deleting-cs/_static/image5.png)</span></span>

<span data-ttu-id="2aa58-135">**圖 3**： `CheckBoxField.aspx` 的介面已移至 `BatchDeleting.aspx` （[按一下以觀看完整大小的影像](batch-deleting-cs/_static/image6.png)）</span><span class="sxs-lookup"><span data-stu-id="2aa58-135">**Figure 3**: The Interface from `CheckBoxField.aspx` has been Moved to `BatchDeleting.aspx` ([Click to view full-size image](batch-deleting-cs/_static/image6.png))</span></span>

## <a name="step-2-deleting-the-checked-products-using-transactions"></a><span data-ttu-id="2aa58-136">步驟2：使用交易刪除核取的產品</span><span class="sxs-lookup"><span data-stu-id="2aa58-136">Step 2: Deleting the Checked Products Using Transactions</span></span>

<span data-ttu-id="2aa58-137">成功將批次刪除介面複製到 `BatchDeleting.aspx`之後，剩下的工作就是更新程式碼，讓 [刪除選取的產品] 按鈕在 `ProductsBLL` 類別中使用 `DeleteProductsWithTransaction` 方法刪除已核取的產品。</span><span class="sxs-lookup"><span data-stu-id="2aa58-137">With the batch deleting interface successfully copied over to `BatchDeleting.aspx`, all that remains is to update the code so that the Delete Selected Products button deletes the checked products using the `DeleteProductsWithTransaction` method in the `ProductsBLL` class.</span></span> <span data-ttu-id="2aa58-138">這個方法在交易教學課程[中的包裝資料庫修改](wrapping-database-modifications-within-a-transaction-cs.md)中加入，會接受 `ProductID` 值的 `List<T>`，並刪除交易範圍內的每個對應 `ProductID`。</span><span class="sxs-lookup"><span data-stu-id="2aa58-138">This method, added in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-cs.md) tutorial, accepts as its input a `List<T>` of `ProductID` values and deletes each corresponding `ProductID` within the scope of a transaction.</span></span>

<span data-ttu-id="2aa58-139">`DeleteSelectedProducts` 按鈕 s `Click` 事件處理常式目前使用下列 `foreach` 迴圈逐一查看每個 GridView 資料列：</span><span class="sxs-lookup"><span data-stu-id="2aa58-139">The `DeleteSelectedProducts` Button s `Click` event handler currently uses the following `foreach` loop to iterate through each GridView row:</span></span>

[!code-csharp[Main](batch-deleting-cs/samples/sample2.cs)]

<span data-ttu-id="2aa58-140">針對每個資料列，會以程式設計方式參考 [`ProductSelector`] 核取方塊 Web 控制項。</span><span class="sxs-lookup"><span data-stu-id="2aa58-140">For each row, the `ProductSelector` CheckBox Web control is programmatically referenced.</span></span> <span data-ttu-id="2aa58-141">如果已核取，則會從 `DataKeys` 集合抓取資料列 `ProductID`，而 `DeleteResults` 標籤 s `Text` 屬性會更新以包含訊息，指出已選取要刪除的資料列。</span><span class="sxs-lookup"><span data-stu-id="2aa58-141">If it is checked, the row s `ProductID` is retrieved from the `DataKeys` collection and the `DeleteResults` Label s `Text` property is updated to include a message indicating that the row was selected for deletion.</span></span>

<span data-ttu-id="2aa58-142">上述程式碼不會實際刪除任何記錄，因為呼叫 `ProductsBLL` 類別 `Delete` 方法會被標記為批註。這是要套用的刪除邏輯，程式碼會刪除產品，而不是在不可部分完成的作業中。</span><span class="sxs-lookup"><span data-stu-id="2aa58-142">The above code does not actually delete any records as the call to the `ProductsBLL` class s `Delete` method is commented out. Were this delete logic to be applied, the code would delete the products but not within an atomic operation.</span></span> <span data-ttu-id="2aa58-143">也就是說，如果序列中的前幾個刪除成功，但後面的一個失敗（可能是因為外鍵條件約束違規），則會擲回例外狀況，但已刪除的產品仍會被刪除。</span><span class="sxs-lookup"><span data-stu-id="2aa58-143">That is, if the first few deletes in the sequence succeeded, but a later one failed (perhaps due to a foreign key constraint violation), an exception would be thrown but those products already deleted would remain deleted.</span></span>

<span data-ttu-id="2aa58-144">為了確保不可部分完成性，我們必須改為使用 `ProductsBLL` 類別的 `DeleteProductsWithTransaction` 方法。</span><span class="sxs-lookup"><span data-stu-id="2aa58-144">In order to assure atomicity, we need to instead use the `ProductsBLL` class s `DeleteProductsWithTransaction` method.</span></span> <span data-ttu-id="2aa58-145">因為此方法會接受 `ProductID` 值的清單，所以我們需要先從方格中編譯此清單，然後將它當做參數傳遞。</span><span class="sxs-lookup"><span data-stu-id="2aa58-145">Because this method accepts a list of `ProductID` values, we need to first compile this list from the grid and then pass it as a parameter.</span></span> <span data-ttu-id="2aa58-146">我們會先建立 `int`型別 `List<T>` 的實例。</span><span class="sxs-lookup"><span data-stu-id="2aa58-146">We first create an instance of a `List<T>` of type `int`.</span></span> <span data-ttu-id="2aa58-147">在 `foreach` 迴圈中，我們需要將選取的產品 `ProductID` 值新增至這個 `List<T>`。</span><span class="sxs-lookup"><span data-stu-id="2aa58-147">Within the `foreach` loop we need to add the selected products `ProductID` values to this `List<T>`.</span></span> <span data-ttu-id="2aa58-148">在迴圈之後，這個 `List<T>` 必須傳遞至 `ProductsBLL` 類別 s `DeleteProductsWithTransaction` 方法。</span><span class="sxs-lookup"><span data-stu-id="2aa58-148">After the loop this `List<T>` must be passed to the `ProductsBLL` class s `DeleteProductsWithTransaction` method.</span></span> <span data-ttu-id="2aa58-149">使用下列程式碼更新 `DeleteSelectedProducts` 按鈕 s `Click` 事件處理常式：</span><span class="sxs-lookup"><span data-stu-id="2aa58-149">Update the `DeleteSelectedProducts` Button s `Click` event handler with the following code:</span></span>

[!code-csharp[Main](batch-deleting-cs/samples/sample3.cs)]

<span data-ttu-id="2aa58-150">更新後的程式碼會建立 `int` （`productIDsToDelete`）類型的 `List<T>`，並在其中填入要刪除的 `ProductID` 值。</span><span class="sxs-lookup"><span data-stu-id="2aa58-150">The updated code creates a `List<T>` of type `int` (`productIDsToDelete`) and populates it with the `ProductID` values to delete.</span></span> <span data-ttu-id="2aa58-151">在 `foreach` 迴圈之後，如果至少選取一個產品，則會呼叫 `ProductsBLL` 類別 s `DeleteProductsWithTransaction` 方法，並傳遞這份清單。</span><span class="sxs-lookup"><span data-stu-id="2aa58-151">After the `foreach` loop, if there is at least one product selected, the `ProductsBLL` class s `DeleteProductsWithTransaction` method is called and passed this list.</span></span> <span data-ttu-id="2aa58-152">也會顯示 [`DeleteResults`] 標籤，並將資料重新系結至 GridView （如此一來，新刪除的記錄就不會再顯示為方格中的資料列）。</span><span class="sxs-lookup"><span data-stu-id="2aa58-152">The `DeleteResults` Label is also displayed and the data rebound to the GridView (so that the newly-deleted records no longer appear as rows in the grid).</span></span>

<span data-ttu-id="2aa58-153">[圖 4] 顯示已選取數個數據列以供刪除之後的 GridView。</span><span class="sxs-lookup"><span data-stu-id="2aa58-153">Figure 4 shows the GridView after a number of rows have been selected for deletion.</span></span> <span data-ttu-id="2aa58-154">[圖 5] 顯示按一下 [刪除選取的產品] 按鈕之後的畫面。</span><span class="sxs-lookup"><span data-stu-id="2aa58-154">Figure 5 shows the screen immediately after the Delete Selected Products button has been clicked.</span></span> <span data-ttu-id="2aa58-155">請注意，在 [圖 5] 中，已刪除之記錄的 `ProductID` 值會顯示在 GridView 底下的標籤中，而那些資料列已不再位於 GridView 中。</span><span class="sxs-lookup"><span data-stu-id="2aa58-155">Note that in Figure 5 the `ProductID` values of the deleted records are displayed in the Label beneath the GridView and those rows are no longer in the GridView.</span></span>

<span data-ttu-id="2aa58-156">[將刪除選取的產品 ![](batch-deleting-cs/_static/image4.gif)](batch-deleting-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="2aa58-156">[![The Selected Products Will Be Deleted](batch-deleting-cs/_static/image4.gif)](batch-deleting-cs/_static/image7.png)</span></span>

<span data-ttu-id="2aa58-157">**圖 4**：將會刪除選取的產品（[按一下以觀看完整大小的影像](batch-deleting-cs/_static/image8.png)）</span><span class="sxs-lookup"><span data-stu-id="2aa58-157">**Figure 4**: The Selected Products Will Be Deleted ([Click to view full-size image](batch-deleting-cs/_static/image8.png))</span></span>

<span data-ttu-id="2aa58-158">[![已刪除的產品 ProductID 值會列在 GridView 底下](batch-deleting-cs/_static/image5.gif)](batch-deleting-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="2aa58-158">[![The Deleted Products ProductID Values are Listed Beneath the GridView](batch-deleting-cs/_static/image5.gif)](batch-deleting-cs/_static/image9.png)</span></span>

<span data-ttu-id="2aa58-159">**圖 5**：已刪除的產品 `ProductID` 值會列在 GridView 底下（[按一下以觀看完整大小的影像](batch-deleting-cs/_static/image10.png)）</span><span class="sxs-lookup"><span data-stu-id="2aa58-159">**Figure 5**: The Deleted Products `ProductID` Values are Listed Beneath the GridView ([Click to view full-size image](batch-deleting-cs/_static/image10.png))</span></span>

> [!NOTE]
> <span data-ttu-id="2aa58-160">若要測試 `DeleteProductsWithTransaction` 方法的不可部分完成性，請在 [`Order Details`] 資料表中手動新增產品的專案，然後嘗試刪除該產品（以及其他）。</span><span class="sxs-lookup"><span data-stu-id="2aa58-160">To test the `DeleteProductsWithTransaction` method s atomicity, manually add an entry for a product in the `Order Details` table and then attempt to delete that product (along with others).</span></span> <span data-ttu-id="2aa58-161">當您嘗試刪除具有相關聯訂單的產品時，將會收到外鍵條件約束違規，但請注意其他選取的產品刪除如何復原。</span><span class="sxs-lookup"><span data-stu-id="2aa58-161">You will receive a foreign key constraint violation when attempting to delete the product with an associated order, but note how the other selected products deletions are rolled back.</span></span>

## <a name="summary"></a><span data-ttu-id="2aa58-162">總結</span><span class="sxs-lookup"><span data-stu-id="2aa58-162">Summary</span></span>

<span data-ttu-id="2aa58-163">建立批次刪除介面包括新增 GridView 與核取方塊的資料行，以及按鈕 Web 控制項，按一下時，會將所有選取的資料列刪除為單一不可部分完成的作業。</span><span class="sxs-lookup"><span data-stu-id="2aa58-163">Creating a batch deleting interface involves adding a GridView with a column of checkboxes and a Button Web control that, when clicked, will delete all of the selected rows as a single atomic operation.</span></span> <span data-ttu-id="2aa58-164">在本教學課程中，我們建立了這類介面，方法是 piecing 在兩個先前的教學課程中完成的工作，[新增 GridView 資料行的核取方塊](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-cs.md)，並將[資料庫修改包裝在交易中](wrapping-database-modifications-within-a-transaction-cs.md)。</span><span class="sxs-lookup"><span data-stu-id="2aa58-164">In this tutorial we built such an interface by piecing together work done in two previous tutorials, [Adding a GridView Column of Checkboxes](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-cs.md) and [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-cs.md).</span></span> <span data-ttu-id="2aa58-165">在第一個教學課程中，我們建立了一個 GridView，其中含有核取方塊的資料行，而在後者中，我們實作為 BLL 中的方法，當傳遞 `ProductID` 值的 `List<T>` 時，就會在交易的範圍內全部刪除。</span><span class="sxs-lookup"><span data-stu-id="2aa58-165">In the first tutorial we created a GridView with a column of checkboxes and in the latter we implemented a method in the BLL that, when passed a `List<T>` of `ProductID` values, deleted them all within the scope of a transaction.</span></span>

<span data-ttu-id="2aa58-166">在下一個教學課程中，我們將建立用來執行批次插入的介面。</span><span class="sxs-lookup"><span data-stu-id="2aa58-166">In the next tutorial we'll create an interface for performing batch inserts.</span></span>

<span data-ttu-id="2aa58-167">快樂的程式設計！</span><span class="sxs-lookup"><span data-stu-id="2aa58-167">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="2aa58-168">關於作者</span><span class="sxs-lookup"><span data-stu-id="2aa58-168">About the Author</span></span>

<span data-ttu-id="2aa58-169">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，自1998起，有七個 ASP/ASP. NET 書籍和創辦人的[4GuysFromRolla.com](http://www.4guysfromrolla.com)。</span><span class="sxs-lookup"><span data-stu-id="2aa58-169">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="2aa58-170">Scott 以獨立的顧問、訓練員和作者的身分運作。</span><span class="sxs-lookup"><span data-stu-id="2aa58-170">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="2aa58-171">他的最新著作是[*在24小時內讓自己的 ASP.NET 2.0*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="2aa58-171">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="2aa58-172">他可以在mitchell@4GuysFromRolla.com觸達[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="2aa58-172">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="2aa58-173">或者透過他的 blog，可以在[http://ScottOnWriting.NET](http://ScottOnWriting.NET)找到。</span><span class="sxs-lookup"><span data-stu-id="2aa58-173">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="2aa58-174">特別感謝</span><span class="sxs-lookup"><span data-stu-id="2aa58-174">Special Thanks To</span></span>

<span data-ttu-id="2aa58-175">本教學課程系列已由許多有用的審核者所審查。</span><span class="sxs-lookup"><span data-stu-id="2aa58-175">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="2aa58-176">本教學課程的領導審查者為 Hilton Giesenow 和 Teresa Murphy。</span><span class="sxs-lookup"><span data-stu-id="2aa58-176">Lead reviewers for this tutorial were Hilton Giesenow and Teresa Murphy.</span></span> <span data-ttu-id="2aa58-177">有興趣複習我即將發行的 MSDN 文章嗎？</span><span class="sxs-lookup"><span data-stu-id="2aa58-177">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="2aa58-178">若是如此，請在mitchell@4GuysFromRolla.com的那一行下拉式[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="2aa58-178">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="2aa58-179">[上一頁](batch-updating-cs.md)
> [下一頁](batch-inserting-cs.md)</span><span class="sxs-lookup"><span data-stu-id="2aa58-179">[Previous](batch-updating-cs.md)
[Next](batch-inserting-cs.md)</span></span>
