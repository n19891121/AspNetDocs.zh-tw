---
uid: web-forms/overview/data-access/caching-data/caching-data-with-the-objectdatasource-cs
title: 使用 ObjectDataSource （C#）快取資料 |Microsoft Docs
author: rick-anderson
description: 快取可以表示慢速和快速 Web 應用程式之間的差異。 本教學課程是四個中的第一個，深入探討 ASP.NET 中的快取 。
ms.author: riande
ms.date: 05/30/2007
ms.assetid: bd87413c-8160-4520-a8a2-43b555c4183a
msc.legacyurl: /web-forms/overview/data-access/caching-data/caching-data-with-the-objectdatasource-cs
msc.type: authoredcontent
ms.openlocfilehash: c9883314d6153b9816d9bad2a281ab3c0a816448
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/06/2020
ms.locfileid: "78524252"
---
# <a name="caching-data-with-the-objectdatasource-c"></a><span data-ttu-id="05af0-104">使用 ObjectDataSource 快取資料 (C#)</span><span class="sxs-lookup"><span data-stu-id="05af0-104">Caching Data with the ObjectDataSource (C#)</span></span>

<span data-ttu-id="05af0-105">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="05af0-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="05af0-106">[下載範例應用程式](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_58_CS.exe)或[下載 PDF](caching-data-with-the-objectdatasource-cs/_static/datatutorial58cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="05af0-106">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_58_CS.exe) or [Download PDF](caching-data-with-the-objectdatasource-cs/_static/datatutorial58cs1.pdf)</span></span>

> <span data-ttu-id="05af0-107">快取可以表示慢速和快速 Web 應用程式之間的差異。</span><span class="sxs-lookup"><span data-stu-id="05af0-107">Caching can mean the difference between a slow and a fast Web application.</span></span> <span data-ttu-id="05af0-108">本教學課程是四個中的第一個，深入探討 ASP.NET 中的快取。</span><span class="sxs-lookup"><span data-stu-id="05af0-108">This tutorial is the first of four that take a detailed look at caching in ASP.NET.</span></span> <span data-ttu-id="05af0-109">瞭解快取的重要概念，以及如何透過 ObjectDataSource 控制項將快取套用至展示層。</span><span class="sxs-lookup"><span data-stu-id="05af0-109">Learn the key concepts of caching and how to apply caching to the Presentation Layer through the ObjectDataSource control.</span></span>

## <a name="introduction"></a><span data-ttu-id="05af0-110">簡介</span><span class="sxs-lookup"><span data-stu-id="05af0-110">Introduction</span></span>

<span data-ttu-id="05af0-111">在「電腦科學」中，快取是取得資料或資訊的*程式，此*程式會耗用大量資源，並將其複本儲存在更快速存取的位置。</span><span class="sxs-lookup"><span data-stu-id="05af0-111">In computer science, *caching* is the process of taking data or information that is expensive to obtain and storing a copy of it in a location that is quicker to access.</span></span> <span data-ttu-id="05af0-112">對於資料驅動的應用程式，大型和複雜的查詢通常會耗用大部分的應用程式執行時間。</span><span class="sxs-lookup"><span data-stu-id="05af0-112">For data-driven applications, large and complex queries commonly consume the majority of the application s execution time.</span></span> <span data-ttu-id="05af0-113">然後，在應用程式記憶體中儲存昂貴資料庫查詢的結果，通常可以改善這類應用程式的效能。</span><span class="sxs-lookup"><span data-stu-id="05af0-113">Such an application s performance, then, can often be improved by storing the results of expensive database queries in the application s memory.</span></span>

<span data-ttu-id="05af0-114">ASP.NET 2.0 提供各種快取選項。</span><span class="sxs-lookup"><span data-stu-id="05af0-114">ASP.NET 2.0 offers a variety of caching options.</span></span> <span data-ttu-id="05af0-115">整個網頁或使用者控制項的呈現標記都可以透過*輸出*快取進行快取。</span><span class="sxs-lookup"><span data-stu-id="05af0-115">An entire web page or User Control s rendered markup can be cached through *output caching*.</span></span> <span data-ttu-id="05af0-116">ObjectDataSource 和 SqlDataSource 控制項也提供快取功能，因此可讓資料在控制項層級進行快取。</span><span class="sxs-lookup"><span data-stu-id="05af0-116">The ObjectDataSource and SqlDataSource controls provide caching capabilities as well, thereby allowing data to be cached at the control level.</span></span> <span data-ttu-id="05af0-117">和 ASP.NET 的*資料*快取提供豐富的快取 API，可讓網頁開發人員以程式設計方式快取物件。</span><span class="sxs-lookup"><span data-stu-id="05af0-117">And ASP.NET s *data cache* provides a rich caching API that enables page developers to programmatically cache objects.</span></span> <span data-ttu-id="05af0-118">在本教學課程和接下來的三個中，我們將使用 ObjectDataSource s 快取功能以及資料快取來進行檢查。</span><span class="sxs-lookup"><span data-stu-id="05af0-118">In this tutorial and the next three we'll examine using the ObjectDataSource s caching features as well as the data cache.</span></span> <span data-ttu-id="05af0-119">我們也會探索如何在啟動時快取整個應用程式的資料，以及如何使用 SQL 快取相依性將快取的資料保持在最新。</span><span class="sxs-lookup"><span data-stu-id="05af0-119">We'll also explore how to cache application-wide data at startup and how to keep cached data fresh through the use of SQL cache dependencies.</span></span> <span data-ttu-id="05af0-120">這些教學課程不會探索輸出快取。</span><span class="sxs-lookup"><span data-stu-id="05af0-120">These tutorials do not explore output caching.</span></span> <span data-ttu-id="05af0-121">如需輸出快取的詳細資訊，請參閱[ASP.NET 2.0 中的輸出](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx)快取。</span><span class="sxs-lookup"><span data-stu-id="05af0-121">For a detailed look at output caching, see [Output Caching in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx).</span></span>

<span data-ttu-id="05af0-122">您可以在架構中的任何位置套用快取，從資料存取層到展示層。</span><span class="sxs-lookup"><span data-stu-id="05af0-122">Caching can be applied at any place in the architecture, from the Data Access Layer up through the Presentation Layer.</span></span> <span data-ttu-id="05af0-123">在本教學課程中，我們將探討如何透過 ObjectDataSource 控制項將快取套用至展示層。</span><span class="sxs-lookup"><span data-stu-id="05af0-123">In this tutorial we'll look at applying caching to the Presentation Layer through the ObjectDataSource control.</span></span> <span data-ttu-id="05af0-124">在下一個教學課程中，我們將檢查商業邏輯層的快取資料。</span><span class="sxs-lookup"><span data-stu-id="05af0-124">In the next tutorial we'll examine caching data at the Business Logic Layer.</span></span>

## <a name="key-caching-concepts"></a><span data-ttu-id="05af0-125">金鑰快取概念</span><span class="sxs-lookup"><span data-stu-id="05af0-125">Key Caching Concepts</span></span>

<span data-ttu-id="05af0-126">快取可以藉由將產生並儲存其複本的資料複製到可更有效率存取的位置，大幅提升應用程式的整體效能和擴充性。</span><span class="sxs-lookup"><span data-stu-id="05af0-126">Caching can greatly improve an application s overall performance and scalability by taking data that is expensive to generate and storing a copy of it in a location that can be more efficiently accessed.</span></span> <span data-ttu-id="05af0-127">由於快取只會保存實際的基礎資料複本，因此如果基礎資料變更，它可能會過時或*過時*。</span><span class="sxs-lookup"><span data-stu-id="05af0-127">Since the cache holds just a copy of the actual, underlying data, it can become outdated, or *stale*, if the underlying data changes.</span></span> <span data-ttu-id="05af0-128">若要對抗這種情況，頁面開發人員可以使用下列其中一種方式，指出將從快取中*收回*快取專案的準則：</span><span class="sxs-lookup"><span data-stu-id="05af0-128">To combat this, a page developer can indicate criteria by which the cache item will be *evicted* from the cache, using either:</span></span>

- <span data-ttu-id="05af0-129">以**時間為基礎的準則**：可將專案新增至快取中的絕對或滑動持續時間。</span><span class="sxs-lookup"><span data-stu-id="05af0-129">**Time-based criteria** an item may be added to the cache for an absolute or sliding duration.</span></span> <span data-ttu-id="05af0-130">例如，網頁開發人員可能會指出持續時間（例如60秒）。</span><span class="sxs-lookup"><span data-stu-id="05af0-130">For example, a page developer may indicate a duration of, say, 60 seconds.</span></span> <span data-ttu-id="05af0-131">在絕對持續期間，快取的專案會在新增至快取後的60秒收回，不論存取的頻率為何。</span><span class="sxs-lookup"><span data-stu-id="05af0-131">With an absolute duration, the cached item is evicted 60 seconds after it was added to cache, regardless of how frequently it was accessed.</span></span> <span data-ttu-id="05af0-132">在滑動期間，快取的專案會在上次存取後的60秒收回。</span><span class="sxs-lookup"><span data-stu-id="05af0-132">With a sliding duration, the cached item is evicted 60 seconds after the last access.</span></span>
- <span data-ttu-id="05af0-133">以相依性為**基礎的準則**：在新增至快取時，相依性可以與專案產生關聯。</span><span class="sxs-lookup"><span data-stu-id="05af0-133">**Dependency-based criteria** a dependency can be associated with an item when added to the cache.</span></span> <span data-ttu-id="05af0-134">當專案的相依性變更時，它會從快取中收回。</span><span class="sxs-lookup"><span data-stu-id="05af0-134">When the item s dependency changes it is evicted from the cache.</span></span> <span data-ttu-id="05af0-135">相依性可能是檔案、另一個快取專案或兩者的組合。</span><span class="sxs-lookup"><span data-stu-id="05af0-135">The dependency may be a file, another cache item, or a combination of the two.</span></span> <span data-ttu-id="05af0-136">ASP.NET 2.0 也允許 SQL 快取相依性，這可讓開發人員將專案新增至快取，並在基礎資料庫資料變更時將它收回。</span><span class="sxs-lookup"><span data-stu-id="05af0-136">ASP.NET 2.0 also allows SQL cache dependencies, which enable developers to add an item to the cache and have it evicted when the underlying database data changes.</span></span> <span data-ttu-id="05af0-137">我們將在未來的[使用 sql](using-sql-cache-dependencies-cs.md)快取相依性教學課程中，檢查 sql 快取相依性。</span><span class="sxs-lookup"><span data-stu-id="05af0-137">We will examine SQL cache dependencies in the upcoming [Using SQL Cache Dependencies](using-sql-cache-dependencies-cs.md) tutorial.</span></span>

<span data-ttu-id="05af0-138">不論指定的收回準則為何，快取中的專案可能會在符合以時間為基礎或以相依性為基礎的準則之前*清除*。</span><span class="sxs-lookup"><span data-stu-id="05af0-138">Regardless of the eviction criteria specified, an item in the cache may be *scavenged* before the time-based or dependency-based criteria has been met.</span></span> <span data-ttu-id="05af0-139">如果快取已達到其容量，就必須先移除現有的專案，才能新增新的專案。</span><span class="sxs-lookup"><span data-stu-id="05af0-139">If the cache has reached its capacity, existing items must be removed before new ones can be added.</span></span> <span data-ttu-id="05af0-140">因此，以程式設計方式處理快取的資料時，您一定會認為快取的資料可能不存在。</span><span class="sxs-lookup"><span data-stu-id="05af0-140">Consequently, when programmatically working with cached data it s vital that you always assume that the cached data may not be present.</span></span> <span data-ttu-id="05af0-141">我們將探討在下一個教學課程中以程式設計方式從快取存取資料時所要使用的模式，在架構中快取*資料*。</span><span class="sxs-lookup"><span data-stu-id="05af0-141">We'll look at the pattern to use when accessing data from the cache programmatically in our next tutorial, *Caching Data in the Architecture*.</span></span>

<span data-ttu-id="05af0-142">快取提供經濟實惠的方法，讓應用程式的效能更高。</span><span class="sxs-lookup"><span data-stu-id="05af0-142">Caching provides an economical means for squeezing more performance from an application.</span></span> <span data-ttu-id="05af0-143">[Steven Smith](http://aspadvice.com/blogs/ssmith/)闡述在他的文章中[ASP.NET Caching：技術和最佳作法](https://msdn.microsoft.com/library/aa478965.aspx)：</span><span class="sxs-lookup"><span data-stu-id="05af0-143">As [Steven Smith](http://aspadvice.com/blogs/ssmith/) articulates in his article [ASP.NET Caching: Techniques and Best Practices](https://msdn.microsoft.com/library/aa478965.aspx):</span></span>

<span data-ttu-id="05af0-144">快取可能是取得足夠效能的好方法，而不需要大量時間和分析。</span><span class="sxs-lookup"><span data-stu-id="05af0-144">Caching can be a good way to get good enough performance without requiring a lot of time and analysis.</span></span> <span data-ttu-id="05af0-145">記憶體的成本很低，因此如果您可以快取30秒的輸出，而不是花費一天或一周的時間來優化您的程式碼或資料庫，請執行 caching 解決方案（假設有30秒的舊資料沒問題），然後繼續進行。</span><span class="sxs-lookup"><span data-stu-id="05af0-145">Memory is cheap, so if you can get the performance you need by caching the output for 30 seconds instead of spending a day or a week trying to optimize your code or database, do the caching solution (assuming 30-second old data is ok) and move on.</span></span> <span data-ttu-id="05af0-146">最後，不良的設計可能會趕上您，因此您應該嘗試正確地設計應用程式。</span><span class="sxs-lookup"><span data-stu-id="05af0-146">Eventually, poor design will probably catch up to you, so of course you should try to design your applications correctly.</span></span> <span data-ttu-id="05af0-147">但是，如果您現在只需要取得足夠的效能，快取就會是絕佳的 [方法]，讓您在日後有時間執行此動作時，為您購買應用程式的時間。</span><span class="sxs-lookup"><span data-stu-id="05af0-147">But if you just need to get good enough performance today, caching can be an excellent [approach], buying you time to refactor your application at a later date when you have the time to do so.</span></span>

<span data-ttu-id="05af0-148">雖然快取可以提供明顯的效能增強功能，但在所有情況下都不適用，例如使用即時、經常更新資料的應用程式，或甚至是即將過期的資料無法接受。</span><span class="sxs-lookup"><span data-stu-id="05af0-148">While caching can provide appreciable performance enhancements, it is not applicable in all situations, such as with applications that use real-time, frequently-updating data, or where even shortly-lived stale data is unacceptable.</span></span> <span data-ttu-id="05af0-149">但對於大部分的應用程式，應該使用快取。</span><span class="sxs-lookup"><span data-stu-id="05af0-149">But for the majority of applications, caching should be used.</span></span> <span data-ttu-id="05af0-150">如需 ASP.NET 2.0 中快取的更多背景資訊，請參閱[ASP.NET 2.0 快速入門教學](https://quickstarts.asp.net/QuickStartv20/aspnet/)課程的快取[效能](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/default.aspx)一節。</span><span class="sxs-lookup"><span data-stu-id="05af0-150">For more background on caching in ASP.NET 2.0, refer to the [Caching for Performance](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/default.aspx) section of the [ASP.NET 2.0 QuickStart Tutorials](https://quickstarts.asp.net/QuickStartv20/aspnet/).</span></span>

## <a name="step-1-creating-the-caching-web-pages"></a><span data-ttu-id="05af0-151">步驟1：建立快取網頁</span><span class="sxs-lookup"><span data-stu-id="05af0-151">Step 1: Creating the Caching Web Pages</span></span>

<span data-ttu-id="05af0-152">開始探索 ObjectDataSource s 快取功能之前，讓我們先花點時間在我們的網站專案中建立 ASP.NET 網頁，我們將在本教學課程和接下來的三篇中使用。</span><span class="sxs-lookup"><span data-stu-id="05af0-152">Before we start our exploration of the ObjectDataSource s caching features, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="05af0-153">從新增名為 `Caching`的資料夾開始。</span><span class="sxs-lookup"><span data-stu-id="05af0-153">Start by adding a new folder named `Caching`.</span></span> <span data-ttu-id="05af0-154">接下來，將下列 ASP.NET 網頁新增至該資料夾，並確定每個頁面都與 `Site.master` 主版頁面相關聯：</span><span class="sxs-lookup"><span data-stu-id="05af0-154">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `ObjectDataSource.aspx`
- `FromTheArchitecture.aspx`
- `AtApplicationStartup.aspx`
- `SqlCacheDependencies.aspx`

![新增快取相關教學課程的 ASP.NET 網頁](caching-data-with-the-objectdatasource-cs/_static/image1.png)

<span data-ttu-id="05af0-156">**圖 1**：新增快取相關教學課程的 ASP.NET 網頁</span><span class="sxs-lookup"><span data-stu-id="05af0-156">**Figure 1**: Add the ASP.NET Pages for the Caching-Related Tutorials</span></span>

<span data-ttu-id="05af0-157">如同在其他資料夾中，[`Caching`] 資料夾中的 `Default.aspx` 會在其區段中列出教學課程。</span><span class="sxs-lookup"><span data-stu-id="05af0-157">Like in the other folders, `Default.aspx` in the `Caching` folder will list the tutorials in its section.</span></span> <span data-ttu-id="05af0-158">回想一下，`SectionLevelTutorialListing.ascx` 的使用者控制項會提供這種功能。</span><span class="sxs-lookup"><span data-stu-id="05af0-158">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="05af0-159">因此，請將這個使用者控制項加入至 `Default.aspx`，方法是將它從方案總管拖曳至頁面 s 設計檢視。</span><span class="sxs-lookup"><span data-stu-id="05af0-159">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>

<span data-ttu-id="05af0-160">[![圖2：將 SectionLevelTutorialListing 的 .ascx 使用者控制項新增至 default.aspx](caching-data-with-the-objectdatasource-cs/_static/image3.png)](caching-data-with-the-objectdatasource-cs/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="05af0-160">[![Figure 2: Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](caching-data-with-the-objectdatasource-cs/_static/image3.png)](caching-data-with-the-objectdatasource-cs/_static/image2.png)</span></span>

<span data-ttu-id="05af0-161">**圖 2**：圖2：將 `SectionLevelTutorialListing.ascx` 使用者控制項加入 `Default.aspx` （[按一下以查看完整大小的影像](caching-data-with-the-objectdatasource-cs/_static/image4.png)）</span><span class="sxs-lookup"><span data-stu-id="05af0-161">**Figure 2**: Figure 2: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](caching-data-with-the-objectdatasource-cs/_static/image4.png))</span></span>

<span data-ttu-id="05af0-162">最後，將這些頁面新增為 `Web.sitemap` 檔案的專案。</span><span class="sxs-lookup"><span data-stu-id="05af0-162">Lastly, add these pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="05af0-163">具體而言，請在使用二進位資料 `<siteMapNode>`之後，加入下列標記：</span><span class="sxs-lookup"><span data-stu-id="05af0-163">Specifically, add the following markup after the Working with Binary Data `<siteMapNode>`:</span></span>

[!code-xml[Main](caching-data-with-the-objectdatasource-cs/samples/sample1.xml)]

<span data-ttu-id="05af0-164">更新 `Web.sitemap`之後，請花一點時間透過瀏覽器來觀看教學課程網站。</span><span class="sxs-lookup"><span data-stu-id="05af0-164">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="05af0-165">左側功能表現在包含快取教學課程的專案。</span><span class="sxs-lookup"><span data-stu-id="05af0-165">The menu on the left now includes items for the caching tutorials.</span></span>

![網站地圖現在包含快取教學課程的專案](caching-data-with-the-objectdatasource-cs/_static/image5.png)

<span data-ttu-id="05af0-167">[**圖 3**]：網站地圖現在包含快取教學課程的專案</span><span class="sxs-lookup"><span data-stu-id="05af0-167">**Figure 3**: The Site Map Now Includes Entries for the Caching Tutorials</span></span>

## <a name="step-2-displaying-a-list-of-products-in-a-web-page"></a><span data-ttu-id="05af0-168">步驟2：在網頁中顯示產品清單</span><span class="sxs-lookup"><span data-stu-id="05af0-168">Step 2: Displaying a List of Products in a Web Page</span></span>

<span data-ttu-id="05af0-169">本教學課程會探索如何使用 ObjectDataSource control s 內建快取功能。</span><span class="sxs-lookup"><span data-stu-id="05af0-169">This tutorial explores how to use the ObjectDataSource control s built-in caching features.</span></span> <span data-ttu-id="05af0-170">不過，在我們可以查看這些功能之前，我們先需要一個可供使用的頁面。</span><span class="sxs-lookup"><span data-stu-id="05af0-170">Before we can look at these features, though, we first need a page to work from.</span></span> <span data-ttu-id="05af0-171">讓我們建立一個網頁，使用 GridView 列出由 `ProductsBLL` 類別的 ObjectDataSource 所抓取的產品資訊。</span><span class="sxs-lookup"><span data-stu-id="05af0-171">Let s create a web page that uses a GridView to list product information retrieved by an ObjectDataSource from the `ProductsBLL` class.</span></span>

<span data-ttu-id="05af0-172">從開啟 [`Caching`] 資料夾中的 [`ObjectDataSource.aspx`] 頁面開始。</span><span class="sxs-lookup"><span data-stu-id="05af0-172">Start by opening the `ObjectDataSource.aspx` page in the `Caching` folder.</span></span> <span data-ttu-id="05af0-173">將 GridView 從 [工具箱] 拖曳至設計工具，將其 [`ID`] 屬性設定為 [`Products`]，然後從其智慧標籤，選擇將其系結至名為 `ProductsDataSource`的新 ObjectDataSource 控制項。</span><span class="sxs-lookup"><span data-stu-id="05af0-173">Drag a GridView from the Toolbox onto the Designer, set its `ID` property to `Products`, and, from its smart tag, choose to bind it to a new ObjectDataSource control named `ProductsDataSource`.</span></span> <span data-ttu-id="05af0-174">設定 ObjectDataSource 以與 `ProductsBLL` 類別搭配使用。</span><span class="sxs-lookup"><span data-stu-id="05af0-174">Configure the ObjectDataSource to work with the `ProductsBLL` class.</span></span>

<span data-ttu-id="05af0-175">[![將 ObjectDataSource 設定為使用 ProductsBLL 類別](caching-data-with-the-objectdatasource-cs/_static/image7.png)](caching-data-with-the-objectdatasource-cs/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="05af0-175">[![Configure the ObjectDataSource to Use the ProductsBLL Class](caching-data-with-the-objectdatasource-cs/_static/image7.png)](caching-data-with-the-objectdatasource-cs/_static/image6.png)</span></span>

<span data-ttu-id="05af0-176">**圖 4**：設定 ObjectDataSource 使用 `ProductsBLL` 類別（[按一下以查看完整大小的影像](caching-data-with-the-objectdatasource-cs/_static/image8.png)）</span><span class="sxs-lookup"><span data-stu-id="05af0-176">**Figure 4**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](caching-data-with-the-objectdatasource-cs/_static/image8.png))</span></span>

<span data-ttu-id="05af0-177">在此頁面中，我們將建立可編輯的 GridView，讓我們可以檢查 ObjectDataSource 中快取的資料是透過 GridView 的介面修改時所發生的情況。</span><span class="sxs-lookup"><span data-stu-id="05af0-177">For this page, let s create an editable GridView so that we can examine what happens when data cached in the ObjectDataSource is modified through the GridView s interface.</span></span> <span data-ttu-id="05af0-178">將 [選取] 索引標籤中的下拉式清單保留為預設值 `GetProducts()`，但將 [更新] 索引標籤中選取的專案變更為接受 `productName`、`unitPrice`和 `productID` 做為其輸入參數的 `UpdateProduct` 多載。</span><span class="sxs-lookup"><span data-stu-id="05af0-178">Leave the drop-down list in the SELECT tab set to its default, `GetProducts()`, but change the selected item in the UPDATE tab to the `UpdateProduct` overload that accepts `productName`, `unitPrice`, and `productID` as its input parameters.</span></span>

<span data-ttu-id="05af0-179">[![將 [更新] 索引標籤 s 下拉式清單設定為適當的 UpdateProduct 多載](caching-data-with-the-objectdatasource-cs/_static/image10.png)](caching-data-with-the-objectdatasource-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="05af0-179">[![Set the UPDATE Tab s Drop-Down List to the Appropriate UpdateProduct Overload](caching-data-with-the-objectdatasource-cs/_static/image10.png)](caching-data-with-the-objectdatasource-cs/_static/image9.png)</span></span>

<span data-ttu-id="05af0-180">**圖 5**：將 [更新] 索引標籤 s 下拉式清單設定為適當的 `UpdateProduct` 多載（[按一下以查看完整大小的影像](caching-data-with-the-objectdatasource-cs/_static/image11.png)）</span><span class="sxs-lookup"><span data-stu-id="05af0-180">**Figure 5**: Set the UPDATE Tab s Drop-Down List to the Appropriate `UpdateProduct` Overload ([Click to view full-size image](caching-data-with-the-objectdatasource-cs/_static/image11.png))</span></span>

<span data-ttu-id="05af0-181">最後，將 [插入] 和 [刪除] 索引標籤中的下拉式清單設定為 [（無）]，然後按一下 [完成]。</span><span class="sxs-lookup"><span data-stu-id="05af0-181">Finally, set the drop-down lists in the INSERT and DELETE tabs to (None) and click Finish.</span></span> <span data-ttu-id="05af0-182">完成 [設定資料來源] 時，Visual Studio 會將 ObjectDataSource 的 `OldValuesParameterFormatString` 屬性設定為 [`original_{0}`]。</span><span class="sxs-lookup"><span data-stu-id="05af0-182">Upon completing the Configure Data Source wizard, Visual Studio sets the ObjectDataSource s `OldValuesParameterFormatString` property to `original_{0}`.</span></span> <span data-ttu-id="05af0-183">如如何[插入、更新和刪除資料](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md)教學課程中所述，您必須從宣告式語法中移除此屬性，或將其設回預設值 `{0}`，才能讓更新工作流程繼續進行，而不會發生錯誤。</span><span class="sxs-lookup"><span data-stu-id="05af0-183">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) tutorial, this property needs to be removed from the declarative syntax or set back to its default value, `{0}`, in order for our update workflow to proceed without error.</span></span>

<span data-ttu-id="05af0-184">此外，當 wizard 完成時 Visual Studio 會針對每個產品資料欄位，將欄位加入至 GridView。</span><span class="sxs-lookup"><span data-stu-id="05af0-184">Furthermore, at the completion of the wizard Visual Studio adds a field to the GridView for each of the product data fields.</span></span> <span data-ttu-id="05af0-185">移除 `ProductName`、`CategoryName`和 `UnitPrice` BoundFields 以外的所有。</span><span class="sxs-lookup"><span data-stu-id="05af0-185">Remove all but the `ProductName`, `CategoryName`, and `UnitPrice` BoundFields.</span></span> <span data-ttu-id="05af0-186">接下來，分別將每個 BoundFields 的 `HeaderText` 屬性更新為 [產品]、[類別] 和 [價格]。</span><span class="sxs-lookup"><span data-stu-id="05af0-186">Next, update the `HeaderText` properties of each of these BoundFields to Product, Category, and Price, respectively.</span></span> <span data-ttu-id="05af0-187">因為 `ProductName` 欄位是必要的，所以請將 BoundField 轉換成 TemplateField，並將 RequiredFieldValidator 新增至 `EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="05af0-187">Since the `ProductName` field is required, convert the BoundField into a TemplateField and add a RequiredFieldValidator to the `EditItemTemplate`.</span></span> <span data-ttu-id="05af0-188">同樣地，將 `UnitPrice` BoundField 轉換成 TemplateField 並加入 CompareValidator，以確保使用者輸入的值是大於或等於零的有效貨幣值。</span><span class="sxs-lookup"><span data-stu-id="05af0-188">Similarly, convert the `UnitPrice` BoundField into a TemplateField and add a CompareValidator to ensure that the value entered by the user is a valid currency value that s greater than or equal to zero.</span></span> <span data-ttu-id="05af0-189">除了這些修改以外，您可以隨意執行任何美觀變更，例如靠右對齊 `UnitPrice` 值，或指定其唯讀和編輯介面中 `UnitPrice` 文字的格式。</span><span class="sxs-lookup"><span data-stu-id="05af0-189">In addition to these modifications, feel free to perform any aesthetic changes, such as right-aligning the `UnitPrice` value, or specifying the formatting for the `UnitPrice` text in its read-only and editing interfaces.</span></span>

<span data-ttu-id="05af0-190">勾選 GridView s 智慧標籤中的 [啟用編輯] 核取方塊，讓 GridView 可供編輯。</span><span class="sxs-lookup"><span data-stu-id="05af0-190">Make the GridView editable by checking the Enable Editing checkbox in the GridView s smart tag.</span></span> <span data-ttu-id="05af0-191">另請核取 [啟用分頁] 和 [啟用排序] 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="05af0-191">Also check the Enable Paging and Enable Sorting checkboxes.</span></span>

> [!NOTE]
> <span data-ttu-id="05af0-192">需要複習如何自訂 GridView 的編輯介面？</span><span class="sxs-lookup"><span data-stu-id="05af0-192">Need a review of how to customize the GridView s editing interface?</span></span> <span data-ttu-id="05af0-193">若是如此，請回頭參閱[自訂資料修改介面](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md)教學課程。</span><span class="sxs-lookup"><span data-stu-id="05af0-193">If so, refer back to the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md) tutorial.</span></span>

<span data-ttu-id="05af0-194">[![啟用 GridView 的編輯、排序和分頁支援](caching-data-with-the-objectdatasource-cs/_static/image13.png)](caching-data-with-the-objectdatasource-cs/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="05af0-194">[![Enable GridView Support for Editing, Sorting, and Paging](caching-data-with-the-objectdatasource-cs/_static/image13.png)](caching-data-with-the-objectdatasource-cs/_static/image12.png)</span></span>

<span data-ttu-id="05af0-195">**圖 6**：啟用 GridView 支援以進行編輯、排序和分頁（[按一下以查看完整大小的影像](caching-data-with-the-objectdatasource-cs/_static/image14.png)）</span><span class="sxs-lookup"><span data-stu-id="05af0-195">**Figure 6**: Enable GridView Support for Editing, Sorting, and Paging ([Click to view full-size image](caching-data-with-the-objectdatasource-cs/_static/image14.png))</span></span>

<span data-ttu-id="05af0-196">進行這些 GridView 修改之後，GridView 和 ObjectDataSource 的宣告式標記看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="05af0-196">After making these GridView modifications, the GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](caching-data-with-the-objectdatasource-cs/samples/sample2.aspx)]

<span data-ttu-id="05af0-197">如 [圖 7] 所示，可編輯的 GridView 會列出資料庫中每個產品的名稱、類別和價格。</span><span class="sxs-lookup"><span data-stu-id="05af0-197">As Figure 7 shows, the editable GridView lists the name, category, and price of each of the products in the database.</span></span> <span data-ttu-id="05af0-198">請花點時間測試頁面的功能排序結果、逐頁流覽，然後編輯記錄。</span><span class="sxs-lookup"><span data-stu-id="05af0-198">Take a moment to test out the page s functionality sort the results, page through them, and edit a record.</span></span>

<span data-ttu-id="05af0-199">[![每個產品的名稱、類別和價格都會列在可排序、可分頁、可編輯的 GridView 中](caching-data-with-the-objectdatasource-cs/_static/image16.png)](caching-data-with-the-objectdatasource-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="05af0-199">[![Each Product s Name, Category, and Price is Listed in a Sortable, Pageable, Editable GridView](caching-data-with-the-objectdatasource-cs/_static/image16.png)](caching-data-with-the-objectdatasource-cs/_static/image15.png)</span></span>

<span data-ttu-id="05af0-200">**圖 7**：每個產品的名稱、類別和價格都會列在可排序、可分頁、可編輯的 GridView 中（[按一下以查看完整大小的影像](caching-data-with-the-objectdatasource-cs/_static/image17.png)）</span><span class="sxs-lookup"><span data-stu-id="05af0-200">**Figure 7**: Each Product s Name, Category, and Price is Listed in a Sortable, Pageable, Editable GridView ([Click to view full-size image](caching-data-with-the-objectdatasource-cs/_static/image17.png))</span></span>

## <a name="step-3-examining-when-the-objectdatasource-is-requesting-data"></a><span data-ttu-id="05af0-201">步驟3：檢查 ObjectDataSource 何時要求資料</span><span class="sxs-lookup"><span data-stu-id="05af0-201">Step 3: Examining When the ObjectDataSource is Requesting Data</span></span>

<span data-ttu-id="05af0-202">`Products` GridView 會藉由叫用 `ProductsDataSource` ObjectDataSource 的 `Select` 方法，來抓取其資料以顯示。</span><span class="sxs-lookup"><span data-stu-id="05af0-202">The `Products` GridView retrieves its data to display by invoking the `Select` method of the `ProductsDataSource` ObjectDataSource.</span></span> <span data-ttu-id="05af0-203">這個 ObjectDataSource 會建立 `ProductsBLL` 類別的商務邏輯層實例，並呼叫它的 `GetProducts()` 方法，然後再呼叫資料存取層 `ProductsTableAdapter` s `GetProducts()` 方法。</span><span class="sxs-lookup"><span data-stu-id="05af0-203">This ObjectDataSource creates an instance of the Business Logic Layer s `ProductsBLL` class and calls its `GetProducts()` method, which in turn calls the Data Access Layer s `ProductsTableAdapter` s `GetProducts()` method.</span></span> <span data-ttu-id="05af0-204">DAL 方法會連接到 Northwind 資料庫，併發出已設定的 `SELECT` 查詢。</span><span class="sxs-lookup"><span data-stu-id="05af0-204">The DAL method connects to the Northwind database and issues the configured `SELECT` query.</span></span> <span data-ttu-id="05af0-205">然後，這項資料會傳回到 DAL，並在 `NorthwindDataTable`中將它封裝在一起。</span><span class="sxs-lookup"><span data-stu-id="05af0-205">This data is then returned to the DAL, which packages it up in a `NorthwindDataTable`.</span></span> <span data-ttu-id="05af0-206">DataTable 物件會傳回給 BLL，其會將它傳回給 GridView，然後將它傳回給 GridView。</span><span class="sxs-lookup"><span data-stu-id="05af0-206">The DataTable object is returned to the BLL, which returns it to the ObjectDataSource, which returns it to the GridView.</span></span> <span data-ttu-id="05af0-207">然後 GridView 會為 DataTable 中的每個 `DataRow` 建立一個 `GridViewRow` 物件，而每個 `GridViewRow` 最終會轉譯成傳回給用戶端的 HTML，並顯示在造訪者的瀏覽器上。</span><span class="sxs-lookup"><span data-stu-id="05af0-207">The GridView then creates a `GridViewRow` object for each `DataRow` in the DataTable, and each `GridViewRow` is eventually rendered into the HTML that is returned to the client and displayed on the visitor s browser.</span></span>

<span data-ttu-id="05af0-208">每次 GridView 需要系結至其基礎資料時，就會發生這個事件順序。</span><span class="sxs-lookup"><span data-stu-id="05af0-208">This sequence of events happens each and every time the GridView needs to bind to its underlying data.</span></span> <span data-ttu-id="05af0-209">當第一次造訪頁面、在排序 GridView 時，或透過其內建編輯或刪除介面修改 GridView 的資料時，就會發生這種情況。</span><span class="sxs-lookup"><span data-stu-id="05af0-209">That happens when the page is first visited, when moving from one page of data to another, when sorting the GridView, or when modifying the GridView s data through its built-in editing or deleting interfaces.</span></span> <span data-ttu-id="05af0-210">如果 GridView s 檢視狀態為停用，則 GridView 也會在每次回傳時重新系結。</span><span class="sxs-lookup"><span data-stu-id="05af0-210">If the GridView s view state is disabled, the GridView will be rebound on each and every postback as well.</span></span> <span data-ttu-id="05af0-211">GridView 也可以藉由呼叫其 `DataBind()` 方法，明確地重新系結至其資料。</span><span class="sxs-lookup"><span data-stu-id="05af0-211">The GridView can also be explicitly rebound to its data by calling its `DataBind()` method.</span></span>

<span data-ttu-id="05af0-212">為了充分感謝從資料庫抓取資料的頻率，讓 s 顯示訊息，指出重新抓取資料的時間。</span><span class="sxs-lookup"><span data-stu-id="05af0-212">To fully appreciate the frequency with which the data is retrieved from the database, let s display a message indicating when the data is being re-retrieved.</span></span> <span data-ttu-id="05af0-213">在名為 `ODSEvents`的 GridView 上方新增標籤 Web 控制項。</span><span class="sxs-lookup"><span data-stu-id="05af0-213">Add a Label Web control above the GridView named `ODSEvents`.</span></span> <span data-ttu-id="05af0-214">清除其 [`Text`] 屬性，並將其 [`EnableViewState`] 屬性設定為 [`false`]。</span><span class="sxs-lookup"><span data-stu-id="05af0-214">Clear out its `Text` property and set its `EnableViewState` property to `false`.</span></span> <span data-ttu-id="05af0-215">在標籤底下，新增按鈕 Web 控制項，並將其 `Text` 屬性設為回傳。</span><span class="sxs-lookup"><span data-stu-id="05af0-215">Underneath the Label, add a Button Web control and set its `Text` property to Postback .</span></span>

<span data-ttu-id="05af0-216">[![將標籤和按鈕新增至 GridView 上方的頁面](caching-data-with-the-objectdatasource-cs/_static/image19.png)](caching-data-with-the-objectdatasource-cs/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="05af0-216">[![Add a Label and Button to the Page Above the GridView](caching-data-with-the-objectdatasource-cs/_static/image19.png)](caching-data-with-the-objectdatasource-cs/_static/image18.png)</span></span>

<span data-ttu-id="05af0-217">**圖 8**：將標籤和按鈕新增至 GridView 上方的頁面（[按一下以觀看完整大小的影像](caching-data-with-the-objectdatasource-cs/_static/image20.png)）</span><span class="sxs-lookup"><span data-stu-id="05af0-217">**Figure 8**: Add a Label and Button to the Page Above the GridView ([Click to view full-size image](caching-data-with-the-objectdatasource-cs/_static/image20.png))</span></span>

<span data-ttu-id="05af0-218">在資料存取工作流程期間，ObjectDataSource s `Selecting` 事件會在建立基礎物件並叫用其設定的方法之前引發。</span><span class="sxs-lookup"><span data-stu-id="05af0-218">During the data access workflow, the ObjectDataSource s `Selecting` event fires before the underlying object is created and its configured method invoked.</span></span> <span data-ttu-id="05af0-219">建立此事件的事件處理常式，並新增下列程式碼：</span><span class="sxs-lookup"><span data-stu-id="05af0-219">Create an event handler for this event and add the following code:</span></span>

[!code-csharp[Main](caching-data-with-the-objectdatasource-cs/samples/sample3.cs)]

<span data-ttu-id="05af0-220">每次 ObjectDataSource 對資料的架構提出要求時，標籤將會顯示 [選取事件引發] 的文字。</span><span class="sxs-lookup"><span data-stu-id="05af0-220">Each time the ObjectDataSource makes a request to the architecture for data, the Label will display the text Selecting event fired .</span></span>

<span data-ttu-id="05af0-221">在瀏覽器中造訪此頁面。</span><span class="sxs-lookup"><span data-stu-id="05af0-221">Visit this page in a browser.</span></span> <span data-ttu-id="05af0-222">第一次流覽頁面時，會顯示 [選取引發的事件] 文字。</span><span class="sxs-lookup"><span data-stu-id="05af0-222">When the page is first visited, the text Selecting event fired is shown.</span></span> <span data-ttu-id="05af0-223">按一下 [回傳] 按鈕，並注意文字會消失（假設 GridView 的 `EnableViewState` 屬性設定為 `true`（預設值）。</span><span class="sxs-lookup"><span data-stu-id="05af0-223">Click the Postback button and note that the text disappears (assuming that the GridView s `EnableViewState` property is set to `true`, the default).</span></span> <span data-ttu-id="05af0-224">這是因為在回傳時，GridView 會從其 view 狀態重建，因此不會針對其資料轉換成 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="05af0-224">This is because, on postback, the GridView is reconstructed from its view state and therefore doesn t turn to the ObjectDataSource for its data.</span></span> <span data-ttu-id="05af0-225">不過，排序、分頁或編輯資料會導致 GridView 重新系結至其資料來源，因此會重新出現選取事件引發的文字。</span><span class="sxs-lookup"><span data-stu-id="05af0-225">Sorting, paging, or editing the data, however, causes the GridView to rebind to its data source, and therefore the Selecting event fired text reappears.</span></span>

<span data-ttu-id="05af0-226">[![當 GridView 重新系結至其資料來源時，會顯示選取 [引發的事件]](caching-data-with-the-objectdatasource-cs/_static/image22.png)](caching-data-with-the-objectdatasource-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="05af0-226">[![Whenever the GridView is Rebound to its Data Source, Selecting event fired is Displayed](caching-data-with-the-objectdatasource-cs/_static/image22.png)](caching-data-with-the-objectdatasource-cs/_static/image21.png)</span></span>

<span data-ttu-id="05af0-227">**圖 9**：每當 GridView 重新系結至其資料來源時，就會顯示選取 [引發的事件] （[按一下以查看完整大小的影像](caching-data-with-the-objectdatasource-cs/_static/image23.png)）</span><span class="sxs-lookup"><span data-stu-id="05af0-227">**Figure 9**: Whenever the GridView is Rebound to its Data Source, Selecting event fired is Displayed ([Click to view full-size image](caching-data-with-the-objectdatasource-cs/_static/image23.png))</span></span>

<span data-ttu-id="05af0-228">[![按一下回傳按鈕，會導致 GridView 從其檢視狀態重新構建](caching-data-with-the-objectdatasource-cs/_static/image25.png)](caching-data-with-the-objectdatasource-cs/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="05af0-228">[![Clicking the Postback Button Causes the GridView to be Reconstructed from its View State](caching-data-with-the-objectdatasource-cs/_static/image25.png)](caching-data-with-the-objectdatasource-cs/_static/image24.png)</span></span>

<span data-ttu-id="05af0-229">**圖 10**：按一下回傳按鈕會導致 GridView 從其檢視狀態重新構建（[按一下以觀看完整大小的影像](caching-data-with-the-objectdatasource-cs/_static/image26.png)）</span><span class="sxs-lookup"><span data-stu-id="05af0-229">**Figure 10**: Clicking the Postback Button Causes the GridView to be Reconstructed from its View State ([Click to view full-size image](caching-data-with-the-objectdatasource-cs/_static/image26.png))</span></span>

<span data-ttu-id="05af0-230">每次資料經過分頁或進行排序時，抓取資料庫資料似乎會浪費。</span><span class="sxs-lookup"><span data-stu-id="05af0-230">It may seem wasteful to retrieve the database data each time the data is paged through or sorted.</span></span> <span data-ttu-id="05af0-231">畢竟，因為我們重新使用預設分頁，所以 ObjectDataSource 會在顯示第一頁時，抓取所有的記錄。</span><span class="sxs-lookup"><span data-stu-id="05af0-231">After all, since we re using default paging, the ObjectDataSource has retrieved all of the records when displaying the first page.</span></span> <span data-ttu-id="05af0-232">即使 GridView 並未提供排序和分頁支援，每次使用者第一次造訪頁面時，都必須從資料庫中取出資料（如果停用 view 狀態，則會在每個回傳上）。</span><span class="sxs-lookup"><span data-stu-id="05af0-232">Even if the GridView does not provide sorting and paging support, the data must be retrieved from the database each time the page is first visited by any user (and on every postback, if view state is disabled).</span></span> <span data-ttu-id="05af0-233">但是，如果 GridView 向所有使用者顯示相同的資料，這些額外的資料庫要求就是多餘的。</span><span class="sxs-lookup"><span data-stu-id="05af0-233">But if the GridView is showing the same data to all users, these extra database requests are superfluous.</span></span> <span data-ttu-id="05af0-234">為什麼不快取從 `GetProducts()` 方法傳回的結果，並將 GridView 系結至這些快取的結果？</span><span class="sxs-lookup"><span data-stu-id="05af0-234">Why not cache the results returned from the `GetProducts()` method and bind the GridView to those cached results?</span></span>

## <a name="step-4-caching-the-data-using-the-objectdatasource"></a><span data-ttu-id="05af0-235">步驟4：使用 ObjectDataSource 快取資料</span><span class="sxs-lookup"><span data-stu-id="05af0-235">Step 4: Caching the Data Using the ObjectDataSource</span></span>

<span data-ttu-id="05af0-236">藉由只設定幾個屬性，可以將 ObjectDataSource 設定為在 ASP.NET 資料快取中自動快取其抓取的資料。</span><span class="sxs-lookup"><span data-stu-id="05af0-236">By simply setting a few properties, the ObjectDataSource can be configured to automatically cache its retrieved data in the ASP.NET data cache.</span></span> <span data-ttu-id="05af0-237">下列清單摘要說明 ObjectDataSource 的快取相關屬性：</span><span class="sxs-lookup"><span data-stu-id="05af0-237">The following list summarizes the cache-related properties of the ObjectDataSource:</span></span>

- <span data-ttu-id="05af0-238">[EnableCaching](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.enablecaching.aspx)必須設定為 `true` 才能啟用快取。</span><span class="sxs-lookup"><span data-stu-id="05af0-238">[EnableCaching](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.enablecaching.aspx) must be set to `true` to enable caching.</span></span> <span data-ttu-id="05af0-239">預設為 `false`。</span><span class="sxs-lookup"><span data-stu-id="05af0-239">The default is `false`.</span></span>
- <span data-ttu-id="05af0-240">[CacheDuration](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheduration.aspx)快取資料的時間量（以秒為單位）。</span><span class="sxs-lookup"><span data-stu-id="05af0-240">[CacheDuration](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheduration.aspx) the amount of time, in seconds, that the data is cached.</span></span> <span data-ttu-id="05af0-241">預設值為 0。</span><span class="sxs-lookup"><span data-stu-id="05af0-241">The default is 0.</span></span> <span data-ttu-id="05af0-242">只有在 `true` `EnableCaching`，且 `CacheDuration` 設定為大於零的值時，ObjectDataSource 才會快取資料。</span><span class="sxs-lookup"><span data-stu-id="05af0-242">The ObjectDataSource will only cache data if `EnableCaching` is `true` and `CacheDuration` is set to a value greater than zero.</span></span>
- <span data-ttu-id="05af0-243">[CacheExpirationPolicy](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheexpirationpolicy.aspx)可以設定為 `Absolute` 或 `Sliding`。</span><span class="sxs-lookup"><span data-stu-id="05af0-243">[CacheExpirationPolicy](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheexpirationpolicy.aspx) can be set to `Absolute` or `Sliding`.</span></span> <span data-ttu-id="05af0-244">如果 `Absolute`，ObjectDataSource 會快取其抓取的資料達 `CacheDuration` 秒;如果 `Sliding`，則資料只有在未被存取 `CacheDuration` 秒之後才會到期。</span><span class="sxs-lookup"><span data-stu-id="05af0-244">If `Absolute`, the ObjectDataSource caches its retrieved data for `CacheDuration` seconds; if `Sliding`, the data expires only after it has not been accessed for `CacheDuration` seconds.</span></span> <span data-ttu-id="05af0-245">預設為 `Absolute`。</span><span class="sxs-lookup"><span data-stu-id="05af0-245">The default is `Absolute`.</span></span>
- <span data-ttu-id="05af0-246">[CacheKeyDependency](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cachekeydependency.aspx)使用此屬性，將 ObjectDataSource s 快取專案與現有的快取相依性產生關聯。</span><span class="sxs-lookup"><span data-stu-id="05af0-246">[CacheKeyDependency](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cachekeydependency.aspx) use this property to associate the ObjectDataSource s cache entries with an existing cache dependency.</span></span> <span data-ttu-id="05af0-247">ObjectDataSource 的資料項目可以藉由將其相關聯的 `CacheKeyDependency`過期，從快取中提前收回。</span><span class="sxs-lookup"><span data-stu-id="05af0-247">The ObjectDataSource s data entries can be prematurely evicted from the cache by expiring its associated `CacheKeyDependency`.</span></span> <span data-ttu-id="05af0-248">此屬性最常用於將 SQL 快取相依性與 ObjectDataSource s 快取建立關聯，我們將在未來[使用 SQL](using-sql-cache-dependencies-cs.md)快取相依性教學課程來探索該主題。</span><span class="sxs-lookup"><span data-stu-id="05af0-248">This property is most commonly used to associate a SQL cache dependency with the ObjectDataSource s cache, a topic we'll explore in the future [Using SQL Cache Dependencies](using-sql-cache-dependencies-cs.md) tutorial.</span></span>

<span data-ttu-id="05af0-249">讓我們將 `ProductsDataSource` ObjectDataSource 設定為在絕對規模上快取30秒的資料。</span><span class="sxs-lookup"><span data-stu-id="05af0-249">Let s configure the `ProductsDataSource` ObjectDataSource to cache its data for 30 seconds on an absolute scale.</span></span> <span data-ttu-id="05af0-250">將 [ObjectDataSource s `EnableCaching`] 屬性設定為 [`true`]，將其 [`CacheDuration`] 屬性設為30。</span><span class="sxs-lookup"><span data-stu-id="05af0-250">Set the ObjectDataSource s `EnableCaching` property to `true` and its `CacheDuration` property to 30.</span></span> <span data-ttu-id="05af0-251">將 [`CacheExpirationPolicy`] 屬性保持設定為預設值 [`Absolute`]。</span><span class="sxs-lookup"><span data-stu-id="05af0-251">Leave the `CacheExpirationPolicy` property set to its default, `Absolute`.</span></span>

<span data-ttu-id="05af0-252">[![將 ObjectDataSource 設定為快取其資料30秒](caching-data-with-the-objectdatasource-cs/_static/image28.png)](caching-data-with-the-objectdatasource-cs/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="05af0-252">[![Configure the ObjectDataSource to Cache its Data for 30 Seconds](caching-data-with-the-objectdatasource-cs/_static/image28.png)](caching-data-with-the-objectdatasource-cs/_static/image27.png)</span></span>

<span data-ttu-id="05af0-253">**圖 11**：設定 ObjectDataSource 快取其資料30秒（[按一下以查看完整大小的影像](caching-data-with-the-objectdatasource-cs/_static/image29.png)）</span><span class="sxs-lookup"><span data-stu-id="05af0-253">**Figure 11**: Configure the ObjectDataSource to Cache its Data for 30 Seconds ([Click to view full-size image](caching-data-with-the-objectdatasource-cs/_static/image29.png))</span></span>

<span data-ttu-id="05af0-254">儲存您的變更，並在瀏覽器中造訪此頁面。</span><span class="sxs-lookup"><span data-stu-id="05af0-254">Save your changes and revisit this page in a browser.</span></span> <span data-ttu-id="05af0-255">當您第一次流覽頁面時，將會出現選取事件引發的文字，因為一開始資料不在快取中。</span><span class="sxs-lookup"><span data-stu-id="05af0-255">The Selecting event fired text will appear when you first visit the page, as initially the data is not in the cache.</span></span> <span data-ttu-id="05af0-256">但是，按一下回傳按鈕、排序、分頁，或按一下 [編輯] 或 [取消] 按鈕所觸發的後續回傳，並*不*會重新顯示選取事件引發的文字。</span><span class="sxs-lookup"><span data-stu-id="05af0-256">But subsequent postbacks triggered by clicking the Postback button, sorting, paging, or clicking the Edit or Cancel buttons does *not* redisplay the Selecting event fired text.</span></span> <span data-ttu-id="05af0-257">這是因為只有當 ObjectDataSource 從其基礎物件取得其資料時，才會引發 `Selecting` 事件;如果從資料快取中提取資料，則不會引發 `Selecting` 事件。</span><span class="sxs-lookup"><span data-stu-id="05af0-257">This is because the `Selecting` event only fires when the ObjectDataSource gets its data from its underlying object; the `Selecting` event does not fire if the data is pulled from the data cache.</span></span>

<span data-ttu-id="05af0-258">30秒之後，資料將會從快取中收回。</span><span class="sxs-lookup"><span data-stu-id="05af0-258">After 30 seconds, the data will be evicted from the cache.</span></span> <span data-ttu-id="05af0-259">如果叫用 ObjectDataSource s `Insert`、`Update`或 `Delete` 方法，資料也會從快取中收回。</span><span class="sxs-lookup"><span data-stu-id="05af0-259">The data will also be evicted from the cache if the ObjectDataSource s `Insert`, `Update`, or `Delete` methods are invoked.</span></span> <span data-ttu-id="05af0-260">因此，經過30秒之後，或按一下 [更新] 按鈕、排序、分頁，或按一下 [編輯] 或 [取消] 按鈕，將會導致 ObjectDataSource 從其基礎物件取得其資料，並顯示在 `Selecting` 事件引發時選取事件引發的文字。</span><span class="sxs-lookup"><span data-stu-id="05af0-260">Consequently, after 30 seconds have passed or the Update button has been clicked, sorting, paging, or clicking the Edit or Cancel buttons will cause the ObjectDataSource to get its data from its underlying object, displaying the Selecting event fired text when the `Selecting` event fires.</span></span> <span data-ttu-id="05af0-261">這些傳回的結果會放回資料快取中。</span><span class="sxs-lookup"><span data-stu-id="05af0-261">These returned results are placed back into the data cache.</span></span>

> [!NOTE]
> <span data-ttu-id="05af0-262">如果您看到經常選取事件引發的文字，即使您預期 ObjectDataSource 會使用快取的資料，也可能是因為記憶體限制。</span><span class="sxs-lookup"><span data-stu-id="05af0-262">If you see the Selecting event fired text frequently, even when you expect the ObjectDataSource to be working with cached data, it may be due to memory constraints.</span></span> <span data-ttu-id="05af0-263">如果沒有足夠的可用記憶體，ObjectDataSource 新增至快取的資料可能已被清除。</span><span class="sxs-lookup"><span data-stu-id="05af0-263">If there is not enough free memory, the data added to the cache by the ObjectDataSource may have been scavenged.</span></span> <span data-ttu-id="05af0-264">如果 ObjectDataSource 似乎沒有正確快取資料，或只是偶爾快取資料，請關閉一些應用程式以釋放記憶體，然後再試一次。</span><span class="sxs-lookup"><span data-stu-id="05af0-264">If the ObjectDataSource doesn t appear to be correctly caching the data or only caches the data sporadically, close some applications to free memory and try again.</span></span>

<span data-ttu-id="05af0-265">[圖 12] 說明 ObjectDataSource s 快取工作流程。</span><span class="sxs-lookup"><span data-stu-id="05af0-265">Figure 12 illustrates the ObjectDataSource s caching workflow.</span></span> <span data-ttu-id="05af0-266">當選取事件引發的文字出現在螢幕上時，這是因為資料不在快取中，而且必須從基礎物件中抓取。</span><span class="sxs-lookup"><span data-stu-id="05af0-266">When the Selecting event fired text appears on your screen, it is because the data was not in the cache and had to be retrieved from the underlying object.</span></span> <span data-ttu-id="05af0-267">不過，此文字遺失時，是因為資料可從快取中取得。</span><span class="sxs-lookup"><span data-stu-id="05af0-267">When this text is missing, however, it s because the data was available from the cache.</span></span> <span data-ttu-id="05af0-268">從快取傳回資料時，不會呼叫基礎物件，因此不會執行任何資料庫查詢。</span><span class="sxs-lookup"><span data-stu-id="05af0-268">When the data is returned from the cache there s no call to the underlying object and, therefore, no database query executed.</span></span>

![ObjectDataSource 會儲存並從資料快取中抓取其資料](caching-data-with-the-objectdatasource-cs/_static/image30.png)

<span data-ttu-id="05af0-270">**圖 12**： ObjectDataSource 儲存和抓取資料快取中的資料</span><span class="sxs-lookup"><span data-stu-id="05af0-270">**Figure 12**: The ObjectDataSource Stores and Retrieves its Data from the Data Cache</span></span>

<span data-ttu-id="05af0-271">每個 ASP.NET 應用程式都有自己的資料快取實例，其會在所有頁面和訪客之間共用。</span><span class="sxs-lookup"><span data-stu-id="05af0-271">Each ASP.NET application has its own data cache instance that s shared across all pages and visitors.</span></span> <span data-ttu-id="05af0-272">這表示由 ObjectDataSource 儲存在資料快取中的資料，同樣會在造訪該頁面的所有使用者之間共用。</span><span class="sxs-lookup"><span data-stu-id="05af0-272">That means that the data stored in the data cache by the ObjectDataSource is likewise shared across all users who visit the page.</span></span> <span data-ttu-id="05af0-273">若要確認這一點，請在瀏覽器中開啟 [`ObjectDataSource.aspx`] 頁面。</span><span class="sxs-lookup"><span data-stu-id="05af0-273">To verify this, open the `ObjectDataSource.aspx` page in a browser.</span></span> <span data-ttu-id="05af0-274">第一次流覽頁面時，將會顯示 [選取引發的事件] 文字（假設先前的測試加入快取的資料現在已經被收回）。</span><span class="sxs-lookup"><span data-stu-id="05af0-274">When first visiting the page, the Selecting event fired text will appear (assuming that the data added to the cache by previous tests has, by now, been evicted).</span></span> <span data-ttu-id="05af0-275">開啟第二個瀏覽器實例，並將 URL 從第一個瀏覽器實例複製並貼到第二個。</span><span class="sxs-lookup"><span data-stu-id="05af0-275">Open a second browser instance and copy and paste the URL from the first browser instance to the second.</span></span> <span data-ttu-id="05af0-276">在第二個瀏覽器實例中，不會顯示選取事件引發的文字，因為它使用與第一個相同的快取資料。</span><span class="sxs-lookup"><span data-stu-id="05af0-276">In the second browser instance, the Selecting event fired text is not shown because it s using the same cached data as the first.</span></span>

<span data-ttu-id="05af0-277">將其抓取的資料插入快取時，ObjectDataSource 會使用包含下列值的快取索引鍵值： `CacheDuration` 和 `CacheExpirationPolicy` 屬性值;ObjectDataSource 所使用之基礎商務物件的型別，它是透過[`TypeName` 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.typename.aspx)（在此範例中為`ProductsBLL`）所指定。`SelectMethod` 屬性的值，以及 `SelectParameters` 集合中參數的名稱和值;以及在執行[自訂分頁](../paging-and-sorting/paging-and-sorting-report-data-cs.md)時，所使用的 `StartRowIndex` 和 `MaximumRows` 屬性的值。</span><span class="sxs-lookup"><span data-stu-id="05af0-277">When inserting its retrieved data into the cache, the ObjectDataSource uses a cache key value that includes: the `CacheDuration` and `CacheExpirationPolicy` property values; the type of the underlying business object being used by the ObjectDataSource, which is specified via the [`TypeName` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.typename.aspx) (`ProductsBLL`, in this example); the value of the `SelectMethod` property and the name and values of the parameters in the `SelectParameters` collection; and the values of its `StartRowIndex` and `MaximumRows` properties, which are used when implementing [custom paging.](../paging-and-sorting/paging-and-sorting-report-data-cs.md)</span></span>

<span data-ttu-id="05af0-278">將快取索引鍵值製作為這些屬性的組合，可確保在這些值變更時，有唯一的快取專案。</span><span class="sxs-lookup"><span data-stu-id="05af0-278">Crafting the cache key value as a combination of these properties ensures a unique cache entry as these values change.</span></span> <span data-ttu-id="05af0-279">例如，在過去的教學課程中，我們探討了如何使用 `ProductsBLL` 類別 `GetProductsByCategoryID(categoryID)`，它會傳回指定分類的所有產品。</span><span class="sxs-lookup"><span data-stu-id="05af0-279">For example, in past tutorials we ve looked at using the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)`, which returns all products for a specified category.</span></span> <span data-ttu-id="05af0-280">一位使用者可能會進入頁面和觀看飲料，其 `CategoryID` 為1。</span><span class="sxs-lookup"><span data-stu-id="05af0-280">One user might come to the page and view beverages, which has a `CategoryID` of 1.</span></span> <span data-ttu-id="05af0-281">如果 ObjectDataSource 快取其結果，而不考慮 `SelectParameters` 值，則當另一位使用者前往頁面來 condiments 時，當飲料產品在快取中時，他們會看到快取的飲料產品而非 condiments。</span><span class="sxs-lookup"><span data-stu-id="05af0-281">If the ObjectDataSource cached its results without regard for the `SelectParameters` values, when another user came to the page to view condiments while the beverages products were in the cache, they d see the cached beverage products rather than condiments.</span></span> <span data-ttu-id="05af0-282">根據這些屬性來改變快取索引鍵，其中包括 `SelectParameters`的值，ObjectDataSource 會為飲料和 condiments 維護個別的快取專案。</span><span class="sxs-lookup"><span data-stu-id="05af0-282">By varying the cache key by these properties, which include the values of the `SelectParameters`, the ObjectDataSource maintains a separate cache entry for beverages and condiments.</span></span>

## <a name="stale-data-concerns"></a><span data-ttu-id="05af0-283">過時的資料考慮</span><span class="sxs-lookup"><span data-stu-id="05af0-283">Stale Data Concerns</span></span>

<span data-ttu-id="05af0-284">當叫用其 `Insert`、`Update`或 `Delete` 方法的任何一個時，ObjectDataSource 會自動從快取中收回其專案。</span><span class="sxs-lookup"><span data-stu-id="05af0-284">The ObjectDataSource automatically evicts its items from the cache when any one of its `Insert`, `Update`, or `Delete` methods is invoked.</span></span> <span data-ttu-id="05af0-285">這有助於防止過時的資料，方法是在透過頁面修改資料時清除快取專案。</span><span class="sxs-lookup"><span data-stu-id="05af0-285">This helps protect against stale data by clearing out the cache entries when the data is modified through the page.</span></span> <span data-ttu-id="05af0-286">不過，使用快取的 ObjectDataSource 仍然可以顯示過時的資料。</span><span class="sxs-lookup"><span data-stu-id="05af0-286">However, it is possible for an ObjectDataSource using caching to still display stale data.</span></span> <span data-ttu-id="05af0-287">在最簡單的情況下，這可能是因為資料直接在資料庫中變更所造成。</span><span class="sxs-lookup"><span data-stu-id="05af0-287">In the simplest case, it can be due to the data changing directly within the database.</span></span> <span data-ttu-id="05af0-288">可能是資料庫管理員剛執行的腳本會修改資料庫中的部分記錄。</span><span class="sxs-lookup"><span data-stu-id="05af0-288">Perhaps a database administrator just ran a script that modifies some of the records in the database.</span></span>

<span data-ttu-id="05af0-289">此案例也可能會以更細微的方式展開。</span><span class="sxs-lookup"><span data-stu-id="05af0-289">This scenario could also unfold in a more subtle way.</span></span> <span data-ttu-id="05af0-290">雖然 ObjectDataSource 會在呼叫其中一個資料修改方法時從快取中收回其專案，但已移除的快取專案是用於 ObjectDataSource 的屬性值（`CacheDuration`、`TypeName`、`SelectMethod`等等）組合。</span><span class="sxs-lookup"><span data-stu-id="05af0-290">While the ObjectDataSource evicts its items from the cache when one of its data modification methods is called, the cached items removed are for the ObjectDataSource s particular combination of property values (`CacheDuration`, `TypeName`, `SelectMethod`, and so on).</span></span> <span data-ttu-id="05af0-291">如果您有兩個使用不同 `SelectMethods` 或 `SelectParameters`的 ObjectDataSources，但仍可更新相同的資料，則一個 ObjectDataSource 可能會更新一個資料列，並使其本身的快取專案失效，但仍會從快取中提供第二個 ObjectDataSource 的對應資料列。</span><span class="sxs-lookup"><span data-stu-id="05af0-291">If you have two ObjectDataSources that use different `SelectMethods` or `SelectParameters`, but still can update the same data, then one ObjectDataSource may update a row and invalidate its own cache entries, but the corresponding row for the second ObjectDataSource will still be served from the cached.</span></span> <span data-ttu-id="05af0-292">我鼓勵您建立頁面來展現這種功能。</span><span class="sxs-lookup"><span data-stu-id="05af0-292">I encourage you to create pages to exhibit this functionality.</span></span> <span data-ttu-id="05af0-293">建立頁面，以顯示可編輯的 GridView，從使用快取的 ObjectDataSource 提取其資料，並設定為從 `ProductsBLL` 類別的 `GetProducts()` 方法取得資料。</span><span class="sxs-lookup"><span data-stu-id="05af0-293">Create a page that displays an editable GridView that pulls its data from an ObjectDataSource that uses caching and is configured to get data from the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="05af0-294">將另一個可編輯的 GridView 和 ObjectDataSource 加入此頁面（或另一個），但在此第二個 ObjectDataSource 中，它會使用 `GetProductsByCategoryID(categoryID)` 方法。</span><span class="sxs-lookup"><span data-stu-id="05af0-294">Add another editable GridView and ObjectDataSource to this page (or another one), but for this second ObjectDataSource have it use the `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="05af0-295">由於這兩個 ObjectDataSources `SelectMethod` 屬性不同，因此它們各自有快取的值。</span><span class="sxs-lookup"><span data-stu-id="05af0-295">Since the two ObjectDataSources `SelectMethod` properties differ, they ll each have their own cached values.</span></span> <span data-ttu-id="05af0-296">如果您在一個方格中編輯某個產品，下次將資料系結回另一個方格（藉由分頁、排序等等）時，它仍然會提供舊的快取資料，而不會反映其他方格所做的變更。</span><span class="sxs-lookup"><span data-stu-id="05af0-296">If you edit a product in one grid, the next time you bind the data back to the other grid (by paging, sorting, and so forth), it will still serve the old, cached data and not reflect the change that was made from the other grid.</span></span>

<span data-ttu-id="05af0-297">簡單地說，如果您願意擁有過時資料的潛能，請只使用以時間為基礎的 expiries，並在資料的有效期限很重要的案例中使用較短的 expiries。</span><span class="sxs-lookup"><span data-stu-id="05af0-297">In short, only use time-based expiries if you are willing to have the potential of stale data, and use shorter expiries for scenarios where the freshness of data is important.</span></span> <span data-ttu-id="05af0-298">如果無法接受過時的資料，請放棄快取或使用 SQL 快取相依性（假設它是您要重新快取的資料庫資料）。</span><span class="sxs-lookup"><span data-stu-id="05af0-298">If stale data is not acceptable, either forgo caching or use SQL cache dependencies (assuming it is database data you re caching).</span></span> <span data-ttu-id="05af0-299">我們將在未來的教學課程中探索 SQL 快取相依性。</span><span class="sxs-lookup"><span data-stu-id="05af0-299">We'll explore SQL cache dependencies in a future tutorial.</span></span>

## <a name="summary"></a><span data-ttu-id="05af0-300">總結</span><span class="sxs-lookup"><span data-stu-id="05af0-300">Summary</span></span>

<span data-ttu-id="05af0-301">在本教學課程中，我們已檢查 ObjectDataSource s 內建快取功能。</span><span class="sxs-lookup"><span data-stu-id="05af0-301">In this tutorial we examined the ObjectDataSource s built-in caching capabilities.</span></span> <span data-ttu-id="05af0-302">只要設定一些屬性，我們就可以指示 ObjectDataSource 快取從指定的 `SelectMethod` 傳回的結果到 ASP.NET 資料快取。</span><span class="sxs-lookup"><span data-stu-id="05af0-302">By simply setting a few properties, we can instruct the ObjectDataSource to cache the results returned from the specified `SelectMethod` into the ASP.NET data cache.</span></span> <span data-ttu-id="05af0-303">[`CacheDuration`] 和 [`CacheExpirationPolicy`] 屬性會指出專案的快取持續時間，以及其為絕對或滑動期限。</span><span class="sxs-lookup"><span data-stu-id="05af0-303">The `CacheDuration` and `CacheExpirationPolicy` properties indicate the duration the item is cached and whether it is an absolute or sliding expiration.</span></span> <span data-ttu-id="05af0-304">`CacheKeyDependency` 屬性會將所有 ObjectDataSource s 快取專案與現有的快取相依性產生關聯。</span><span class="sxs-lookup"><span data-stu-id="05af0-304">The `CacheKeyDependency` property associates all of the ObjectDataSource s cache entries with an existing cache dependency.</span></span> <span data-ttu-id="05af0-305">這可以用來從快取中收回 ObjectDataSource 的專案，然後再達到以時間為基礎的到期日，而且通常會搭配 SQL 快取相依性使用。</span><span class="sxs-lookup"><span data-stu-id="05af0-305">This can be used to evict the ObjectDataSource s entries from the cache before the time-based expiration is reached, and is typically used with SQL cache dependencies.</span></span>

<span data-ttu-id="05af0-306">因為 ObjectDataSource 只會將其值快取至資料快取，所以我們可以透過程式設計方式複寫 ObjectDataSource 的內建功能。</span><span class="sxs-lookup"><span data-stu-id="05af0-306">Since the ObjectDataSource simply caches its values to the data cache, we could replicate the ObjectDataSource s built-in functionality programmatically.</span></span> <span data-ttu-id="05af0-307">在展示層執行此動作並不合理，因為 ObjectDataSource 提供了現成的這項功能，但我們可以在架構的個別層級中執行快取功能。</span><span class="sxs-lookup"><span data-stu-id="05af0-307">It doesn t make sense to do this at the Presentation Layer, since the ObjectDataSource offers this functionality out of the box, but we can implement caching capabilities in a separate layer of the architecture.</span></span> <span data-ttu-id="05af0-308">若要這麼做，我們必須重複 ObjectDataSource 所使用的相同邏輯。</span><span class="sxs-lookup"><span data-stu-id="05af0-308">To do so, we'll need to repeat the same logic used by the ObjectDataSource.</span></span> <span data-ttu-id="05af0-309">我們將在下一個教學課程中探索如何以程式設計方式使用架構中的資料快取。</span><span class="sxs-lookup"><span data-stu-id="05af0-309">We'll explore how to programmatically work with the data cache from within the architecture in our next tutorial.</span></span>

<span data-ttu-id="05af0-310">快樂的程式設計！</span><span class="sxs-lookup"><span data-stu-id="05af0-310">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="05af0-311">進一步閱讀</span><span class="sxs-lookup"><span data-stu-id="05af0-311">Further Reading</span></span>

<span data-ttu-id="05af0-312">如需本教學課程中所討論之主題的詳細資訊，請參閱下列資源：</span><span class="sxs-lookup"><span data-stu-id="05af0-312">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="05af0-313">ASP.NET Caching：技術和最佳作法</span><span class="sxs-lookup"><span data-stu-id="05af0-313">ASP.NET Caching: Techniques and Best Practices</span></span>](https://msdn.microsoft.com/library/aa478965.aspx)
- [<span data-ttu-id="05af0-314">.NET Framework 應用程式的快取架構指南</span><span class="sxs-lookup"><span data-stu-id="05af0-314">Caching Architecture Guide for .NET Framework Applications</span></span>](https://msdn.microsoft.com/library/ee817645.aspx)
- [<span data-ttu-id="05af0-315">ASP.NET 2.0 中的輸出快取</span><span class="sxs-lookup"><span data-stu-id="05af0-315">Output Caching in ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx)

## <a name="about-the-author"></a><span data-ttu-id="05af0-316">關於作者</span><span class="sxs-lookup"><span data-stu-id="05af0-316">About the Author</span></span>

<span data-ttu-id="05af0-317">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，自1998起，有七個 ASP/ASP. NET 書籍和創辦人的[4GuysFromRolla.com](http://www.4guysfromrolla.com)。</span><span class="sxs-lookup"><span data-stu-id="05af0-317">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="05af0-318">Scott 以獨立的顧問、訓練員和作者的身分運作。</span><span class="sxs-lookup"><span data-stu-id="05af0-318">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="05af0-319">他的最新著作是[*在24小時內讓自己的 ASP.NET 2.0*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="05af0-319">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="05af0-320">他可以在mitchell@4GuysFromRolla.com觸達[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="05af0-320">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="05af0-321">或者透過他的 blog，可以在[http://ScottOnWriting.NET](http://ScottOnWriting.NET)找到。</span><span class="sxs-lookup"><span data-stu-id="05af0-321">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="05af0-322">特別感謝</span><span class="sxs-lookup"><span data-stu-id="05af0-322">Special Thanks To</span></span>

<span data-ttu-id="05af0-323">本教學課程系列已由許多有用的審核者所審查。</span><span class="sxs-lookup"><span data-stu-id="05af0-323">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="05af0-324">本教學課程的領導審查者為 Teresa Murphy。</span><span class="sxs-lookup"><span data-stu-id="05af0-324">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="05af0-325">有興趣複習我即將發行的 MSDN 文章嗎？</span><span class="sxs-lookup"><span data-stu-id="05af0-325">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="05af0-326">若是如此，請在mitchell@4GuysFromRolla.com的那一行下拉式[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="05af0-326">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="05af0-327">下一個</span><span class="sxs-lookup"><span data-stu-id="05af0-327">Next</span></span>](caching-data-in-the-architecture-cs.md)
