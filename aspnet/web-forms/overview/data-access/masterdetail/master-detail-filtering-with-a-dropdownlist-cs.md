---
uid: web-forms/overview/data-access/masterdetail/master-detail-filtering-with-a-dropdownlist-cs
title: 使用 DropDownList （C#）的主要/詳細資料篩選 |Microsoft Docs
author: rick-anderson
description: 在本教學課程中，我們將瞭解如何在 GridView 中顯示 DropDownList 控制項中的主要記錄，以及所選取清單專案的詳細資料。
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 53e659cc-eefb-40c1-a1dc-559481c99443
msc.legacyurl: /web-forms/overview/data-access/masterdetail/master-detail-filtering-with-a-dropdownlist-cs
msc.type: authoredcontent
ms.openlocfilehash: 3ec549f9da7a2b3a021e77827f0039e6ae60b5c5
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/06/2020
ms.locfileid: "78528816"
---
# <a name="masterdetail-filtering-with-a-dropdownlist-c"></a><span data-ttu-id="707d5-103">使用 DropDownList 進行主要/詳細資料篩選 (C#)</span><span class="sxs-lookup"><span data-stu-id="707d5-103">Master/Detail Filtering With a DropDownList (C#)</span></span>

<span data-ttu-id="707d5-104">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="707d5-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="707d5-105">[下載範例應用程式](https://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_7_CS.exe)或[下載 PDF](master-detail-filtering-with-a-dropdownlist-cs/_static/datatutorial07cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="707d5-105">[Download Sample App](https://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_7_CS.exe) or [Download PDF](master-detail-filtering-with-a-dropdownlist-cs/_static/datatutorial07cs1.pdf)</span></span>

> <span data-ttu-id="707d5-106">在本教學課程中，我們將瞭解如何在 GridView 中顯示 DropDownList 控制項中的主要記錄，以及所選取清單專案的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="707d5-106">In this tutorial we'll see how to display the master records in a DropDownList control and the details of the selected list item in a GridView.</span></span>

## <a name="introduction"></a><span data-ttu-id="707d5-107">簡介</span><span class="sxs-lookup"><span data-stu-id="707d5-107">Introduction</span></span>

<span data-ttu-id="707d5-108">一般報表類型是*主要/詳細資料包表*，報表一開始會顯示一組「主要」記錄。</span><span class="sxs-lookup"><span data-stu-id="707d5-108">A common type of report is the *master/detail report*, in which the report begins by showing some set of "master" records.</span></span> <span data-ttu-id="707d5-109">使用者接著可以向下切入到其中一個主要記錄，藉此查看該主記錄的「詳細資料」。</span><span class="sxs-lookup"><span data-stu-id="707d5-109">The user can then drill down into one of the master records, thereby viewing that master record's "details."</span></span> <span data-ttu-id="707d5-110">主要/詳細資料包表是視覺化一對多關聯性的理想選擇，例如顯示所有類別的報表，然後允許使用者選取特定類別，並顯示其相關聯的產品。</span><span class="sxs-lookup"><span data-stu-id="707d5-110">Master/detail reports are an ideal choice for visualizing one-to-many relationships, such as a report showing all of the categories and then allowing a user to select a particular category and display its associated products.</span></span> <span data-ttu-id="707d5-111">此外，主要/詳細資料包表非常適合用來顯示特別「寬」資料表的詳細資訊（具有大量資料行的資料表）。</span><span class="sxs-lookup"><span data-stu-id="707d5-111">Additionally, master/detail reports are useful for displaying detailed information from particularly "wide" tables (ones that have a lot of columns).</span></span> <span data-ttu-id="707d5-112">例如，主要/詳細資料包表的「主要」層級可能只會顯示資料庫中產品的產品名稱和單價，而向下切入特定產品會顯示額外的產品欄位（類別、供應商、每個單位的數量等等）。</span><span class="sxs-lookup"><span data-stu-id="707d5-112">For example, the "master" level of a master/detail report might show just the product name and unit price of the products in the database, and drilling down into a particular product would show the additional product fields (category, supplier, quantity per unit, and so on).</span></span>

<span data-ttu-id="707d5-113">有許多方式可以執行主要/詳細資料包告。</span><span class="sxs-lookup"><span data-stu-id="707d5-113">There are many ways with which a master/detail report can be implemented.</span></span> <span data-ttu-id="707d5-114">在此和接下來的三個教學課程中，我們將探討各種主要/詳細資料包表。</span><span class="sxs-lookup"><span data-stu-id="707d5-114">Over this and the next three tutorials we'll look at a variety of master/detail reports.</span></span> <span data-ttu-id="707d5-115">在本教學課程中，我們將瞭解如何在 GridView 中顯示[DropDownList 控制項](https://msdn.microsoft.com/library/dtx91y0z.aspx)中的主要記錄，以及所選取清單專案的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="707d5-115">In this tutorial we'll see how to display the master records in a [DropDownList control](https://msdn.microsoft.com/library/dtx91y0z.aspx) and the details of the selected list item in a GridView.</span></span> <span data-ttu-id="707d5-116">特別是，本教學課程的主要/詳細資料包表會列出類別目錄和產品資訊。</span><span class="sxs-lookup"><span data-stu-id="707d5-116">In particular, this tutorial's master/detail report will list category and product information.</span></span>

## <a name="step-1-displaying-the-categories-in-a-dropdownlist"></a><span data-ttu-id="707d5-117">步驟1：在 DropDownList 中顯示類別</span><span class="sxs-lookup"><span data-stu-id="707d5-117">Step 1: Displaying the Categories in a DropDownList</span></span>

<span data-ttu-id="707d5-118">我們的主要/詳細資料包表會列出 DropDownList 中的類別，並在 GridView 的頁面中進一步顯示選取的清單專案產品。</span><span class="sxs-lookup"><span data-stu-id="707d5-118">Our master/detail report will list the categories in a DropDownList, with the selected list item's products displayed further down in the page in a GridView.</span></span> <span data-ttu-id="707d5-119">然後，前面的第一項工作是讓類別顯示在 DropDownList 中。</span><span class="sxs-lookup"><span data-stu-id="707d5-119">The first task ahead of us, then, is to have the categories displayed in a DropDownList.</span></span> <span data-ttu-id="707d5-120">開啟 [`Filtering`] 資料夾中的 [`FilterByDropDownList.aspx`] 頁面，將 DropDownList 從 [工具箱] 拖曳至頁面的設計工具上，並將其 [`ID`] 屬性設定為 [`Categories`]。</span><span class="sxs-lookup"><span data-stu-id="707d5-120">Open the `FilterByDropDownList.aspx` page in the `Filtering` folder, drag on a DropDownList from the Toolbox onto the page's designer, and set its `ID` property to `Categories`.</span></span> <span data-ttu-id="707d5-121">接下來，按一下 DropDownList 的智慧標籤中的 [選擇資料來源] 連結。</span><span class="sxs-lookup"><span data-stu-id="707d5-121">Next, click on the Choose Data Source link from the DropDownList's smart tag.</span></span> <span data-ttu-id="707d5-122">這會顯示 [資料來源設定向導]。</span><span class="sxs-lookup"><span data-stu-id="707d5-122">This will display the Data Source Configuration wizard.</span></span>

<span data-ttu-id="707d5-123">[![指定 DropDownList 的資料來源](master-detail-filtering-with-a-dropdownlist-cs/_static/image2.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="707d5-123">[![Specify the DropDownList's Data Source](master-detail-filtering-with-a-dropdownlist-cs/_static/image2.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image1.png)</span></span>

<span data-ttu-id="707d5-124">**圖 1**：指定 DropDownList 的資料來源（[按一下以查看完整大小的影像](master-detail-filtering-with-a-dropdownlist-cs/_static/image3.png)）</span><span class="sxs-lookup"><span data-stu-id="707d5-124">**Figure 1**: Specify the DropDownList's Data Source ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-cs/_static/image3.png))</span></span>

<span data-ttu-id="707d5-125">選擇新增名為 `CategoriesDataSource` 的新 ObjectDataSource，以叫用 `CategoriesBLL` 類別的 `GetCategories()` 方法。</span><span class="sxs-lookup"><span data-stu-id="707d5-125">Choose to add a new ObjectDataSource named `CategoriesDataSource` that invokes the `CategoriesBLL` class's `GetCategories()` method.</span></span>

<span data-ttu-id="707d5-126">[![新增名為 CategoriesDataSource 的新 ObjectDataSource](master-detail-filtering-with-a-dropdownlist-cs/_static/image5.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="707d5-126">[![Add a New ObjectDataSource Named CategoriesDataSource](master-detail-filtering-with-a-dropdownlist-cs/_static/image5.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image4.png)</span></span>

<span data-ttu-id="707d5-127">**圖 2**：新增名為 `CategoriesDataSource` 的新 ObjectDataSource （[按一下以查看完整大小的影像](master-detail-filtering-with-a-dropdownlist-cs/_static/image6.png)）</span><span class="sxs-lookup"><span data-stu-id="707d5-127">**Figure 2**: Add a New ObjectDataSource Named `CategoriesDataSource` ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-cs/_static/image6.png))</span></span>

<span data-ttu-id="707d5-128">[![選擇使用 CategoriesBLL 類別](master-detail-filtering-with-a-dropdownlist-cs/_static/image8.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="707d5-128">[![Choose to Use the CategoriesBLL Class](master-detail-filtering-with-a-dropdownlist-cs/_static/image8.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image7.png)</span></span>

<span data-ttu-id="707d5-129">**圖 3**：選擇使用 [`CategoriesBLL`] 類別（[按一下以查看完整大小的影像](master-detail-filtering-with-a-dropdownlist-cs/_static/image9.png)）</span><span class="sxs-lookup"><span data-stu-id="707d5-129">**Figure 3**: Choose to Use the `CategoriesBLL` Class ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-cs/_static/image9.png))</span></span>

<span data-ttu-id="707d5-130">[![將 ObjectDataSource 設定為使用 GetCategories （）方法](master-detail-filtering-with-a-dropdownlist-cs/_static/image11.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="707d5-130">[![Configure the ObjectDataSource to Use the GetCategories() Method](master-detail-filtering-with-a-dropdownlist-cs/_static/image11.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image10.png)</span></span>

<span data-ttu-id="707d5-131">**圖 4**：設定 ObjectDataSource 以使用 `GetCategories()` 方法（[按一下以查看完整大小的影像](master-detail-filtering-with-a-dropdownlist-cs/_static/image12.png)）</span><span class="sxs-lookup"><span data-stu-id="707d5-131">**Figure 4**: Configure the ObjectDataSource to Use the `GetCategories()` Method ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-cs/_static/image12.png))</span></span>

<span data-ttu-id="707d5-132">設定 ObjectDataSource 之後，我們仍然需要指定應該在 DropDownList 中顯示哪一個資料來源欄位，以及哪一個應該與清單專案的值相關聯。</span><span class="sxs-lookup"><span data-stu-id="707d5-132">After configuring the ObjectDataSource we still need to specify what data source field should be displayed in DropDownList and which one should be associated as the value for the list item.</span></span> <span data-ttu-id="707d5-133">將 [`CategoryName`] 欄位做為顯示，並 `CategoryID` 為每個清單專案的值。</span><span class="sxs-lookup"><span data-stu-id="707d5-133">Have the `CategoryName` field as the display and `CategoryID` as the value for each list item.</span></span>

<span data-ttu-id="707d5-134">[![讓 DropDownList 顯示 [類別名稱] 欄位，並使用 [類別名稱] 做為值](master-detail-filtering-with-a-dropdownlist-cs/_static/image14.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="707d5-134">[![Have the DropDownList Display the CategoryName Field and Use CategoryID as the Value](master-detail-filtering-with-a-dropdownlist-cs/_static/image14.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image13.png)</span></span>

<span data-ttu-id="707d5-135">**圖 5**：讓 DropDownList 顯示 `CategoryName` 欄位，並使用 `CategoryID` 作為值（[按一下以查看完整大小的影像](master-detail-filtering-with-a-dropdownlist-cs/_static/image15.png)）</span><span class="sxs-lookup"><span data-stu-id="707d5-135">**Figure 5**: Have the DropDownList Display the `CategoryName` Field and Use `CategoryID` as the Value ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-cs/_static/image15.png))</span></span>

<span data-ttu-id="707d5-136">此時，我們有一個 DropDownList 控制項，其中填入了 `Categories` 資料表中的記錄（全部在大約六秒內完成）。</span><span class="sxs-lookup"><span data-stu-id="707d5-136">At this point we have a DropDownList control that's populated with the records from the `Categories` table (all accomplished in about six seconds).</span></span> <span data-ttu-id="707d5-137">[圖 6] 顯示透過瀏覽器觀看的進度。</span><span class="sxs-lookup"><span data-stu-id="707d5-137">Figure 6 shows our progress thus far when viewed through a browser.</span></span>

<span data-ttu-id="707d5-138">[![下拉式清單會列出目前的類別](master-detail-filtering-with-a-dropdownlist-cs/_static/image17.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="707d5-138">[![A Drop-Down Lists the Current Categories](master-detail-filtering-with-a-dropdownlist-cs/_static/image17.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image16.png)</span></span>

<span data-ttu-id="707d5-139">**圖 6**：下拉式清單會列出目前的類別（[按一下以查看完整大小的影像](master-detail-filtering-with-a-dropdownlist-cs/_static/image18.png)）</span><span class="sxs-lookup"><span data-stu-id="707d5-139">**Figure 6**: A Drop-Down Lists the Current Categories ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-cs/_static/image18.png))</span></span>

## <a name="step-2-adding-the-products-gridview"></a><span data-ttu-id="707d5-140">步驟2：新增產品 GridView</span><span class="sxs-lookup"><span data-stu-id="707d5-140">Step 2: Adding the Products GridView</span></span>

<span data-ttu-id="707d5-141">主要/詳細資料包告中的最後一個步驟，是列出與所選類別相關聯的產品。</span><span class="sxs-lookup"><span data-stu-id="707d5-141">That last step in our master/detail report is to list the products associated with the selected category.</span></span> <span data-ttu-id="707d5-142">若要完成此動作，請在頁面中新增 GridView，並建立名為 `productsDataSource`的新 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="707d5-142">To accomplish this, add a GridView to the page and create a new ObjectDataSource named `productsDataSource`.</span></span> <span data-ttu-id="707d5-143">讓 `productsDataSource` 控制項會從 `ProductsBLL` 類別的 `GetProductsByCategoryID(categoryID)` 方法挑選其資料。</span><span class="sxs-lookup"><span data-stu-id="707d5-143">Have the `productsDataSource` control cull its data from the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method.</span></span>

<span data-ttu-id="707d5-144">[![選取 GetProductsByCategoryID （[類別]）方法](master-detail-filtering-with-a-dropdownlist-cs/_static/image20.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="707d5-144">[![Select the GetProductsByCategoryID(categoryID) Method](master-detail-filtering-with-a-dropdownlist-cs/_static/image20.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image19.png)</span></span>

<span data-ttu-id="707d5-145">**圖 7**：選取 [`GetProductsByCategoryID(categoryID)`] 方法（[按一下以查看完整大小的影像](master-detail-filtering-with-a-dropdownlist-cs/_static/image21.png)）</span><span class="sxs-lookup"><span data-stu-id="707d5-145">**Figure 7**: Select the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-cs/_static/image21.png))</span></span>

<span data-ttu-id="707d5-146">選擇這個方法之後，ObjectDataSource wizard 會提示我們輸入方法之 *`categoryID`* 參數的值。</span><span class="sxs-lookup"><span data-stu-id="707d5-146">After choosing this method, the ObjectDataSource wizard prompts us for the value for the method's *`categoryID`* parameter.</span></span> <span data-ttu-id="707d5-147">若要使用所選取 `categories` DropDownList 專案的值，請將參數來源設定為 Control，並將 ControlID 設為 `Categories`。</span><span class="sxs-lookup"><span data-stu-id="707d5-147">To use the value of the selected `categories` DropDownList item set the Parameter source to Control and the ControlID to `Categories`.</span></span>

<span data-ttu-id="707d5-148">[![將 [類別目錄] 參數設定為 [分類] DropDownList 的值](master-detail-filtering-with-a-dropdownlist-cs/_static/image23.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="707d5-148">[![Set the categoryID Parameter to the Value of the Categories DropDownList](master-detail-filtering-with-a-dropdownlist-cs/_static/image23.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image22.png)</span></span>

<span data-ttu-id="707d5-149">**圖 8**：將 *`categoryID`* 參數設定為 `Categories` DropDownList 的值（[按一下以查看完整大小的影像](master-detail-filtering-with-a-dropdownlist-cs/_static/image24.png)）</span><span class="sxs-lookup"><span data-stu-id="707d5-149">**Figure 8**: Set the *`categoryID`* Parameter to the Value of the `Categories` DropDownList ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-cs/_static/image24.png))</span></span>

<span data-ttu-id="707d5-150">請花點時間在瀏覽器中查看進度。</span><span class="sxs-lookup"><span data-stu-id="707d5-150">Take a moment to check out our progress in a browser.</span></span> <span data-ttu-id="707d5-151">第一次流覽頁面時，會顯示屬於所選類別（飲料）的產品（如 [圖 9] 所示），但是變更 DropDownList 並不會更新資料。</span><span class="sxs-lookup"><span data-stu-id="707d5-151">When first visiting the page, those products belong to the selected category (Beverages) are displayed (as shown in Figure 9), but changing the DropDownList doesn't update the data.</span></span> <span data-ttu-id="707d5-152">這是因為必須進行回傳，GridView 才會更新。</span><span class="sxs-lookup"><span data-stu-id="707d5-152">This is because a postback must occur for the GridView to update.</span></span> <span data-ttu-id="707d5-153">若要完成這項工作，我們有兩個選項（兩者都不需要撰寫任何程式碼）：</span><span class="sxs-lookup"><span data-stu-id="707d5-153">To accomplish this we have two options (neither of which requires writing any code):</span></span>

- <span data-ttu-id="707d5-154">**將類別 DropDownList 的**[AutoPostBack 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listcontrol.autopostback%28VS.80%29.aspx)設定**為 True。**</span><span class="sxs-lookup"><span data-stu-id="707d5-154">**Set the categories DropDownList's**[AutoPostBack property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listcontrol.autopostback%28VS.80%29.aspx)**to True.**</span></span> <span data-ttu-id="707d5-155">（您可以藉由核取 DropDownList 的智慧標籤中的 [啟用 AutoPostBack] 選項來完成這項操作。）每當使用者變更 DropDownList 的選取專案時，這會觸發回傳。</span><span class="sxs-lookup"><span data-stu-id="707d5-155">(You can accomplish this by checking the Enable AutoPostBack option in the DropDownList's smart tag.) This will trigger a postback whenever the DropDownList's selected item is changed by the user.</span></span> <span data-ttu-id="707d5-156">因此，當使用者從 DropDownList 中選取新的類別時，回傳將會控制發生，而 GridView 會更新為新選取之類別目錄的產品。</span><span class="sxs-lookup"><span data-stu-id="707d5-156">Therefore, when the user selects a new category from the DropDownList a postback will ensue and the GridView will be updated with the products for the newly selected category.</span></span> <span data-ttu-id="707d5-157">（這是我在本教學課程中使用的方法）。</span><span class="sxs-lookup"><span data-stu-id="707d5-157">(This is the approach I've used in this tutorial.)</span></span>
- <span data-ttu-id="707d5-158">**在 DropDownList 旁新增按鈕 Web 控制項。**</span><span class="sxs-lookup"><span data-stu-id="707d5-158">**Add a Button Web control next to the DropDownList.**</span></span> <span data-ttu-id="707d5-159">將其 `Text` 屬性設定為 [重新整理] 或類似的內容。</span><span class="sxs-lookup"><span data-stu-id="707d5-159">Set its `Text` property to Refresh or something similar.</span></span> <span data-ttu-id="707d5-160">使用此方法時，使用者必須選取新的類別，然後按一下按鈕。</span><span class="sxs-lookup"><span data-stu-id="707d5-160">With this approach, the user will need to select a new category and then click the Button.</span></span> <span data-ttu-id="707d5-161">按一下此按鈕會導致回傳並更新 GridView，以列出所選類別目錄的產品。</span><span class="sxs-lookup"><span data-stu-id="707d5-161">Clicking the Button will cause a postback and update the GridView to list those products of the selected category.</span></span>

<span data-ttu-id="707d5-162">[圖 9] 和 [10] 說明主要/詳細報告的實際運作方式。</span><span class="sxs-lookup"><span data-stu-id="707d5-162">Figures 9 and 10 illustrate the master/detail report in action.</span></span>

<span data-ttu-id="707d5-163">[![第一次造訪網頁時，會顯示飲料產品](master-detail-filtering-with-a-dropdownlist-cs/_static/image26.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="707d5-163">[![When First Visiting the Page, the Beverage Products are Displayed](master-detail-filtering-with-a-dropdownlist-cs/_static/image26.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image25.png)</span></span>

<span data-ttu-id="707d5-164">**圖 9**：第一次流覽頁面時，會顯示飲料產品（[按一下以觀看完整大小的影像](master-detail-filtering-with-a-dropdownlist-cs/_static/image27.png)）</span><span class="sxs-lookup"><span data-stu-id="707d5-164">**Figure 9**: When First Visiting the Page, the Beverage Products are Displayed ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-cs/_static/image27.png))</span></span>

<span data-ttu-id="707d5-165">[![選取新產品（產生）會自動導致回傳，並更新 GridView](master-detail-filtering-with-a-dropdownlist-cs/_static/image29.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="707d5-165">[![Selecting a New Product (Produce) Automatically Causes a PostBack, Updating the GridView](master-detail-filtering-with-a-dropdownlist-cs/_static/image29.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image28.png)</span></span>

<span data-ttu-id="707d5-166">**圖 10**：選取新的產品（產生）會自動導致回傳，並更新 GridView （[按一下以觀看完整大小的影像](master-detail-filtering-with-a-dropdownlist-cs/_static/image30.png)）</span><span class="sxs-lookup"><span data-stu-id="707d5-166">**Figure 10**: Selecting a New Product (Produce) Automatically Causes a PostBack, Updating the GridView ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-cs/_static/image30.png))</span></span>

## <a name="adding-a----choose-a-category----list-item"></a><span data-ttu-id="707d5-167">新增「--選擇類別--」清單專案</span><span class="sxs-lookup"><span data-stu-id="707d5-167">Adding a "-- Choose a Category --" List Item</span></span>

<span data-ttu-id="707d5-168">第一次造訪 [`FilterByDropDownList.aspx`] 頁面時，預設會選取 [類別] DropDownList 的 [第一個清單專案（飲料）]，其中顯示 GridView 中的飲料產品。</span><span class="sxs-lookup"><span data-stu-id="707d5-168">When first visiting the `FilterByDropDownList.aspx` page the categories DropDownList's first list item (Beverages) is selected by default, showing the beverage products in the GridView.</span></span> <span data-ttu-id="707d5-169">我們可能會想要改為選取 [--選擇類別--] 這類的 DropDownList 專案，而不是顯示第一個類別的產品。</span><span class="sxs-lookup"><span data-stu-id="707d5-169">Rather than showing the first category's products, we may want to instead have a DropDownList item selected that says something like, "-- Choose a Category --".</span></span>

<span data-ttu-id="707d5-170">若要將新的清單專案加入至 DropDownList，請移至 屬性視窗，然後按一下 `Items` 屬性中的省略號。</span><span class="sxs-lookup"><span data-stu-id="707d5-170">To add a new list item to the DropDownList, go to the Properties window and click on the ellipses in the `Items` property.</span></span> <span data-ttu-id="707d5-171">加入具有 `Text` "--選擇類別目錄--" 和 `Value` `-1`的新清單專案。</span><span class="sxs-lookup"><span data-stu-id="707d5-171">Add a new list item with the `Text` "-- Choose a Category --" and the `Value` `-1`.</span></span>

<span data-ttu-id="707d5-172">[![新增--選擇類別目錄--清單專案](master-detail-filtering-with-a-dropdownlist-cs/_static/image32.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="707d5-172">[![Add a -- Choose a Category -- List Item](master-detail-filtering-with-a-dropdownlist-cs/_static/image32.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image31.png)</span></span>

<span data-ttu-id="707d5-173">**圖 11**：新增--選擇類別目錄--清單專案（[按一下以查看完整大小的影像](master-detail-filtering-with-a-dropdownlist-cs/_static/image33.png)）</span><span class="sxs-lookup"><span data-stu-id="707d5-173">**Figure 11**: Add a -- Choose a Category -- List Item ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-cs/_static/image33.png))</span></span>

<span data-ttu-id="707d5-174">或者，您也可以將下列標記新增至 DropDownList，以新增清單專案：</span><span class="sxs-lookup"><span data-stu-id="707d5-174">Alternatively, you can add the list item by adding the following markup to the DropDownList:</span></span>

[!code-aspx[Main](master-detail-filtering-with-a-dropdownlist-cs/samples/sample1.aspx)]

<span data-ttu-id="707d5-175">此外，我們需要將 DropDownList 控制項的 `AppendDataBoundItems` 設定為 True，因為當類別目錄從 ObjectDataSource 系結至 DropDownList 時，如果 `AppendDataBoundItems` 不是 True，就會覆寫任何手動加入的清單專案。</span><span class="sxs-lookup"><span data-stu-id="707d5-175">Additionally, we need to set the DropDownList control's `AppendDataBoundItems` to True because when the categories are bound to the DropDownList from the ObjectDataSource they'll overwrite any manually-added list items if `AppendDataBoundItems` isn't True.</span></span>

![將 AppendDataBoundItems 屬性設定為 True](master-detail-filtering-with-a-dropdownlist-cs/_static/image34.png)

<span data-ttu-id="707d5-177">**圖 12**：將 `AppendDataBoundItems` 屬性設定為 True</span><span class="sxs-lookup"><span data-stu-id="707d5-177">**Figure 12**: Set the `AppendDataBoundItems` Property to True</span></span>

<span data-ttu-id="707d5-178">這些變更之後，第一次造訪頁面時，會選取 [--選擇類別--] 選項，而且不會顯示任何產品。</span><span class="sxs-lookup"><span data-stu-id="707d5-178">After these changes, when first visiting the page the "-- Choose a Category --" option is selected and no products are displayed.</span></span>

<span data-ttu-id="707d5-179">[初始頁面上的 ![[載入不顯示任何產品]](master-detail-filtering-with-a-dropdownlist-cs/_static/image36.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="707d5-179">[![On the Initial Page Load No Products are Displayed](master-detail-filtering-with-a-dropdownlist-cs/_static/image36.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image35.png)</span></span>

<span data-ttu-id="707d5-180">**圖 13**：在初始頁面上載入沒有顯示任何產品（[按一下以觀看完整大小的影像](master-detail-filtering-with-a-dropdownlist-cs/_static/image37.png)）</span><span class="sxs-lookup"><span data-stu-id="707d5-180">**Figure 13**: On the Initial Page Load No Products are Displayed ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-cs/_static/image37.png))</span></span>

<span data-ttu-id="707d5-181">當選取 [--選擇類別--] 清單專案時，沒有顯示任何產品的原因是因為它的值是 `-1`，而且資料庫中沒有任何具有 `CategoryID` `-1`的產品。</span><span class="sxs-lookup"><span data-stu-id="707d5-181">The reason no products are displayed when because the "-- Choose a Category --" list item is selected is because its value is `-1` and there are no products in the database with a `CategoryID` of `-1`.</span></span> <span data-ttu-id="707d5-182">如果這是您想要的行為，您就大功告成了！</span><span class="sxs-lookup"><span data-stu-id="707d5-182">If this is the behavior you want then you're done at this point!</span></span> <span data-ttu-id="707d5-183">不過，如果您想要在選取 [--選擇類別--] 清單專案時顯示*所有*類別，請回到 `ProductsBLL` 類別並自訂 `GetProductsByCategoryID(categoryID)` 方法，以便在傳入的 *`categoryID`* 參數小於零時，叫用 `GetProducts()` 方法：</span><span class="sxs-lookup"><span data-stu-id="707d5-183">If, however, you want to display *all* of the categories when the "-- Choose a Category --" list item is selected, return to the `ProductsBLL` class and customize the `GetProductsByCategoryID(categoryID)` method so that it invokes the `GetProducts()` method if the passed in *`categoryID`* parameter is less than zero:</span></span>

[!code-csharp[Main](master-detail-filtering-with-a-dropdownlist-cs/samples/sample2.cs)]

<span data-ttu-id="707d5-184">此處所使用的技術與我們用來在[宣告式參數](../basic-reporting/declarative-parameters-cs.md)教學課程中顯示所有供應商的方法類似，雖然在此範例中，我們會使用 `-1` 的值，表示應該抓取所有記錄，而不是 `null`。</span><span class="sxs-lookup"><span data-stu-id="707d5-184">The technique used here is similar to the approach we used to display all suppliers back in the [Declarative Parameters](../basic-reporting/declarative-parameters-cs.md) tutorial, although for this example we're using a value of `-1` to indicate that all records should be retrieved as opposed to `null`.</span></span> <span data-ttu-id="707d5-185">這是因為 `GetProductsByCategoryID(categoryID)` 方法的 *`categoryID`* 參數預期傳入的整數值，而在宣告式參數教學課程中，我們傳入的是字串輸入參數。</span><span class="sxs-lookup"><span data-stu-id="707d5-185">This is because the *`categoryID`* parameter of the `GetProductsByCategoryID(categoryID)` method expects as integer value passed in, whereas in the Declarative Parameters tutorial we were passing in a string input parameter.</span></span>

<span data-ttu-id="707d5-186">[圖 14] 顯示已選取 [--選擇類別--] 選項時 `FilterByDropDownList.aspx` 的螢幕擷取畫面。</span><span class="sxs-lookup"><span data-stu-id="707d5-186">Figure 14 shows a screen shot of `FilterByDropDownList.aspx` when the "-- Choose a Category --" option is selected.</span></span> <span data-ttu-id="707d5-187">在這裡，預設會顯示所有產品，而使用者可以選擇特定分類來縮小顯示範圍。</span><span class="sxs-lookup"><span data-stu-id="707d5-187">Here, all of the products are displayed by default, and the user can narrow the display by choosing a specific category.</span></span>

<span data-ttu-id="707d5-188">[![現在預設會列出所有產品](master-detail-filtering-with-a-dropdownlist-cs/_static/image39.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="707d5-188">[![All of the Products are Now Listed By Default](master-detail-filtering-with-a-dropdownlist-cs/_static/image39.png)](master-detail-filtering-with-a-dropdownlist-cs/_static/image38.png)</span></span>

<span data-ttu-id="707d5-189">**圖 14**：預設會列出所有產品（[按一下以觀看完整大小的影像](master-detail-filtering-with-a-dropdownlist-cs/_static/image40.png)）</span><span class="sxs-lookup"><span data-stu-id="707d5-189">**Figure 14**: All of the Products are Now Listed By Default ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-cs/_static/image40.png))</span></span>

## <a name="summary"></a><span data-ttu-id="707d5-190">總結</span><span class="sxs-lookup"><span data-stu-id="707d5-190">Summary</span></span>

<span data-ttu-id="707d5-191">當顯示階層式相關資料時，通常會使用主要/詳細報告來呈現資料，而使用者可以從階層的頂端開始流覽資料，並向下切入詳細資料。</span><span class="sxs-lookup"><span data-stu-id="707d5-191">When displaying hierarchically-related data, it often helps to present the data using master/detail reports, from which the user can start perusing the data from the top of the hierarchy and drill down into details.</span></span> <span data-ttu-id="707d5-192">在本教學課程中，我們已檢查建立一個簡單的主版/詳細資料包告，其中顯示所選類別的產品。</span><span class="sxs-lookup"><span data-stu-id="707d5-192">In this tutorial we examined building a simple master/detail report showing a selected category's products.</span></span> <span data-ttu-id="707d5-193">這是針對分類清單，以及屬於所選類別之產品的 GridView 而完成。</span><span class="sxs-lookup"><span data-stu-id="707d5-193">This was accomplished by using a DropDownList for the list of categories and a GridView for the products belonging to the selected category.</span></span>

<span data-ttu-id="707d5-194">在[下一個教學](master-detail-filtering-with-two-dropdownlists-cs.md)課程中，我們將使用兩個 dropdownlist 進行，讓 DropDownList 介面更進一步。</span><span class="sxs-lookup"><span data-stu-id="707d5-194">In the [next tutorial](master-detail-filtering-with-two-dropdownlists-cs.md) we'll take the DropDownList interface one step further, using two DropDownLists.</span></span>

<span data-ttu-id="707d5-195">快樂的程式設計！</span><span class="sxs-lookup"><span data-stu-id="707d5-195">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="707d5-196">關於作者</span><span class="sxs-lookup"><span data-stu-id="707d5-196">About the Author</span></span>

<span data-ttu-id="707d5-197">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，自1998起，有七個 ASP/ASP. NET 書籍和創辦人的[4GuysFromRolla.com](http://www.4guysfromrolla.com)。</span><span class="sxs-lookup"><span data-stu-id="707d5-197">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="707d5-198">Scott 以獨立的顧問、訓練員和作者的身分運作。</span><span class="sxs-lookup"><span data-stu-id="707d5-198">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="707d5-199">他的最新著作是[*在24小時內讓自己的 ASP.NET 2.0*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="707d5-199">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="707d5-200">他可以在mitchell@4GuysFromRolla.com觸達[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="707d5-200">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="707d5-201">或者透過他的 blog，可以在[http://ScottOnWriting.NET](http://ScottOnWriting.NET)找到。</span><span class="sxs-lookup"><span data-stu-id="707d5-201">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="707d5-202">下一個</span><span class="sxs-lookup"><span data-stu-id="707d5-202">Next</span></span>](master-detail-filtering-with-two-dropdownlists-cs.md)
