---
uid: web-forms/overview/data-access/masterdetail/master-detail-filtering-across-two-pages-vb
title: 跨兩個頁面的主要/詳細資料篩選（VB） |Microsoft Docs
author: rick-anderson
description: 在本教學課程中，我們將使用 GridView 來列出資料庫中的供應商，以執行這種模式。 GridView 中的每個供應商資料列將包含檢視表 w 。
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 361d6a44-3f1f-4daf-85df-d4c2b8bf065d
msc.legacyurl: /web-forms/overview/data-access/masterdetail/master-detail-filtering-across-two-pages-vb
msc.type: authoredcontent
ms.openlocfilehash: 252c6d5e48aff0087e090e3ddc1f58c84a2c030e
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/06/2020
ms.locfileid: "78529061"
---
# <a name="masterdetail-filtering-across-two-pages-vb"></a><span data-ttu-id="31288-104">跨兩個頁面進行主要/詳細資料篩選 (VB)</span><span class="sxs-lookup"><span data-stu-id="31288-104">Master/Detail Filtering Across Two Pages (VB)</span></span>

<span data-ttu-id="31288-105">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="31288-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="31288-106">[下載範例應用程式](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_9_VB.exe)或[下載 PDF](master-detail-filtering-across-two-pages-vb/_static/datatutorial09vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="31288-106">[Download Sample App](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_9_VB.exe) or [Download PDF](master-detail-filtering-across-two-pages-vb/_static/datatutorial09vb1.pdf)</span></span>

> <span data-ttu-id="31288-107">在本教學課程中，我們將使用 GridView 來列出資料庫中的供應商，以執行這種模式。</span><span class="sxs-lookup"><span data-stu-id="31288-107">In this tutorial we'll implement this pattern by using a GridView to list the suppliers in the database.</span></span> <span data-ttu-id="31288-108">GridView 中的每個供應商資料列都會包含 View Products 連結，當您按下時，就會將使用者帶到列出所選供應商產品的個別頁面。</span><span class="sxs-lookup"><span data-stu-id="31288-108">Each supplier row in the GridView will contain a View Products link that, when clicked, will take the user to a separate page that lists those products for the selected supplier.</span></span>

## <a name="introduction"></a><span data-ttu-id="31288-109">簡介</span><span class="sxs-lookup"><span data-stu-id="31288-109">Introduction</span></span>

<span data-ttu-id="31288-110">在前兩個教學課程中，我們已瞭解如何在單一網頁中顯示主要/詳細資料包表，方法是使用 Dropdownlist 進行來顯示「主要」記錄和[GridView](master-detail-filtering-with-a-dropdownlist-vb.md)或[DetailsView](master-detail-filtering-with-two-dropdownlists-vb.md)控制項，以顯示 [詳細資料]。</span><span class="sxs-lookup"><span data-stu-id="31288-110">In the previous two tutorials we saw how to display master/detail reports in a single web page using DropDownLists to display the "master" records and a [GridView](master-detail-filtering-with-a-dropdownlist-vb.md) or [DetailsView](master-detail-filtering-with-two-dropdownlists-vb.md) control to display the "details."</span></span> <span data-ttu-id="31288-111">主要/詳細資料包表使用的另一個常見模式是在一個網頁上擁有主要記錄，並在另一個頁面上顯示詳細資料。</span><span class="sxs-lookup"><span data-stu-id="31288-111">Another common pattern used for master/details reports is to have the master records on one web page and the details shown on another.</span></span> <span data-ttu-id="31288-112">論壇網站（如[ASP.NET 論壇](https://forums.asp.net/)）是此模式的絕佳範例。</span><span class="sxs-lookup"><span data-stu-id="31288-112">A forum website, like [the ASP.NET Forums](https://forums.asp.net/), is a great example of this pattern in practice.</span></span> <span data-ttu-id="31288-113">ASP.NET 論壇包含各種論壇消費者入門、Web form、資料簡報控制項等等。</span><span class="sxs-lookup"><span data-stu-id="31288-113">The ASP.NET Forums are composed of a variety of forums Getting Started, Web Forms, Data Presentation Controls, and so on.</span></span> <span data-ttu-id="31288-114">每個論壇都是由許多執行緒組成，而每個執行緒都是由幾篇文章所組成。</span><span class="sxs-lookup"><span data-stu-id="31288-114">Each forum is composed of many threads and each thread is composed of a number of posts.</span></span> <span data-ttu-id="31288-115">在 ASP.NET 論壇首頁上，會列出論壇。</span><span class="sxs-lookup"><span data-stu-id="31288-115">On the ASP.NET Forums homepage, the forums are listed.</span></span> <span data-ttu-id="31288-116">按一下論壇會 whisks 您前往 `ShowForum.aspx` 頁面，其中會列出該論壇的往來文章。</span><span class="sxs-lookup"><span data-stu-id="31288-116">Clicking on a forum whisks you to a `ShowForum.aspx` page, which lists the threads for that forum.</span></span> <span data-ttu-id="31288-117">同樣地，按一下執行緒會帶您前往 `ShowPost.aspx`，這會顯示已按下之執行緒的貼文。</span><span class="sxs-lookup"><span data-stu-id="31288-117">Likewise, clicking on a thread takes you to `ShowPost.aspx`, which displays the posts for the thread that was clicked.</span></span>

<span data-ttu-id="31288-118">在本教學課程中，我們將使用 GridView 來列出資料庫中的供應商，以執行這種模式。</span><span class="sxs-lookup"><span data-stu-id="31288-118">In this tutorial we'll implement this pattern by using a GridView to list the suppliers in the database.</span></span> <span data-ttu-id="31288-119">GridView 中的每個供應商資料列都會包含 View Products 連結，當您按下時，就會將使用者帶到列出所選供應商產品的個別頁面。</span><span class="sxs-lookup"><span data-stu-id="31288-119">Each supplier row in the GridView will contain a View Products link that, when clicked, will take the user to a separate page that lists those products for the selected supplier.</span></span>

## <a name="step-1-addingsupplierlistmasteraspxandproductsforsupplierdetailsaspxpages-to-thefilteringfolder"></a><span data-ttu-id="31288-120">步驟1：將`SupplierListMaster.aspx`和`ProductsForSupplierDetails.aspx`頁面新增至`Filtering`資料夾</span><span class="sxs-lookup"><span data-stu-id="31288-120">Step 1: Adding`SupplierListMaster.aspx`and`ProductsForSupplierDetails.aspx`Pages to the`Filtering`Folder</span></span>

<span data-ttu-id="31288-121">在第三個教學課程中定義頁面配置時，我們在 [`BasicReporting`]、[`Filtering`] 和 [`CustomFormatting`] 資料夾中新增了一些「入門」頁面。</span><span class="sxs-lookup"><span data-stu-id="31288-121">When defining the page layout in the third tutorial we added a number of "starter" pages in the `BasicReporting`, `Filtering`, and `CustomFormatting` folders.</span></span> <span data-ttu-id="31288-122">不過，我們目前並未新增本教學課程的起始頁，因此請花點時間將兩個新頁面新增至 `Filtering` 資料夾： `SupplierListMaster.aspx` 和 `ProductsForSupplierDetails.aspx`。</span><span class="sxs-lookup"><span data-stu-id="31288-122">However, we did not add a starter page for this tutorial at that time, so take a moment to add two new pages to the `Filtering` folder: `SupplierListMaster.aspx` and `ProductsForSupplierDetails.aspx`.</span></span> <span data-ttu-id="31288-123">`SupplierListMaster.aspx` 將會列出「主要」記錄（供應商），而 `ProductsForSupplierDetails.aspx` 會顯示所選供應商的產品。</span><span class="sxs-lookup"><span data-stu-id="31288-123">`SupplierListMaster.aspx` will list the "master" records (the suppliers) while `ProductsForSupplierDetails.aspx` will display the products for the selected supplier.</span></span>

<span data-ttu-id="31288-124">建立這兩個新的頁面時，請務必將它們與 `Site.master` 主版頁面建立關聯。</span><span class="sxs-lookup"><span data-stu-id="31288-124">When creating these two new pages be certain to associate them with the `Site.master` master page.</span></span>

![將 SupplierListMaster 和 ProductsForSupplierDetails 頁面新增至篩選資料夾](master-detail-filtering-across-two-pages-vb/_static/image1.png)

<span data-ttu-id="31288-126">**圖 1**：將 [`SupplierListMaster.aspx`] 和 [`ProductsForSupplierDetails.aspx`] 頁面新增至 [`Filtering`] 資料夾</span><span class="sxs-lookup"><span data-stu-id="31288-126">**Figure 1**: Add the `SupplierListMaster.aspx` and `ProductsForSupplierDetails.aspx` Pages to the `Filtering` Folder</span></span>

<span data-ttu-id="31288-127">此外，將新頁面新增至專案時，請務必更新網站地圖檔案，`Web.sitemap`。</span><span class="sxs-lookup"><span data-stu-id="31288-127">Also, when adding new pages to the project, be sure to update the site map file, `Web.sitemap`, accordingly.</span></span> <span data-ttu-id="31288-128">在本教學課程中，只需使用下列 XML 內容，將 [`SupplierListMaster.aspx`] 頁面新增至網站地圖，做為篩選報告 `<siteMapNode>` 元素的子系：</span><span class="sxs-lookup"><span data-stu-id="31288-128">For this tutorial simply add the `SupplierListMaster.aspx` page to the site map using the following XML content as a child of the Filtering Reports `<siteMapNode>` element:</span></span>

[!code-xml[Main](master-detail-filtering-across-two-pages-vb/samples/sample1.xml)]

> [!NOTE]
> <span data-ttu-id="31288-129">使用[K. Scott Allen](http://odetocode.com/Blogs/scott/)的免費 Visual Studio[網站地圖宏](http://odetocode.com/Blogs/scott/archive/2005/11/29/2537.aspx)來加入新的 ASP.NET 網頁時，您可以協助將更新網站地圖檔案的程式自動化。</span><span class="sxs-lookup"><span data-stu-id="31288-129">You can help automate the process of updating the site map file when adding new ASP.NET pages using [K. Scott Allen](http://odetocode.com/Blogs/scott/)'s free Visual Studio [Site Map Macro](http://odetocode.com/Blogs/scott/archive/2005/11/29/2537.aspx).</span></span>

## <a name="step-2-displaying-the-supplier-list-insupplierlistmasteraspx"></a><span data-ttu-id="31288-130">步驟2：在`SupplierListMaster.aspx` 中顯示供應商清單</span><span class="sxs-lookup"><span data-stu-id="31288-130">Step 2: Displaying the Supplier List in`SupplierListMaster.aspx`</span></span>

<span data-ttu-id="31288-131">建立 `SupplierListMaster.aspx` 和 `ProductsForSupplierDetails.aspx` 頁面後，下一個步驟是在 `SupplierListMaster.aspx`中建立供應商的 GridView。</span><span class="sxs-lookup"><span data-stu-id="31288-131">With the `SupplierListMaster.aspx` and `ProductsForSupplierDetails.aspx` pages created, our next step is to create the GridView of suppliers in `SupplierListMaster.aspx`.</span></span> <span data-ttu-id="31288-132">將 GridView 新增至頁面，並將它系結至新的 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="31288-132">Add a GridView to the page and bind it to a new ObjectDataSource.</span></span> <span data-ttu-id="31288-133">這個 ObjectDataSource 應該使用 `SuppliersBLL` 類別的 `GetSuppliers()` 方法來傳回所有供應商。</span><span class="sxs-lookup"><span data-stu-id="31288-133">This ObjectDataSource should use the `SuppliersBLL` class's `GetSuppliers()` method to return all suppliers.</span></span>

<span data-ttu-id="31288-134">[![選取 SuppliersBLL 類別](master-detail-filtering-across-two-pages-vb/_static/image3.png)](master-detail-filtering-across-two-pages-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="31288-134">[![Select the SuppliersBLL Class](master-detail-filtering-across-two-pages-vb/_static/image3.png)](master-detail-filtering-across-two-pages-vb/_static/image2.png)</span></span>

<span data-ttu-id="31288-135">**圖 2**：選取 [`SuppliersBLL`] 類別（[按一下以查看完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image4.png)）</span><span class="sxs-lookup"><span data-stu-id="31288-135">**Figure 2**: Select the `SuppliersBLL` Class ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image4.png))</span></span>

<span data-ttu-id="31288-136">[![將 ObjectDataSource 設定為使用 GetSuppliers （）方法](master-detail-filtering-across-two-pages-vb/_static/image6.png)](master-detail-filtering-across-two-pages-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="31288-136">[![Configure the ObjectDataSource to Use the GetSuppliers() Method](master-detail-filtering-across-two-pages-vb/_static/image6.png)](master-detail-filtering-across-two-pages-vb/_static/image5.png)</span></span>

<span data-ttu-id="31288-137">**圖 3**：設定 ObjectDataSource 以使用 `GetSuppliers()` 方法（[按一下以查看完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image7.png)）</span><span class="sxs-lookup"><span data-stu-id="31288-137">**Figure 3**: Configure the ObjectDataSource to Use the `GetSuppliers()` Method ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image7.png))</span></span>

<span data-ttu-id="31288-138">我們需要在每個 GridView 資料列中加入一個標題為 View Products 的連結，當按下時，就會透過 querystring 讓使用者 `ProductsForSupplierDetails.aspx` 傳入所選資料列的 `SupplierID` 值。</span><span class="sxs-lookup"><span data-stu-id="31288-138">We need to include a link titled View Products in each GridView row that, when clicked, takes the user to `ProductsForSupplierDetails.aspx` passing in the selected row's `SupplierID` value through the querystring.</span></span> <span data-ttu-id="31288-139">例如，如果使用者針對東京貿易供應商（其 `SupplierID` 值為4）按一下 [View Products] 連結，則應該將它們傳送至 `ProductsForSupplierDetails.aspx?SupplierID=4`。</span><span class="sxs-lookup"><span data-stu-id="31288-139">For example, if user clicks on the View Products link for the Tokyo Traders supplier (which has a `SupplierID` value of 4), they should be sent to `ProductsForSupplierDetails.aspx?SupplierID=4`.</span></span>

<span data-ttu-id="31288-140">若要完成這項操作，請將[HyperLinkField](https://msdn.microsoft.com/library/system.web.ui.webcontrols.hyperlinkfield.aspx)加入 gridview，這會將超連結加入至每個 gridview 資料列。</span><span class="sxs-lookup"><span data-stu-id="31288-140">To accomplish this, add a [HyperLinkField](https://msdn.microsoft.com/library/system.web.ui.webcontrols.hyperlinkfield.aspx) to the GridView, which adds a hyperlink to each GridView row.</span></span> <span data-ttu-id="31288-141">從 GridView 的智慧標籤按一下 [編輯資料行] 連結開始。</span><span class="sxs-lookup"><span data-stu-id="31288-141">Start by clicking the Edit Columns link from the GridView's smart tag.</span></span> <span data-ttu-id="31288-142">接下來，從左上方的清單中選取 HyperLinkField，然後按一下 [新增] 以在 GridView 的欄位清單中包含 HyperLinkField。</span><span class="sxs-lookup"><span data-stu-id="31288-142">Next, select the HyperLinkField from the list in the upper left and click Add to include the HyperLinkField in the GridView's field list.</span></span>

<span data-ttu-id="31288-143">[![將 HyperLinkField 新增至 GridView](master-detail-filtering-across-two-pages-vb/_static/image9.png)](master-detail-filtering-across-two-pages-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="31288-143">[![Add a HyperLinkField to the GridView](master-detail-filtering-across-two-pages-vb/_static/image9.png)](master-detail-filtering-across-two-pages-vb/_static/image8.png)</span></span>

<span data-ttu-id="31288-144">**圖 4**：將 HyperLinkField 新增至 GridView （[按一下以觀看完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image10.png)）</span><span class="sxs-lookup"><span data-stu-id="31288-144">**Figure 4**: Add a HyperLinkField to the GridView ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image10.png))</span></span>

<span data-ttu-id="31288-145">HyperLinkField 可以設定為使用相同的文字或 URL 值，每個 GridView 資料列中的連結，或者可以根據系結至每個特定資料列的資料值來做為這些值的依據。</span><span class="sxs-lookup"><span data-stu-id="31288-145">The HyperLinkField can be configured to use the same text or URL values the link in each GridView row, or can base these values on the data values bound to each particular row.</span></span> <span data-ttu-id="31288-146">若要在所有資料列上指定靜態值，請使用 HyperLinkField 的 `Text` 或 `NavigateUrl` 屬性。</span><span class="sxs-lookup"><span data-stu-id="31288-146">To specify a static value across all rows use the HyperLinkField's `Text` or `NavigateUrl` properties.</span></span> <span data-ttu-id="31288-147">因為我們希望所有資料列的連結文字都相同，所以請將 HyperLinkField 的 `Text` 屬性設定為 [View Products] （產品）。</span><span class="sxs-lookup"><span data-stu-id="31288-147">Since we want the link text to be the same for all rows, set the HyperLinkField's `Text` property to View Products.</span></span>

<span data-ttu-id="31288-148">[![設定 HyperLinkField 的 Text 屬性以查看產品](master-detail-filtering-across-two-pages-vb/_static/image12.png)](master-detail-filtering-across-two-pages-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="31288-148">[![Set the HyperLinkField's Text Property to View Products](master-detail-filtering-across-two-pages-vb/_static/image12.png)](master-detail-filtering-across-two-pages-vb/_static/image11.png)</span></span>

<span data-ttu-id="31288-149">**圖 5**：將 HyperLinkField 的 `Text` 屬性設定為可觀看產品（[按一下以觀看完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image13.png)）</span><span class="sxs-lookup"><span data-stu-id="31288-149">**Figure 5**: Set the HyperLinkField's `Text` Property to View Products ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image13.png))</span></span>

<span data-ttu-id="31288-150">若要將文字或 URL 值設定為根據系結至 GridView 資料列的基礎資料，請在 [`DataTextField`] 或 [`DataNavigateUrlFields` 屬性] 中指定要從中提取文字或 URL 值的資料欄位。</span><span class="sxs-lookup"><span data-stu-id="31288-150">To set the text or URL values to be based on the underlying data bound to the GridView row, specify the data fields the text or URL values should be pulled from in the `DataTextField` or `DataNavigateUrlFields` properties.</span></span> <span data-ttu-id="31288-151">`DataTextField` 只能設定為單一資料欄位;不過，`DataNavigateUrlFields`可以設定為以逗號分隔的資料欄位清單。</span><span class="sxs-lookup"><span data-stu-id="31288-151">`DataTextField` can only be set to a single data field; `DataNavigateUrlFields`, however, can be set to a comma-delimited list of data fields.</span></span> <span data-ttu-id="31288-152">我們經常需要以目前資料列的資料欄值和一些靜態標記的組合做為文字或 URL 的基礎。</span><span class="sxs-lookup"><span data-stu-id="31288-152">We frequently need to base the text or URL on a combination of the current row's data field value and some static markup.</span></span> <span data-ttu-id="31288-153">例如，在本教學課程中，我們想要 `ProductsForSupplierDetails.aspx?SupplierID=supplierID`HyperLinkField 連結的 URL，其中 *`supplierID`* 是每個 GridView 的 row's `SupplierID` 值。</span><span class="sxs-lookup"><span data-stu-id="31288-153">In this tutorial, for example, we want the URL of the HyperLinkField's links to be `ProductsForSupplierDetails.aspx?SupplierID=supplierID`, where *`supplierID`* is each GridView's row's `SupplierID` value.</span></span> <span data-ttu-id="31288-154">請注意，這裡需要靜態和資料驅動的值：連結 URL 的 `ProductsForSupplierDetails.aspx?SupplierID=` 部分是靜態的，而 *`supplierID`* 部分則是資料驅動的，因為它的值是每個資料列本身的 `SupplierID` 值。</span><span class="sxs-lookup"><span data-stu-id="31288-154">Notice that we need both static and data-driven values here: the `ProductsForSupplierDetails.aspx?SupplierID=` portion of the link's URL is static, whereas the *`supplierID`* portion is data-driven as its value is each row's own `SupplierID` value.</span></span>

<span data-ttu-id="31288-155">若要指示靜態和資料驅動值的組合，請使用 `DataTextFormatString` 並 `DataNavigateUrlFormatString` 屬性。</span><span class="sxs-lookup"><span data-stu-id="31288-155">To indicate a combination of static and data-driven values, use the `DataTextFormatString` and `DataNavigateUrlFormatString` properties.</span></span> <span data-ttu-id="31288-156">在這些屬性中，視需要輸入靜態標記，然後使用標記 `{0}` 您想要在 [`DataTextField`] 或 [`DataNavigateUrlFields` 屬性] 中指定的欄位值出現。</span><span class="sxs-lookup"><span data-stu-id="31288-156">In these properties enter the static markup as needed and then use the marker `{0}` where you want the value of the field specified in the `DataTextField` or `DataNavigateUrlFields` properties to appear.</span></span> <span data-ttu-id="31288-157">如果 `DataNavigateUrlFields` 屬性已指定多個欄位，請使用 `{0}` 您想要插入的第一個域值，`{1}` 作為第二個域值，依此類推。</span><span class="sxs-lookup"><span data-stu-id="31288-157">If the `DataNavigateUrlFields` property has multiple fields specified use `{0}` where you want the first field value inserted, `{1}` for the second field value, and so on.</span></span>

<span data-ttu-id="31288-158">將此套用到我們的教學課程時，我們必須將 `DataNavigateUrlFields` 屬性設為 `SupplierID`，因為這是我們需要以每個資料列為基礎自訂之值的資料欄位，以及要 `ProductsForSupplierDetails.aspx?SupplierID={0}`的 `DataNavigateUrlFormatString` 屬性。</span><span class="sxs-lookup"><span data-stu-id="31288-158">Applying this to our tutorial, we need to set the `DataNavigateUrlFields` property to `SupplierID`, since that's the data field whose value we need to customize on a per-row basis, and the `DataNavigateUrlFormatString` property to `ProductsForSupplierDetails.aspx?SupplierID={0}`.</span></span>

<span data-ttu-id="31288-159">[![將 HyperLinkField 設定為根據建立的供應商包含適當的連結 URL](master-detail-filtering-across-two-pages-vb/_static/image15.png)](master-detail-filtering-across-two-pages-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="31288-159">[![Configure the HyperLinkField to Include the Proper Link URL Based Upon the SupplierID](master-detail-filtering-across-two-pages-vb/_static/image15.png)](master-detail-filtering-across-two-pages-vb/_static/image14.png)</span></span>

<span data-ttu-id="31288-160">**圖 6**：設定 HyperLinkField 以根據 `SupplierID` 包含適當的連結 URL （[按一下以觀看完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image16.png)）</span><span class="sxs-lookup"><span data-stu-id="31288-160">**Figure 6**: Configure the HyperLinkField to Include the Proper Link URL Based Upon the `SupplierID` ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image16.png))</span></span>

<span data-ttu-id="31288-161">加入 HyperLinkField 之後，您可以隨意自訂並重新排列 GridView 的欄位。</span><span class="sxs-lookup"><span data-stu-id="31288-161">After adding the HyperLinkField, feel free to customize and reorder the GridView's fields.</span></span> <span data-ttu-id="31288-162">當我進行一些次要欄位層級自訂之後，下列標記會顯示 GridView。</span><span class="sxs-lookup"><span data-stu-id="31288-162">The following markup shows the GridView after I've made some minor field-level customizations.</span></span>

[!code-aspx[Main](master-detail-filtering-across-two-pages-vb/samples/sample2.aspx)]

<span data-ttu-id="31288-163">請花點時間透過瀏覽器來觀看 `SupplierListMaster.aspx` 頁面。</span><span class="sxs-lookup"><span data-stu-id="31288-163">Take a moment to view the `SupplierListMaster.aspx` page through a browser.</span></span> <span data-ttu-id="31288-164">如 [圖 7] 所示，此頁面目前列出所有供應商，包括 [View Products] 連結。</span><span class="sxs-lookup"><span data-stu-id="31288-164">As Figure 7 shows, the page currently lists all of the suppliers including a View Products link.</span></span> <span data-ttu-id="31288-165">按一下 [View Products] 連結將會帶您前往 `ProductsForSupplierDetails.aspx`，並在查詢字串中傳遞供應商的 `SupplierID`。</span><span class="sxs-lookup"><span data-stu-id="31288-165">Clicking on the View Products link will take you to `ProductsForSupplierDetails.aspx`, passing along the supplier's `SupplierID` in the querystring.</span></span>

<span data-ttu-id="31288-166">[![每個供應商資料列都包含 View Products 連結](master-detail-filtering-across-two-pages-vb/_static/image18.png)](master-detail-filtering-across-two-pages-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="31288-166">[![Each Supplier Row Contains a View Products Link](master-detail-filtering-across-two-pages-vb/_static/image18.png)](master-detail-filtering-across-two-pages-vb/_static/image17.png)</span></span>

<span data-ttu-id="31288-167">**圖 7**：每個供應商資料列都包含 [view Products] 連結（[按一下以查看完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image19.png)）</span><span class="sxs-lookup"><span data-stu-id="31288-167">**Figure 7**: Each Supplier Row Contains a View Products Link ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image19.png))</span></span>

## <a name="step-3-listing-the-suppliers-products-inproductsforsupplierdetailsaspx"></a><span data-ttu-id="31288-168">步驟3：在`ProductsForSupplierDetails.aspx` 中列出供應商的產品</span><span class="sxs-lookup"><span data-stu-id="31288-168">Step 3: Listing the Supplier's Products in`ProductsForSupplierDetails.aspx`</span></span>

<span data-ttu-id="31288-169">此時，`SupplierListMaster.aspx` 頁面會將使用者傳送至 `ProductsForSupplierDetails.aspx`，並在 querystring 中傳遞所選供應商的 `SupplierID`。</span><span class="sxs-lookup"><span data-stu-id="31288-169">At this point the `SupplierListMaster.aspx` page is sending users to `ProductsForSupplierDetails.aspx`, passing the selected supplier's `SupplierID` in the querystring.</span></span> <span data-ttu-id="31288-170">本教學課程的最後一個步驟是在 `ProductsForSupplierDetails.aspx` 中顯示 GridView 中的產品，其 `SupplierID` 等於透過 querystring 傳遞的 `SupplierID`。</span><span class="sxs-lookup"><span data-stu-id="31288-170">The tutorial's final step is to display the products in a GridView in `ProductsForSupplierDetails.aspx` whose `SupplierID` equals the `SupplierID` passed in through the querystring.</span></span> <span data-ttu-id="31288-171">若要完成這項工作，請先使用名為 `ProductsBySupplierDataSource` 的新 ObjectDataSource 控制項，從 `ProductsBLL` 類別叫用 `GetProductsBySupplierID(supplierID)` 方法，以將 GridView 加入至 `ProductsForSupplierDetails.aspx` 頁面。</span><span class="sxs-lookup"><span data-stu-id="31288-171">To accomplish this start by adding a GridView to the `ProductsForSupplierDetails.aspx` page, using a new ObjectDataSource control named `ProductsBySupplierDataSource` that invokes the `GetProductsBySupplierID(supplierID)` method from the `ProductsBLL` class.</span></span>

<span data-ttu-id="31288-172">[![新增名為 ProductsBySupplierDataSource 的新 ObjectDataSource](master-detail-filtering-across-two-pages-vb/_static/image21.png)](master-detail-filtering-across-two-pages-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="31288-172">[![Add a New ObjectDataSource Named ProductsBySupplierDataSource](master-detail-filtering-across-two-pages-vb/_static/image21.png)](master-detail-filtering-across-two-pages-vb/_static/image20.png)</span></span>

<span data-ttu-id="31288-173">**圖 8**：新增名為 `ProductsBySupplierDataSource` 的新 ObjectDataSource （[按一下以查看完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image22.png)）</span><span class="sxs-lookup"><span data-stu-id="31288-173">**Figure 8**: Add a New ObjectDataSource Named `ProductsBySupplierDataSource` ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image22.png))</span></span>

<span data-ttu-id="31288-174">[![選取 ProductsBLL 類別](master-detail-filtering-across-two-pages-vb/_static/image24.png)](master-detail-filtering-across-two-pages-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="31288-174">[![Select the ProductsBLL Class](master-detail-filtering-across-two-pages-vb/_static/image24.png)](master-detail-filtering-across-two-pages-vb/_static/image23.png)</span></span>

<span data-ttu-id="31288-175">**圖 9**：選取 [`ProductsBLL`] 類別（[按一下以查看完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image25.png)）</span><span class="sxs-lookup"><span data-stu-id="31288-175">**Figure 9**: Select the `ProductsBLL` Class ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image25.png))</span></span>

<span data-ttu-id="31288-176">[![讓 ObjectDataSource 叫用 GetProductsBySupplierID （的「已供應商）方法](master-detail-filtering-across-two-pages-vb/_static/image27.png)](master-detail-filtering-across-two-pages-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="31288-176">[![Have the ObjectDataSource Invoke the GetProductsBySupplierID(supplierID) Method](master-detail-filtering-across-two-pages-vb/_static/image27.png)](master-detail-filtering-across-two-pages-vb/_static/image26.png)</span></span>

<span data-ttu-id="31288-177">**圖 10**：讓 ObjectDataSource 叫用 `GetProductsBySupplierID(supplierID)` 方法（[按一下以查看完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image28.png)）</span><span class="sxs-lookup"><span data-stu-id="31288-177">**Figure 10**: Have the ObjectDataSource Invoke the `GetProductsBySupplierID(supplierID)` Method ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image28.png))</span></span>

<span data-ttu-id="31288-178">[設定資料來源] 嚮導的最後一個步驟會要求我們提供 `GetProductsBySupplierID(supplierID)` 方法 *`supplierID`* 參數的來源。</span><span class="sxs-lookup"><span data-stu-id="31288-178">The final step of the Configure Data Source wizard asks us to provide the source of the `GetProductsBySupplierID(supplierID)` method's *`supplierID`* parameter.</span></span> <span data-ttu-id="31288-179">若要使用 querystring 值，請將參數來源設定為 QueryString，並在 [QueryStringField] 文字方塊中輸入要使用之 querystring 值的名稱（`SupplierID`）。</span><span class="sxs-lookup"><span data-stu-id="31288-179">To use the querystring value, set the Parameter source to QueryString and enter the name of the querystring value to use in the QueryStringField textbox (`SupplierID`).</span></span>

<span data-ttu-id="31288-180">[![填入來自于 [已的] 參數字串值](master-detail-filtering-across-two-pages-vb/_static/image30.png)](master-detail-filtering-across-two-pages-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="31288-180">[![Populate the supplierID Parameter Value from the SupplierID Querystring Value](master-detail-filtering-across-two-pages-vb/_static/image30.png)](master-detail-filtering-across-two-pages-vb/_static/image29.png)</span></span>

<span data-ttu-id="31288-181">**圖 11**：填入來自 `SupplierID` Querystring 值的 *`supplierID`* 參數值（[按一下以查看完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image31.png)）</span><span class="sxs-lookup"><span data-stu-id="31288-181">**Figure 11**: Populate the *`supplierID`* Parameter Value from the `SupplierID` Querystring Value ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image31.png))</span></span>

<span data-ttu-id="31288-182">這樣就全部完成了！</span><span class="sxs-lookup"><span data-stu-id="31288-182">That's all there is to it!</span></span> <span data-ttu-id="31288-183">[圖 12] 從 `SupplierListMaster.aspx`按一下 [東京貿易] 連結來顯示 [`ProductsForSupplierDetails.aspx`] 頁面。</span><span class="sxs-lookup"><span data-stu-id="31288-183">Figure 12 shows the `ProductsForSupplierDetails.aspx` page when visited by clicking the Tokyo Traders link from `SupplierListMaster.aspx`.</span></span>

<span data-ttu-id="31288-184">[![會顯示東京貿易所提供的產品](master-detail-filtering-across-two-pages-vb/_static/image33.png)](master-detail-filtering-across-two-pages-vb/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="31288-184">[![The Products Supplied by Tokyo Traders are Shown](master-detail-filtering-across-two-pages-vb/_static/image33.png)](master-detail-filtering-across-two-pages-vb/_static/image32.png)</span></span>

<span data-ttu-id="31288-185">**圖 12**：顯示東京商貿所提供的產品（[按一下以觀看完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image34.png)）</span><span class="sxs-lookup"><span data-stu-id="31288-185">**Figure 12**: The Products Supplied by Tokyo Traders are Shown ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image34.png))</span></span>

## <a name="displaying-supplier-information-inproductsforsupplierdetailsaspx"></a><span data-ttu-id="31288-186">在`ProductsForSupplierDetails.aspx` 中顯示供應商資訊</span><span class="sxs-lookup"><span data-stu-id="31288-186">Displaying Supplier Information in`ProductsForSupplierDetails.aspx`</span></span>

<span data-ttu-id="31288-187">如 [圖 12] 所示，[`ProductsForSupplierDetails.aspx`] 頁面只會列出查詢字串中所指定之 `SupplierID` 所提供的產品。</span><span class="sxs-lookup"><span data-stu-id="31288-187">As Figure 12 shows, the `ProductsForSupplierDetails.aspx` page simply lists the products that are supplied by the `SupplierID` specified in the querystring.</span></span> <span data-ttu-id="31288-188">不過，直接傳送到此頁面的人不知道 [圖 12] 顯示東京貿易的產品。</span><span class="sxs-lookup"><span data-stu-id="31288-188">Someone sent directly to this page, however, would not know that Figure 12 is showing Tokyo Traders' products.</span></span> <span data-ttu-id="31288-189">若要解決此問題，我們也可以在此頁面中顯示供應商資訊。</span><span class="sxs-lookup"><span data-stu-id="31288-189">To remedy this we can display supplier information in this page as well.</span></span>

<span data-ttu-id="31288-190">首先，在 [products] GridView 上方新增 FormView。</span><span class="sxs-lookup"><span data-stu-id="31288-190">Start by adding a FormView above the products GridView.</span></span> <span data-ttu-id="31288-191">建立名為 `SuppliersDataSource` 的新 ObjectDataSource 控制項，以叫用 `SuppliersBLL` 類別的 `GetSupplierBySupplierID(supplierID)` 方法。</span><span class="sxs-lookup"><span data-stu-id="31288-191">Create a new ObjectDataSource control named `SuppliersDataSource` that invokes the `SuppliersBLL` class's `GetSupplierBySupplierID(supplierID)` method.</span></span>

<span data-ttu-id="31288-192">[![選取 SuppliersBLL 類別](master-detail-filtering-across-two-pages-vb/_static/image36.png)](master-detail-filtering-across-two-pages-vb/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="31288-192">[![Select the SuppliersBLL Class](master-detail-filtering-across-two-pages-vb/_static/image36.png)](master-detail-filtering-across-two-pages-vb/_static/image35.png)</span></span>

<span data-ttu-id="31288-193">**圖 13**：選取 [`SuppliersBLL`] 類別（[按一下以查看完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image37.png)）</span><span class="sxs-lookup"><span data-stu-id="31288-193">**Figure 13**: Select the `SuppliersBLL` Class ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image37.png))</span></span>

<span data-ttu-id="31288-194">[![讓 ObjectDataSource 叫用 GetSupplierBySupplierID （的「已供應商）方法](master-detail-filtering-across-two-pages-vb/_static/image39.png)](master-detail-filtering-across-two-pages-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="31288-194">[![Have the ObjectDataSource Invoke the GetSupplierBySupplierID(supplierID) Method](master-detail-filtering-across-two-pages-vb/_static/image39.png)](master-detail-filtering-across-two-pages-vb/_static/image38.png)</span></span>

<span data-ttu-id="31288-195">**圖 14**：讓 ObjectDataSource 叫用 `GetSupplierBySupplierID(supplierID)` 方法（[按一下以查看完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image40.png)）</span><span class="sxs-lookup"><span data-stu-id="31288-195">**Figure 14**: Have the ObjectDataSource Invoke the `GetSupplierBySupplierID(supplierID)` Method ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image40.png))</span></span>

<span data-ttu-id="31288-196">如同 `ProductsBySupplierDataSource`，請 *`supplierID`* 參數指派 `SupplierID` querystring 值的值。</span><span class="sxs-lookup"><span data-stu-id="31288-196">As with the `ProductsBySupplierDataSource`, have the *`supplierID`* parameter assigned the value of the `SupplierID` querystring value.</span></span>

<span data-ttu-id="31288-197">[![填入來自于 [已的] 參數字串值](master-detail-filtering-across-two-pages-vb/_static/image42.png)](master-detail-filtering-across-two-pages-vb/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="31288-197">[![Populate the supplierID Parameter Value from the SupplierID Querystring Value](master-detail-filtering-across-two-pages-vb/_static/image42.png)](master-detail-filtering-across-two-pages-vb/_static/image41.png)</span></span>

<span data-ttu-id="31288-198">**圖 15**：填入來自 `SupplierID` Querystring 值的 *`supplierID`* 參數值（[按一下以查看完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image43.png)）</span><span class="sxs-lookup"><span data-stu-id="31288-198">**Figure 15**: Populate the *`supplierID`* Parameter Value from the `SupplierID` Querystring Value ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image43.png))</span></span>

<span data-ttu-id="31288-199">將 FormView 系結至設計檢視中的 ObjectDataSource 時，Visual Studio 會自動為 ObjectDataSource 所傳回的每個資料欄位建立 FormView 的 `ItemTemplate`、`InsertItemTemplate`和 `EditItemTemplate` 以及標籤和 TextBox Web 控制項。</span><span class="sxs-lookup"><span data-stu-id="31288-199">When binding the FormView to the ObjectDataSource in the Design view, Visual Studio will automatically create the FormView's `ItemTemplate`, `InsertItemTemplate`, and `EditItemTemplate` with Label and TextBox Web controls for each of the data fields returned by the ObjectDataSource.</span></span> <span data-ttu-id="31288-200">因為我們只想要顯示供應商資訊，所以請隨意移除 `InsertItemTemplate` 和 `EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="31288-200">Since we just want to display supplier information feel free to remove the `InsertItemTemplate` and `EditItemTemplate`.</span></span> <span data-ttu-id="31288-201">接著，編輯 ItemTemplate，使其在 [`<h3>`] 專案中顯示供應商的公司名稱，並在 [公司名稱] 下方的 [位址]、[城市]、[國家] 和 [電話號碼]。</span><span class="sxs-lookup"><span data-stu-id="31288-201">Next, edit the ItemTemplate so that it displays the supplier's company name in an `<h3>` element and the address, city, country, and phone number beneath the company name.</span></span> <span data-ttu-id="31288-202">或者，您也可以手動設定 FormView 的 `DataSourceID` 並建立 `ItemTemplate` 標記，如同我們在「[使用 ObjectDataSource 顯示資料](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md)」教學課程中所做的一樣。</span><span class="sxs-lookup"><span data-stu-id="31288-202">Alternatively, you can manually set the FormView's `DataSourceID` and create the `ItemTemplate` markup, as we did back in the "[Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md)" tutorial.</span></span>

<span data-ttu-id="31288-203">在這些編輯之後，FormView 的宣告式標記看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="31288-203">After these edits the FormView's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](master-detail-filtering-across-two-pages-vb/samples/sample3.aspx)]

<span data-ttu-id="31288-204">[圖 16] 顯示已包含上述的供應商資訊之後，[`ProductsForSupplierDetails.aspx`] 頁面的螢幕擷取畫面。</span><span class="sxs-lookup"><span data-stu-id="31288-204">Figure 16 shows a screen shot of the `ProductsForSupplierDetails.aspx` page after the supplier information detailed above has been included.</span></span>

<span data-ttu-id="31288-205">[![產品清單包含供應商的相關摘要](master-detail-filtering-across-two-pages-vb/_static/image45.png)](master-detail-filtering-across-two-pages-vb/_static/image44.png)</span><span class="sxs-lookup"><span data-stu-id="31288-205">[![The List of Products Includes a Summary About the Supplier](master-detail-filtering-across-two-pages-vb/_static/image45.png)](master-detail-filtering-across-two-pages-vb/_static/image44.png)</span></span>

<span data-ttu-id="31288-206">**圖 16**：產品清單包含供應商的摘要（[按一下以觀看完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image46.png)）</span><span class="sxs-lookup"><span data-stu-id="31288-206">**Figure 16**: The List of Products Includes a Summary About the Supplier ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image46.png))</span></span>

## <a name="applying-the-final-touches-for-theproductsforsupplierdetailsaspxui"></a><span data-ttu-id="31288-207">為`ProductsForSupplierDetails.aspx`UI 套用最後的潤色</span><span class="sxs-lookup"><span data-stu-id="31288-207">Applying the Final Touches for the`ProductsForSupplierDetails.aspx`UI</span></span>

<span data-ttu-id="31288-208">若要改善此報表的使用者體驗，我們應該對 [`ProductsForSupplierDetails.aspx`] 頁面進行幾項新增。</span><span class="sxs-lookup"><span data-stu-id="31288-208">To improve the user experience for this report there are a couple of additions we ought to make to the `ProductsForSupplierDetails.aspx` page.</span></span> <span data-ttu-id="31288-209">使用者目前唯一可以從 [`ProductsForSupplierDetails.aspx`] 頁面移回供應商清單的方式，是按一下其瀏覽器的 [上一頁] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="31288-209">Currently the only way a user can go from the `ProductsForSupplierDetails.aspx` page back to the list of suppliers is to click their browser's back button.</span></span> <span data-ttu-id="31288-210">讓我們將超連結控制項新增至連結回到 `SupplierListMaster.aspx`的 [`ProductsForSupplierDetails.aspx`] 頁面，以提供另一種方法讓使用者回到主要清單。</span><span class="sxs-lookup"><span data-stu-id="31288-210">Let's add a HyperLink control to the `ProductsForSupplierDetails.aspx` page that links back to `SupplierListMaster.aspx`, providing another way for the user to return to the master list.</span></span>

<span data-ttu-id="31288-211">[![新增超連結控制項，讓使用者回到 SupplierListMaster .aspx](master-detail-filtering-across-two-pages-vb/_static/image48.png)](master-detail-filtering-across-two-pages-vb/_static/image47.png)</span><span class="sxs-lookup"><span data-stu-id="31288-211">[![Add a HyperLink Control to Take the User Back to SupplierListMaster.aspx](master-detail-filtering-across-two-pages-vb/_static/image48.png)](master-detail-filtering-across-two-pages-vb/_static/image47.png)</span></span>

<span data-ttu-id="31288-212">**圖 17**：新增超連結控制項，讓使用者回到 `SupplierListMaster.aspx` （[按一下以觀看完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image49.png)）</span><span class="sxs-lookup"><span data-stu-id="31288-212">**Figure 17**: Add a HyperLink Control to Take the User Back to `SupplierListMaster.aspx` ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image49.png))</span></span>

<span data-ttu-id="31288-213">如果使用者針對沒有任何產品的供應商按一下 [View Products] 連結，`ProductsForSupplierDetails.aspx` 中的 `ProductsBySupplierDataSource` ObjectDataSource 就不會傳回任何結果。</span><span class="sxs-lookup"><span data-stu-id="31288-213">If the user clicks on the View Products link for a supplier that doesn't have any products, the `ProductsBySupplierDataSource` ObjectDataSource in `ProductsForSupplierDetails.aspx` won't return any results.</span></span> <span data-ttu-id="31288-214">系結至 ObjectDataSource 的 GridView 不會在使用者的瀏覽器中呈現頁面上產生空白區域的任何標記。</span><span class="sxs-lookup"><span data-stu-id="31288-214">The GridView bound to the ObjectDataSource won't render any markup resulting in a blank region on the page in the user's browser.</span></span> <span data-ttu-id="31288-215">為了更清楚地向使用者傳達沒有與所選供應商相關聯的產品，我們可以將 GridView 的 `EmptyDataText` 屬性設定為要在發生這種情況時顯示的訊息。</span><span class="sxs-lookup"><span data-stu-id="31288-215">To more clearly communicate to the user that there are no products associated with the selected supplier we can set the GridView's `EmptyDataText` property to the message we want displayed when such a situation arises.</span></span> <span data-ttu-id="31288-216">我已將此屬性設定為「沒有此供應商提供的產品」</span><span class="sxs-lookup"><span data-stu-id="31288-216">I've set this property to "There are no products provided by this supplier�"</span></span>

<span data-ttu-id="31288-217">根據預設，Northwinds 資料庫中的所有供應商至少會提供一項產品。</span><span class="sxs-lookup"><span data-stu-id="31288-217">By default, all suppliers in the Northwinds database provide at least one product.</span></span> <span data-ttu-id="31288-218">不過，在本教學課程中，我手動修改了 `Products` 的資料表，讓供應商 Escargots Nouveaux 不再與任何產品相關聯。</span><span class="sxs-lookup"><span data-stu-id="31288-218">However, for this tutorial I've manually modified the `Products` table so that the supplier Escargots Nouveaux is no longer associated with any products.</span></span> <span data-ttu-id="31288-219">[圖 18] 顯示在進行此變更之後 Escargots Nouveaux 的詳細資料頁面。</span><span class="sxs-lookup"><span data-stu-id="31288-219">Figure 18 shows the details page for Escargots Nouveaux after this change has been made.</span></span>

<span data-ttu-id="31288-220">[![使用者會收到通知，表示供應商未提供任何產品](master-detail-filtering-across-two-pages-vb/_static/image51.png)](master-detail-filtering-across-two-pages-vb/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="31288-220">[![Users are Informed that the Supplier Doesn't Provide Any Products](master-detail-filtering-across-two-pages-vb/_static/image51.png)](master-detail-filtering-across-two-pages-vb/_static/image50.png)</span></span>

<span data-ttu-id="31288-221">**圖 18**：通知使用者供應商未提供任何產品（[按一下以觀看完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image52.png)）</span><span class="sxs-lookup"><span data-stu-id="31288-221">**Figure 18**: Users are Informed that the Supplier Doesn't Provide Any Products ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image52.png))</span></span>

## <a name="summary"></a><span data-ttu-id="31288-222">總結</span><span class="sxs-lookup"><span data-stu-id="31288-222">Summary</span></span>

<span data-ttu-id="31288-223">雖然主要/詳細資料包表可以在單一頁面上顯示主要和詳細資料記錄，但在許多網站中，它們會分成兩個網頁。</span><span class="sxs-lookup"><span data-stu-id="31288-223">While master/detail reports can display both the master and detail records on a single page, in many websites they are separated out across two web pages.</span></span> <span data-ttu-id="31288-224">在本教學課程中，我們探討了如何在「主要」網頁的 GridView 中列出供應商，以及在 [詳細資料] 頁面中列出相關聯的產品，以執行這類主要/詳細報告。</span><span class="sxs-lookup"><span data-stu-id="31288-224">In this tutorial we looked at how to implement such a master/detail report by having the suppliers listed in a GridView in the "master" web page and the associated products listed in the "details" page.</span></span> <span data-ttu-id="31288-225">主要網頁中的每個供應商資料列都包含以資料列的 `SupplierID` 值傳遞之詳細資料頁面的連結。</span><span class="sxs-lookup"><span data-stu-id="31288-225">Each supplier row in the master web page contained a link to the details page that passed along the row's `SupplierID` value.</span></span> <span data-ttu-id="31288-226">您可以使用 GridView 的 HyperLinkField 輕鬆地加入這類資料列特定連結。</span><span class="sxs-lookup"><span data-stu-id="31288-226">Such row-specific links can be easily added using the GridView's HyperLinkField.</span></span>

<span data-ttu-id="31288-227">在詳細資料頁面中，藉由叫用 `ProductsBLL` 類別的 `GetProductsBySupplierID(supplierID)` 方法，來為指定的供應商抓取這些產品。</span><span class="sxs-lookup"><span data-stu-id="31288-227">In the details page retrieving those products for the specified supplier was accomplished by invoking the `ProductsBLL` class's `GetProductsBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="31288-228">*`supplierID`* 參數值是使用 querystring 當做參數來源以宣告方式指定。</span><span class="sxs-lookup"><span data-stu-id="31288-228">The *`supplierID`* parameter value was specified declaratively using the querystring as the parameter source.</span></span> <span data-ttu-id="31288-229">我們也探討了如何使用 FormView 在詳細資料頁面中顯示供應商詳細資料。</span><span class="sxs-lookup"><span data-stu-id="31288-229">We also looked at how to display the supplier details in the details page using a FormView.</span></span>

<span data-ttu-id="31288-230">我們的[下一個教學](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb.md)課程是主要/詳細資料包告上的最後一個教學課程。</span><span class="sxs-lookup"><span data-stu-id="31288-230">Our [next tutorial](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb.md) is the final one on master/detail reports.</span></span> <span data-ttu-id="31288-231">我們將探討如何在 GridView 中顯示產品清單，其中每個資料列都有 [選取] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="31288-231">We'll look at how to display a list of products in a GridView where each row has a Select button.</span></span> <span data-ttu-id="31288-232">按一下 [選取] 按鈕，將會在相同頁面上的 DetailsView 控制項中顯示該產品的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="31288-232">Clicking on the Select button will display that product's details in a DetailsView control on the same page.</span></span>

<span data-ttu-id="31288-233">快樂的程式設計！</span><span class="sxs-lookup"><span data-stu-id="31288-233">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="31288-234">關於作者</span><span class="sxs-lookup"><span data-stu-id="31288-234">About the Author</span></span>

<span data-ttu-id="31288-235">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，自1998起，有七個 ASP/ASP. NET 書籍和創辦人的[4GuysFromRolla.com](http://www.4guysfromrolla.com)。</span><span class="sxs-lookup"><span data-stu-id="31288-235">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="31288-236">Scott 以獨立的顧問、訓練員和作者的身分運作。</span><span class="sxs-lookup"><span data-stu-id="31288-236">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="31288-237">他的最新著作是[*在24小時內讓自己的 ASP.NET 2.0*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="31288-237">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="31288-238">他可以在mitchell@4GuysFromRolla.com觸達[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="31288-238">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="31288-239">或者透過他的 blog，可以在[http://ScottOnWriting.NET](http://ScottOnWriting.NET)找到。</span><span class="sxs-lookup"><span data-stu-id="31288-239">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="31288-240">特別感謝</span><span class="sxs-lookup"><span data-stu-id="31288-240">Special Thanks To</span></span>

<span data-ttu-id="31288-241">本教學課程系列已由許多有用的審核者所審查。</span><span class="sxs-lookup"><span data-stu-id="31288-241">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="31288-242">本教學課程的領導審查者為 Hilton Giesenow。</span><span class="sxs-lookup"><span data-stu-id="31288-242">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="31288-243">有興趣複習我即將發行的 MSDN 文章嗎？</span><span class="sxs-lookup"><span data-stu-id="31288-243">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="31288-244">若是如此，請在mitchell@4GuysFromRolla.com的那一行下拉式[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="31288-244">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="31288-245">[上一頁](master-detail-filtering-with-two-dropdownlists-vb.md)
> [下一頁](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb.md)</span><span class="sxs-lookup"><span data-stu-id="31288-245">[Previous](master-detail-filtering-with-two-dropdownlists-vb.md)
[Next](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb.md)</span></span>
