---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-vb
title: 更新 TableAdapter 以使用 Join (VB) |Microsoft Docs
author: rick-anderson
description: 使用資料庫時通常會要求資料，則會分散到多個資料表。 若要擷取兩個不同的資料表資料的我們可以使用...
ms.author: riande
ms.date: 07/18/2007
ms.assetid: e624a3e0-061b-4efc-8b0e-5877f9ff6714
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-vb
msc.type: authoredcontent
ms.openlocfilehash: 943b8a67e77e4ed449e0b2c887b3cae7cc10f305
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/17/2019
ms.locfileid: "59383430"
---
# <a name="updating-the-tableadapter-to-use-joins-vb"></a><span data-ttu-id="3241c-104">更新 TableAdapter 以使用 JOIN (VB)</span><span class="sxs-lookup"><span data-stu-id="3241c-104">Updating the TableAdapter to Use JOINs (VB)</span></span>

<span data-ttu-id="3241c-105">藉由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="3241c-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="3241c-106">[下載程式碼](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_VB.zip)或[下載 PDF](updating-the-tableadapter-to-use-joins-vb/_static/datatutorial69vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="3241c-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_VB.zip) or [Download PDF](updating-the-tableadapter-to-use-joins-vb/_static/datatutorial69vb1.pdf)</span></span>

> <span data-ttu-id="3241c-107">使用資料庫時通常會要求資料，則會分散到多個資料表。</span><span class="sxs-lookup"><span data-stu-id="3241c-107">When working with a database it is common to request data that is spread across multiple tables.</span></span> <span data-ttu-id="3241c-108">若要從兩個不同資料表中擷取資料中，我們可以使用相互關聯子查詢或聯結作業。</span><span class="sxs-lookup"><span data-stu-id="3241c-108">To retrieve data from two different tables we can use either a correlated subquery or a JOIN operation.</span></span> <span data-ttu-id="3241c-109">在本教學課程我們再看看如何建立包含聯結，在其主查詢的 TableAdapter 比較相互關聯子查詢和聯結語法。</span><span class="sxs-lookup"><span data-stu-id="3241c-109">In this tutorial we compare correlated subqueries and the JOIN syntax before looking at how to create a TableAdapter that includes a JOIN in its main query.</span></span>


## <a name="introduction"></a><span data-ttu-id="3241c-110">簡介</span><span class="sxs-lookup"><span data-stu-id="3241c-110">Introduction</span></span>

<span data-ttu-id="3241c-111">與關聯式資料庫通常是分散多個資料表的我們有興趣使用的資料。</span><span class="sxs-lookup"><span data-stu-id="3241c-111">With relational databases the data we are interested in working with is often spread across multiple tables.</span></span> <span data-ttu-id="3241c-112">例如，顯示產品資訊時我們可能想要列出每個產品 s 對應類別目錄和供應商 s 的名稱。</span><span class="sxs-lookup"><span data-stu-id="3241c-112">For example, when displaying product information we likely want to list each product s corresponding category and supplier s names.</span></span> <span data-ttu-id="3241c-113">`Products`資料表有`CategoryID`並`SupplierID`值，但實際的類別和供應商名稱位於`Categories`和`Suppliers`分別資料表。</span><span class="sxs-lookup"><span data-stu-id="3241c-113">The `Products` table has `CategoryID` and `SupplierID` values, but the actual category and supplier names are in the `Categories` and `Suppliers` tables, respectively.</span></span>

<span data-ttu-id="3241c-114">若要從另一個相關的資料表擷取資訊，我們可以使用*相互關聯子查詢*或是`JOIN` *s*。</span><span class="sxs-lookup"><span data-stu-id="3241c-114">To retrieve information from another, related table, we can either use *correlated subqueries* or `JOIN`*s*.</span></span> <span data-ttu-id="3241c-115">相互關聯子查詢是巢狀`SELECT`參考外部查詢中的資料行的查詢。</span><span class="sxs-lookup"><span data-stu-id="3241c-115">A correlated subquery is a nested `SELECT` query that references columns in the outer query.</span></span> <span data-ttu-id="3241c-116">例如，在[建立資料存取層](../introduction/creating-a-data-access-layer-vb.md)教學課程中我們使用中的兩個相互關聯子查詢`ProductsTableAdapter`s 主要查詢來傳回每個產品類別目錄和供應商名稱。</span><span class="sxs-lookup"><span data-stu-id="3241c-116">For example, in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) tutorial we used two correlated subqueries in the `ProductsTableAdapter` s main query to return the category and supplier names for each product.</span></span> <span data-ttu-id="3241c-117">A`JOIN`是合併兩個不同資料表的相關資料列的 SQL 建構。</span><span class="sxs-lookup"><span data-stu-id="3241c-117">A `JOIN` is a SQL construct that merges related rows from two different tables.</span></span> <span data-ttu-id="3241c-118">我們使用了`JOIN`中[SqlDataSource 控制項查詢資料](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb.md)教學課程，以顯示與每個產品類別目錄資訊。</span><span class="sxs-lookup"><span data-stu-id="3241c-118">We used a `JOIN` in the [Querying Data with the SqlDataSource Control](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb.md) tutorial to display category information alongside each product.</span></span>

<span data-ttu-id="3241c-119">我們已從使用 abstained 的原因`JOIN`與 Tableadapter 是由於 TableAdapter 的精靈自動產生的對應中的限制`INSERT`， `UPDATE`，和`DELETE`陳述式。</span><span class="sxs-lookup"><span data-stu-id="3241c-119">The reason we have abstained from using `JOIN` s with the TableAdapters is because of limitations in the TableAdapter s wizard to auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="3241c-120">更具體來說，如果 TableAdapter s 主查詢包含任何`JOIN`s，TableAdapter 無法自動建立的特定 SQL 陳述式或預存程序及其`InsertCommand`， `UpdateCommand`，和`DeleteCommand`屬性。</span><span class="sxs-lookup"><span data-stu-id="3241c-120">More specifically, if the TableAdapter s main query contains any `JOIN` s, the TableAdapter cannot auto-create the ad-hoc SQL statements or stored procedures for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span>

<span data-ttu-id="3241c-121">在此教學課程中我們將會簡短地比較和對比相互關聯子查詢及`JOIN`之後再探索如何建立包含的 TableAdapter s`JOIN`其主查詢。</span><span class="sxs-lookup"><span data-stu-id="3241c-121">In this tutorial we will briefly compare and contrast correlated subqueries and `JOIN` s before exploring how to create a TableAdapter that includes `JOIN` s in its main query.</span></span>

## <a name="comparing-and-contrasting-correlated-subqueries-andjoin-s"></a><span data-ttu-id="3241c-122">比較及對照相互關聯子查詢和`JOIN`s</span><span class="sxs-lookup"><span data-stu-id="3241c-122">Comparing and Contrasting Correlated Subqueries and`JOIN` s</span></span>

<span data-ttu-id="3241c-123">請記得，`ProductsTableAdapter`中的第一個教學課程中建立`Northwind`資料集使用相互關聯子查詢來重新顯示每個產品 s 對應類別目錄和供應商的名稱。</span><span class="sxs-lookup"><span data-stu-id="3241c-123">Recall that the `ProductsTableAdapter` created in the first tutorial in the `Northwind` DataSet uses correlated subqueries to bring back each product s corresponding category and supplier name.</span></span> <span data-ttu-id="3241c-124">`ProductsTableAdapter` s 主查詢如下所示。</span><span class="sxs-lookup"><span data-stu-id="3241c-124">The `ProductsTableAdapter` s main query is shown below.</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample1.sql)]

<span data-ttu-id="3241c-125">這兩個相互關聯子查詢-`(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)`並`(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)`-會`SELECT`查詢傳回的每項產品的單一值做為額外的資料行中的外部`SELECT`陳述式 s 資料行清單。</span><span class="sxs-lookup"><span data-stu-id="3241c-125">The two correlated subqueries - `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` and `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` - are `SELECT` queries that return a single value per product as an additional column in the outer `SELECT` statement s column list.</span></span>

<span data-ttu-id="3241c-126">或者，`JOIN`可用來傳回每個產品 s 供應商和類別名稱。</span><span class="sxs-lookup"><span data-stu-id="3241c-126">Alternatively, a `JOIN` can be used to return each product s supplier and category name.</span></span> <span data-ttu-id="3241c-127">下列查詢會傳回與上述的其中一個，相同的輸出，但使用`JOIN`s 取代子查詢：</span><span class="sxs-lookup"><span data-stu-id="3241c-127">The following query returns the same output as the above one, but uses `JOIN` s in place of subqueries:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample2.sql)]

<span data-ttu-id="3241c-128">A`JOIN`合併從一個資料表記錄與根據一些準則的另一個資料表中的記錄。</span><span class="sxs-lookup"><span data-stu-id="3241c-128">A `JOIN` merges the records from one table with records from another table based on some criteria.</span></span> <span data-ttu-id="3241c-129">在上述查詢中，例如`LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID`會指示 SQL Server 合併每個產品與分類的記錄會記錄其`CategoryID`值符合產品的`CategoryID`值。</span><span class="sxs-lookup"><span data-stu-id="3241c-129">In the above query, for example, the `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` instructs SQL Server to merge each product record with the category record whose `CategoryID` value matches the product s `CategoryID` value.</span></span> <span data-ttu-id="3241c-130">合併的結果可讓我們使用對應的類別目錄欄位，針對每個產品 (例如`CategoryName`)。</span><span class="sxs-lookup"><span data-stu-id="3241c-130">The merged result allows us to work with the corresponding category fields for each product (such as `CategoryName`).</span></span>

> [!NOTE]
> <span data-ttu-id="3241c-131">`JOIN` 查詢關聯式資料庫中的資料時，通常會使用 s。</span><span class="sxs-lookup"><span data-stu-id="3241c-131">`JOIN` s are commonly used when querying data from relational databases.</span></span> <span data-ttu-id="3241c-132">如果您是新手`JOIN`語法或需要稍微重溫一下其使用方式，d 建議[SQL Join 的教學課程](http://www.w3schools.com/sql/sql_join.asp)在[W3 學校](http://www.w3schools.com/)。</span><span class="sxs-lookup"><span data-stu-id="3241c-132">If you are new to the `JOIN` syntax or need to brush up a bit on its usage, I d recommend the [SQL Join tutorial](http://www.w3schools.com/sql/sql_join.asp) at [W3 Schools](http://www.w3schools.com/).</span></span> <span data-ttu-id="3241c-133">也值得一讀都[`JOIN`基本概念](https://msdn.microsoft.com/library/ms191517.aspx)並[子查詢基本概念](https://msdn.microsoft.com/library/ms189575.aspx)區段[SQL 線上叢書 》](https://msdn.microsoft.com/library/ms130214.aspx)。</span><span class="sxs-lookup"><span data-stu-id="3241c-133">Also worth reading are the [`JOIN` Fundamentals](https://msdn.microsoft.com/library/ms191517.aspx) and [Subquery Fundamentals](https://msdn.microsoft.com/library/ms189575.aspx) sections of the [SQL Books Online](https://msdn.microsoft.com/library/ms130214.aspx).</span></span>


<span data-ttu-id="3241c-134">因為`JOIN`s 和相互關聯子查詢都可用來擷取其他資料表中的相關的資料，許多開發人員仍正準備碰上其標頭，並想要使用哪個方法。</span><span class="sxs-lookup"><span data-stu-id="3241c-134">Since `JOIN` s and correlated subqueries can both be used to retrieve related data from other tables, many developers are left scratching their heads and wondering which approach to use.</span></span> <span data-ttu-id="3241c-135">所有的 SQL 專家我 ve 談過要說大致上相同的作業，它不 t 是很重要效能方面，SQL Server 將會產生大致上相同的執行計畫。</span><span class="sxs-lookup"><span data-stu-id="3241c-135">All of the SQL gurus I ve talked to have said roughly the same thing, that it doesn t really matter performance-wise as SQL Server will produce roughly identical execution plans.</span></span> <span data-ttu-id="3241c-136">然後，其建議中，是使用您和您的小組是最熟悉的技巧。</span><span class="sxs-lookup"><span data-stu-id="3241c-136">Their advice, then, is to use the technique that you and your team are most comfortable with.</span></span> <span data-ttu-id="3241c-137">它需要注意的是之後 imparting 這項建議, 這些專家立即 express 其喜好設定`JOIN`s 透過相互關聯子查詢。</span><span class="sxs-lookup"><span data-stu-id="3241c-137">It merits noting that after imparting this advice these experts immediately express their preference of `JOIN` s over correlated subqueries.</span></span>

<span data-ttu-id="3241c-138">建置時使用具類型資料集的資料存取層，這些工具適合使用子查詢時。</span><span class="sxs-lookup"><span data-stu-id="3241c-138">When building a Data Access Layer using Typed DataSets, the tools work better when using subqueries.</span></span> <span data-ttu-id="3241c-139">特別的是，TableAdapter 的精靈將無法自動產生對應`INSERT`， `UPDATE`，和`DELETE`陳述式，如果主要的查詢包含任何`JOIN`s，但將會自動產生這些陳述式時相互關聯子查詢會使用。</span><span class="sxs-lookup"><span data-stu-id="3241c-139">In particular, the TableAdapter s wizard will not auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements if the main query contains any `JOIN` s, but will auto-generate these statements when correlated subqueries are used.</span></span>

<span data-ttu-id="3241c-140">若要探索這個缺點，建立暫存類型中的資料集`~/App_Code/DAL`資料夾。</span><span class="sxs-lookup"><span data-stu-id="3241c-140">To explore this shortcoming, create a temporary Typed DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="3241c-141">在 TableAdapter 組態精靈 期間選擇使用特定 SQL 陳述式，並輸入下列`SELECT`查詢 （請參閱 圖 1）：</span><span class="sxs-lookup"><span data-stu-id="3241c-141">During the TableAdapter Configuration wizard, choose to use ad-hoc SQL statements and enter the following `SELECT` query (see Figure 1):</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample3.sql)]


<span data-ttu-id="3241c-142">[![輸入主要的查詢包含聯結](updating-the-tableadapter-to-use-joins-vb/_static/image2.png)](updating-the-tableadapter-to-use-joins-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="3241c-142">[![Enter a Main Query that Contains JOINs](updating-the-tableadapter-to-use-joins-vb/_static/image2.png)](updating-the-tableadapter-to-use-joins-vb/_static/image1.png)</span></span>

<span data-ttu-id="3241c-143">**圖 1**:輸入主要查詢的 Contains `JOIN` s ([按一下以檢視完整大小的影像](updating-the-tableadapter-to-use-joins-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="3241c-143">**Figure 1**: Enter a Main Query that Contains `JOIN` s ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image3.png))</span></span>


<span data-ttu-id="3241c-144">根據預設，TableAdapter 將會自動建立`INSERT`， `UPDATE`，和`DELETE`主要查詢為基礎的陳述式。</span><span class="sxs-lookup"><span data-stu-id="3241c-144">By default, the TableAdapter will automatically create `INSERT`, `UPDATE`, and `DELETE` statements based on the main query.</span></span> <span data-ttu-id="3241c-145">如果您按一下 [進階] 按鈕，您可以看到這項功能已啟用。</span><span class="sxs-lookup"><span data-stu-id="3241c-145">If you click the Advanced button you can see that this feature is enabled.</span></span> <span data-ttu-id="3241c-146">儘管這項設定，TableAdapter 將無法建立`INSERT`， `UPDATE`，並`DELETE`陳述式因為主要的查詢中包含`JOIN`。</span><span class="sxs-lookup"><span data-stu-id="3241c-146">Despite this setting, the TableAdapter will not be able to create the `INSERT`, `UPDATE`, and `DELETE` statements because the main query contains a `JOIN`.</span></span>


![輸入主要的查詢包含聯結](updating-the-tableadapter-to-use-joins-vb/_static/image4.png)

<span data-ttu-id="3241c-148">**圖 2**:輸入包含的主查詢`JOIN`s</span><span class="sxs-lookup"><span data-stu-id="3241c-148">**Figure 2**: Enter a Main Query that Contains `JOIN` s</span></span>


<span data-ttu-id="3241c-149">按一下 完成 以完成精靈。</span><span class="sxs-lookup"><span data-stu-id="3241c-149">Click Finish to complete the wizard.</span></span> <span data-ttu-id="3241c-150">此時您資料集設計工具會包含單一 TableAdapter 與資料行的 datatable 中傳回的欄位的每個`SELECT`查詢 s 資料行清單。</span><span class="sxs-lookup"><span data-stu-id="3241c-150">At this point your DataSet s Designer will include a single TableAdapter with a DataTable with columns for each of the fields returned in the `SELECT` query s column list.</span></span> <span data-ttu-id="3241c-151">這包括`CategoryName`和`SupplierName`，如 圖 3 所示。</span><span class="sxs-lookup"><span data-stu-id="3241c-151">This includes the `CategoryName` and `SupplierName`, as Figure 3 shows.</span></span>


![DataTable 資料行清單中傳回每個欄位包含資料行](updating-the-tableadapter-to-use-joins-vb/_static/image5.png)

<span data-ttu-id="3241c-153">**圖 3**:DataTable 資料行清單中傳回每個欄位包含資料行</span><span class="sxs-lookup"><span data-stu-id="3241c-153">**Figure 3**: The DataTable Includes a Column for Each Field Returned in the Column List</span></span>


<span data-ttu-id="3241c-154">TableAdapter 的 DataTable 有適當的資料行，缺少值及其`InsertCommand`， `UpdateCommand`，和`DeleteCommand`屬性。</span><span class="sxs-lookup"><span data-stu-id="3241c-154">While the DataTable has the appropriate columns, the TableAdapter lacks values for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="3241c-155">若要確認這一點，按一下設計工具的 TableAdapter 上，然後移至 [屬性] 視窗。</span><span class="sxs-lookup"><span data-stu-id="3241c-155">To confirm this, click on the TableAdapter in the Designer and then go to the Properties window.</span></span> <span data-ttu-id="3241c-156">那里，您會看到`InsertCommand`， `UpdateCommand`，和`DeleteCommand`屬性會設為 （無）。</span><span class="sxs-lookup"><span data-stu-id="3241c-156">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are set to (None) .</span></span>


<span data-ttu-id="3241c-157">[![InsertCommand、 UpdateCommand 和 DeleteCommand 屬性設定為 （無）](updating-the-tableadapter-to-use-joins-vb/_static/image7.png)](updating-the-tableadapter-to-use-joins-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="3241c-157">[![The InsertCommand, UpdateCommand, and DeleteCommand Properties are Set to (None)](updating-the-tableadapter-to-use-joins-vb/_static/image7.png)](updating-the-tableadapter-to-use-joins-vb/_static/image6.png)</span></span>

<span data-ttu-id="3241c-158">**圖 4**:`InsertCommand`， `UpdateCommand`，並`DeleteCommand`屬性設定為 [（無）] ([按一下以檢視完整大小的影像](updating-the-tableadapter-to-use-joins-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="3241c-158">**Figure 4**: The `InsertCommand`, `UpdateCommand`, and `DeleteCommand` Properties are Set to (None) ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image8.png))</span></span>


<span data-ttu-id="3241c-159">若要解決這個缺點，我們可以手動提供的 SQL 陳述式和參數`InsertCommand`， `UpdateCommand`，和`DeleteCommand`透過 [屬性] 視窗的屬性。</span><span class="sxs-lookup"><span data-stu-id="3241c-159">To work around this shortcoming, we can manually provide the SQL statements and parameters for the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties via the Properties window.</span></span> <span data-ttu-id="3241c-160">或者，我們可以藉由設定 TableAdapter s 主要查詢，以啟動*未*包含任何`JOIN`s。</span><span class="sxs-lookup"><span data-stu-id="3241c-160">Alternatively, we could start by configuring the TableAdapter s main query to *not* include any `JOIN` s.</span></span> <span data-ttu-id="3241c-161">這可讓`INSERT`， `UPDATE`，和`DELETE`會為我們自動產生的陳述式。</span><span class="sxs-lookup"><span data-stu-id="3241c-161">This will allow the `INSERT`, `UPDATE`, and `DELETE` statements to be auto-generated for us.</span></span> <span data-ttu-id="3241c-162">完成精靈之後，我們無法以手動方式更新 tableadapter`SelectCommand`從 [屬性] 視窗，使其包含`JOIN`語法。</span><span class="sxs-lookup"><span data-stu-id="3241c-162">After completing the wizard, we could then manually update the TableAdapter s `SelectCommand` from the Properties window so that it includes the `JOIN` syntax.</span></span>

<span data-ttu-id="3241c-163">雖然這種方法的運作方式，是非常脆弱重新設定完成精靈，自動產生使用特定 SQL 查詢，因為每當 TableAdapter s 主查詢時`INSERT`， `UPDATE`，和`DELETE`陳述式會重新建立。</span><span class="sxs-lookup"><span data-stu-id="3241c-163">While this approach works, it is very brittle when using ad-hoc SQL queries because any time the TableAdapter s main query is re-configured through the wizard, the auto-generated `INSERT`, `UPDATE`, and `DELETE` statements are recreated.</span></span> <span data-ttu-id="3241c-164">這表示我們稍後所做的自訂便會遺失我們 TableAdapter 上以滑鼠右鍵按一下，從操作功能表中選擇設定並再次完成精靈。</span><span class="sxs-lookup"><span data-stu-id="3241c-164">That means all of the customizations we later made would be lost if we right-clicked on the TableAdapter, chose Configure from the context menu, and completed the wizard again.</span></span>

<span data-ttu-id="3241c-165">自動產生的 tableadapter 的脆弱`INSERT`， `UPDATE`，和`DELETE`陳述式，幸運的是，限制為特定 SQL 陳述式。</span><span class="sxs-lookup"><span data-stu-id="3241c-165">The brittleness of the TableAdapter s auto-generated `INSERT`, `UPDATE`, and `DELETE` statements is, fortunately, limited to ad-hoc SQL statements.</span></span> <span data-ttu-id="3241c-166">如果您的 TableAdapter 會使用預存程序，您可以自訂`SelectCommand`， `InsertCommand`， `UpdateCommand`，或`DeleteCommand`預存程序，並重新執行而不需要擔心預存程序，將會的 TableAdapter 組態精靈修改。</span><span class="sxs-lookup"><span data-stu-id="3241c-166">If your TableAdapter uses stored procedures, you can customize the `SelectCommand`, `InsertCommand`, `UpdateCommand`, or `DeleteCommand` stored procedures and re-run the TableAdapter Configuration wizard without having to fear that the stored procedures will be modified.</span></span>

<span data-ttu-id="3241c-167">接下來幾個步驟，我們將建立的 TableAdapter，一開始，會使用主要查詢省略任何`JOIN`s，以便對應插入、 更新和刪除預存程序將會自動產生。</span><span class="sxs-lookup"><span data-stu-id="3241c-167">Over the next several steps we will create a TableAdapter that, initially, uses a main query that omits any `JOIN` s so that the corresponding insert, update, and delete stored procedures will be auto-generated.</span></span> <span data-ttu-id="3241c-168">我們會接著更新`SelectCommand`，因此使用`JOIN`相關資料表中傳回其他資料行。</span><span class="sxs-lookup"><span data-stu-id="3241c-168">We will then update the `SelectCommand` so that uses a `JOIN` that returns additional columns from related tables.</span></span> <span data-ttu-id="3241c-169">最後，我們會建立對應的商務邏輯層類別，並示範如何在 ASP.NET 網頁中使用的 TableAdapter。</span><span class="sxs-lookup"><span data-stu-id="3241c-169">Finally, we'll create a corresponding Business Logic Layer class and demonstrate using the TableAdapter in an ASP.NET web page.</span></span>

## <a name="step-1-creating-the-tableadapter-using-a-simplified-main-query"></a><span data-ttu-id="3241c-170">步驟 1：建立使用簡化的主查詢的 TableAdapter</span><span class="sxs-lookup"><span data-stu-id="3241c-170">Step 1: Creating the TableAdapter Using a Simplified Main Query</span></span>

<span data-ttu-id="3241c-171">本教學課程中，我們將新增 TableAdapter 和強型別的 DataTable`Employees`資料表中`NorthwindWithSprocs`資料集。</span><span class="sxs-lookup"><span data-stu-id="3241c-171">For this tutorial we will add a TableAdapter and strongly-typed DataTable for the `Employees` table in the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="3241c-172">`Employees`資料表包含`ReportsTo`欄位指定`EmployeeID`的員工 s manager。</span><span class="sxs-lookup"><span data-stu-id="3241c-172">The `Employees` table contains a `ReportsTo` field that specified the `EmployeeID` of the employee s manager.</span></span> <span data-ttu-id="3241c-173">例如，員工 Anne 葉剛已`ReportTo`值為 5，也就是`EmployeeID`孟。</span><span class="sxs-lookup"><span data-stu-id="3241c-173">For example, employee Anne Dodsworth has a `ReportTo` value of 5, which is the `EmployeeID` of Steven Buchanan.</span></span> <span data-ttu-id="3241c-174">因此，安妮報告 Steven，她的管理員。</span><span class="sxs-lookup"><span data-stu-id="3241c-174">Consequently, Anne reports to Steven, her manager.</span></span> <span data-ttu-id="3241c-175">以及報告每一位員工的`ReportsTo`值，我們可能也想要擷取其管理員的名稱。</span><span class="sxs-lookup"><span data-stu-id="3241c-175">Along with reporting each employee s `ReportsTo` value, we might also want to retrieve the name of their manager.</span></span> <span data-ttu-id="3241c-176">這可以使用來完成`JOIN`。</span><span class="sxs-lookup"><span data-stu-id="3241c-176">This can be accomplished using a `JOIN`.</span></span> <span data-ttu-id="3241c-177">但使用`JOIN`時一開始建立 TableAdapter 防止精靈自動產生對應的插入、 更新和刪除功能。</span><span class="sxs-lookup"><span data-stu-id="3241c-177">But using a `JOIN` when initially creating the TableAdapter precludes the wizard from automatically generating the corresponding insert, update, and delete capabilities.</span></span> <span data-ttu-id="3241c-178">因此，我們將先建立其主要的查詢不包含任何 TableAdapter `JOIN` s。</span><span class="sxs-lookup"><span data-stu-id="3241c-178">Therefore, we will start by creating a TableAdapter whose main query does not contain any `JOIN` s.</span></span> <span data-ttu-id="3241c-179">然後，在步驟 2 中，我們將更新主要查詢預存程序，擷取透過管理員的名稱`JOIN`。</span><span class="sxs-lookup"><span data-stu-id="3241c-179">Then, in Step 2, we will update the main query stored procedure to retrieve the manager s name via a `JOIN`.</span></span>

<span data-ttu-id="3241c-180">首先開啟`NorthwindWithSprocs`中的資料集`~/App_Code/DAL`資料夾。</span><span class="sxs-lookup"><span data-stu-id="3241c-180">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="3241c-181">以滑鼠右鍵按一下設計工具上，從操作功能表中，選取 [新增] 選項，挑選 TableAdapter 的功能表項目。</span><span class="sxs-lookup"><span data-stu-id="3241c-181">Right-click on the Designer, select the Add option from the context menu, and pick the TableAdapter menu item.</span></span> <span data-ttu-id="3241c-182">這會啟動 [TableAdapter 組態精靈]。</span><span class="sxs-lookup"><span data-stu-id="3241c-182">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="3241c-183">如 圖 5 說明，讓精靈建立新的預存程序，並按一下 下一步。</span><span class="sxs-lookup"><span data-stu-id="3241c-183">As Figure 5 depicts, have the wizard create new stored procedures and click Next.</span></span> <span data-ttu-id="3241c-184">建立新的重新整理程式中，預存程序，從 [TableAdapter] s 精靈，請參閱[建立新預存程序的輸入資料集 Tableadapter](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)教學課程。</span><span class="sxs-lookup"><span data-stu-id="3241c-184">For a refresher on creating new stored procedures from the TableAdapter s wizard, consult the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span>


<span data-ttu-id="3241c-185">[![選取 建立新預存程序選項](updating-the-tableadapter-to-use-joins-vb/_static/image10.png)](updating-the-tableadapter-to-use-joins-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="3241c-185">[![Select the Create new stored procedures Option](updating-the-tableadapter-to-use-joins-vb/_static/image10.png)](updating-the-tableadapter-to-use-joins-vb/_static/image9.png)</span></span>

<span data-ttu-id="3241c-186">**圖 5**:選取 建立新的預存程序選項 ([按一下以檢視完整大小的影像](updating-the-tableadapter-to-use-joins-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="3241c-186">**Figure 5**: Select the Create new stored procedures Option ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image11.png))</span></span>


<span data-ttu-id="3241c-187">使用下列項目`SELECT`TableAdapter s 主查詢的陳述式：</span><span class="sxs-lookup"><span data-stu-id="3241c-187">Use the following `SELECT` statement for the TableAdapter s main query:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample4.sql)]

<span data-ttu-id="3241c-188">因為此查詢不包含任何`JOIN`s，[Tabaleadapter 精靈] 會自動建立預存程序，該 id 對應`INSERT`， `UPDATE`，和`DELETE`陳述式，以及執行主要的預存程序查詢。</span><span class="sxs-lookup"><span data-stu-id="3241c-188">Since this query does not include any `JOIN` s, the TableAdapter wizard will automatically create stored procedures with corresponding `INSERT`, `UPDATE`, and `DELETE` statements, as well as a stored procedure for executing the main query.</span></span>

<span data-ttu-id="3241c-189">下列步驟可讓我們來命名的 TableAdapter s 預存程序。</span><span class="sxs-lookup"><span data-stu-id="3241c-189">The following step allows us to name the TableAdapter s stored procedures.</span></span> <span data-ttu-id="3241c-190">使用名稱`Employees_Select`， `Employees_Insert`， `Employees_Update`，和`Employees_Delete`，如 [圖 6] 所示。</span><span class="sxs-lookup"><span data-stu-id="3241c-190">Use the names `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`, as shown in Figure 6.</span></span>


<span data-ttu-id="3241c-191">[![名稱的 TableAdapter s 預存程序](updating-the-tableadapter-to-use-joins-vb/_static/image13.png)](updating-the-tableadapter-to-use-joins-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="3241c-191">[![Name the TableAdapter s Stored Procedures](updating-the-tableadapter-to-use-joins-vb/_static/image13.png)](updating-the-tableadapter-to-use-joins-vb/_static/image12.png)</span></span>

<span data-ttu-id="3241c-192">**圖 6**:命名 TableAdapter s 預存程序 ([按一下以檢視完整大小的影像](updating-the-tableadapter-to-use-joins-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="3241c-192">**Figure 6**: Name the TableAdapter s Stored Procedures ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image14.png))</span></span>


<span data-ttu-id="3241c-193">最後一個步驟會提示我們輸入來命名的 TableAdapter 的方法。</span><span class="sxs-lookup"><span data-stu-id="3241c-193">The final step prompts us to name the TableAdapter s methods.</span></span> <span data-ttu-id="3241c-194">使用`Fill`和`GetEmployees`做為方法名稱。</span><span class="sxs-lookup"><span data-stu-id="3241c-194">Use `Fill` and `GetEmployees` as the method names.</span></span> <span data-ttu-id="3241c-195">也請務必將更新直接傳送至資料庫 (GenerateDBDirectMethods) 核取方塊已核取的建立方法。</span><span class="sxs-lookup"><span data-stu-id="3241c-195">Also be sure to leave the Create methods to send updates directly to the database (GenerateDBDirectMethods) checkbox checked.</span></span>


<span data-ttu-id="3241c-196">[![名稱的 TableAdapter 的方法填滿和 GetEmployees](updating-the-tableadapter-to-use-joins-vb/_static/image16.png)](updating-the-tableadapter-to-use-joins-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="3241c-196">[![Name the TableAdapter s Methods Fill and GetEmployees](updating-the-tableadapter-to-use-joins-vb/_static/image16.png)](updating-the-tableadapter-to-use-joins-vb/_static/image15.png)</span></span>

<span data-ttu-id="3241c-197">**圖 7**:命名的 tableadapter 方法`Fill`並`GetEmployees`([按一下以檢視完整大小的影像](updating-the-tableadapter-to-use-joins-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="3241c-197">**Figure 7**: Name the TableAdapter s Methods `Fill` and `GetEmployees` ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image17.png))</span></span>


<span data-ttu-id="3241c-198">完成精靈之後，花點時間檢查資料庫中的預存程序。</span><span class="sxs-lookup"><span data-stu-id="3241c-198">After completing the wizard, take a moment to examine the stored procedures in the database.</span></span> <span data-ttu-id="3241c-199">您應該會看到四個新的： `Employees_Select`， `Employees_Insert`， `Employees_Update`，和`Employees_Delete`。</span><span class="sxs-lookup"><span data-stu-id="3241c-199">You should see four new ones: `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`.</span></span> <span data-ttu-id="3241c-200">接下來，檢查`EmployeesDataTable`和`EmployeesTableAdapter`剛建立。</span><span class="sxs-lookup"><span data-stu-id="3241c-200">Next, inspect the `EmployeesDataTable` and `EmployeesTableAdapter` just created.</span></span> <span data-ttu-id="3241c-201">DataTable 包含主查詢所傳回的每個欄位的資料行。</span><span class="sxs-lookup"><span data-stu-id="3241c-201">The DataTable contains a column for each field returned by the main query.</span></span> <span data-ttu-id="3241c-202">TableAdapter 上按一下，然後移至 [屬性] 視窗。</span><span class="sxs-lookup"><span data-stu-id="3241c-202">Click on the TableAdapter and then go to the Properties window.</span></span> <span data-ttu-id="3241c-203">那里，您會看到`InsertCommand`， `UpdateCommand`，和`DeleteCommand`屬性已正確設定來呼叫對應的預存程序。</span><span class="sxs-lookup"><span data-stu-id="3241c-203">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are correctly configured to call the corresponding stored procedures.</span></span>


<span data-ttu-id="3241c-204">[![TableAdapter 包含插入、 更新和刪除功能](updating-the-tableadapter-to-use-joins-vb/_static/image19.png)](updating-the-tableadapter-to-use-joins-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="3241c-204">[![The TableAdapter Includes Insert, Update, and Delete Capabilities](updating-the-tableadapter-to-use-joins-vb/_static/image19.png)](updating-the-tableadapter-to-use-joins-vb/_static/image18.png)</span></span>

<span data-ttu-id="3241c-205">**圖 8**:TableAdapter 包含插入、 更新和刪除功能 ([按一下以檢視完整大小的影像](updating-the-tableadapter-to-use-joins-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="3241c-205">**Figure 8**: The TableAdapter Includes Insert, Update, and Delete Capabilities ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image20.png))</span></span>


<span data-ttu-id="3241c-206">插入、 更新和刪除自動建立的預存程序和`InsertCommand`， `UpdateCommand`，並`DeleteCommand`正確設定的屬性，我們已準備好自訂`SelectCommand`s 預存程序傳回其他每個員工 s manager 的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="3241c-206">With the insert, update, and delete stored procedures automatically created and the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties correctly configured, we are ready to customize the `SelectCommand` s stored procedure to return additional information about each employee s manager.</span></span> <span data-ttu-id="3241c-207">具體來說，我們需要更新`Employees_Select`預存程序，使用`JOIN`，並傳回 manager s`FirstName`和`LastName`值。</span><span class="sxs-lookup"><span data-stu-id="3241c-207">Specifically, we need to update the `Employees_Select` stored procedure to use a `JOIN` and return the manager s `FirstName` and `LastName` values.</span></span> <span data-ttu-id="3241c-208">更新預存程序之後，我們必須更新 DataTable，使其包含這些額外的資料行。</span><span class="sxs-lookup"><span data-stu-id="3241c-208">After the stored procedure has been updated, we will need to update the DataTable so that it includes these additional columns.</span></span> <span data-ttu-id="3241c-209">我們將會處理這兩項工作在步驟 2 和 3。</span><span class="sxs-lookup"><span data-stu-id="3241c-209">We'll tackle these two tasks in Steps 2 and 3.</span></span>

## <a name="step-2-customizing-the-stored-procedure-to-include-ajoin"></a><span data-ttu-id="3241c-210">步驟 2：自訂要包含的預存程序`JOIN`</span><span class="sxs-lookup"><span data-stu-id="3241c-210">Step 2: Customizing the Stored Procedure to Include a`JOIN`</span></span>

<span data-ttu-id="3241c-211">開始請先移至 [伺服器總管] 中，向下切入至 [Northwind 資料庫 s 預存程序] 資料夾中，並開啟`Employees_Select`預存程序。</span><span class="sxs-lookup"><span data-stu-id="3241c-211">Start by going to the Server Explorer, drilling down into the Northwind database s Stored Procedures folder, and opening the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="3241c-212">如果看不到此預存程序，以滑鼠右鍵按一下 預存程序 資料夾，並選擇 重新整理。</span><span class="sxs-lookup"><span data-stu-id="3241c-212">If you do not see this stored procedure, right-click on the Stored Procedures folder and choose Refresh.</span></span> <span data-ttu-id="3241c-213">更新預存程序，使其使用`LEFT JOIN`先傳回 manager s 和姓氏：</span><span class="sxs-lookup"><span data-stu-id="3241c-213">Update the stored procedure so that it uses a `LEFT JOIN` to return the manager s first and last name:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample5.sql)]

<span data-ttu-id="3241c-214">在更新之後`SELECT`陳述式中，移至 檔案 功能表，然後選擇 儲存的變更儲存`Employees_Select`。</span><span class="sxs-lookup"><span data-stu-id="3241c-214">After updating the `SELECT` statement, save the changes by going to the File menu and choosing Save `Employees_Select`.</span></span> <span data-ttu-id="3241c-215">或者，您可以按一下工具列中的 [儲存] 圖示，或按 Ctrl + S。</span><span class="sxs-lookup"><span data-stu-id="3241c-215">Alternatively, you can click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="3241c-216">儲存您的變更之後，以滑鼠右鍵按一下`Employees_Select`預存程序，在 伺服器總管，然後選擇 執行。</span><span class="sxs-lookup"><span data-stu-id="3241c-216">After saving your changes, right-click on the `Employees_Select` stored procedure in the Server Explorer and choose Execute.</span></span> <span data-ttu-id="3241c-217">這會執行預存程序，並在 輸出 視窗中顯示其結果 （請參閱 圖 9）。</span><span class="sxs-lookup"><span data-stu-id="3241c-217">This will run the stored procedure and show its results in the Output window (see Figure 9).</span></span>


<span data-ttu-id="3241c-218">[![預存程序結果會顯示在 [輸出] 視窗](updating-the-tableadapter-to-use-joins-vb/_static/image22.png)](updating-the-tableadapter-to-use-joins-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="3241c-218">[![The Stored Procedures Results are Displayed in the Output Window](updating-the-tableadapter-to-use-joins-vb/_static/image22.png)](updating-the-tableadapter-to-use-joins-vb/_static/image21.png)</span></span>

<span data-ttu-id="3241c-219">**圖 9**:預存程序結果會顯示在 [輸出] 視窗中 ([按一下以檢視完整大小的影像](updating-the-tableadapter-to-use-joins-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="3241c-219">**Figure 9**: The Stored Procedures Results are Displayed in the Output Window ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image23.png))</span></span>


## <a name="step-3-updating-the-datatable-s-columns"></a><span data-ttu-id="3241c-220">步驟 3：更新資料表 s 資料行</span><span class="sxs-lookup"><span data-stu-id="3241c-220">Step 3: Updating the DataTable s Columns</span></span>

<span data-ttu-id="3241c-221">此時，`Employees_Select`預存程序會傳回`ManagerFirstName`並`ManagerLastName`的值，但`EmployeesDataTable`遺失這些資料行。</span><span class="sxs-lookup"><span data-stu-id="3241c-221">At this point, the `Employees_Select` stored procedure returns `ManagerFirstName` and `ManagerLastName` values, but the `EmployeesDataTable` is missing these columns.</span></span> <span data-ttu-id="3241c-222">這些遺漏的資料行可以加入至 DataTable 中有兩種：</span><span class="sxs-lookup"><span data-stu-id="3241c-222">These missing columns can be added to the DataTable in one of two ways:</span></span>

- <span data-ttu-id="3241c-223">**以手動方式**-以滑鼠右鍵按一下 DataSet 設計工具中的 DataTable 並從 新增 功能表中，選擇 資料行。</span><span class="sxs-lookup"><span data-stu-id="3241c-223">**Manually** - right-click on the DataTable in the DataSet Designer and, from the Add menu, choose Column.</span></span> <span data-ttu-id="3241c-224">您可以命名資料行，然後據以設定其屬性。</span><span class="sxs-lookup"><span data-stu-id="3241c-224">You can then name the column and set its properties accordingly.</span></span>
- <span data-ttu-id="3241c-225">**自動**-[TableAdapter 組態精靈] 將會更新資料表 s 資料行，以反映所傳回的欄位`SelectCommand`預存程序。</span><span class="sxs-lookup"><span data-stu-id="3241c-225">**Automatically** - the TableAdapter Configuration wizard will update the DataTable s columns to reflect the fields returned by the `SelectCommand` stored procedure.</span></span> <span data-ttu-id="3241c-226">當使用特定 SQL 陳述式，也會移除精靈`InsertCommand`， `UpdateCommand`，和`DeleteCommand`屬性，因為`SelectCommand`現在包含`JOIN`。</span><span class="sxs-lookup"><span data-stu-id="3241c-226">When using ad-hoc SQL statements, the wizard will also remove the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties since the `SelectCommand` now contains a `JOIN`.</span></span> <span data-ttu-id="3241c-227">但在使用預存程序時，命令會保留這些屬性保持不變。</span><span class="sxs-lookup"><span data-stu-id="3241c-227">But when using stored procedures, these command properties remain intact.</span></span>

<span data-ttu-id="3241c-228">我們在先前的教學課程，包括探索了手動加入的 DataTable 資料行[主要/詳細說明使用具有詳細資料 DataList 的主要記錄項目符號清單](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md)並[上傳檔案](../working-with-binary-files/uploading-files-vb.md)，而我們也將在我們的下一個教學課程中，查看此程序一次的更多詳細資料。</span><span class="sxs-lookup"><span data-stu-id="3241c-228">We have explored manually adding DataTable columns in previous tutorials, including [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) and [Uploading Files](../working-with-binary-files/uploading-files-vb.md), and we will look at this process again in more detail in our next tutorial.</span></span> <span data-ttu-id="3241c-229">本教學課程中，不過，讓使用透過 [TableAdapter 組態精靈] 的自動方式的 s。</span><span class="sxs-lookup"><span data-stu-id="3241c-229">For this tutorial, however, let s use the automatic approach via the TableAdapter Configuration wizard.</span></span>

<span data-ttu-id="3241c-230">以滑鼠右鍵按一下啟動`EmployeesTableAdapter`並從內容功能表中選取設定。</span><span class="sxs-lookup"><span data-stu-id="3241c-230">Start by right-clicking on the `EmployeesTableAdapter` and selecting Configure from the context menu.</span></span> <span data-ttu-id="3241c-231">這會顯示 TableAdapter 組態精靈，它會列出用於選取、 插入、 更新和刪除，以及它們的傳回值和參數 （如果有的話） 的預存程序。</span><span class="sxs-lookup"><span data-stu-id="3241c-231">This brings up the TableAdapter Configuration wizard, which lists the stored procedures used for selecting, inserting, updating, and deleting, along with their return values and parameters (if any).</span></span> <span data-ttu-id="3241c-232">[圖 10] 顯示此精靈。</span><span class="sxs-lookup"><span data-stu-id="3241c-232">Figure 10 shows this wizard.</span></span> <span data-ttu-id="3241c-233">這裡我們可以看到`Employees_Select`預存程序現在會傳回`ManagerFirstName`和`ManagerLastName`欄位。</span><span class="sxs-lookup"><span data-stu-id="3241c-233">Here we can see that the `Employees_Select` stored procedure now returns the `ManagerFirstName` and `ManagerLastName` fields.</span></span>


<span data-ttu-id="3241c-234">[![精靈顯示更新的資料行清單中，針對 Employees_Select 預存程序](updating-the-tableadapter-to-use-joins-vb/_static/image25.png)](updating-the-tableadapter-to-use-joins-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="3241c-234">[![The Wizard Shows the Updated Column List for the Employees_Select Stored Procedure](updating-the-tableadapter-to-use-joins-vb/_static/image25.png)](updating-the-tableadapter-to-use-joins-vb/_static/image24.png)</span></span>

<span data-ttu-id="3241c-235">**圖 10**:精靈會顯示更新資料行清單，如`Employees_Select`預存程序 ([按一下以檢視完整大小的影像](updating-the-tableadapter-to-use-joins-vb/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="3241c-235">**Figure 10**: The Wizard Shows the Updated Column List for the `Employees_Select` Stored Procedure ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image26.png))</span></span>


<span data-ttu-id="3241c-236">按一下 [完成] 來完成精靈。</span><span class="sxs-lookup"><span data-stu-id="3241c-236">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="3241c-237">DataSet 設計工具中，返回`EmployeesDataTable`包含兩個額外的資料行：`ManagerFirstName`和`ManagerLastName`。</span><span class="sxs-lookup"><span data-stu-id="3241c-237">Upon returning to the DataSet Designer, the `EmployeesDataTable` includes two additional columns: `ManagerFirstName` and `ManagerLastName`.</span></span>


<span data-ttu-id="3241c-238">[![EmployeesDataTable 包含兩個新的資料行](updating-the-tableadapter-to-use-joins-vb/_static/image28.png)](updating-the-tableadapter-to-use-joins-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="3241c-238">[![The EmployeesDataTable Contains Two New Columns](updating-the-tableadapter-to-use-joins-vb/_static/image28.png)](updating-the-tableadapter-to-use-joins-vb/_static/image27.png)</span></span>

<span data-ttu-id="3241c-239">**圖 11**:`EmployeesDataTable`包含兩個新資料行 ([按一下以檢視完整大小的影像](updating-the-tableadapter-to-use-joins-vb/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="3241c-239">**Figure 11**: The `EmployeesDataTable` Contains Two New Columns ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image29.png))</span></span>


<span data-ttu-id="3241c-240">為了說明，更新`Employees_Select`預存程序作用中，插入、 更新和刪除的 TableAdapter 的功能都仍運作正常，讓建立網頁，可讓使用者檢視和刪除員工。</span><span class="sxs-lookup"><span data-stu-id="3241c-240">To illustrate that the updated `Employees_Select` stored procedure is in effect and that the insert, update, and delete capabilities of the TableAdapter are still functional, let s create a web page that allows users to view and delete employees.</span></span> <span data-ttu-id="3241c-241">建立這類頁面之前，不過，我們必須先建立新的類別中的員工所使用的商務邏輯層`NorthwindWithSprocs`資料集。</span><span class="sxs-lookup"><span data-stu-id="3241c-241">Before we create such a page, however, we need to first create a new class in the Business Logic Layer for working with employees from the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="3241c-242">在步驟 4 中，我們將建立`EmployeesBLLWithSprocs`類別。</span><span class="sxs-lookup"><span data-stu-id="3241c-242">In Step 4, we will create an `EmployeesBLLWithSprocs` class.</span></span> <span data-ttu-id="3241c-243">在步驟 5 中，我們將使用此類別從 ASP.NET 頁面。</span><span class="sxs-lookup"><span data-stu-id="3241c-243">In Step 5, we will use this class from an ASP.NET page.</span></span>

## <a name="step-4-implementing-the-business-logic-layer"></a><span data-ttu-id="3241c-244">步驟 4：實作商務邏輯層</span><span class="sxs-lookup"><span data-stu-id="3241c-244">Step 4: Implementing the Business Logic Layer</span></span>

<span data-ttu-id="3241c-245">建立新的類別檔案中`~/App_Code/BLL`名為資料夾`EmployeesBLLWithSprocs.vb`。</span><span class="sxs-lookup"><span data-stu-id="3241c-245">Create a new class file in the `~/App_Code/BLL` folder named `EmployeesBLLWithSprocs.vb`.</span></span> <span data-ttu-id="3241c-246">這個類別會模仿現有的語意`EmployeesBLL`類別，這個新其中一個提供較少的方法，並使用`NorthwindWithSprocs`資料集 (而不是`Northwind`資料集)。</span><span class="sxs-lookup"><span data-stu-id="3241c-246">This class mimics the semantics of the existing `EmployeesBLL` class, only this new one provides fewer methods and uses the `NorthwindWithSprocs` DataSet (instead of the `Northwind` DataSet).</span></span> <span data-ttu-id="3241c-247">將下列程式碼加入 `EmployeesBLLWithSprocs` 類別。</span><span class="sxs-lookup"><span data-stu-id="3241c-247">Add the following code to the `EmployeesBLLWithSprocs` class.</span></span>


[!code-vb[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample6.vb)]

<span data-ttu-id="3241c-248">`EmployeesBLLWithSprocs`類別 s`Adapter`屬性傳回的執行個體`NorthwindWithSprocs`dataset `EmployeesTableAdapter`。</span><span class="sxs-lookup"><span data-stu-id="3241c-248">The `EmployeesBLLWithSprocs` class s `Adapter` property returns an instance of the `NorthwindWithSprocs` DataSet s `EmployeesTableAdapter`.</span></span> <span data-ttu-id="3241c-249">這由類別 s`GetEmployees`和`DeleteEmployee`方法。</span><span class="sxs-lookup"><span data-stu-id="3241c-249">This is used by the class s `GetEmployees` and `DeleteEmployee` methods.</span></span> <span data-ttu-id="3241c-250">`GetEmployees`方法呼叫`EmployeesTableAdapter`s 對應`GetEmployees`方法，它會叫用`Employees_Select`預存程序，並於其中填入在其結果`EmployeeDataTable`。</span><span class="sxs-lookup"><span data-stu-id="3241c-250">The `GetEmployees` method calls the `EmployeesTableAdapter` s corresponding `GetEmployees` method, which invokes the `Employees_Select` stored procedure and populates its results in an `EmployeeDataTable`.</span></span> <span data-ttu-id="3241c-251">`DeleteEmployee`方法會同樣地呼叫`EmployeesTableAdapter`s`Delete`方法，它會叫用`Employees_Delete`預存程序。</span><span class="sxs-lookup"><span data-stu-id="3241c-251">The `DeleteEmployee` method similarly calls the `EmployeesTableAdapter` s `Delete` method, which invokes the `Employees_Delete` stored procedure.</span></span>

## <a name="step-5-working-with-the-data-in-the-presentation-layer"></a><span data-ttu-id="3241c-252">步驟 5：使用中的資料展示層</span><span class="sxs-lookup"><span data-stu-id="3241c-252">Step 5: Working with the Data in the Presentation Layer</span></span>

<span data-ttu-id="3241c-253">使用`EmployeesBLLWithSprocs`類別完成時，我們準備好可使用透過 ASP.NET 網頁的員工資料。</span><span class="sxs-lookup"><span data-stu-id="3241c-253">With the `EmployeesBLLWithSprocs` class complete, we re ready to work with employee data through an ASP.NET page.</span></span> <span data-ttu-id="3241c-254">開啟`JOINs.aspx`頁面中`AdvancedDAL`資料夾，然後拖曳的 GridView，從 [工具箱] 拖曳至設計工具，設定其`ID`屬性設`Employees`。</span><span class="sxs-lookup"><span data-stu-id="3241c-254">Open the `JOINs.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Employees`.</span></span> <span data-ttu-id="3241c-255">接下來，從 [GridView] s 智慧標籤，將方格繫結至新的 ObjectDataSource 控制項，名為`EmployeesDataSource`。</span><span class="sxs-lookup"><span data-stu-id="3241c-255">Next, from the GridView s smart tag, bind the grid to a new ObjectDataSource control named `EmployeesDataSource`.</span></span>

<span data-ttu-id="3241c-256">設定要使用 ObjectDataSource`EmployeesBLLWithSprocs`類別，並從 選取和刪除索引標籤，確定`GetEmployees`和`DeleteEmployee`方法會從下拉式清單中選取。</span><span class="sxs-lookup"><span data-stu-id="3241c-256">Configure the ObjectDataSource to use the `EmployeesBLLWithSprocs` class and, from the SELECT and DELETE tabs, ensure that the `GetEmployees` and `DeleteEmployee` methods are selected from the drop-down lists.</span></span> <span data-ttu-id="3241c-257">按一下 [完成] 以完成 ObjectDataSource 的組態。</span><span class="sxs-lookup"><span data-stu-id="3241c-257">Click Finish to complete the ObjectDataSource s configuration.</span></span>


<span data-ttu-id="3241c-258">[![設定使用 EmployeesBLLWithSprocs 類別 ObjectDataSource](updating-the-tableadapter-to-use-joins-vb/_static/image31.png)](updating-the-tableadapter-to-use-joins-vb/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="3241c-258">[![Configure the ObjectDataSource to Use the EmployeesBLLWithSprocs Class](updating-the-tableadapter-to-use-joins-vb/_static/image31.png)](updating-the-tableadapter-to-use-joins-vb/_static/image30.png)</span></span>

<span data-ttu-id="3241c-259">**圖 12**:設定要使用 ObjectDataSource`EmployeesBLLWithSprocs`類別 ([按一下以檢視完整大小的影像](updating-the-tableadapter-to-use-joins-vb/_static/image32.png))</span><span class="sxs-lookup"><span data-stu-id="3241c-259">**Figure 12**: Configure the ObjectDataSource to Use the `EmployeesBLLWithSprocs` Class ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image32.png))</span></span>


<span data-ttu-id="3241c-260">[![具有 ObjectDataSource 使用 GetEmployees 和 DeleteEmployee 方法](updating-the-tableadapter-to-use-joins-vb/_static/image34.png)](updating-the-tableadapter-to-use-joins-vb/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="3241c-260">[![Have the ObjectDataSource Use the GetEmployees and DeleteEmployee Methods](updating-the-tableadapter-to-use-joins-vb/_static/image34.png)](updating-the-tableadapter-to-use-joins-vb/_static/image33.png)</span></span>

<span data-ttu-id="3241c-261">**圖 13**:ObjectDataSource 使用了`GetEmployees`並`DeleteEmployee`方法 ([按一下以檢視完整大小的影像](updating-the-tableadapter-to-use-joins-vb/_static/image35.png))</span><span class="sxs-lookup"><span data-stu-id="3241c-261">**Figure 13**: Have the ObjectDataSource Use the `GetEmployees` and `DeleteEmployee` Methods ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image35.png))</span></span>


<span data-ttu-id="3241c-262">Visual Studio 會加入至 GridView BoundField 的每個`EmployeesDataTable`s 資料行。</span><span class="sxs-lookup"><span data-stu-id="3241c-262">Visual Studio will add a BoundField to the GridView for each of the `EmployeesDataTable` s columns.</span></span> <span data-ttu-id="3241c-263">移除所有除了這些 BoundFields `Title`， `LastName`， `FirstName`， `ManagerFirstName`，並`ManagerLastName`並重新命名`HeaderText`姓氏、 名字、 Manager s 第一個名稱，最後四個 BoundFields 屬性和管理員 s 姓氏，分別。</span><span class="sxs-lookup"><span data-stu-id="3241c-263">Remove all of these BoundFields except for `Title`, `LastName`, `FirstName`, `ManagerFirstName`, and `ManagerLastName` and rename the `HeaderText` properties for the last four BoundFields to Last Name, First Name, Manager s First Name, and Manager s Last Name, respectively.</span></span>

<span data-ttu-id="3241c-264">若要允許從這個頁面刪除員工的使用者，我們需要做兩件事。</span><span class="sxs-lookup"><span data-stu-id="3241c-264">To allow users to delete employees from this page we need to do two things.</span></span> <span data-ttu-id="3241c-265">首先，指示 GridView，以檢查它的智慧標籤的 啟用刪除選項提供刪除的功能。</span><span class="sxs-lookup"><span data-stu-id="3241c-265">First, instruct the GridView to provide deleting capabilities by checking the Enable Deleting option from its smart tag.</span></span> <span data-ttu-id="3241c-266">第二，變更 ObjectDataSource s `OldValuesParameterFormatString` ObjectDataSource 精靈設定屬性的值 (`original_{0}`) 為其預設值 (`{0}`)。</span><span class="sxs-lookup"><span data-stu-id="3241c-266">Second, change the ObjectDataSource s `OldValuesParameterFormatString` property from the value set by the ObjectDataSource wizard (`original_{0}`) to its default value (`{0}`).</span></span> <span data-ttu-id="3241c-267">進行這些變更之後，您的 GridView 和 ObjectDataSource s 宣告式標記看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="3241c-267">After making these changes, your GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample7.aspx)]

<span data-ttu-id="3241c-268">造訪透過瀏覽器來測試頁面。</span><span class="sxs-lookup"><span data-stu-id="3241c-268">Test out the page by visiting it through a browser.</span></span> <span data-ttu-id="3241c-269">如 [圖 14] 所示，此頁面會列出每一位員工和 （假設有的話） 的他或她 manager s 名稱。</span><span class="sxs-lookup"><span data-stu-id="3241c-269">As Figure 14 shows, the page will list each employee and his or her manager s name (assuming they have one).</span></span>


<span data-ttu-id="3241c-270">[![Employees_Select 參與預存程序會傳回經理的名稱](updating-the-tableadapter-to-use-joins-vb/_static/image37.png)](updating-the-tableadapter-to-use-joins-vb/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="3241c-270">[![The JOIN in the Employees_Select Stored Procedure Returns the Manager s Name](updating-the-tableadapter-to-use-joins-vb/_static/image37.png)](updating-the-tableadapter-to-use-joins-vb/_static/image36.png)</span></span>

<span data-ttu-id="3241c-271">**圖 14**:`JOIN`中`Employees_Select`預存程序傳回的管理員名稱 ([按一下以檢視完整大小的影像](updating-the-tableadapter-to-use-joins-vb/_static/image38.png))</span><span class="sxs-lookup"><span data-stu-id="3241c-271">**Figure 14**: The `JOIN` in the `Employees_Select` Stored Procedure Returns the Manager s Name ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image38.png))</span></span>


<span data-ttu-id="3241c-272">按一下 [刪除] 按鈕會啟動刪除最後的執行中的工作流程，`Employees_Delete`預存程序。</span><span class="sxs-lookup"><span data-stu-id="3241c-272">Clicking the Delete button starts the deleting workflow, which culminates in the execution of the `Employees_Delete` stored procedure.</span></span> <span data-ttu-id="3241c-273">不過，嘗試`DELETE`預存程序的陳述式會失敗，因為外部索引鍵條件約束違規情形 （請參閱 圖 15）。</span><span class="sxs-lookup"><span data-stu-id="3241c-273">However, the attempted `DELETE` statement in the stored procedure fails because of a foreign key constraint violation (see Figure 15).</span></span> <span data-ttu-id="3241c-274">具體來說，每一位員工會有一或多個記錄`Orders`資料表中，導致無法刪除。</span><span class="sxs-lookup"><span data-stu-id="3241c-274">Specifically, each employee has one or more records in the `Orders` table, causing the delete to fail.</span></span>


<span data-ttu-id="3241c-275">[![刪除某位員工具有對應的訂單結果中外部索引鍵條件約束違規](updating-the-tableadapter-to-use-joins-vb/_static/image40.png)](updating-the-tableadapter-to-use-joins-vb/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="3241c-275">[![Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation](updating-the-tableadapter-to-use-joins-vb/_static/image40.png)](updating-the-tableadapter-to-use-joins-vb/_static/image39.png)</span></span>

<span data-ttu-id="3241c-276">**圖 15**:刪除某位員工具有對應的訂單結果中外部索引鍵條件約束違規 ([按一下以檢視完整大小的影像](updating-the-tableadapter-to-use-joins-vb/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="3241c-276">**Figure 15**: Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image41.png))</span></span>


<span data-ttu-id="3241c-277">若要讓員工可刪除您可以：</span><span class="sxs-lookup"><span data-stu-id="3241c-277">To allow an employee to be deleted you could:</span></span>

- <span data-ttu-id="3241c-278">更新外部索引鍵條件約束的串聯刪除</span><span class="sxs-lookup"><span data-stu-id="3241c-278">Update the foreign key constraint to cascade deletes,</span></span>
- <span data-ttu-id="3241c-279">以手動方式刪除資料錄`Orders`employee(s) 您想要刪除的資料表或</span><span class="sxs-lookup"><span data-stu-id="3241c-279">Manually delete the records from the `Orders` table for the employee(s) you want to delete, or</span></span>
- <span data-ttu-id="3241c-280">更新`Employees_Delete`預存程序，先刪除相關的記錄，從`Orders`資料表，然後再刪除`Employees`記錄。</span><span class="sxs-lookup"><span data-stu-id="3241c-280">Update the `Employees_Delete` stored procedure to first delete the related records from the `Orders` table before deleting the `Employees` record.</span></span> <span data-ttu-id="3241c-281">我們會討論此技巧[使用現有預存程序的輸入資料集 Tableadapter](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)教學課程。</span><span class="sxs-lookup"><span data-stu-id="3241c-281">We discussed this technique in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span>

<span data-ttu-id="3241c-282">我不要更動此練習的讀取器。</span><span class="sxs-lookup"><span data-stu-id="3241c-282">I leave this as an exercise for the reader.</span></span>

## <a name="summary"></a><span data-ttu-id="3241c-283">總結</span><span class="sxs-lookup"><span data-stu-id="3241c-283">Summary</span></span>

<span data-ttu-id="3241c-284">使用關聯式資料庫時, 很常見的查詢，以提取其資料從多個相關資料表。</span><span class="sxs-lookup"><span data-stu-id="3241c-284">When working with relational databases, it is common for queries to pull their data from multiple, related tables.</span></span> <span data-ttu-id="3241c-285">相互關聯子查詢和`JOIN`提供兩種不同技術來存取資料，從查詢中的相關資料表。</span><span class="sxs-lookup"><span data-stu-id="3241c-285">Correlated subqueries and `JOIN` s provide two different techniques for accessing data from related tables in a query.</span></span> <span data-ttu-id="3241c-286">在我們最常做的上一個教學課程使用的相互關聯子查詢，因為 TableAdapter 無法自動產生`INSERT`， `UPDATE`，並`DELETE`陳述式中的查詢涉及`JOIN`s。</span><span class="sxs-lookup"><span data-stu-id="3241c-286">In previous tutorials we most commonly made use of correlated subqueries because the TableAdapter cannot auto-generate `INSERT`, `UPDATE`, and `DELETE` statements for queries involving `JOIN` s.</span></span> <span data-ttu-id="3241c-287">雖然使用特定 SQL 陳述式完成 [TableAdapter 組態精靈] 之後的任何自訂將會覆寫時，可以手動提供這些值。</span><span class="sxs-lookup"><span data-stu-id="3241c-287">While these values can be provided manually, when using ad-hoc SQL statements any customizations will be overwritten when the TableAdapter Configuration wizard is completed.</span></span>

<span data-ttu-id="3241c-288">幸運的是，使用預存程序所建立的 Tableadapter 不會發生與使用特定 SQL 陳述式所建立之相同脆弱度。</span><span class="sxs-lookup"><span data-stu-id="3241c-288">Fortunately, TableAdapters created using stored procedures do not suffer from the same brittleness as those created using ad-hoc SQL statements.</span></span> <span data-ttu-id="3241c-289">因此，就可以建立其主要的查詢會使用的 TableAdapter`JOIN`時使用預存程序。</span><span class="sxs-lookup"><span data-stu-id="3241c-289">Therefore, it is feasible to create a TableAdapter whose main query uses a `JOIN` when using stored procedures.</span></span> <span data-ttu-id="3241c-290">在本教學課程中，我們了解如何建立這類的 TableAdapter 的內容。</span><span class="sxs-lookup"><span data-stu-id="3241c-290">In this tutorial we saw how to create such a TableAdapter.</span></span> <span data-ttu-id="3241c-291">我們開始使用`JOIN`-較少`SELECT`TableAdapter s 主查詢的查詢，以便對應的 insert、 update 和 delete 預存程序會自動建立。</span><span class="sxs-lookup"><span data-stu-id="3241c-291">We started by using a `JOIN`-less `SELECT` query for the TableAdapter s main query so that the corresponding insert, update, and delete stored procedures would be auto-created.</span></span> <span data-ttu-id="3241c-292">TableAdapter s 初始設定完成後，我們擴大`SelectCommand`預存程序，使用`JOIN`並重新執行 TableAdapter 組態精靈以更新`EmployeesDataTable`s 資料行。</span><span class="sxs-lookup"><span data-stu-id="3241c-292">With the TableAdapter s initial configuration complete, we augmented the `SelectCommand` stored procedure to use a `JOIN` and re-ran the TableAdapter Configuration wizard to update the `EmployeesDataTable` s columns.</span></span>

<span data-ttu-id="3241c-293">重新執行 TableAdapter 組態精靈會自動更新`EmployeesDataTable`以反映所傳回的資料欄位的資料行`Employees_Select`預存程序。</span><span class="sxs-lookup"><span data-stu-id="3241c-293">Re-running the TableAdapter Configuration wizard automatically updated the `EmployeesDataTable` columns to reflect the data fields returned by the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="3241c-294">或者，我們可能有這些資料行手動新增至 DataTable。</span><span class="sxs-lookup"><span data-stu-id="3241c-294">Alternatively, we could have added these columns manually to the DataTable.</span></span> <span data-ttu-id="3241c-295">我們將探討以手動方式新增的資料行至 DataTable，在下一個教學課程。</span><span class="sxs-lookup"><span data-stu-id="3241c-295">We will explore manually adding columns to the DataTable in the next tutorial.</span></span>

<span data-ttu-id="3241c-296">快樂地寫程式 ！</span><span class="sxs-lookup"><span data-stu-id="3241c-296">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="3241c-297">關於作者</span><span class="sxs-lookup"><span data-stu-id="3241c-297">About the Author</span></span>

<span data-ttu-id="3241c-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，作者的七個 ASP 書籍和的創辦人[4GuysFromRolla.com](http://www.4guysfromrolla.com)，自 1998 年從事 Microsoft Web 技術工作。</span><span class="sxs-lookup"><span data-stu-id="3241c-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="3241c-299">Scott 會擔任獨立的顧問、 培訓講師和作家。</span><span class="sxs-lookup"><span data-stu-id="3241c-299">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="3241c-300">他最新的著作是[ *Sams 教導您自己 ASP.NET 2.0 在 24 小時內*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="3241c-300">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="3241c-301">他可以在觸達[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="3241c-301">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="3241c-302">或透過他的部落格，這位於 [http://ScottOnWriting.NET](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="3241c-302">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="3241c-303">特別感謝</span><span class="sxs-lookup"><span data-stu-id="3241c-303">Special Thanks To</span></span>

<span data-ttu-id="3241c-304">本教學課程系列是由許多實用的檢閱者檢閱。</span><span class="sxs-lookup"><span data-stu-id="3241c-304">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="3241c-305">本教學課程中的潛在客戶檢閱者已 Hilton Geisenow、 David Suru 和 Teresa murphy 徹底檢驗了。</span><span class="sxs-lookup"><span data-stu-id="3241c-305">Lead reviewers for this tutorial were Hilton Geisenow, David Suru, and Teresa Murphy.</span></span> <span data-ttu-id="3241c-306">有興趣檢閱我即將推出的 MSDN 文章嗎？</span><span class="sxs-lookup"><span data-stu-id="3241c-306">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="3241c-307">如果是這樣，psychic 在[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="3241c-307">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="3241c-308">[上一頁](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
> [下一頁](adding-additional-datatable-columns-vb.md)</span><span class="sxs-lookup"><span data-stu-id="3241c-308">[Previous](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
[Next](adding-additional-datatable-columns-vb.md)</span></span>
