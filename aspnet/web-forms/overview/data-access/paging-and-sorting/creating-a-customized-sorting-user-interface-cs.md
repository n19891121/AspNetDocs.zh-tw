---
uid: web-forms/overview/data-access/paging-and-sorting/creating-a-customized-sorting-user-interface-cs
title: 建立自訂的排序使用者介面C#（） |Microsoft Docs
author: rick-anderson
description: 當顯示一長串的已排序資料時，藉由引進分隔符號列來分組相關資料可能會很有説明。 在本教學課程中，我們將瞭解如何認證 。
ms.author: riande
ms.date: 08/15/2006
ms.assetid: 6f81b633-9d01-4e52-ae4a-2ea6bc109475
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting/creating-a-customized-sorting-user-interface-cs
msc.type: authoredcontent
ms.openlocfilehash: 93ec07a13de80e4c874ff46b5dfa626b60b632c8
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/28/2019
ms.locfileid: "74597274"
---
# <a name="creating-a-customized-sorting-user-interface-c"></a><span data-ttu-id="c539b-104">建立自訂的排序使用者介面 (C#)</span><span class="sxs-lookup"><span data-stu-id="c539b-104">Creating a Customized Sorting User Interface (C#)</span></span>

<span data-ttu-id="c539b-105">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="c539b-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="c539b-106">[下載範例應用程式](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_27_CS.exe)或[下載 PDF](creating-a-customized-sorting-user-interface-cs/_static/datatutorial27cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="c539b-106">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_27_CS.exe) or [Download PDF](creating-a-customized-sorting-user-interface-cs/_static/datatutorial27cs1.pdf)</span></span>

> <span data-ttu-id="c539b-107">當顯示一長串的已排序資料時，藉由引進分隔符號列來分組相關資料可能會很有説明。</span><span class="sxs-lookup"><span data-stu-id="c539b-107">When displaying a long list of sorted data, it can be very helpful to group related data by introducing separator rows.</span></span> <span data-ttu-id="c539b-108">在本教學課程中，我們將瞭解如何建立這類排序使用者介面。</span><span class="sxs-lookup"><span data-stu-id="c539b-108">In this tutorial we'll see how to create such a sorting user interface.</span></span>

## <a name="introduction"></a><span data-ttu-id="c539b-109">簡介</span><span class="sxs-lookup"><span data-stu-id="c539b-109">Introduction</span></span>

<span data-ttu-id="c539b-110">顯示已排序資料的一長串清單，其中只有幾個不同的值在已排序的資料行中，終端使用者可能會發現很難辨識差異界限發生的位置。</span><span class="sxs-lookup"><span data-stu-id="c539b-110">When displaying a long list of sorted data where there are only a handful of different values in the sorted column, an end user might find it hard to discern where, exactly, the difference boundaries occur.</span></span> <span data-ttu-id="c539b-111">例如，資料庫中有81產品，但只有九個不同的類別選擇（八個唯一的分類加上 `NULL` 選項）。</span><span class="sxs-lookup"><span data-stu-id="c539b-111">For example, there are 81 products in the database, but only nine different category choices (eight unique categories plus the `NULL` option).</span></span> <span data-ttu-id="c539b-112">請考慮有興趣檢查落在 [海鮮] 類別之下之產品的使用者案例。</span><span class="sxs-lookup"><span data-stu-id="c539b-112">Consider the case of a user who is interested in examining the products that fall under the Seafood category.</span></span> <span data-ttu-id="c539b-113">在單一 GridView 中列出*所有*產品的頁面中，使用者可能會決定其最佳做法是依類別排序結果，這會將所有的海鮮產品群組在一起。</span><span class="sxs-lookup"><span data-stu-id="c539b-113">From a page that lists *all* of the products in a single GridView, the user might decide her best bet is to sort the results by category, which will group together all of the Seafood products together.</span></span> <span data-ttu-id="c539b-114">依類別排序之後，使用者就必須搜尋清單，尋找以海鮮分組的產品開始和結束的位置。</span><span class="sxs-lookup"><span data-stu-id="c539b-114">After sorting by category, the user then needs to hunt through the list, looking for where the Seafood-grouped products start and end.</span></span> <span data-ttu-id="c539b-115">由於結果是依分類名稱以字母順序排序，尋找海鮮產品並不容易，但仍然需要仔細掃描方格中的專案清單。</span><span class="sxs-lookup"><span data-stu-id="c539b-115">Since the results are ordered alphabetically by the category name finding the Seafood products is not difficult, but it still requires closely scanning the list of items in the grid.</span></span>

<span data-ttu-id="c539b-116">為了協助強調已排序群組之間的界限，許多網站都採用使用者介面，在這類群組之間加上分隔符號。</span><span class="sxs-lookup"><span data-stu-id="c539b-116">To help highlight the boundaries between sorted groups, many websites employ a user interface that adds a separator between such groups.</span></span> <span data-ttu-id="c539b-117">像 [圖 1] 所示的分隔符號，可以讓使用者更快速地找到特定群組並識別其界限，以及確定資料中有哪些不同的群組存在。</span><span class="sxs-lookup"><span data-stu-id="c539b-117">Separators like the ones shown in Figure 1 enables a user to more quickly find a particular group and identify its boundaries, as well as ascertain what distinct groups exist in the data.</span></span>

<span data-ttu-id="c539b-118">[![清楚識別每個類別目錄群組](creating-a-customized-sorting-user-interface-cs/_static/image2.png)](creating-a-customized-sorting-user-interface-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="c539b-118">[![Each Category Group is Clearly Identified](creating-a-customized-sorting-user-interface-cs/_static/image2.png)](creating-a-customized-sorting-user-interface-cs/_static/image1.png)</span></span>

<span data-ttu-id="c539b-119">**圖 1**：清楚地識別每個類別目錄群組（[按一下以查看完整大小的影像](creating-a-customized-sorting-user-interface-cs/_static/image3.png)）</span><span class="sxs-lookup"><span data-stu-id="c539b-119">**Figure 1**: Each Category Group is Clearly Identified ([Click to view full-size image](creating-a-customized-sorting-user-interface-cs/_static/image3.png))</span></span>

<span data-ttu-id="c539b-120">在本教學課程中，我們將瞭解如何建立這類排序使用者介面。</span><span class="sxs-lookup"><span data-stu-id="c539b-120">In this tutorial we'll see how to create such a sorting user interface.</span></span>

## <a name="step-1-creating-a-standard-sortable-gridview"></a><span data-ttu-id="c539b-121">步驟1：建立標準、可排序的 GridView</span><span class="sxs-lookup"><span data-stu-id="c539b-121">Step 1: Creating a Standard, Sortable GridView</span></span>

<span data-ttu-id="c539b-122">在我們探索如何增強 GridView 以提供增強型排序介面之前，先建立一個可排序的標準 GridView 來列出產品。</span><span class="sxs-lookup"><span data-stu-id="c539b-122">Before we explore how to augment the GridView to provide the enhanced sorting interface, let s first create a standard, sortable GridView that lists the products.</span></span> <span data-ttu-id="c539b-123">從開啟 [`PagingAndSorting`] 資料夾中的 [`CustomSortingUI.aspx`] 頁面開始。</span><span class="sxs-lookup"><span data-stu-id="c539b-123">Start by opening the `CustomSortingUI.aspx` page in the `PagingAndSorting` folder.</span></span> <span data-ttu-id="c539b-124">將 GridView 新增至頁面，將其 [`ID`] 屬性設為 [`ProductList`]，並將它系結至新的 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="c539b-124">Add a GridView to the page, set its `ID` property to `ProductList`, and bind it to a new ObjectDataSource.</span></span> <span data-ttu-id="c539b-125">設定 ObjectDataSource 使用 `ProductsBLL` 類別的 `GetProducts()` 方法來選取記錄。</span><span class="sxs-lookup"><span data-stu-id="c539b-125">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method for selecting records.</span></span>

<span data-ttu-id="c539b-126">接下來，設定 GridView，使其只包含 `ProductName`、`CategoryName`、`SupplierName`和 `UnitPrice` BoundFields 和已停止的 CheckBoxField。</span><span class="sxs-lookup"><span data-stu-id="c539b-126">Next, configure the GridView such that it only contains the `ProductName`, `CategoryName`, `SupplierName`, and `UnitPrice` BoundFields and the Discontinued CheckBoxField.</span></span> <span data-ttu-id="c539b-127">最後，藉由勾選 GridView s 智慧標籤中的 [啟用排序] 核取方塊（或將其 [`AllowSorting`] 屬性設定為 [`true`]），將 GridView 設定為支援排序。</span><span class="sxs-lookup"><span data-stu-id="c539b-127">Finally, configure the GridView to support sorting by checking the Enable Sorting checkbox in the GridView s smart tag (or by setting its `AllowSorting` property to `true`).</span></span> <span data-ttu-id="c539b-128">在 `CustomSortingUI.aspx` 頁面上新增這些專案之後，宣告式標記看起來應該像下面這樣：</span><span class="sxs-lookup"><span data-stu-id="c539b-128">After making these additions to the `CustomSortingUI.aspx` page, the declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](creating-a-customized-sorting-user-interface-cs/samples/sample1.aspx)]

<span data-ttu-id="c539b-129">在瀏覽器中，花點時間觀看我們的進度。</span><span class="sxs-lookup"><span data-stu-id="c539b-129">Take a moment to view our progress thus far in a browser.</span></span> <span data-ttu-id="c539b-130">[圖 2] 顯示可排序的 GridView，其資料依類別目錄依字母順序排序。</span><span class="sxs-lookup"><span data-stu-id="c539b-130">Figure 2 shows the sortable GridView when its data is sorted by category in alphabetical order.</span></span>

<span data-ttu-id="c539b-131">[![可排序的 GridView s 資料依類別排序](creating-a-customized-sorting-user-interface-cs/_static/image5.png)](creating-a-customized-sorting-user-interface-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="c539b-131">[![The Sortable GridView s Data is Ordered by Category](creating-a-customized-sorting-user-interface-cs/_static/image5.png)](creating-a-customized-sorting-user-interface-cs/_static/image4.png)</span></span>

<span data-ttu-id="c539b-132">**圖 2**：可排序的 GridView s 資料依類別排序（[按一下以觀看完整大小的影像](creating-a-customized-sorting-user-interface-cs/_static/image6.png)）</span><span class="sxs-lookup"><span data-stu-id="c539b-132">**Figure 2**: The Sortable GridView s Data is Ordered by Category ([Click to view full-size image](creating-a-customized-sorting-user-interface-cs/_static/image6.png))</span></span>

## <a name="step-2-exploring-techniques-for-adding-the-separator-rows"></a><span data-ttu-id="c539b-133">步驟2：探索加入分隔符號資料列的技巧</span><span class="sxs-lookup"><span data-stu-id="c539b-133">Step 2: Exploring Techniques for Adding the Separator Rows</span></span>

<span data-ttu-id="c539b-134">使用一般的可排序 GridView 完成後，剩下的工作就是能夠在 GridView 中的每個唯一排序群組之前加入分隔符號資料列。</span><span class="sxs-lookup"><span data-stu-id="c539b-134">With the generic, sortable GridView complete, all that remains is to be able to add the separator rows in the GridView before each unique sorted group.</span></span> <span data-ttu-id="c539b-135">但這類資料列如何插入 GridView？</span><span class="sxs-lookup"><span data-stu-id="c539b-135">But how can such rows be injected into the GridView?</span></span> <span data-ttu-id="c539b-136">基本上，我們需要逐一查看 GridView 的資料列、判斷已排序資料行中的值之間有何差異，然後再加入適當的分隔欄。</span><span class="sxs-lookup"><span data-stu-id="c539b-136">Essentially, we need to iterate through the GridView s rows, determine where the differences occur between the values in the sorted column, and then add the appropriate separator row.</span></span> <span data-ttu-id="c539b-137">在思考這個問題時，此解決方案似乎是在 GridView 的 `RowDataBound` 事件處理常式中的某處。</span><span class="sxs-lookup"><span data-stu-id="c539b-137">When thinking about this problem, it seems natural that the solution lies somewhere in the GridView s `RowDataBound` event handler.</span></span> <span data-ttu-id="c539b-138">如我們在[根據資料的自訂格式](../custom-formatting/custom-formatting-based-upon-data-cs.md)教學課程中所討論，此事件處理常式通常會在根據資料列資料套用資料列層級的格式時使用。</span><span class="sxs-lookup"><span data-stu-id="c539b-138">As we discussed in the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-cs.md) tutorial, this event handler is commonly used when applying row-level formatting based on the row s data.</span></span> <span data-ttu-id="c539b-139">不過，`RowDataBound` 事件處理常式不是這裡的解決方案，因為無法以程式設計方式從這個事件處理常式將資料列加入至 GridView。</span><span class="sxs-lookup"><span data-stu-id="c539b-139">However, the `RowDataBound` event handler is not the solution here, as rows cannot be added to the GridView programmatically from this event handler.</span></span> <span data-ttu-id="c539b-140">事實上，GridView 的 `Rows` 集合是唯讀的。</span><span class="sxs-lookup"><span data-stu-id="c539b-140">The GridView s `Rows` collection, in fact, is read-only.</span></span>

<span data-ttu-id="c539b-141">若要在 GridView 中加入其他資料列，我們有三個選擇：</span><span class="sxs-lookup"><span data-stu-id="c539b-141">To add additional rows to the GridView we have three choices:</span></span>

- <span data-ttu-id="c539b-142">將這些中繼資料分隔資料列新增至系結至 GridView 的實際資料</span><span class="sxs-lookup"><span data-stu-id="c539b-142">Add these metadata separator rows to the actual data that is bound to the GridView</span></span>
- <span data-ttu-id="c539b-143">將 GridView 系結至資料之後，將其他 `TableRow` 實例新增至 GridView 的控制項集合</span><span class="sxs-lookup"><span data-stu-id="c539b-143">After the GridView has been bound to the data, add additional `TableRow` instances to the GridView s control collection</span></span>
- <span data-ttu-id="c539b-144">建立擴充 GridView 控制項的自訂伺服器控制項，並覆寫負責建立 GridView 結構的方法</span><span class="sxs-lookup"><span data-stu-id="c539b-144">Create a custom server control that extends the GridView control and overrides those methods responsible for constructing the GridView s structure</span></span>

<span data-ttu-id="c539b-145">如果在許多網頁上或跨多個網站需要這項功能，建立自訂伺服器控制項就是最好的方法。</span><span class="sxs-lookup"><span data-stu-id="c539b-145">Creating a custom server control would be the best approach if this functionality was needed on many web pages or across several websites.</span></span> <span data-ttu-id="c539b-146">不過，它需要相當多的程式碼，並徹底探索 GridView 內部工作的深度。</span><span class="sxs-lookup"><span data-stu-id="c539b-146">However, it would entail quite a bit of code and a thorough exploration into the depths of the GridView s internal workings.</span></span> <span data-ttu-id="c539b-147">因此，在本教學課程中，我們不會考慮此選項。</span><span class="sxs-lookup"><span data-stu-id="c539b-147">Therefore, we'll not consider that option for this tutorial.</span></span>

<span data-ttu-id="c539b-148">其他兩個選項會將分隔符號資料列加入至要系結至 GridView 的實際資料，並在其系結之後操作 GridView 的控制項集合，並以不同的方式攻擊問題並提出討論。</span><span class="sxs-lookup"><span data-stu-id="c539b-148">The other two options adding separator rows to the actual data being bound to the GridView and manipulating the GridView s control collection after its been bound - attack the problem differently and merit a discussion.</span></span>

## <a name="adding-rows-to-the-data-bound-to-the-gridview"></a><span data-ttu-id="c539b-149">將資料列加入至系結至 GridView 的資料</span><span class="sxs-lookup"><span data-stu-id="c539b-149">Adding Rows to the Data Bound to the GridView</span></span>

<span data-ttu-id="c539b-150">當 GridView 系結至資料來源時，它會針對資料來源所傳回的每個記錄建立一個 `GridViewRow`。</span><span class="sxs-lookup"><span data-stu-id="c539b-150">When the GridView is bound to a data source, it creates a `GridViewRow` for each record returned by the data source.</span></span> <span data-ttu-id="c539b-151">因此，我們可以藉由在資料來源中加入分隔記錄，然後將它系結至 GridView，藉以插入所需的分隔資料列。</span><span class="sxs-lookup"><span data-stu-id="c539b-151">Therefore, we can inject the needed separator rows by adding separator records to the data source before binding it to the GridView.</span></span> <span data-ttu-id="c539b-152">[圖 3] 說明此概念。</span><span class="sxs-lookup"><span data-stu-id="c539b-152">Figure 3 illustrates this concept.</span></span>

![其中一項技術包括將分隔資料列加入至資料來源](creating-a-customized-sorting-user-interface-cs/_static/image7.png)

<span data-ttu-id="c539b-154">**圖 3**：其中一項技術牽涉到將分隔資料列加入至資料來源</span><span class="sxs-lookup"><span data-stu-id="c539b-154">**Figure 3**: One Technique Involves Adding Separator Rows to the Data Source</span></span>

<span data-ttu-id="c539b-155">我使用引號中的「分隔符號」（separator）記錄，因為沒有任何特殊的分隔符號記錄。相反地，我們必須以某種方式來旗標資料來源中的特定記錄做為分隔符號，而不是一般資料列。</span><span class="sxs-lookup"><span data-stu-id="c539b-155">I use the term separator records in quotes because there is no special separator record; rather, we must somehow flag that a particular record in the data source serves as a separator rather than a normal data row.</span></span> <span data-ttu-id="c539b-156">在我們的範例中，我們會將 `ProductsDataTable` 實例重新系結至 GridView，這是由 `ProductRows`所組成。</span><span class="sxs-lookup"><span data-stu-id="c539b-156">For our examples, we re binding a `ProductsDataTable` instance to the GridView, which is composed of `ProductRows`.</span></span> <span data-ttu-id="c539b-157">我們可能會藉由將記錄的 `CategoryID` 屬性設定為 `-1` （因為這樣的值無法正常存在），將記錄標示為分隔資料列。</span><span class="sxs-lookup"><span data-stu-id="c539b-157">We might flag a record as a separator row by setting its `CategoryID` property to `-1` (since such a value couldn't exist normally).</span></span>

<span data-ttu-id="c539b-158">若要利用這項技術，我們必須執行下列步驟：</span><span class="sxs-lookup"><span data-stu-id="c539b-158">To utilize this technique we d need to perform the following steps:</span></span>

1. <span data-ttu-id="c539b-159">以程式設計方式取出資料以系結至 GridView （`ProductsDataTable` 實例）</span><span class="sxs-lookup"><span data-stu-id="c539b-159">Programmatically retrieve the data to bind to the GridView (a `ProductsDataTable` instance)</span></span>
2. <span data-ttu-id="c539b-160">根據 GridView 的 `SortExpression` 和 `SortDirection` 屬性來排序資料</span><span class="sxs-lookup"><span data-stu-id="c539b-160">Sort the data based on the GridView s `SortExpression` and `SortDirection` properties</span></span>
3. <span data-ttu-id="c539b-161">逐一查看 `ProductsDataTable`中的 `ProductsRows`，尋找已排序資料行中差異的位置</span><span class="sxs-lookup"><span data-stu-id="c539b-161">Iterate through the `ProductsRows` in the `ProductsDataTable`, looking for where the differences in the sorted column lie</span></span>
4. <span data-ttu-id="c539b-162">在每個群組界限中，將分隔符號記錄 `ProductsRow` 實例插入 DataTable 中，其 `CategoryID` 設定為 `-1` （或決定將記錄標示為分隔符號記錄的任何指定）</span><span class="sxs-lookup"><span data-stu-id="c539b-162">At each group boundary, inject a separator record `ProductsRow` instance into the DataTable, one that has it s `CategoryID` set to `-1` (or whatever designation was decided upon to mark a record as a separator record )</span></span>
5. <span data-ttu-id="c539b-163">插入分隔符號列之後，以程式設計方式將資料系結至 GridView</span><span class="sxs-lookup"><span data-stu-id="c539b-163">After injecting the separator rows, programmatically bind the data to the GridView</span></span>

<span data-ttu-id="c539b-164">除了這五個步驟以外，我們也需要為 GridView 的 `RowDataBound` 事件提供事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="c539b-164">In addition to these five steps, we d also need to provide an event handler for the GridView s `RowDataBound` event.</span></span> <span data-ttu-id="c539b-165">在這裡，我們會檢查每個 `DataRow` 並判斷它是否為分隔符號資料列，其 `CategoryID` 設定已 `-1`。</span><span class="sxs-lookup"><span data-stu-id="c539b-165">Here, we d check each `DataRow` and determine if it was a separator row, one whose `CategoryID` setting was `-1`.</span></span> <span data-ttu-id="c539b-166">若是如此，我們可能會想要調整其格式或顯示在資料格中的文字。</span><span class="sxs-lookup"><span data-stu-id="c539b-166">If so, we d probably want to adjust its formatting or the text displayed in the cell(s).</span></span>

<span data-ttu-id="c539b-167">使用這項技術來插入排序群組界限需要比上述更多的工作，因為您也需要為 GridView 的 `Sorting` 事件提供事件處理常式，並追蹤 `SortExpression` 和 `SortDirection` 值。</span><span class="sxs-lookup"><span data-stu-id="c539b-167">Using this technique for injecting the sorting group boundaries requires a bit more work than outlined above, as you need to also provide an event handler for the GridView s `Sorting` event and keep track of the `SortExpression` and `SortDirection` values.</span></span>

## <a name="manipulating-the-gridview-s-control-collection-after-it-s-been-databound"></a><span data-ttu-id="c539b-168">在資料系結之後操作 GridView 的控制項集合</span><span class="sxs-lookup"><span data-stu-id="c539b-168">Manipulating the GridView s Control Collection After It s Been Databound</span></span>

<span data-ttu-id="c539b-169">我們可以在將資料系結至 gridview*之後*加入分隔符號資料列，而不是在系結至 gridview 之前，先將資料傳送給它。</span><span class="sxs-lookup"><span data-stu-id="c539b-169">Rather than messaging the data before binding it to the GridView, we can add the separator rows *after* the data has been bound to the GridView.</span></span> <span data-ttu-id="c539b-170">資料系結的程式會建立 GridView 的控制階層，事實上，這只是由一系列資料列組成的 `Table` 實例，其中每一個都是由一組資料格所組成。</span><span class="sxs-lookup"><span data-stu-id="c539b-170">The process of data binding builds up the GridView s control hierarchy, which in reality is simply a `Table` instance composed of a collection of rows, each of which is composed of a collection of cells.</span></span> <span data-ttu-id="c539b-171">具體而言，GridView 的控制項集合包含其根目錄的 `Table` 物件、系結至 GridView 之 `DataSource` 中每筆記錄的 `GridViewRow` （衍生自 `TableRow` 類別），以及 `TableCell` 中每個資料欄位的每個 `GridViewRow` 實例中的 `DataSource`物件。</span><span class="sxs-lookup"><span data-stu-id="c539b-171">Specifically, the GridView s control collection contains a `Table` object at its root, a `GridViewRow` (which is derived from the `TableRow` class) for each record in the `DataSource` bound to the GridView, and a `TableCell` object in each `GridViewRow` instance for each data field in the `DataSource`.</span></span>

<span data-ttu-id="c539b-172">若要在每個排序群組之間加入分隔資料列，我們可以在建立此控制項階層之後直接操作。</span><span class="sxs-lookup"><span data-stu-id="c539b-172">To add separator rows between each sorting group, we can directly manipulate this control hierarchy once it has been created.</span></span> <span data-ttu-id="c539b-173">我們可以放心，GridView 的控制項階層是在頁面轉譯的最後一次建立的。</span><span class="sxs-lookup"><span data-stu-id="c539b-173">We can be confident that the GridView s control hierarchy has been created for the last time by the time the page is being rendered.</span></span> <span data-ttu-id="c539b-174">因此，此方法會覆寫 `Page` 類別的 `Render` 方法，此時 GridView 的最終控制項階層會更新為包含所需的分隔資料列。</span><span class="sxs-lookup"><span data-stu-id="c539b-174">Therefore, this approach overrides the `Page` class s `Render` method, at which point the GridView s final control hierarchy is updated to include the needed separator rows.</span></span> <span data-ttu-id="c539b-175">[圖 4] 說明此程式。</span><span class="sxs-lookup"><span data-stu-id="c539b-175">Figure 4 illustrates this process.</span></span>

<span data-ttu-id="c539b-176">[![用於操作 GridView s 控制項階層的替代技術](creating-a-customized-sorting-user-interface-cs/_static/image9.png)](creating-a-customized-sorting-user-interface-cs/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="c539b-176">[![An Alternate Technique Manipulates the GridView s Control Hierarchy](creating-a-customized-sorting-user-interface-cs/_static/image9.png)](creating-a-customized-sorting-user-interface-cs/_static/image8.png)</span></span>

<span data-ttu-id="c539b-177">**圖 4**：操作 GridView s 控制階層的替代方法（[按一下以觀看完整大小的影像](creating-a-customized-sorting-user-interface-cs/_static/image10.png)）</span><span class="sxs-lookup"><span data-stu-id="c539b-177">**Figure 4**: An Alternate Technique Manipulates the GridView s Control Hierarchy ([Click to view full-size image](creating-a-customized-sorting-user-interface-cs/_static/image10.png))</span></span>

<span data-ttu-id="c539b-178">在本教學課程中，我們將使用這第二個方法來自訂排序使用者體驗。</span><span class="sxs-lookup"><span data-stu-id="c539b-178">For this tutorial, we'll use this latter approach to customize the sorting user experience.</span></span>

> [!NOTE]
> <span data-ttu-id="c539b-179">本教學課程中所示範的程式碼是以[Teemu Keiski](http://aspadvice.com/blogs/joteke/default.aspx) s blog 專案中提供的範例為基礎，[並使用 GridView 排序群組來播放一些](http://aspadvice.com/blogs/joteke/archive/2006/02/11/15130.aspx)。</span><span class="sxs-lookup"><span data-stu-id="c539b-179">The code I m presenting in this tutorial is based on the example provided in [Teemu Keiski](http://aspadvice.com/blogs/joteke/default.aspx) s blog entry, [Playing a Bit with GridView Sort Grouping](http://aspadvice.com/blogs/joteke/archive/2006/02/11/15130.aspx).</span></span>

## <a name="step-3-adding-the-separator-rows-to-the-gridview-s-control-hierarchy"></a><span data-ttu-id="c539b-180">步驟3：將分隔符號資料列加入至 GridView 的控制項階層架構</span><span class="sxs-lookup"><span data-stu-id="c539b-180">Step 3: Adding the Separator Rows to the GridView s Control Hierarchy</span></span>

<span data-ttu-id="c539b-181">因為我們只想要在控制項階層已建立並在該頁面上最後一次建立時，將分隔資料列加入至 GridView 的控制項階層，所以我們想要在頁面生命週期結束時，但在實際 GridView c 之前執行這項新增控制階層已轉譯為 HTML。</span><span class="sxs-lookup"><span data-stu-id="c539b-181">Since we only want to add the separator rows to the GridView s control hierarchy after its control hierarchy has been created and created for the last time on that page visit, we want to perform this addition at the end of the page lifecycle, but before the actual GridView control hierarchy has been rendered into HTML.</span></span> <span data-ttu-id="c539b-182">我們可以完成這項工作的最新可能點是 `Page` 類別的 `Render` 事件，我們可以使用下列方法簽章，在程式碼後置類別中覆寫：</span><span class="sxs-lookup"><span data-stu-id="c539b-182">The latest possible point at which we can accomplish this is the `Page` class s `Render` event, which we can override in our code-behind class using the following method signature:</span></span>

[!code-csharp[Main](creating-a-customized-sorting-user-interface-cs/samples/sample2.cs)]

<span data-ttu-id="c539b-183">叫用 `Page` 類別的原始 `Render` 方法時 `base.Render(writer)` 會轉譯頁面中的每個控制項，並根據控制項階層來產生標記。</span><span class="sxs-lookup"><span data-stu-id="c539b-183">When the `Page` class s original `Render` method is invoked `base.Render(writer)` each of the controls in the page will be rendered, generating the markup based on their control hierarchy.</span></span> <span data-ttu-id="c539b-184">因此，我們必須呼叫 `base.Render(writer)`，以便呈現頁面，而且我們會在呼叫 `base.Render(writer)`之前操作 GridView s 控制項階層，以便在轉譯之前將分隔符號資料列新增至 GridView s 控制項階層。</span><span class="sxs-lookup"><span data-stu-id="c539b-184">Therefore it is imperative that we both call `base.Render(writer)`, so that the page is rendered, and that we manipulate the GridView s control hierarchy prior to calling `base.Render(writer)`, so that the separator rows have been added to the GridView s control hierarchy before it s been rendered.</span></span>

<span data-ttu-id="c539b-185">若要插入排序群組標頭，我們必須先確認使用者已要求排序資料。</span><span class="sxs-lookup"><span data-stu-id="c539b-185">To inject the sort group headers we first need to ensure that the user has requested that the data be sorted.</span></span> <span data-ttu-id="c539b-186">根據預設，GridView 的內容不會排序，因此不需要輸入任何群組排序標頭。</span><span class="sxs-lookup"><span data-stu-id="c539b-186">By default, the GridView s contents are not sorted, and therefore we don t need to enter any group sorting headers.</span></span>

> [!NOTE]
> <span data-ttu-id="c539b-187">當第一次載入頁面時，如果您想要依特定資料行來排序 GridView，請在第一頁上呼叫 GridView s `Sort` 方法（但不在後續回傳時）。</span><span class="sxs-lookup"><span data-stu-id="c539b-187">If you want the GridView to be sorted by a particular column when the page is first loaded, call the GridView s `Sort` method on the first page visit (but not on subsequent postbacks).</span></span> <span data-ttu-id="c539b-188">若要完成這項操作，請在 `if (!Page.IsPostBack)` 條件的 `Page_Load` 事件處理常式中新增此呼叫。</span><span class="sxs-lookup"><span data-stu-id="c539b-188">To accomplish this, add this call in the `Page_Load` event handler within an `if (!Page.IsPostBack)` conditional.</span></span> <span data-ttu-id="c539b-189">如需 `Sort` 方法的詳細資訊，請回頭參閱[分頁和排序報表資料](paging-and-sorting-report-data-cs.md)教學課程資訊。</span><span class="sxs-lookup"><span data-stu-id="c539b-189">Refer back to the [Paging and Sorting Report Data](paging-and-sorting-report-data-cs.md) tutorial information for more on the `Sort` method.</span></span>

<span data-ttu-id="c539b-190">假設資料已經過排序，下一項工作是要判斷資料的排序依據，然後掃描資料列以尋找該資料行的值之間的差異。</span><span class="sxs-lookup"><span data-stu-id="c539b-190">Assuming that the data has been sorted, our next task is to determine what column the data was sorted by and then to scan the rows looking for differences in that column s values.</span></span> <span data-ttu-id="c539b-191">下列程式碼可確保資料已排序，並尋找資料已排序所依據的資料行：</span><span class="sxs-lookup"><span data-stu-id="c539b-191">The following code ensures that the data has been sorted and finds the column by which the data has been sorted:</span></span>

[!code-csharp[Main](creating-a-customized-sorting-user-interface-cs/samples/sample3.cs)]

<span data-ttu-id="c539b-192">如果 GridView 尚未排序，則不會設定 GridView 的 `SortExpression` 屬性。</span><span class="sxs-lookup"><span data-stu-id="c539b-192">If the GridView has yet to be sorted, the GridView s `SortExpression` property will not have been set.</span></span> <span data-ttu-id="c539b-193">因此，如果這個屬性有一些值，我們只想要加入分隔符號資料列。</span><span class="sxs-lookup"><span data-stu-id="c539b-193">Therefore, we only want to add the separator rows if this property has some value.</span></span> <span data-ttu-id="c539b-194">如果有的話，我們接下來必須決定資料的排序依據的索引。</span><span class="sxs-lookup"><span data-stu-id="c539b-194">If it does, we next need to determine the index of the column by which the data was sorted.</span></span> <span data-ttu-id="c539b-195">這是藉由在 GridView 的 `Columns` 集合中進行迴圈，搜尋其 `SortExpression` 屬性等於 GridView s `SortExpression` 屬性的資料行來完成。</span><span class="sxs-lookup"><span data-stu-id="c539b-195">This is accomplished by looping through the GridView s `Columns` collection, searching for the column whose `SortExpression` property equals the GridView s `SortExpression` property.</span></span> <span data-ttu-id="c539b-196">除了資料行的索引之外，我們也會抓取 [`HeaderText`] 屬性，這會在顯示分隔符號資料列時使用。</span><span class="sxs-lookup"><span data-stu-id="c539b-196">In addition to the column s index, we also grab the `HeaderText` property, which is used when displaying the separator rows.</span></span>

<span data-ttu-id="c539b-197">藉由排序資料的資料行索引，最後一個步驟是列舉 GridView 的列。</span><span class="sxs-lookup"><span data-stu-id="c539b-197">With the index of the column by which the data is sorted, the final step is to enumerate the rows of the GridView.</span></span> <span data-ttu-id="c539b-198">針對每個資料列，我們必須判斷排序的資料行的值是否與上一個資料列的排序資料行 s 值不同。</span><span class="sxs-lookup"><span data-stu-id="c539b-198">For each row we need to determine whether the sorted column s value differs from the previous row s sorted column s value.</span></span> <span data-ttu-id="c539b-199">若是如此，我們必須將新的 `GridViewRow` 實例插入控制項階層中。</span><span class="sxs-lookup"><span data-stu-id="c539b-199">If so, we need to inject a new `GridViewRow` instance into the control hierarchy.</span></span> <span data-ttu-id="c539b-200">使用下列程式碼即可完成這項作業：</span><span class="sxs-lookup"><span data-stu-id="c539b-200">This is accomplished with the following code:</span></span>

[!code-csharp[Main](creating-a-customized-sorting-user-interface-cs/samples/sample4.cs)]

<span data-ttu-id="c539b-201">此程式碼一開始會以程式設計方式參考在 GridView 控制項階層的根目錄中找到的 `Table` 物件，並建立名為 `lastValue`的字串變數。</span><span class="sxs-lookup"><span data-stu-id="c539b-201">This code starts by programmatically referencing the `Table` object found at the root of the GridView s control hierarchy and creating a string variable named `lastValue`.</span></span> <span data-ttu-id="c539b-202">`lastValue` 可用來比較目前資料列的已排序資料行值與前一個資料列的值。</span><span class="sxs-lookup"><span data-stu-id="c539b-202">`lastValue` is used to compare the current row s sorted column value with the previous row s value.</span></span> <span data-ttu-id="c539b-203">接下來，會列舉 GridView 的 `Rows` 集合，並針對每個資料列，已排序資料行的值會儲存在 `currentValue` 變數中。</span><span class="sxs-lookup"><span data-stu-id="c539b-203">Next, the GridView s `Rows` collection is enumerated and for each row the value of the sorted column is stored in the `currentValue` variable.</span></span>

> [!NOTE]
> <span data-ttu-id="c539b-204">若要判斷特定資料列排序資料行的值，我使用 cell `Text` 屬性。</span><span class="sxs-lookup"><span data-stu-id="c539b-204">To determine the value of the particular row s sorted column I use the cell s `Text` property.</span></span> <span data-ttu-id="c539b-205">這適用于 BoundFields，但不會如預期般用於 TemplateFields、CheckBoxFields 等等。</span><span class="sxs-lookup"><span data-stu-id="c539b-205">This works well for BoundFields, but will not work as desired for TemplateFields, CheckBoxFields, and so on.</span></span> <span data-ttu-id="c539b-206">我們將在稍後討論如何為替代的 GridView 欄位提供考慮。</span><span class="sxs-lookup"><span data-stu-id="c539b-206">We'll look at how to account for alternate GridView fields shortly.</span></span>

<span data-ttu-id="c539b-207">然後會比較 `currentValue` 和 `lastValue` 變數。</span><span class="sxs-lookup"><span data-stu-id="c539b-207">The `currentValue` and `lastValue` variables are then compared.</span></span> <span data-ttu-id="c539b-208">如果兩者不同，我們需要在控制項階層中加入一個新的分隔資料列。</span><span class="sxs-lookup"><span data-stu-id="c539b-208">If they differ we need to add a new separator row to the control hierarchy.</span></span> <span data-ttu-id="c539b-209">這是藉由判斷 `Table` 物件 s `Rows` 集合中 `GridViewRow` 的索引、建立新的 `GridViewRow` 和 `TableCell` 實例，然後將 `TableCell` 和 `GridViewRow` 加入至控制項階層來完成。</span><span class="sxs-lookup"><span data-stu-id="c539b-209">This is accomplished by determining the index of the `GridViewRow` in the `Table` object s `Rows` collection, creating new `GridViewRow` and `TableCell` instances, and then adding the `TableCell` and `GridViewRow` to the control hierarchy.</span></span>

<span data-ttu-id="c539b-210">請注意，分隔符號資料列獨立 `TableCell` 的格式會使其橫跨 GridView 的整個寬度、使用 `SortHeaderRowStyle` CSS 類別進行格式化，並具有其 `Text` 屬性，使其同時顯示排序組名（例如 Category）和 group s 值（例如飲料）。</span><span class="sxs-lookup"><span data-stu-id="c539b-210">Note that the separator row s lone `TableCell` is formatted such that it spans the entire width of the GridView, is formatted using the `SortHeaderRowStyle` CSS class, and has its `Text` property such that it shows both the sort group name (such as Category ) and the group s value (such as Beverages ).</span></span> <span data-ttu-id="c539b-211">最後，`lastValue` 會更新為 `currentValue`的值。</span><span class="sxs-lookup"><span data-stu-id="c539b-211">Finally, `lastValue` is updated to the value of `currentValue`.</span></span>

<span data-ttu-id="c539b-212">用來格式化排序群組標頭資料列 `SortHeaderRowStyle` 的 CSS 類別必須在 `Styles.css` 檔案中指定。</span><span class="sxs-lookup"><span data-stu-id="c539b-212">The CSS class used to format the sorting group header row `SortHeaderRowStyle` needs to be specified in the `Styles.css` file.</span></span> <span data-ttu-id="c539b-213">您可以隨意使用任何想要的樣式設定;我使用了下列內容：</span><span class="sxs-lookup"><span data-stu-id="c539b-213">Feel free to use whatever style settings appeal to you; I used the following:</span></span>

[!code-css[Main](creating-a-customized-sorting-user-interface-cs/samples/sample5.css)]

<span data-ttu-id="c539b-214">使用目前的程式碼，排序介面會在依任何 BoundField 排序時加入排序群組標頭（請參閱 [圖 5]，這會顯示依供應商排序時的螢幕擷取畫面）。</span><span class="sxs-lookup"><span data-stu-id="c539b-214">With the current code, the sorting interface adds sort group headers when sorting by any BoundField (see Figure 5, which shows a screenshot when sorting by supplier).</span></span> <span data-ttu-id="c539b-215">不過，依任何其他欄位類型（例如 CheckBoxField 或 TemplateField）排序時，不會找到排序群組標頭（請參閱 [圖 6]）。</span><span class="sxs-lookup"><span data-stu-id="c539b-215">However, when sorting by any other field type (such as a CheckBoxField or TemplateField), the sort group headers are nowhere to be found (see Figure 6).</span></span>

<span data-ttu-id="c539b-216">[![排序介面在依 BoundFields 排序時包含排序群組標頭](creating-a-customized-sorting-user-interface-cs/_static/image12.png)](creating-a-customized-sorting-user-interface-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="c539b-216">[![The Sorting Interface Includes Sort Group Headers When Sorting by BoundFields](creating-a-customized-sorting-user-interface-cs/_static/image12.png)](creating-a-customized-sorting-user-interface-cs/_static/image11.png)</span></span>

<span data-ttu-id="c539b-217">**圖 5**：排序介面包含依 BoundFields 排序時的排序群組標頭（[按一下以查看完整大小的影像](creating-a-customized-sorting-user-interface-cs/_static/image13.png)）</span><span class="sxs-lookup"><span data-stu-id="c539b-217">**Figure 5**: The Sorting Interface Includes Sort Group Headers When Sorting by BoundFields ([Click to view full-size image](creating-a-customized-sorting-user-interface-cs/_static/image13.png))</span></span>

<span data-ttu-id="c539b-218">[排序 CheckBoxField 時，![排序群組標頭遺失](creating-a-customized-sorting-user-interface-cs/_static/image15.png)](creating-a-customized-sorting-user-interface-cs/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="c539b-218">[![The Sort Group Headers are Missing When Sorting a CheckBoxField](creating-a-customized-sorting-user-interface-cs/_static/image15.png)](creating-a-customized-sorting-user-interface-cs/_static/image14.png)</span></span>

<span data-ttu-id="c539b-219">**圖 6**：排序 CheckBoxField （[按一下以觀看完整大小的影像](creating-a-customized-sorting-user-interface-cs/_static/image16.png)）時，排序群組標頭遺失</span><span class="sxs-lookup"><span data-stu-id="c539b-219">**Figure 6**: The Sort Group Headers are Missing When Sorting a CheckBoxField ([Click to view full-size image](creating-a-customized-sorting-user-interface-cs/_static/image16.png))</span></span>

<span data-ttu-id="c539b-220">依 CheckBoxField 排序時，排序群組標頭遺漏的原因是因為程式碼目前僅使用 `TableCell` s `Text` 屬性來判斷每個資料列之已排序資料行的值。</span><span class="sxs-lookup"><span data-stu-id="c539b-220">The reason the sort group headers are missing when sorting by a CheckBoxField is because the code currently uses just the `TableCell` s `Text` property to determine the value of the sorted column for each row.</span></span> <span data-ttu-id="c539b-221">若為 CheckBoxFields，`TableCell` s `Text` 屬性為空字串;相反地，此值可透過位於 `TableCell` s `Controls` 集合內的核取方塊 Web 控制項來取得。</span><span class="sxs-lookup"><span data-stu-id="c539b-221">For CheckBoxFields, the `TableCell` s `Text` property is an empty string; instead, the value is available through a CheckBox Web control that resides within the `TableCell` s `Controls` collection.</span></span>

<span data-ttu-id="c539b-222">若要處理 BoundFields 以外的欄位類型，我們必須擴充指派 `currentValue` 變數的程式碼，以檢查 `TableCell` s `Controls` 集合中是否存在核取方塊。</span><span class="sxs-lookup"><span data-stu-id="c539b-222">To handle field types other than BoundFields, we need to augment the code where the `currentValue` variable is assigned to check for the existence of a CheckBox in the `TableCell` s `Controls` collection.</span></span> <span data-ttu-id="c539b-223">不使用 `currentValue = gvr.Cells[sortColumnIndex].Text`，而是將此程式碼取代為下列內容：</span><span class="sxs-lookup"><span data-stu-id="c539b-223">Instead of using `currentValue = gvr.Cells[sortColumnIndex].Text`, replace this code with the following:</span></span>

[!code-csharp[Main](creating-a-customized-sorting-user-interface-cs/samples/sample6.cs)]

<span data-ttu-id="c539b-224">此程式碼會檢查目前資料列的已排序資料行 `TableCell`，以判斷 `Controls` 集合中是否有任何控制項。</span><span class="sxs-lookup"><span data-stu-id="c539b-224">This code examines the sorted column `TableCell` for the current row to determine if there are any controls in the `Controls` collection.</span></span> <span data-ttu-id="c539b-225">如果有，而且第一個控制項是核取方塊，則 `currentValue` 變數會設定為 [是] 或 [否]，視 CheckBox 的 `Checked` 屬性而定。</span><span class="sxs-lookup"><span data-stu-id="c539b-225">If there are, and the first control is a CheckBox, the `currentValue` variable is set to Yes or No, depending on the CheckBox s `Checked` property.</span></span> <span data-ttu-id="c539b-226">否則，會從 `TableCell` s `Text` 屬性取得值。</span><span class="sxs-lookup"><span data-stu-id="c539b-226">Otherwise, the value is taken from the `TableCell` s `Text` property.</span></span> <span data-ttu-id="c539b-227">這個邏輯可以複寫來處理可能存在於 GridView 中之任何 TemplateFields 的排序。</span><span class="sxs-lookup"><span data-stu-id="c539b-227">This logic can be replicated to handle sorting for any TemplateFields that may exist in the GridView.</span></span>

<span data-ttu-id="c539b-228">在上述程式碼新增中，排序群組標頭現在會在依照已停止的 CheckBoxField 排序時出現（請參閱 [圖 7]）。</span><span class="sxs-lookup"><span data-stu-id="c539b-228">With the above code addition, the sort group headers are now present when sorting by the Discontinued CheckBoxField (see Figure 7).</span></span>

<span data-ttu-id="c539b-229">[![排序群組標頭現在會在排序 CheckBoxField 時出現](creating-a-customized-sorting-user-interface-cs/_static/image18.png)](creating-a-customized-sorting-user-interface-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="c539b-229">[![The Sort Group Headers are Now Present When Sorting a CheckBoxField](creating-a-customized-sorting-user-interface-cs/_static/image18.png)](creating-a-customized-sorting-user-interface-cs/_static/image17.png)</span></span>

<span data-ttu-id="c539b-230">**圖 7**：排序群組標頭現在會在排序 CheckBoxField 時顯示（[按一下以觀看完整大小的影像](creating-a-customized-sorting-user-interface-cs/_static/image19.png)）</span><span class="sxs-lookup"><span data-stu-id="c539b-230">**Figure 7**: The Sort Group Headers are Now Present When Sorting a CheckBoxField ([Click to view full-size image](creating-a-customized-sorting-user-interface-cs/_static/image19.png))</span></span>

> [!NOTE]
> <span data-ttu-id="c539b-231">如果您的產品具有 [`CategoryID`]、[`SupplierID`] 或 [`UnitPrice`] 欄位的 `NULL` 資料庫值，則這些值預設會顯示為 GridView 中的空字串，這表示具有 `NULL` 值之產品的分隔符號資料列文字將會讀取，如下類別：（也就是類別目錄之後沒有名稱：如 Category：飲料）。</span><span class="sxs-lookup"><span data-stu-id="c539b-231">If you have products with `NULL` database values for the `CategoryID`, `SupplierID`, or `UnitPrice` fields, those values will appear as empty strings in the GridView by default, meaning the separator row s text for those products with `NULL` values will read like Category: (that is, there s no name after Category: like with Category: Beverages ).</span></span> <span data-ttu-id="c539b-232">如果您想要在這裡顯示的值，您可以將 [BoundFields [`NullDisplayText`] 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.nulldisplaytext.aspx)設為您要顯示的文字，或在將 `currentValue` 指派給 [分隔符號] 資料列 `Text` 屬性時，將條件陳述式加入至 Render 方法。</span><span class="sxs-lookup"><span data-stu-id="c539b-232">If you want a value displayed here you can either set the BoundFields [`NullDisplayText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.nulldisplaytext.aspx) to the text you want displayed or you can add a conditional statement in the Render method when assigning the `currentValue` to the separator row s `Text` property.</span></span>

## <a name="summary"></a><span data-ttu-id="c539b-233">總結</span><span class="sxs-lookup"><span data-stu-id="c539b-233">Summary</span></span>

<span data-ttu-id="c539b-234">GridView 不包含許多自訂排序介面的內建選項。</span><span class="sxs-lookup"><span data-stu-id="c539b-234">The GridView does not include many built-in options for customizing the sorting interface.</span></span> <span data-ttu-id="c539b-235">不過，有了一些低層級的程式碼，就可以調整 GridView 的控制階層，以建立更多自訂的介面。</span><span class="sxs-lookup"><span data-stu-id="c539b-235">However, with a bit of low-level code, it s possible to tweak the GridView s control hierarchy to create a more customized interface.</span></span> <span data-ttu-id="c539b-236">在本教學課程中，我們已瞭解如何為可排序的 GridView 新增排序群組分隔符號，以便更輕鬆地識別不同的群組和這些群組界限。</span><span class="sxs-lookup"><span data-stu-id="c539b-236">In this tutorial we saw how to add a sort group separator row for a sortable GridView, which more easily identifies the distinct groups and those groups boundaries.</span></span> <span data-ttu-id="c539b-237">如需自訂排序介面的其他範例，請查看[Scott Guthrie](https://weblogs.asp.net/scottgu/) ，其中[有幾個 ASP.NET 2.0 GridView 排序秘訣和訣竅](https://weblogs.asp.net/scottgu/archive/2006/02/11/437995.aspx)blog 專案。</span><span class="sxs-lookup"><span data-stu-id="c539b-237">For additional examples of customized sorting interfaces, check out [Scott Guthrie](https://weblogs.asp.net/scottgu/) s [A Few ASP.NET 2.0 GridView Sorting Tips and Tricks](https://weblogs.asp.net/scottgu/archive/2006/02/11/437995.aspx) blog entry.</span></span>

<span data-ttu-id="c539b-238">快樂的程式設計！</span><span class="sxs-lookup"><span data-stu-id="c539b-238">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="c539b-239">關於作者</span><span class="sxs-lookup"><span data-stu-id="c539b-239">About the Author</span></span>

<span data-ttu-id="c539b-240">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，自1998起，有七個 ASP/ASP. NET 書籍和創辦人的[4GuysFromRolla.com](http://www.4guysfromrolla.com)。</span><span class="sxs-lookup"><span data-stu-id="c539b-240">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="c539b-241">Scott 以獨立的顧問、訓練員和作者的身分運作。</span><span class="sxs-lookup"><span data-stu-id="c539b-241">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="c539b-242">他的最新著作是[*在24小時內讓自己的 ASP.NET 2.0*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="c539b-242">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="c539b-243">他可以在mitchell@4GuysFromRolla.com觸達[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="c539b-243">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="c539b-244">或者透過他的 blog，可以在[http://ScottOnWriting.NET](http://ScottOnWriting.NET)找到。</span><span class="sxs-lookup"><span data-stu-id="c539b-244">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="c539b-245">[上一頁](sorting-custom-paged-data-cs.md)
> [下一頁](paging-and-sorting-report-data-vb.md)</span><span class="sxs-lookup"><span data-stu-id="c539b-245">[Previous](sorting-custom-paged-data-cs.md)
[Next](paging-and-sorting-report-data-vb.md)</span></span>
