---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb
title: 簡介如何插入、更新和刪除資料（VB） |Microsoft Docs
author: rick-anderson
description: 在本教學課程中，我們將瞭解如何將 ObjectDataSource 的 Insert （）、Update （）和 Delete （）方法對應到 BLL 類別的方法，以及如何 devenv.exe.configu 。
ms.author: riande
ms.date: 07/17/2006
ms.assetid: 35b40b8f-2ca8-4ab3-9c19-f361a91a3647
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb
msc.type: authoredcontent
ms.openlocfilehash: 79491118ba1cbbc8c1b67ca9646a817d941f17ba
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/06/2020
ms.locfileid: "78609631"
---
# <a name="an-overview-of-inserting-updating-and-deleting-data-vb"></a><span data-ttu-id="344a2-103">簡介插入、更新和刪除資料（VB）</span><span class="sxs-lookup"><span data-stu-id="344a2-103">An Overview of Inserting, Updating, and Deleting Data (VB)</span></span>

<span data-ttu-id="344a2-104">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="344a2-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="344a2-105">[下載範例應用程式](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_16_VB.exe)或[下載 PDF](an-overview-of-inserting-updating-and-deleting-data-vb/_static/datatutorial16vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="344a2-105">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_16_VB.exe) or [Download PDF](an-overview-of-inserting-updating-and-deleting-data-vb/_static/datatutorial16vb1.pdf)</span></span>

> <span data-ttu-id="344a2-106">在本教學課程中，我們將瞭解如何將 ObjectDataSource 的 Insert （）、Update （）和 Delete （）方法對應到 BLL 類別的方法，以及如何設定 GridView、DetailsView 和 FormView 控制項來提供資料修改功能。</span><span class="sxs-lookup"><span data-stu-id="344a2-106">In this tutorial we'll see how to map an ObjectDataSource's Insert(), Update(), and Delete() methods to the methods of BLL classes, as well as how to configure the GridView, DetailsView, and FormView controls to provide data modification capabilities.</span></span>

## <a name="introduction"></a><span data-ttu-id="344a2-107">簡介</span><span class="sxs-lookup"><span data-stu-id="344a2-107">Introduction</span></span>

<span data-ttu-id="344a2-108">在過去數個教學課程中，我們已檢查如何使用 GridView、DetailsView 和 FormView 控制項，在 ASP.NET 網頁中顯示資料。</span><span class="sxs-lookup"><span data-stu-id="344a2-108">Over the past several tutorials we've examined how to display data in an ASP.NET page using the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="344a2-109">這些控制項只會處理提供給它們的資料。</span><span class="sxs-lookup"><span data-stu-id="344a2-109">These controls simply work with data supplied to them.</span></span> <span data-ttu-id="344a2-110">這些控制項通常會透過使用資料來源控制項（例如 ObjectDataSource）來存取資料。</span><span class="sxs-lookup"><span data-stu-id="344a2-110">Commonly, these controls access data through the use of a data source control, such as the ObjectDataSource.</span></span> <span data-ttu-id="344a2-111">我們已瞭解 ObjectDataSource 如何作為 ASP.NET 網頁與基礎資料之間的 proxy。</span><span class="sxs-lookup"><span data-stu-id="344a2-111">We've seen how the ObjectDataSource acts as a proxy between the ASP.NET page and the underlying data.</span></span> <span data-ttu-id="344a2-112">當 GridView 需要顯示資料時，它會叫用其 ObjectDataSource 的 `Select()` 方法，然後從我們的商務邏輯層（BLL）調用方法，這會呼叫適當資料存取層（DAL） TableAdapter 中的方法，然後將 `SELECT` 查詢傳送至 Northwind 資料庫。</span><span class="sxs-lookup"><span data-stu-id="344a2-112">When a GridView needs to display data, it invokes its ObjectDataSource's `Select()` method, which in turn invokes a method from our Business Logic Layer (BLL), which calls a method in the appropriate Data Access Layer's (DAL) TableAdapter, which in turn sends a `SELECT` query to the Northwind database.</span></span>

<span data-ttu-id="344a2-113">回想一下，當我們在[第一個教學](../introduction/creating-a-data-access-layer-cs.md)課程的 DAL 中建立 tableadapter 時，Visual Studio 自動新增了從基礎資料庫資料表插入、更新和刪除資料的方法。</span><span class="sxs-lookup"><span data-stu-id="344a2-113">Recall that when we created the TableAdapters in the DAL in [our first tutorial](../introduction/creating-a-data-access-layer-cs.md), Visual Studio automatically added methods for inserting, updating, and deleting data from the underlying database table.</span></span> <span data-ttu-id="344a2-114">此外，在[建立商務邏輯層](../introduction/creating-a-business-logic-layer-vb.md)時，我們在 BLL 中設計了方法，以向下呼叫這些資料修改 DAL 方法。</span><span class="sxs-lookup"><span data-stu-id="344a2-114">Moreover, in [Creating a Business Logic Layer](../introduction/creating-a-business-logic-layer-vb.md) we designed methods in the BLL that called down into these data modification DAL methods.</span></span>

<span data-ttu-id="344a2-115">除了其 `Select()` 方法之外，ObjectDataSource 也具有 `Insert()`、`Update()`和 `Delete()` 方法。</span><span class="sxs-lookup"><span data-stu-id="344a2-115">In addition to its `Select()` method, the ObjectDataSource also has `Insert()`, `Update()`, and `Delete()` methods.</span></span> <span data-ttu-id="344a2-116">如同 `Select()` 方法，這三種方法可以對應到基礎物件中的方法。</span><span class="sxs-lookup"><span data-stu-id="344a2-116">Like the `Select()` method, these three methods can be mapped to methods in an underlying object.</span></span> <span data-ttu-id="344a2-117">當設定為插入、更新或刪除資料時，GridView、DetailsView 和 FormView 控制項會提供使用者介面來修改基礎資料。</span><span class="sxs-lookup"><span data-stu-id="344a2-117">When configured to insert, update, or delete data, the GridView, DetailsView, and FormView controls provide a user interface for modifying the underlying data.</span></span> <span data-ttu-id="344a2-118">這個使用者介面會呼叫 ObjectDataSource 的 `Insert()`、`Update()`和 `Delete()` 方法，然後叫用基礎物件的相關聯方法（請參閱 [圖 1]）。</span><span class="sxs-lookup"><span data-stu-id="344a2-118">This user interface calls the `Insert()`, `Update()`, and `Delete()` methods of the ObjectDataSource, which then invoke the underlying object's associated methods (see Figure 1).</span></span>

<span data-ttu-id="344a2-119">[![ObjectDataSource 的 Insert （）、Update （）和 Delete （）方法做為 BLL 中的 Proxy](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image2.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="344a2-119">[![The ObjectDataSource's Insert(), Update(), and Delete() Methods Serve as a Proxy into the BLL](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image2.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image1.png)</span></span>

<span data-ttu-id="344a2-120">**圖 1**： ObjectDataSource 的 `Insert()`、`Update()`和 `Delete()` 方法作為 BLL 的 Proxy （[按一下以觀看完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image3.png)）</span><span class="sxs-lookup"><span data-stu-id="344a2-120">**Figure 1**: The ObjectDataSource's `Insert()`, `Update()`, and `Delete()` Methods Serve as a Proxy into the BLL ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image3.png))</span></span>

<span data-ttu-id="344a2-121">在本教學課程中，我們將瞭解如何將 ObjectDataSource 的 `Insert()`、`Update()`和 `Delete()` 方法對應到 BLL 中類別的方法，以及如何設定 GridView、DetailsView 和 FormView 控制項來提供資料修改功能。</span><span class="sxs-lookup"><span data-stu-id="344a2-121">In this tutorial we'll see how to map the ObjectDataSource's `Insert()`, `Update()`, and `Delete()` methods to methods of classes in the BLL, as well as how to configure the GridView, DetailsView, and FormView controls to provide data modification capabilities.</span></span>

## <a name="step-1-creating-the-insert-update-and-delete-tutorials-web-pages"></a><span data-ttu-id="344a2-122">步驟1：建立 Insert、Update 和 Delete 教學課程的網頁</span><span class="sxs-lookup"><span data-stu-id="344a2-122">Step 1: Creating the Insert, Update, and Delete Tutorials Web Pages</span></span>

<span data-ttu-id="344a2-123">在我們開始探索如何插入、更新和刪除資料之前，讓我們先花點時間在我們的網站專案中建立 ASP.NET 網頁，我們將在本教學課程中使用，以及接下來的幾頁。</span><span class="sxs-lookup"><span data-stu-id="344a2-123">Before we start exploring how to insert, update, and delete data, let's first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next several ones.</span></span> <span data-ttu-id="344a2-124">從新增名為 `EditInsertDelete`的資料夾開始。</span><span class="sxs-lookup"><span data-stu-id="344a2-124">Start by adding a new folder named `EditInsertDelete`.</span></span> <span data-ttu-id="344a2-125">接下來，將下列 ASP.NET 網頁新增至該資料夾，並確定每個頁面都與 `Site.master` 主版頁面相關聯：</span><span class="sxs-lookup"><span data-stu-id="344a2-125">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `Basics.aspx`
- `DataModificationEvents.aspx`
- `ErrorHandling.aspx`
- `UIValidation.aspx`
- `CustomizedUI.aspx`
- `OptimisticConcurrency.aspx`
- `ConfirmationOnDelete.aspx`
- `UserLevelAccess.aspx`

![新增資料修改相關教學課程的 ASP.NET 網頁](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image4.png)

<span data-ttu-id="344a2-127">**圖 2**：加入資料修改相關教學課程的 ASP.NET 網頁</span><span class="sxs-lookup"><span data-stu-id="344a2-127">**Figure 2**: Add the ASP.NET Pages for the Data Modification-Related Tutorials</span></span>

<span data-ttu-id="344a2-128">如同在其他資料夾中，[`EditInsertDelete`] 資料夾中的 `Default.aspx` 會在其區段中列出教學課程。</span><span class="sxs-lookup"><span data-stu-id="344a2-128">Like in the other folders, `Default.aspx` in the `EditInsertDelete` folder will list the tutorials in its section.</span></span> <span data-ttu-id="344a2-129">回想一下，`SectionLevelTutorialListing.ascx` 的使用者控制項會提供這種功能。</span><span class="sxs-lookup"><span data-stu-id="344a2-129">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="344a2-130">因此，請將此使用者控制項從方案總管拖曳至頁面的設計檢視，以將其新增至 `Default.aspx`。</span><span class="sxs-lookup"><span data-stu-id="344a2-130">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page's Design view.</span></span>

<span data-ttu-id="344a2-131">[![將 SectionLevelTutorialListing 的 .ascx 使用者控制項新增至 default.aspx](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image6.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="344a2-131">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image6.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image5.png)</span></span>

<span data-ttu-id="344a2-132">**圖 3**：將 `SectionLevelTutorialListing.ascx` 使用者控制項加入 `Default.aspx` （[按一下以查看完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image7.png)）</span><span class="sxs-lookup"><span data-stu-id="344a2-132">**Figure 3**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image7.png))</span></span>

<span data-ttu-id="344a2-133">最後，將頁面新增為 `Web.sitemap` 檔案的專案。</span><span class="sxs-lookup"><span data-stu-id="344a2-133">Lastly, add the pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="344a2-134">具體而言，請在自訂的格式設定 `<siteMapNode>`之後加入下列標記：</span><span class="sxs-lookup"><span data-stu-id="344a2-134">Specifically, add the following markup after the Customized Formatting `<siteMapNode>`:</span></span>

[!code-xml[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample1.xml)]

<span data-ttu-id="344a2-135">更新 `Web.sitemap`之後，請花一點時間透過瀏覽器來觀看教學課程網站。</span><span class="sxs-lookup"><span data-stu-id="344a2-135">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="344a2-136">左側功能表現在包含用於編輯、插入及刪除教學課程的專案。</span><span class="sxs-lookup"><span data-stu-id="344a2-136">The menu on the left now includes items for the editing, inserting, and deleting tutorials.</span></span>

![網站地圖現在包含編輯、插入及刪除教學課程的專案](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image8.png)

<span data-ttu-id="344a2-138">**圖 4**：網站地圖現在包含用於編輯、插入及刪除教學課程的專案</span><span class="sxs-lookup"><span data-stu-id="344a2-138">**Figure 4**: The Site Map Now Includes Entries for the Editing, Inserting, and Deleting Tutorials</span></span>

## <a name="step-2-adding-and-configuring-the-objectdatasource-control"></a><span data-ttu-id="344a2-139">步驟2：加入和設定 ObjectDataSource 控制項</span><span class="sxs-lookup"><span data-stu-id="344a2-139">Step 2: Adding and Configuring the ObjectDataSource Control</span></span>

<span data-ttu-id="344a2-140">由於 GridView、DetailsView 和 FormView 各有不同的資料修改功能和配置，因此讓我們個別檢查每個。</span><span class="sxs-lookup"><span data-stu-id="344a2-140">Since the GridView, DetailsView, and FormView each differ in their data modification capabilities and layout, let's examine each one individually.</span></span> <span data-ttu-id="344a2-141">不過，不是讓每個控制項使用自己的 ObjectDataSource，而是建立所有三個控制項範例都可以共用的單一 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="344a2-141">Rather than have each control using its own ObjectDataSource, however, let's just create a single ObjectDataSource that all three control examples can share.</span></span>

<span data-ttu-id="344a2-142">開啟 [`Basics.aspx`] 頁面，從 [工具箱] 將 [ObjectDataSource] 拖曳至設計工具，然後按一下其智慧標籤中的 [設定資料來源] 連結。</span><span class="sxs-lookup"><span data-stu-id="344a2-142">Open the `Basics.aspx` page, drag an ObjectDataSource from the Toolbox onto the Designer, and click the Configure Data Source link from its smart tag.</span></span> <span data-ttu-id="344a2-143">由於 `ProductsBLL` 是唯一提供編輯、插入和刪除方法的 BLL 類別，因此請將 ObjectDataSource 設定為使用這個類別。</span><span class="sxs-lookup"><span data-stu-id="344a2-143">Since the `ProductsBLL` is the only BLL class that provides editing, inserting, and deleting methods, configure the ObjectDataSource to use this class.</span></span>

<span data-ttu-id="344a2-144">[![將 ObjectDataSource 設定為使用 ProductsBLL 類別](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image10.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="344a2-144">[![Configure the ObjectDataSource to Use the ProductsBLL Class](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image10.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image9.png)</span></span>

<span data-ttu-id="344a2-145">**圖 5**：設定 ObjectDataSource 使用 `ProductsBLL` 類別（[按一下以查看完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image11.png)）</span><span class="sxs-lookup"><span data-stu-id="344a2-145">**Figure 5**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image11.png))</span></span>

<span data-ttu-id="344a2-146">在下一個畫面中，我們可以選取適當的索引標籤，然後從下拉式清單中選擇方法，以指定 `ProductsBLL` 類別對應至 ObjectDataSource `Select()`、`Insert()`、`Update()`和 `Delete()` 的方法。</span><span class="sxs-lookup"><span data-stu-id="344a2-146">In the next screen we can specify what methods of the `ProductsBLL` class are mapped to the ObjectDataSource's `Select()`, `Insert()`, `Update()`, and `Delete()` by selecting the appropriate tab and choosing the method from the drop-down list.</span></span> <span data-ttu-id="344a2-147">[圖 6] 現在看起來應該很熟悉，將 ObjectDataSource 的 `Select()` 方法對應到 `ProductsBLL` 類別的 `GetProducts()` 方法。</span><span class="sxs-lookup"><span data-stu-id="344a2-147">Figure 6, which should look familiar by now, maps the ObjectDataSource's `Select()` method to the `ProductsBLL` class's `GetProducts()` method.</span></span> <span data-ttu-id="344a2-148">您可以從頂端的清單中選取適當的索引標籤，來設定 `Insert()`、`Update()`和 `Delete()` 方法。</span><span class="sxs-lookup"><span data-stu-id="344a2-148">The `Insert()`, `Update()`, and `Delete()` methods can be configured by selecting the appropriate tab from the list along the top.</span></span>

<span data-ttu-id="344a2-149">[![讓 ObjectDataSource 傳回所有產品](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image13.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="344a2-149">[![Have the ObjectDataSource Return All of the Products](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image13.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image12.png)</span></span>

<span data-ttu-id="344a2-150">**圖 6**：讓 ObjectDataSource 傳回所有產品（[按一下以觀看完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image14.png)）</span><span class="sxs-lookup"><span data-stu-id="344a2-150">**Figure 6**: Have the ObjectDataSource Return All of the Products ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image14.png))</span></span>

<span data-ttu-id="344a2-151">圖7、8和9顯示 ObjectDataSource 的 [更新]、[插入] 和 [刪除] 索引標籤。</span><span class="sxs-lookup"><span data-stu-id="344a2-151">Figures 7, 8, and 9 show the ObjectDataSource's UPDATE, INSERT, and DELETE tabs.</span></span> <span data-ttu-id="344a2-152">設定這些索引標籤，讓 `Insert()`、`Update()`和 `Delete()` 方法分別叫用 `ProductsBLL` 類別的 `UpdateProduct`、`AddProduct`和 `DeleteProduct` 方法。</span><span class="sxs-lookup"><span data-stu-id="344a2-152">Configure these tabs so that the `Insert()`, `Update()`, and `Delete()` methods invoke the `ProductsBLL` class's `UpdateProduct`, `AddProduct`, and `DeleteProduct` methods, respectively.</span></span>

<span data-ttu-id="344a2-153">[![將 ObjectDataSource 的 Update （）方法對應至 ProductBLL 類別的 UpdateProduct 方法](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image16.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="344a2-153">[![Map the ObjectDataSource's Update() Method to the ProductBLL Class's UpdateProduct Method](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image16.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image15.png)</span></span>

<span data-ttu-id="344a2-154">**圖 7**：將 ObjectDataSource 的 `Update()` 方法對應到 `ProductBLL` 類別的 `UpdateProduct` 方法（[按一下以查看完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image17.png)）</span><span class="sxs-lookup"><span data-stu-id="344a2-154">**Figure 7**: Map the ObjectDataSource's `Update()` Method to the `ProductBLL` Class's `UpdateProduct` Method ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image17.png))</span></span>

<span data-ttu-id="344a2-155">[![將 ObjectDataSource 的 Insert （）方法對應至 ProductBLL 類別的 AddProduct 方法](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image19.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="344a2-155">[![Map the ObjectDataSource's Insert() Method to the ProductBLL Class's AddProduct Method](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image19.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image18.png)</span></span>

<span data-ttu-id="344a2-156">**圖 8**：將 ObjectDataSource 的 `Insert()` 方法對應到 `ProductBLL` 類別的新增 `Product` 方法（[按一下以查看完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image20.png)）</span><span class="sxs-lookup"><span data-stu-id="344a2-156">**Figure 8**: Map the ObjectDataSource's `Insert()` Method to the `ProductBLL` Class's Add `Product` Method ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image20.png))</span></span>

<span data-ttu-id="344a2-157">[![將 ObjectDataSource 的 Delete （）方法對應至 ProductBLL 類別的 DeleteProduct 方法](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image22.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="344a2-157">[![Map the ObjectDataSource's Delete() Method to the ProductBLL Class's DeleteProduct Method](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image22.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image21.png)</span></span>

<span data-ttu-id="344a2-158">**圖 9**：將 ObjectDataSource 的 `Delete()` 方法對應到 `ProductBLL` 類別的 `DeleteProduct` 方法（[按一下以查看完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image23.png)）</span><span class="sxs-lookup"><span data-stu-id="344a2-158">**Figure 9**: Map the ObjectDataSource's `Delete()` Method to the `ProductBLL` Class's `DeleteProduct` Method ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image23.png))</span></span>

<span data-ttu-id="344a2-159">您可能已經注意到，[更新]、[插入] 和 [刪除] 索引標籤中的下拉式清單已選取這些方法。</span><span class="sxs-lookup"><span data-stu-id="344a2-159">You may have noticed that the drop-down lists in the UPDATE, INSERT, and DELETE tabs already had these methods selected.</span></span> <span data-ttu-id="344a2-160">這是因為我們使用 `DataObjectMethodAttribute` 來裝飾 `ProductsBLL`的方法。</span><span class="sxs-lookup"><span data-stu-id="344a2-160">This is thanks to our use of the `DataObjectMethodAttribute` that decorates the methods of `ProductsBLL`.</span></span> <span data-ttu-id="344a2-161">例如，DeleteProduct 方法具有下列簽章：</span><span class="sxs-lookup"><span data-stu-id="344a2-161">For example, the DeleteProduct method has the following signature:</span></span>

[!code-vb[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample2.vb)]

<span data-ttu-id="344a2-162">`DataObjectMethodAttribute` 屬性指出每個方法的用途，不論它是用於選取、插入、更新或刪除，以及它是否為預設值。</span><span class="sxs-lookup"><span data-stu-id="344a2-162">The `DataObjectMethodAttribute` attribute indicates the purpose of each method whether it is for selecting, inserting, updating, or deleting and whether or not it's the default value.</span></span> <span data-ttu-id="344a2-163">如果您在建立 BLL 類別時省略這些屬性，則必須從 [更新]、[插入] 和 [刪除] 索引標籤手動選取方法。</span><span class="sxs-lookup"><span data-stu-id="344a2-163">If you omitted these attributes when creating your BLL classes, you'll need to manually select the methods from the UPDATE, INSERT, and DELETE tabs.</span></span>

<span data-ttu-id="344a2-164">確定適當的 `ProductsBLL` 方法對應到 ObjectDataSource 的 `Insert()`、`Update()`和 `Delete()` 方法之後，請按一下 [完成] 以完成嚮導。</span><span class="sxs-lookup"><span data-stu-id="344a2-164">After ensuring that the appropriate `ProductsBLL` methods are mapped to the ObjectDataSource's `Insert()`, `Update()`, and `Delete()` methods, click Finish to complete the wizard.</span></span>

## <a name="examining-the-objectdatasources-markup"></a><span data-ttu-id="344a2-165">檢查 ObjectDataSource 的標記</span><span class="sxs-lookup"><span data-stu-id="344a2-165">Examining the ObjectDataSource's Markup</span></span>

<span data-ttu-id="344a2-166">透過其 wizard 設定 ObjectDataSource 之後，請前往來源視圖來檢查產生的宣告式標記。</span><span class="sxs-lookup"><span data-stu-id="344a2-166">After configuring the ObjectDataSource through its wizard, go to the Source view to examine the generated declarative markup.</span></span> <span data-ttu-id="344a2-167">`<asp:ObjectDataSource>` 標記會指定基礎物件和要叫用的方法。</span><span class="sxs-lookup"><span data-stu-id="344a2-167">The `<asp:ObjectDataSource>` tag specifies the underlying object and the methods to invoke.</span></span> <span data-ttu-id="344a2-168">此外，還有 `DeleteParameters`、`UpdateParameters`和 `InsertParameters` 對應至 `ProductsBLL` 類別的 `AddProduct`、`UpdateProduct`和 `DeleteProduct` 方法的輸入參數：</span><span class="sxs-lookup"><span data-stu-id="344a2-168">Additionally, there are `DeleteParameters`, `UpdateParameters`, and `InsertParameters` that map to the input parameters for the `ProductsBLL` class's `AddProduct`, `UpdateProduct`, and `DeleteProduct` methods:</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample3.aspx)]

<span data-ttu-id="344a2-169">ObjectDataSource 會針對其相關聯的方法包含每個輸入參數的參數，就像當 ObjectDataSource 設定為呼叫預期輸入參數（例如 `GetProductsByCategoryID(categoryID)`）的 select 方法時，會出現 `SelectParameter` s 的清單。</span><span class="sxs-lookup"><span data-stu-id="344a2-169">The ObjectDataSource includes a parameter for each of the input parameters for its associated methods, just like a list of `SelectParameter` s is present when the ObjectDataSource is configured to call a select method that expects an input parameter (such as `GetProductsByCategoryID(categoryID)`).</span></span> <span data-ttu-id="344a2-170">如我們稍後所見，GridView、DetailsView 和 FormView 會在叫用 ObjectDataSource 的 `Insert()`、`Update()`或 `Delete()` 方法之前，自動設定這些 `DeleteParameters`、`UpdateParameters`和 `InsertParameters` 的值。</span><span class="sxs-lookup"><span data-stu-id="344a2-170">As we'll see shortly, values for these `DeleteParameters`, `UpdateParameters`, and `InsertParameters` are set automatically by the GridView, DetailsView, and FormView prior to invoking the ObjectDataSource's `Insert()`, `Update()`, or `Delete()` method.</span></span> <span data-ttu-id="344a2-171">您也可以視需要以程式設計方式設定這些值，我們將在未來的教學課程中討論。</span><span class="sxs-lookup"><span data-stu-id="344a2-171">These values can also be set programmatically as needed, as we'll discuss in a future tutorial.</span></span>

<span data-ttu-id="344a2-172">使用 wizard 設定 ObjectDataSource 的一個副作用是，Visual Studio 將[OldValuesParameterFormatString 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.oldvaluesparameterformatstring(VS.80).aspx)設定為 `original_{0}`。</span><span class="sxs-lookup"><span data-stu-id="344a2-172">One side effect of using the wizard to configure to ObjectDataSource is that Visual Studio sets the [OldValuesParameterFormatString property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.oldvaluesparameterformatstring(VS.80).aspx) to `original_{0}`.</span></span> <span data-ttu-id="344a2-173">這個屬性值是用來包含正在編輯之資料的原始值，在兩種情況下很有用：</span><span class="sxs-lookup"><span data-stu-id="344a2-173">This property value is used to include the original values of the data being edited and is useful in two scenarios:</span></span>

- <span data-ttu-id="344a2-174">如果在編輯記錄時，使用者可以變更主要金鑰值。</span><span class="sxs-lookup"><span data-stu-id="344a2-174">If, when editing a record, users are able to change the primary key value.</span></span> <span data-ttu-id="344a2-175">在此情況下，必須提供新的主鍵值和原始的主要金鑰值，才能找到具有原始主要金鑰值的記錄，並據此更新其值。</span><span class="sxs-lookup"><span data-stu-id="344a2-175">In this case, both the new primary key value and the original primary key value must be provided so that the record with the original primary key value can be found and have its value updated accordingly.</span></span>
- <span data-ttu-id="344a2-176">使用開放式平行存取時。</span><span class="sxs-lookup"><span data-stu-id="344a2-176">When using optimistic concurrency.</span></span> <span data-ttu-id="344a2-177">開放式平行存取是一項技術，可確保兩個同時進行的使用者不會覆寫另一個變更，而是後續教學課程的主題。</span><span class="sxs-lookup"><span data-stu-id="344a2-177">Optimistic concurrency is a technique to ensure that two simultaneous users don't overwrite one another's changes, and is the topic for a future tutorial.</span></span>

<span data-ttu-id="344a2-178">`OldValuesParameterFormatString` 屬性會指出原始值的基礎物件之 update 和 delete 方法中的輸入參數名稱。</span><span class="sxs-lookup"><span data-stu-id="344a2-178">The `OldValuesParameterFormatString` property indicates the name of the input parameters in the underlying object's update and delete methods for the original values.</span></span> <span data-ttu-id="344a2-179">當我們探索開放式平行存取時，我們會更詳細地討論此屬性及其用途。</span><span class="sxs-lookup"><span data-stu-id="344a2-179">We'll discuss this property and its purpose in greater detail when we explore optimistic concurrency.</span></span> <span data-ttu-id="344a2-180">不過，我現在會將它帶入，因為我們的 BLL 方法不會預期原始值，因此請務必移除此屬性。</span><span class="sxs-lookup"><span data-stu-id="344a2-180">I bring it up now, however, because our BLL's methods do not expect the original values and therefore it's important that we remove this property.</span></span> <span data-ttu-id="344a2-181">將 `OldValuesParameterFormatString` 屬性設定為預設值以外的任何專案（`{0}`），會在資料 Web 控制項嘗試叫用 ObjectDataSource 的 `Update()` 或 `Delete()` 方法時造成錯誤，因為 ObjectDataSource 會嘗試同時傳入 `UpdateParameters` 或指定的 `DeleteParameters`，以及原始值參數。</span><span class="sxs-lookup"><span data-stu-id="344a2-181">Leaving the `OldValuesParameterFormatString` property set to anything other than the default (`{0}`) will cause an error when a data Web control attempts to invoke the ObjectDataSource's `Update()` or `Delete()` methods because the ObjectDataSource will attempt to pass in both the `UpdateParameters` or `DeleteParameters` specified as well as original value parameters.</span></span>

<span data-ttu-id="344a2-182">如果這不太清楚，別擔心，我們將在未來的教學課程中檢查這個屬性及其公用程式。</span><span class="sxs-lookup"><span data-stu-id="344a2-182">If this isn't terribly clear at this juncture, don't worry, we'll examine this property and its utility in a future tutorial.</span></span> <span data-ttu-id="344a2-183">目前，您只需從宣告式語法中移除此屬性宣告，或將值設為預設值（{0}）。</span><span class="sxs-lookup"><span data-stu-id="344a2-183">For now, just be certain to either remove this property declaration entirely from the declarative syntax or set the value to the default value ({0}).</span></span>

> [!NOTE]
> <span data-ttu-id="344a2-184">如果您只是從設計檢視中的屬性視窗清除 `OldValuesParameterFormatString` 屬性值，屬性仍然會存在於宣告式語法中，但會設為空字串。</span><span class="sxs-lookup"><span data-stu-id="344a2-184">If you simply clear out the `OldValuesParameterFormatString` property value from the Properties window in the Design view, the property will still exist in the declarative syntax, but be set to an empty string.</span></span> <span data-ttu-id="344a2-185">不幸的是，仍然會產生上述的相同問題。</span><span class="sxs-lookup"><span data-stu-id="344a2-185">This, unfortunately, will still result in the same problem discussed above.</span></span> <span data-ttu-id="344a2-186">因此，請從宣告式語法中移除該屬性，或從屬性視窗將值設定為預設的 `{0}`。</span><span class="sxs-lookup"><span data-stu-id="344a2-186">Therefore, either remove the property altogether from the declarative syntax or, from the Properties window, set the value to the default, `{0}`.</span></span>

## <a name="step-3-adding-a-data-web-control-and-configuring-it-for-data-modification"></a><span data-ttu-id="344a2-187">步驟3：加入資料 Web 控制項並設定它以進行資料修改</span><span class="sxs-lookup"><span data-stu-id="344a2-187">Step 3: Adding a Data Web Control and Configuring It for Data Modification</span></span>

<span data-ttu-id="344a2-188">一旦將 ObjectDataSource 新增至頁面並設定之後，我們就可以將資料 Web 控制項新增至頁面，以顯示資料並提供方法讓使用者進行修改。</span><span class="sxs-lookup"><span data-stu-id="344a2-188">Once the ObjectDataSource has been added to the page and configured, we're ready to add data Web controls to the page to both display the data and provide a means for the end user to modify it.</span></span> <span data-ttu-id="344a2-189">我們會分別探討 GridView、DetailsView 和 FormView，因為這些資料 Web 控制項的資料修改功能和設定各有不同。</span><span class="sxs-lookup"><span data-stu-id="344a2-189">We'll look at the GridView, DetailsView, and FormView separately, as these data Web controls differ in their data modification capabilities and configuration.</span></span>

<span data-ttu-id="344a2-190">我們將在本文的其餘部分看到，透過 GridView、DetailsView 和 FormView 控制項來新增非常基本的編輯、插入及刪除支援，其實就像檢查幾個核取方塊一樣簡單。</span><span class="sxs-lookup"><span data-stu-id="344a2-190">As we'll see in the remainder of this article, adding very basic editing, inserting, and deleting support through the GridView, DetailsView, and FormView controls is really as simple as checking a couple of checkboxes.</span></span> <span data-ttu-id="344a2-191">在現實世界中，有許多微妙差異和 edge 案例可提供比單純點和按一下更多的功能。</span><span class="sxs-lookup"><span data-stu-id="344a2-191">There are many subtleties and edge cases in the real-world that make providing such functionality more involved than just point and click.</span></span> <span data-ttu-id="344a2-192">不過，本教學課程只著重于證明簡單的資料修改功能。</span><span class="sxs-lookup"><span data-stu-id="344a2-192">This tutorial, however, focuses solely on proving simplistic data modification capabilities.</span></span> <span data-ttu-id="344a2-193">未來的教學課程會檢查在實際設定中一定會發生的顧慮。</span><span class="sxs-lookup"><span data-stu-id="344a2-193">Future tutorials will examine concerns that will undoubtedly arise in a real-world setting.</span></span>

## <a name="deleting-data-from-the-gridview"></a><span data-ttu-id="344a2-194">刪除 GridView 中的資料</span><span class="sxs-lookup"><span data-stu-id="344a2-194">Deleting Data from the GridView</span></span>

<span data-ttu-id="344a2-195">首先，從 [工具箱] 將 GridView 拖曳至設計工具。</span><span class="sxs-lookup"><span data-stu-id="344a2-195">Start by dragging a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="344a2-196">接下來，從 GridView 智慧標籤的下拉式清單中選取 ObjectDataSource，將其系結至 GridView。</span><span class="sxs-lookup"><span data-stu-id="344a2-196">Next, bind the ObjectDataSource to the GridView by selecting it from the drop-down list in the GridView's smart tag.</span></span> <span data-ttu-id="344a2-197">此時，GridView 的宣告式標記會是：</span><span class="sxs-lookup"><span data-stu-id="344a2-197">At this point the GridView's declarative markup will be:</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample4.aspx)]

<span data-ttu-id="344a2-198">透過其智慧標籤將 GridView 系結至 ObjectDataSource 有兩個優點：</span><span class="sxs-lookup"><span data-stu-id="344a2-198">Binding the GridView to the ObjectDataSource through its smart tag has two benefits:</span></span>

- <span data-ttu-id="344a2-199">系統會針對 ObjectDataSource 所傳回的每個欄位，自動建立 BoundFields 和 CheckBoxFields。</span><span class="sxs-lookup"><span data-stu-id="344a2-199">BoundFields and CheckBoxFields are automatically created for each of the fields returned by the ObjectDataSource.</span></span> <span data-ttu-id="344a2-200">此外，BoundField 和 CheckBoxField 的屬性會根據基礎欄位的中繼資料來設定。</span><span class="sxs-lookup"><span data-stu-id="344a2-200">Moreover, the BoundField and CheckBoxField's properties are set based on the underlying field's metadata.</span></span> <span data-ttu-id="344a2-201">例如，[`ProductID`]、[`CategoryName`] 和 [`SupplierName`] 欄位在 `ProductsDataTable` 中會標示為唯讀，因此在編輯時，不應該是可更新的。</span><span class="sxs-lookup"><span data-stu-id="344a2-201">For example, the `ProductID`, `CategoryName`, and `SupplierName` fields are marked as read-only in the `ProductsDataTable` and therefore shouldn't be updatable when editing.</span></span> <span data-ttu-id="344a2-202">為了配合此，這些 BoundFields 的[ReadOnly 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.readonly(VS.80).aspx)會設定為 `True`。</span><span class="sxs-lookup"><span data-stu-id="344a2-202">To accommodate this, these BoundFields' [ReadOnly properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.readonly(VS.80).aspx) are set to `True`.</span></span>
- <span data-ttu-id="344a2-203">[DataKeyNames 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.datakeynames(VS.80).aspx)會指派給基礎物件的主要索引鍵欄位。</span><span class="sxs-lookup"><span data-stu-id="344a2-203">The [DataKeyNames property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.datakeynames(VS.80).aspx) is assigned to the primary key field(s) of the underlying object.</span></span> <span data-ttu-id="344a2-204">使用 GridView 編輯或刪除資料時，這是必要的，因為此屬性會指出唯一識別每筆記錄的欄位（或欄位集合）。</span><span class="sxs-lookup"><span data-stu-id="344a2-204">This is essential when using the GridView for editing or deleting data, as this property indicates the field (or set of fields) that unique identifies each record.</span></span> <span data-ttu-id="344a2-205">如需 `DataKeyNames` 屬性的詳細資訊，請參閱使用可[選取的主要 GridView 和詳細資訊 detailview 之教學課程中的主要/詳細資料](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md)。</span><span class="sxs-lookup"><span data-stu-id="344a2-205">For more information on the `DataKeyNames` property, refer back to the [Master/Detail Using a Selectable Master GridView with a Details DetailView](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md) tutorial.</span></span>

<span data-ttu-id="344a2-206">雖然 GridView 可以透過屬性視窗或宣告式語法系結至 ObjectDataSource，但這麼做會要求您手動新增適當的 BoundField 和 `DataKeyNames` 標記。</span><span class="sxs-lookup"><span data-stu-id="344a2-206">While the GridView can be bound to the ObjectDataSource through the Properties window or declarative syntax, doing so requires you to manually add the appropriate BoundField and `DataKeyNames` markup.</span></span>

<span data-ttu-id="344a2-207">GridView 控制項提供資料列層級編輯和刪除的內建支援。</span><span class="sxs-lookup"><span data-stu-id="344a2-207">The GridView control provides built-in support for row-level editing and deleting.</span></span> <span data-ttu-id="344a2-208">設定 GridView 以支援刪除會新增 [刪除] 按鈕的資料行。</span><span class="sxs-lookup"><span data-stu-id="344a2-208">Configuring a GridView to support deleting adds a column of Delete buttons.</span></span> <span data-ttu-id="344a2-209">當終端使用者按一下特定資料列的 [刪除] 按鈕時，回傳接踵而來和 GridView 會執行下列步驟：</span><span class="sxs-lookup"><span data-stu-id="344a2-209">When the end user clicks the Delete button for a particular row, a postback ensues and the GridView performs the following steps:</span></span>

1. <span data-ttu-id="344a2-210">已指派 ObjectDataSource 的 `DeleteParameters` 值</span><span class="sxs-lookup"><span data-stu-id="344a2-210">The ObjectDataSource's `DeleteParameters` value(s) are assigned</span></span>
2. <span data-ttu-id="344a2-211">已叫用 ObjectDataSource 的 `Delete()` 方法，正在刪除指定的記錄</span><span class="sxs-lookup"><span data-stu-id="344a2-211">The ObjectDataSource's `Delete()` method is invoked, deleting the specified record</span></span>
3. <span data-ttu-id="344a2-212">GridView 藉由叫用其 `Select()` 方法，將其本身重新系結至 ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="344a2-212">The GridView rebinds itself to the ObjectDataSource by invoking its `Select()` method</span></span>

<span data-ttu-id="344a2-213">指派給 `DeleteParameters` 的值是已按一下 [刪除] 按鈕之資料列的 `DataKeyNames` 欄位值。</span><span class="sxs-lookup"><span data-stu-id="344a2-213">The values assigned to the `DeleteParameters` are the values of the `DataKeyNames` field(s) for the row whose Delete button was clicked.</span></span> <span data-ttu-id="344a2-214">因此，要正確設定 GridView 的 `DataKeyNames` 屬性是很重要的。</span><span class="sxs-lookup"><span data-stu-id="344a2-214">Therefore it's vital that a GridView's `DataKeyNames` property be correctly set.</span></span> <span data-ttu-id="344a2-215">如果遺失，`DeleteParameters` 將在步驟1中指派 `Nothing` 的值，而這不會導致步驟2中任何已刪除的記錄。</span><span class="sxs-lookup"><span data-stu-id="344a2-215">If it's missing, the `DeleteParameters` will be assigned a value of `Nothing` in Step 1, which in turn will not result in any deleted records in Step 2.</span></span>

> [!NOTE]
> <span data-ttu-id="344a2-216">`DataKeys` 集合會儲存在 GridView 的控制項狀態中，這表示即使已停用 GridView s view 狀態，仍會在回傳期間記住 `DataKeys` 值。</span><span class="sxs-lookup"><span data-stu-id="344a2-216">The `DataKeys` collection is stored in the GridView s control state, meaning that the `DataKeys` values will be remembered across postback even if the GridView s view state has been disabled.</span></span> <span data-ttu-id="344a2-217">不過，對於支援編輯或刪除的 Gridview （預設行為），檢視狀態會保持為 [已啟用] 非常重要。</span><span class="sxs-lookup"><span data-stu-id="344a2-217">However, it is very important that view state remains enabled for GridViews that support editing or deleting (the default behavior).</span></span> <span data-ttu-id="344a2-218">如果您將 GridView 的 `EnableViewState` 屬性設定為 `false`，則單一使用者的編輯和刪除行為將會正常運作，但如果有並行使用者刪除資料，則這些並行使用者可能會不小心刪除或編輯他們不想要的記錄。</span><span class="sxs-lookup"><span data-stu-id="344a2-218">If you set the GridView s `EnableViewState` property to `false`, the editing and deleting behavior will work fine for a single user, but if there are concurrent users deleting data, there exists the possibility that these concurrent users may accidentally delete or edit records that they didn't intend.</span></span> <span data-ttu-id="344a2-219">如需詳細資訊，請參閱我的 blog 專案，[警告： ASP.NET 2.0 gridview/DetailsView/FormViews 的並行處理問題，支援編輯及/或刪除，以及停用檢視狀態](http://scottonwriting.net/sowblog/posts/10054.aspx)的。</span><span class="sxs-lookup"><span data-stu-id="344a2-219">See my blog entry, [WARNING: Concurrency Issue with ASP.NET 2.0 GridViews/DetailsView/FormViews that Support Editing and/or Deleting and Whose View State is Disabled](http://scottonwriting.net/sowblog/posts/10054.aspx), for more information.</span></span>

<span data-ttu-id="344a2-220">這個相同的警告也適用于 DetailsViews 和 FormViews。</span><span class="sxs-lookup"><span data-stu-id="344a2-220">This same warning also applies to DetailsViews and FormViews.</span></span>

<span data-ttu-id="344a2-221">若要新增 GridView 的刪除功能，只要移至其智慧標籤，然後勾選 [啟用刪除] 核取方塊即可。</span><span class="sxs-lookup"><span data-stu-id="344a2-221">To add deleting capabilities to a GridView, simply go to its smart tag and check the Enable Deleting checkbox.</span></span>

![勾選 [啟用刪除] 核取方塊](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image24.png)

<span data-ttu-id="344a2-223">**圖 10**：勾選 [啟用刪除] 核取方塊</span><span class="sxs-lookup"><span data-stu-id="344a2-223">**Figure 10**: Check the Enable Deleting Checkbox</span></span>

<span data-ttu-id="344a2-224">核取 [從智慧標籤啟用刪除] 核取方塊，會將 CommandField 新增至 GridView。</span><span class="sxs-lookup"><span data-stu-id="344a2-224">Checking the Enable Deleting checkbox from the smart tag adds a CommandField to the GridView.</span></span> <span data-ttu-id="344a2-225">CommandField 會使用可執行下列一或多項工作的按鈕，呈現 GridView 中的資料行：選取記錄、編輯記錄，以及刪除記錄。</span><span class="sxs-lookup"><span data-stu-id="344a2-225">The CommandField renders a column in the GridView with buttons for performing one or more of the following tasks: selecting a record, editing a record, and deleting a record.</span></span> <span data-ttu-id="344a2-226">我們先前已看到 CommandField 的運作方式，是使用可[選取的主要 GridView 和詳細資料 detailview 之教學課程來選取主要/詳細資料](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md)中的記錄。</span><span class="sxs-lookup"><span data-stu-id="344a2-226">We previously saw the CommandField in action with selecting records in the [Master/Detail Using a Selectable Master GridView with a Details DetailView](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md) tutorial.</span></span>

<span data-ttu-id="344a2-227">CommandField 包含數個 `ShowXButton` 屬性，指出要在 CommandField 中顯示哪一系列的按鈕。</span><span class="sxs-lookup"><span data-stu-id="344a2-227">The CommandField contains a number of `ShowXButton` properties that indicate what series of buttons are displayed in the CommandField.</span></span> <span data-ttu-id="344a2-228">藉由勾選 [啟用刪除] 核取方塊，其 `ShowDeleteButton` 屬性為 `True` 的 CommandField 已加入 GridView 的資料行集合中。</span><span class="sxs-lookup"><span data-stu-id="344a2-228">By checking the Enable Deleting checkbox a CommandField whose `ShowDeleteButton` property is `True` has been added to the GridView's Columns collection.</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample5.aspx)]

<span data-ttu-id="344a2-229">此時，相信它不信了，我們已完成將刪除支援新增至 GridView 的作業！</span><span class="sxs-lookup"><span data-stu-id="344a2-229">At this point, believe it or not, we're done with adding deleting support to the GridView!</span></span> <span data-ttu-id="344a2-230">如 [圖 11] 所示，當您透過瀏覽器造訪此頁面時，會出現 [刪除] 按鈕的資料行。</span><span class="sxs-lookup"><span data-stu-id="344a2-230">As Figure 11 shows, when visiting this page through a browser a column of Delete buttons is present.</span></span>

<span data-ttu-id="344a2-231">[![CommandField 新增 [刪除] 按鈕的資料行](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image26.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="344a2-231">[![The CommandField Adds a Column of Delete Buttons](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image26.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image25.png)</span></span>

<span data-ttu-id="344a2-232">**圖 11**： CommandField 新增 [刪除] 按鈕的資料行（[按一下以查看完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image27.png)）</span><span class="sxs-lookup"><span data-stu-id="344a2-232">**Figure 11**: The CommandField Adds a Column of Delete Buttons ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image27.png))</span></span>

<span data-ttu-id="344a2-233">如果您是從頭開始建立本教學課程，則在測試此頁面時，按一下 [刪除] 按鈕將會引發例外狀況。</span><span class="sxs-lookup"><span data-stu-id="344a2-233">If you've been building this tutorial from the ground up on your own, when testing this page clicking the Delete button will raise an exception.</span></span> <span data-ttu-id="344a2-234">繼續閱讀以瞭解為什麼會引發這些例外狀況，以及如何加以修正。</span><span class="sxs-lookup"><span data-stu-id="344a2-234">Continue reading to learn as to why these exceptions were raised and how to fix them.</span></span>

> [!NOTE]
> <span data-ttu-id="344a2-235">如果您遵循本教學課程隨附的下載內容，這些問題已列入考慮。</span><span class="sxs-lookup"><span data-stu-id="344a2-235">If you're following along using the download accompanying this tutorial, these problems have already been accounted for.</span></span> <span data-ttu-id="344a2-236">不過，我建議您仔細閱讀下面所列的詳細資料，以協助找出可能發生的問題，以及適當的因應措施。</span><span class="sxs-lookup"><span data-stu-id="344a2-236">However, I encourage you to read through the details listed below to help identify problems that may arise and suitable workarounds.</span></span>

<span data-ttu-id="344a2-237">如果嘗試刪除產品時，您會收到例外狀況，其訊息類似于 "*ObjectDataSource ' ObjectDataSource1 ' 找不到具有下列參數的非泛型方法 ' DeleteProduct '： productid，原始\_productID*"，您可能忘了從 ObjectDataSource 移除 `OldValuesParameterFormatString` 屬性。</span><span class="sxs-lookup"><span data-stu-id="344a2-237">If, when attempting to delete a product, you get an exception whose message is similar to "*ObjectDataSource 'ObjectDataSource1' could not find a non-generic method 'DeleteProduct' that has parameters: productID, original\_ProductID*," you likely forgot to remove the `OldValuesParameterFormatString` property from the ObjectDataSource.</span></span> <span data-ttu-id="344a2-238">在指定了 `OldValuesParameterFormatString` 屬性的情況下，ObjectDataSource 會嘗試將 `productID` 和 `original_ProductID` 輸入參數傳入 `DeleteProduct` 方法。</span><span class="sxs-lookup"><span data-stu-id="344a2-238">With the `OldValuesParameterFormatString` property specified, the ObjectDataSource attempts to pass in both `productID` and `original_ProductID` input parameters to the `DeleteProduct` method.</span></span> <span data-ttu-id="344a2-239">不過，`DeleteProduct`只接受單一輸入參數，因此會發生例外狀況。</span><span class="sxs-lookup"><span data-stu-id="344a2-239">`DeleteProduct`, however, only accepts a single input parameter, hence the exception.</span></span> <span data-ttu-id="344a2-240">移除 `OldValuesParameterFormatString` 屬性（或將它設定為 `{0}`），會指示 ObjectDataSource 不要嘗試傳入原始輸入參數。</span><span class="sxs-lookup"><span data-stu-id="344a2-240">Removing the `OldValuesParameterFormatString` property (or setting it to `{0}`) instructs the ObjectDataSource to not attempt to pass in the original input parameter.</span></span>

<span data-ttu-id="344a2-241">[![確定已清除 OldValuesParameterFormatString 屬性](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image29.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="344a2-241">[![Ensure That the OldValuesParameterFormatString Property Has Been Cleared Out](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image29.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image28.png)</span></span>

<span data-ttu-id="344a2-242">**圖 12**：確定已清除 `OldValuesParameterFormatString` 屬性（[按一下以觀看完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image30.png)）</span><span class="sxs-lookup"><span data-stu-id="344a2-242">**Figure 12**: Ensure That the `OldValuesParameterFormatString` Property Has Been Cleared Out ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image30.png))</span></span>

<span data-ttu-id="344a2-243">即使您已移除 `OldValuesParameterFormatString` 屬性，當您嘗試刪除包含下列訊息的產品時，仍會收到例外狀況：「*delete 語句與參考條件約束衝突」 FK\_順序\_詳細資料\_產品 '* 」。Northwind 資料庫包含 `Order Details` 和 `Products` 資料表之間的外鍵條件約束，這表示如果 `Order Details` 資料表中有一或多筆記錄，就無法從系統中刪除該產品。</span><span class="sxs-lookup"><span data-stu-id="344a2-243">Even if you had removed the `OldValuesParameterFormatString` property, you still will get an exception when trying to delete a product with the message: "*The DELETE statement conflicted with the REFERENCE constraint 'FK\_Order\_Details\_Products'*." The Northwind database contains a foreign key constraint between the `Order Details` and `Products` table, meaning that a product cannot be deleted from the system if there are one or more records for it in the `Order Details` table.</span></span> <span data-ttu-id="344a2-244">由於 Northwind 資料庫中的每個產品在 `Order Details`中至少有一筆記錄，因此在我們第一次刪除產品的相關訂單詳細資料記錄之前，無法刪除任何產品。</span><span class="sxs-lookup"><span data-stu-id="344a2-244">Since every product in the Northwind database has at least one record in `Order Details`, we cannot delete any products until we first delete the product's associated order details records.</span></span>

<span data-ttu-id="344a2-245">[![外鍵條件約束禁止刪除產品](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image32.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="344a2-245">[![A Foreign Key Constraint Prohibits the Deletion of Products](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image32.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image31.png)</span></span>

<span data-ttu-id="344a2-246">**圖 13**：外鍵條件約束禁止刪除產品（[按一下以觀看完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image33.png)）</span><span class="sxs-lookup"><span data-stu-id="344a2-246">**Figure 13**: A Foreign Key Constraint Prohibits the Deletion of Products ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image33.png))</span></span>

<span data-ttu-id="344a2-247">在本教學課程中，我們將直接刪除 `Order Details` 資料表中的所有記錄。</span><span class="sxs-lookup"><span data-stu-id="344a2-247">For our tutorial, let's just delete all of the records from the `Order Details` table.</span></span> <span data-ttu-id="344a2-248">在真實世界的應用程式中，我們需要執行下列其中一項：</span><span class="sxs-lookup"><span data-stu-id="344a2-248">In a real-world application we'd need to either:</span></span>

- <span data-ttu-id="344a2-249">擁有另一個畫面來管理訂單詳細資訊</span><span class="sxs-lookup"><span data-stu-id="344a2-249">Have another screen to manage order details information</span></span>
- <span data-ttu-id="344a2-250">擴大 `DeleteProduct` 方法，以包含刪除指定產品訂單詳細資料的邏輯</span><span class="sxs-lookup"><span data-stu-id="344a2-250">Augment the `DeleteProduct` method to include logic to delete the specified product's order details</span></span>
- <span data-ttu-id="344a2-251">修改 TableAdapter 所使用的 SQL 查詢，以包含刪除指定產品的訂單詳細資料</span><span class="sxs-lookup"><span data-stu-id="344a2-251">Modify the SQL query used by the TableAdapter to include deletion of the specified product's order details</span></span>

<span data-ttu-id="344a2-252">讓我們直接刪除 `Order Details` 資料表中的所有記錄，以規避外鍵條件約束。</span><span class="sxs-lookup"><span data-stu-id="344a2-252">Let's just delete all of the records from the `Order Details` table to circumvent the foreign key constraint.</span></span> <span data-ttu-id="344a2-253">移至 Visual Studio 中的伺服器總管，以滑鼠右鍵按一下 [`NORTHWND.MDF`] 節點，然後選擇 [新增查詢]。</span><span class="sxs-lookup"><span data-stu-id="344a2-253">Go to the Server Explorer in Visual Studio, right-click on the `NORTHWND.MDF` node, and choose New Query.</span></span> <span data-ttu-id="344a2-254">然後，在查詢視窗中，執行下列 SQL 語句： `DELETE FROM [Order Details]`</span><span class="sxs-lookup"><span data-stu-id="344a2-254">Then, in the query window, run the following SQL statement: `DELETE FROM [Order Details]`</span></span>

<span data-ttu-id="344a2-255">[![刪除 Order Details 資料表中的所有記錄](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image35.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="344a2-255">[![Delete All Records from the Order Details Table](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image35.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image34.png)</span></span>

<span data-ttu-id="344a2-256">**圖 14**：刪除 `Order Details` 資料表中的所有記錄（[按一下以查看完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image36.png)）</span><span class="sxs-lookup"><span data-stu-id="344a2-256">**Figure 14**: Delete All Records from the `Order Details` Table ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image36.png))</span></span>

<span data-ttu-id="344a2-257">清除 `Order Details` 資料表後，按一下 [刪除] 按鈕將會刪除產品，而不會發生錯誤。</span><span class="sxs-lookup"><span data-stu-id="344a2-257">After clearing out the `Order Details` table clicking on the Delete button will delete the product without error.</span></span> <span data-ttu-id="344a2-258">如果按一下 [刪除] 按鈕不會刪除產品，請檢查並確定 GridView 的 `DataKeyNames` 屬性已設為 [主要金鑰] 欄位（`ProductID`）。</span><span class="sxs-lookup"><span data-stu-id="344a2-258">If clicking on the Delete button does not delete the product, check to ensure that the GridView's `DataKeyNames` property is set to the primary key field (`ProductID`).</span></span>

> [!NOTE]
> <span data-ttu-id="344a2-259">當按一下 [刪除] 按鈕時，回傳接踵而來和記錄會被刪除。</span><span class="sxs-lookup"><span data-stu-id="344a2-259">When clicking on the Delete button a postback ensues and the record is deleted.</span></span> <span data-ttu-id="344a2-260">這可能是危險的，因為很容易不小心按一下錯誤的資料列的 [刪除] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="344a2-260">This can be dangerous since it is easy to accidentally click on the wrong row's Delete button.</span></span> <span data-ttu-id="344a2-261">在未來的教學課程中，我們將瞭解如何在刪除記錄時新增用戶端確認。</span><span class="sxs-lookup"><span data-stu-id="344a2-261">In a future tutorial we'll see how to add a client-side confirmation when deleting a record.</span></span>

## <a name="editing-data-with-the-gridview"></a><span data-ttu-id="344a2-262">使用 GridView 編輯資料</span><span class="sxs-lookup"><span data-stu-id="344a2-262">Editing Data with the GridView</span></span>

<span data-ttu-id="344a2-263">除了刪除，GridView 控制項也提供內建的資料列層級編輯支援。</span><span class="sxs-lookup"><span data-stu-id="344a2-263">Along with deleting, the GridView control also provides built-in row-level editing support.</span></span> <span data-ttu-id="344a2-264">設定 GridView 以支援編輯時，會加入 [編輯] 按鈕的資料行。</span><span class="sxs-lookup"><span data-stu-id="344a2-264">Configuring a GridView to support editing adds a column of Edit buttons.</span></span> <span data-ttu-id="344a2-265">從使用者的觀點來看，按一下資料列的 [編輯] 按鈕會導致該資料列變成可編輯狀態，然後將儲存格轉換成包含現有值的文字方塊，並以 [更新] 和 [取消] 按鈕取代 [編輯] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="344a2-265">From the end user's perspective, clicking a row's Edit button causes that row to become editable, turning the cells into textboxes containing the existing values and replacing the Edit button with Update and Cancel buttons.</span></span> <span data-ttu-id="344a2-266">進行想要的變更之後，終端使用者可以按一下 [更新] 按鈕來認可變更，或按 [取消] 按鈕來捨棄它們。</span><span class="sxs-lookup"><span data-stu-id="344a2-266">After making their desired changes, the end user can click the Update button to commit the changes or the Cancel button to discard them.</span></span> <span data-ttu-id="344a2-267">不論是哪一種情況，在按一下 [更新] 或 [取消] 之後，GridView 都會回到其預先編輯狀態。</span><span class="sxs-lookup"><span data-stu-id="344a2-267">In either case, after clicking Update or Cancel the GridView returns to its pre-editing state.</span></span>

<span data-ttu-id="344a2-268">身為頁面開發人員的觀點，當使用者按一下特定資料列的 [編輯] 按鈕時，回傳接踵而來和 GridView 會執行下列步驟：</span><span class="sxs-lookup"><span data-stu-id="344a2-268">From our perspective as the page developer, when the end user clicks the Edit button for a particular row, a postback ensues and the GridView performs the following steps:</span></span>

1. <span data-ttu-id="344a2-269">GridView 的 `EditItemIndex` 屬性會指派給按下 [編輯] 按鈕的資料列索引</span><span class="sxs-lookup"><span data-stu-id="344a2-269">The GridView's `EditItemIndex` property is assigned to the index of the row whose Edit button was clicked</span></span>
2. <span data-ttu-id="344a2-270">GridView 藉由叫用其 `Select()` 方法，將其本身重新系結至 ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="344a2-270">The GridView rebinds itself to the ObjectDataSource by invoking its `Select()` method</span></span>
3. <span data-ttu-id="344a2-271">符合 `EditItemIndex` 的資料列索引會以「編輯模式」呈現。</span><span class="sxs-lookup"><span data-stu-id="344a2-271">The row index that matches the `EditItemIndex` is rendered in "edit mode."</span></span> <span data-ttu-id="344a2-272">在此模式中，[編輯] 按鈕會取代為 [更新] 和 [取消] 按鈕和 BoundFields，其 `ReadOnly` 屬性為 False （預設值）會轉譯為 TextBox Web 控制項，其 `Text` 屬性會指派給資料欄位的值。</span><span class="sxs-lookup"><span data-stu-id="344a2-272">In this mode, the Edit button is replaced by Update and Cancel buttons and BoundFields whose `ReadOnly` properties are False (the default) are rendered as TextBox Web controls whose `Text` properties are assigned to the data fields' values.</span></span>

<span data-ttu-id="344a2-273">此時，標記會傳回到瀏覽器，讓使用者可以對資料列的資料進行任何變更。</span><span class="sxs-lookup"><span data-stu-id="344a2-273">At this point the markup is returned to the browser, allowing the end user to make any changes to the row's data.</span></span> <span data-ttu-id="344a2-274">當使用者按一下 [更新] 按鈕時，就會發生回傳，而 GridView 會執行下列步驟：</span><span class="sxs-lookup"><span data-stu-id="344a2-274">When the user clicks the Update button, a postback occurs and the GridView performs the following steps:</span></span>

1. <span data-ttu-id="344a2-275">ObjectDataSource 的 `UpdateParameters` 值會被指派使用者輸入至 GridView 編輯介面的值</span><span class="sxs-lookup"><span data-stu-id="344a2-275">The ObjectDataSource's `UpdateParameters` value(s) are assigned the values entered by the end user into the GridView's editing interface</span></span>
2. <span data-ttu-id="344a2-276">會叫用 ObjectDataSource 的 `Update()` 方法，並更新指定的記錄</span><span class="sxs-lookup"><span data-stu-id="344a2-276">The ObjectDataSource's `Update()` method is invoked, updating the specified record</span></span>
3. <span data-ttu-id="344a2-277">GridView 藉由叫用其 `Select()` 方法，將其本身重新系結至 ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="344a2-277">The GridView rebinds itself to the ObjectDataSource by invoking its `Select()` method</span></span>

<span data-ttu-id="344a2-278">在步驟1中指派給 `UpdateParameters` 的主要金鑰值來自于 `DataKeyNames` 屬性中指定的值，而非主鍵值則來自于編輯過的資料列之 TextBox Web 控制項中的文字。</span><span class="sxs-lookup"><span data-stu-id="344a2-278">The primary key values assigned to the `UpdateParameters` in Step 1 come from the values specified in the `DataKeyNames` property, whereas the non-primary key values come from the text in the TextBox Web controls for the edited row.</span></span> <span data-ttu-id="344a2-279">如同刪除，很重要的是 GridView 的 `DataKeyNames` 屬性設定正確。</span><span class="sxs-lookup"><span data-stu-id="344a2-279">As with deleting, it is vital that a GridView's `DataKeyNames` property be correctly set.</span></span> <span data-ttu-id="344a2-280">如果遺失，`UpdateParameters` 的主要金鑰值會指派給步驟1中的 `Nothing` 值，而不會在步驟2中產生任何更新的記錄。</span><span class="sxs-lookup"><span data-stu-id="344a2-280">If it's missing, the `UpdateParameters` primary key value will be assigned a value of `Nothing` in Step 1, which in turn will not result in any updated records in Step 2.</span></span>

<span data-ttu-id="344a2-281">只要勾選 GridView 智慧標籤中的 [啟用編輯] 核取方塊，即可啟用編輯功能。</span><span class="sxs-lookup"><span data-stu-id="344a2-281">Editing functionality can be activated by simply checking the Enable Editing checkbox in the GridView's smart tag.</span></span>

![勾選 [啟用編輯] 核取方塊](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image37.png)

<span data-ttu-id="344a2-283">**圖 15**：勾選 [啟用編輯] 核取方塊</span><span class="sxs-lookup"><span data-stu-id="344a2-283">**Figure 15**: Check the Enable Editing Checkbox</span></span>

<span data-ttu-id="344a2-284">勾選 [啟用編輯] 核取方塊將會加入 CommandField （如有需要），並將其 `ShowEditButton` 屬性設為 `True`。</span><span class="sxs-lookup"><span data-stu-id="344a2-284">Checking the Enable Editing checkbox will add a CommandField (if needed) and set its `ShowEditButton` property to `True`.</span></span> <span data-ttu-id="344a2-285">如先前所見，CommandField 包含數個 `ShowXButton` 屬性，指出 CommandField 中顯示的按鈕系列。</span><span class="sxs-lookup"><span data-stu-id="344a2-285">As we saw earlier, the CommandField contains a number of `ShowXButton` properties that indicate what series of buttons are displayed in the CommandField.</span></span> <span data-ttu-id="344a2-286">勾選 [啟用編輯] 核取方塊會將 `ShowEditButton` 屬性新增至現有的 CommandField：</span><span class="sxs-lookup"><span data-stu-id="344a2-286">Checking the Enable Editing checkbox adds the `ShowEditButton` property to the existing CommandField:</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample6.aspx)]

<span data-ttu-id="344a2-287">這就是新增基本編輯支援的所有程式。</span><span class="sxs-lookup"><span data-stu-id="344a2-287">That's all there is to adding rudimentary editing support.</span></span> <span data-ttu-id="344a2-288">如 Figure16 所示，編輯介面相當粗糙每個 BoundField，其 `ReadOnly` 屬性設為 `False` （預設值）會轉譯成 TextBox。</span><span class="sxs-lookup"><span data-stu-id="344a2-288">As Figure16 shows, the editing interface is rather crude each BoundField whose `ReadOnly` property is set to `False` (the default) is rendered as a TextBox.</span></span> <span data-ttu-id="344a2-289">這包括 `CategoryID` 和 `SupplierID`等欄位，也就是其他資料表的索引鍵。</span><span class="sxs-lookup"><span data-stu-id="344a2-289">This includes fields like `CategoryID` and `SupplierID`, which are keys to other tables.</span></span>

<span data-ttu-id="344a2-290">[![按一下 [Chai s 編輯] 按鈕，就會在編輯模式中顯示資料列](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image39.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="344a2-290">[![Clicking Chai s Edit Button Displays the Row in Edit Mode](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image39.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image38.png)</span></span>

<span data-ttu-id="344a2-291">**圖 16**：按一下 [Chai s 編輯] 按鈕會在編輯模式中顯示資料列（[按一下以觀看完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image40.png)）</span><span class="sxs-lookup"><span data-stu-id="344a2-291">**Figure 16**: Clicking Chai s Edit Button Displays the Row in Edit Mode ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image40.png))</span></span>

<span data-ttu-id="344a2-292">除了要求使用者直接編輯外鍵值以外，編輯介面的介面也缺少下列方法：</span><span class="sxs-lookup"><span data-stu-id="344a2-292">In addition to asking users to edit foreign key values directly, the editing interface's interface is lacking in the following ways:</span></span>

- <span data-ttu-id="344a2-293">如果使用者輸入的 `CategoryID` 或 `SupplierID` 不存在於資料庫中，`UPDATE` 將會違反外鍵條件約束，而導致引發例外狀況。</span><span class="sxs-lookup"><span data-stu-id="344a2-293">If the user enters a `CategoryID` or `SupplierID` that does not exist in the database, the `UPDATE` will violate a foreign key constraint, causing an exception to be raised.</span></span>
- <span data-ttu-id="344a2-294">編輯介面不包含任何驗證。</span><span class="sxs-lookup"><span data-stu-id="344a2-294">The editing interface doesn't include any validation.</span></span> <span data-ttu-id="344a2-295">如果您未提供必要的值（例如 `ProductName`），或輸入應為數值的字串值（例如輸入「太多！」</span><span class="sxs-lookup"><span data-stu-id="344a2-295">If you don't provide a required value (such as `ProductName`), or enter a string value where a numeric value is expected (such as entering "Too much!"</span></span> <span data-ttu-id="344a2-296">在 [`UnitPrice`] 文字方塊）中，將會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="344a2-296">into the `UnitPrice` textbox), an exception will be thrown.</span></span> <span data-ttu-id="344a2-297">未來的教學課程將會檢查如何將驗證控制項新增至編輯使用者介面。</span><span class="sxs-lookup"><span data-stu-id="344a2-297">A future tutorial will examine how to add validation controls to the editing user interface.</span></span>
- <span data-ttu-id="344a2-298">目前，*所有*非唯讀的產品欄位都必須包含在 GridView 中。</span><span class="sxs-lookup"><span data-stu-id="344a2-298">Currently, *all* product fields that are not read-only must be included in the GridView.</span></span> <span data-ttu-id="344a2-299">如果我們要從 GridView 移除欄位（例如 `UnitPrice`），則在更新資料時，GridView 不會將 `UnitPrice` `UpdateParameters` 值，這會將資料庫記錄的 `UnitPrice` 變更為 `NULL` 值。</span><span class="sxs-lookup"><span data-stu-id="344a2-299">If we were to remove a field from the GridView, say `UnitPrice`, when updating the data the GridView would not set the `UnitPrice` `UpdateParameters` value, which would change the database record's `UnitPrice` to a `NULL` value.</span></span> <span data-ttu-id="344a2-300">同樣地，如果必要的欄位（例如 `ProductName`）已從 GridView 移除，則更新會失敗，並出現相同的「資料*行 ' ProductName ' 不允許 null*」的例外狀況。</span><span class="sxs-lookup"><span data-stu-id="344a2-300">Similarly, if a required field, such as `ProductName`, is removed from the GridView, the update will fail with the same "*Column 'ProductName' does not allow nulls*" exception mentioned above.</span></span>
- <span data-ttu-id="344a2-301">編輯介面的格式設定並不需要太多。</span><span class="sxs-lookup"><span data-stu-id="344a2-301">The editing interface formatting leaves a lot to be desired.</span></span> <span data-ttu-id="344a2-302">`UnitPrice` 會以四個小數點顯示。</span><span class="sxs-lookup"><span data-stu-id="344a2-302">The `UnitPrice` is shown with four decimal points.</span></span> <span data-ttu-id="344a2-303">在理想的情況下，`CategoryID` 和 `SupplierID` 值會包含 Dropdownlist 進行，列出系統中的類別和供應商。</span><span class="sxs-lookup"><span data-stu-id="344a2-303">Ideally the `CategoryID` and `SupplierID` values would contain DropDownLists that list the categories and suppliers in the system.</span></span>

<span data-ttu-id="344a2-304">這些都是我們目前必須提供的缺點，但會在未來的教學課程中解決。</span><span class="sxs-lookup"><span data-stu-id="344a2-304">These are all shortcomings that we'll have to live with for now, but will be addressed in future tutorials.</span></span>

## <a name="inserting-editing-and-deleting-data-with-the-detailsview"></a><span data-ttu-id="344a2-305">使用 DetailsView 插入、編輯和刪除資料</span><span class="sxs-lookup"><span data-stu-id="344a2-305">Inserting, Editing, and Deleting Data with the DetailsView</span></span>

<span data-ttu-id="344a2-306">如我們在先前的教學課程中所見，DetailsView 控制項一次會顯示一筆記錄，如 GridView，則允許編輯及刪除目前顯示的記錄。</span><span class="sxs-lookup"><span data-stu-id="344a2-306">As we've seen in earlier tutorials, the DetailsView control displays one record at a time and, like the GridView, allows for editing and deleting of the currently displayed record.</span></span> <span data-ttu-id="344a2-307">使用者從 DetailsView 編輯和刪除專案的經驗，以及來自 ASP.NET 端的工作流程，都與 GridView 的功能完全相同。</span><span class="sxs-lookup"><span data-stu-id="344a2-307">Both the end user's experience with editing and deleting items from a DetailsView and the workflow from the ASP.NET side is identical to that of the GridView.</span></span> <span data-ttu-id="344a2-308">DetailsView 與 GridView 的不同之處在于，它也提供內建的插入支援。</span><span class="sxs-lookup"><span data-stu-id="344a2-308">Where the DetailsView differs from the GridView is that it also provides built-in inserting support.</span></span>

<span data-ttu-id="344a2-309">若要示範 GridView 的資料修改功能，請先將 DetailsView 新增至現有 GridView 上方的 [`Basics.aspx`] 頁面，然後透過 DetailsView 的智慧標籤將其系結至現有的 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="344a2-309">To demonstrate the data modification capabilities of the GridView, start by adding a DetailsView to the `Basics.aspx` page above the existing GridView and bind it to the existing ObjectDataSource through the DetailsView's smart tag.</span></span> <span data-ttu-id="344a2-310">接下來，清除 DetailsView 的 `Height` 並 `Width` 屬性，然後從智慧標籤中選取 [啟用分頁] 選項。</span><span class="sxs-lookup"><span data-stu-id="344a2-310">Next, clear out the DetailsView's `Height` and `Width` properties, and check the Enable Paging option from the smart tag.</span></span> <span data-ttu-id="344a2-311">若要啟用編輯、插入及刪除支援，只要勾選智慧標籤中的 [啟用編輯]、[啟用插入] 和 [啟用刪除] 核取方塊即可。</span><span class="sxs-lookup"><span data-stu-id="344a2-311">To enable editing, inserting, and deleting support, simply check the Enable Editing, Enable Inserting, and Enable Deleting checkboxes in the smart tag.</span></span>

![設定 DetailsView 以支援編輯、插入及刪除](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image41.png)

<span data-ttu-id="344a2-313">**圖 17**：設定 DetailsView 以支援編輯、插入及刪除</span><span class="sxs-lookup"><span data-stu-id="344a2-313">**Figure 17**: Configure the DetailsView to Support Editing, Inserting, and Deleting</span></span>

<span data-ttu-id="344a2-314">如同 GridView，加入編輯、插入或刪除支援會將 CommandField 新增至 DetailsView，如下列宣告式語法所示：</span><span class="sxs-lookup"><span data-stu-id="344a2-314">As with the GridView, adding editing, inserting, or deleting support adds a CommandField to the DetailsView, as the following declarative syntax shows:</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample7.aspx)]

<span data-ttu-id="344a2-315">請注意，針對 DetailsView，CommandField 預設會出現在資料行集合的結尾。</span><span class="sxs-lookup"><span data-stu-id="344a2-315">Note that for the DetailsView the CommandField appears at the end of the Columns collection by default.</span></span> <span data-ttu-id="344a2-316">因為 DetailsView 的欄位會轉譯為數據列，所以 CommandField 會顯示為數據列，其中包含 DetailsView 底部的 [插入]、[編輯] 和 [刪除] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="344a2-316">Since the DetailsView's fields are rendered as rows, the CommandField appears as a row with Insert, Edit, and Delete buttons at the bottom of the DetailsView.</span></span>

<span data-ttu-id="344a2-317">[![設定 DetailsView 以支援編輯、插入及刪除](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image43.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="344a2-317">[![Configure the DetailsView to Support Editing, Inserting, and Deleting](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image43.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image42.png)</span></span>

<span data-ttu-id="344a2-318">**圖 18**：設定 DetailsView 以支援編輯、插入和刪除（[按一下以觀看完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image44.png)）</span><span class="sxs-lookup"><span data-stu-id="344a2-318">**Figure 18**: Configure the DetailsView to Support Editing, Inserting, and Deleting ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image44.png))</span></span>

<span data-ttu-id="344a2-319">按一下 [刪除] 按鈕會啟動與 GridView 相同的事件順序：回傳;接著，DetailsView 會根據 `DataKeyNames` 值填入其 ObjectDataSource 的 `DeleteParameters`;完成後，請呼叫其 ObjectDataSource 的 `Delete()` 方法，這實際上會從資料庫移除產品。</span><span class="sxs-lookup"><span data-stu-id="344a2-319">Clicking on the Delete button starts the same sequence of events as with the GridView: a postback; followed by the DetailsView populating its ObjectDataSource's `DeleteParameters` based on the `DataKeyNames` values; and completed with a call its ObjectDataSource's `Delete()` method, which actually removes the product from the database.</span></span> <span data-ttu-id="344a2-320">在 DetailsView 中編輯的功能也與 GridView 的方式相同。</span><span class="sxs-lookup"><span data-stu-id="344a2-320">Editing in the DetailsView also works in a fashion identical to that of the GridView.</span></span>

<span data-ttu-id="344a2-321">若要插入，使用者會看到一個新按鈕，當您按一下時，就會以「插入模式」轉譯 DetailsView。</span><span class="sxs-lookup"><span data-stu-id="344a2-321">For inserting, the end user is presented with a New button that, when clicked, renders the DetailsView in "insert mode."</span></span> <span data-ttu-id="344a2-322">使用 [插入模式] 時，[新增] 按鈕會由 [插入] 和 [取消] 按鈕取代，而且只會顯示 `InsertVisible` 屬性設為 `True` （預設值）的 BoundFields。</span><span class="sxs-lookup"><span data-stu-id="344a2-322">With "insert mode" the New button is replaced by Insert and Cancel buttons and only those BoundFields whose `InsertVisible` property is set to `True` (the default) are displayed.</span></span> <span data-ttu-id="344a2-323">當您透過智慧標籤將 DetailsView 系結至資料來源時，這些資料欄位（例如 `ProductID`）會將其[InsertVisible 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datacontrolfield.insertvisible(VS.80).aspx)設定為 `False`。</span><span class="sxs-lookup"><span data-stu-id="344a2-323">Those data fields identified as auto-increment fields, such as `ProductID`, have their [InsertVisible property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datacontrolfield.insertvisible(VS.80).aspx) set to `False` when binding the DetailsView to the data source through the smart tag.</span></span>

<span data-ttu-id="344a2-324">透過智慧標籤將資料來源系結至 DetailsView 時，Visual Studio 會將 `InsertVisible` 屬性設定為僅 `False` 自動遞增欄位。</span><span class="sxs-lookup"><span data-stu-id="344a2-324">When binding a data source to a DetailsView through the smart tag, Visual Studio sets the `InsertVisible` property to `False` only for auto-increment fields.</span></span> <span data-ttu-id="344a2-325">唯讀欄位（例如 `CategoryName` 和 `SupplierName`）將會顯示在「插入模式」使用者介面中，除非其 `InsertVisible` 屬性已明確設定為 [`False`]。</span><span class="sxs-lookup"><span data-stu-id="344a2-325">Read-only fields, like `CategoryName` and `SupplierName`, will be displayed in the "insert mode" user interface unless their `InsertVisible` property is explicitly set to `False`.</span></span> <span data-ttu-id="344a2-326">請花點時間將這兩個欄位的 `InsertVisible` 屬性設定為 `False`，不論是透過 DetailsView 的宣告式語法，或透過智慧標籤中的編輯欄位連結。</span><span class="sxs-lookup"><span data-stu-id="344a2-326">Take a moment to set these two fields' `InsertVisible` properties to `False`, either through the DetailsView's declarative syntax or through the Edit Fields link in the smart tag.</span></span> <span data-ttu-id="344a2-327">[圖 19] 顯示按一下 [編輯欄位] 連結，將 `InsertVisible` 屬性設定為 [`False`]。</span><span class="sxs-lookup"><span data-stu-id="344a2-327">Figure 19 shows setting the `InsertVisible` properties to `False` by clicking on the Edit Fields link.</span></span>

<span data-ttu-id="344a2-328">[![Northwind 商貿現在提供 Acme 茶](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image46.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="344a2-328">[![Northwind Traders Now Offers Acme Tea](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image46.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image45.png)</span></span>

<span data-ttu-id="344a2-329">**圖 19**： Northwind 商貿現在提供 Acme 茶（[按一下以觀看完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image47.png)）</span><span class="sxs-lookup"><span data-stu-id="344a2-329">**Figure 19**: Northwind Traders Now Offers Acme Tea ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image47.png))</span></span>

<span data-ttu-id="344a2-330">設定 `InsertVisible` 屬性之後，請在瀏覽器中查看 [`Basics.aspx`] 頁面，然後按一下 [新增] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="344a2-330">After setting the `InsertVisible` properties, view the `Basics.aspx` page in a browser and click the New button.</span></span> <span data-ttu-id="344a2-331">[圖 20] 顯示將新飲料（Acme 茶）新增至產品線時的 DetailsView。</span><span class="sxs-lookup"><span data-stu-id="344a2-331">Figure 20 shows the DetailsView when adding a new beverage, Acme Tea, to our product line.</span></span>

<span data-ttu-id="344a2-332">[![Northwind 商貿現在提供 Acme 茶](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image49.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image48.png)</span><span class="sxs-lookup"><span data-stu-id="344a2-332">[![Northwind Traders Now Offers Acme Tea](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image49.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image48.png)</span></span>

<span data-ttu-id="344a2-333">**圖 20**： Northwind 商貿現在提供 Acme 茶（[按一下以觀看完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image50.png)）</span><span class="sxs-lookup"><span data-stu-id="344a2-333">**Figure 20**: Northwind Traders Now Offers Acme Tea ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image50.png))</span></span>

<span data-ttu-id="344a2-334">輸入 Acme 茶的詳細資料並按一下 [插入] 按鈕之後，會將回傳接踵而來和新記錄加入至 `Products` 資料庫資料表。</span><span class="sxs-lookup"><span data-stu-id="344a2-334">After entering the details for Acme Tea and clicking the Insert button, a postback ensues and the new record is added to the `Products` database table.</span></span> <span data-ttu-id="344a2-335">由於此 DetailsView 會列出產品，而且它們存在於資料庫資料表中，因此我們必須先分頁到最後一個產品，才能看到新的產品。</span><span class="sxs-lookup"><span data-stu-id="344a2-335">Since this DetailsView lists the products in order with which they exist in the database table, we must page to the last product in order to see the new product.</span></span>

<span data-ttu-id="344a2-336">[適用于 Acme 茶的 ![詳細資料](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image52.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image51.png)</span><span class="sxs-lookup"><span data-stu-id="344a2-336">[![Details for Acme Tea](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image52.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image51.png)</span></span>

<span data-ttu-id="344a2-337">**圖 21**： Acme 茶的詳細資料（[按一下以觀看完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image53.png)）</span><span class="sxs-lookup"><span data-stu-id="344a2-337">**Figure 21**: Details for Acme Tea ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image53.png))</span></span>

> [!NOTE]
> <span data-ttu-id="344a2-338">DetailsView 的[CurrentMode 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.currentmode(VS.80).aspx)會指出要顯示的介面，而且可以是下列其中一個值： `Edit`、`Insert`或 `ReadOnly`。</span><span class="sxs-lookup"><span data-stu-id="344a2-338">The DetailsView's [CurrentMode property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.currentmode(VS.80).aspx) indicates the interface being displayed and can be one of the following values: `Edit`, `Insert`, or `ReadOnly`.</span></span> <span data-ttu-id="344a2-339">[DefaultMode 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.defaultmode(VS.80).aspx)指出 detailsview 在完成編輯或插入之後，所傳回的模式，並且適用于顯示永久為 [編輯] 或 [插入] 模式的 DetailsView。</span><span class="sxs-lookup"><span data-stu-id="344a2-339">The [DefaultMode property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.defaultmode(VS.80).aspx) indicates the mode the DetailsView returns to after an edit or insert has been completed and is useful for displaying a DetailsView that is permanently in edit or insert mode.</span></span>

<span data-ttu-id="344a2-340">DetailsView 的點和編輯功能與 GridView 的限制相同：使用者必須輸入現有的 `CategoryID`，並透過 textbox `SupplierID` 值;介面缺少任何驗證邏輯;不允許 `NULL` 值或沒有在資料庫層級指定之預設值的所有產品欄位，都必須包含在插入介面中，依此類推。</span><span class="sxs-lookup"><span data-stu-id="344a2-340">The point and click inserting and editing capabilities of the DetailsView suffer from the same limitations as the GridView: the user must enter existing `CategoryID` and `SupplierID` values through a textbox; the interface lacks any validation logic; all product fields that do not allow `NULL` values or don't have a default value specified at the database level must be included in the inserting interface, and so on.</span></span>

<span data-ttu-id="344a2-341">在未來的文章中，我們將檢查以擴充及增強 GridView 編輯介面的技術，也適用于 DetailsView 控制項的編輯和插入介面。</span><span class="sxs-lookup"><span data-stu-id="344a2-341">The techniques we will examine for extending and enhancing the GridView's editing interface in future articles can be applied to the DetailsView control's editing and inserting interfaces as well.</span></span>

## <a name="using-the-formview-for-a-more-flexible-data-modification-user-interface"></a><span data-ttu-id="344a2-342">使用 FormView 取得更有彈性的資料修改使用者介面</span><span class="sxs-lookup"><span data-stu-id="344a2-342">Using the FormView for a More Flexible Data Modification User Interface</span></span>

<span data-ttu-id="344a2-343">FormView 提供了插入、編輯和刪除資料的內建支援，但是因為它使用範本而不是欄位，所以沒有任何地方可以加入 GridView 和 DetailsView 控制項用來提供資料的 BoundFields 或 CommandField修改介面。</span><span class="sxs-lookup"><span data-stu-id="344a2-343">The FormView offers built-in support for inserting, editing, and deleting data, but because it uses templates instead of fields there's no place to add the BoundFields or the CommandField used by the GridView and DetailsView controls to provide the data modification interface.</span></span> <span data-ttu-id="344a2-344">相反地，在加入新專案時，用來收集使用者輸入的 Web 控制項，或編輯現有的 [新增]、[編輯]、[刪除]、[插入]、[更新] 和 [取消] 按鈕，必須手動新增至適當的範本。</span><span class="sxs-lookup"><span data-stu-id="344a2-344">Instead, this interface the Web controls for collecting user input when adding a new item or editing an existing one along with the New, Edit, Delete, Insert, Update, and Cancel buttons must be added manually to the appropriate templates.</span></span> <span data-ttu-id="344a2-345">幸好，Visual Studio 會在透過其智慧標籤的下拉式清單將 FormView 系結至資料來源時，自動建立所需的介面。</span><span class="sxs-lookup"><span data-stu-id="344a2-345">Fortunately, Visual Studio will automatically create the needed interface when binding the FormView to a data source through the drop-down list in its smart tag.</span></span>

<span data-ttu-id="344a2-346">為了說明這些技術，請先將 FormView 加入至 `Basics.aspx` 頁面，然後從 FormView 的智慧標籤將它系結至已建立的 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="344a2-346">To illustrate these techniques, start by adding a FormView to the `Basics.aspx` page and, from the FormView's smart tag, bind it to the ObjectDataSource already created.</span></span> <span data-ttu-id="344a2-347">這會產生 [FormView with TextBox] Web 控制項的 `EditItemTemplate`、`InsertItemTemplate`和 `ItemTemplate`，用於收集 [新增]、[編輯]、[刪除]、[插入]、[更新] 和 [取消] 按鈕的使用者輸入和按鈕 Web 控制項。</span><span class="sxs-lookup"><span data-stu-id="344a2-347">This will generate an `EditItemTemplate`, `InsertItemTemplate`, and `ItemTemplate` for the FormView with TextBox Web controls for collecting the user's input and Button Web controls for the New, Edit, Delete, Insert, Update, and Cancel buttons.</span></span> <span data-ttu-id="344a2-348">此外，FormView 的 `DataKeyNames` 屬性會設定為 ObjectDataSource 所傳回之物件的主要索引鍵欄位（`ProductID`）。</span><span class="sxs-lookup"><span data-stu-id="344a2-348">Additionally, the FormView's `DataKeyNames` property is set to the primary key field (`ProductID`) of the object returned by the ObjectDataSource.</span></span> <span data-ttu-id="344a2-349">最後，勾選 FormView 的智慧標籤中的 [啟用分頁] 選項。</span><span class="sxs-lookup"><span data-stu-id="344a2-349">Lastly, check the Enable Paging option in the FormView's smart tag.</span></span>

<span data-ttu-id="344a2-350">以下顯示在 FormView 已系結至 ObjectDataSource 之後，FormView 的 `ItemTemplate` 宣告式標記。</span><span class="sxs-lookup"><span data-stu-id="344a2-350">The following shows the declarative markup for the FormView's `ItemTemplate` after the FormView has been bound to the ObjectDataSource.</span></span> <span data-ttu-id="344a2-351">根據預設，每個非布林值產品欄位都會系結至標籤 Web 控制項的 `Text` 屬性，而每個布林值欄位（`Discontinued`）都會系結至已停用之核取方塊 Web 控制項的 `Checked` 屬性。</span><span class="sxs-lookup"><span data-stu-id="344a2-351">By default, each non-Boolean value product field is bound to the `Text` property of a Label Web control while each Boolean value field (`Discontinued`) is bound to the `Checked` property of a disabled CheckBox Web control.</span></span> <span data-ttu-id="344a2-352">為了讓 [新增]、[編輯] 和 [刪除] 按鈕在按一下時觸發特定的 FormView 行為，請務必將其 `CommandName` 值分別設定為 `New`、`Edit`和 `Delete`。</span><span class="sxs-lookup"><span data-stu-id="344a2-352">In order for the New, Edit, and Delete buttons to trigger certain FormView behavior when clicked, it is imperative that their `CommandName` values be set to `New`, `Edit`, and `Delete`, respectively.</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample8.aspx)]

<span data-ttu-id="344a2-353">[圖 22] 顯示在瀏覽器中觀看 FormView 的 `ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="344a2-353">Figure 22 shows the FormView's `ItemTemplate` when viewed through a browser.</span></span> <span data-ttu-id="344a2-354">每個產品欄位都會以底部的 [新增]、[編輯] 和 [刪除] 按鈕列出。</span><span class="sxs-lookup"><span data-stu-id="344a2-354">Each product field is listed with the New, Edit, and Delete buttons at the bottom.</span></span>

<span data-ttu-id="344a2-355">[![預設使用者名稱為 FormView ItemTemplate 會列出每個產品欄位，以及 [新增]、[編輯] 和 [刪除] 按鈕](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image55.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image54.png)</span><span class="sxs-lookup"><span data-stu-id="344a2-355">[![The Defaut FormView ItemTemplate Lists Each Product Field Along with New, Edit, and Delete Buttons](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image55.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image54.png)</span></span>

<span data-ttu-id="344a2-356">**圖 22**：預設使用者名稱為 FormView `ItemTemplate` 會列出每個產品欄位，以及 [新增]、[編輯] 和 [刪除] 按鈕（[按一下以查看完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image56.png)）</span><span class="sxs-lookup"><span data-stu-id="344a2-356">**Figure 22**: The Defaut FormView `ItemTemplate` Lists Each Product Field Along with New, Edit, and Delete Buttons ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image56.png))</span></span>

<span data-ttu-id="344a2-357">就像 GridView 和 DetailsView 一樣，按一下 [刪除] 按鈕或 `CommandName` 屬性設為 [刪除] 的任何按鈕、LinkButton 或 ImageButton，都會導致回傳、根據 FormView 的 `DataKeyNames` 值填入 ObjectDataSource 的 `DeleteParameters`，以及叫用 ObjectDataSource 的 `Delete()` 方法。</span><span class="sxs-lookup"><span data-stu-id="344a2-357">Like with the GridView and DetailsView, clicking the Delete button or any Button, LinkButton, or ImageButton whose `CommandName` property is set to Delete causes a postback, populates the ObjectDataSource's `DeleteParameters` based on the FormView's `DataKeyNames` value, and invokes the ObjectDataSource's `Delete()` method.</span></span>

<span data-ttu-id="344a2-358">當按一下 [編輯] 按鈕時，回傳接踵而來和資料會重新系結至 `EditItemTemplate`，這會負責呈現編輯介面。</span><span class="sxs-lookup"><span data-stu-id="344a2-358">When the Edit button is clicked a postback ensues and the data is rebound to the `EditItemTemplate`, which is responsible for rendering the editing interface.</span></span> <span data-ttu-id="344a2-359">此介面包含用於編輯資料的 Web 控制項，以及 [更新] 和 [取消] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="344a2-359">This interface includes the Web controls for editing data along with the Update and Cancel buttons.</span></span> <span data-ttu-id="344a2-360">Visual Studio 產生的預設 `EditItemTemplate` 包含任何自動遞增欄位（`ProductID`）的標籤、每個非布林值欄位的 TextBox，以及每個布林值欄位的核取方塊。</span><span class="sxs-lookup"><span data-stu-id="344a2-360">The default `EditItemTemplate` generated by Visual Studio contains a Label for any auto-increment fields (`ProductID`), a TextBox for each non-Boolean value field, and a CheckBox for each Boolean value field.</span></span> <span data-ttu-id="344a2-361">這個行為與 GridView 和 DetailsView 控制項中自動產生的 BoundFields 非常類似。</span><span class="sxs-lookup"><span data-stu-id="344a2-361">This behavior is very similar to the auto-generated BoundFields in the GridView and DetailsView controls.</span></span>

> [!NOTE]
> <span data-ttu-id="344a2-362">FormView 自動產生 `EditItemTemplate` 的一個小問題是，它會針對唯讀的欄位呈現 TextBox Web 控制項，例如 `CategoryName` 和 `SupplierName`。</span><span class="sxs-lookup"><span data-stu-id="344a2-362">One small issue with the FormView's auto-generation of the `EditItemTemplate` is that it renders TextBox Web controls for those fields that are read-only, such as `CategoryName` and `SupplierName`.</span></span> <span data-ttu-id="344a2-363">我們很快就會說明如何將此帳戶。</span><span class="sxs-lookup"><span data-stu-id="344a2-363">We'll see how to account for this shortly.</span></span>

<span data-ttu-id="344a2-364">`EditItemTemplate` 中的 TextBox 控制項使用*雙向資料*系結，將其 `Text` 屬性系結至其對應資料欄位的值。</span><span class="sxs-lookup"><span data-stu-id="344a2-364">The TextBox controls in the `EditItemTemplate` have their `Text` property bound to the value of their corresponding data field using *two-way databinding*.</span></span> <span data-ttu-id="344a2-365">雙向資料系結（以 `<%# Bind("dataField") %>`表示）會在將資料系結至範本，以及填入 ObjectDataSource 的參數來插入或編輯記錄時，執行資料系結。</span><span class="sxs-lookup"><span data-stu-id="344a2-365">Two-way databinding, denoted by `<%# Bind("dataField") %>`, performs databinding both when binding data to the template and when populating the ObjectDataSource's parameters for inserting or editing records.</span></span> <span data-ttu-id="344a2-366">也就是說，當使用者從 `ItemTemplate`按一下 [編輯] 按鈕時，`Bind()` 方法會傳回指定的資料欄值。</span><span class="sxs-lookup"><span data-stu-id="344a2-366">That is, when the user clicks the Edit button from the `ItemTemplate`, the `Bind()` method returns the specified data field value.</span></span> <span data-ttu-id="344a2-367">使用者進行變更並按一下 [更新] 之後，會將回傳的值（對應至使用 `Bind()` 所指定的資料欄位）套用至 ObjectDataSource 的 `UpdateParameters`。</span><span class="sxs-lookup"><span data-stu-id="344a2-367">After the user makes their changes and clicks Update, the values posted back that correspond to the data fields specified using `Bind()` are applied to the ObjectDataSource's `UpdateParameters`.</span></span> <span data-ttu-id="344a2-368">或者，單向資料系結（以 `<%# Eval("dataField") %>`表示）只會在將資料系結至範本時，才會抓取資料欄位值，*而且不會*在回傳時將使用者輸入的值傳回資料來源的參數。</span><span class="sxs-lookup"><span data-stu-id="344a2-368">Alternatively, one-way databinding, denoted by `<%# Eval("dataField") %>`, only retrieves the data field values when binding data to the template and does *not* return the user-entered values to the data source's parameters on postback.</span></span>

<span data-ttu-id="344a2-369">下列宣告式標記會顯示 FormView 的 `EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="344a2-369">The following declarative markup shows the FormView's `EditItemTemplate`.</span></span> <span data-ttu-id="344a2-370">請注意，這裡的資料系結語法中會使用 `Bind()` 方法，而且 [更新] 和 [取消] 按鈕 Web 控制項會據以設定其 `CommandName` 屬性。</span><span class="sxs-lookup"><span data-stu-id="344a2-370">Note that the `Bind()` method is used in the databinding syntax here and that the Update and Cancel Button Web controls have their `CommandName` properties set accordingly.</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample9.aspx)]

<span data-ttu-id="344a2-371">此時，我們的 `EditItemTemplate`會導致擲回例外狀況（如果我們嘗試使用的話）。</span><span class="sxs-lookup"><span data-stu-id="344a2-371">Our `EditItemTemplate`, at this point, will cause an exception to be thrown if we attempt to use it.</span></span> <span data-ttu-id="344a2-372">問題在於 [`CategoryName`] 和 [`SupplierName`] 欄位會轉譯為 `EditItemTemplate`中的 TextBox Web 控制項。</span><span class="sxs-lookup"><span data-stu-id="344a2-372">The problem is that the `CategoryName` and `SupplierName` fields are rendered as TextBox Web controls in the `EditItemTemplate`.</span></span> <span data-ttu-id="344a2-373">我們必須將這些文字方塊變更為標籤，或將它們全部移除。</span><span class="sxs-lookup"><span data-stu-id="344a2-373">We either need to change these TextBoxes to Labels or remove them altogether.</span></span> <span data-ttu-id="344a2-374">讓我們直接從 `EditItemTemplate`中刪除它們。</span><span class="sxs-lookup"><span data-stu-id="344a2-374">Let's simply delete them entirely from the `EditItemTemplate`.</span></span>

<span data-ttu-id="344a2-375">[圖 23] 顯示在按一下 [編輯] 按鈕以進行 Chai 之後，瀏覽器中的 FormView。</span><span class="sxs-lookup"><span data-stu-id="344a2-375">Figure 23 shows the FormView in a browser after the Edit button has been clicked for Chai.</span></span> <span data-ttu-id="344a2-376">請注意，`ItemTemplate` 中顯示的 [`SupplierName`] 和 [`CategoryName`] 欄位已不存在，因為我們只是從 `EditItemTemplate`中移除它們。</span><span class="sxs-lookup"><span data-stu-id="344a2-376">Note that the `SupplierName` and `CategoryName` fields shown in the `ItemTemplate` are no longer present, as we just removed them from the `EditItemTemplate`.</span></span> <span data-ttu-id="344a2-377">按一下 [更新] 按鈕時，FormView 會繼續進行與 GridView 和 DetailsView 控制項相同的步驟順序。</span><span class="sxs-lookup"><span data-stu-id="344a2-377">When the Update button is clicked the FormView proceeds through the same sequence of steps as the GridView and DetailsView controls.</span></span>

<span data-ttu-id="344a2-378">[![依預設，EditItemTemplate 會將每個可編輯的產品欄位顯示為文字方塊或核取方塊](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image58.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image57.png)</span><span class="sxs-lookup"><span data-stu-id="344a2-378">[![By Default the EditItemTemplate Shows Each Editable Product Field as a TextBox or CheckBox](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image58.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image57.png)</span></span>

<span data-ttu-id="344a2-379">**圖 23**：根據預設，`EditItemTemplate` 會將每個可編輯的產品欄位顯示為文字方塊或核取方塊（[按一下以查看完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image59.png)）</span><span class="sxs-lookup"><span data-stu-id="344a2-379">**Figure 23**: By Default the `EditItemTemplate` Shows Each Editable Product Field as a TextBox or CheckBox ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image59.png))</span></span>

<span data-ttu-id="344a2-380">當按一下 [插入] 按鈕時，會將 FormView 的 `ItemTemplate` 回傳接踵而來。</span><span class="sxs-lookup"><span data-stu-id="344a2-380">When the Insert button is clicked the FormView's `ItemTemplate` a postback ensues.</span></span> <span data-ttu-id="344a2-381">不過，因為加入了新的記錄，所以沒有任何資料系結到 FormView。</span><span class="sxs-lookup"><span data-stu-id="344a2-381">However, no data is bound to the FormView because a new record is being added.</span></span> <span data-ttu-id="344a2-382">`InsertItemTemplate` 介面包含的 Web 控制項，可用於加入新記錄以及 [插入] 和 [取消] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="344a2-382">The `InsertItemTemplate` interface includes the Web controls for adding a new record along with the Insert and Cancel buttons.</span></span> <span data-ttu-id="344a2-383">Visual Studio 產生的預設 `InsertItemTemplate` 包含每個非布林值欄位的文字方塊，以及每個布林值欄位的核取方塊，類似于自動產生的 `EditItemTemplate`介面。</span><span class="sxs-lookup"><span data-stu-id="344a2-383">The default `InsertItemTemplate` generated by Visual Studio contains a TextBox for each non-Boolean value field and a CheckBox for each Boolean value field, similar to the auto-generated `EditItemTemplate`'s interface.</span></span> <span data-ttu-id="344a2-384">TextBox 控制項的 `Text` 屬性會使用雙向資料系結，系結至其對應資料欄位的值。</span><span class="sxs-lookup"><span data-stu-id="344a2-384">The TextBox controls have their `Text` property bound to the value of their corresponding data field using two-way databinding.</span></span>

<span data-ttu-id="344a2-385">下列宣告式標記會顯示 FormView 的 `InsertItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="344a2-385">The following declarative markup shows the FormView's `InsertItemTemplate`.</span></span> <span data-ttu-id="344a2-386">請注意，這裡的資料系結語法中會使用 `Bind()` 方法，而且 [插入] 和 [取消] 按鈕 Web 控制項會據以設定其 `CommandName` 屬性。</span><span class="sxs-lookup"><span data-stu-id="344a2-386">Note that the `Bind()` method is used in the databinding syntax here and that the Insert and Cancel Button Web controls have their `CommandName` properties set accordingly.</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample10.aspx)]

<span data-ttu-id="344a2-387">奧妙會使用 FormView 的自動產生 `InsertItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="344a2-387">There's a subtlety with the FormView's auto-generation of the `InsertItemTemplate`.</span></span> <span data-ttu-id="344a2-388">具體來說，即使是唯讀的欄位，也會建立 TextBox Web 控制項，例如 `CategoryName` 和 `SupplierName`。</span><span class="sxs-lookup"><span data-stu-id="344a2-388">Specifically, the TextBox Web controls are created even for those fields that are read-only, such as `CategoryName` and `SupplierName`.</span></span> <span data-ttu-id="344a2-389">如同 `EditItemTemplate`，我們需要從 `InsertItemTemplate`中移除這些文字方塊。</span><span class="sxs-lookup"><span data-stu-id="344a2-389">Like with the `EditItemTemplate`, we need to remove these TextBoxes from the `InsertItemTemplate`.</span></span>

<span data-ttu-id="344a2-390">[圖 24] 在加入新產品時，將 FormView 顯示在瀏覽器中（Acme 咖啡）。</span><span class="sxs-lookup"><span data-stu-id="344a2-390">Figure 24 shows the FormView in a browser when adding a new product, Acme Coffee.</span></span> <span data-ttu-id="344a2-391">請注意，`ItemTemplate` 中顯示的 [`SupplierName`] 和 [`CategoryName`] 欄位已不存在，因為我們剛剛將其移除。</span><span class="sxs-lookup"><span data-stu-id="344a2-391">Note that the `SupplierName` and `CategoryName` fields shown in the `ItemTemplate` are no longer present, as we just removed them.</span></span> <span data-ttu-id="344a2-392">當按一下 [插入] 按鈕時，FormView 會繼續進行與 DetailsView 控制項相同的步驟順序，並將新的記錄加入 `Products` 資料表。</span><span class="sxs-lookup"><span data-stu-id="344a2-392">When the Insert button is clicked the FormView proceeds through the same sequence of steps as the DetailsView control, adding a new record to the `Products` table.</span></span> <span data-ttu-id="344a2-393">[圖 25] 顯示在已插入的 FormView 中的 Acme 咖啡產品詳細資料。</span><span class="sxs-lookup"><span data-stu-id="344a2-393">Figure 25 shows Acme Coffee product's details in the FormView after it has been inserted.</span></span>

<span data-ttu-id="344a2-394">[![InsertItemTemplate 規定 FormView 的插入介面](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image61.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image60.png)</span><span class="sxs-lookup"><span data-stu-id="344a2-394">[![The InsertItemTemplate Dictates the FormView's Inserting Interface](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image61.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image60.png)</span></span>

<span data-ttu-id="344a2-395">**圖 24**： `InsertItemTemplate` 規定 FormView 的插入介面（[按一下以觀看完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image62.png)）</span><span class="sxs-lookup"><span data-stu-id="344a2-395">**Figure 24**: The `InsertItemTemplate` Dictates the FormView's Inserting Interface ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image62.png))</span></span>

<span data-ttu-id="344a2-396">[![新產品的詳細資料（Acme 咖啡）會顯示在 FormView 中](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image64.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image63.png)</span><span class="sxs-lookup"><span data-stu-id="344a2-396">[![The Details for New Product, Acme Coffee, are Displayed in the FormView](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image64.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image63.png)</span></span>

<span data-ttu-id="344a2-397">**圖 25**：新產品的詳細資料（Acme 咖啡）會顯示在 FormView 中（[按一下以觀看完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image65.png)）</span><span class="sxs-lookup"><span data-stu-id="344a2-397">**Figure 25**: The Details for New Product, Acme Coffee, are Displayed in the FormView ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image65.png))</span></span>

<span data-ttu-id="344a2-398">藉由將唯讀、編輯和插入介面分成三個不同的範本，FormView 可讓您更精細地控制這些介面，而不是 DetailsView 和 GridView。</span><span class="sxs-lookup"><span data-stu-id="344a2-398">By separating out the read-only, editing, and inserting interfaces into three separate templates, the FormView allows for a finer degree of control over these interfaces than the DetailsView and GridView.</span></span>

> [!NOTE]
> <span data-ttu-id="344a2-399">就像 DetailsView 一樣，FormView 的 `CurrentMode` 屬性會指出所顯示的介面，而它的 `DefaultMode` 屬性則表示在完成編輯或插入之後，FormView 傳回的模式。</span><span class="sxs-lookup"><span data-stu-id="344a2-399">Like the DetailsView, the FormView's `CurrentMode` property indicates the interface being displayed and its `DefaultMode` property indicates the mode the FormView returns to after an edit or insert has been completed.</span></span>

## <a name="summary"></a><span data-ttu-id="344a2-400">總結</span><span class="sxs-lookup"><span data-stu-id="344a2-400">Summary</span></span>

<span data-ttu-id="344a2-401">在本教學課程中，我們探討了使用 GridView、DetailsView 和 FormView 來插入、編輯和刪除資料的基本概念。</span><span class="sxs-lookup"><span data-stu-id="344a2-401">In this tutorial we examined the basics of inserting, editing, and deleting data using the GridView, DetailsView, and FormView.</span></span> <span data-ttu-id="344a2-402">這三個控制項都提供某種層級的內建資料修改功能，而不必在 ASP.NET 網頁中撰寫任何一行程式碼，因為資料 Web 控制項和 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="344a2-402">All three of these controls provide some level of built-in data modification capabilities that can be utilized without writing a single line of code in the ASP.NET page thanks to the data Web controls and the ObjectDataSource.</span></span> <span data-ttu-id="344a2-403">不過，簡單的點和按一下技巧會轉譯一個相當 frail 且單純的資料修改使用者介面。</span><span class="sxs-lookup"><span data-stu-id="344a2-403">However, the simple point and click techniques render a fairly frail and naïve data modification user interface.</span></span> <span data-ttu-id="344a2-404">為了提供驗證、插入程式設計的值、適當地處理例外狀況、自訂使用者介面等等，我們必須依賴將在接下來的幾個教學課程中討論的技術系列。</span><span class="sxs-lookup"><span data-stu-id="344a2-404">To provide validation, inject programmatic values, gracefully handle exceptions, customize the user interface, and so on, we'll need to rely on a bevy of techniques that will be discussed over the next several tutorials.</span></span>

<span data-ttu-id="344a2-405">快樂的程式設計！</span><span class="sxs-lookup"><span data-stu-id="344a2-405">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="344a2-406">關於作者</span><span class="sxs-lookup"><span data-stu-id="344a2-406">About the Author</span></span>

<span data-ttu-id="344a2-407">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，自1998起，有七個 ASP/ASP. NET 書籍和創辦人的[4GuysFromRolla.com](http://www.4guysfromrolla.com)。</span><span class="sxs-lookup"><span data-stu-id="344a2-407">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="344a2-408">Scott 以獨立的顧問、訓練員和作者的身分運作。</span><span class="sxs-lookup"><span data-stu-id="344a2-408">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="344a2-409">他的最新著作是[*在24小時內讓自己的 ASP.NET 2.0*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="344a2-409">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="344a2-410">他可以在mitchell@4GuysFromRolla.com觸達[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="344a2-410">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="344a2-411">或者透過他的 blog，可以在[http://ScottOnWriting.NET](http://ScottOnWriting.NET)找到。</span><span class="sxs-lookup"><span data-stu-id="344a2-411">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="344a2-412">[上一頁](limiting-data-modification-functionality-based-on-the-user-cs.md)
> [下一頁](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)</span><span class="sxs-lookup"><span data-stu-id="344a2-412">[Previous](limiting-data-modification-functionality-based-on-the-user-cs.md)
[Next](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)</span></span>
