---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb
title: 將驗證控制項新增至編輯和插入介面（VB） |Microsoft Docs
author: rick-anderson
description: 在本教學課程中，我們將瞭解如何輕鬆地將驗證控制項新增至資料 Web 控制項的 EditItemTemplate 和 InsertItemTemplate，以提供更多 。
ms.author: riande
ms.date: 07/17/2006
ms.assetid: e3d7028a-7a22-4a4f-babe-d53afc41c0e2
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb
msc.type: authoredcontent
ms.openlocfilehash: 5c5ad110ee0836f0a464b02a2b29254e2e06381e
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/06/2020
ms.locfileid: "78592824"
---
# <a name="adding-validation-controls-to-the-editing-and-inserting-interfaces-vb"></a><span data-ttu-id="ffff8-103">將驗證控制項新增至編輯和插入介面 (VB)</span><span class="sxs-lookup"><span data-stu-id="ffff8-103">Adding Validation Controls to the Editing and Inserting Interfaces (VB)</span></span>

<span data-ttu-id="ffff8-104">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="ffff8-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="ffff8-105">[下載範例應用程式](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_19_VB.exe)或[下載 PDF](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/datatutorial19vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="ffff8-105">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_19_VB.exe) or [Download PDF](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/datatutorial19vb1.pdf)</span></span>

> <span data-ttu-id="ffff8-106">在本教學課程中，我們將瞭解如何輕鬆地將驗證控制項新增至資料 Web 控制項的 EditItemTemplate 和 InsertItemTemplate，以提供更可靠的使用者介面。</span><span class="sxs-lookup"><span data-stu-id="ffff8-106">In this tutorial we'll see how easy it is to add validation controls to the EditItemTemplate and InsertItemTemplate of a data Web control, to provide a more foolproof user interface.</span></span>

## <a name="introduction"></a><span data-ttu-id="ffff8-107">簡介</span><span class="sxs-lookup"><span data-stu-id="ffff8-107">Introduction</span></span>

<span data-ttu-id="ffff8-108">在過去三個教學課程中，我們所探討的範例中的 GridView 和 DetailsView 控制項全都是由 BoundFields 和 CheckBoxFields 所組成（在將 GridView 或 DetailsView 系結至資料來源時，Visual Studio 自動新增的欄位類型透過智慧標籤進行控制。</span><span class="sxs-lookup"><span data-stu-id="ffff8-108">The GridView and DetailsView controls in the examples we've explored over the past three tutorials have all been composed of BoundFields and CheckBoxFields (the field types automatically added by Visual Studio when binding a GridView or DetailsView to a data source control through the smart tag).</span></span> <span data-ttu-id="ffff8-109">編輯 GridView 或 DetailsView 中的資料列時，那些非唯讀的 BoundFields 會轉換成 textbox，使用者可以從該文字方塊修改現有的資料。</span><span class="sxs-lookup"><span data-stu-id="ffff8-109">When editing a row in a GridView or DetailsView, those BoundFields that are not read-only are converted into textboxes, from which the end user can modify the existing data.</span></span> <span data-ttu-id="ffff8-110">同樣地，將新記錄插入 DetailsView 控制項時，`InsertVisible` 屬性設為 `True` （預設值）的 BoundFields 會轉譯為空白文字方塊，使用者可以在其中提供新記錄的域值。</span><span class="sxs-lookup"><span data-stu-id="ffff8-110">Similarly, when inserting a new record into a DetailsView control, those BoundFields whose `InsertVisible` property is set to `True` (the default) are rendered as empty textboxes, into which the user can provide the new record's field values.</span></span> <span data-ttu-id="ffff8-111">同樣地，在「標準」、「唯讀」介面中停用的 CheckBoxFields 會在編輯和插入介面中轉換成已啟用的核取方塊。</span><span class="sxs-lookup"><span data-stu-id="ffff8-111">Likewise, CheckBoxFields, which are disabled in the standard, read-only interface, are converted into enabled checkboxes in the editing and inserting interfaces.</span></span>

<span data-ttu-id="ffff8-112">雖然 BoundField 和 CheckBoxField 的預設編輯和插入介面可能很有説明，但介面缺少任何類型的驗證。</span><span class="sxs-lookup"><span data-stu-id="ffff8-112">While the default editing and inserting interfaces for the BoundField and CheckBoxField can be helpful, the interface lacks any sort of validation.</span></span> <span data-ttu-id="ffff8-113">如果使用者輸入錯誤（例如省略 `ProductName` 欄位，或為 `UnitsInStock` 輸入不正確值（例如-50），則會從應用程式架構的深度中引發例外狀況。</span><span class="sxs-lookup"><span data-stu-id="ffff8-113">If a user makes a data entry mistake - such as omitting the `ProductName` field or entering an invalid value for `UnitsInStock` (such as -50) an exception will be raised from within the depths of the application architecture.</span></span> <span data-ttu-id="ffff8-114">雖然可以適當地處理這個例外狀況（如[前一個教學](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md)課程中所示），但在理想的情況下，編輯或插入使用者介面會包含驗證控制項，以防止使用者一開始就輸入這類不正確資料。</span><span class="sxs-lookup"><span data-stu-id="ffff8-114">While this exception can be gracefully handled as demonstrated in the [previous tutorial](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md), ideally the editing or inserting user interface would include validation controls to prevent a user from entering such invalid data in the first place.</span></span>

<span data-ttu-id="ffff8-115">為了提供自訂的編輯或插入介面，我們必須將 BoundField 或 CheckBoxField 取代為 TemplateField。</span><span class="sxs-lookup"><span data-stu-id="ffff8-115">In order to provide a customized editing or inserting interface, we need to replace the BoundField or CheckBoxField with a TemplateField.</span></span> <span data-ttu-id="ffff8-116">TemplateFields，這是在 GridView 控制項中[使用 TemplateFields](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md)和在 DetailsView 控制項教學課程中[使用 TemplateFields](../custom-formatting/using-templatefields-in-the-detailsview-control-vb.md)所討論的主題，可以包含多個範本，為不同的資料列狀態定義不同的介面。</span><span class="sxs-lookup"><span data-stu-id="ffff8-116">TemplateFields, which were the topic of discussion in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md) and [Using TemplateFields in the DetailsView Control](../custom-formatting/using-templatefields-in-the-detailsview-control-vb.md) tutorials, can consist of multiple templates defining separate interfaces for different row states.</span></span> <span data-ttu-id="ffff8-117">TemplateField 的 `ItemTemplate` 用於轉譯 DetailsView 或 GridView 控制項中的唯讀欄位或資料列時，而 `EditItemTemplate` 和 `InsertItemTemplate` 會分別指出用於編輯和插入模式的介面。</span><span class="sxs-lookup"><span data-stu-id="ffff8-117">The TemplateField's `ItemTemplate` is used to when rendering read-only fields or rows in the DetailsView or GridView controls, whereas the `EditItemTemplate` and `InsertItemTemplate` indicate the interfaces to use for the editing and inserting modes, respectively.</span></span>

<span data-ttu-id="ffff8-118">在本教學課程中，我們將瞭解如何輕鬆地將驗證控制項新增至 TemplateField 的 `EditItemTemplate`，並 `InsertItemTemplate` 以提供更可靠的使用者介面。</span><span class="sxs-lookup"><span data-stu-id="ffff8-118">In this tutorial we'll see how easy it is to add validation controls to the TemplateField's `EditItemTemplate` and `InsertItemTemplate` to provide a more foolproof user interface.</span></span> <span data-ttu-id="ffff8-119">具體來說，本教學課程會採用在[檢查與插入、更新和刪除教學課程相關聯的事件](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)中所建立的範例，並增強編輯和插入介面以包含適當的驗證。</span><span class="sxs-lookup"><span data-stu-id="ffff8-119">Specifically, this tutorial takes the example created in the [Examining the Events Associated with Inserting, Updating, and Deleting](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) tutorial and augments the editing and inserting interfaces to include appropriate validation.</span></span>

## <a name="step-1-replicating-the-example-fromexamining-the-events-associated-with-inserting-updating-and-deleting"></a><span data-ttu-id="ffff8-120">步驟1：複寫範例，[以檢查與插入、更新和刪除相關聯的事件](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)</span><span class="sxs-lookup"><span data-stu-id="ffff8-120">Step 1: Replicating the Example from[Examining the Events Associated with Inserting, Updating, and Deleting](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)</span></span>

<span data-ttu-id="ffff8-121">在[檢查與插入、更新和刪除教學課程相關聯的事件中，](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)我們建立了一個頁面，其中列出了可編輯 GridView 中產品的名稱和價格。</span><span class="sxs-lookup"><span data-stu-id="ffff8-121">In the [Examining the Events Associated with Inserting, Updating, and Deleting](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) tutorial we created a page that listed the names and prices of the products in an editable GridView.</span></span> <span data-ttu-id="ffff8-122">此外，此頁面包含一個 DetailsView，其 `DefaultMode` 屬性設定為 `Insert`，因此一律以插入模式呈現。</span><span class="sxs-lookup"><span data-stu-id="ffff8-122">Additionally, the page included a DetailsView whose `DefaultMode` property was set to `Insert`, thereby always rendering in insert mode.</span></span> <span data-ttu-id="ffff8-123">在此 DetailsView 中，使用者可以輸入新產品的名稱和價格，按一下 [插入]，並將它新增至系統（請參閱 [圖 1]）。</span><span class="sxs-lookup"><span data-stu-id="ffff8-123">From this DetailsView, the user could enter the name and price for a new product, click Insert, and have it added to the system (see Figure 1).</span></span>

<span data-ttu-id="ffff8-124">[![上一個範例可讓使用者新增新的產品，並編輯現有的產品](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image2.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="ffff8-124">[![The Previous Example Allows Users to Add New Products and Edit Existing Ones](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image2.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image1.png)</span></span>

<span data-ttu-id="ffff8-125">**圖 1**：先前的範例可讓使用者加入新產品並編輯現有的產品（[按一下以觀看完整大小的影像](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image3.png)）</span><span class="sxs-lookup"><span data-stu-id="ffff8-125">**Figure 1**: The Previous Example Allows Users to Add New Products and Edit Existing Ones ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image3.png))</span></span>

<span data-ttu-id="ffff8-126">本教學課程的目標是要加強 DetailsView 和 GridView，以提供驗證控制項。</span><span class="sxs-lookup"><span data-stu-id="ffff8-126">Our goal for this tutorial is to augment the DetailsView and GridView to provide validation controls.</span></span> <span data-ttu-id="ffff8-127">特別是，我們的驗證邏輯將會：</span><span class="sxs-lookup"><span data-stu-id="ffff8-127">In particular, our validation logic will:</span></span>

- <span data-ttu-id="ffff8-128">需要在插入或編輯產品時提供名稱</span><span class="sxs-lookup"><span data-stu-id="ffff8-128">Require that the name be provided when inserting or editing a product</span></span>
- <span data-ttu-id="ffff8-129">必須在插入記錄時提供價格;編輯記錄時，我們仍需要價格，但會使用在 GridView 的 `RowUpdating` 事件處理常式中，在先前的教學課程中已存在的程式設計邏輯。</span><span class="sxs-lookup"><span data-stu-id="ffff8-129">Require that the price be provided when inserting a record; when editing a record, we will still require a price, but will use the programmatic logic in the GridView's `RowUpdating` event handler already present from the earlier tutorial</span></span>
- <span data-ttu-id="ffff8-130">請確定為價格輸入的值是有效的貨幣格式</span><span class="sxs-lookup"><span data-stu-id="ffff8-130">Ensure that the value entered for the price is a valid currency format</span></span>

<span data-ttu-id="ffff8-131">我們必須先從 `DataModificationEvents.aspx` 頁面將範例複製到本教學課程的頁面，`UIValidation.aspx`，才能查看如何擴充前一個範例以包含驗證。</span><span class="sxs-lookup"><span data-stu-id="ffff8-131">Before we can look at augmenting the previous example to include validation, we first need to replicate the example from the `DataModificationEvents.aspx` page to the page for this tutorial, `UIValidation.aspx`.</span></span> <span data-ttu-id="ffff8-132">為了完成這項工作，我們必須同時複製 `DataModificationEvents.aspx` 頁面的宣告式標記和其原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="ffff8-132">To accomplish this we need to copy over both the `DataModificationEvents.aspx` page's declarative markup and its source code.</span></span> <span data-ttu-id="ffff8-133">請執行下列步驟，先複製宣告式標記：</span><span class="sxs-lookup"><span data-stu-id="ffff8-133">First copy over the declarative markup by performing the following steps:</span></span>

1. <span data-ttu-id="ffff8-134">在 Visual Studio 中開啟 [`DataModificationEvents.aspx`] 頁面</span><span class="sxs-lookup"><span data-stu-id="ffff8-134">Open the `DataModificationEvents.aspx` page in Visual Studio</span></span>
2. <span data-ttu-id="ffff8-135">移至頁面的宣告式標記（按一下頁面底部的 [來源] 按鈕）</span><span class="sxs-lookup"><span data-stu-id="ffff8-135">Go to the page's declarative markup (click on the Source button at the bottom of the page)</span></span>
3. <span data-ttu-id="ffff8-136">複製 `<asp:Content>` 內的文字，並 `</asp:Content>` 標記（第3到44行），如 [圖 2] 所示。</span><span class="sxs-lookup"><span data-stu-id="ffff8-136">Copy the text within the `<asp:Content>` and `</asp:Content>` tags (lines 3 through 44), as shown in Figure 2.</span></span>

<span data-ttu-id="ffff8-137">[![複製 &lt;asp： Content&gt; 控制項內的文字](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image5.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="ffff8-137">[![Copy the Text Within the &lt;asp:Content&gt; Control](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image5.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image4.png)</span></span>

<span data-ttu-id="ffff8-138">**圖 2**：複製 `<asp:Content>` 控制項內的文字（[按一下以查看完整大小的影像](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image6.png)）</span><span class="sxs-lookup"><span data-stu-id="ffff8-138">**Figure 2**: Copy the Text Within the `<asp:Content>` Control ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image6.png))</span></span>

1. <span data-ttu-id="ffff8-139">開啟 [`UIValidation.aspx`] 頁面</span><span class="sxs-lookup"><span data-stu-id="ffff8-139">Open the `UIValidation.aspx` page</span></span>
2. <span data-ttu-id="ffff8-140">移至頁面的宣告式標記</span><span class="sxs-lookup"><span data-stu-id="ffff8-140">Go to the page's declarative markup</span></span>
3. <span data-ttu-id="ffff8-141">貼上 `<asp:Content>` 控制項內的文字。</span><span class="sxs-lookup"><span data-stu-id="ffff8-141">Paste the text within the `<asp:Content>` control.</span></span>

<span data-ttu-id="ffff8-142">若要複製原始碼，請開啟 [`DataModificationEvents.aspx.vb`] 頁面，並只複製 `EditInsertDelete_DataModificationEvents` 類別*中*的文字。</span><span class="sxs-lookup"><span data-stu-id="ffff8-142">To copy over the source code, open the `DataModificationEvents.aspx.vb` page and copy just the text *within* the `EditInsertDelete_DataModificationEvents` class.</span></span> <span data-ttu-id="ffff8-143">複製三個事件處理常式（`Page_Load`、`GridView1_RowUpdating`和 `ObjectDataSource1_Inserting`），但不要**複製類別**宣告。</span><span class="sxs-lookup"><span data-stu-id="ffff8-143">Copy the three event handlers (`Page_Load`, `GridView1_RowUpdating`, and `ObjectDataSource1_Inserting`), but do **not** copy the class declaration.</span></span> <span data-ttu-id="ffff8-144">將複製的文字貼入 `UIValidation.aspx.vb`的 `EditInsertDelete_UIValidation`*類別中。*</span><span class="sxs-lookup"><span data-stu-id="ffff8-144">Paste the copied text *within* the `EditInsertDelete_UIValidation` class in `UIValidation.aspx.vb`.</span></span>

<span data-ttu-id="ffff8-145">將內容和程式碼從 `DataModificationEvents.aspx` 移至 `UIValidation.aspx`之後，請花點時間在瀏覽器中測試您的進度。</span><span class="sxs-lookup"><span data-stu-id="ffff8-145">After moving over the content and code from `DataModificationEvents.aspx` to `UIValidation.aspx`, take a moment to test out your progress in a browser.</span></span> <span data-ttu-id="ffff8-146">您應該會看到相同的輸出，並在這兩個頁面中體驗相同的功能（請參閱 [圖 1]，以取得 `DataModificationEvents.aspx` 動作的螢幕擷取畫面）。</span><span class="sxs-lookup"><span data-stu-id="ffff8-146">You should see the same output and experience the same functionality in each of these two pages (refer back to Figure 1 for a screen shot of `DataModificationEvents.aspx` in action).</span></span>

## <a name="step-2-converting-the-boundfields-into-templatefields"></a><span data-ttu-id="ffff8-147">步驟2：將 BoundFields 轉換成 TemplateFields</span><span class="sxs-lookup"><span data-stu-id="ffff8-147">Step 2: Converting the BoundFields Into TemplateFields</span></span>

<span data-ttu-id="ffff8-148">若要將驗證控制項新增至編輯和插入介面，DetailsView 和 GridView 控制項所使用的 BoundFields 必須轉換成 TemplateFields。</span><span class="sxs-lookup"><span data-stu-id="ffff8-148">To add validation controls to the editing and inserting interfaces, the BoundFields used by the DetailsView and GridView controls need to be converted into TemplateFields.</span></span> <span data-ttu-id="ffff8-149">若要達成此目的，請分別按一下 GridView 和 DetailsView 的智慧標籤中的 [編輯資料行] 和 [編輯欄位] 連結。</span><span class="sxs-lookup"><span data-stu-id="ffff8-149">To achieve this, click on the Edit Columns and Edit Fields links in the GridView and DetailsView's smart tags, respectively.</span></span> <span data-ttu-id="ffff8-150">在那裡選取每個 BoundFields，然後按一下 [將此欄位轉換成 TemplateField] 連結。</span><span class="sxs-lookup"><span data-stu-id="ffff8-150">There, select each of the BoundFields and click the "Convert this field into a TemplateField" link.</span></span>

<span data-ttu-id="ffff8-151">[![將每個 DetailsView 和 GridView 的 BoundFields 轉換成 TemplateFields](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image8.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="ffff8-151">[![Convert Each of the DetailsView's and GridView's BoundFields Into TemplateFields](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image8.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image7.png)</span></span>

<span data-ttu-id="ffff8-152">**圖 3**：將每個 DetailsView 和 GridView 的 BoundFields 轉換成 TemplateFields （[按一下以觀看完整大小的影像](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image9.png)）</span><span class="sxs-lookup"><span data-stu-id="ffff8-152">**Figure 3**: Convert Each of the DetailsView's and GridView's BoundFields Into TemplateFields ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image9.png))</span></span>

<span data-ttu-id="ffff8-153">透過 [欄位] 對話方塊將 BoundField 轉換成 TemplateField 時，會產生 TemplateField，使其呈現與 BoundField 本身相同的唯讀、編輯和插入介面。</span><span class="sxs-lookup"><span data-stu-id="ffff8-153">Converting a BoundField into a TemplateField through the Fields dialog box generates a TemplateField that exhibits the same read-only, editing, and inserting interfaces as the BoundField itself.</span></span> <span data-ttu-id="ffff8-154">下列標記會顯示在 DetailsView 轉換成 TemplateField 後，會將 [`ProductName`] 欄位的宣告式語法：</span><span class="sxs-lookup"><span data-stu-id="ffff8-154">The following markup shows the declarative syntax for the `ProductName` field in the DetailsView after it has been converted into a TemplateField:</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/samples/sample1.aspx)]

<span data-ttu-id="ffff8-155">請注意，此 TemplateField 會自動建立三個範本 `ItemTemplate`、`EditItemTemplate`和 `InsertItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="ffff8-155">Note that this TemplateField had three templates automatically created `ItemTemplate`, `EditItemTemplate`, and `InsertItemTemplate`.</span></span> <span data-ttu-id="ffff8-156">`ItemTemplate` 會使用標籤 Web 控制項顯示單一資料欄值（`ProductName`），而 `EditItemTemplate` 和 `InsertItemTemplate` 會在 TextBox Web 控制項中呈現資料欄位值，而該文字方塊會使用雙向資料系結將資料欄位與文字方塊的 `Text` 屬性產生關聯。</span><span class="sxs-lookup"><span data-stu-id="ffff8-156">The `ItemTemplate` displays a single data field value (`ProductName`) using a Label Web control, while the `EditItemTemplate` and `InsertItemTemplate` present the data field value in a TextBox Web control that associates the data field with the TextBox's `Text` property using two-way databinding.</span></span> <span data-ttu-id="ffff8-157">因為我們只會在此頁面中使用 DetailsView 進行插入，所以您可以從這兩個 TemplateFields 中移除 `ItemTemplate` 和 `EditItemTemplate`，但不會對其留下傷害。</span><span class="sxs-lookup"><span data-stu-id="ffff8-157">Since we are only using the DetailsView in this page for inserting, you may remove the `ItemTemplate` and `EditItemTemplate` from the two TemplateFields, although there's no harm in leaving them.</span></span>

<span data-ttu-id="ffff8-158">由於 GridView 不支援 DetailsView 的內建插入功能，因此將 GridView 的 `ProductName` 欄位轉換成 TemplateField 只會產生 `ItemTemplate` 和 `EditItemTemplate`：</span><span class="sxs-lookup"><span data-stu-id="ffff8-158">Since the GridView does not support the built-in inserting features of the DetailsView, converting the GridView's `ProductName` field into a TemplateField results in only an `ItemTemplate` and `EditItemTemplate`:</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/samples/sample2.aspx)]

<span data-ttu-id="ffff8-159">藉由按一下 [將此欄位轉換成 TemplateField]，Visual Studio 已建立 TemplateField，其範本會模擬已轉換之 BoundField 的使用者介面。</span><span class="sxs-lookup"><span data-stu-id="ffff8-159">By clicking the "Convert this field into a TemplateField," Visual Studio has created a TemplateField whose templates mimic the user interface of the converted BoundField.</span></span> <span data-ttu-id="ffff8-160">您可以透過瀏覽器造訪此頁面來確認這一點。</span><span class="sxs-lookup"><span data-stu-id="ffff8-160">You can verify this by visiting this page through a browser.</span></span> <span data-ttu-id="ffff8-161">您會發現 TemplateFields 的外觀和行為與改用 BoundFields 時的體驗相同。</span><span class="sxs-lookup"><span data-stu-id="ffff8-161">You'll find that the appearance and behavior of the TemplateFields is identical to the experience when BoundFields were used instead.</span></span>

> [!NOTE]
> <span data-ttu-id="ffff8-162">您可以視需要自訂範本中的編輯介面。</span><span class="sxs-lookup"><span data-stu-id="ffff8-162">Feel free to customize the editing interfaces in the templates as needed.</span></span> <span data-ttu-id="ffff8-163">例如，我們可能會想要將 [`UnitPrice`] TemplateFields 中的文字方塊轉譯成小於 [`ProductName`] 文字方塊的文字方塊。</span><span class="sxs-lookup"><span data-stu-id="ffff8-163">For example, we may want to have the TextBox in the `UnitPrice` TemplateFields rendered as a smaller textbox than the `ProductName` textbox.</span></span> <span data-ttu-id="ffff8-164">若要完成此動作，您可以將 TextBox 的 `Columns` 屬性設定為適當的值，或透過 `Width` 屬性提供絕對寬度。</span><span class="sxs-lookup"><span data-stu-id="ffff8-164">To accomplish this you can set the TextBox's `Columns` property to an appropriate value or provide an absolute width via the `Width` property.</span></span> <span data-ttu-id="ffff8-165">在下一個教學課程中，我們將瞭解如何藉由使用替代資料項目 Web 控制項來取代 TextBox，以完全自訂編輯介面。</span><span class="sxs-lookup"><span data-stu-id="ffff8-165">In the next tutorial we'll see how to completely customize the editing interface by replacing the TextBox with an alternate data entry Web control.</span></span>

## <a name="step-3-adding-the-validation-controls-to-the-gridviewsedititemtemplate-s"></a><span data-ttu-id="ffff8-166">步驟3：將驗證控制項新增至 GridView 的`EditItemTemplate` s</span><span class="sxs-lookup"><span data-stu-id="ffff8-166">Step 3: Adding the Validation Controls to the GridView's`EditItemTemplate` s</span></span>

<span data-ttu-id="ffff8-167">在建立資料輸入表單時，使用者必須輸入任何必要的欄位，而且所有提供的輸入都是合法且格式正確的值。</span><span class="sxs-lookup"><span data-stu-id="ffff8-167">When constructing data entry forms, it is important that users enter any required fields and that all provided inputs are legal, properly-formatted values.</span></span> <span data-ttu-id="ffff8-168">為了協助確保使用者的輸入有效，ASP.NET 提供五個內建的驗證控制項，設計用來驗證單一輸入控制項的值：</span><span class="sxs-lookup"><span data-stu-id="ffff8-168">To help ensure that a user's inputs are valid, ASP.NET provides five built-in validation controls that are designed to be used to validate the value of a single input control:</span></span>

- <span data-ttu-id="ffff8-169">[RequiredFieldValidator](https://msdn.microsoft.com/library/5hbw267h(VS.80).aspx)可確保已提供值</span><span class="sxs-lookup"><span data-stu-id="ffff8-169">[RequiredFieldValidator](https://msdn.microsoft.com/library/5hbw267h(VS.80).aspx) ensures that a value has been provided</span></span>
- <span data-ttu-id="ffff8-170">[CompareValidator](https://msdn.microsoft.com/library/db330ayw(VS.80).aspx)會根據另一個 Web 控制值或常數值來驗證值，或確保值的格式對於指定的資料類型是合法的</span><span class="sxs-lookup"><span data-stu-id="ffff8-170">[CompareValidator](https://msdn.microsoft.com/library/db330ayw(VS.80).aspx) validates a value against another Web control value or a constant value, or ensures that the value's format is legal for a specified data type</span></span>
- <span data-ttu-id="ffff8-171">[RangeValidator](https://msdn.microsoft.com/library/f70d09xt.aspx)可確保值在值的範圍內</span><span class="sxs-lookup"><span data-stu-id="ffff8-171">[RangeValidator](https://msdn.microsoft.com/library/f70d09xt.aspx) ensures that a value is within a range of values</span></span>
- <span data-ttu-id="ffff8-172">[RegularExpressionValidator](https://msdn.microsoft.com/library/eahwtc9e.aspx)會根據[正則運算式](http://en.wikipedia.org/wiki/Regular_expression)來驗證值</span><span class="sxs-lookup"><span data-stu-id="ffff8-172">[RegularExpressionValidator](https://msdn.microsoft.com/library/eahwtc9e.aspx) validates a value against a [regular expression](http://en.wikipedia.org/wiki/Regular_expression)</span></span>
- <span data-ttu-id="ffff8-173">[CustomValidator](https://msdn.microsoft.com/library/9eee01cx(VS.80).aspx)會根據自訂的使用者定義方法來驗證值</span><span class="sxs-lookup"><span data-stu-id="ffff8-173">[CustomValidator](https://msdn.microsoft.com/library/9eee01cx(VS.80).aspx) validates a value against a custom, user-defined method</span></span>

<span data-ttu-id="ffff8-174">如需這五個控制項的詳細資訊，請參閱[ASP.NET 快速入門教學](https://asp.net/QuickStart/aspnet/)課程的[驗證控制項一節](https://quickstarts.asp.net/quickstartv20/aspnet/doc/ctrlref/validation/default.aspx)。</span><span class="sxs-lookup"><span data-stu-id="ffff8-174">For more information on these five controls, check out the [Validation Controls section](https://quickstarts.asp.net/quickstartv20/aspnet/doc/ctrlref/validation/default.aspx) of the [ASP.NET Quickstart Tutorials](https://asp.net/QuickStart/aspnet/).</span></span>

<span data-ttu-id="ffff8-175">在本教學課程中，我們將需要在 DetailsView 和 GridView 的 `ProductName` TemplateFields 中使用 RequiredFieldValidator，並在 DetailsView 的 `UnitPrice` TemplateField 中使用 RequiredFieldValidator。</span><span class="sxs-lookup"><span data-stu-id="ffff8-175">For our tutorial we'll need to use a RequiredFieldValidator in both the DetailsView and GridView's `ProductName` TemplateFields and a RequiredFieldValidator in the DetailsView's `UnitPrice` TemplateField.</span></span> <span data-ttu-id="ffff8-176">此外，我們還需要將 CompareValidator 新增至兩個控制項的 `UnitPrice` TemplateFields，以確保輸入的價格具有大於或等於0的值，且會以有效的貨幣格式呈現。</span><span class="sxs-lookup"><span data-stu-id="ffff8-176">Furthermore, we'll need to add a CompareValidator to both controls' `UnitPrice` TemplateFields that ensures that the entered price has a value greater than or equal to 0 and is presented in a valid currency format.</span></span>

> [!NOTE]
> <span data-ttu-id="ffff8-177">雖然 ASP.NET 1.x 具有這五個相同的驗證控制項，但 ASP.NET 2.0 已新增一些改良功能，主要兩個則是針對 Internet Explorer 以外的瀏覽器提供用戶端腳本支援，而且能夠將頁面上的驗證控制項分割成驗證群組。</span><span class="sxs-lookup"><span data-stu-id="ffff8-177">While ASP.NET 1.x had these same five validation controls, ASP.NET 2.0 has added a number of improvements, the main two being client-side script support for browsers other than Internet Explorer and the ability to partition validation controls on a page into validation groups.</span></span> <span data-ttu-id="ffff8-178">如需2.0 中新驗證控制功能的詳細資訊，請參閱[剖析 the ASP.NET 2.0 中的驗證控制項](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx)。</span><span class="sxs-lookup"><span data-stu-id="ffff8-178">For more information on the new validation control features in 2.0, refer to [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx).</span></span>

<span data-ttu-id="ffff8-179">讓我們從將必要的驗證控制項新增至 GridView TemplateFields 中的 `EditItemTemplate` 開始。</span><span class="sxs-lookup"><span data-stu-id="ffff8-179">Let's start by adding the necessary validation controls to the `EditItemTemplate` s in the GridView's TemplateFields.</span></span> <span data-ttu-id="ffff8-180">若要完成此動作，請按一下 GridView 智慧標籤中的 [編輯範本] 連結，以顯示範本編輯介面。</span><span class="sxs-lookup"><span data-stu-id="ffff8-180">To accomplish this, click on the Edit Templates link from the GridView's smart tag to bring up the template editing interface.</span></span> <span data-ttu-id="ffff8-181">從這裡，您可以從下拉式清單中選取要編輯的範本。</span><span class="sxs-lookup"><span data-stu-id="ffff8-181">From here, you can select which template to edit from the drop-down list.</span></span> <span data-ttu-id="ffff8-182">因為我們想要增強編輯介面，所以我們需要將驗證控制項新增至 `ProductName` 和 `UnitPrice`的 `EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="ffff8-182">Since we want to augment the editing interface, we need to add validation controls to the `ProductName` and `UnitPrice`'s `EditItemTemplate` s.</span></span>

<span data-ttu-id="ffff8-183">[![我們需要擴充 ProductName 和單價的 EditItemTemplates](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image11.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="ffff8-183">[![We Need to Extend the ProductName and UnitPrice's EditItemTemplates](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image11.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image10.png)</span></span>

<span data-ttu-id="ffff8-184">**圖 4**：我們需要擴充 `ProductName` 和 `UnitPrice`的 `EditItemTemplate` （[按一下以觀看完整大小的影像](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image12.png)）</span><span class="sxs-lookup"><span data-stu-id="ffff8-184">**Figure 4**: We Need to Extend the `ProductName` and `UnitPrice`'s `EditItemTemplate` s ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image12.png))</span></span>

<span data-ttu-id="ffff8-185">在 [`ProductName`] `EditItemTemplate`中，將 RequiredFieldValidator 從 [工具箱] 拖曳至範本編輯介面，並放在文字方塊後面，以新增一個。</span><span class="sxs-lookup"><span data-stu-id="ffff8-185">In the `ProductName` `EditItemTemplate`, add a RequiredFieldValidator by dragging it from the Toolbox into the template editing interface, placing after the TextBox.</span></span>

<span data-ttu-id="ffff8-186">[![將 RequiredFieldValidator 新增至 ProductName EditItemTemplate](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image14.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="ffff8-186">[![Add a RequiredFieldValidator to the ProductName EditItemTemplate](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image14.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image13.png)</span></span>

<span data-ttu-id="ffff8-187">**圖 5**：將 RequiredFieldValidator 新增至 `ProductName` `EditItemTemplate` （[按一下以查看完整大小的影像](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image15.png)）</span><span class="sxs-lookup"><span data-stu-id="ffff8-187">**Figure 5**: Add a RequiredFieldValidator to the `ProductName` `EditItemTemplate` ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image15.png))</span></span>

<span data-ttu-id="ffff8-188">所有驗證控制項都可以藉由驗證單一 ASP.NET Web 控制項的輸入來執行。</span><span class="sxs-lookup"><span data-stu-id="ffff8-188">All validation controls work by validating the input of a single ASP.NET Web control.</span></span> <span data-ttu-id="ffff8-189">因此，我們必須指出剛才新增的 RequiredFieldValidator 應該針對 `EditItemTemplate`中的 TextBox 進行驗證;將驗證控制項的[ControlToValidate 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.controltovalidate(VS.80).aspx)設定為適當 Web 控制項的 `ID`，即可完成這項作業。</span><span class="sxs-lookup"><span data-stu-id="ffff8-189">Therefore, we need to indicate that the RequiredFieldValidator we just added should validate against the TextBox in the `EditItemTemplate`; this is accomplished by setting the validation control's [ControlToValidate property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.controltovalidate(VS.80).aspx) to the `ID` of the appropriate Web control.</span></span> <span data-ttu-id="ffff8-190">文字方塊目前有 `TextBox1`的 nondescript `ID`，但讓我們將其變更為更適當的專案。</span><span class="sxs-lookup"><span data-stu-id="ffff8-190">The TextBox currently has the rather nondescript `ID` of `TextBox1`, but let's change it to something more appropriate.</span></span> <span data-ttu-id="ffff8-191">按一下範本中的文字方塊，然後從 屬性視窗中，將 `ID` 從 `TextBox1` 變更為 `EditProductName`。</span><span class="sxs-lookup"><span data-stu-id="ffff8-191">Click on the TextBox in the template and then, from the Properties window, change the `ID` from `TextBox1` to `EditProductName`.</span></span>

<span data-ttu-id="ffff8-192">[![將文字方塊的識別碼變更為 EditProductName](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image17.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="ffff8-192">[![Change the TextBox's ID to EditProductName](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image17.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image16.png)</span></span>

<span data-ttu-id="ffff8-193">**圖 6**：將文字方塊的 `ID` 變更為 `EditProductName` （[按一下以查看完整大小的影像](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image18.png)）</span><span class="sxs-lookup"><span data-stu-id="ffff8-193">**Figure 6**: Change the TextBox's `ID` to `EditProductName` ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image18.png))</span></span>

<span data-ttu-id="ffff8-194">接下來，將 RequiredFieldValidator 的 `ControlToValidate` 屬性設定為 `EditProductName`。</span><span class="sxs-lookup"><span data-stu-id="ffff8-194">Next, set the RequiredFieldValidator's `ControlToValidate` property to `EditProductName`.</span></span> <span data-ttu-id="ffff8-195">最後，將 [ [ErrorMessage] 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.errormessage(VS.80).aspx)設為 [您必須提供產品的名稱] 和 [ [Text] 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.text(VS.80).aspx)設定為 [\*]。</span><span class="sxs-lookup"><span data-stu-id="ffff8-195">Finally, set the [ErrorMessage property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.errormessage(VS.80).aspx) to "You must provide the product's name" and the [Text property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.text(VS.80).aspx) to "\*".</span></span> <span data-ttu-id="ffff8-196">如果有提供 `Text` 屬性值，就是驗證控制項在驗證失敗時所顯示的文字。</span><span class="sxs-lookup"><span data-stu-id="ffff8-196">The `Text` property value, if provided, is the text that is displayed by the validation control if the validation fails.</span></span> <span data-ttu-id="ffff8-197">ValidationSummary 控制項會使用所需的 `ErrorMessage` 屬性值;如果省略 `Text` 屬性值，則 `ErrorMessage` 屬性值也會是驗證控制項在無效輸入時顯示的文字。</span><span class="sxs-lookup"><span data-stu-id="ffff8-197">The `ErrorMessage` property value, which is required, is used by the ValidationSummary control; if the `Text` property value is omitted, the `ErrorMessage` property value is also the text displayed by the validation control on invalid input.</span></span>

<span data-ttu-id="ffff8-198">設定 RequiredFieldValidator 的這三個屬性之後，您的畫面看起來應該像 [圖 7]。</span><span class="sxs-lookup"><span data-stu-id="ffff8-198">After setting these three properties of the RequiredFieldValidator, your screen should look similar to Figure 7.</span></span>

<span data-ttu-id="ffff8-199">[![設定 RequiredFieldValidator 的 ControlToValidate、ErrorMessage 和 Text 屬性](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image20.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="ffff8-199">[![Set the RequiredFieldValidator's ControlToValidate, ErrorMessage, and Text Properties](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image20.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image19.png)</span></span>

<span data-ttu-id="ffff8-200">**圖 7**：設定 RequiredFieldValidator 的 `ControlToValidate`、`ErrorMessage`和 `Text` 屬性（[按一下以查看完整大小的影像](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image21.png)）</span><span class="sxs-lookup"><span data-stu-id="ffff8-200">**Figure 7**: Set the RequiredFieldValidator's `ControlToValidate`, `ErrorMessage`, and `Text` Properties ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image21.png))</span></span>

<span data-ttu-id="ffff8-201">將 RequiredFieldValidator 新增至 `ProductName` `EditItemTemplate`後，剩下的工作就是將必要的驗證新增至 `UnitPrice` `EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="ffff8-201">With the RequiredFieldValidator added to the `ProductName` `EditItemTemplate`, all that remains is to add the necessary validation to the `UnitPrice` `EditItemTemplate`.</span></span> <span data-ttu-id="ffff8-202">因為我們已決定在編輯記錄時，`UnitPrice` 是選擇性的，所以我們不需要新增 RequiredFieldValidator。</span><span class="sxs-lookup"><span data-stu-id="ffff8-202">Since we've decided that, for this page, the `UnitPrice` is optional when editing a record, we don't need to add a RequiredFieldValidator.</span></span> <span data-ttu-id="ffff8-203">不過，我們需要新增 CompareValidator，以確保 `UnitPrice`（如有提供）會正確地格式化為貨幣且大於或等於0。</span><span class="sxs-lookup"><span data-stu-id="ffff8-203">We do, however, need to add a CompareValidator to ensure that the `UnitPrice`, if supplied, is properly formatted as a currency and is greater than or equal to 0.</span></span>

<span data-ttu-id="ffff8-204">將 CompareValidator 新增至 `UnitPrice` `EditItemTemplate`之前，讓我們先將 TextBox Web 控制項的識別碼從 `TextBox2` 變更為 `EditUnitPrice`。</span><span class="sxs-lookup"><span data-stu-id="ffff8-204">Before we add the CompareValidator to the `UnitPrice` `EditItemTemplate`, let's first change the TextBox Web control's ID from `TextBox2` to `EditUnitPrice`.</span></span> <span data-ttu-id="ffff8-205">進行這種變更之後，請新增 CompareValidator，將其 `ControlToValidate` 屬性設為 `EditUnitPrice`，其 `ErrorMessage` 屬性設為「價格必須大於或等於零，而且不能包含貨幣符號」和其 `Text` 屬性設為 "\*"。</span><span class="sxs-lookup"><span data-stu-id="ffff8-205">After making this change, add the CompareValidator, setting its `ControlToValidate` property to `EditUnitPrice`, its `ErrorMessage` property to "The price must be greater than or equal to zero and cannot include the currency symbol", and its `Text` property to "\*".</span></span>

<span data-ttu-id="ffff8-206">若要指出 `UnitPrice` 值必須大於或等於0，請將 CompareValidator 的[Operator 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.operator(VS.80).aspx)設為 `GreaterThanEqual`、其[ValueToCompare 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.valuetocompare(VS.80).aspx)設定為 "0"，並將其[Type 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basecomparevalidator.type.aspx)設定為 `Currency`。</span><span class="sxs-lookup"><span data-stu-id="ffff8-206">To indicate that the `UnitPrice` value must be greater than or equal to 0, set the CompareValidator's [Operator property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.operator(VS.80).aspx) to `GreaterThanEqual`, its [ValueToCompare property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.valuetocompare(VS.80).aspx) to "0", and its [Type property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basecomparevalidator.type.aspx) to `Currency`.</span></span> <span data-ttu-id="ffff8-207">下列宣告式語法會顯示在進行這些變更之後，`UnitPrice` TemplateField 的 `EditItemTemplate`：</span><span class="sxs-lookup"><span data-stu-id="ffff8-207">The following declarative syntax shows the `UnitPrice` TemplateField's `EditItemTemplate` after these changes have been made:</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/samples/sample3.aspx)]

<span data-ttu-id="ffff8-208">進行這些變更之後，請在瀏覽器中開啟頁面。</span><span class="sxs-lookup"><span data-stu-id="ffff8-208">After making these changes, open the page in a browser.</span></span> <span data-ttu-id="ffff8-209">如果您嘗試在編輯產品時省略名稱或輸入不正確價格值，則文字方塊旁會出現星號。</span><span class="sxs-lookup"><span data-stu-id="ffff8-209">If you attempt to omit the name or enter an invalid price value when editing a product, an asterisk appears next to the textbox.</span></span> <span data-ttu-id="ffff8-210">如 [圖 8] 所示，包含貨幣符號（例如 $19.95）的價格值會被視為無效。</span><span class="sxs-lookup"><span data-stu-id="ffff8-210">As Figure 8 shows, a price value that includes the currency symbol such as $19.95 is considered invalid.</span></span> <span data-ttu-id="ffff8-211">CompareValidator 的 `Currency` `Type` 允許數位分隔符號（例如逗號或句號，視文化特性設定而定）和前置加號或負號，但*不允許貨幣*符號。</span><span class="sxs-lookup"><span data-stu-id="ffff8-211">The CompareValidator's `Currency` `Type` allows for digit separators (such as commas or periods, depending on the culture settings) and a leading plus or minus sign, but does *not* permit a currency symbol.</span></span> <span data-ttu-id="ffff8-212">這種行為可能會 perplex 使用者，因為編輯介面目前使用貨幣格式呈現 `UnitPrice`。</span><span class="sxs-lookup"><span data-stu-id="ffff8-212">This behavior may perplex users as the editing interface currently renders the `UnitPrice` using the currency format.</span></span>

> [!NOTE]
> <span data-ttu-id="ffff8-213">回想一下，在*與插入、更新和刪除教學課程相關聯的事件*中，我們將 BoundField 的 `DataFormatString` 屬性設定為 `{0:c}`，以便將它格式化為貨幣。</span><span class="sxs-lookup"><span data-stu-id="ffff8-213">Recall that in the *Events Associated with Inserting, Updating, and Deleting* tutorial we set the BoundField's `DataFormatString` property to `{0:c}` in order to format it as a currency.</span></span> <span data-ttu-id="ffff8-214">此外，我們會將 [`ApplyFormatInEditMode`] 屬性設為 [true]，使 GridView 的編輯介面將 `UnitPrice` 格式化為貨幣。</span><span class="sxs-lookup"><span data-stu-id="ffff8-214">Furthermore, we set the `ApplyFormatInEditMode` property to true, causing the GridView's editing interface to format the `UnitPrice` as a currency.</span></span> <span data-ttu-id="ffff8-215">將 BoundField 轉換成 TemplateField 時，Visual Studio 記下這些設定，並使用資料系結語法 `<%# Bind("UnitPrice", "{0:c}") %>`，將 TextBox 的 `Text` 屬性格式化為貨幣。</span><span class="sxs-lookup"><span data-stu-id="ffff8-215">When converting the BoundField into a TemplateField, Visual Studio noted these settings and formatted the TextBox's `Text` property as a currency using the databinding syntax `<%# Bind("UnitPrice", "{0:c}") %>`.</span></span>

<span data-ttu-id="ffff8-216">[![星號會出現在具有無效輸入的文字方塊旁邊](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image23.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="ffff8-216">[![An Asterisk Appears Next to the Textboxes with Invalid Input](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image23.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image22.png)</span></span>

<span data-ttu-id="ffff8-217">**圖 8**：具有無效輸入的文字方塊旁邊會出現星號（[按一下以觀看完整大小的影像](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image24.png)）</span><span class="sxs-lookup"><span data-stu-id="ffff8-217">**Figure 8**: An Asterisk Appears Next to the Textboxes with Invalid Input ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image24.png))</span></span>

<span data-ttu-id="ffff8-218">雖然驗證的運作方式不盡相同，但在編輯記錄時，使用者必須手動移除貨幣符號，這是無法接受的。</span><span class="sxs-lookup"><span data-stu-id="ffff8-218">While the validation works as-is, the user has to manually remove the currency symbol when editing a record, which is not acceptable.</span></span> <span data-ttu-id="ffff8-219">若要解決此問題，我們有三個選項：</span><span class="sxs-lookup"><span data-stu-id="ffff8-219">To remedy this, we have three options:</span></span>

1. <span data-ttu-id="ffff8-220">設定 `EditItemTemplate`，讓 `UnitPrice` 值不會格式化為貨幣。</span><span class="sxs-lookup"><span data-stu-id="ffff8-220">Configure the `EditItemTemplate` so that the `UnitPrice` value is not formatted as a currency.</span></span>
2. <span data-ttu-id="ffff8-221">允許使用者藉由移除 CompareValidator，並將其取代為正確檢查正確格式貨幣值的 RegularExpressionValidator，來輸入貨幣符號。</span><span class="sxs-lookup"><span data-stu-id="ffff8-221">Allow the user to enter a currency symbol by removing the CompareValidator and replacing it with a RegularExpressionValidator that properly checks for a properly formatted currency value.</span></span> <span data-ttu-id="ffff8-222">這裡的問題在於，驗證貨幣值的正則運算式並不是很棒，如果我們想要納入文化特性設定，則需要撰寫程式碼。</span><span class="sxs-lookup"><span data-stu-id="ffff8-222">The problem here is that the regular expression to validate a currency value is not pretty and would require writing code if we wanted to incorporate culture settings.</span></span>
3. <span data-ttu-id="ffff8-223">完全移除驗證控制項，並依賴 GridView 的 `RowUpdating` 事件處理常式中的伺服器端驗證邏輯。</span><span class="sxs-lookup"><span data-stu-id="ffff8-223">Remove the validation control altogether and rely on server-side validation logic in the GridView's `RowUpdating` event handler.</span></span>

<span data-ttu-id="ffff8-224">讓我們在此練習中使用選項 #1。</span><span class="sxs-lookup"><span data-stu-id="ffff8-224">Let's go with option #1 for this exercise.</span></span> <span data-ttu-id="ffff8-225">由於 `EditItemTemplate`： `<%# Bind("UnitPrice", "{0:c}") %>`中 TextBox 的資料系結運算式，因此目前 `UnitPrice` 會格式化為貨幣。</span><span class="sxs-lookup"><span data-stu-id="ffff8-225">Currently the `UnitPrice` is formatted as a currency due to the databinding expression for the TextBox in the `EditItemTemplate`: `<%# Bind("UnitPrice", "{0:c}") %>`.</span></span> <span data-ttu-id="ffff8-226">將 Bind 語句變更為 `Bind("UnitPrice", "{0:n2}")`，將結果格式化為具有兩位數精確度的數位。</span><span class="sxs-lookup"><span data-stu-id="ffff8-226">Change the Bind statement to `Bind("UnitPrice", "{0:n2}")`, which formats the result as a number with two digits of precision.</span></span> <span data-ttu-id="ffff8-227">這可以直接透過宣告式語法來完成，或從 `UnitPrice` TemplateField 的 `EditItemTemplate` 中的 [`EditUnitPrice`] 文字方塊中按一下 [編輯資料系結] 連結（請參閱 [圖 9] 和 [10]）。</span><span class="sxs-lookup"><span data-stu-id="ffff8-227">This can be done directly through the declarative syntax or by clicking on the Edit DataBindings link from the `EditUnitPrice` TextBox in the `UnitPrice` TemplateField's `EditItemTemplate` (see Figures 9 and 10).</span></span>

<span data-ttu-id="ffff8-228">[![按一下文字方塊的 [編輯系結] 連結](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image26.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="ffff8-228">[![Click on the TextBox's Edit DataBindings link](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image26.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image25.png)</span></span>

<span data-ttu-id="ffff8-229">**圖 9**：按一下文字方塊的 [編輯系結] 連結（[按一下以查看完整大小的影像](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image27.png)）</span><span class="sxs-lookup"><span data-stu-id="ffff8-229">**Figure 9**: Click on the TextBox's Edit DataBindings link ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image27.png))</span></span>

<span data-ttu-id="ffff8-230">[![在 Bind 語句中指定格式規範](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image29.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="ffff8-230">[![Specify the Format Specifier in the Bind Statement](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image29.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image28.png)</span></span>

<span data-ttu-id="ffff8-231">**圖 10**：在 `Bind` 語句中指定格式規範（[按一下以查看完整大小的影像](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image30.png)）</span><span class="sxs-lookup"><span data-stu-id="ffff8-231">**Figure 10**: Specify the Format Specifier in the `Bind` Statement ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image30.png))</span></span>

<span data-ttu-id="ffff8-232">透過這項變更，編輯介面中的格式化價格包括逗號做為群組分隔符號，並將句點當做小數分隔符號，但會保留貨幣符號。</span><span class="sxs-lookup"><span data-stu-id="ffff8-232">With this change, the formatted price in the editing interface includes commas as the group separator and a period as the decimal separator, but leaves off the currency symbol.</span></span>

> [!NOTE]
> <span data-ttu-id="ffff8-233">`UnitPrice` `EditItemTemplate` 不包含 RequiredFieldValidator，允許回傳至控制發生和更新邏輯開始。</span><span class="sxs-lookup"><span data-stu-id="ffff8-233">The `UnitPrice` `EditItemTemplate` doesn't include a RequiredFieldValidator, allowing the postback to ensue and the updating logic to commence.</span></span> <span data-ttu-id="ffff8-234">不過，從*檢查與插入、更新和刪除*教學課程關聯的事件中複製的 `RowUpdating` 事件處理常式，包含可確保已提供 `UnitPrice` 的程式設計檢查。</span><span class="sxs-lookup"><span data-stu-id="ffff8-234">However, the `RowUpdating` event handler copied over from the *Examining the Events Associated with Inserting, Updating, and Deleting* tutorial includes a programmatic check that ensures that the `UnitPrice` is provided.</span></span> <span data-ttu-id="ffff8-235">請隨意移除此邏輯，將其保持原狀，或將 RequiredFieldValidator 新增至 `UnitPrice` `EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="ffff8-235">Feel free to remove this logic, leave it in as-is, or add a RequiredFieldValidator to the `UnitPrice` `EditItemTemplate`.</span></span>

## <a name="step-4-summarizing-data-entry-problems"></a><span data-ttu-id="ffff8-236">步驟4：摘要資料輸入問題</span><span class="sxs-lookup"><span data-stu-id="ffff8-236">Step 4: Summarizing Data Entry Problems</span></span>

<span data-ttu-id="ffff8-237">除了五個驗證控制項以外，ASP.NET 還包含[ValidationSummary 控制項](https://msdn.microsoft.com/library/f9h59855(VS.80).aspx)，它會顯示偵測到無效資料之驗證控制項的 `ErrorMessage`。</span><span class="sxs-lookup"><span data-stu-id="ffff8-237">In addition to the five validation controls, ASP.NET includes the [ValidationSummary control](https://msdn.microsoft.com/library/f9h59855(VS.80).aspx), which displays the `ErrorMessage` s of those validation controls that detected invalid data.</span></span> <span data-ttu-id="ffff8-238">此摘要資料可顯示為網頁上的文字，或透過強制回應的用戶端 messagebox。</span><span class="sxs-lookup"><span data-stu-id="ffff8-238">This summary data can be displayed as text on the web page or through a modal, client-side messagebox.</span></span> <span data-ttu-id="ffff8-239">讓我們增強此教學課程，以包含用戶端 messagebox，其中摘要說明任何驗證問題。</span><span class="sxs-lookup"><span data-stu-id="ffff8-239">Let's enhance this tutorial to include a client-side messagebox summarizing any validation problems.</span></span>

<span data-ttu-id="ffff8-240">若要完成此動作，請將 ValidationSummary 控制項從 [工具箱] 拖曳至設計工具。</span><span class="sxs-lookup"><span data-stu-id="ffff8-240">To accomplish this, drag a ValidationSummary control from the Toolbox onto the Designer.</span></span> <span data-ttu-id="ffff8-241">驗證控制項的位置並不重要，因為我們要將它設定為只將摘要顯示為 messagebox。</span><span class="sxs-lookup"><span data-stu-id="ffff8-241">The location of the Validation control doesn't really matter, since we're going to configure it to only display the summary as a messagebox.</span></span> <span data-ttu-id="ffff8-242">加入控制項之後，將其[ShowSummary 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showsummary(VS.80).aspx)設為 `False`，並將其[ShowMessageBox 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showmessagebox(VS.80).aspx)設定為 `True`。</span><span class="sxs-lookup"><span data-stu-id="ffff8-242">After adding the control, set its [ShowSummary property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showsummary(VS.80).aspx) to `False` and its [ShowMessageBox property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showmessagebox(VS.80).aspx) to `True`.</span></span> <span data-ttu-id="ffff8-243">透過這項新增功能，任何驗證錯誤都會在用戶端 messagebox 中匯總。</span><span class="sxs-lookup"><span data-stu-id="ffff8-243">With this addition, any validation errors are summarized in a client-side messagebox.</span></span>

<span data-ttu-id="ffff8-244">[在用戶端 Messagebox 中，會摘要說明驗證錯誤 ![](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image32.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="ffff8-244">[![The Validation Errors are Summarized in a Client-Side Messagebox](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image32.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image31.png)</span></span>

<span data-ttu-id="ffff8-245">**圖 11**：驗證錯誤會在用戶端 Messagebox 中匯總（[按一下以觀看完整大小的影像](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image33.png)）</span><span class="sxs-lookup"><span data-stu-id="ffff8-245">**Figure 11**: The Validation Errors are Summarized in a Client-Side Messagebox ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image33.png))</span></span>

## <a name="step-5-adding-the-validation-controls-to-the-detailsviewsinsertitemtemplate"></a><span data-ttu-id="ffff8-246">步驟5：將驗證控制項新增至 DetailsView 的`InsertItemTemplate`</span><span class="sxs-lookup"><span data-stu-id="ffff8-246">Step 5: Adding the Validation Controls to the DetailsView's`InsertItemTemplate`</span></span>

<span data-ttu-id="ffff8-247">本教學課程剩下的工作，就是將驗證控制項新增至 DetailsView 的插入介面。</span><span class="sxs-lookup"><span data-stu-id="ffff8-247">All that remains for this tutorial is to add the validation controls to the DetailsView's inserting interface.</span></span> <span data-ttu-id="ffff8-248">將驗證控制項新增至 DetailsView 範本的程式，與步驟3中所檢查的程式相同。因此，我們將在此步驟中輕鬆完成這項工作。</span><span class="sxs-lookup"><span data-stu-id="ffff8-248">The process of adding validation controls to the DetailsView's templates is identical to that examined in Step 3; therefore, we'll breeze through the task in this step.</span></span> <span data-ttu-id="ffff8-249">如同我們對 GridView 的 `EditItemTemplate`，建議您將 nondescript `TextBox1` 的文字方塊 `ID` 重新命名，並 `TextBox2` `InsertProductName` 和 `InsertUnitPrice`。</span><span class="sxs-lookup"><span data-stu-id="ffff8-249">As we did with the GridView's `EditItemTemplate` s, I encourage you to rename the `ID` s of the TextBoxes from the nondescript `TextBox1` and `TextBox2` to `InsertProductName` and `InsertUnitPrice`.</span></span>

<span data-ttu-id="ffff8-250">將 RequiredFieldValidator 新增至 `ProductName` `InsertItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="ffff8-250">Add a RequiredFieldValidator to the `ProductName` `InsertItemTemplate`.</span></span> <span data-ttu-id="ffff8-251">將 [`ControlToValidate`] 設定為範本中文字方塊的 `ID`，其 `Text` 屬性設為 "\*"，而其 `ErrorMessage` 屬性設為 [您必須提供產品的名稱]。</span><span class="sxs-lookup"><span data-stu-id="ffff8-251">Set the `ControlToValidate` to the `ID` of the TextBox in the template, its `Text` property to "\*" and its `ErrorMessage` property to "You must provide the product's name".</span></span>

<span data-ttu-id="ffff8-252">由於新增記錄時，此頁面需要 `UnitPrice`，因此，請將 RequiredFieldValidator 新增至 `UnitPrice` `InsertItemTemplate`，適當地設定其 `ControlToValidate`、`Text`和 `ErrorMessage` 屬性。</span><span class="sxs-lookup"><span data-stu-id="ffff8-252">Since the `UnitPrice` is required for this page when adding a new record, add a RequiredFieldValidator to the `UnitPrice` `InsertItemTemplate`, setting its `ControlToValidate`, `Text`, and `ErrorMessage` properties appropriately.</span></span> <span data-ttu-id="ffff8-253">最後，將 CompareValidator 新增至 `UnitPrice` `InsertItemTemplate`，並設定其 `ControlToValidate`、`Text`、`ErrorMessage`、`Type`、`Operator`和 `ValueToCompare` 屬性，就像我們在 GridView `UnitPrice`中 `EditItemTemplate`的 CompareValidator 一樣。</span><span class="sxs-lookup"><span data-stu-id="ffff8-253">Finally, add a CompareValidator to the `UnitPrice` `InsertItemTemplate` as well, configuring its `ControlToValidate`, `Text`, `ErrorMessage`, `Type`, `Operator`, and `ValueToCompare` properties just like we did with the `UnitPrice`'s CompareValidator in the GridView's `EditItemTemplate`.</span></span>

<span data-ttu-id="ffff8-254">加入這些驗證控制項之後，如果未提供新產品的名稱，或其價格為負數或格式不合法，則無法將其新增至系統。</span><span class="sxs-lookup"><span data-stu-id="ffff8-254">After adding these validation controls, a new product cannot be added to the system if its name is not supplied or if its price is a negative number or illegally formatted.</span></span>

<span data-ttu-id="ffff8-255">[已將 ![驗證邏輯新增至 DetailsView 的插入介面](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image35.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="ffff8-255">[![Validation Logic has been Added to the DetailsView's Inserting Interface](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image35.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image34.png)</span></span>

<span data-ttu-id="ffff8-256">**圖 12**：驗證邏輯已新增至 DetailsView 的插入介面（[按一下以觀看完整大小的影像](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image36.png)）</span><span class="sxs-lookup"><span data-stu-id="ffff8-256">**Figure 12**: Validation Logic has been Added to the DetailsView's Inserting Interface ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image36.png))</span></span>

## <a name="step-6-partitioning-the-validation-controls-into-validation-groups"></a><span data-ttu-id="ffff8-257">步驟6：將驗證控制項分割成驗證群組</span><span class="sxs-lookup"><span data-stu-id="ffff8-257">Step 6: Partitioning the Validation Controls Into Validation Groups</span></span>

<span data-ttu-id="ffff8-258">我們的頁面是由兩個邏輯上不同的驗證控制項集所組成：對應至 GridView 的編輯介面，以及對應至 DetailsView 插入介面的設定。</span><span class="sxs-lookup"><span data-stu-id="ffff8-258">Our page consists of two logically disparate sets of validation controls: those that correspond to the GridView's editing interface and those that correspond to the DetailsView's inserting interface.</span></span> <span data-ttu-id="ffff8-259">根據預設，當回傳時，會檢查頁面上的*所有*驗證控制項。</span><span class="sxs-lookup"><span data-stu-id="ffff8-259">By default, when a postback occurs *all* validation controls on the page are checked.</span></span> <span data-ttu-id="ffff8-260">不過，在編輯記錄時，我們不希望 DetailsView 的插入介面驗證控制項進行驗證。</span><span class="sxs-lookup"><span data-stu-id="ffff8-260">However, when editing a record we don't want the DetailsView's inserting interface's validation controls to validate.</span></span> <span data-ttu-id="ffff8-261">[圖 13] 說明當使用者使用完全合法的值來編輯產品時，我們目前的難題，按一下 [更新] 會導致驗證錯誤，因為插入介面中的名稱和價格值是空白的。</span><span class="sxs-lookup"><span data-stu-id="ffff8-261">Figure 13 illustrates our current dilemma when a user is editing a product with perfectly legal values, clicking Update causes a validation error because the name and price values in the inserting interface are blank.</span></span>

<span data-ttu-id="ffff8-262">[更新產品 ![會導致插入介面的驗證控制項引發](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image38.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="ffff8-262">[![Updating a Product Causes the Inserting Interface's Validation Controls to Fire](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image38.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image37.png)</span></span>

<span data-ttu-id="ffff8-263">**圖 13**：更新產品會引發插入介面的驗證控制項（[按一下以查看完整大小的影像](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image39.png)）</span><span class="sxs-lookup"><span data-stu-id="ffff8-263">**Figure 13**: Updating a Product Causes the Inserting Interface's Validation Controls to Fire ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image39.png))</span></span>

<span data-ttu-id="ffff8-264">ASP.NET 2.0 中的驗證控制項可以透過其 `ValidationGroup` 屬性分割成驗證群組。</span><span class="sxs-lookup"><span data-stu-id="ffff8-264">The validation controls in ASP.NET 2.0 can be partitioned into validation groups through their `ValidationGroup` property.</span></span> <span data-ttu-id="ffff8-265">若要關聯群組中的一組驗證控制項，只要將其 `ValidationGroup` 屬性設為相同的值即可。</span><span class="sxs-lookup"><span data-stu-id="ffff8-265">To associate a set of validation controls in a group, simply set their `ValidationGroup` property to the same value.</span></span> <span data-ttu-id="ffff8-266">在本教學課程中，將 GridView TemplateFields 中驗證控制項的 `ValidationGroup` 屬性設為 `EditValidationControls`，並將 DetailsView TemplateFields 的 `ValidationGroup` 屬性設定為 `InsertValidationControls`。</span><span class="sxs-lookup"><span data-stu-id="ffff8-266">For our tutorial, set the `ValidationGroup` properties of the validation controls in the GridView's TemplateFields to `EditValidationControls` and the `ValidationGroup` properties of the DetailsView's TemplateFields to `InsertValidationControls`.</span></span> <span data-ttu-id="ffff8-267">當您使用設計工具的編輯範本介面時，可以直接在宣告式標記中或透過屬性視窗來完成這些變更。</span><span class="sxs-lookup"><span data-stu-id="ffff8-267">These changes can be done directly in the declarative markup or through the Properties window when using the Designer's edit template interface.</span></span>

<span data-ttu-id="ffff8-268">除了驗證控制項以外，ASP.NET 2.0 中的按鈕和按鈕相關控制項也包含 `ValidationGroup` 屬性。</span><span class="sxs-lookup"><span data-stu-id="ffff8-268">In addition to the validation controls, the Button and Button-related controls in ASP.NET 2.0 also include a `ValidationGroup` property.</span></span> <span data-ttu-id="ffff8-269">只有當回傳是由具有相同 `ValidationGroup` 屬性設定的按鈕所引發時，才會檢查驗證群組的驗證程式是否有效。</span><span class="sxs-lookup"><span data-stu-id="ffff8-269">A validation group's validators are checked for validity only when a postback is induced by a Button that has the same `ValidationGroup` property setting.</span></span> <span data-ttu-id="ffff8-270">例如，為了讓 DetailsView 的 [插入] 按鈕觸發 `InsertValidationControls` 驗證群組，我們必須將 CommandField 的 `ValidationGroup` 屬性設定為 [`InsertValidationControls`] （請參閱 [圖 14]）。</span><span class="sxs-lookup"><span data-stu-id="ffff8-270">For example, in order for the DetailsView's Insert button to trigger the `InsertValidationControls` validation group we need to set the CommandField's `ValidationGroup` property to `InsertValidationControls` (see Figure 14).</span></span> <span data-ttu-id="ffff8-271">此外，將 GridView 的 [CommandField's `ValidationGroup`] 屬性設定為 [`EditValidationControls`]。</span><span class="sxs-lookup"><span data-stu-id="ffff8-271">Additionally, set the GridView's CommandField's `ValidationGroup` property to `EditValidationControls`.</span></span>

<span data-ttu-id="ffff8-272">[![將 DetailsView 的 CommandField's ValidationGroup 屬性設定為 InsertValidationControls](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image41.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="ffff8-272">[![Set the DetailsView's CommandField's ValidationGroup property to InsertValidationControls](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image41.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image40.png)</span></span>

<span data-ttu-id="ffff8-273">**圖 14**：將 DetailsView 的 CommandField's `ValidationGroup` 屬性設定為 `InsertValidationControls` （[按一下以查看完整大小的影像](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image42.png)）</span><span class="sxs-lookup"><span data-stu-id="ffff8-273">**Figure 14**: Set the DetailsView's CommandField's `ValidationGroup` property to `InsertValidationControls` ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/_static/image42.png))</span></span>

<span data-ttu-id="ffff8-274">這些變更之後，DetailsView 和 GridView 的 TemplateFields 和 CommandFields 看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="ffff8-274">After these changes, the DetailsView and GridView's TemplateFields and CommandFields should look similar to the following:</span></span>

<span data-ttu-id="ffff8-275">DetailsView 的 TemplateFields 和 CommandField</span><span class="sxs-lookup"><span data-stu-id="ffff8-275">The DetailsView's TemplateFields and CommandField</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/samples/sample4.aspx)]

<span data-ttu-id="ffff8-276">GridView 的 CommandField 和 TemplateFields</span><span class="sxs-lookup"><span data-stu-id="ffff8-276">The GridView's CommandField and TemplateFields</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/samples/sample5.aspx)]

<span data-ttu-id="ffff8-277">此時，只有在按下 GridView 的 [插入] 按鈕時才會引發編輯特定的驗證控制項，而插入特定的驗證控制項則只會在按一下 DetailsView 的 [插入] 按鈕時引發，以解決 [圖 13] 中反白顯示的問題。</span><span class="sxs-lookup"><span data-stu-id="ffff8-277">At this point the edit-specific validation controls fire only when the GridView's Update button is clicked and the insert-specific validation controls fire only when the DetailsView's Insert button is clicked, resolving the problem highlighted by Figure 13.</span></span> <span data-ttu-id="ffff8-278">不過，在此變更中，當輸入不正確資料時，不會再顯示 ValidationSummary 控制項。</span><span class="sxs-lookup"><span data-stu-id="ffff8-278">However, with this change our ValidationSummary control no longer displays when entering invalid data.</span></span> <span data-ttu-id="ffff8-279">ValidationSummary 控制項也包含 `ValidationGroup` 屬性，而且只會在其驗證群組中顯示這些驗證控制項的摘要資訊。</span><span class="sxs-lookup"><span data-stu-id="ffff8-279">The ValidationSummary control also contains a `ValidationGroup` property and only shows summary information for those validation controls in its validation group.</span></span> <span data-ttu-id="ffff8-280">因此，我們在此頁面中必須有兩個驗證控制項，一個用於 `InsertValidationControls` 驗證群組，另一個用於 `EditValidationControls`。</span><span class="sxs-lookup"><span data-stu-id="ffff8-280">Therefore, we need to have two validation controls in this page, one for the `InsertValidationControls` validation group and one for `EditValidationControls`.</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-vb/samples/sample6.aspx)]

<span data-ttu-id="ffff8-281">完成此新增教學課程後，</span><span class="sxs-lookup"><span data-stu-id="ffff8-281">With this addition our tutorial is complete!</span></span>

## <a name="summary"></a><span data-ttu-id="ffff8-282">總結</span><span class="sxs-lookup"><span data-stu-id="ffff8-282">Summary</span></span>

<span data-ttu-id="ffff8-283">雖然 BoundFields 可以同時提供插入和編輯介面，但介面無法自訂。</span><span class="sxs-lookup"><span data-stu-id="ffff8-283">While BoundFields can provide both an inserting and editing interface, the interface is not customizable.</span></span> <span data-ttu-id="ffff8-284">通常，我們會想要將驗證控制項新增至編輯和插入介面，以確保使用者以合法格式輸入必要的輸入。</span><span class="sxs-lookup"><span data-stu-id="ffff8-284">Commonly, we want to add validation controls to the editing and inserting interface to ensure that the user enters required inputs in a legal format.</span></span> <span data-ttu-id="ffff8-285">若要完成此動作，我們必須將 BoundFields 轉換成 TemplateFields，並將驗證控制項新增至適當的範本。</span><span class="sxs-lookup"><span data-stu-id="ffff8-285">To accomplish this we must convert the BoundFields into TemplateFields and add the validation controls to the appropriate template(s).</span></span> <span data-ttu-id="ffff8-286">在本教學課程中，我們將從*檢查與插入、更新和刪除教學課程相關聯的事件*中擴充範例，並將驗證控制項新增至 DetailsView 的插入介面和 GridView 的編輯介面。</span><span class="sxs-lookup"><span data-stu-id="ffff8-286">In this tutorial we extended the example from the *Examining the Events Associated with Inserting, Updating, and Deleting* tutorial, adding validation controls to both the DetailsView's inserting interface and the GridView's editing interface.</span></span> <span data-ttu-id="ffff8-287">此外，我們也看到了如何使用 ValidationSummary 控制項顯示摘要驗證資訊，以及如何將頁面上的驗證控制項分割成不同的驗證群組。</span><span class="sxs-lookup"><span data-stu-id="ffff8-287">Moreover, we saw how to display summary validation information using the ValidationSummary control and how to partition the validation controls on the page into distinct validation groups.</span></span>

<span data-ttu-id="ffff8-288">如我們在本教學課程中所見，TemplateFields 允許增強編輯和插入介面，以包含驗證控制項。</span><span class="sxs-lookup"><span data-stu-id="ffff8-288">As we saw in this tutorial, TemplateFields allow the editing and inserting interfaces to be augmented to include validation controls.</span></span> <span data-ttu-id="ffff8-289">TemplateFields 也可以擴充以包含額外的輸入 Web 控制項，讓文字方塊能夠由更適合的 Web 控制項取代。</span><span class="sxs-lookup"><span data-stu-id="ffff8-289">TemplateFields can also be extended to include additional input Web controls, enabling the TextBox to be replaced by a more suitable Web control.</span></span> <span data-ttu-id="ffff8-290">在下一個教學課程中，我們將瞭解如何使用資料系結 DropDownList 控制項來取代 TextBox 控制項，這在編輯外鍵（例如 `Products` 資料表中的 `CategoryID` 或 `SupplierID`）時是理想的選擇。</span><span class="sxs-lookup"><span data-stu-id="ffff8-290">In our next tutorial we'll see how to replace the TextBox control with a data-bound DropDownList control, which is ideal when editing a foreign key (such as `CategoryID` or `SupplierID` in the `Products` table).</span></span>

<span data-ttu-id="ffff8-291">快樂的程式設計！</span><span class="sxs-lookup"><span data-stu-id="ffff8-291">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="ffff8-292">關於作者</span><span class="sxs-lookup"><span data-stu-id="ffff8-292">About the Author</span></span>

<span data-ttu-id="ffff8-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，自1998起，有七個 ASP/ASP. NET 書籍和創辦人的[4GuysFromRolla.com](http://www.4guysfromrolla.com)。</span><span class="sxs-lookup"><span data-stu-id="ffff8-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="ffff8-294">Scott 以獨立的顧問、訓練員和作者的身分運作。</span><span class="sxs-lookup"><span data-stu-id="ffff8-294">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="ffff8-295">他的最新著作是[*在24小時內讓自己的 ASP.NET 2.0*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="ffff8-295">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="ffff8-296">他可以在mitchell@4GuysFromRolla.com觸達[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="ffff8-296">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="ffff8-297">或者透過他的 blog，可以在[http://ScottOnWriting.NET](http://ScottOnWriting.NET)找到。</span><span class="sxs-lookup"><span data-stu-id="ffff8-297">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="ffff8-298">特別感謝</span><span class="sxs-lookup"><span data-stu-id="ffff8-298">Special Thanks To</span></span>

<span data-ttu-id="ffff8-299">本教學課程系列已由許多有用的審核者所審查。</span><span class="sxs-lookup"><span data-stu-id="ffff8-299">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="ffff8-300">本教學課程的潛在客戶審核者為 Liz Shulok 和 Zack。</span><span class="sxs-lookup"><span data-stu-id="ffff8-300">Lead reviewers for this tutorial were Liz Shulok and Zack Jones.</span></span> <span data-ttu-id="ffff8-301">有興趣複習我即將發行的 MSDN 文章嗎？</span><span class="sxs-lookup"><span data-stu-id="ffff8-301">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="ffff8-302">若是如此，請在mitchell@4GuysFromRolla.com的那一行下拉式[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="ffff8-302">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="ffff8-303">[上一頁](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md)
> [下一頁](customizing-the-data-modification-interface-vb.md)</span><span class="sxs-lookup"><span data-stu-id="ffff8-303">[Previous](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md)
[Next](customizing-the-data-modification-interface-vb.md)</span></span>
