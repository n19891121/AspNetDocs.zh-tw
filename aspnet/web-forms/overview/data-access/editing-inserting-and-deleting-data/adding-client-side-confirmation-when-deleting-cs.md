---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-cs
title: 刪除 (C#) 時新增用戶端確認 |Microsoft Docs
author: rick-anderson
description: 在介面中，我們建立了到目前為止，使用者不小心刪除資料時在想要按一下 [編輯] 按鈕，按一下 [刪除] 按鈕。 在此 t...
ms.author: riande
ms.date: 07/17/2006
ms.assetid: f6e2a12a-2b5e-48fd-8db3-1e94a500c19a
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-cs
msc.type: authoredcontent
ms.openlocfilehash: d7a6f29dc660cff2bfa9db8f9790d73e51a2cc1c
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/17/2019
ms.locfileid: "59420129"
---
# <a name="adding-client-side-confirmation-when-deleting-c"></a><span data-ttu-id="56710-104">於刪除時新增用戶端確認 (C#)</span><span class="sxs-lookup"><span data-stu-id="56710-104">Adding Client-Side Confirmation When Deleting (C#)</span></span>

<span data-ttu-id="56710-105">藉由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="56710-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="56710-106">[下載範例應用程式](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_22_CS.exe)或[下載 PDF](adding-client-side-confirmation-when-deleting-cs/_static/datatutorial22cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="56710-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_22_CS.exe) or [Download PDF](adding-client-side-confirmation-when-deleting-cs/_static/datatutorial22cs1.pdf)</span></span>

> <span data-ttu-id="56710-107">在介面中，我們建立了到目前為止，使用者不小心刪除資料時在想要按一下 [編輯] 按鈕，按一下 [刪除] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="56710-107">In the interfaces we've created so far, a user can accidentally delete data by clicking the Delete button when they meant to click the Edit button.</span></span> <span data-ttu-id="56710-108">在本教學課程中，我們將新增用戶端確認對話方塊出現時按一下 [刪除] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="56710-108">In this tutorial we'll add a client-side confirmation dialog box that appears when the Delete button is clicked.</span></span>


## <a name="introduction"></a><span data-ttu-id="56710-109">簡介</span><span class="sxs-lookup"><span data-stu-id="56710-109">Introduction</span></span>

<span data-ttu-id="56710-110">移轉過去的幾個教學課程我們已了解如何搭配使用我們的應用程式架構、 ObjectDataSource 和資料 Web 控制項，來提供插入、 編輯和刪除功能。</span><span class="sxs-lookup"><span data-stu-id="56710-110">Over the past several tutorials we ve seen how to use our application architecture, ObjectDataSource, and the data Web controls in concert to provide inserting, editing, and deleting capabilities.</span></span> <span data-ttu-id="56710-111">刪除介面我們 ve 檢查到目前為止已撰寫的刪除按鈕，當按下時，造成回傳而叫用的 ObjectDataSource s`Delete()`方法。</span><span class="sxs-lookup"><span data-stu-id="56710-111">The deleting interfaces we ve examined thus far have been composed of a Delete button that, when clicked, causes a postback and invokes the ObjectDataSource s `Delete()` method.</span></span> <span data-ttu-id="56710-112">`Delete()`方法則會叫用的設定的方法，從商業邏輯層，會傳播到資料存取層，發出的實際呼叫`DELETE`到資料庫的陳述式。</span><span class="sxs-lookup"><span data-stu-id="56710-112">The `Delete()` method then invokes the configured method from the Business Logic Layer, which propagates the call down to the Data Access Layer, issuing the actual `DELETE` statement to the database.</span></span>

<span data-ttu-id="56710-113">雖然此使用者介面可讓訪客，若要刪除的 GridView、 DetailsView 或 FormView 控制項之間的記錄，它缺乏任何一種確認，當使用者按一下 [刪除] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="56710-113">While this user interface enables visitors to delete records through the GridView, DetailsView, or FormView controls, it lacks any sort of confirmation when the user clicks the Delete button.</span></span> <span data-ttu-id="56710-114">如果使用者不小心按下 [刪除] 按鈕時在想要按一下編輯，在想要更新的記錄將會改為刪除。</span><span class="sxs-lookup"><span data-stu-id="56710-114">If a user accidentally clicks the Delete button when they meant to click Edit, the record they meant to update will instead be deleted.</span></span> <span data-ttu-id="56710-115">為了避免此情形，在本教學課程中，我們將新增用戶端確認對話方塊出現時按一下 [刪除] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="56710-115">To help prevent this, in this tutorial we'll add a client-side confirmation dialog box that appears when the Delete button is clicked.</span></span>

<span data-ttu-id="56710-116">JavaScript`confirm(string)`函式會顯示其字串輸入的參數為強制回應對話方塊中，配備兩個按鈕-好 和 取消 （請參閱 圖 1） 內的文字。</span><span class="sxs-lookup"><span data-stu-id="56710-116">The JavaScript `confirm(string)` function displays its string input parameter as the text inside a modal dialog box that comes equipped with two buttons - OK and Cancel (see Figure 1).</span></span> <span data-ttu-id="56710-117">`confirm(string)`函式會傳回布林值，根據按下哪個按鈕 (`true`，如果使用者按一下 [確定]，和`false`如果按 [取消])。</span><span class="sxs-lookup"><span data-stu-id="56710-117">The `confirm(string)` function returns a Boolean value depending on what button is clicked (`true`, if the user clicks OK, and `false` if they click Cancel).</span></span>


![JavaScript confirm(string) 方法會顯示強制回應，用戶端 Messagebox](adding-client-side-confirmation-when-deleting-cs/_static/image1.png)

<span data-ttu-id="56710-119">**圖 1**:JavaScript`confirm(string)`方法會顯示強制回應的用戶端的 Messagebox</span><span class="sxs-lookup"><span data-stu-id="56710-119">**Figure 1**: The JavaScript `confirm(string)` Method Displays a Modal, Client-Side Messagebox</span></span>


<span data-ttu-id="56710-120">在表單提交時，如果值為`false`傳回從用戶端事件處理常式中，則會取消送出表單。</span><span class="sxs-lookup"><span data-stu-id="56710-120">During a form submission, if a value of `false` is returned from a client-side event handler then the form submission is cancelled.</span></span> <span data-ttu-id="56710-121">使用這項功能，我們可以有刪除按鈕的用戶端`onclick`事件處理常式的傳回值呼叫`confirm("Are you sure you want to delete this product?")`。</span><span class="sxs-lookup"><span data-stu-id="56710-121">Using this feature, we can have the Delete button s client-side `onclick` event handler return the value of a call to `confirm("Are you sure you want to delete this product?")`.</span></span> <span data-ttu-id="56710-122">如果使用者按一下 [取消]，`confirm(string)`會傳回 false，因而導致取消送出表單。</span><span class="sxs-lookup"><span data-stu-id="56710-122">If the user clicks Cancel, `confirm(string)` will return false, thereby causing the form submission to cancel.</span></span> <span data-ttu-id="56710-123">具有任何回傳中，將不會刪除其 [刪除] 按鈕已按下的產品。</span><span class="sxs-lookup"><span data-stu-id="56710-123">With no postback, the product whose Delete button was clicked won't be deleted.</span></span> <span data-ttu-id="56710-124">不過，使用者按一下 [確定] 確認對話方塊中的，回傳會繼續而每況愈下則產品將會被刪除。</span><span class="sxs-lookup"><span data-stu-id="56710-124">If, however, the user clicks OK in the confirmation dialog box, the postback will continue unabated and the product will be deleted.</span></span> <span data-ttu-id="56710-125">請參閱[使用 JavaScript s`confirm()`方法，以控制表單提交](http://www.webreference.com/programming/javascript/confirm/)如需有關這項技術。</span><span class="sxs-lookup"><span data-stu-id="56710-125">Consult [Using JavaScript s `confirm()` Method to Control Form Submission](http://www.webreference.com/programming/javascript/confirm/) for more information on this technique.</span></span>

<span data-ttu-id="56710-126">新增必要的用戶端指令碼稍有不同如果使用比使用 CommandField 的範本。</span><span class="sxs-lookup"><span data-stu-id="56710-126">Adding the necessary client-side script differs slightly if using templates than when using a CommandField.</span></span> <span data-ttu-id="56710-127">因此，在本教學課程中，我們將看看 FormView 和 GridView 範例。</span><span class="sxs-lookup"><span data-stu-id="56710-127">Therefore, in this tutorial we will look at both a FormView and GridView example.</span></span>

> [!NOTE]
> <span data-ttu-id="56710-128">使用用戶端確認技術，討論在本教學課程中，像是假設與支援 JavaScript 的瀏覽器瀏覽您的使用者，並且具有已啟用 JavaScript。</span><span class="sxs-lookup"><span data-stu-id="56710-128">Using client-side confirmation techniques, like the ones discussed in this tutorial, assumes that your users are visiting with browsers that support JavaScript and that they have JavaScript enabled.</span></span> <span data-ttu-id="56710-129">如果其中一個這些假設不是特定的使用者，則為 true，按一下 [刪除] 按鈕將會立即回傳，（不顯示確認訊息方塊）。</span><span class="sxs-lookup"><span data-stu-id="56710-129">If either of these assumptions are not true for a particular user, clicking the Delete button will immediately cause a postback (not displaying a confirm messagebox).</span></span>


## <a name="step-1-creating-a-formview-that-supports-deletion"></a><span data-ttu-id="56710-130">步驟 1：建立 FormView 支援刪除</span><span class="sxs-lookup"><span data-stu-id="56710-130">Step 1: Creating a FormView That Supports Deletion</span></span>

<span data-ttu-id="56710-131">首先新增至 FormView`ConfirmationOnDelete.aspx`頁面中`EditInsertDelete`資料夾中，繫結至可取回產品資訊，透過新 ObjectDataSource`ProductsBLL`類別的`GetProducts()`方法。</span><span class="sxs-lookup"><span data-stu-id="56710-131">Start by adding a FormView to the `ConfirmationOnDelete.aspx` page in the `EditInsertDelete` folder, binding it to a new ObjectDataSource that pulls back the product information via the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="56710-132">也設定 ObjectDataSource 以便`ProductsBLL`類別 s`DeleteProduct(productID)`方法會對應到 ObjectDataSource`Delete()`方法; 請確認插入和更新] 索引標籤下拉式清單設定為 [（無）。</span><span class="sxs-lookup"><span data-stu-id="56710-132">Also configure the ObjectDataSource so that the `ProductsBLL` class s `DeleteProduct(productID)` method is mapped to the ObjectDataSource s `Delete()` method; ensure that the INSERT and UPDATE tabs drop-down lists are set to (None).</span></span> <span data-ttu-id="56710-133">最後，檢查 FormView s 智慧標籤的 啟用分頁核取方塊。</span><span class="sxs-lookup"><span data-stu-id="56710-133">Finally, check the Enable Paging checkbox in the FormView s smart tag.</span></span>

<span data-ttu-id="56710-134">完成這些步驟中之後, 的新 ObjectDataSource s 宣告式標記看起來如下所示：</span><span class="sxs-lookup"><span data-stu-id="56710-134">After these steps, the new ObjectDataSource s declarative markup will look like the following:</span></span>


[!code-aspx[Main](adding-client-side-confirmation-when-deleting-cs/samples/sample1.aspx)]

<span data-ttu-id="56710-135">如過去範例未使用開放式並行存取，請花一點時間來清除 ObjectDataSource 的`OldValuesParameterFormatString`屬性。</span><span class="sxs-lookup"><span data-stu-id="56710-135">As in our past examples that did not use optimistic concurrency, take a moment to clear out the ObjectDataSource s `OldValuesParameterFormatString` property.</span></span>

<span data-ttu-id="56710-136">因為已繫結至 ObjectDataSource 控制項僅支援 刪除 FormView 的`ItemTemplate`提供只有 刪除 按鈕，缺少的新功能和更新的按鈕。</span><span class="sxs-lookup"><span data-stu-id="56710-136">Since it has been bound to an ObjectDataSource control that only supports deleting, the FormView s `ItemTemplate` offers only the Delete button, lacking the New and Update buttons.</span></span> <span data-ttu-id="56710-137">FormView s 宣告式標記，不過，包含多餘`EditItemTemplate`和`InsertItemTemplate`，其中可以移除。</span><span class="sxs-lookup"><span data-stu-id="56710-137">The FormView s declarative markup, however, includes a superfluous `EditItemTemplate` and `InsertItemTemplate`, which can be removed.</span></span> <span data-ttu-id="56710-138">花點時間自訂`ItemTemplate`這樣就會顯示資料欄位只是產品的子集。</span><span class="sxs-lookup"><span data-stu-id="56710-138">Take a moment to customize the `ItemTemplate` so that is shows only a subset of the product data fields.</span></span> <span data-ttu-id="56710-139">我已設定我的顯示中的產品的名稱`<h3>`標題上方及其供應商和類別目錄的名稱 （以及 [刪除] 按鈕）。</span><span class="sxs-lookup"><span data-stu-id="56710-139">I ve configured mine to show the product s name in an `<h3>` heading above its supplier and category names (along with the Delete button).</span></span>


[!code-aspx[Main](adding-client-side-confirmation-when-deleting-cs/samples/sample2.aspx)]

<span data-ttu-id="56710-140">經過這些變更，我們有功能完整的網頁，可讓使用者透過一個產品一次切換能夠刪除產品，只要按一下 [刪除] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="56710-140">With these changes, we have a fully functional web page that allows a user to toggle through the products one at a time, with the ability to delete a product by simply clicking the Delete button.</span></span> <span data-ttu-id="56710-141">圖 2 顯示進度的螢幕擷取畫面到目前為止透過瀏覽器檢視時。</span><span class="sxs-lookup"><span data-stu-id="56710-141">Figure 2 shows a screen shot of our progress thus far when viewed through a browser.</span></span>


<span data-ttu-id="56710-142">[![FormView 顯示單一產品的相關資訊](adding-client-side-confirmation-when-deleting-cs/_static/image3.png)](adding-client-side-confirmation-when-deleting-cs/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="56710-142">[![The FormView Shows Information About a Single Product](adding-client-side-confirmation-when-deleting-cs/_static/image3.png)](adding-client-side-confirmation-when-deleting-cs/_static/image2.png)</span></span>

<span data-ttu-id="56710-143">**圖 2**:FormView 顯示資訊有關單一產品 ([按一下以檢視完整大小的影像](adding-client-side-confirmation-when-deleting-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="56710-143">**Figure 2**: The FormView Shows Information About a Single Product ([Click to view full-size image](adding-client-side-confirmation-when-deleting-cs/_static/image4.png))</span></span>


## <a name="step-2-calling-the-confirmstring-function-from-the-delete-buttons-client-side-onclick-event"></a><span data-ttu-id="56710-144">步驟 2：從 [刪除] 按鈕用戶端的 onclick 事件呼叫 confirm(string) 函式</span><span class="sxs-lookup"><span data-stu-id="56710-144">Step 2: Calling the confirm(string) Function from the Delete Buttons Client-Side onclick Event</span></span>

<span data-ttu-id="56710-145">使用建立 FormView，最後一個步驟是設定 [刪除] 按鈕這類，當它 s 按一下訪客，JavaScript`confirm(string)`函式會叫用。</span><span class="sxs-lookup"><span data-stu-id="56710-145">With the FormView created, the final step is to configure the Delete button such that when it s clicked by the visitor, the JavaScript `confirm(string)` function is invoked.</span></span> <span data-ttu-id="56710-146">加入按鈕、 LinkButton 或 ImageButton 的用戶端的用戶端指令碼`onclick`事件，即可使用`OnClientClick property`，這是 ASP.NET 2.0 新功能。</span><span class="sxs-lookup"><span data-stu-id="56710-146">Adding client-side script to a Button, LinkButton, or ImageButton s client-side `onclick` event can be accomplished through the use of the `OnClientClick property`, which is new to ASP.NET 2.0.</span></span> <span data-ttu-id="56710-147">因為我們想要的值`confirm(string)`函式傳回時，只要將設定這個屬性： `return confirm('Are you certain that you want to delete this product?');`</span><span class="sxs-lookup"><span data-stu-id="56710-147">Since we want to have the value of the `confirm(string)` function returned, simply set this property to: `return confirm('Are you certain that you want to delete this product?');`</span></span>

<span data-ttu-id="56710-148">這項變更之後刪除 LinkButton s 宣告式語法看起來應該類似：</span><span class="sxs-lookup"><span data-stu-id="56710-148">After this change the Delete LinkButton s declarative syntax should look something like:</span></span>


[!code-aspx[Main](adding-client-side-confirmation-when-deleting-cs/samples/sample3.aspx)]

<span data-ttu-id="56710-149">S 就是這麼簡單 ！</span><span class="sxs-lookup"><span data-stu-id="56710-149">That s all there is to it!</span></span> <span data-ttu-id="56710-150">圖 3 顯示作用中的這項確認的螢幕擷取畫面。</span><span class="sxs-lookup"><span data-stu-id="56710-150">Figure 3 shows a screen shot of this confirmation in action.</span></span> <span data-ttu-id="56710-151">按一下 [刪除] 按鈕會帶出 [確認] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="56710-151">Clicking the Delete button brings up the confirm dialog box.</span></span> <span data-ttu-id="56710-152">如果使用者按一下 [取消]，回傳會取消，並不會刪除產品。</span><span class="sxs-lookup"><span data-stu-id="56710-152">If the user clicks Cancel, the postback is cancelled and the product is not deleted.</span></span> <span data-ttu-id="56710-153">如果，不過，使用者會按一下 [確定]，回傳會繼續與 ObjectDataSource 的`Delete()`叫用方法時，已累積可被刪除的資料庫記錄。</span><span class="sxs-lookup"><span data-stu-id="56710-153">If, however, the user clicks OK, the postback continues and the ObjectDataSource s `Delete()` method is invoked, culminating in the database record being deleted.</span></span>

> [!NOTE]
> <span data-ttu-id="56710-154">將字串傳遞至`confirm(string)`JavaScript 函式以撇號 （而不是引號）。</span><span class="sxs-lookup"><span data-stu-id="56710-154">The string passed into the `confirm(string)` JavaScript function is delimited with apostrophes (rather than quotation marks).</span></span> <span data-ttu-id="56710-155">在 JavaScript 中，字串可以使用任一字元分隔。</span><span class="sxs-lookup"><span data-stu-id="56710-155">In JavaScript, strings can be delimited using either character.</span></span> <span data-ttu-id="56710-156">我們使用單引號這裡讓的分隔符號字串傳遞至`confirm(string)`不會產生模稜兩可用於分隔符號`OnClientClick`屬性值。</span><span class="sxs-lookup"><span data-stu-id="56710-156">We use apostrophes here so that the delimiters for the string passed into `confirm(string)` do not introduce an ambiguity with the delimiters used for the `OnClientClick` property value.</span></span>


<span data-ttu-id="56710-157">[![確認訊息會立即顯示時按一下 [刪除] 按鈕](adding-client-side-confirmation-when-deleting-cs/_static/image6.png)](adding-client-side-confirmation-when-deleting-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="56710-157">[![A Confirmation is Now Displayed When Clicking the Delete Button](adding-client-side-confirmation-when-deleting-cs/_static/image6.png)](adding-client-side-confirmation-when-deleting-cs/_static/image5.png)</span></span>

<span data-ttu-id="56710-158">**圖 3**:確認訊息會立即顯示時按一下 [刪除] 按鈕 ([按一下以檢視完整大小的影像](adding-client-side-confirmation-when-deleting-cs/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="56710-158">**Figure 3**: A Confirmation is Now Displayed When Clicking the Delete Button ([Click to view full-size image](adding-client-side-confirmation-when-deleting-cs/_static/image7.png))</span></span>


## <a name="step-3-configuring-the-onclientclick-property-for-the-delete-button-in-a-commandfield"></a><span data-ttu-id="56710-159">步驟 3：在 CommandField 中設定 刪除 按鈕 OnClientClick 屬性</span><span class="sxs-lookup"><span data-stu-id="56710-159">Step 3: Configuring the OnClientClick Property for the Delete Button in a CommandField</span></span>

<span data-ttu-id="56710-160">當使用按鈕、 LinkButton、 ImageButton 直接在範本中，確認對話方塊中可以是與它相關聯藉由直接設定其`OnClientClick`屬性，以傳回結果的 JavaScript`confirm(string)`函式。</span><span class="sxs-lookup"><span data-stu-id="56710-160">When working with a Button, LinkButton, or ImageButton directly in a template, a confirmation dialog box can be associated with it by simply configuring its `OnClientClick` property to return the results of the JavaScript `confirm(string)` function.</span></span> <span data-ttu-id="56710-161">不過，CommandField-這將刪除按鈕的欄位加入到 GridView 或 DetailsView-沒有`OnClientClick`可以宣告方式設定的屬性。</span><span class="sxs-lookup"><span data-stu-id="56710-161">However, the CommandField - which adds a field of Delete buttons to a GridView or DetailsView - does not have an `OnClientClick` property that can be set declaratively.</span></span> <span data-ttu-id="56710-162">相反地，我們必須以程式設計方式參考適當的 GridView 或 DetailsView s 中的 [刪除] 按鈕`DataBound`事件處理常式，然後將設定其`OnClientClick`那里屬性。</span><span class="sxs-lookup"><span data-stu-id="56710-162">Instead, we must programmatically reference the Delete button in the GridView or DetailsView s appropriate `DataBound` event handler, and then set its `OnClientClick` property there.</span></span>

> [!NOTE]
> <span data-ttu-id="56710-163">設定 s 上的 [刪除] 按鈕時`OnClientClick`中的適當屬性`DataBound`事件處理常式中，我們可以存取的資料繫結至目前的記錄。</span><span class="sxs-lookup"><span data-stu-id="56710-163">When setting the Delete button s `OnClientClick` property in the appropriate `DataBound` event handler, we have access to the data was bound to the current record.</span></span> <span data-ttu-id="56710-164">這表示我們可以擴充確認訊息包含有關該特定的記錄，詳細資料，例如，「 是您確定要刪除 Chai 產品嗎？ 」</span><span class="sxs-lookup"><span data-stu-id="56710-164">This means we can extend the confirmation message to include details about the particular record, such as, "Are you sure you want to delete the Chai product?"</span></span> <span data-ttu-id="56710-165">這種自訂，也可以使用資料繫結語法的範本中。</span><span class="sxs-lookup"><span data-stu-id="56710-165">Such customization is also possible in templates using databinding syntax.</span></span>


<span data-ttu-id="56710-166">做法是設定`OnClientClick`刪除 button(s) CommandField，讓 s 中的屬性加入至頁面的 GridView。</span><span class="sxs-lookup"><span data-stu-id="56710-166">To practice setting the `OnClientClick` property for the Delete button(s) in a CommandField, let s add a GridView to the page.</span></span> <span data-ttu-id="56710-167">設定此 GridView，以使用相同的 ObjectDataSource 控制項，會使用 FormView。</span><span class="sxs-lookup"><span data-stu-id="56710-167">Configure this GridView to use the same ObjectDataSource control that the FormView uses.</span></span> <span data-ttu-id="56710-168">也限制 GridView 的 BoundFields，使其只包含 產品名稱、 類別和供應商。</span><span class="sxs-lookup"><span data-stu-id="56710-168">Also limit the GridView s BoundFields to only include the product s name, category, and supplier.</span></span> <span data-ttu-id="56710-169">最後，核取方塊啟用刪除從 GridView s 智慧標籤。</span><span class="sxs-lookup"><span data-stu-id="56710-169">Lastly, check the Enable Deleting checkbox from the GridView s smart tag.</span></span> <span data-ttu-id="56710-170">這會將 CommandField 新增到 GridView`Columns`與集合及其`ShowDeleteButton`屬性設定為`true`。</span><span class="sxs-lookup"><span data-stu-id="56710-170">This will add a CommandField to the GridView s `Columns` collection with its `ShowDeleteButton` property set to `true`.</span></span>

<span data-ttu-id="56710-171">進行這些變更之後，GridView s 的宣告式標記看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="56710-171">After making these changes, your GridView s declarative markup should look like the following:</span></span>


[!code-aspx[Main](adding-client-side-confirmation-when-deleting-cs/samples/sample4.aspx)]

<span data-ttu-id="56710-172">CommandField 包含單一的刪除 LinkButton 執行個體可從 GridView s 以程式設計方式存取`RowDataBound`事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="56710-172">The CommandField contains a single Delete LinkButton instance that can be accessed programmatically from the GridView s `RowDataBound` event handler.</span></span> <span data-ttu-id="56710-173">一旦參考，我們可以設定其`OnClientClick`屬性據此。</span><span class="sxs-lookup"><span data-stu-id="56710-173">Once referenced, we can set its `OnClientClick` property accordingly.</span></span> <span data-ttu-id="56710-174">建立事件處理常式`RowDataBound`使用下列程式碼的事件：</span><span class="sxs-lookup"><span data-stu-id="56710-174">Create an event handler for the `RowDataBound` event using the following code:</span></span>


[!code-csharp[Main](adding-client-side-confirmation-when-deleting-cs/samples/sample5.cs)]

<span data-ttu-id="56710-175">這個事件處理常式會與資料列 （其會將擁有 [刪除] 按鈕），並一開始會以程式設計方式參考 [刪除] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="56710-175">This event handler works with data rows (those that will have the Delete button) and begins by programmatically referencing the Delete button.</span></span> <span data-ttu-id="56710-176">在一般使用以下模式：</span><span class="sxs-lookup"><span data-stu-id="56710-176">In general use the following pattern:</span></span>


[!code-csharp[Main](adding-client-side-confirmation-when-deleting-cs/samples/sample6.cs)]

<span data-ttu-id="56710-177">*ButtonType*是正由 CommandField-LinkButton 或 ImageButton 按鈕的按鈕類型。</span><span class="sxs-lookup"><span data-stu-id="56710-177">*ButtonType* is the type of button being used by the CommandField - Button, LinkButton, or ImageButton.</span></span> <span data-ttu-id="56710-178">根據預設，CommandField 使用 Linkbutton，但這可以自訂經由 CommandField 的`ButtonType property`。</span><span class="sxs-lookup"><span data-stu-id="56710-178">By default, the CommandField uses LinkButtons, but this can be customized via the CommandField s `ButtonType property`.</span></span> <span data-ttu-id="56710-179">*CommandFieldIndex*是循序索引內的 GridView s CommandField`Columns`集合，而*controlIndex* CommandField s 內的 [刪除] 按鈕的索引`Controls`集合。</span><span class="sxs-lookup"><span data-stu-id="56710-179">The *commandFieldIndex* is the ordinal index of the CommandField within the GridView s `Columns` collection, whereas the *controlIndex* is the index of the Delete button within the CommandField s `Controls` collection.</span></span> <span data-ttu-id="56710-180">*ControlIndex*值取決於 CommandField 相對於其他按鈕的按鈕的位置。</span><span class="sxs-lookup"><span data-stu-id="56710-180">The *controlIndex* value depends on the button s position relative to other buttons in the CommandField.</span></span> <span data-ttu-id="56710-181">比方說，如果唯一 CommandField 中顯示的按鈕是 [刪除] 按鈕，使用索引為 0。</span><span class="sxs-lookup"><span data-stu-id="56710-181">For example, if the only button displayed in the CommandField is the Delete button, use an index of 0.</span></span> <span data-ttu-id="56710-182">如果，不過，有 編輯 按鈕之前刪除 按鈕，使用的索引 2。</span><span class="sxs-lookup"><span data-stu-id="56710-182">If, however, there s an Edit button that precedes the Delete button, use an index of 2.</span></span> <span data-ttu-id="56710-183">使用索引為 2 的原因是由 [刪除] 按鈕之前 CommandField 所加入的兩個控制項: [編輯] 按鈕和 LiteralControl s 用來新增一些編輯和刪除按鈕之間的空間。</span><span class="sxs-lookup"><span data-stu-id="56710-183">The reason an index of 2 is used is because two controls are added by the CommandField before the Delete button: the Edit button and a LiteralControl that s used to add some space between the Edit and Delete buttons.</span></span>

<span data-ttu-id="56710-184">特定範例中，CommandField 使用 Linkbutton 而且，在最左邊 欄位中，具有*commandFieldIndex*為 0。</span><span class="sxs-lookup"><span data-stu-id="56710-184">For our particular example, the CommandField uses LinkButtons and, being the left-most field, has a *commandFieldIndex* of 0.</span></span> <span data-ttu-id="56710-185">因為沒有任何其他按鈕，但在 CommandField 中的 [刪除] 按鈕，我們會使用*controlIndex*為 0。</span><span class="sxs-lookup"><span data-stu-id="56710-185">Since there are no other buttons but the Delete button in the CommandField, we use a *controlIndex* of 0.</span></span>

<span data-ttu-id="56710-186">在參考 CommandField 中的 [刪除] 按鈕之後, 我們接下來會抓取繫結至目前的 GridView 資料列的產品的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="56710-186">After referencing the Delete button in the CommandField, we next grab information about the product bound to the current GridView row.</span></span> <span data-ttu-id="56710-187">最後，我們將設定 [刪除] 按鈕的`OnClientClick`適當的 javascript 中，包括產品的名稱的屬性。</span><span class="sxs-lookup"><span data-stu-id="56710-187">Finally, we set the Delete button s `OnClientClick` property to the appropriate JavaScript, which includes the product s name.</span></span> <span data-ttu-id="56710-188">因為 JavaScript 字串傳遞至`confirm(string)`函式使用我們必須將出現在產品的名稱的任何單引號逸出的單引號分隔。</span><span class="sxs-lookup"><span data-stu-id="56710-188">Since the JavaScript string passed into the `confirm(string)` function is delimited using apostrophes we must escape any apostrophes that appear within the product s name.</span></span> <span data-ttu-id="56710-189">以逸出，s 產品名稱中的任何單引號是特別的是，「`\'`"。</span><span class="sxs-lookup"><span data-stu-id="56710-189">In particular, any apostrophes in the product s name are escaped with "`\'`".</span></span>

<span data-ttu-id="56710-190">完成這些變更，按一下 刪除 按鈕，在 GridView 會顯示自訂的確認對話方塊 （請參閱 圖 4）。</span><span class="sxs-lookup"><span data-stu-id="56710-190">With these changes complete, clicking on a Delete button in the GridView displays a customized confirmation dialog box (see Figure 4).</span></span> <span data-ttu-id="56710-191">為和確認訊息方塊，從 FormView，如果使用者按一下 [取消] 回傳被取消，藉此防止發生刪除。</span><span class="sxs-lookup"><span data-stu-id="56710-191">As with the confirmation messagebox from the FormView, if the user clicks Cancel the postback is cancelled, thereby preventing the deletion from occurring.</span></span>

> [!NOTE]
> <span data-ttu-id="56710-192">這項技術也可用來以程式設計方式存取在 DetailsView 中 CommandField 中的 [刪除] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="56710-192">This technique can also be used to programmatically access the Delete button in the CommandField in a DetailsView.</span></span> <span data-ttu-id="56710-193">DetailsView，不過，d 您建立的事件處理常式`DataBound`事件，因為沒有 DetailsView`RowDataBound`事件。</span><span class="sxs-lookup"><span data-stu-id="56710-193">For the DetailsView, however, you d create an event handler for the `DataBound` event, since the DetailsView does not have a `RowDataBound` event.</span></span>


<span data-ttu-id="56710-194">[![按一下 GridView s [刪除] 按鈕會顯示自訂的確認對話方塊](adding-client-side-confirmation-when-deleting-cs/_static/image9.png)](adding-client-side-confirmation-when-deleting-cs/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="56710-194">[![Clicking the GridView s Delete Button Displays a Customized Confirmation Dialog Box](adding-client-side-confirmation-when-deleting-cs/_static/image9.png)](adding-client-side-confirmation-when-deleting-cs/_static/image8.png)</span></span>

<span data-ttu-id="56710-195">**圖 4**:按一下 GridView s [刪除] 按鈕會顯示自訂的確認對話方塊中 ([按一下以檢視完整大小的影像](adding-client-side-confirmation-when-deleting-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="56710-195">**Figure 4**: Clicking the GridView s Delete Button Displays a Customized Confirmation Dialog Box ([Click to view full-size image](adding-client-side-confirmation-when-deleting-cs/_static/image10.png))</span></span>


## <a name="using-templatefields"></a><span data-ttu-id="56710-196">使用 TemplateFields</span><span class="sxs-lookup"><span data-stu-id="56710-196">Using TemplateFields</span></span>

<span data-ttu-id="56710-197">其中一個 CommandField 的缺點是它的按鈕都必須透過編製索引和產生的物件，必須轉換成適當的按鈕類型 （按鈕、 LinkButton 或 ImageButton）。</span><span class="sxs-lookup"><span data-stu-id="56710-197">One of the disadvantages of the CommandField is that its buttons must be accessed through indexing and that the resulting object must be cast to the appropriate button type (Button, LinkButton, or ImageButton).</span></span> <span data-ttu-id="56710-198">使用 「 神奇號碼 」 和硬式編碼的型別邀請找不到執行階段之前的問題。</span><span class="sxs-lookup"><span data-stu-id="56710-198">Using "magic numbers" and hard-coded types invites problems that cannot be discovered until runtime.</span></span> <span data-ttu-id="56710-199">例如，如果您或另一個開發人員，將新按鈕加入至某個時間點以後 （例如 [編輯] 按鈕），或變更 CommandField`ButtonType`屬性，而沒有錯誤，仍會編譯現有的程式碼，但瀏覽頁面可能會造成例外狀況或非預期的行為，根據您的程式碼撰寫的方式和所做的變更。</span><span class="sxs-lookup"><span data-stu-id="56710-199">For example, if you, or another developer, adds new buttons to the CommandField at some point in the future (such as an Edit button) or changes the `ButtonType` property, the existing code will still compile without error, but visiting the page may cause an exception or unexpected behavior, depending on how your code was written and what changes were made.</span></span>

<span data-ttu-id="56710-200">替代方式是將 GridView 和 DetailsView 的 CommandFields TemplateFields 轉換。</span><span class="sxs-lookup"><span data-stu-id="56710-200">An alternative approach is to convert the GridView and DetailsView s CommandFields into TemplateFields.</span></span> <span data-ttu-id="56710-201">這會產生使用 TemplateField `ItemTemplate` CommandField 中每個按鈕具有 LinkButton （按鈕或 ImageButton）。</span><span class="sxs-lookup"><span data-stu-id="56710-201">This will generate a TemplateField with an `ItemTemplate` that has a LinkButton (or Button or ImageButton) for each button in the CommandField.</span></span> <span data-ttu-id="56710-202">這些按鈕`OnClientClick`屬性可指定以宣告方式，當我們看到了 FormView，或以程式設計的方式可在適當`DataBound`事件處理常式，使用下列模式：</span><span class="sxs-lookup"><span data-stu-id="56710-202">These buttons `OnClientClick` properties can be assigned declaratively, as we saw with the FormView, or can be programmatically accessed in the appropriate `DataBound` event handler using the following pattern:</span></span>


[!code-csharp[Main](adding-client-side-confirmation-when-deleting-cs/samples/sample7.cs)]

<span data-ttu-id="56710-203">何處*controlID*是 [s] 按鈕的值`ID`屬性。</span><span class="sxs-lookup"><span data-stu-id="56710-203">Where *controlID* is the value of the button s `ID` property.</span></span> <span data-ttu-id="56710-204">雖然此模式仍然需要硬式編碼的類型轉換的它會移除需要編製索引，以便進行版面配置，以變更不會導致執行階段錯誤。</span><span class="sxs-lookup"><span data-stu-id="56710-204">While this pattern still requires a hard-coded type for the cast, it removes the need for indexing, allowing for the layout to change without resulting in a runtime error.</span></span>

## <a name="summary"></a><span data-ttu-id="56710-205">總結</span><span class="sxs-lookup"><span data-stu-id="56710-205">Summary</span></span>

<span data-ttu-id="56710-206">JavaScript`confirm(string)`函式是控制表單提交工作流程的常用的技巧。</span><span class="sxs-lookup"><span data-stu-id="56710-206">The JavaScript `confirm(string)` function is a commonly used technique for controlling form submission workflow.</span></span> <span data-ttu-id="56710-207">執行時，此函式會顯示強制回應的用戶端 對話方塊，其中包含兩個按鈕的 確定 和 取消。</span><span class="sxs-lookup"><span data-stu-id="56710-207">When executed, the function displays a modal, client-side dialog box that includes two buttons, OK and Cancel.</span></span> <span data-ttu-id="56710-208">如果使用者按一下 [確定]`confirm(string)`函式會傳回`true`; 按一下 [取消] 會傳回`false`。</span><span class="sxs-lookup"><span data-stu-id="56710-208">If the user clicks OK, the `confirm(string)` function returns `true`; clicking Cancel returns `false`.</span></span> <span data-ttu-id="56710-209">這項功能，加上的瀏覽器的行為，可取消表單送出，如果事件處理常式在提交程序期間傳回`false`，可用來刪除記錄時顯示確認訊息方塊。</span><span class="sxs-lookup"><span data-stu-id="56710-209">This functionality, coupled with a browser s behavior to cancel a form submission if an event handler during the submission process returns `false`, can be used to display a confirmation messagebox when deleting a record.</span></span>

<span data-ttu-id="56710-210">`confirm(string)`函式可以與按鈕 Web 控制項的用戶端相關聯`onclick`事件處理常式，透過控制的`OnClientClick`屬性。</span><span class="sxs-lookup"><span data-stu-id="56710-210">The `confirm(string)` function can be associated with a Button Web control s client-side `onclick` event handler through the control s `OnClientClick` property.</span></span> <span data-ttu-id="56710-211">使用範本-可能是其中一個 FormView 的範本中，或在 DetailsView 或 GridView-TemplateField 中的 [刪除] 按鈕時此屬性可以設定以宣告方式或以程式設計的方式，如我們在本教學課程中所見。</span><span class="sxs-lookup"><span data-stu-id="56710-211">When working with a Delete button in a template - either in one of the FormView s templates or in a TemplateField in the DetailsView or GridView - this property can be set either declaratively or programmatically, as we saw in this tutorial.</span></span>

<span data-ttu-id="56710-212">快樂地寫程式 ！</span><span class="sxs-lookup"><span data-stu-id="56710-212">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="56710-213">關於作者</span><span class="sxs-lookup"><span data-stu-id="56710-213">About the Author</span></span>

<span data-ttu-id="56710-214">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，作者的七個 ASP 書籍和的創辦人[4GuysFromRolla.com](http://www.4guysfromrolla.com)，自 1998 年從事 Microsoft Web 技術工作。</span><span class="sxs-lookup"><span data-stu-id="56710-214">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="56710-215">Scott 會擔任獨立的顧問、 培訓講師和作家。</span><span class="sxs-lookup"><span data-stu-id="56710-215">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="56710-216">他最新的著作是[ *Sams 教導您自己 ASP.NET 2.0 在 24 小時內*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="56710-216">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="56710-217">他可以在觸達[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="56710-217">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="56710-218">或透過他的部落格，這位於 [http://ScottOnWriting.NET](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="56710-218">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="56710-219">[上一頁](implementing-optimistic-concurrency-cs.md)
> [下一頁](limiting-data-modification-functionality-based-on-the-user-cs.md)</span><span class="sxs-lookup"><span data-stu-id="56710-219">[Previous](implementing-optimistic-concurrency-cs.md)
[Next](limiting-data-modification-functionality-based-on-the-user-cs.md)</span></span>
