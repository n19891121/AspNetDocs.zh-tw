---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs
title: 將驗證控制項新增至編輯和插入介面 (C#) |Microsoft Docs
author: rick-anderson
description: 在本教學課程中，我們會看到將驗證控制項新增至 EditItemTemplate 和 InsertItemTemplate Web 控制項的資料，以提供更是多麼...
ms.author: riande
ms.date: 07/17/2006
ms.assetid: 2086cb1a-ab78-49ae-9c0b-03891c69776a
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs
msc.type: authoredcontent
ms.openlocfilehash: 157a71c7b8a7b5e8e34c08957d0520dfb8da8db9
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/09/2019
ms.locfileid: "59391256"
---
# <a name="adding-validation-controls-to-the-editing-and-inserting-interfaces-c"></a><span data-ttu-id="fdf6e-103">將驗證控制項新增至編輯和插入介面 (C#)</span><span class="sxs-lookup"><span data-stu-id="fdf6e-103">Adding Validation Controls to the Editing and Inserting Interfaces (C#)</span></span>

<span data-ttu-id="fdf6e-104">藉由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="fdf6e-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="fdf6e-105">[下載範例應用程式](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_19_CS.exe)或[下載 PDF](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/datatutorial19cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="fdf6e-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_19_CS.exe) or [Download PDF](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/datatutorial19cs1.pdf)</span></span>

> <span data-ttu-id="fdf6e-106">在本教學課程中，我們會看到將驗證控制項新增至要提供更萬無一失的使用者介面的 EditItemTemplate 和 InsertItemTemplate 資料 Web 控制項的是多麼容易。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-106">In this tutorial we'll see how easy it is to add validation controls to the EditItemTemplate and InsertItemTemplate of a data Web control, to provide a more foolproof user interface.</span></span>


## <a name="introduction"></a><span data-ttu-id="fdf6e-107">簡介</span><span class="sxs-lookup"><span data-stu-id="fdf6e-107">Introduction</span></span>

<span data-ttu-id="fdf6e-108">GridView 和 DetailsView 控制項範例中的我們探討了過去三個教學課程有所有已 BoundFields 和組成 CheckBoxFields （的欄位型別繫結至資料來源的 GridView 或 DetailsView 時，自動加入由 Visual Studio透過智慧標籤控制）。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-108">The GridView and DetailsView controls in the examples we've explored over the past three tutorials have all been composed of BoundFields and CheckBoxFields (the field types automatically added by Visual Studio when binding a GridView or DetailsView to a data source control through the smart tag).</span></span> <span data-ttu-id="fdf6e-109">當您編輯的 GridView 或 DetailsView 中的資料列，這些不是唯讀的 BoundFields 會轉換成文字方塊中，使用者可以從中修改現有的資料。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-109">When editing a row in a GridView or DetailsView, those BoundFields that are not read-only are converted into textboxes, from which the end user can modify the existing data.</span></span> <span data-ttu-id="fdf6e-110">同樣地，當插入新記錄到 DetailsView 控制項，這些 BoundFields 其`InsertVisible`屬性設定為`true`（預設值） 會呈現為空白的文字方塊中，使用者可以在其中提供新資料錄的欄位值。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-110">Similarly, when inserting a new record into a DetailsView control, those BoundFields whose `InsertVisible` property is set to `true` (the default) are rendered as empty textboxes, into which the user can provide the new record's field values.</span></span> <span data-ttu-id="fdf6e-111">同樣地，CheckBoxFields，會停用標準的唯讀介面中，會轉換成已啟用的核取方塊中編輯和插入介面。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-111">Likewise, CheckBoxFields, which are disabled in the standard, read-only interface, are converted into enabled checkboxes in the editing and inserting interfaces.</span></span>

<span data-ttu-id="fdf6e-112">雖然預設編輯和插入介面 BoundField 及其可能很有幫助，介面會缺少任何類型的驗證。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-112">While the default editing and inserting interfaces for the BoundField and CheckBoxField can be helpful, the interface lacks any sort of validation.</span></span> <span data-ttu-id="fdf6e-113">如果使用者犯了資料項目-例如省略`ProductName`欄位，或輸入的值為 「 無效 」 `UnitsInStock` （例如-50) 將會引發例外狀況從應用程式架構的深度內。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-113">If a user makes a data entry mistake - such as omitting the `ProductName` field or entering an invalid value for `UnitsInStock` (such as -50) an exception will be raised from within the depths of the application architecture.</span></span> <span data-ttu-id="fdf6e-114">雖然此處理例外狀況可以依正常程序中所示[先前的教學課程](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md)，在理想情況下編輯，或插入使用者介面會包含驗證控制項，以防止使用者輸入中這類無效的資料第一個位置。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-114">While this exception can be gracefully handled as demonstrated in the [previous tutorial](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md), ideally the editing or inserting user interface would include validation controls to prevent a user from entering such invalid data in the first place.</span></span>

<span data-ttu-id="fdf6e-115">若要提供自訂的編輯或插入的介面，我們要取代為 TemplateField BoundField 或 CheckBoxField。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-115">In order to provide a customized editing or inserting interface, we need to replace the BoundField or CheckBoxField with a TemplateField.</span></span> <span data-ttu-id="fdf6e-116">TemplateFields 所討論的主題中[使用 GridView 控制項中的 TemplateFields](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md)並[DetailsView 控制項中的使用 TemplateFields](../custom-formatting/using-templatefields-in-the-detailsview-control-cs.md)教學課程中，可以包含多個範本定義分隔不同的資料列狀態的介面。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-116">TemplateFields, which were the topic of discussion in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md) and [Using TemplateFields in the DetailsView Control](../custom-formatting/using-templatefields-in-the-detailsview-control-cs.md) tutorials, can consist of multiple templates defining separate interfaces for different row states.</span></span> <span data-ttu-id="fdf6e-117">TemplateField`ItemTemplate`時，用來呈現唯讀欄位或資料列，在 DetailsView 或 GridView 控制項中，而`EditItemTemplate`和`InsertItemTemplate`表示要進行編輯，然後分別插入模式中，使用的介面。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-117">The TemplateField's `ItemTemplate` is used to when rendering read-only fields or rows in the DetailsView or GridView controls, whereas the `EditItemTemplate` and `InsertItemTemplate` indicate the interfaces to use for the editing and inserting modes, respectively.</span></span>

<span data-ttu-id="fdf6e-118">在本教學課程中我們會看到將驗證控制項新增至 TemplateField 是多麼`EditItemTemplate`和`InsertItemTemplate`提供更萬無一失的使用者介面。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-118">In this tutorial we'll see how easy it is to add validation controls to the TemplateField's `EditItemTemplate` and `InsertItemTemplate` to provide a more foolproof user interface.</span></span> <span data-ttu-id="fdf6e-119">具體來說，本教學課程需要中建立的範例[檢查與插入、 更新和刪除事件相關聯](examining-the-events-associated-with-inserting-updating-and-deleting-cs.md)教學課程和加強的編輯和插入介面以包含適當的驗證。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-119">Specifically, this tutorial takes the example created in the [Examining the Events Associated with Inserting, Updating, and Deleting](examining-the-events-associated-with-inserting-updating-and-deleting-cs.md) tutorial and augments the editing and inserting interfaces to include appropriate validation.</span></span>

## <a name="step-1-replicating-the-example-fromexamining-the-events-associated-with-inserting-updating-and-deletingexamining-the-events-associated-with-inserting-updating-and-deleting-csmd"></a><span data-ttu-id="fdf6e-120">步驟 1：複寫的範例[檢查的事件相關聯插入、 更新和刪除](examining-the-events-associated-with-inserting-updating-and-deleting-cs.md)</span><span class="sxs-lookup"><span data-stu-id="fdf6e-120">Step 1: Replicating the Example from[Examining the Events Associated with Inserting, Updating, and Deleting](examining-the-events-associated-with-inserting-updating-and-deleting-cs.md)</span></span>

<span data-ttu-id="fdf6e-121">在 [檢查與插入、 更新和刪除事件相關聯](examining-the-events-associated-with-inserting-updating-and-deleting-cs.md)教學課程中我們建立所列出的名稱和價格的產品，可編輯的 GridView 內的頁面。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-121">In the [Examining the Events Associated with Inserting, Updating, and Deleting](examining-the-events-associated-with-inserting-updating-and-deleting-cs.md) tutorial we created a page that listed the names and prices of the products in an editable GridView.</span></span> <span data-ttu-id="fdf6e-122">此外，頁面包含 DetailsView 其`DefaultMode`屬性設定為`Insert`，藉此一律呈現在插入模式。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-122">Additionally, the page included a DetailsView whose `DefaultMode` property was set to `Insert`, thereby always rendering in insert mode.</span></span> <span data-ttu-id="fdf6e-123">從這個 DetailsView 中，使用者無法輸入新的產品名稱和價格、 按一下 插入，以及將它新增至系統 （請參閱 圖 1）。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-123">From this DetailsView, the user could enter the name and price for a new product, click Insert, and have it added to the system (see Figure 1).</span></span>


[![T<span data-ttu-id="fdf6e-124">他先前範例可讓使用者加入新的產品，並編輯現有的]</span><span class="sxs-lookup"><span data-stu-id="fdf6e-124">he Previous Example Allows Users to Add New Products and Edit Existing Ones]</span></span>(adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image2.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image1.png)

<span data-ttu-id="fdf6e-125">**圖 1**:前一個範例可讓使用者加入新的產品，並編輯現有的 ([按一下以檢視完整大小的影像](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="fdf6e-125">**Figure 1**: The Previous Example Allows Users to Add New Products and Edit Existing Ones ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image3.png))</span></span>


<span data-ttu-id="fdf6e-126">我們在本教學課程的目標是以增強 DetailsView 和 GridView，來提供驗證控制項。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-126">Our goal for this tutorial is to augment the DetailsView and GridView to provide validation controls.</span></span> <span data-ttu-id="fdf6e-127">特別是，我們將驗證邏輯將會：</span><span class="sxs-lookup"><span data-stu-id="fdf6e-127">In particular, our validation logic will:</span></span>

- <span data-ttu-id="fdf6e-128">需要插入或編輯產品時，提供名稱</span><span class="sxs-lookup"><span data-stu-id="fdf6e-128">Require that the name be provided when inserting or editing a product</span></span>
- <span data-ttu-id="fdf6e-129">需要插入一筆記錄; 時，提供價格當您編輯一筆記錄，我們仍需要價格，但將程式設計邏輯，在 GridView 的`RowUpdating`已經存在於較早的教學課程中的事件處理常式</span><span class="sxs-lookup"><span data-stu-id="fdf6e-129">Require that the price be provided when inserting a record; when editing a record, we will still require a price, but will use the programmatic logic in the GridView's `RowUpdating` event handler already present from the earlier tutorial</span></span>
- <span data-ttu-id="fdf6e-130">請確定輸入的價格的值是有效的貨幣格式</span><span class="sxs-lookup"><span data-stu-id="fdf6e-130">Ensure that the value entered for the price is a valid currency format</span></span>

<span data-ttu-id="fdf6e-131">我們來看看擴充前一個範例，以包含驗證之前，我們必須先將複寫的範例`DataModificationEvents.aspx`頁面，即可在此教學課程中，頁面`UIValidation.aspx`。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-131">Before we can look at augmenting the previous example to include validation, we first need to replicate the example from the `DataModificationEvents.aspx` page to the page for this tutorial, `UIValidation.aspx`.</span></span> <span data-ttu-id="fdf6e-132">若要這麼做我們要同時複製`DataModificationEvents.aspx`頁面的宣告式標記和其原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-132">To accomplish this we need to copy over both the `DataModificationEvents.aspx` page's declarative markup and its source code.</span></span> <span data-ttu-id="fdf6e-133">第一次複製的宣告式標記執行下列步驟：</span><span class="sxs-lookup"><span data-stu-id="fdf6e-133">First copy over the declarative markup by performing the following steps:</span></span>

1. <span data-ttu-id="fdf6e-134">開啟`DataModificationEvents.aspx`Visual Studio 中的頁面</span><span class="sxs-lookup"><span data-stu-id="fdf6e-134">Open the `DataModificationEvents.aspx` page in Visual Studio</span></span>
2. <span data-ttu-id="fdf6e-135">請移至頁面的宣告式標記 （在頁面底部的 [來源] 按鈕按一下）</span><span class="sxs-lookup"><span data-stu-id="fdf6e-135">Go to the page's declarative markup (click on the Source button at the bottom of the page)</span></span>
3. <span data-ttu-id="fdf6e-136">複製內的文字`<asp:Content>`和`</asp:Content>`標籤 （程式行 3 到 44），為所示的 圖 2。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-136">Copy the text within the `<asp:Content>` and `</asp:Content>` tags (lines 3 through 44), as shown in Figure 2.</span></span>


[![C<span data-ttu-id="fdf6e-137">複製文字內&lt;asp: Content&gt;控制項]</span><span class="sxs-lookup"><span data-stu-id="fdf6e-137">opy the Text Within the &lt;asp:Content&gt; Control]</span></span>(adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image5.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image4.png)

<span data-ttu-id="fdf6e-138">**圖 2**:複製文字內`<asp:Content>`控制項 ([按一下以檢視完整大小的影像](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="fdf6e-138">**Figure 2**: Copy the Text Within the `<asp:Content>` Control ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image6.png))</span></span>


1. <span data-ttu-id="fdf6e-139">開啟`UIValidation.aspx`頁面</span><span class="sxs-lookup"><span data-stu-id="fdf6e-139">Open the `UIValidation.aspx` page</span></span>
2. <span data-ttu-id="fdf6e-140">請移至頁面的宣告式標記</span><span class="sxs-lookup"><span data-stu-id="fdf6e-140">Go to the page's declarative markup</span></span>
3. <span data-ttu-id="fdf6e-141">貼上文字內`<asp:Content>`控制項。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-141">Paste the text within the `<asp:Content>` control.</span></span>

<span data-ttu-id="fdf6e-142">若要複製的原始碼，開啟`DataModificationEvents.aspx.cs`頁面上，並複製只是文字*內*`EditInsertDelete_DataModificationEvents`類別。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-142">To copy over the source code, open the `DataModificationEvents.aspx.cs` page and copy just the text *within* the `EditInsertDelete_DataModificationEvents` class.</span></span> <span data-ttu-id="fdf6e-143">複製的三個事件處理常式 (`Page_Load`， `GridView1_RowUpdating`，並`ObjectDataSource1_Inserting`)，但不要**不**複製類別宣告或`using`陳述式。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-143">Copy the three event handlers (`Page_Load`, `GridView1_RowUpdating`, and `ObjectDataSource1_Inserting`), but do **not** copy the class declaration or `using` statements.</span></span> <span data-ttu-id="fdf6e-144">貼上複製的文字*內*`EditInsertDelete_UIValidation`類別在`UIValidation.aspx.cs`。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-144">Paste the copied text *within* the `EditInsertDelete_UIValidation` class in `UIValidation.aspx.cs`.</span></span>

<span data-ttu-id="fdf6e-145">移動內容，以及從程式碼之後`DataModificationEvents.aspx`至`UIValidation.aspx`，花點時間來測試您的瀏覽器中的進度。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-145">After moving over the content and code from `DataModificationEvents.aspx` to `UIValidation.aspx`, take a moment to test out your progress in a browser.</span></span> <span data-ttu-id="fdf6e-146">您應該會看到相同的輸出和體驗相同的功能，在每個這兩個頁面中 (請參閱上一步 圖 1 的螢幕擷取畫面`DataModificationEvents.aspx`作用中)。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-146">You should see the same output and experience the same functionality in each of these two pages (refer back to Figure 1 for a screen shot of `DataModificationEvents.aspx` in action).</span></span>

## <a name="step-2-converting-the-boundfields-into-templatefields"></a><span data-ttu-id="fdf6e-147">步驟 2：BoundFields 轉換 TemplateFields</span><span class="sxs-lookup"><span data-stu-id="fdf6e-147">Step 2: Converting the BoundFields Into TemplateFields</span></span>

<span data-ttu-id="fdf6e-148">若要將驗證控制項加入編輯和插入介面，需要轉換成 TemplateFields BoundFields DetailsView 和 GridView 控制項所使用的。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-148">To add validation controls to the editing and inserting interfaces, the BoundFields used by the DetailsView and GridView controls need to be converted into TemplateFields.</span></span> <span data-ttu-id="fdf6e-149">若要這麼做，請分別按一下 編輯資料行和編輯欄位的連結，在 GridView 和 DetailsView 的智慧標籤。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-149">To achieve this, click on the Edit Columns and Edit Fields links in the GridView and DetailsView's smart tags, respectively.</span></span> <span data-ttu-id="fdf6e-150">選取每個 BoundFields，然後按一下 「 將這個欄位轉換為 TemplateField 」 連結。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-150">There, select each of the BoundFields and click the "Convert this field into a TemplateField" link.</span></span>


[![C<span data-ttu-id="fdf6e-151">轉換每個的 GridView 與 DetailsView 的 BoundFields 到 TemplateFields]</span><span class="sxs-lookup"><span data-stu-id="fdf6e-151">onvert Each of the DetailsView's and GridView's BoundFields Into TemplateFields]</span></span>(adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image8.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image7.png)

<span data-ttu-id="fdf6e-152">**圖 3**:轉換每個的 GridView 與 DetailsView 的 BoundFields 到 TemplateFields ([按一下以檢視完整大小的影像](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="fdf6e-152">**Figure 3**: Convert Each of the DetailsView's and GridView's BoundFields Into TemplateFields ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image9.png))</span></span>


<span data-ttu-id="fdf6e-153">BoundField 轉換為 TemplateField 透過 [欄位] 對話方塊中，會產生展現相同的唯讀、 編輯和插入介面 BoundField 本身為 TemplateField。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-153">Converting a BoundField into a TemplateField through the Fields dialog box generates a TemplateField that exhibits the same read-only, editing, and inserting interfaces as the BoundField itself.</span></span> <span data-ttu-id="fdf6e-154">下列標記顯示的宣告式語法`ProductName`DetailsView 轉換為 TemplateField 成欄位：</span><span class="sxs-lookup"><span data-stu-id="fdf6e-154">The following markup shows the declarative syntax for the `ProductName` field in the DetailsView after it has been converted into a TemplateField:</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/samples/sample1.aspx)]

<span data-ttu-id="fdf6e-155">請注意此 TemplateField 有三個自動建立的範本`ItemTemplate`， `EditItemTemplate`，和`InsertItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-155">Note that this TemplateField had three templates automatically created `ItemTemplate`, `EditItemTemplate`, and `InsertItemTemplate`.</span></span> <span data-ttu-id="fdf6e-156">`ItemTemplate`會顯示單一資料欄位值 (`ProductName`) 使用 Label Web 控制項，而`EditItemTemplate`並`InsertItemTemplate`關聯的文字方塊中的資料欄位的文字方塊中的 Web 控制項中呈現資料欄位值`Text`使用雙向資料繫結的屬性。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-156">The `ItemTemplate` displays a single data field value (`ProductName`) using a Label Web control, while the `EditItemTemplate` and `InsertItemTemplate` present the data field value in a TextBox Web control that associates the data field with the TextBox's `Text` property using two-way databinding.</span></span> <span data-ttu-id="fdf6e-157">因為我們只將此頁面中使用 DetailsView，您可能會移除`ItemTemplate`和`EditItemTemplate`從兩個的 TemplateFields，雖然沒有壞處，在將它們保留。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-157">Since we are only using the DetailsView in this page for inserting, you may remove the `ItemTemplate` and `EditItemTemplate` from the two TemplateFields, although there's no harm in leaving them.</span></span>

<span data-ttu-id="fdf6e-158">因為 GridView 不支援內建插入 DetailsView 的功能、 將轉換的 GridView `ProductName` TemplateField 欄位會導致只`ItemTemplate`和`EditItemTemplate`:</span><span class="sxs-lookup"><span data-stu-id="fdf6e-158">Since the GridView does not support the built-in inserting features of the DetailsView, converting the GridView's `ProductName` field into a TemplateField results in only an `ItemTemplate` and `EditItemTemplate`:</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/samples/sample2.aspx)]

<span data-ttu-id="fdf6e-159">按一下"轉換為 TemplateField 到這個欄位 」，Visual Studio 建立的範本模擬之使用者介面的轉換 BoundField TemplateField。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-159">By clicking the "Convert this field into a TemplateField," Visual Studio has created a TemplateField whose templates mimic the user interface of the converted BoundField.</span></span> <span data-ttu-id="fdf6e-160">您可以瀏覽此頁面，透過瀏覽器來確認。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-160">You can verify this by visiting this page through a browser.</span></span> <span data-ttu-id="fdf6e-161">您會發現的外觀和行為的 TemplateFields 是相同的體驗時 BoundFields 所使用。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-161">You'll find that the appearance and behavior of the TemplateFields is identical to the experience when BoundFields were used instead.</span></span>

> [!NOTE]
> <span data-ttu-id="fdf6e-162">請隨意自訂中的範本所需的編輯介面。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-162">Feel free to customize the editing interfaces in the templates as needed.</span></span> <span data-ttu-id="fdf6e-163">比方說，我們可能會想要在文字方塊`UnitPrice`轉譯為較小的文字方塊，比 TemplateFields`ProductName`文字方塊中。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-163">For example, we may want to have the TextBox in the `UnitPrice` TemplateFields rendered as a smaller textbox than the `ProductName` textbox.</span></span> <span data-ttu-id="fdf6e-164">若要這麼做，您可以設定文字方塊的`Columns`屬性設為適當的值，或提供絕對的寬度，透過`Width`屬性。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-164">To accomplish this you can set the TextBox's `Columns` property to an appropriate value or provide an absolute width via the `Width` property.</span></span> <span data-ttu-id="fdf6e-165">在下一個教學課程中，我們會看到如何完全自訂編輯介面，以替代的資料輸入 Web 控制項取代文字方塊中。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-165">In the next tutorial we'll see how to completely customize the editing interface by replacing the TextBox with an alternate data entry Web control.</span></span>


## <a name="step-3-adding-the-validation-controls-to-the-gridviewsedititemtemplate-s"></a><span data-ttu-id="fdf6e-166">步驟 3：將驗證控制項新增至 GridView 的`EditItemTemplate`s</span><span class="sxs-lookup"><span data-stu-id="fdf6e-166">Step 3: Adding the Validation Controls to the GridView's`EditItemTemplate` s</span></span>

<span data-ttu-id="fdf6e-167">當建構資料輸入表單，很重要，使用者輸入任何必要的欄位和所有提供的輸入是法律、 格式正確的值。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-167">When constructing data entry forms, it is important that users enter any required fields and that all provided inputs are legal, properly-formatted values.</span></span> <span data-ttu-id="fdf6e-168">為了協助確保使用者的輸入都有效，ASP.NET 會提供五個內建的驗證控制項專為用來驗證單一的輸入控制項的值：</span><span class="sxs-lookup"><span data-stu-id="fdf6e-168">To help ensure that a user's inputs are valid, ASP.NET provides five built-in validation controls that are designed to be used to validate the value of a single input control:</span></span>

- <span data-ttu-id="fdf6e-169">[RequiredFieldValidator](https://msdn.microsoft.com/library/5hbw267h(VS.80).aspx)可確保已提供的值</span><span class="sxs-lookup"><span data-stu-id="fdf6e-169">[RequiredFieldValidator](https://msdn.microsoft.com/library/5hbw267h(VS.80).aspx) ensures that a value has been provided</span></span>
- <span data-ttu-id="fdf6e-170">[CompareValidator](https://msdn.microsoft.com/library/db330ayw(VS.80).aspx)驗證值與另一個 Web 控制項的值或常數的值，或可確保值的格式是合法的指定的資料型別</span><span class="sxs-lookup"><span data-stu-id="fdf6e-170">[CompareValidator](https://msdn.microsoft.com/library/db330ayw(VS.80).aspx) validates a value against another Web control value or a constant value, or ensures that the value's format is legal for a specified data type</span></span>
- <span data-ttu-id="fdf6e-171">[RangeValidator](https://msdn.microsoft.com/library/f70d09xt.aspx)確保值的值範圍內</span><span class="sxs-lookup"><span data-stu-id="fdf6e-171">[RangeValidator](https://msdn.microsoft.com/library/f70d09xt.aspx) ensures that a value is within a range of values</span></span>
- <span data-ttu-id="fdf6e-172">[RegularExpressionValidator](https://msdn.microsoft.com/library/eahwtc9e.aspx)驗證值[規則運算式](http://en.wikipedia.org/wiki/Regular_expression)</span><span class="sxs-lookup"><span data-stu-id="fdf6e-172">[RegularExpressionValidator](https://msdn.microsoft.com/library/eahwtc9e.aspx) validates a value against a [regular expression](http://en.wikipedia.org/wiki/Regular_expression)</span></span>
- <span data-ttu-id="fdf6e-173">[CustomValidator](https://msdn.microsoft.com/library/9eee01cx(VS.80).aspx)驗證值，以符合自訂的使用者定義的方法</span><span class="sxs-lookup"><span data-stu-id="fdf6e-173">[CustomValidator](https://msdn.microsoft.com/library/9eee01cx(VS.80).aspx) validates a value against a custom, user-defined method</span></span>

<span data-ttu-id="fdf6e-174">如需有關這些五個控制項的詳細資訊，請參閱[驗證控制項 」 一節](https://quickstarts.asp.net/quickstartv20/aspnet/doc/ctrlref/validation/default.aspx)的[ASP.NET 快速入門教學課程](https://asp.net/QuickStart/aspnet/)。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-174">For more information on these five controls, check out the [Validation Controls section](https://quickstarts.asp.net/quickstartv20/aspnet/doc/ctrlref/validation/default.aspx) of the [ASP.NET Quickstart Tutorials](https://asp.net/QuickStart/aspnet/).</span></span>

<span data-ttu-id="fdf6e-175">本教學課程中，我們將需要使用在 DetailsView 和 GridView 的 RequiredFieldValidator `ProductName` TemplateFields 和 DetailsView 中的 RequiredFieldValidator `UnitPrice` TemplateField。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-175">For our tutorial we'll need to use a RequiredFieldValidator in both the DetailsView and GridView's `ProductName` TemplateFields and a RequiredFieldValidator in the DetailsView's `UnitPrice` TemplateField.</span></span> <span data-ttu-id="fdf6e-176">此外，我們需要加入這兩個控制項的 CompareValidator `UnitPrice` TemplateFields，以確保輸入的價格大於或等於 0 的值，並以有效的貨幣格式顯示。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-176">Furthermore, we'll need to add a CompareValidator to both controls' `UnitPrice` TemplateFields that ensures that the entered price has a value greater than or equal to 0 and is presented in a valid currency format.</span></span>

> [!NOTE]
> <span data-ttu-id="fdf6e-177">雖然 ASP.NET 1.x 有這些相同的五個驗證控制項、 ASP.NET 2.0 新增了一些改進功能、 主要兩位用戶端指令碼支援非 Internet Explorer 的瀏覽器和到頁面上的資料分割驗證控制項的能力驗證群組。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-177">While ASP.NET 1.x had these same five validation controls, ASP.NET 2.0 has added a number of improvements, the main two being client-side script support for browsers other than Internet Explorer and the ability to partition validation controls on a page into validation groups.</span></span> <span data-ttu-id="fdf6e-178">如需有關 2.0 中新的驗證控制項功能的詳細資訊，請參閱[剖析 ASP.NET 2.0 中的驗證控制項](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx)。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-178">For more information on the new validation control features in 2.0, refer to [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx).</span></span>


<span data-ttu-id="fdf6e-179">讓我們開始新增必要的驗證控制項，以`EditItemTemplate`GridView 的 TemplateFields。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-179">Let's start by adding the necessary validation controls to the `EditItemTemplate` s in the GridView's TemplateFields.</span></span> <span data-ttu-id="fdf6e-180">若要這麼做，按一下 GridView 的智慧標籤，即可啟動 [編輯範本] 介面中的 [編輯範本] 連結。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-180">To accomplish this, click on the Edit Templates link from the GridView's smart tag to bring up the template editing interface.</span></span> <span data-ttu-id="fdf6e-181">從這裡開始，您可以選取要從下拉式清單中編輯的範本。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-181">From here, you can select which template to edit from the drop-down list.</span></span> <span data-ttu-id="fdf6e-182">因為我們想要擴充的編輯介面，我們需要將驗證控制項加入`ProductName`並`UnitPrice`的`EditItemTemplate`s。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-182">Since we want to augment the editing interface, we need to add validation controls to the `ProductName` and `UnitPrice`'s `EditItemTemplate` s.</span></span>


[![W<span data-ttu-id="fdf6e-183">e 需要擴充產品名稱和單價的 EditItemTemplates]</span><span class="sxs-lookup"><span data-stu-id="fdf6e-183">e Need to Extend the ProductName and UnitPrice's EditItemTemplates]</span></span>(adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image11.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image10.png)

<span data-ttu-id="fdf6e-184">**圖 4**:我們需要延長`ProductName`並`UnitPrice`的`EditItemTemplate`s ([按一下以檢視完整大小的影像](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="fdf6e-184">**Figure 4**: We Need to Extend the `ProductName` and `UnitPrice`'s `EditItemTemplate` s ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image12.png))</span></span>


<span data-ttu-id="fdf6e-185">在  `ProductName` `EditItemTemplate`，藉由將它從 工具箱 拖曳至範本的編輯介面，加入 RequiredFieldValidator 放後的文字方塊中。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-185">In the `ProductName` `EditItemTemplate`, add a RequiredFieldValidator by dragging it from the Toolbox into the template editing interface, placing after the TextBox.</span></span>


[![A<span data-ttu-id="fdf6e-186">dd 到 ProductName EditItemTemplate RequiredFieldValidator]</span><span class="sxs-lookup"><span data-stu-id="fdf6e-186">dd a RequiredFieldValidator to the ProductName EditItemTemplate]</span></span>(adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image14.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image13.png)

<span data-ttu-id="fdf6e-187">**圖 5**:新增至 RequiredFieldValidator `ProductName` `EditItemTemplate` ([按一下以檢視完整大小的影像](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="fdf6e-187">**Figure 5**: Add a RequiredFieldValidator to the `ProductName` `EditItemTemplate` ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image15.png))</span></span>


<span data-ttu-id="fdf6e-188">所有驗證控制項來都處理驗證單一 ASP.NET Web 控制項的輸入。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-188">All validation controls work by validating the input of a single ASP.NET Web control.</span></span> <span data-ttu-id="fdf6e-189">因此，我們要指出我們剛才加入 RequiredFieldValidator 應該驗證在文字方塊`EditItemTemplate`; 這可以藉由設定驗證控制項[ControlToValidate 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.controltovalidate(VS.80).aspx)至`ID`適當的 Web 控制項。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-189">Therefore, we need to indicate that the RequiredFieldValidator we just added should validate against the TextBox in the `EditItemTemplate`; this is accomplished by setting the validation control's [ControlToValidate property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.controltovalidate(VS.80).aspx) to the `ID` of the appropriate Web control.</span></span> <span data-ttu-id="fdf6e-190">[] 文字方塊中目前有相當的描述性`ID`的`TextBox1`，但讓我們將它變更為更適當。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-190">The TextBox currently has the rather nondescript `ID` of `TextBox1`, but let's change it to something more appropriate.</span></span> <span data-ttu-id="fdf6e-191">在文字方塊中，在範本上按一下，然後，從 [屬性] 視窗中，變更`ID`從`TextBox1`至`EditProductName`。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-191">Click on the TextBox in the template and then, from the Properties window, change the `ID` from `TextBox1` to `EditProductName`.</span></span>


[![C<span data-ttu-id="fdf6e-192">變更文字方塊的 EditProductName ID]</span><span class="sxs-lookup"><span data-stu-id="fdf6e-192">hange the TextBox's ID to EditProductName]</span></span>(adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image17.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image16.png)

<span data-ttu-id="fdf6e-193">**圖 6**:變更文字方塊的`ID`要`EditProductName`([按一下以檢視完整大小的影像](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="fdf6e-193">**Figure 6**: Change the TextBox's `ID` to `EditProductName` ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image18.png))</span></span>


<span data-ttu-id="fdf6e-194">接下來，設定 RequiredFieldValidator`ControlToValidate`屬性設`EditProductName`。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-194">Next, set the RequiredFieldValidator's `ControlToValidate` property to `EditProductName`.</span></span> <span data-ttu-id="fdf6e-195">最後，設定[ErrorMessage 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.errormessage(VS.80).aspx)「 您必須提供的產品名稱 」，[文字屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.text(VS.80).aspx)來 「\*"。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-195">Finally, set the [ErrorMessage property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.errormessage(VS.80).aspx) to "You must provide the product's name" and the [Text property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.text(VS.80).aspx) to "\*".</span></span> <span data-ttu-id="fdf6e-196">`Text`屬性值，如果提供，是在驗證失敗時，會將驗證控制項所顯示的文字。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-196">The `Text` property value, if provided, is the text that is displayed by the validation control if the validation fails.</span></span> <span data-ttu-id="fdf6e-197">`ErrorMessage`屬性值，也就是必要項目，由 ValidationSummary 控制項; 如果`Text`省略屬性值，則`ErrorMessage`屬性值也是無效的輸入上的驗證控制項所顯示的文字。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-197">The `ErrorMessage` property value, which is required, is used by the ValidationSummary control; if the `Text` property value is omitted, the `ErrorMessage` property value is also the text displayed by the validation control on invalid input.</span></span>

<span data-ttu-id="fdf6e-198">設定之後的 RequiredFieldValidator 這三個屬性，您的畫面看起來應該類似於 圖 7。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-198">After setting these three properties of the RequiredFieldValidator, your screen should look similar to Figure 7.</span></span>


[![S<span data-ttu-id="fdf6e-199">et RequiredFieldValidator ControlToValidate、 錯誤訊息和文字屬性]</span><span class="sxs-lookup"><span data-stu-id="fdf6e-199">et the RequiredFieldValidator's ControlToValidate, ErrorMessage, and Text Properties]</span></span>(adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image20.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image19.png)

<span data-ttu-id="fdf6e-200">**圖 7**:設定 RequiredFieldValidator `ControlToValidate`， `ErrorMessage`，並`Text`屬性 ([按一下以檢視完整大小的影像](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="fdf6e-200">**Figure 7**: Set the RequiredFieldValidator's `ControlToValidate`, `ErrorMessage`, and `Text` Properties ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image21.png))</span></span>


<span data-ttu-id="fdf6e-201">使用新增至 RequiredFieldValidator `ProductName` `EditItemTemplate`，則所有剩下是加入必要的驗證，以`UnitPrice` `EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-201">With the RequiredFieldValidator added to the `ProductName` `EditItemTemplate`, all that remains is to add the necessary validation to the `UnitPrice` `EditItemTemplate`.</span></span> <span data-ttu-id="fdf6e-202">因為我們已決定，此頁面上，針對`UnitPrice`選擇性當編輯一筆記錄，我們不需要新增 RequiredFieldValidator。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-202">Since we've decided that, for this page, the `UnitPrice` is optional when editing a record, we don't need to add a RequiredFieldValidator.</span></span> <span data-ttu-id="fdf6e-203">我們，不過，需要新增以確保 CompareValidator `UnitPrice`，提供，如果已正確格式化為貨幣，且大於或等於 0。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-203">We do, however, need to add a CompareValidator to ensure that the `UnitPrice`, if supplied, is properly formatted as a currency and is greater than or equal to 0.</span></span>

<span data-ttu-id="fdf6e-204">我們將新增至 CompareValidator 之前`UnitPrice` `EditItemTemplate`，讓我們先將變更從 TextBox Web 控制項的 ID`TextBox2`至`EditUnitPrice`。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-204">Before we add the CompareValidator to the `UnitPrice` `EditItemTemplate`, let's first change the TextBox Web control's ID from `TextBox2` to `EditUnitPrice`.</span></span> <span data-ttu-id="fdf6e-205">完成此變更之後，新增 CompareValidator，設定其`ControlToValidate`屬性，以`EditUnitPrice`、 其`ErrorMessage`屬性，以 「 價格必須大於或等於零，而且不能包含貨幣符號"並將其`Text`屬性"\*".</span><span class="sxs-lookup"><span data-stu-id="fdf6e-205">After making this change, add the CompareValidator, setting its `ControlToValidate` property to `EditUnitPrice`, its `ErrorMessage` property to "The price must be greater than or equal to zero and cannot include the currency symbol", and its `Text` property to "\*".</span></span>

<span data-ttu-id="fdf6e-206">表示`UnitPrice`值必須是大於或等於 0，設定的 CompareValidator[運算子屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.operator(VS.80).aspx)要`GreaterThanEqual`、 其[ValueToCompare 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.valuetocompare(VS.80).aspx)"0"，和其[型別屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basecomparevalidator.type.aspx)至`Currency`。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-206">To indicate that the `UnitPrice` value must be greater than or equal to 0, set the CompareValidator's [Operator property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.operator(VS.80).aspx) to `GreaterThanEqual`, its [ValueToCompare property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.valuetocompare(VS.80).aspx) to "0", and its [Type property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basecomparevalidator.type.aspx) to `Currency`.</span></span> <span data-ttu-id="fdf6e-207">下列宣告式語法示範`UnitPrice`TemplateField 的`EditItemTemplate`在進行這些變更之後：</span><span class="sxs-lookup"><span data-stu-id="fdf6e-207">The following declarative syntax shows the `UnitPrice` TemplateField's `EditItemTemplate` after these changes have been made:</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/samples/sample3.aspx)]

<span data-ttu-id="fdf6e-208">進行這些變更之後，請在瀏覽器中開啟頁面。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-208">After making these changes, open the page in a browser.</span></span> <span data-ttu-id="fdf6e-209">如果您嘗試以省略名稱，或編輯產品時，請輸入不正確的價格值，則會在文字方塊旁邊出現星號。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-209">If you attempt to omit the name or enter an invalid price value when editing a product, an asterisk appears next to the textbox.</span></span> <span data-ttu-id="fdf6e-210">如 [圖 8] 所示，包含貨幣符號，例如 $19.95 價格值會被視為無效。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-210">As Figure 8 shows, a price value that includes the currency symbol such as $19.95 is considered invalid.</span></span> <span data-ttu-id="fdf6e-211">CompareValidator `Currency` `Type`可讓數字分隔符號 （例如逗號或句號，根據文化特性設定而定） 和前置加號或減號，但*不*允許貨幣符號。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-211">The CompareValidator's `Currency` `Type` allows for digit separators (such as commas or periods, depending on the culture settings) and a leading plus or minus sign, but does *not* permit a currency symbol.</span></span> <span data-ttu-id="fdf6e-212">此行為可能 perplex 使用者，因為編輯介面目前呈現`UnitPrice`使用貨幣格式。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-212">This behavior may perplex users as the editing interface currently renders the `UnitPrice` using the currency format.</span></span>

> [!NOTE]
> <span data-ttu-id="fdf6e-213">請注意，在*與插入、 更新和刪除相關聯的事件*教學課程中，我們設定 BoundField`DataFormatString`屬性設`{0:c}`才能將它格式化為貨幣。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-213">Recall that in the *Events Associated with Inserting, Updating, and Deleting* tutorial we set the BoundField's `DataFormatString` property to `{0:c}` in order to format it as a currency.</span></span> <span data-ttu-id="fdf6e-214">此外，我們會設定`ApplyFormatInEditMode`屬性設為 true，造成 GridView 的編輯介面，以格式化`UnitPrice`為貨幣。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-214">Furthermore, we set the `ApplyFormatInEditMode` property to true, causing the GridView's editing interface to format the `UnitPrice` as a currency.</span></span> <span data-ttu-id="fdf6e-215">Visual Studio 時轉換為 TemplateField BoundField，記下這些設定，並格式化文字方塊的`Text`屬性為貨幣，使用資料繫結語法`<%# Bind("UnitPrice", "{0:c}") %>`。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-215">When converting the BoundField into a TemplateField, Visual Studio noted these settings and formatted the TextBox's `Text` property as a currency using the databinding syntax `<%# Bind("UnitPrice", "{0:c}") %>`.</span></span>


[![A<span data-ttu-id="fdf6e-216">具有無效的輸入文字方塊旁邊出現星號 n]</span><span class="sxs-lookup"><span data-stu-id="fdf6e-216">n Asterisk Appears Next to the Textboxes with Invalid Input]</span></span>(adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image23.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image22.png)

<span data-ttu-id="fdf6e-217">**圖 8**:星號會出現下一個具有無效的輸入文字方塊 ([按一下以檢視完整大小的影像](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="fdf6e-217">**Figure 8**: An Asterisk Appears Next to the Textboxes with Invalid Input ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image24.png))</span></span>


<span data-ttu-id="fdf6e-218">同時做為驗證運作方式-就是，使用者必須手動編輯記錄，這不是可接受時，移除的貨幣符號。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-218">While the validation works as-is, the user has to manually remove the currency symbol when editing a record, which is not acceptable.</span></span> <span data-ttu-id="fdf6e-219">若要解決此問題，我們有三個選項：</span><span class="sxs-lookup"><span data-stu-id="fdf6e-219">To remedy this, we have three options:</span></span>

1. <span data-ttu-id="fdf6e-220">設定`EditItemTemplate`以便`UnitPrice`值不格式化為貨幣。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-220">Configure the `EditItemTemplate` so that the `UnitPrice` value is not formatted as a currency.</span></span>
2. <span data-ttu-id="fdf6e-221">可讓使用者藉由移除 CompareValidator RegularExpressionValidator 會正確檢查是格式正確的貨幣值，以取代輸入貨幣符號。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-221">Allow the user to enter a currency symbol by removing the CompareValidator and replacing it with a RegularExpressionValidator that properly checks for a properly formatted currency value.</span></span> <span data-ttu-id="fdf6e-222">此處的問題是要驗證之貨幣值的規則運算式不是完美，需要撰寫程式碼，如果我們想要納入的文化特性設定。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-222">The problem here is that the regular expression to validate a currency value is not pretty and would require writing code if we wanted to incorporate culture settings.</span></span>
3. <span data-ttu-id="fdf6e-223">完全移除驗證控制項，並依賴伺服器端驗證邏輯，在 GridView 的`RowUpdating`事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-223">Remove the validation control altogether and rely on server-side validation logic in the GridView's `RowUpdating` event handler.</span></span>

<span data-ttu-id="fdf6e-224">讓我們針對此練習的選項 #1。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-224">Let's go with option #1 for this exercise.</span></span> <span data-ttu-id="fdf6e-225">目前`UnitPrice`格式化為貨幣，因為文字方塊中的資料繫結運算式`EditItemTemplate`: `<%# Bind("UnitPrice", "{0:c}") %>`。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-225">Currently the `UnitPrice` is formatted as a currency due to the databinding expression for the TextBox in the `EditItemTemplate`: `<%# Bind("UnitPrice", "{0:c}") %>`.</span></span> <span data-ttu-id="fdf6e-226">變更繫結陳述式來`Bind("UnitPrice", "{0:n2}")`，它將結果格式化為兩位數的有效位數的數字。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-226">Change the Bind statement to `Bind("UnitPrice", "{0:n2}")`, which formats the result as a number with two digits of precision.</span></span> <span data-ttu-id="fdf6e-227">這可以直接透過宣告式語法，或從 編輯資料繫結 連結，即可完成`EditUnitPrice`中的文字方塊`UnitPrice`TemplateField 的`EditItemTemplate`（請參閱 圖 9 和 10）。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-227">This can be done directly through the declarative syntax or by clicking on the Edit DataBindings link from the `EditUnitPrice` TextBox in the `UnitPrice` TemplateField's `EditItemTemplate` (see Figures 9 and 10).</span></span>


[![C<span data-ttu-id="fdf6e-228">按一下文字方塊的編輯資料繫結連結]</span><span class="sxs-lookup"><span data-stu-id="fdf6e-228">lick on the TextBox's Edit DataBindings link]</span></span>(adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image26.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image25.png)

<span data-ttu-id="fdf6e-229">**圖 9**:按一下文字方塊的編輯資料繫結連結 ([按一下以檢視完整大小的影像](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="fdf6e-229">**Figure 9**: Click on the TextBox's Edit DataBindings link ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image27.png))</span></span>


[![S<span data-ttu-id="fdf6e-230">指定繫結陳述式中的格式規範]</span><span class="sxs-lookup"><span data-stu-id="fdf6e-230">pecify the Format Specifier in the Bind Statement]</span></span>(adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image29.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image28.png)

<span data-ttu-id="fdf6e-231">**圖 10**:指定中的格式規範`Bind`陳述式 ([按一下以檢視完整大小的影像](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="fdf6e-231">**Figure 10**: Specify the Format Specifier in the `Bind` Statement ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image30.png))</span></span>


<span data-ttu-id="fdf6e-232">透過這項變更，編輯介面中格式化的價格包含做為群組分隔符號的逗號和句號當做十進位分隔符號，但缺乏的貨幣符號。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-232">With this change, the formatted price in the editing interface includes commas as the group separator and a period as the decimal separator, but leaves off the currency symbol.</span></span>

> [!NOTE]
> <span data-ttu-id="fdf6e-233">`UnitPrice` `EditItemTemplate`不包含 RequiredFieldValidator，允許以發生回傳和更新的邏輯，以開始進行。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-233">The `UnitPrice` `EditItemTemplate` doesn't include a RequiredFieldValidator, allowing the postback to ensue and the updating logic to commence.</span></span> <span data-ttu-id="fdf6e-234">不過，`RowUpdating`從複製的事件處理常式*檢查與插入、 更新和刪除事件相關聯*教學課程包含以程式設計方式檢查，可確保`UnitPrice`提供。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-234">However, the `RowUpdating` event handler copied over from the *Examining the Events Associated with Inserting, Updating, and Deleting* tutorial includes a programmatic check that ensures that the `UnitPrice` is provided.</span></span> <span data-ttu-id="fdf6e-235">歡迎您移除此邏輯，請將它保留在為-，或新增至 RequiredFieldValidator `UnitPrice` `EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-235">Feel free to remove this logic, leave it in as-is, or add a RequiredFieldValidator to the `UnitPrice` `EditItemTemplate`.</span></span>


## <a name="step-4-summarizing-data-entry-problems"></a><span data-ttu-id="fdf6e-236">步驟 4：彙總資料輸入問題</span><span class="sxs-lookup"><span data-stu-id="fdf6e-236">Step 4: Summarizing Data Entry Problems</span></span>

<span data-ttu-id="fdf6e-237">ASP.NET 包含五個驗證控制項，除了[ValidationSummary 控制項](https://msdn.microsoft.com/library/f9h59855(VS.80).aspx)，用來顯示`ErrorMessage`之驗證控制項偵測到無效的資料。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-237">In addition to the five validation controls, ASP.NET includes the [ValidationSummary control](https://msdn.microsoft.com/library/f9h59855(VS.80).aspx), which displays the `ErrorMessage` s of those validation controls that detected invalid data.</span></span> <span data-ttu-id="fdf6e-238">此摘要的資料可以顯示為網頁上或透過強制回應的用戶端的訊息方塊的文字。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-238">This summary data can be displayed as text on the web page or through a modal, client-side messagebox.</span></span> <span data-ttu-id="fdf6e-239">讓我們來增強本教學課程，包括用戶端 messagebox 進行任何驗證問題的摘要。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-239">Let's enhance this tutorial to include a client-side messagebox summarizing any validation problems.</span></span>

<span data-ttu-id="fdf6e-240">若要這麼做，請從 [工具箱] 拖曳至設計工具拖曳 ValidationSummary 控制項。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-240">To accomplish this, drag a ValidationSummary control from the Toolbox onto the Designer.</span></span> <span data-ttu-id="fdf6e-241">驗證控制項的位置並不很重要，因為我們要將它設定為只會顯示摘要為 messagebox。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-241">The location of the Validation control doesn't really matter, since we're going to configure it to only display the summary as a messagebox.</span></span> <span data-ttu-id="fdf6e-242">加入控制項之後, 設定其[ShowSummary 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showsummary(VS.80).aspx)要`false`及其[ShowMessageBox 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showmessagebox(VS.80).aspx)到`true`。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-242">After adding the control, set its [ShowSummary property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showsummary(VS.80).aspx) to `false` and its [ShowMessageBox property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showmessagebox(VS.80).aspx) to `true`.</span></span> <span data-ttu-id="fdf6e-243">此步驟中，任何驗證錯誤摘要說明在用戶端 messagebox 中。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-243">With this addition, any validation errors are summarized in a client-side messagebox.</span></span>


[![T<span data-ttu-id="fdf6e-244">用戶端 Messagebox 將摘要列出他驗證錯誤]</span><span class="sxs-lookup"><span data-stu-id="fdf6e-244">he Validation Errors are Summarized in a Client-Side Messagebox]</span></span>(adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image32.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image31.png)

<span data-ttu-id="fdf6e-245">**圖 11**:驗證錯誤會摘要在用戶端 Messagebox ([按一下以檢視完整大小的影像](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="fdf6e-245">**Figure 11**: The Validation Errors are Summarized in a Client-Side Messagebox ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image33.png))</span></span>


## <a name="step-5-adding-the-validation-controls-to-the-detailsviewsinsertitemtemplate"></a><span data-ttu-id="fdf6e-246">步驟 5：將驗證控制項新增至 DetailsView`InsertItemTemplate`</span><span class="sxs-lookup"><span data-stu-id="fdf6e-246">Step 5: Adding the Validation Controls to the DetailsView's`InsertItemTemplate`</span></span>

<span data-ttu-id="fdf6e-247">所有在此教學課程是將驗證控制項新增至 DetailsView 插入的介面。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-247">All that remains for this tutorial is to add the validation controls to the DetailsView's inserting interface.</span></span> <span data-ttu-id="fdf6e-248">將驗證控制項新增至 DetailsView 範本的程序等同於在步驟 3 中，檢查因此，我們將快速瀏覽此步驟中的工作。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-248">The process of adding validation controls to the DetailsView's templates is identical to that examined in Step 3; therefore, we'll breeze through the task in this step.</span></span> <span data-ttu-id="fdf6e-249">使用 GridView 的一樣`EditItemTemplate`s，建議您重新命名`ID`從描述性文字方塊之`TextBox1`和`TextBox2`來`InsertProductName`和`InsertUnitPrice`。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-249">As we did with the GridView's `EditItemTemplate` s, I encourage you to rename the `ID` s of the TextBoxes from the nondescript `TextBox1` and `TextBox2` to `InsertProductName` and `InsertUnitPrice`.</span></span>

<span data-ttu-id="fdf6e-250">新增至 RequiredFieldValidator `ProductName` `InsertItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-250">Add a RequiredFieldValidator to the `ProductName` `InsertItemTemplate`.</span></span> <span data-ttu-id="fdf6e-251">設定`ControlToValidate`來`ID`的文字方塊中，在範本中，其`Text`屬性，以 「\*"並將其`ErrorMessage`「 您必須提供的產品名稱 」 屬性。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-251">Set the `ControlToValidate` to the `ID` of the TextBox in the template, its `Text` property to "\*" and its `ErrorMessage` property to "You must provide the product's name".</span></span>

<span data-ttu-id="fdf6e-252">由於`UnitPrice`是當手寫筆新記錄時，所需的此頁面，新增至 RequiredFieldValidator `UnitPrice` `InsertItemTemplate`，將其`ControlToValidate`， `Text`，和`ErrorMessage`屬性適當地。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-252">Since the `UnitPrice` is required for this page when adding a new record, add a RequiredFieldValidator to the `UnitPrice` `InsertItemTemplate`, setting its `ControlToValidate`, `Text`, and `ErrorMessage` properties appropriately.</span></span> <span data-ttu-id="fdf6e-253">最後，新增至 CompareValidator `UnitPrice` `InsertItemTemplate` ，設定其`ControlToValidate`， `Text`， `ErrorMessage`， `Type`， `Operator`，以及`ValueToCompare`屬性就像我們一樣`UnitPrice`的 GridView 內的 CompareValidator `EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-253">Finally, add a CompareValidator to the `UnitPrice` `InsertItemTemplate` as well, configuring its `ControlToValidate`, `Text`, `ErrorMessage`, `Type`, `Operator`, and `ValueToCompare` properties just like we did with the `UnitPrice`'s CompareValidator in the GridView's `EditItemTemplate`.</span></span>

<span data-ttu-id="fdf6e-254">之後新增這些驗證控制項，無法新增至系統，如果未提供其名稱，或其價格是負數或非法格式化一個新的產品。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-254">After adding these validation controls, a new product cannot be added to the system if its name is not supplied or if its price is a negative number or illegally formatted.</span></span>


[![V<span data-ttu-id="fdf6e-255">已新增邏輯，DetailsView 插入介面 alidation]</span><span class="sxs-lookup"><span data-stu-id="fdf6e-255">alidation Logic has been Added to the DetailsView's Inserting Interface]</span></span>(adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image35.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image34.png)

<span data-ttu-id="fdf6e-256">**圖 12**:驗證邏輯已新增至 DetailsView 插入介面 ([按一下以檢視完整大小的影像](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="fdf6e-256">**Figure 12**: Validation Logic has been Added to the DetailsView's Inserting Interface ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image36.png))</span></span>


## <a name="step-6-partitioning-the-validation-controls-into-validation-groups"></a><span data-ttu-id="fdf6e-257">步驟 6：資料分割成驗證群組的驗證控制項</span><span class="sxs-lookup"><span data-stu-id="fdf6e-257">Step 6: Partitioning the Validation Controls Into Validation Groups</span></span>

<span data-ttu-id="fdf6e-258">我們的頁面包含兩個以邏輯方式不同集合的驗證控制項： 與 GridView 的編輯介面，並與 DetailsView 的插入介面。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-258">Our page consists of two logically disparate sets of validation controls: those that correspond to the GridView's editing interface and those that correspond to the DetailsView's inserting interface.</span></span> <span data-ttu-id="fdf6e-259">根據預設，當會回傳*所有*簽入驗證頁面上的控制項。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-259">By default, when a postback occurs *all* validation controls on the page are checked.</span></span> <span data-ttu-id="fdf6e-260">不過，編輯一筆記錄時我們不想要驗證的 DetailsView 插入介面的驗證控制項。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-260">However, when editing a record we don't want the DetailsView's inserting interface's validation controls to validate.</span></span> <span data-ttu-id="fdf6e-261">圖 13 說明我們目前的難題，當使用者編輯的產品，完全合法的值時，按一下 更新會造成驗證錯誤，因為插入的介面中的名稱和價格的值為空白。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-261">Figure 13 illustrates our current dilemma when a user is editing a product with perfectly legal values, clicking Update causes a validation error because the name and price values in the inserting interface are blank.</span></span>


[![U<span data-ttu-id="fdf6e-262">pdating 產品會造成引發插入之介面的驗證控制項]</span><span class="sxs-lookup"><span data-stu-id="fdf6e-262">pdating a Product Causes the Inserting Interface's Validation Controls to Fire]</span></span>(adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image38.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image37.png)

<span data-ttu-id="fdf6e-263">**圖 13**:更新產品會造成引發插入之介面的驗證控制項 ([按一下以檢視完整大小的影像](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="fdf6e-263">**Figure 13**: Updating a Product Causes the Inserting Interface's Validation Controls to Fire ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image39.png))</span></span>


<span data-ttu-id="fdf6e-264">ASP.NET 2.0 中的驗證控制項可以分割成透過驗證群組其`ValidationGroup`屬性。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-264">The validation controls in ASP.NET 2.0 can be partitioned into validation groups through their `ValidationGroup` property.</span></span> <span data-ttu-id="fdf6e-265">若要建立一組驗證控制項群組中的關聯，請設定其`ValidationGroup`屬性設為相同的值。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-265">To associate a set of validation controls in a group, simply set their `ValidationGroup` property to the same value.</span></span> <span data-ttu-id="fdf6e-266">教學課程中，設定`ValidationGroup`GridView 的 TemplateFields，若要在驗證控制項的屬性`EditValidationControls`而`ValidationGroup`屬性以 DetailsView TemplateFields `InsertValidationControls`。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-266">For our tutorial, set the `ValidationGroup` properties of the validation controls in the GridView's TemplateFields to `EditValidationControls` and the `ValidationGroup` properties of the DetailsView's TemplateFields to `InsertValidationControls`.</span></span> <span data-ttu-id="fdf6e-267">這些變更可直接在宣告式標記，或透過 [屬性] 視窗中使用設計工具時編輯 [範本] 介面。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-267">These changes can be done directly in the declarative markup or through the Properties window when using the Designer's edit template interface.</span></span>

<span data-ttu-id="fdf6e-268">除了驗證控制項、 按鈕和按鈕的相關的控制項，在 ASP.NET 2.0 也包含`ValidationGroup`屬性。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-268">In addition to the validation controls, the Button and Button-related controls in ASP.NET 2.0 also include a `ValidationGroup` property.</span></span> <span data-ttu-id="fdf6e-269">驗證群組的驗證程式會檢查其有效性只有當您引發具有同一個按鈕所回傳是，才`ValidationGroup`屬性設定。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-269">A validation group's validators are checked for validity only when a postback is induced by a Button that has the same `ValidationGroup` property setting.</span></span> <span data-ttu-id="fdf6e-270">例如，為了讓 DetailsView 插入按鈕來觸發`InsertValidationControls`驗證群組，我們需要設定 CommandField`ValidationGroup`屬性設`InsertValidationControls`（請參閱 圖 14）。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-270">For example, in order for the DetailsView's Insert button to trigger the `InsertValidationControls` validation group we need to set the CommandField's `ValidationGroup` property to `InsertValidationControls` (see Figure 14).</span></span> <span data-ttu-id="fdf6e-271">此外，設定 GridView 的 CommandField`ValidationGroup`屬性設`EditValidationControls`。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-271">Additionally, set the GridView's CommandField's `ValidationGroup` property to `EditValidationControls`.</span></span>


[![S<span data-ttu-id="fdf6e-272">現實 DetailsView InsertValidationControls CommandField 的 ValidationGroup 屬性]</span><span class="sxs-lookup"><span data-stu-id="fdf6e-272">et the DetailsView's CommandField's ValidationGroup property to InsertValidationControls]</span></span>(adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image41.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image40.png)

<span data-ttu-id="fdf6e-273">**圖 14**:設定 DetailsView CommandField 的`ValidationGroup`屬性，以`InsertValidationControls`([按一下以檢視完整大小的影像](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="fdf6e-273">**Figure 14**: Set the DetailsView's CommandField's `ValidationGroup` property to `InsertValidationControls` ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image42.png))</span></span>


<span data-ttu-id="fdf6e-274">在這些變更之後, 的 GridView 與 DetailsView TemplateFields 和 CommandFields 看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="fdf6e-274">After these changes, the DetailsView and GridView's TemplateFields and CommandFields should look similar to the following:</span></span>

<span data-ttu-id="fdf6e-275">DetailsView TemplateFields 和 CommandField</span><span class="sxs-lookup"><span data-stu-id="fdf6e-275">The DetailsView's TemplateFields and CommandField</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/samples/sample4.aspx)]

<span data-ttu-id="fdf6e-276">GridView 的 CommandField 和 TemplateFields</span><span class="sxs-lookup"><span data-stu-id="fdf6e-276">The GridView's CommandField and TemplateFields</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/samples/sample5.aspx)]

<span data-ttu-id="fdf6e-277">編輯特定的驗證控制項此時按一下 DetailsView 的 插入 按鈕時，解決問題以 圖 13 反白顯示時，才會引發只有在按一下 GridView 的 更新 按鈕時才和插入特定的驗證控制項引發。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-277">At this point the edit-specific validation controls fire only when the GridView's Update button is clicked and the insert-specific validation controls fire only when the DetailsView's Insert button is clicked, resolving the problem highlighted by Figure 13.</span></span> <span data-ttu-id="fdf6e-278">不過，這項變更我們 ValidationSummary 控制項不會再顯示在輸入無效的資料時。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-278">However, with this change our ValidationSummary control no longer displays when entering invalid data.</span></span> <span data-ttu-id="fdf6e-279">ValidationSummary 控制項還包含`ValidationGroup`屬性，只顯示摘要資訊的驗證控制項，其驗證群組中。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-279">The ValidationSummary control also contains a `ValidationGroup` property and only shows summary information for those validation controls in its validation group.</span></span> <span data-ttu-id="fdf6e-280">因此，我們需要將兩個驗證控制項放在這個頁面上，一個用於`InsertValidationControls`驗證群組，一個用於`EditValidationControls`。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-280">Therefore, we need to have two validation controls in this page, one for the `InsertValidationControls` validation group and one for `EditValidationControls`.</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/samples/sample6.aspx)]

<span data-ttu-id="fdf6e-281">添加這在本教學課程已完成 ！</span><span class="sxs-lookup"><span data-stu-id="fdf6e-281">With this addition our tutorial is complete!</span></span>

## <a name="summary"></a><span data-ttu-id="fdf6e-282">總結</span><span class="sxs-lookup"><span data-stu-id="fdf6e-282">Summary</span></span>

<span data-ttu-id="fdf6e-283">雖然 BoundFields 可以提供同時插入和編輯介面，該介面不是可自訂的。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-283">While BoundFields can provide both an inserting and editing interface, the interface is not customizable.</span></span> <span data-ttu-id="fdf6e-284">通常，我們想要將驗證控制項新增至編輯和插入介面來確保使用者輸入必要的輸入，合法的格式。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-284">Commonly, we want to add validation controls to the editing and inserting interface to ensure that the user enters required inputs in a legal format.</span></span> <span data-ttu-id="fdf6e-285">若要這麼做，就必須轉換 TemplateFields BoundFields，並將驗證控制項新增至適當的範本。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-285">To accomplish this we must convert the BoundFields into TemplateFields and add the validation controls to the appropriate template(s).</span></span> <span data-ttu-id="fdf6e-286">在本教學課程中，我們擴充的範例*檢查與插入、 更新和刪除事件相關聯*教學課程中，將驗證控制項新增至這兩個 DetailsView 的插入介面和 GridView 的編輯介面。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-286">In this tutorial we extended the example from the *Examining the Events Associated with Inserting, Updating, and Deleting* tutorial, adding validation controls to both the DetailsView's inserting interface and the GridView's editing interface.</span></span> <span data-ttu-id="fdf6e-287">此外，我們看到如何顯示使用 ValidationSummary 控制項的摘要驗證資訊以及如何分割成不同的驗證群組的頁面上的驗證控制項。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-287">Moreover, we saw how to display summary validation information using the ValidationSummary control and how to partition the validation controls on the page into distinct validation groups.</span></span>

<span data-ttu-id="fdf6e-288">如我們在本教學課程中所見的 TemplateFields 允許予以增加以包含驗證控制項的編輯和插入介面。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-288">As we saw in this tutorial, TemplateFields allow the editing and inserting interfaces to be augmented to include validation controls.</span></span> <span data-ttu-id="fdf6e-289">TemplateFields 也可以擴充以包含額外的輸入的 Web 控制項，讓文字方塊來取代更適合的 Web 控制項。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-289">TemplateFields can also be extended to include additional input Web controls, enabling the TextBox to be replaced by a more suitable Web control.</span></span> <span data-ttu-id="fdf6e-290">在我們的下一個教學課程中，我們將看到如何使用資料繫結 DropDownList 控制項，也就是理想的編輯外部索引鍵時取代 TextBox 控制項 (例如`CategoryID`或是`SupplierID`在`Products`資料表)。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-290">In our next tutorial we'll see how to replace the TextBox control with a data-bound DropDownList control, which is ideal when editing a foreign key (such as `CategoryID` or `SupplierID` in the `Products` table).</span></span>

<span data-ttu-id="fdf6e-291">快樂地寫程式 ！</span><span class="sxs-lookup"><span data-stu-id="fdf6e-291">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="fdf6e-292">關於作者</span><span class="sxs-lookup"><span data-stu-id="fdf6e-292">About the Author</span></span>

<span data-ttu-id="fdf6e-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，作者的七個 ASP 書籍和的創辦人[4GuysFromRolla.com](http://www.4guysfromrolla.com)，自 1998 年從事 Microsoft Web 技術工作。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="fdf6e-294">Scott 會擔任獨立的顧問、 培訓講師和作家。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-294">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="fdf6e-295">他最新的著作是[ *Sams 教導您自己 ASP.NET 2.0 在 24 小時內*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-295">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="fdf6e-296">他可以在觸達[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="fdf6e-296">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="fdf6e-297">或透過他的部落格，這位於 [http://ScottOnWriting.NET](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-297">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="fdf6e-298">特別感謝</span><span class="sxs-lookup"><span data-stu-id="fdf6e-298">Special Thanks To</span></span>

<span data-ttu-id="fdf6e-299">本教學課程系列是由許多實用的檢閱者檢閱。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-299">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="fdf6e-300">本教學課程中的潛在客戶檢閱者已 Liz Shulok 和 Zack Jones。</span><span class="sxs-lookup"><span data-stu-id="fdf6e-300">Lead reviewers for this tutorial were Liz Shulok and Zack Jones.</span></span> <span data-ttu-id="fdf6e-301">有興趣檢閱我即將推出的 MSDN 文章嗎？</span><span class="sxs-lookup"><span data-stu-id="fdf6e-301">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="fdf6e-302">如果是這樣，psychic 在[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="fdf6e-302">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="fdf6e-303">[上一頁](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md)
> [下一頁](customizing-the-data-modification-interface-cs.md)</span><span class="sxs-lookup"><span data-stu-id="fdf6e-303">[Previous](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md)
[Next](customizing-the-data-modification-interface-cs.md)</span></span>
