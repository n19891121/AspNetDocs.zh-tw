---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/common-configuration-differences-between-development-and-production-vb
title: 開發與生產環境間的常見設定差異（VB） |Microsoft Docs
author: rick-anderson
description: 在先前的教學課程中，我們會將所有相關檔案從開發環境複製到生產環境，藉以部署我們的網站。 不過，我 。
ms.author: riande
ms.date: 04/01/2009
ms.assetid: 548e75f6-4d6c-4cb4-8da8-417915eb8393
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/common-configuration-differences-between-development-and-production-vb
msc.type: authoredcontent
ms.openlocfilehash: cc65af6eb4fca8b3b805e11e26da468a958a4221
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/28/2019
ms.locfileid: "74619949"
---
# <a name="common-configuration-differences-between-development-and-production-vb"></a><span data-ttu-id="f2234-104">開發與生產環境間的常見設定差異 (VB)</span><span class="sxs-lookup"><span data-stu-id="f2234-104">Common Configuration Differences Between Development and Production (VB)</span></span>

<span data-ttu-id="f2234-105">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="f2234-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

[<span data-ttu-id="f2234-106">下載 PDF</span><span class="sxs-lookup"><span data-stu-id="f2234-106">Download PDF</span></span>](https://download.microsoft.com/download/E/8/9/E8920AE6-D441-41A7-8A77-9EF8FF970D8B/aspnet_tutorial05_ConfigDifferences_vb.pdf)

> <span data-ttu-id="f2234-107">在先前的教學課程中，我們會將所有相關檔案從開發環境複製到生產環境，藉以部署我們的網站。</span><span class="sxs-lookup"><span data-stu-id="f2234-107">In earlier tutorials we deployed our website by copying all of the pertinent files from the development environment to the production environment.</span></span> <span data-ttu-id="f2234-108">不過，環境之間的設定差異並不常見，因為每個環境都有唯一的 Web.config 檔案。</span><span class="sxs-lookup"><span data-stu-id="f2234-108">However, it is not uncommon for there to be configuration differences between environments, which necessitates that each environment have a unique Web.config file.</span></span> <span data-ttu-id="f2234-109">本教學課程會檢查一般設定差異，並查看維護個別設定資訊的策略。</span><span class="sxs-lookup"><span data-stu-id="f2234-109">This tutorial examines typical configuration differences and looks at strategies for maintaining separate configuration information.</span></span>

## <a name="introduction"></a><span data-ttu-id="f2234-110">簡介</span><span class="sxs-lookup"><span data-stu-id="f2234-110">Introduction</span></span>

<span data-ttu-id="f2234-111">最後兩個教學課程逐步解說如何部署簡單的 web 應用程式。</span><span class="sxs-lookup"><span data-stu-id="f2234-111">The last two tutorials walked through deploying a simple web application.</span></span> <span data-ttu-id="f2234-112">[*使用 FTP 用戶端部署您的網站*](deploying-your-site-using-an-ftp-client-vb.md)教學課程示範如何使用獨立的 FTP 用戶端，將所需的檔案從開發環境複製到生產環境。</span><span class="sxs-lookup"><span data-stu-id="f2234-112">The [*Deploying Your Site Using an FTP Client*](deploying-your-site-using-an-ftp-client-vb.md) tutorial showed how to use a stand-alone FTP client to copy the necessary files from the development environment up to production.</span></span> <span data-ttu-id="f2234-113">先前的教學課程[*使用 Visual Studio 部署您的網站*](deploying-your-site-using-visual-studio-vb.md)，並使用 Visual Studio 的複製網站工具和發佈選項來進行部署。</span><span class="sxs-lookup"><span data-stu-id="f2234-113">The preceding tutorial, [*Deploying Your Site Using Visual Studio*](deploying-your-site-using-visual-studio-vb.md), looked at deployment using Visual Studio's Copy Web Site tool and Publish option.</span></span> <span data-ttu-id="f2234-114">在兩個教學課程中，生產環境中的每個檔案都是開發環境上的檔案複本。</span><span class="sxs-lookup"><span data-stu-id="f2234-114">In both tutorials every file in the production environment was a copy of a file on the development environment.</span></span> <span data-ttu-id="f2234-115">不過，實際執行環境中的設定檔與開發環境中的不同，並不罕見。</span><span class="sxs-lookup"><span data-stu-id="f2234-115">However, it is not uncommon for configuration files in the production environment to differ from those in the development environment.</span></span> <span data-ttu-id="f2234-116">Web 應用程式的設定會儲存在 `Web.config` 檔案中，而且通常包含外部資源的相關資訊，例如資料庫、web 和電子郵件伺服器。</span><span class="sxs-lookup"><span data-stu-id="f2234-116">A web application's configuration is stored in the `Web.config` file and typically includes information about external resources, such as database, web, and email servers.</span></span> <span data-ttu-id="f2234-117">在某些情況下，它也會說明應用程式的行為，例如在未處理的例外狀況發生時所採取的動作。</span><span class="sxs-lookup"><span data-stu-id="f2234-117">It also spells out the behavior of the application in certain situations, such as the course of action to take when an unhandled exception occurs.</span></span>

<span data-ttu-id="f2234-118">部署 web 應用程式時，正確的設定資訊必須在生產環境中結束。</span><span class="sxs-lookup"><span data-stu-id="f2234-118">When deploying a web application it is important that the correct configuration information end up in the production environment.</span></span> <span data-ttu-id="f2234-119">在大多數情況下，開發環境中的 `Web.config` 檔案無法依原樣複製到生產環境。</span><span class="sxs-lookup"><span data-stu-id="f2234-119">In most cases the `Web.config` file in the development environment cannot be copied to the production environment as-is.</span></span> <span data-ttu-id="f2234-120">而是必須將自訂版本的 `Web.config` 上傳到生產環境。</span><span class="sxs-lookup"><span data-stu-id="f2234-120">Instead, a customized version of `Web.config` needs to be uploaded to production.</span></span> <span data-ttu-id="f2234-121">本教學課程簡要回顧一些較常見的設定差異;它也會摘要說明在環境之間維護不同設定資訊的一些技術。</span><span class="sxs-lookup"><span data-stu-id="f2234-121">This tutorial briefly reviews some of the more common configuration differences; it also summarizes some techniques for maintaining different configuration information between the environments.</span></span>

## <a name="typical-configuration-differences-between-the-development-and-production-environments"></a><span data-ttu-id="f2234-122">開發與生產環境之間的一般設定差異</span><span class="sxs-lookup"><span data-stu-id="f2234-122">Typical Configuration Differences Between the Development and Production Environments</span></span>

<span data-ttu-id="f2234-123">`Web.config` 檔案包含 ASP.NET 應用程式的各種設定資訊。</span><span class="sxs-lookup"><span data-stu-id="f2234-123">The `Web.config` file includes an assortment of configuration information for an ASP.NET application.</span></span> <span data-ttu-id="f2234-124">無論環境為何，這項設定資訊都是相同的。</span><span class="sxs-lookup"><span data-stu-id="f2234-124">Some of this configuration information is the same regardless of the environment.</span></span> <span data-ttu-id="f2234-125">比方說，不論環境為何，在 `Web.config` 檔案的 `<authentication>` 和 `<authorization>` 元素中拼出的驗證設定和 URL 授權規則通常都相同。</span><span class="sxs-lookup"><span data-stu-id="f2234-125">For instance, the authentication settings and URL authorization rules spelled out in the `Web.config` file's `<authentication>` and `<authorization>` elements are usually the same regardless of the environment.</span></span> <span data-ttu-id="f2234-126">但是其他設定資訊（例如外部資源的相關資訊）通常會因環境而有所不同。</span><span class="sxs-lookup"><span data-stu-id="f2234-126">But other configuration information - such as information about external resources - typically differs depending on the environment.</span></span>

<span data-ttu-id="f2234-127">資料庫連接字串是根據環境而有所不同之設定資訊的主要範例。</span><span class="sxs-lookup"><span data-stu-id="f2234-127">Database connections strings are a prime example of configuration information that differs based on the environment.</span></span> <span data-ttu-id="f2234-128">當 web 應用程式與資料庫伺服器通訊時，必須先建立連接，並透過[連接字串](http://www.connectionstrings.com/Articles/Show/what-is-a-connection-string)來達成此目的。</span><span class="sxs-lookup"><span data-stu-id="f2234-128">When a web application communicates with a database server it must first establish a connection, and that is achieved through a [connection string](http://www.connectionstrings.com/Articles/Show/what-is-a-connection-string).</span></span> <span data-ttu-id="f2234-129">雖然可以直接在網頁或連接到資料庫的程式碼中硬式編碼資料庫連接字串，但最好將它放在 `Web.config`的[`<connectionStrings>` 元素](https://msdn.microsoft.com/library/bf7sd233.aspx)，以便連接字串資訊位於單一的集中位置。</span><span class="sxs-lookup"><span data-stu-id="f2234-129">While it is possible to hard-code the database connection string directly in the web pages or the code that connects to the database, it is best to place it `Web.config`'s [`<connectionStrings>` element](https://msdn.microsoft.com/library/bf7sd233.aspx) so that the connection string information is in a single, centralized location.</span></span> <span data-ttu-id="f2234-130">在開發期間，通常會使用不同的資料庫，而不是在生產環境中使用;因此，每個環境的連接字串資訊都必須是唯一的。</span><span class="sxs-lookup"><span data-stu-id="f2234-130">Oftentimes a different database is used during development than is used in production; consequently, the connection string information must be unique for each environment.</span></span>

> [!NOTE]
> <span data-ttu-id="f2234-131">未來的教學課程探索如何部署資料驅動應用程式，此時我們將深入探討資料庫連接字串如何儲存在設定檔中的細節。</span><span class="sxs-lookup"><span data-stu-id="f2234-131">Future tutorials explore deploying data-driven applications, at which point we'll dive into the specifics of how database connection strings are stored in the configuration file.</span></span>

<span data-ttu-id="f2234-132">開發和生產環境的預期行為差異極大。</span><span class="sxs-lookup"><span data-stu-id="f2234-132">The intended behavior of the development and production environments differs substantially.</span></span> <span data-ttu-id="f2234-133">開發環境中的 web 應用程式是由一小組開發人員所建立、測試及進行調試。</span><span class="sxs-lookup"><span data-stu-id="f2234-133">A web application in the development environment is being created, tested, and debugged by a small group of developers.</span></span> <span data-ttu-id="f2234-134">在生產環境中，有許多不同的並行使用者正在造訪相同的應用程式。</span><span class="sxs-lookup"><span data-stu-id="f2234-134">In the production environment that same application is being visited by many different simultaneous users.</span></span> <span data-ttu-id="f2234-135">ASP.NET 包含一些可協助開發人員測試和偵測應用程式的功能，但在生產環境中，這些功能應該基於效能和安全性理由而停用。</span><span class="sxs-lookup"><span data-stu-id="f2234-135">ASP.NET includes a number of features that help developers in testing and debugging an application, but these features should be disabled for performance and security reasons when in the production environment.</span></span> <span data-ttu-id="f2234-136">讓我們來看幾個這類的設定。</span><span class="sxs-lookup"><span data-stu-id="f2234-136">Let's look at a few such configuration settings.</span></span>

### <a name="configuration-settings-that-impact-performance"></a><span data-ttu-id="f2234-137">會影響效能的設定</span><span class="sxs-lookup"><span data-stu-id="f2234-137">Configuration Settings That Impact Performance</span></span>

<span data-ttu-id="f2234-138">第一次造訪 ASP.NET 網頁時（或第一次變更之後），其宣告式標記必須轉換成類別，而且必須編譯此類別。</span><span class="sxs-lookup"><span data-stu-id="f2234-138">When an ASP.NET page is visited for the first time (or the first time after it has changed), its declarative markup must be converted into a class and this class must be compiled.</span></span> <span data-ttu-id="f2234-139">如果 web 應用程式使用自動編譯，則也需要編譯頁面的程式碼後置類別。</span><span class="sxs-lookup"><span data-stu-id="f2234-139">If the web application uses automatic compilation then the page's code-behind class needs to be compiled, too.</span></span> <span data-ttu-id="f2234-140">您可以透過 `Web.config` 檔案的[`<compilation>` 元素](https://msdn.microsoft.com/library/s10awwz0.aspx)來設定各種編譯選項。</span><span class="sxs-lookup"><span data-stu-id="f2234-140">You can configure an assortment of compilation options via the `Web.config` file's [`<compilation>` element](https://msdn.microsoft.com/library/s10awwz0.aspx).</span></span>

<span data-ttu-id="f2234-141">Debug 屬性是 `<compilation>` 元素中最重要的屬性之一。</span><span class="sxs-lookup"><span data-stu-id="f2234-141">The debug attribute is one of the most important attributes in the `<compilation>` element.</span></span> <span data-ttu-id="f2234-142">如果 `debug` 屬性設定為 "true"，則編譯的元件會包含在 Visual Studio 中對應用程式進行調試時所需的 debug 符號。</span><span class="sxs-lookup"><span data-stu-id="f2234-142">If the `debug` attribute is set to "true" then the compiled assemblies include debug symbols, which are needed when debugging an application in Visual Studio.</span></span> <span data-ttu-id="f2234-143">但是，在執行程式碼時，debug 符號會增加元件的大小，並強加額外的記憶體需求。</span><span class="sxs-lookup"><span data-stu-id="f2234-143">But debug symbols increase the size of the assembly and impose additional memory requirements when running the code.</span></span> <span data-ttu-id="f2234-144">此外，當 `debug` 屬性設定為 "true" 時，`WebResource.axd` 所傳回的任何內容都不會進行快取，這表示每次使用者造訪頁面時，都必須重新下載 `WebResource.axd`所傳回的靜態內容。</span><span class="sxs-lookup"><span data-stu-id="f2234-144">Furthermore, when the `debug` attribute is set to "true" any content returned by `WebResource.axd` is not cached, meaning that each time a user visits a page they will need to re-download the static content returned by `WebResource.axd`.</span></span>

> [!NOTE]
> <span data-ttu-id="f2234-145">`WebResource.axd` 是在 ASP.NET 2.0 中引進的內建 HTTP 處理常式，伺服器控制項可用來抓取內嵌的資源，例如腳本檔案、影像、CSS 檔案和其他內容。</span><span class="sxs-lookup"><span data-stu-id="f2234-145">`WebResource.axd` is a built-in HTTP Handler introduced in ASP.NET 2.0 that server controls use to retrieve embedded resources, such as script files, images, CSS files, and other content.</span></span> <span data-ttu-id="f2234-146">如需 `WebResource.axd` 的運作方式，以及如何使用它從自訂伺服器控制項存取內嵌資源的詳細資訊，請參閱[使用 `WebResource.axd`透過 URL 存取內嵌資源](http://aspnet.4guysfromrolla.com/articles/080906-1.aspx)。</span><span class="sxs-lookup"><span data-stu-id="f2234-146">For more information on how `WebResource.axd` works and how you can use it to access embedded resources from your custom server controls, see [Accessing Embedded Resources Through a URL Using `WebResource.axd`](http://aspnet.4guysfromrolla.com/articles/080906-1.aspx).</span></span>

<span data-ttu-id="f2234-147">在開發環境中，`<compilation>` 元素的 `debug` 屬性通常會設定為 "true"。</span><span class="sxs-lookup"><span data-stu-id="f2234-147">The `<compilation>` element's `debug` attribute is usually set to "true" in the development environment.</span></span> <span data-ttu-id="f2234-148">事實上，此屬性必須設定為 "true"，才能進行 web 應用程式的偵錯工具。如果您嘗試從 Visual Studio 中偵測到 ASP.NET 應用程式，而且 `debug` 屬性設定為 "false"，Visual Studio 將會顯示一則訊息，說明在 `debug` 屬性設定為 "true" 之前，應用程式無法進行調試，並會提供給您進行這種變更。</span><span class="sxs-lookup"><span data-stu-id="f2234-148">In fact, this attribute must be set to "true" in order to debug a web application; if you try to debug an ASP.NET application from Visual Studio and the `debug` attribute is set to "false", Visual Studio will display a message explaining that the application cannot be debugged until the `debug` attribute is set to "true" and will offer to make this change for you.</span></span>

<span data-ttu-id="f2234-149">您**絕對不**應該在生產環境中將 `debug` 屬性設為 "true"，因為它會對效能造成影響。</span><span class="sxs-lookup"><span data-stu-id="f2234-149">You should **never** have the `debug` attribute set to "true" in a production environment because of its impact on performance.</span></span> <span data-ttu-id="f2234-150">如需本主題的更完整討論，請參閱[Scott Guthrie](https://weblogs.asp.net/scottgu/)的 blog 文章，[不要執行生產 ASP.NET 應用程式並啟用 `debug="true"`](https://weblogs.asp.net/scottgu/442448)。</span><span class="sxs-lookup"><span data-stu-id="f2234-150">For a more thorough discussion on this topic, refer to [Scott Guthrie](https://weblogs.asp.net/scottgu/)'s blog post, [Don't Run Production ASP.NET Applications With `debug="true"` Enabled](https://weblogs.asp.net/scottgu/442448).</span></span>

### <a name="custom-errors-and-tracing"></a><span data-ttu-id="f2234-151">自訂錯誤和追蹤</span><span class="sxs-lookup"><span data-stu-id="f2234-151">Custom Errors and Tracing</span></span>

<span data-ttu-id="f2234-152">當 ASP.NET 應用程式中發生未處理的例外狀況時，它會反升至執行時間，此時會發生三件事的其中一個：</span><span class="sxs-lookup"><span data-stu-id="f2234-152">When an unhandled exception occurs in an ASP.NET application it bubbles up to the runtime at which point one of three things happens:</span></span>

- <span data-ttu-id="f2234-153">隨即顯示一般執行階段錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="f2234-153">A generic runtime error message is displayed.</span></span> <span data-ttu-id="f2234-154">此頁面會通知使用者發生執行階段錯誤，但未提供任何有關錯誤的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="f2234-154">This page informs the user that there was a runtime error, but does not provide any details about the error.</span></span>
- <span data-ttu-id="f2234-155">[例外狀況詳細資料] 訊息隨即顯示，其中包含剛剛擲回之例外狀況的資訊。</span><span class="sxs-lookup"><span data-stu-id="f2234-155">An exception details message is displayed, which includes information on the exception that was just thrown.</span></span>
- <span data-ttu-id="f2234-156">[自訂錯誤] 頁面隨即顯示，這是您建立的 ASP.NET 網頁，會顯示您想要的任何訊息。</span><span class="sxs-lookup"><span data-stu-id="f2234-156">A custom error page is displayed, which is an ASP.NET page that you create that displays any message you desire.</span></span>

<span data-ttu-id="f2234-157">在發生未處理的例外狀況時，會發生什麼情況，取決於 `Web.config` 檔案的[`<customErrors>` 區段](https://msdn.microsoft.com/library/h0hfz6fc.aspx)。</span><span class="sxs-lookup"><span data-stu-id="f2234-157">What happens in the face of an unhandled exception depends on the `Web.config` file's [`<customErrors>` section](https://msdn.microsoft.com/library/h0hfz6fc.aspx).</span></span>

<span data-ttu-id="f2234-158">開發和測試應用程式時，它有助於查看瀏覽器中任何例外狀況的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="f2234-158">When developing and testing an application it helps to see details of any exception in the browser.</span></span> <span data-ttu-id="f2234-159">不過，在生產環境中顯示應用程式的例外狀況詳細資料是潛在的安全性風險。</span><span class="sxs-lookup"><span data-stu-id="f2234-159">However, showing exception details in an application on production is a potential security risk.</span></span> <span data-ttu-id="f2234-160">此外，它也是 unflattering，讓您的網站看起來不夠專業。</span><span class="sxs-lookup"><span data-stu-id="f2234-160">Moreover, it's unflattering and makes your website look unprofessional.</span></span> <span data-ttu-id="f2234-161">在理想情況下，在發生未處理的例外狀況時，開發環境中的 web 應用程式將會顯示例外狀況的詳細資料，而生產環境中的相同應用程式將會顯示自訂錯誤頁面。</span><span class="sxs-lookup"><span data-stu-id="f2234-161">Ideally, in the event of an unhandled exception a web application in the development environment will show the exception's details while the same application in production will show a custom error page.</span></span>

> [!NOTE]
> <span data-ttu-id="f2234-162">預設 `<customErrors>` 區段設定只會在網頁透過 localhost 流覽時顯示例外狀況詳細資料訊息，否則會顯示 [一般執行時間錯誤] 頁面。</span><span class="sxs-lookup"><span data-stu-id="f2234-162">The default `<customErrors>` section setting shows the exception details message only when the page is being visited through localhost, and shows the generic runtime error page otherwise.</span></span> <span data-ttu-id="f2234-163">這不是理想的做法，但要知道預設行為並不會向非本機訪客顯示例外狀況詳細資料。</span><span class="sxs-lookup"><span data-stu-id="f2234-163">This isn't ideal, but it's assuring to know that the default behavior doesn't reveal exception details to non-local visitors.</span></span> <span data-ttu-id="f2234-164">未來的教學課程會更詳細地檢查 `<customErrors>` 區段，並說明在生產環境中發生錯誤時，如何顯示自訂錯誤頁面。</span><span class="sxs-lookup"><span data-stu-id="f2234-164">A future tutorial examines the `<customErrors>` section in more detail and shows how to have a custom error page shown when an error occurs in production.</span></span>

<span data-ttu-id="f2234-165">在開發期間，另一個有用的 ASP.NET 功能是追蹤。</span><span class="sxs-lookup"><span data-stu-id="f2234-165">Another ASP.NET feature that is useful during development is tracing.</span></span> <span data-ttu-id="f2234-166">追蹤（啟用時）會記錄每個連入要求的相關資訊，並提供 `Trace.axd`的特殊網頁，以用於查看最近的要求詳細資料。</span><span class="sxs-lookup"><span data-stu-id="f2234-166">Tracing, if enabled, records information about each incoming request and provides a special web page, `Trace.axd`, for viewing recent request details.</span></span> <span data-ttu-id="f2234-167">您可以透過 `Web.config`中的[`<trace>` 元素](https://msdn.microsoft.com/library/6915t83k.aspx)來開啟和設定追蹤。</span><span class="sxs-lookup"><span data-stu-id="f2234-167">You can turn on and configure tracing via the [`<trace>` element](https://msdn.microsoft.com/library/6915t83k.aspx) in `Web.config`.</span></span>

<span data-ttu-id="f2234-168">如果您啟用追蹤，請確定它已在生產環境中停用。</span><span class="sxs-lookup"><span data-stu-id="f2234-168">If you enable tracing make sure that it is disabled in production.</span></span> <span data-ttu-id="f2234-169">由於追蹤資訊包括 cookie、會話資料和其他潛在的敏感性資訊，因此在生產環境中停用追蹤是很重要的。</span><span class="sxs-lookup"><span data-stu-id="f2234-169">Because the trace information includes cookies, session data, and other potentially sensitive information, it is important to disable tracing in production.</span></span> <span data-ttu-id="f2234-170">好消息是，根據預設，會停用追蹤，而且只能透過 localhost 存取 `Trace.axd` 檔案。</span><span class="sxs-lookup"><span data-stu-id="f2234-170">The good news is that, by default, tracing is disabled and the `Trace.axd` file is only accessible through localhost.</span></span> <span data-ttu-id="f2234-171">如果您在開發中變更這些預設設定，請確定已在生產環境中將它們關閉。</span><span class="sxs-lookup"><span data-stu-id="f2234-171">If you change these default settings in development make sure that they are turned back off in production.</span></span>

## <a name="techniques-for-maintaining-separate-configuration-information"></a><span data-ttu-id="f2234-172">維護個別設定資訊的技術</span><span class="sxs-lookup"><span data-stu-id="f2234-172">Techniques for Maintaining Separate Configuration Information</span></span>

<span data-ttu-id="f2234-173">在開發和生產環境中擁有不同的設定，會使部署程式變得更複雜。</span><span class="sxs-lookup"><span data-stu-id="f2234-173">Having different configuration settings in the development and production environments complicates the deployment process.</span></span> <span data-ttu-id="f2234-174">在前兩個教學課程中，部署程式牽涉到從開發中將所有必要的檔案複製到生產環境，但這種方法僅適用于這兩種環境中的設定資訊相同。</span><span class="sxs-lookup"><span data-stu-id="f2234-174">In the previous two tutorials the deployment process involved copying all of the necessary files from development to production, but that approach only works if the configuration information is the same in both environments.</span></span> <span data-ttu-id="f2234-175">有各種不同的技術可讓您部署應用程式，並具有各種設定資訊。</span><span class="sxs-lookup"><span data-stu-id="f2234-175">There are a variety of techniques for deploying an application with varying configuration information.</span></span> <span data-ttu-id="f2234-176">讓我們為裝載的 web 應用程式，將其中一些選項分類。</span><span class="sxs-lookup"><span data-stu-id="f2234-176">Let's catalog some of these options for hosted web applications.</span></span>

### <a name="manually-deploying-the-production-environment-configuration-file"></a><span data-ttu-id="f2234-177">手動部署生產環境設定檔</span><span class="sxs-lookup"><span data-stu-id="f2234-177">Manually Deploying the Production Environment Configuration File</span></span>

<span data-ttu-id="f2234-178">最簡單的方法是維護兩個版本的 `Web.config` 檔案：一個用於開發環境，另一個用於生產環境。</span><span class="sxs-lookup"><span data-stu-id="f2234-178">The simplest approach is to maintain two versions of the `Web.config` file: one for the development environment and one for the production environment.</span></span> <span data-ttu-id="f2234-179">將網站部署到生產環境時，需要將所有檔案複製到開發環境中的實際執行伺服器，但 `Web.config` 檔案*除外*。</span><span class="sxs-lookup"><span data-stu-id="f2234-179">Deploying a site to production entails copying all of the files to the production server in the development environment *except* for the `Web.config` file.</span></span> <span data-ttu-id="f2234-180">相反地，生產環境特定 `Web.config` 檔案會複製到生產環境。</span><span class="sxs-lookup"><span data-stu-id="f2234-180">Instead, the production environment-specific `Web.config` file would be copied to production.</span></span>

<span data-ttu-id="f2234-181">這種方法並不複雜，但其實很容易實行，因為設定資訊不常變更。</span><span class="sxs-lookup"><span data-stu-id="f2234-181">This approach is not very sophisticated, but it is easy to implement because configuration information changes infrequently.</span></span> <span data-ttu-id="f2234-182">它最適合具有小型開發小組的應用程式，裝載于單一 web 伺服器上，且其設定資訊不常變更。</span><span class="sxs-lookup"><span data-stu-id="f2234-182">It works best for applications with a small development team that are hosted on a single web server and whose configuration information is infrequently changed.</span></span> <span data-ttu-id="f2234-183">當您使用獨立的 FTP 用戶端手動部署應用程式檔時，這是最 tenable 的。</span><span class="sxs-lookup"><span data-stu-id="f2234-183">It's most tenable when manually deploying the application files using a stand-alone FTP client.</span></span> <span data-ttu-id="f2234-184">使用 Visual Studio 的 [複製網站] 工具或 [發佈] 選項時，您必須先將部署特定的 `Web.config` 檔案與生產環境特定的檔案交換，然後再進行部署，然後在部署完成之後將它們交換回來。</span><span class="sxs-lookup"><span data-stu-id="f2234-184">When using Visual Studio's Copy Web Site tool or Publish option you'll need to first swap out the deployment-specific `Web.config` file with the production-specific one before deploying, and then swap them back after deployment completes.</span></span>

### <a name="change-the-configuration-during-the-build-or-deployment-process"></a><span data-ttu-id="f2234-185">在組建或部署過程中變更設定</span><span class="sxs-lookup"><span data-stu-id="f2234-185">Change the Configuration During the Build or Deployment Process</span></span>

<span data-ttu-id="f2234-186">到目前為止，我們已假設有臨機操作組建和部署程式。</span><span class="sxs-lookup"><span data-stu-id="f2234-186">The discussions thus far have assumed an ad-hoc build and deployment process.</span></span> <span data-ttu-id="f2234-187">許多較大型的軟體專案都有更正規化的程式，利用開放原始碼、家用成長或協力廠商工具。</span><span class="sxs-lookup"><span data-stu-id="f2234-187">Many larger software projects have more formalized processes that make use of open-source, home-grown, or third-party tools.</span></span> <span data-ttu-id="f2234-188">針對這類專案，您可能會自訂群組建或部署程式，以便在將設定資訊推送至生產環境之前，適當地加以修改。</span><span class="sxs-lookup"><span data-stu-id="f2234-188">For such projects you can likely customize the build or deployment process to appropriately modify the configuration information before it is pushed to production.</span></span> <span data-ttu-id="f2234-189">如果您使用[MSBuild](http://en.wikipedia.org/wiki/MSBuild)、 [NAnt](http://nant.sourceforge.net/)或其他組建工具來建立 web 應用程式，您可能會新增組建步驟來修改 `Web.config` 檔案，以包含生產環境特定的設定。</span><span class="sxs-lookup"><span data-stu-id="f2234-189">If you build your web application using [MSBuild](http://en.wikipedia.org/wiki/MSBuild), [NAnt](http://nant.sourceforge.net/), or some other build tool, you can likely add a build step to modify the `Web.config` file to include the production-specific settings.</span></span> <span data-ttu-id="f2234-190">或者，您的部署工作流程可透過程式設計方式連接到原始檔控制伺服器，並取出適當的 `Web.config` 檔案。</span><span class="sxs-lookup"><span data-stu-id="f2234-190">Or your deployment workflow could programmatically connect to the source control server and retrieve the appropriate `Web.config` file.</span></span>

<span data-ttu-id="f2234-191">取得適當設定資訊到生產環境的實際方法，會根據您的工具和工作流程而有很大的差異。</span><span class="sxs-lookup"><span data-stu-id="f2234-191">The actual approach for getting the appropriate configuration information to production varies widely based on your tools and workflow.</span></span> <span data-ttu-id="f2234-192">因此，我們不會進一步深入探討本主題。</span><span class="sxs-lookup"><span data-stu-id="f2234-192">As such, we will not delve into this topic further.</span></span> <span data-ttu-id="f2234-193">如果您使用的是熱門的組建工具（例如 MSBuild 或 NAnt），您可以透過 web 搜尋找到這些工具的特定部署文章和教學課程。</span><span class="sxs-lookup"><span data-stu-id="f2234-193">If you are using a popular build tool like MSBuild or NAnt you can find deployment articles and tutorials specific to these tools through a web search.</span></span>

### <a name="managing-configuration-differences-via-the-web-deployment-project-add-in"></a><span data-ttu-id="f2234-194">透過 Web 部署專案增益集管理設定差異</span><span class="sxs-lookup"><span data-stu-id="f2234-194">Managing Configuration Differences via the Web Deployment Project Add-In</span></span>

<span data-ttu-id="f2234-195">在2006中，Microsoft 發行了適用于 Visual Studio 2005 的 Web 開發專案增益集。</span><span class="sxs-lookup"><span data-stu-id="f2234-195">In 2006 Microsoft released the Web Development Project Add-In for Visual Studio 2005.</span></span> <span data-ttu-id="f2234-196">Visual Studio 2008 的增益集已于2008發行。</span><span class="sxs-lookup"><span data-stu-id="f2234-196">An Add-In for Visual Studio 2008 was released in 2008.</span></span> <span data-ttu-id="f2234-197">此增益集可讓 ASP.NET 開發人員建立個別的 Web 部署專案，以及其 web 應用程式專案（在建立時）明確地編譯 web 應用程式，並複製要部署到本機輸出目錄的檔案。</span><span class="sxs-lookup"><span data-stu-id="f2234-197">This Add-In allows for ASP.NET developers to create a separate Web Deployment Project alongside their web application project that, when built, explicitly compiles the web application and copies the files to deploy to a local output directory.</span></span> <span data-ttu-id="f2234-198">Web 應用程式專案會在幕後使用 MSBuild。</span><span class="sxs-lookup"><span data-stu-id="f2234-198">The Web Application Project uses MSBuild behind the scenes.</span></span>

<span data-ttu-id="f2234-199">根據預設，開發環境的 `Web.config` 檔案會複製到輸出目錄，但是您可以設定 Web 部署專案來自訂</span><span class="sxs-lookup"><span data-stu-id="f2234-199">By default, the development environment's `Web.config` file is copied to the output directory, but you can setup the Web Deployment Project to customize the</span></span>

<span data-ttu-id="f2234-200">以下列方式複製到此目錄的設定資訊：</span><span class="sxs-lookup"><span data-stu-id="f2234-200">configuration information that gets copied to this directory in the following ways:</span></span>

- <span data-ttu-id="f2234-201">透過 `Web.config` 檔案區段取代，您可以在其中指定要取代的區段，以及包含取代文字的 XML 檔案。</span><span class="sxs-lookup"><span data-stu-id="f2234-201">Via `Web.config` file section replacement, in which you specify the section to replace and an XML file that contains the replacement text.</span></span>
- <span data-ttu-id="f2234-202">提供外部設定來源檔案的路徑。</span><span class="sxs-lookup"><span data-stu-id="f2234-202">By providing a path to an external configuration source file.</span></span> <span data-ttu-id="f2234-203">選取此選項時，Web 部署專案會將特定的 `Web.config` 檔案複製到輸出目錄（而不是開發環境中所使用的 `Web.config` 檔案）。</span><span class="sxs-lookup"><span data-stu-id="f2234-203">With this option selected, the Web Deployment Project copies a particular `Web.config` file to the output directory (rather than the `Web.config` file used in the development environment).</span></span>
- <span data-ttu-id="f2234-204">藉由將自訂規則新增至 Web 部署專案所使用的 MSBuild 檔案。</span><span class="sxs-lookup"><span data-stu-id="f2234-204">By adding custom rules to the MSBuild file used by the Web Deployment Project.</span></span>

<span data-ttu-id="f2234-205">若要部署 web 應用程式，請建立 Web 部署專案，然後將檔案從專案的輸出檔案夾複製到生產環境。</span><span class="sxs-lookup"><span data-stu-id="f2234-205">To deploy the web application build the Web Deployment Project and then copy the files from the project's output folder to the production environment.</span></span>

<span data-ttu-id="f2234-206">若要深入瞭解使用 Web 部署專案的詳細資訊，請參閱[這篇 Web 部署](https://msdn.microsoft.com/magazine/cc163448.aspx)專案： [MSDN 雜誌](https://msdn.microsoft.com/magazine/default.aspx)的2007年4月問題，或參考本教學課程結尾的進一步閱讀一節中的連結。</span><span class="sxs-lookup"><span data-stu-id="f2234-206">To learn more about using the Web Deployment Project check out [this Web Deployment Projects article](https://msdn.microsoft.com/magazine/cc163448.aspx) from the April 2007 issue of [MSDN Magazine](https://msdn.microsoft.com/magazine/default.aspx), or consult the links in the Further Reading section at the end of this tutorial.</span></span>

> [!NOTE]
> <span data-ttu-id="f2234-207">您無法將 Web 部署專案與 Visual Web Developer 搭配使用，因為 Web 部署專案會實作為 Visual Studio 增益集，而 Visual Studio Express 版本（包括 Visual Web Developer）則不支援增益集。</span><span class="sxs-lookup"><span data-stu-id="f2234-207">You cannot use the Web Deployment Project with Visual Web Developer because the Web Deployment Project is implemented as a Visual Studio Add-In and the Visual Studio Express Editions (including Visual Web Developer) do not support Add-Ins.</span></span>

## <a name="summary"></a><span data-ttu-id="f2234-208">總結</span><span class="sxs-lookup"><span data-stu-id="f2234-208">Summary</span></span>

<span data-ttu-id="f2234-209">在開發中，web 應用程式的外部資源和行為通常會與在生產環境中的相同應用程式不同。</span><span class="sxs-lookup"><span data-stu-id="f2234-209">The external resources and behavior of a web application in development are typically different than when the same application is in production.</span></span> <span data-ttu-id="f2234-210">例如，當未處理的例外狀況發生時，環境之間通常會有不同的資料庫連接字串、編譯選項和行為。</span><span class="sxs-lookup"><span data-stu-id="f2234-210">For instance, database connection strings, compilation options, and the behavior when an unhandled exception occurs commonly differ between environments.</span></span> <span data-ttu-id="f2234-211">部署程式必須配合這些差異。</span><span class="sxs-lookup"><span data-stu-id="f2234-211">The deployment process must accommodate these differences.</span></span> <span data-ttu-id="f2234-212">如我們在本教學課程中所討論，最簡單的方法是手動將替代的配置檔案複製到生產環境。</span><span class="sxs-lookup"><span data-stu-id="f2234-212">As we discussed in this tutorial, the simplest approach is to manually copy an alternate configuration file to the production environment.</span></span> <span data-ttu-id="f2234-213">當使用 Web 部署專案增益集，或使用更正式的組建或部署程式來容納這類自訂時，可能會有更精緻的解決方案。</span><span class="sxs-lookup"><span data-stu-id="f2234-213">More elegant solutions are possible when using the Web Deployment Project Add-In or with a more formalized build or deployment process that can accommodate such customizations.</span></span>

<span data-ttu-id="f2234-214">快樂的程式設計！</span><span class="sxs-lookup"><span data-stu-id="f2234-214">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="f2234-215">進一步閱讀</span><span class="sxs-lookup"><span data-stu-id="f2234-215">Further Reading</span></span>

<span data-ttu-id="f2234-216">如需本教學課程中所討論之主題的詳細資訊，請參閱下列資源：</span><span class="sxs-lookup"><span data-stu-id="f2234-216">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="f2234-217">已說明的連接字串</span><span class="sxs-lookup"><span data-stu-id="f2234-217">Connection Strings Explained</span></span>](http://www.connectionstrings.com/Articles/Show/what-is-a-connection-string)
- [<span data-ttu-id="f2234-218">資料庫連接字串 @ ConnectionStrings.com</span><span class="sxs-lookup"><span data-stu-id="f2234-218">Database Connection Strings @ ConnectionStrings.com</span></span>](http://www.connectionstrings.com/)
- [<span data-ttu-id="f2234-219">請勿在啟用 `debug="true"` 的情況下執行生產 ASP.NET 應用程式</span><span class="sxs-lookup"><span data-stu-id="f2234-219">Don't Run Production ASP.NET Applications with `debug="true"` Enabled</span></span>](https://weblogs.asp.net/scottgu/Don_1920_t-run-production-ASP.NET-Applications-with-debug_3D001D20_true_1D20_-enabled)
- [<span data-ttu-id="f2234-220">正常回應未處理的例外狀況-顯示使用者易記的錯誤頁面</span><span class="sxs-lookup"><span data-stu-id="f2234-220">Gracefully Responding to Unhandled Exceptions - Displaying User-Friendly Error Pages</span></span>](http://aspnet.4guysfromrolla.com/articles/090606-1.aspx)
- [<span data-ttu-id="f2234-221">如何：使用 Visual Studio 2008 Web 部署專案？</span><span class="sxs-lookup"><span data-stu-id="f2234-221">How Do I: Use a Visual Studio 2008 Web Deployment Project?</span></span>](../../../videos/how-do-i/how-do-i-use-a-visual-studio-2008-web-deployment-project.md)
- [<span data-ttu-id="f2234-222">部署資料庫時的金鑰設定</span><span class="sxs-lookup"><span data-stu-id="f2234-222">Key Configuration Settings When Deploying a Database</span></span>](http://aspnet.4guysfromrolla.com/articles/121008-1.aspx)
- <span data-ttu-id="f2234-223">[Visual Studio 2008 Web 部署專案下載](https://www.microsoft.com/downloads/details.aspx?FamilyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&amp;displaylang=en) | [Visual Studio 2005 Web 部署專案下載](https://download.microsoft.com/download/9/4/9/9496adc4-574e-4043-bb70-bc841e27f13c/WebDeploymentSetup.msi)</span><span class="sxs-lookup"><span data-stu-id="f2234-223">[Visual Studio 2008 Web Deployment Projects Download](https://www.microsoft.com/downloads/details.aspx?FamilyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&amp;displaylang=en) | [Visual Studio 2005 Web Deployment Projects Download](https://download.microsoft.com/download/9/4/9/9496adc4-574e-4043-bb70-bc841e27f13c/WebDeploymentSetup.msi)</span></span>
- <span data-ttu-id="f2234-224">[Vs 2008 Web 部署](https://weblogs.asp.net/scottgu/archive/2005/11/06/429723.aspx)專案 | [Vs 2008 Web 部署專案支援已發行](https://weblogs.asp.net/scottgu/archive/2008/01/28/vs-2008-web-deployment-project-support-released.aspx)</span><span class="sxs-lookup"><span data-stu-id="f2234-224">[VS 2008 Web Deployment Projects](https://weblogs.asp.net/scottgu/archive/2005/11/06/429723.aspx) | [VS 2008 Web Deployment Project Support Released](https://weblogs.asp.net/scottgu/archive/2008/01/28/vs-2008-web-deployment-project-support-released.aspx)</span></span>
- [<span data-ttu-id="f2234-225">Web 部署專案</span><span class="sxs-lookup"><span data-stu-id="f2234-225">Web Deployment Projects</span></span>](https://msdn.microsoft.com/magazine/cc163448.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="f2234-226">[上一頁](deploying-your-site-using-visual-studio-vb.md)
> [下一頁](core-differences-between-iis-and-the-asp-net-development-server-vb.md)</span><span class="sxs-lookup"><span data-stu-id="f2234-226">[Previous](deploying-your-site-using-visual-studio-vb.md)
[Next](core-differences-between-iis-and-the-asp-net-development-server-vb.md)</span></span>
