---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/users-and-roles-on-the-production-website-vb
title: 生產網站上的使用者和角色（VB） |Microsoft Docs
author: rick-anderson
description: ASP.NET 網站管理工具（WSAT）提供網頁型使用者介面，可用來設定成員資格和角色設定，以及建立、編輯、。
ms.author: riande
ms.date: 06/09/2009
ms.assetid: 491ed5ae-9be1-4191-87be-65e4e1c57690
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/users-and-roles-on-the-production-website-vb
msc.type: authoredcontent
ms.openlocfilehash: d4ce8b278322684be2d44faefd6e69fc524bbe18
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/28/2019
ms.locfileid: "74617892"
---
# <a name="users-and-roles-on-the-production-website-vb"></a><span data-ttu-id="e6134-103">生產網站上的使用者和角色（VB）</span><span class="sxs-lookup"><span data-stu-id="e6134-103">Users and Roles On The Production Website (VB)</span></span>

<span data-ttu-id="e6134-104">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="e6134-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

[<span data-ttu-id="e6134-105">下載 PDF</span><span class="sxs-lookup"><span data-stu-id="e6134-105">Download PDF</span></span>](https://download.microsoft.com/download/5/C/5/5C57DB8C-5DEA-4B3A-92CA-4405544D313B/aspnet_tutorial16_CustomAWAT_vb.pdf)

> <span data-ttu-id="e6134-106">ASP.NET 網站管理工具（WSAT）提供網頁型使用者介面，可用來設定成員資格和角色，以及建立、編輯和刪除使用者和角色。</span><span class="sxs-lookup"><span data-stu-id="e6134-106">The ASP.NET Website Administration Tool (WSAT) provides a web-based user interface for configuring Membership and Roles settings and for creating, editing, and deleting users and roles.</span></span> <span data-ttu-id="e6134-107">可惜的是，WSAT 只能在從 localhost 流覽時運作，這表示您無法透過瀏覽器連線至生產網站的系統管理工具。</span><span class="sxs-lookup"><span data-stu-id="e6134-107">Unfortunately, the WSAT only works when visited from localhost, meaning that you cannot reach the production website's Administration Tool through your browser.</span></span> <span data-ttu-id="e6134-108">好消息是，有一些因應措施，可以讓您在生產環境上管理使用者和角色。</span><span class="sxs-lookup"><span data-stu-id="e6134-108">The good news is that there are workarounds that make it possible to manage users and roles on production.</span></span> <span data-ttu-id="e6134-109">本教學課程會探討這些因應措施及其他方法。</span><span class="sxs-lookup"><span data-stu-id="e6134-109">This tutorial looks at these workarounds and others.</span></span>

## <a name="introduction"></a><span data-ttu-id="e6134-110">簡介</span><span class="sxs-lookup"><span data-stu-id="e6134-110">Introduction</span></span>

<span data-ttu-id="e6134-111">ASP.NET 2.0 引進了許多*應用程式服務*，這是一組您可以新增至 web 應用程式的建立區塊服務。</span><span class="sxs-lookup"><span data-stu-id="e6134-111">ASP.NET 2.0 introduced a number of *application services*, which are a suite of building block services that you can add to your web application.</span></span> <span data-ttu-id="e6134-112">我們已在「設定[*使用應用程式服務的網站*」教學](configuring-a-website-that-uses-application-services-vb.md)課程中，將「成員資格」和「角色」服務新增至「書籍評論」網站。</span><span class="sxs-lookup"><span data-stu-id="e6134-112">We added the Membership and Roles services to the Book Reviews website back in the [*Configuring a Website That Uses Application Services* tutorial](configuring-a-website-that-uses-application-services-vb.md).</span></span> <span data-ttu-id="e6134-113">成員資格服務可協助建立和管理使用者帳戶;角色服務提供將使用者分類為群組的 API。</span><span class="sxs-lookup"><span data-stu-id="e6134-113">The Membership service facilitates creating and managing user accounts; the Roles service offers an API for categorizing users into groups.</span></span> <span data-ttu-id="e6134-114">本書評論網站有三個使用者帳戶-Scott、Jisun 和 Alice-以及單一角色 Admin，並具有 Scott 和 Jisun 的系統管理員角色。</span><span class="sxs-lookup"><span data-stu-id="e6134-114">The Book Reviews site has three user accounts - Scott, Jisun, and Alice - and a single role, Admin, with Scott and Jisun in the Admin role.</span></span>

<span data-ttu-id="e6134-115">ASP.NET 的應用程式服務不會系結至特定的執行。</span><span class="sxs-lookup"><span data-stu-id="e6134-115">ASP.NET's application services are not tied to a specific implementation.</span></span> <span data-ttu-id="e6134-116">相反地，您會指示應用程式服務使用特定的*提供者*，而該提供者會使用特定技術來執行服務。</span><span class="sxs-lookup"><span data-stu-id="e6134-116">Instead, you instruct the application services to use a particular *provider*, and that provider implements the service using a particular technology.</span></span> <span data-ttu-id="e6134-117">我們已設定書籍審查 web 應用程式，以使用成員資格和角色服務的 `SqlMembershipProvider` 和 `SqlRoleProvider` 提供者。</span><span class="sxs-lookup"><span data-stu-id="e6134-117">We configured the Book Reviews web application to use the `SqlMembershipProvider` and `SqlRoleProvider` providers for the Membership and Roles services.</span></span> <span data-ttu-id="e6134-118">這兩個提供者會將使用者帳戶和角色資訊儲存在 SQL Server 資料庫中，而且是裝載于虛擬主機公司之以網際網路為基礎的 web 應用程式最常使用的提供者。</span><span class="sxs-lookup"><span data-stu-id="e6134-118">These two providers store user account and role information in a SQL Server database and are the most commonly used providers for Internet-based web applications hosted at a web hosting company.</span></span>

<span data-ttu-id="e6134-119">使用成員資格和角色服務的開發人員經常面臨的挑戰，是管理生產環境中的使用者和角色。</span><span class="sxs-lookup"><span data-stu-id="e6134-119">A common challenge for developers using the Membership and Roles services is managing the users and roles on the production environment.</span></span> <span data-ttu-id="e6134-120">如何從生產網站刪除使用者帳戶、加入新的角色，或將現有的使用者新增至現有的角色？</span><span class="sxs-lookup"><span data-stu-id="e6134-120">How do you delete a user account from the production website, add a new role, or add an existing user to an existing role?</span></span> <span data-ttu-id="e6134-121">本教學課程會探索在生產網站上管理使用者和角色的不同技術。</span><span class="sxs-lookup"><span data-stu-id="e6134-121">This tutorial explores different techniques for managing users and roles on the production website.</span></span>

## <a name="using-the-aspnet-web-site-administration-tool"></a><span data-ttu-id="e6134-122">使用 ASP.NET 網站管理工具</span><span class="sxs-lookup"><span data-stu-id="e6134-122">Using the ASP.NET Web Site Administration Tool</span></span>

<span data-ttu-id="e6134-123">ASP.NET 包含[網站管理工具](https://msdn.microsoft.com/library/yy40ytx0.aspx)（WSAT），可讓您輕鬆地建立及管理使用者帳戶和角色，並指定以使用者和角色為基礎的授權規則。</span><span class="sxs-lookup"><span data-stu-id="e6134-123">ASP.NET includes a [Web Site Administration Tool](https://msdn.microsoft.com/library/yy40ytx0.aspx) (WSAT) that makes it easy to create and manage user accounts and roles and to specify user- and role-based authorization rules.</span></span> <span data-ttu-id="e6134-124">若要使用 WSAT，請按一下 方案總管中的 ASP.NET 設定 圖示，或移至 網站 或 專案 功能表，然後選擇 ASP.NET 設定 選項。</span><span class="sxs-lookup"><span data-stu-id="e6134-124">To use the WSAT, click the ASP.NET Configuration icon in the Solution Explorer, or go to the Website or Project menu and choose the ASP.NET Configuration option.</span></span> <span data-ttu-id="e6134-125">任一種方法都會啟動網頁瀏覽器，並將其指向 WSAT 的位址，例如： `http://localhost:portNumber/asp.netwebadminfiles/default.aspx?applicationPhysicalPath=pathToApplication`</span><span class="sxs-lookup"><span data-stu-id="e6134-125">Either approach launches a web browser and points it to the WSAT at an address like: `http://localhost:portNumber/asp.netwebadminfiles/default.aspx?applicationPhysicalPath=pathToApplication`</span></span>

<span data-ttu-id="e6134-126">WSAT 分成三個區段：</span><span class="sxs-lookup"><span data-stu-id="e6134-126">The WSAT is divided into three sections:</span></span>

- <span data-ttu-id="e6134-127">**安全性**-管理使用者、角色和授權規則。</span><span class="sxs-lookup"><span data-stu-id="e6134-127">**Security** - manage users, roles, and authorization rules.</span></span>
- <span data-ttu-id="e6134-128">**Policies.applicationconfiguration** -從這裡管理 &lt;appSettings&gt; 和 SMTP 設定。</span><span class="sxs-lookup"><span data-stu-id="e6134-128">**ApplicationConfiguration** - manage the &lt;appSettings&gt; and SMTP settings from here.</span></span> <span data-ttu-id="e6134-129">您也可以讓應用程式離線，並從這裡管理偵測和追蹤設定，以及指定預設的自訂錯誤網頁。</span><span class="sxs-lookup"><span data-stu-id="e6134-129">You can also take the application offline and manage debugging and tracing settings from here, as well as specify the default custom error page.</span></span>
- <span data-ttu-id="e6134-130">**ProviderConfiguration** -設定應用程式服務所使用的提供者。</span><span class="sxs-lookup"><span data-stu-id="e6134-130">**ProviderConfiguration** - configure the providers used by the application services.</span></span>

<span data-ttu-id="e6134-131">[安全性] 區段（如 [**圖 1**] 所示）包含用來建立新使用者、管理使用者、建立和管理角色，以及建立和管理存取規則的連結。</span><span class="sxs-lookup"><span data-stu-id="e6134-131">The Security section (shown in **Figure 1**) includes links for creating new users, managing users, creating and managing roles, and creating and managing access rules.</span></span> <span data-ttu-id="e6134-132">您可以從這裡將新角色新增至系統、刪除現有的使用者，或從特定使用者帳戶新增或移除角色。</span><span class="sxs-lookup"><span data-stu-id="e6134-132">From here you can add a new role to the system, delete an existing user, or add or remove roles from a particular user account.</span></span>

[![](users-and-roles-on-the-production-website-vb/_static/image2.png)](users-and-roles-on-the-production-website-vb/_static/image1.png)

<span data-ttu-id="e6134-133">**圖 1**： WSAT 安全性區段包含管理使用者和角色的選項</span><span class="sxs-lookup"><span data-stu-id="e6134-133">**Figure 1**: The WSAT Security Section Includes Options for Managing Users and Roles</span></span>  
<span data-ttu-id="e6134-134">（[按一下以查看完整大小的影像](users-and-roles-on-the-production-website-vb/_static/image3.png)）</span><span class="sxs-lookup"><span data-stu-id="e6134-134">([Click to view full-size image](users-and-roles-on-the-production-website-vb/_static/image3.png))</span></span>

<span data-ttu-id="e6134-135">可惜的是，WSAT 只能在本機存取。</span><span class="sxs-lookup"><span data-stu-id="e6134-135">Unfortunately, the WSAT is only accessible locally.</span></span> <span data-ttu-id="e6134-136">您無法造訪遠端生產網站上的 WSAT;如果您造訪 `www.yoursite.com/asp.netwebadminfiles/default.aspx` 會收到「404找不到」回應。</span><span class="sxs-lookup"><span data-stu-id="e6134-136">You cannot visit the WSAT on your remote production website; if you visit `www.yoursite.com/asp.netwebadminfiles/default.aspx` you get a 404 Not Found response.</span></span> <span data-ttu-id="e6134-137">WSAT 的程式碼會使用 .NET Framework 中的 `Membership` 和 `Roles` 類別，來建立、編輯和刪除使用者和角色。</span><span class="sxs-lookup"><span data-stu-id="e6134-137">The code that powers the WSAT uses the `Membership` and `Roles` classes in the .NET Framework to create, edit, and delete users and roles.</span></span> <span data-ttu-id="e6134-138">這些類別會參考 web 應用程式的設定資訊，以判斷要使用的提供者;回到設定[*使用應用程式服務的網站*教學](configuring-a-website-that-uses-application-services-vb.md)課程，我們將「書籍評論」網站設為使用 `SqlMembershipProvider` 和 `SqlRoleProvider` 提供者。</span><span class="sxs-lookup"><span data-stu-id="e6134-138">These classes consult the web application's configuration information to determine what provider to use; back in the [*Configuring a Website That Uses Application Services* tutorial](configuring-a-website-that-uses-application-services-vb.md) we setup the Book Reviews website to use the `SqlMembershipProvider` and `SqlRoleProvider` providers.</span></span> <span data-ttu-id="e6134-139">這個詳述如下會將 `<membership>` 和 `<roleManager>` 區段新增至 `Web.config`。</span><span class="sxs-lookup"><span data-stu-id="e6134-139">This entailed adding `<membership>` and `<roleManager>` sections to `Web.config`.</span></span>

[!code-xml[Main](users-and-roles-on-the-production-website-vb/samples/sample1.xml)]

<span data-ttu-id="e6134-140">請注意，`<membership>` 和 `<roleManager>` 區段分別參考其 `type` 屬性中的 `SqlMembershipProvider` 和 `SqlRoleProvider` 提供者。</span><span class="sxs-lookup"><span data-stu-id="e6134-140">Note that the `<membership>` and `<roleManager>` sections reference the `SqlMembershipProvider` and `SqlRoleProvider` providers in their `type` attribute, respectively.</span></span> <span data-ttu-id="e6134-141">這些提供者會將使用者和角色資訊儲存在指定的 SQL Server 資料庫中。</span><span class="sxs-lookup"><span data-stu-id="e6134-141">These providers store the user and role information in a specified SQL Server database.</span></span> <span data-ttu-id="e6134-142">這些提供者所使用的資料庫是由 `~/ConfigSections/databaseConnectionStrings.config` 檔中定義的 `connectionStringName` 屬性 `ReviewsConnectionString`所指定。</span><span class="sxs-lookup"><span data-stu-id="e6134-142">The database used by these providers is specified by the `connectionStringName` attribute, `ReviewsConnectionString`, which is defined in the `~/ConfigSections/databaseConnectionStrings.config` file.</span></span> <span data-ttu-id="e6134-143">回想一下，開發環境中的 `databaseConnectionStrings.config` 檔案包含開發資料庫的連接字串，而實際執行的 `databaseConnectionStrings.config` 檔案則包含生產資料庫的連接字串。</span><span class="sxs-lookup"><span data-stu-id="e6134-143">Recall that the `databaseConnectionStrings.config` file in the development environment contains the connection string to the development database whereas the `databaseConnectionStrings.config` file on production contains the connection string to the production database.</span></span>

<span data-ttu-id="e6134-144">簡言之，WSAT 必須透過開發環境在本機存取，而且它會與 `databaseConnectionStrings.config` 檔案所指定之資料庫中的使用者和角色資訊搭配使用。</span><span class="sxs-lookup"><span data-stu-id="e6134-144">In a nutshell, the WSAT must be accessed locally through the development environment, and it works with the user and role information in the database specified in the `databaseConnectionStrings.config` file.</span></span> <span data-ttu-id="e6134-145">因此，如果我們在開發環境上變更 `databaseConnectionStrings.config` 檔案中的連接字串資訊，我們可以在本機使用 WSAT 來管理生產環境中的使用者和角色。</span><span class="sxs-lookup"><span data-stu-id="e6134-145">Consequently, if we change the connection string information in the `databaseConnectionStrings.config` file on the development environment we can use the WSAT locally to manage users and roles in the production environment.</span></span>

<span data-ttu-id="e6134-146">若要說明這項功能，請在開發環境的 Visual Studio 中開啟 `databaseConnectionStrings.config` 檔案，然後將開發資料庫連接字串取代為實際執行的資料庫連接字串。</span><span class="sxs-lookup"><span data-stu-id="e6134-146">To illustrate this functionality, open the `databaseConnectionStrings.config` file in Visual Studio on the development environment and replace the development database connection string with the production database connection string.</span></span> <span data-ttu-id="e6134-147">然後啟動 WSAT，並移至 [安全性] 索引標籤，然後新增名為 Sam 且密碼為 "password！" 的新使用者</span><span class="sxs-lookup"><span data-stu-id="e6134-147">Then launch the WSAT, go the Security tab, and add a new user named Sam with password "password!"</span></span> <span data-ttu-id="e6134-148">（較少引號）。</span><span class="sxs-lookup"><span data-stu-id="e6134-148">(less the quotation marks).</span></span> <span data-ttu-id="e6134-149">[**圖 2** ] 顯示建立此帳戶時的 WSAT 畫面。</span><span class="sxs-lookup"><span data-stu-id="e6134-149">**Figure 2** shows the WSAT screen when creating this account.</span></span>

[![](users-and-roles-on-the-production-website-vb/_static/image5.png)](users-and-roles-on-the-production-website-vb/_static/image4.png)

<span data-ttu-id="e6134-150">**圖 2**：在生產環境中建立名為 Sam 的新使用者</span><span class="sxs-lookup"><span data-stu-id="e6134-150">**Figure 2**: Create a New User Named Sam In the Production Environment</span></span>  
<span data-ttu-id="e6134-151">（[按一下以查看完整大小的影像](users-and-roles-on-the-production-website-vb/_static/image6.png)）</span><span class="sxs-lookup"><span data-stu-id="e6134-151">([Click to view full-size image](users-and-roles-on-the-production-website-vb/_static/image6.png))</span></span>

<span data-ttu-id="e6134-152">因為我們將 `databaseConnectionStrings.config` 中的連接字串變更為指向實際執行的資料庫伺服器，所以 Sam 是以使用者的身分新增到生產環境中。</span><span class="sxs-lookup"><span data-stu-id="e6134-152">Because we changed the connection string in `databaseConnectionStrings.config` to point to the production database server, Sam was added as a user in the production environment.</span></span> <span data-ttu-id="e6134-153">若要確認這一點，請將 `databaseConnectionStrings.config` 檔案中的連接字串變更回開發資料庫，然後造訪開發環境中的 [`Login.aspx`] 頁面。</span><span class="sxs-lookup"><span data-stu-id="e6134-153">To verify this, change the connection string in the `databaseConnectionStrings.config` file back to the development database and then visit the `Login.aspx` page in the development environment.</span></span> <span data-ttu-id="e6134-154">嘗試以 Sam 身分登入（請參閱 [**圖 3**]）。</span><span class="sxs-lookup"><span data-stu-id="e6134-154">Try to sign in as Sam (see **Figure 3**).</span></span>

[![](users-and-roles-on-the-production-website-vb/_static/image8.png)](users-and-roles-on-the-production-website-vb/_static/image7.png)

<span data-ttu-id="e6134-155">**圖 3**：您無法在開發環境中以 Sam 的身分登入</span><span class="sxs-lookup"><span data-stu-id="e6134-155">**Figure 3**: You Cannot Sign In As Sam in the Development Environment</span></span>  
<span data-ttu-id="e6134-156">（[按一下以查看完整大小的影像](users-and-roles-on-the-production-website-vb/_static/image9.png)）</span><span class="sxs-lookup"><span data-stu-id="e6134-156">([Click to view full-size image](users-and-roles-on-the-production-website-vb/_static/image9.png))</span></span>

<span data-ttu-id="e6134-157">您無法在開發環境中以 Sam 的身分登入，因為使用者帳戶資訊不存在於本機資料庫中。</span><span class="sxs-lookup"><span data-stu-id="e6134-157">You cannot sign in as Sam in the development environment because the user account information does not exist in the local database.</span></span> <span data-ttu-id="e6134-158">相反地，已加入生產資料庫中。</span><span class="sxs-lookup"><span data-stu-id="e6134-158">Rather, is was added to the production database.</span></span> <span data-ttu-id="e6134-159">若要確認這一點，請在開發和生產資料庫中同時查看 `aspnet_Users` 資料表的內容。</span><span class="sxs-lookup"><span data-stu-id="e6134-159">To verify this, view the contents of the `aspnet_Users` table in both the development and production databases.</span></span> <span data-ttu-id="e6134-160">在開發環境中，只有 Scott、Jisun 和 Alice 的使用者才會有三筆記錄。</span><span class="sxs-lookup"><span data-stu-id="e6134-160">In the development environment there should be only three records for users Scott, Jisun, and Alice.</span></span> <span data-ttu-id="e6134-161">不過，生產資料庫中的 `aspnet_Users` 資料表有四筆記錄： Scott、Jisun、Alice 和 Sam。</span><span class="sxs-lookup"><span data-stu-id="e6134-161">However, the `aspnet_Users` table in the production database has four records: Scott, Jisun, Alice, and Sam.</span></span> <span data-ttu-id="e6134-162">因此，Sam 可以在生產環境中透過網站登入，而不是透過開發環境。</span><span class="sxs-lookup"><span data-stu-id="e6134-162">Consequently, Sam can sign in through the website in production, but not through the development environment.</span></span>

[![](users-and-roles-on-the-production-website-vb/_static/image11.png)](users-and-roles-on-the-production-website-vb/_static/image10.png)

<span data-ttu-id="e6134-163">**圖 4**： Sam 可以在生產網站上登入</span><span class="sxs-lookup"><span data-stu-id="e6134-163">**Figure 4**: Sam Can Sign In On the Production Website</span></span>  
<span data-ttu-id="e6134-164">（[按一下以查看完整大小的影像](users-and-roles-on-the-production-website-vb/_static/image12.png)）</span><span class="sxs-lookup"><span data-stu-id="e6134-164">([Click to view full-size image](users-and-roles-on-the-production-website-vb/_static/image12.png))</span></span>

> [!NOTE]
> <span data-ttu-id="e6134-165">當您完成使用 WSAT 時，別忘了將 `databaseConnectionStrings.config` 檔案中的連接字串變更回開發資料庫的連接字串，否則當您透過開發環境測試網站時，將會使用生產資料。</span><span class="sxs-lookup"><span data-stu-id="e6134-165">Don't forget to change the connection string in the `databaseConnectionStrings.config` file back to the development database's connect string when you're done working with the WSAT otherwise you will be working with production data when testing the site through the development environment.</span></span> <span data-ttu-id="e6134-166">也請記住，雖然我們剛才討論的技巧可以讓我們使用 WSAT 從遠端系統管理使用者和角色，但變更任何其他 WSAT 設定選項（存取規則、SMTP 設定、偵錯工具和追蹤設定等等）都會修改 `Web.config` 檔案。</span><span class="sxs-lookup"><span data-stu-id="e6134-166">Also keep in mind that while the technique we just discussed allows us to use the WSAT to remotely manage users and roles, changes to any of the other WSAT configuration options (access rules, SMTP settings, debugging and tracing settings, and so on) modify the `Web.config` file.</span></span> <span data-ttu-id="e6134-167">因此，對設定所做的任何變更都會套用至開發環境，而不會套用至生產環境。</span><span class="sxs-lookup"><span data-stu-id="e6134-167">Consequently, any changes made to the settings apply to the development environment and not to the production environment.</span></span>

## <a name="creating-custom-user-and-role-management-web-pages"></a><span data-ttu-id="e6134-168">建立自訂使用者和角色管理網頁</span><span class="sxs-lookup"><span data-stu-id="e6134-168">Creating Custom User and Role Management Web Pages</span></span>

<span data-ttu-id="e6134-169">WSAT 提供現成可用的系統來管理使用者和角色，但只能在本機啟動，而且需要變更連接字串資訊，才能管理生產環境中的使用者和角色。</span><span class="sxs-lookup"><span data-stu-id="e6134-169">The WSAT provides an out of the box system for managing users and roles, but can only be launched locally and requires making changes to the connection string information in order to manage the users and roles on production.</span></span> <span data-ttu-id="e6134-170">大部分支援使用者帳戶的網站也包含一些使用者和角色管理網頁，可讓系統管理員從網站內的頁面管理使用者和角色。</span><span class="sxs-lookup"><span data-stu-id="e6134-170">Most websites that support user accounts also include a number of user and role administration web pages that enable administrators to manage users and roles from pages within the site.</span></span> <span data-ttu-id="e6134-171">這類網頁系統管理頁面可讓您更輕鬆地管理使用者和角色，對於可能有許多系統管理員或系統管理員無法存取的網站，或使用 Visual Studio 來啟動 WSAT 的技術背景而言，這是很重要的。</span><span class="sxs-lookup"><span data-stu-id="e6134-171">Such web-based administration pages make it much easier to manage users and roles and are essential for sites where there may be many administrators or administrators that do not have access to or the technical background to use Visual Studio to launch the WSAT.</span></span>

<span data-ttu-id="e6134-172">ASP.NET 包含許多內建的登入相關 Web 控制項，可讓您輕鬆地執行這些系統管理網頁，如同拖放。</span><span class="sxs-lookup"><span data-stu-id="e6134-172">ASP.NET includes a number of built-in Login-related Web controls that make implementing many of these administrative web pages as easy as drag and drop.</span></span> <span data-ttu-id="e6134-173">例如，您可以建立一個頁面，讓系統管理員將 CreateUserWizard 控制項拖曳至頁面上，並設定幾個屬性，以建立新的使用者帳戶。</span><span class="sxs-lookup"><span data-stu-id="e6134-173">For example, you can create a page for administrators to create a new user account by dragging the CreateUserWizard control onto the page and setting a few properties.</span></span> <span data-ttu-id="e6134-174">事實上，如 [**圖 2** ] 所示，在 WSAT 中建立使用者的頁面會使用您可以加入至頁面的相同 CreateUserWizard 控制項。</span><span class="sxs-lookup"><span data-stu-id="e6134-174">In fact, the page for creating users in the WSAT shown in **Figure 2** uses the same CreateUserWizard control that you can add to your pages.</span></span> <span data-ttu-id="e6134-175">此外，您可以透過 .NET Framework 中的 `Membership` 和 `Roles` 類別，以程式設計方式取得成員資格和角色服務的功能。</span><span class="sxs-lookup"><span data-stu-id="e6134-175">Furthermore, the Membership and Roles services' functionalities are available programmatically through the `Membership` and `Roles` classes in the .NET Framework.</span></span> <span data-ttu-id="e6134-176">使用這些類別，您可以撰寫程式碼來建立、編輯和刪除使用者和角色，以及新增或移除角色的使用者，以判斷哪些使用者屬於哪些角色，以及執行其他與使用者和角色相關的工作。</span><span class="sxs-lookup"><span data-stu-id="e6134-176">With these classes you can write code to create, edit, and delete users and roles, as well as to add or remove users to roles, to determine what users are in what roles, and to perform other user- and role-related tasks.</span></span>

<span data-ttu-id="e6134-177">在設定[*使用應用程式服務的網站*教學](configuring-a-website-that-uses-application-services-vb.md)課程中，我已將頁面新增至名為 `CreateAccount.aspx`的 `Admin` 資料夾。</span><span class="sxs-lookup"><span data-stu-id="e6134-177">In the [*Configuring a Website That Uses Application Services* tutorial](configuring-a-website-that-uses-application-services-vb.md) I added a page to the `Admin` folder named `CreateAccount.aspx`.</span></span> <span data-ttu-id="e6134-178">此頁面可讓系統管理員將新的使用者帳戶新增至網站，並指定新建立的使用者是否為系統管理員角色（請參閱 [**圖 5**]）。</span><span class="sxs-lookup"><span data-stu-id="e6134-178">This page allows an administrator to add a new user account to the site and to specify whether or not the newly created user is in the Admin role (see **Figure 5**).</span></span>

[![](users-and-roles-on-the-production-website-vb/_static/image14.png)](users-and-roles-on-the-production-website-vb/_static/image13.png)

<span data-ttu-id="e6134-179">**圖 5**：系統管理員可以建立新的使用者帳戶</span><span class="sxs-lookup"><span data-stu-id="e6134-179">**Figure 5**: Administrators Can Create New User Accounts</span></span>  
<span data-ttu-id="e6134-180">（[按一下以查看完整大小的影像](users-and-roles-on-the-production-website-vb/_static/image15.png)）</span><span class="sxs-lookup"><span data-stu-id="e6134-180">([Click to view full-size image](users-and-roles-on-the-production-website-vb/_static/image15.png))</span></span>

<span data-ttu-id="e6134-181">如需建立使用者和角色管理頁面的詳細資訊，以及使用 `Membership` 和 `Roles` 類別以及與登入相關的 ASP.NET Web 控制項的逐步指示，請務必閱讀我的[網站安全性教學](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md)課程。</span><span class="sxs-lookup"><span data-stu-id="e6134-181">For a more detailed look at building user and role administration pages, along with step-by-step instructions on using the `Membership` and `Roles` classes and the Login-related ASP.NET Web controls, be sure to read my [Website Security Tutorials](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span></span> <span data-ttu-id="e6134-182">您可以在這裡找到如何建立新帳戶、建立和管理角色、將使用者指派給角色和其他一般系統管理工作的網頁指引。</span><span class="sxs-lookup"><span data-stu-id="e6134-182">There you'll find guidance on how to build web pages for creating new accounts, creating and managing roles, assigning users to roles, and other common administrative tasks.</span></span>

<span data-ttu-id="e6134-183">若要在生產網站上執行類似 WSAT 的功能，您一律可以建立自己的一系列網頁來執行 WSAT 的功能。</span><span class="sxs-lookup"><span data-stu-id="e6134-183">To implement WSAT-like functionality on the production website you can always build your own series of web pages that implement the WSAT's features.</span></span> <span data-ttu-id="e6134-184">若要協助您開始使用，請參閱 WSAT 原始程式碼，此程式碼位於資料夾 `%WINDIR%\Microsoft.NET\Framework\v2.0.50727\ASP.NETWebAdminFiles`。</span><span class="sxs-lookup"><span data-stu-id="e6134-184">To help get started, check out the WSAT source code, which is located in the folder `%WINDIR%\Microsoft.NET\Framework\v2.0.50727\ASP.NETWebAdminFiles`.</span></span> <span data-ttu-id="e6134-185">另一個選項是使用 Dan Clem 的 WSAT 替代專案，他會在他的文章中分享[自己的網站管理工具](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)。</span><span class="sxs-lookup"><span data-stu-id="e6134-185">Another option is to use Dan Clem's WSAT alternative, which he shares in his article, [Rolling Your Own Web Site Administration Tool](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx).</span></span> <span data-ttu-id="e6134-186">Dan 會引導讀者完成建立自訂 WSAT 工具的程式，包括其應用程式的原始程式碼供您下載（在中C#），並提供將自訂 WSAT 加入至託管網站的逐步指示。</span><span class="sxs-lookup"><span data-stu-id="e6134-186">Dan walks readers through the process of building a custom WSAT-like tool, includes his application's source code for download (in C#), and gives step-by-step instructions for adding his custom WSAT to a hosted website.</span></span>

## <a name="summary"></a><span data-ttu-id="e6134-187">總結</span><span class="sxs-lookup"><span data-stu-id="e6134-187">Summary</span></span>

<span data-ttu-id="e6134-188">ASP.NET 網站管理工具（WSAT）可與成員資格和角色應用程式服務一起使用，以管理您網站的使用者和角色資訊。</span><span class="sxs-lookup"><span data-stu-id="e6134-188">The ASP.NET Web Site Administration Tool (WSAT) can be used in tandem with the Membership and Roles application services to manage user and role information for your website.</span></span> <span data-ttu-id="e6134-189">可惜的是，WSAT 只能在本機存取，無法從您的生產網站造訪。</span><span class="sxs-lookup"><span data-stu-id="e6134-189">Unfortunately, the WSAT is only accessible locally and cannot be visited from your production website.</span></span> <span data-ttu-id="e6134-190">不過，藉由將開發環境中的連接字串變更為指向實際執行的資料庫，您可以使用 WSAT 來管理生產網站上的使用者和角色。</span><span class="sxs-lookup"><span data-stu-id="e6134-190">However, by changing the connection string in the development environment to point to the production database you can use the WSAT to manage the users and roles on the production website.</span></span>

<span data-ttu-id="e6134-191">雖然 WSAT 方法提供快速且輕鬆的方式來管理使用者和角色，但它還是需要從 Visual Studio 啟動 WSAT，以及暫時變更連接字串資訊。</span><span class="sxs-lookup"><span data-stu-id="e6134-191">While the WSAT approach affords a quick and easy way to manage users and roles, it necessitates launching the WSAT from Visual Studio as well as temporary changes to the connection string information.</span></span> <span data-ttu-id="e6134-192">WSAT 提供快速的方式來管理生產環境中的使用者和角色，但非常麻煩，而且對於具有多個系統管理員或沒有或不熟悉 Visual Studio 和 WSAT 的系統管理員而言，並不適用。</span><span class="sxs-lookup"><span data-stu-id="e6134-192">The WSAT offers a quick way to manage users and roles on production, but is cumbersome and does not work well for websites with multiple administrators or with administrators who do not have or are not familiar with Visual Studio and the WSAT.</span></span> <span data-ttu-id="e6134-193">基於這些理由，大部分支援使用者帳戶的網站都包含一組系統管理網頁。</span><span class="sxs-lookup"><span data-stu-id="e6134-193">For these reasons, most websites that support user accounts include a set of administrative web pages.</span></span> <span data-ttu-id="e6134-194">這一組網頁不需要 WSAT，而是由各種系統管理使用者從任何電腦使用。</span><span class="sxs-lookup"><span data-stu-id="e6134-194">Such a set of web pages eliminates the need for the WSAT and used by various administrative users from any computer.</span></span>

<span data-ttu-id="e6134-195">快樂的程式設計！</span><span class="sxs-lookup"><span data-stu-id="e6134-195">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="e6134-196">進一步閱讀</span><span class="sxs-lookup"><span data-stu-id="e6134-196">Further Reading</span></span>

<span data-ttu-id="e6134-197">如需本教學課程中所討論之主題的詳細資訊，請參閱下列資源：</span><span class="sxs-lookup"><span data-stu-id="e6134-197">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="e6134-198">檢查 ASP。NET 的成員資格、角色和設定檔</span><span class="sxs-lookup"><span data-stu-id="e6134-198">Examining ASP.NET's Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="e6134-199">推出您自己的網站管理工具</span><span class="sxs-lookup"><span data-stu-id="e6134-199">Rolling Your Own Web Site Administration Tool</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)
- [<span data-ttu-id="e6134-200">網站管理工具總覽</span><span class="sxs-lookup"><span data-stu-id="e6134-200">Web Site Administration Tool Overview</span></span>](https://msdn.microsoft.com/library/yy40ytx0.aspx)
- [<span data-ttu-id="e6134-201">網站安全性教學課程</span><span class="sxs-lookup"><span data-stu-id="e6134-201">Website Security Tutorials</span></span>](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md)

> [!div class="step-by-step"]
> [<span data-ttu-id="e6134-202">上一篇</span><span class="sxs-lookup"><span data-stu-id="e6134-202">Previous</span></span>](precompiling-your-website-vb.md)
