---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/common-configuration-differences-between-development-and-production-cs
title: 常見組態差異開發和生產環境 (C#) |Microsoft Docs
author: rick-anderson
description: 在先前的教學課程中，我們會部署我們的網站所複製的所有相關的檔案從開發環境到生產環境。 不過，我...
ms.author: riande
ms.date: 04/01/2009
ms.assetid: 721a5c37-7e21-48e0-832e-535c6351dcae
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/common-configuration-differences-between-development-and-production-cs
msc.type: authoredcontent
ms.openlocfilehash: 265243a54eb5ab28a7f76d2df32a9442d61862a5
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 05/06/2019
ms.locfileid: "65130657"
---
# <a name="common-configuration-differences-between-development-and-production-c"></a><span data-ttu-id="605bb-104">開發與生產環境間的常見設定差異 (C#)</span><span class="sxs-lookup"><span data-stu-id="605bb-104">Common Configuration Differences Between Development and Production (C#)</span></span>

<span data-ttu-id="605bb-105">藉由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="605bb-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

[<span data-ttu-id="605bb-106">下載 PDF</span><span class="sxs-lookup"><span data-stu-id="605bb-106">Download PDF</span></span>](http://download.microsoft.com/download/E/8/9/E8920AE6-D441-41A7-8A77-9EF8FF970D8B/aspnet_tutorial05_ConfigDifferences_cs.pdf)

> <span data-ttu-id="605bb-107">在先前的教學課程中，我們會部署我們的網站所複製的所有相關的檔案從開發環境到生產環境。</span><span class="sxs-lookup"><span data-stu-id="605bb-107">In earlier tutorials we deployed our website by copying all of the pertinent files from the development environment to the production environment.</span></span> <span data-ttu-id="605bb-108">不過，不可能有組態差異會使得每個環境都有唯一的 Web.config 檔案的環境發生的狀況。</span><span class="sxs-lookup"><span data-stu-id="605bb-108">However, it is not uncommon for there to be configuration differences between environments, which necessitates that each environment have a unique Web.config file.</span></span> <span data-ttu-id="605bb-109">本教學課程會檢查常見組態差異，並探討維護個別的組態資訊的策略。</span><span class="sxs-lookup"><span data-stu-id="605bb-109">This tutorial examines typical configuration differences and looks at strategies for maintaining separate configuration information.</span></span>

## <a name="introduction"></a><span data-ttu-id="605bb-110">簡介</span><span class="sxs-lookup"><span data-stu-id="605bb-110">Introduction</span></span>

<span data-ttu-id="605bb-111">最後兩個教學課程會逐步部署簡單的 web 應用程式。</span><span class="sxs-lookup"><span data-stu-id="605bb-111">The last two tutorials walked through deploying a simple web application.</span></span> <span data-ttu-id="605bb-112">[*部署您的網站使用 FTP 用戶端*](deploying-your-site-using-an-ftp-client-cs.md)教學課程示範了如何使用獨立 FTP 用戶端從開發環境，一直到生產階段複製必要的檔案。</span><span class="sxs-lookup"><span data-stu-id="605bb-112">The [*Deploying Your Site Using an FTP Client*](deploying-your-site-using-an-ftp-client-cs.md) tutorial showed how to use a stand-alone FTP client to copy the necessary files from the development environment up to production.</span></span> <span data-ttu-id="605bb-113">先前的教學課程中， [*部署您的網站使用的 Visual Studio*](deploying-your-site-using-visual-studio-cs.md)、 探討使用 Visual Studio 複製網站工具和發佈選項的部署。</span><span class="sxs-lookup"><span data-stu-id="605bb-113">The preceding tutorial, [*Deploying Your Site Using Visual Studio*](deploying-your-site-using-visual-studio-cs.md), looked at deployment using Visual Studio's Copy Web Site tool and Publish option.</span></span> <span data-ttu-id="605bb-114">在這兩個教學課程中的生產環境中的每個檔案是一份檔案，以在開發環境。</span><span class="sxs-lookup"><span data-stu-id="605bb-114">In both tutorials every file in the production environment was a copy of a file on the development environment.</span></span> <span data-ttu-id="605bb-115">不過，就經常以不同於在開發環境與生產環境中的組態檔。</span><span class="sxs-lookup"><span data-stu-id="605bb-115">However, it is not uncommon for configuration files in the production environment to differ from those in the development environment.</span></span> <span data-ttu-id="605bb-116">Web 應用程式的組態儲存在`Web.config`檔案，並通常包括外部資源，例如資料庫、 web 和電子郵件伺服器的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="605bb-116">A web application's configuration is stored in the `Web.config` file and typically includes information about external resources, such as database, web, and email servers.</span></span> <span data-ttu-id="605bb-117">它也詳細說明，請在某些情況下，例如採取的未處理的例外狀況發生時要採取的動作中的應用程式的行為。</span><span class="sxs-lookup"><span data-stu-id="605bb-117">It also spells out the behavior of the application in certain situations, such as the course of action to take when an unhandled exception occurs.</span></span>

<span data-ttu-id="605bb-118">部署 web 應用程式時很重要，正確的設定資訊最後在生產環境中。</span><span class="sxs-lookup"><span data-stu-id="605bb-118">When deploying a web application it is important that the correct configuration information end up in the production environment.</span></span> <span data-ttu-id="605bb-119">在大部分情況下`Web.config`無法在開發環境中的檔案複製到與生產環境-是。</span><span class="sxs-lookup"><span data-stu-id="605bb-119">In most cases the `Web.config` file in the development environment cannot be copied to the production environment as-is.</span></span> <span data-ttu-id="605bb-120">相反地，自訂的版本的`Web.config`需要上傳到生產環境。</span><span class="sxs-lookup"><span data-stu-id="605bb-120">Instead, a customized version of `Web.config` needs to be uploaded to production.</span></span> <span data-ttu-id="605bb-121">本教學課程簡短回顧一些較常見的組態差異;本文件也摘要了維護不同的組態資訊在環境之間的一些技術。</span><span class="sxs-lookup"><span data-stu-id="605bb-121">This tutorial briefly reviews some of the more common configuration differences; it also summarizes some techniques for maintaining different configuration information between the environments.</span></span>

## <a name="typical-configuration-differences-between-the-development-and-production-environments"></a><span data-ttu-id="605bb-122">開發和生產環境的常見組態差異</span><span class="sxs-lookup"><span data-stu-id="605bb-122">Typical Configuration Differences Between the Development and Production Environments</span></span>

<span data-ttu-id="605bb-123">`Web.config`檔案包含各種 ASP.NET 應用程式的組態資訊。</span><span class="sxs-lookup"><span data-stu-id="605bb-123">The `Web.config` file includes an assortment of configuration information for an ASP.NET application.</span></span> <span data-ttu-id="605bb-124">部分組態資訊，無論是一樣的環境。</span><span class="sxs-lookup"><span data-stu-id="605bb-124">Some of this configuration information is the same regardless of the environment.</span></span> <span data-ttu-id="605bb-125">比方說，驗證設定和 URL 授權規則拼出`Web.config`檔案的`<authentication>`和`<authorization>`項目通常是相同的環境無關。</span><span class="sxs-lookup"><span data-stu-id="605bb-125">For instance, the authentication settings and URL authorization rules spelled out in the `Web.config` file's `<authentication>` and `<authorization>` elements are usually the same regardless of the environment.</span></span> <span data-ttu-id="605bb-126">但其他組態資訊-例如有關外部資源，通常與不同的環境而定。</span><span class="sxs-lookup"><span data-stu-id="605bb-126">But other configuration information - such as information about external resources - typically differs depending on the environment.</span></span>

<span data-ttu-id="605bb-127">資料庫連接字串是不同的組態資訊的基本範例會根據環境。</span><span class="sxs-lookup"><span data-stu-id="605bb-127">Database connections strings are a prime example of configuration information that differs based on the environment.</span></span> <span data-ttu-id="605bb-128">當 web 應用程式資料庫與伺服器通訊，它必須先建立連線，並可透過[連接字串](http://www.connectionstrings.com/Articles/Show/what-is-a-connection-string)。</span><span class="sxs-lookup"><span data-stu-id="605bb-128">When a web application communicates with a database server it must first establish a connection, and that is achieved through a [connection string](http://www.connectionstrings.com/Articles/Show/what-is-a-connection-string).</span></span> <span data-ttu-id="605bb-129">雖然您可以用硬式編碼直接在網頁或連接至資料庫的程式碼中的資料庫連接字串，所以最好先將它放`Web.config`的[`<connectionStrings>`項目](https://msdn.microsoft.com/library/bf7sd233.aspx)以便在連接字串資訊是在單一的集中式位置。</span><span class="sxs-lookup"><span data-stu-id="605bb-129">While it is possible to hard-code the database connection string directly in the web pages or the code that connects to the database, it is best to place it `Web.config`'s [`<connectionStrings>` element](https://msdn.microsoft.com/library/bf7sd233.aspx) so that the connection string information is in a single, centralized location.</span></span> <span data-ttu-id="605bb-130">通常不同的資料庫是在開發期間使用非用於生產環境。因此，連接字串資訊必須是唯一的每個環境。</span><span class="sxs-lookup"><span data-stu-id="605bb-130">Oftentimes a different database is used during development than is used in production; consequently, the connection string information must be unique for each environment.</span></span>

> [!NOTE]
> <span data-ttu-id="605bb-131">未來的教學課程會探索部署資料導向應用程式，此時我們將探討如何將資料庫連接字串儲存在組態檔中的細節。</span><span class="sxs-lookup"><span data-stu-id="605bb-131">Future tutorials explore deploying data-driven applications, at which point we'll dive into the specifics of how database connection strings are stored in the configuration file.</span></span>

<span data-ttu-id="605bb-132">開發和生產環境的預期的行為與本質上不同。</span><span class="sxs-lookup"><span data-stu-id="605bb-132">The intended behavior of the development and production environments differs substantially.</span></span> <span data-ttu-id="605bb-133">在開發環境中的 web 應用程式正在建立、 測試及偵錯的一小群開發人員。</span><span class="sxs-lookup"><span data-stu-id="605bb-133">A web application in the development environment is being created, tested, and debugged by a small group of developers.</span></span> <span data-ttu-id="605bb-134">在生產環境中由許多不同的同步使用者所造訪該相同的應用程式。</span><span class="sxs-lookup"><span data-stu-id="605bb-134">In the production environment that same application is being visited by many different simultaneous users.</span></span> <span data-ttu-id="605bb-135">ASP.NET 包含數項功能，可協助開發人員測試和偵錯應用程式，但這些功能應停用效能和安全性理由，在生產環境中。</span><span class="sxs-lookup"><span data-stu-id="605bb-135">ASP.NET includes a number of features that help developers in testing and debugging an application, but these features should be disabled for performance and security reasons when in the production environment.</span></span> <span data-ttu-id="605bb-136">讓我們看看一些這類組態設定。</span><span class="sxs-lookup"><span data-stu-id="605bb-136">Let's look at a few such configuration settings.</span></span>

### <a name="configuration-settings-that-impact-performance"></a><span data-ttu-id="605bb-137">會影響效能的組態設定</span><span class="sxs-lookup"><span data-stu-id="605bb-137">Configuration Settings That Impact Performance</span></span>

<span data-ttu-id="605bb-138">當瀏覽 ASP.NET 網頁時的第一次 （或第一次變更後），其宣告式標記必須先轉換成類別，這個類別必須編譯。</span><span class="sxs-lookup"><span data-stu-id="605bb-138">When an ASP.NET page is visited for the first time (or the first time after it has changed), its declarative markup must be converted into a class and this class must be compiled.</span></span> <span data-ttu-id="605bb-139">如果 web 應用程式使用自動編譯網頁的程式碼後置類別就必須重新編譯，太。</span><span class="sxs-lookup"><span data-stu-id="605bb-139">If the web application uses automatic compilation then the page's code-behind class needs to be compiled, too.</span></span> <span data-ttu-id="605bb-140">您可以設定編譯選項，透過各種`Web.config`檔案的[`<compilation>`項目](https://msdn.microsoft.com/library/s10awwz0.aspx)。</span><span class="sxs-lookup"><span data-stu-id="605bb-140">You can configure an assortment of compilation options via the `Web.config` file's [`<compilation>` element](https://msdn.microsoft.com/library/s10awwz0.aspx).</span></span>

<span data-ttu-id="605bb-141">偵錯屬性是其中一個最重要的屬性，在`<compilation>`項目。</span><span class="sxs-lookup"><span data-stu-id="605bb-141">The debug attribute is one of the most important attributes in the `<compilation>` element.</span></span> <span data-ttu-id="605bb-142">如果`debug`屬性設為"true"則表示已編譯的組件包含偵錯 Visual Studio 中的應用程式時所需的偵錯符號。</span><span class="sxs-lookup"><span data-stu-id="605bb-142">If the `debug` attribute is set to "true" then the compiled assemblies include debug symbols, which are needed when debugging an application in Visual Studio.</span></span> <span data-ttu-id="605bb-143">但是，偵錯符號增加組件的大小，並執行程式碼時，會造成額外的記憶體需求。</span><span class="sxs-lookup"><span data-stu-id="605bb-143">But debug symbols increase the size of the assembly and impose additional memory requirements when running the code.</span></span> <span data-ttu-id="605bb-144">此外，當`debug`屬性設定為"true"所傳回的任何內容`WebResource.axd`未快取，這表示，每次使用者瀏覽他們必須重新下載靜態內容所傳回的頁面`WebResource.axd`。</span><span class="sxs-lookup"><span data-stu-id="605bb-144">Furthermore, when the `debug` attribute is set to "true" any content returned by `WebResource.axd` is not cached, meaning that each time a user visits a page they will need to re-download the static content returned by `WebResource.axd`.</span></span>

> [!NOTE]
> <span data-ttu-id="605bb-145">`WebResource.axd` 是內建的 HTTP 處理常式在 ASP.NET 2.0 引進伺服器控制項用來擷取內嵌的資源，例如指令碼檔案、 影像、 CSS 檔案和其他內容。</span><span class="sxs-lookup"><span data-stu-id="605bb-145">`WebResource.axd` is a built-in HTTP Handler introduced in ASP.NET 2.0 that server controls use to retrieve embedded resources, such as script files, images, CSS files, and other content.</span></span> <span data-ttu-id="605bb-146">如需有關如何`WebResource.axd`運作，以及如何使用它來存取內嵌的資源，從您的自訂伺服器控制項，請參閱[存取內嵌的資源透過 URL 使用`WebResource.axd` ](http://aspnet.4guysfromrolla.com/articles/080906-1.aspx)。</span><span class="sxs-lookup"><span data-stu-id="605bb-146">For more information on how `WebResource.axd` works and how you can use it to access embedded resources from your custom server controls, see [Accessing Embedded Resources Through a URL Using `WebResource.axd`](http://aspnet.4guysfromrolla.com/articles/080906-1.aspx).</span></span>

<span data-ttu-id="605bb-147">`<compilation>`項目的`debug`屬性通常設定為"true"在開發環境中。</span><span class="sxs-lookup"><span data-stu-id="605bb-147">The `<compilation>` element's `debug` attribute is usually set to "true" in the development environment.</span></span> <span data-ttu-id="605bb-148">事實上，此屬性必須設為"true"，才能在 web 應用程式進行偵錯如果您嘗試偵錯 ASP.NET 應用程式從 Visual Studio 和`debug`屬性設定為"false"時，Visual Studio 會顯示訊息，說明無法進行應用程式偵錯，直到`debug`屬性設為"true"，並將若要進行這項變更為您的供應項目。</span><span class="sxs-lookup"><span data-stu-id="605bb-148">In fact, this attribute must be set to "true" in order to debug a web application; if you try to debug an ASP.NET application from Visual Studio and the `debug` attribute is set to "false", Visual Studio will display a message explaining that the application cannot be debugged until the `debug` attribute is set to "true" and will offer to make this change for you.</span></span>

<span data-ttu-id="605bb-149">您應該**從未**有`debug`屬性設定為"true"，在生產環境中，因為它對效能的影響。</span><span class="sxs-lookup"><span data-stu-id="605bb-149">You should **never** have the `debug` attribute set to "true" in a production environment because of its impact on performance.</span></span> <span data-ttu-id="605bb-150">如需本主題的深入討論，請參閱[Scott Guthrie](https://weblogs.asp.net/scottgu/)的部落格文章[不執行生產環境 ASP.NET 應用程式與`debug="true"`Enabled](https://weblogs.asp.net/scottgu/442448)。</span><span class="sxs-lookup"><span data-stu-id="605bb-150">For a more thorough discussion on this topic, refer to [Scott Guthrie](https://weblogs.asp.net/scottgu/)'s blog post, [Don't Run Production ASP.NET Applications With `debug="true"` Enabled](https://weblogs.asp.net/scottgu/442448).</span></span>

### <a name="custom-errors-and-tracing"></a><span data-ttu-id="605bb-151">自訂的錯誤和追蹤</span><span class="sxs-lookup"><span data-stu-id="605bb-151">Custom Errors and Tracing</span></span>

<span data-ttu-id="605bb-152">在 ASP.NET 應用程式中處理的例外狀況時它會顯示最多三個事項之一發生在哪個時間點的執行階段：</span><span class="sxs-lookup"><span data-stu-id="605bb-152">When an unhandled exception occurs in an ASP.NET application it bubbles up to the runtime at which point one of three things happens:</span></span>

- <span data-ttu-id="605bb-153">會顯示一般的執行階段錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="605bb-153">A generic runtime error message is displayed.</span></span> <span data-ttu-id="605bb-154">此頁面會通知那里的使用者執行階段錯誤，但不提供任何錯誤的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="605bb-154">This page informs the user that there was a runtime error, but does not provide any details about the error.</span></span>
- <span data-ttu-id="605bb-155">會顯示例外狀況詳細資料訊息，其中包含剛擲回的例外狀況的資訊。</span><span class="sxs-lookup"><span data-stu-id="605bb-155">An exception details message is displayed, which includes information on the exception that was just thrown.</span></span>
- <span data-ttu-id="605bb-156">顯示自訂錯誤頁面，這是 ASP.NET 網頁，您建立可顯示您想要的任何訊息。</span><span class="sxs-lookup"><span data-stu-id="605bb-156">A custom error page is displayed, which is an ASP.NET page that you create that displays any message you desire.</span></span>

<span data-ttu-id="605bb-157">發生未處理的例外狀況的情況取決於`Web.config`檔案的[`<customErrors>`一節](https://msdn.microsoft.com/library/h0hfz6fc.aspx)。</span><span class="sxs-lookup"><span data-stu-id="605bb-157">What happens in the face of an unhandled exception depends on the `Web.config` file's [`<customErrors>` section](https://msdn.microsoft.com/library/h0hfz6fc.aspx).</span></span>

<span data-ttu-id="605bb-158">開發和測試應用程式時最好先查看瀏覽器中的任何例外狀況的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="605bb-158">When developing and testing an application it helps to see details of any exception in the browser.</span></span> <span data-ttu-id="605bb-159">不過，在生產環境應用程式中顯示例外狀況詳細資料是潛在的安全性風險。</span><span class="sxs-lookup"><span data-stu-id="605bb-159">However, showing exception details in an application on production is a potential security risk.</span></span> <span data-ttu-id="605bb-160">此外，它是 unflattering，並可讓您的網站看起來不夠專業。</span><span class="sxs-lookup"><span data-stu-id="605bb-160">Moreover, it's unflattering and makes your website look unprofessional.</span></span> <span data-ttu-id="605bb-161">在理想情況下，發生未處理的例外狀況時在開發環境中的 web 應用程式會顯示例外狀況的詳細資料而在生產環境中相同的應用程式將會顯示自訂錯誤頁面。</span><span class="sxs-lookup"><span data-stu-id="605bb-161">Ideally, in the event of an unhandled exception a web application in the development environment will show the exception's details while the same application in production will show a custom error page.</span></span>

> [!NOTE]
> <span data-ttu-id="605bb-162">預設值`<customErrors>`例外狀況詳細資料訊息的頁面所造訪透過 localhost，且否則顯示一般的執行階段錯誤頁面時，才會顯示區段設定。</span><span class="sxs-lookup"><span data-stu-id="605bb-162">The default `<customErrors>` section setting shows the exception details message only when the page is being visited through localhost, and shows the generic runtime error page otherwise.</span></span> <span data-ttu-id="605bb-163">這並不理想，但它會確保知道的預設行為並不會顯示非本機訪客的例外狀況詳細資料。</span><span class="sxs-lookup"><span data-stu-id="605bb-163">This isn't ideal, but it's assuring to know that the default behavior doesn't reveal exception details to non-local visitors.</span></span> <span data-ttu-id="605bb-164">未來的教學課程會檢查`<customErrors>`一節中更多詳細資料，並說明如何將自訂錯誤網頁顯示在生產環境中發生的錯誤。</span><span class="sxs-lookup"><span data-stu-id="605bb-164">A future tutorial examines the `<customErrors>` section in more detail and shows how to have a custom error page shown when an error occurs in production.</span></span>

<span data-ttu-id="605bb-165">在開發期間很有用的另一個 ASP.NET 功能追蹤。</span><span class="sxs-lookup"><span data-stu-id="605bb-165">Another ASP.NET feature that is useful during development is tracing.</span></span> <span data-ttu-id="605bb-166">追蹤，如果啟用，記錄每個傳入要求的相關資訊，並提供特殊的網頁， `Trace.axd`，來檢視最近的要求詳細資料。</span><span class="sxs-lookup"><span data-stu-id="605bb-166">Tracing, if enabled, records information about each incoming request and provides a special web page, `Trace.axd`, for viewing recent request details.</span></span> <span data-ttu-id="605bb-167">您可以開啟和設定追蹤透過[`<trace>`項目](https://msdn.microsoft.com/library/6915t83k.aspx)在`Web.config`。</span><span class="sxs-lookup"><span data-stu-id="605bb-167">You can turn on and configure tracing via the [`<trace>` element](https://msdn.microsoft.com/library/6915t83k.aspx) in `Web.config`.</span></span>

<span data-ttu-id="605bb-168">如果您啟用追蹤，請務必確定它已停用在生產環境中。</span><span class="sxs-lookup"><span data-stu-id="605bb-168">If you enable tracing make sure that it is disabled in production.</span></span> <span data-ttu-id="605bb-169">追蹤資訊包括 cookie、 工作階段資料，以及其他潛在的敏感資訊，因此務必停用在生產環境中的追蹤。</span><span class="sxs-lookup"><span data-stu-id="605bb-169">Because the trace information includes cookies, session data, and other potentially sensitive information, it is important to disable tracing in production.</span></span> <span data-ttu-id="605bb-170">好消息是，根據預設，已停用追蹤和`Trace.axd`檔案就只能透過 localhost 存取。</span><span class="sxs-lookup"><span data-stu-id="605bb-170">The good news is that, by default, tracing is disabled and the `Trace.axd` file is only accessible through localhost.</span></span> <span data-ttu-id="605bb-171">如果您變更這些預設設定，在開發過程中確定，它們會關閉上一步在生產環境中。</span><span class="sxs-lookup"><span data-stu-id="605bb-171">If you change these default settings in development make sure that they are turned back off in production.</span></span>

## <a name="techniques-for-maintaining-separate-configuration-information"></a><span data-ttu-id="605bb-172">維護個別的組態資訊的技術</span><span class="sxs-lookup"><span data-stu-id="605bb-172">Techniques for Maintaining Separate Configuration Information</span></span>

<span data-ttu-id="605bb-173">開發和生產環境中有不同的組態設定變得非常複雜的部署程序。</span><span class="sxs-lookup"><span data-stu-id="605bb-173">Having different configuration settings in the development and production environments complicates the deployment process.</span></span> <span data-ttu-id="605bb-174">先前的兩個教學課程中的部署程序牽涉到複製所有必要的檔案從開發到生產環境，但此方法僅適用於組態資訊為兩個環境中相同。</span><span class="sxs-lookup"><span data-stu-id="605bb-174">In the previous two tutorials the deployment process involved copying all of the necessary files from development to production, but that approach only works if the configuration information is the same in both environments.</span></span> <span data-ttu-id="605bb-175">有各種不同的部署具有不同的組態資訊的應用程式的技術。</span><span class="sxs-lookup"><span data-stu-id="605bb-175">There are a variety of techniques for deploying an application with varying configuration information.</span></span> <span data-ttu-id="605bb-176">讓我們目錄其中一些託管的 web 應用程式的選項。</span><span class="sxs-lookup"><span data-stu-id="605bb-176">Let's catalog some of these options for hosted web applications.</span></span>

### <a name="manually-deploying-the-production-environment-configuration-file"></a><span data-ttu-id="605bb-177">手動部署實際執行環境組態檔</span><span class="sxs-lookup"><span data-stu-id="605bb-177">Manually Deploying the Production Environment Configuration File</span></span>

<span data-ttu-id="605bb-178">最簡單的方法是維護兩個版本`Web.config`檔案： 一個用於開發環境，一個用於生產環境。</span><span class="sxs-lookup"><span data-stu-id="605bb-178">The simplest approach is to maintain two versions of the `Web.config` file: one for the development environment and one for the production environment.</span></span> <span data-ttu-id="605bb-179">部署至生產環境的站台需要的所有檔案複製到實際執行伺服器，在開發環境*除了*如`Web.config`檔案。</span><span class="sxs-lookup"><span data-stu-id="605bb-179">Deploying a site to production entails copying all of the files to the production server in the development environment *except* for the `Web.config` file.</span></span> <span data-ttu-id="605bb-180">相反地，實際執行環境特定`Web.config`檔案將會複製到實際執行環境。</span><span class="sxs-lookup"><span data-stu-id="605bb-180">Instead, the production environment-specific `Web.config` file would be copied to production.</span></span>

<span data-ttu-id="605bb-181">此方法不是非常複雜，但很容易實作，因為不常變更的組態資訊。</span><span class="sxs-lookup"><span data-stu-id="605bb-181">This approach is not very sophisticated, but it is easy to implement because configuration information changes infrequently.</span></span> <span data-ttu-id="605bb-182">它適合用於應用程式與小型開發團隊，單一的 web 伺服器上裝載，而且不常變更其組態資訊。</span><span class="sxs-lookup"><span data-stu-id="605bb-182">It works best for applications with a small development team that are hosted on a single web server and whose configuration information is infrequently changed.</span></span> <span data-ttu-id="605bb-183">手動部署使用獨立 FTP 用戶端應用程式檔案時，它是最 tenable。</span><span class="sxs-lookup"><span data-stu-id="605bb-183">It's most tenable when manually deploying the application files using a stand-alone FTP client.</span></span> <span data-ttu-id="605bb-184">使用 Visual Studio 複製網站工具或 [發佈] 選項時您必須先抽換部署特定`Web.config`以在部署之前，生產環境特定的檔案，然後再將其交換部署完成之後。</span><span class="sxs-lookup"><span data-stu-id="605bb-184">When using Visual Studio's Copy Web Site tool or Publish option you'll need to first swap out the deployment-specific `Web.config` file with the production-specific one before deploying, and then swap them back after deployment completes.</span></span>

### <a name="change-the-configuration-during-the-build-or-deployment-process"></a><span data-ttu-id="605bb-185">變更組建或部署程序期間設定</span><span class="sxs-lookup"><span data-stu-id="605bb-185">Change the Configuration During the Build or Deployment Process</span></span>

<span data-ttu-id="605bb-186">到目前為止的討論被假設特定的建置和部署程序。</span><span class="sxs-lookup"><span data-stu-id="605bb-186">The discussions thus far have assumed an ad-hoc build and deployment process.</span></span> <span data-ttu-id="605bb-187">許多較大型的軟體專案擁有更正式的程序，讓使用開放原始碼，自產或第三方工具。</span><span class="sxs-lookup"><span data-stu-id="605bb-187">Many larger software projects have more formalized processes that make use of open-source, home-grown, or third-party tools.</span></span> <span data-ttu-id="605bb-188">這類專案您可能可以自訂推桿推到生產環境之前適當地修改的組態資訊的組建或部署程序。</span><span class="sxs-lookup"><span data-stu-id="605bb-188">For such projects you can likely customize the build or deployment process to appropriately modify the configuration information before it is pushed to production.</span></span> <span data-ttu-id="605bb-189">如果您要建置您的 web 應用程式使用[MSBuild](http://en.wikipedia.org/wiki/MSBuild)， [NAnt](http://nant.sourceforge.net/)，或其他建置工具，您可以有可能加入建置步驟以修改`Web.config`檔案以包含生產環境特定設定。</span><span class="sxs-lookup"><span data-stu-id="605bb-189">If you build your web application using [MSBuild](http://en.wikipedia.org/wiki/MSBuild), [NAnt](http://nant.sourceforge.net/), or some other build tool, you can likely add a build step to modify the `Web.config` file to include the production-specific settings.</span></span> <span data-ttu-id="605bb-190">或您的部署工作流程無法以程式設計方式連接到原始檔控制伺服器並擷取適當`Web.config`檔案。</span><span class="sxs-lookup"><span data-stu-id="605bb-190">Or your deployment workflow could programmatically connect to the source control server and retrieve the appropriate `Web.config` file.</span></span>

<span data-ttu-id="605bb-191">取得適當的組態資訊到生產環境的實際方法會依據您的工具和工作流程而有所不同。</span><span class="sxs-lookup"><span data-stu-id="605bb-191">The actual approach for getting the appropriate configuration information to production varies widely based on your tools and workflow.</span></span> <span data-ttu-id="605bb-192">因此，我們不會探討本主題會進一步。</span><span class="sxs-lookup"><span data-stu-id="605bb-192">As such, we will not delve into this topic further.</span></span> <span data-ttu-id="605bb-193">如果您使用熱門的建置工具 MSBuild 或 NAnt 您可以找到部署文件和教學課程特有這些工具，透過 web 搜尋。</span><span class="sxs-lookup"><span data-stu-id="605bb-193">If you are using a popular build tool like MSBuild or NAnt you can find deployment articles and tutorials specific to these tools through a web search.</span></span>

### <a name="managing-configuration-differences-via-the-web-deployment-project-add-in"></a><span data-ttu-id="605bb-194">管理組態差異，透過 Web 部署專案增益集</span><span class="sxs-lookup"><span data-stu-id="605bb-194">Managing Configuration Differences via the Web Deployment Project Add-In</span></span>

<span data-ttu-id="605bb-195">2006 Microsoft 發行的 Web 開發專案增益集適用於 Visual Studio 2005。</span><span class="sxs-lookup"><span data-stu-id="605bb-195">In 2006 Microsoft released the Web Development Project Add-In for Visual Studio 2005.</span></span> <span data-ttu-id="605bb-196">適用於 Visual Studio 2008 增益集是在 2008年發行。</span><span class="sxs-lookup"><span data-stu-id="605bb-196">An Add-In for Visual Studio 2008 was released in 2008.</span></span> <span data-ttu-id="605bb-197">此增益集可讓 ASP.NET 開發人員建立個別的 Web 部署專案和其 web 應用程式專案，建置時、 明確編譯 web 應用程式並將檔案複製到部署到本機的輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="605bb-197">This Add-In allows for ASP.NET developers to create a separate Web Deployment Project alongside their web application project that, when built, explicitly compiles the web application and copies the files to deploy to a local output directory.</span></span> <span data-ttu-id="605bb-198">Web 應用程式專案會在幕後使用 MSBuild。</span><span class="sxs-lookup"><span data-stu-id="605bb-198">The Web Application Project uses MSBuild behind the scenes.</span></span>

<span data-ttu-id="605bb-199">根據預設，在開發環境的`Web.config`檔案複製到輸出目錄中，但您可以設定自訂的 Web 部署專案</span><span class="sxs-lookup"><span data-stu-id="605bb-199">By default, the development environment's `Web.config` file is copied to the output directory, but you can setup the Web Deployment Project to customize the</span></span>

<span data-ttu-id="605bb-200">取得透過下列方式複製到這個目錄的組態資訊：</span><span class="sxs-lookup"><span data-stu-id="605bb-200">configuration information that gets copied to this directory in the following ways:</span></span>

- <span data-ttu-id="605bb-201">透過`Web.config`檔案區段取代，您可以在其中指定要取代的區段和 XML 檔案，其中包含取代文字。</span><span class="sxs-lookup"><span data-stu-id="605bb-201">Via `Web.config` file section replacement, in which you specify the section to replace and an XML file that contains the replacement text.</span></span>
- <span data-ttu-id="605bb-202">藉由提供外部組態來源檔的路徑。</span><span class="sxs-lookup"><span data-stu-id="605bb-202">By providing a path to an external configuration source file.</span></span> <span data-ttu-id="605bb-203">選取此選項，Web 部署專案複製特定`Web.config`到輸出目錄的檔案 (而非`Web.config`開發環境中使用的檔案)。</span><span class="sxs-lookup"><span data-stu-id="605bb-203">With this option selected, the Web Deployment Project copies a particular `Web.config` file to the output directory (rather than the `Web.config` file used in the development environment).</span></span>
- <span data-ttu-id="605bb-204">加入 Web 部署專案所使用的 MSBuild 檔案中的自訂規則。</span><span class="sxs-lookup"><span data-stu-id="605bb-204">By adding custom rules to the MSBuild file used by the Web Deployment Project.</span></span>

<span data-ttu-id="605bb-205">若要部署 web 應用程式建置 Web 部署專案，然後將檔案從專案的輸出資料夾複製到生產環境。</span><span class="sxs-lookup"><span data-stu-id="605bb-205">To deploy the web application build the Web Deployment Project and then copy the files from the project's output folder to the production environment.</span></span>

<span data-ttu-id="605bb-206">若要了解使用 Web 部署專案的詳細資訊請參閱[Web 部署專案本文](https://msdn.microsoft.com/magazine/cc163448.aspx)2007 年 4 月號的[MSDN Magazine](https://msdn.microsoft.com/magazine/default.aspx)，或請參閱 「 深入閱讀 」 一節中的連結本教學課程的結尾。</span><span class="sxs-lookup"><span data-stu-id="605bb-206">To learn more about using the Web Deployment Project check out [this Web Deployment Projects article](https://msdn.microsoft.com/magazine/cc163448.aspx) from the April 2007 issue of [MSDN Magazine](https://msdn.microsoft.com/magazine/default.aspx), or consult the links in the Further Reading section at the end of this tutorial.</span></span>

> [!NOTE]
> <span data-ttu-id="605bb-207">您無法使用 Web 部署專案使用 Visual Web Developer，因為 Web 部署專案做為 Visual Studio 增益集實作，而且 Visual Studio Express 各版本 （包括 Visual Web Developer） 不支援增益集。</span><span class="sxs-lookup"><span data-stu-id="605bb-207">You cannot use the Web Deployment Project with Visual Web Developer because the Web Deployment Project is implemented as a Visual Studio Add-In and the Visual Studio Express Editions (including Visual Web Developer) do not support Add-Ins.</span></span>

## <a name="summary"></a><span data-ttu-id="605bb-208">總結</span><span class="sxs-lookup"><span data-stu-id="605bb-208">Summary</span></span>

<span data-ttu-id="605bb-209">外部資源和 web 應用程式開發中的行為是通常不同於相同的應用程式處於生產環境。</span><span class="sxs-lookup"><span data-stu-id="605bb-209">The external resources and behavior of a web application in development are typically different than when the same application is in production.</span></span> <span data-ttu-id="605bb-210">例如，資料庫連接字串、 編譯選項，以及處理的例外狀況通常發生時的行為不同環境之間。</span><span class="sxs-lookup"><span data-stu-id="605bb-210">For instance, database connection strings, compilation options, and the behavior when an unhandled exception occurs commonly differ between environments.</span></span> <span data-ttu-id="605bb-211">部署程序必須配合這些差異。</span><span class="sxs-lookup"><span data-stu-id="605bb-211">The deployment process must accommodate these differences.</span></span> <span data-ttu-id="605bb-212">如我們在本教學課程所討論的最簡單的方法是手動複製到生產環境的 其他設定檔案。</span><span class="sxs-lookup"><span data-stu-id="605bb-212">As we discussed in this tutorial, the simplest approach is to manually copy an alternate configuration file to the production environment.</span></span> <span data-ttu-id="605bb-213">可能會有更精緻的解決方案或使用更正式的組建或部署程序可容納這類自訂項目時使用 Web 部署專案增益集。</span><span class="sxs-lookup"><span data-stu-id="605bb-213">More elegant solutions are possible when using the Web Deployment Project Add-In or with a more formalized build or deployment process that can accommodate such customizations.</span></span>

<span data-ttu-id="605bb-214">快樂地寫程式 ！</span><span class="sxs-lookup"><span data-stu-id="605bb-214">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="605bb-215">進一步閱讀</span><span class="sxs-lookup"><span data-stu-id="605bb-215">Further Reading</span></span>

<span data-ttu-id="605bb-216">如需有關在本教學課程所討論的主題的詳細資訊，請參閱下列資源：</span><span class="sxs-lookup"><span data-stu-id="605bb-216">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="605bb-217">連接字串說明</span><span class="sxs-lookup"><span data-stu-id="605bb-217">Connection Strings Explained</span></span>](http://www.connectionstrings.com/Articles/Show/what-is-a-connection-string)
- [<span data-ttu-id="605bb-218">資料庫連接字串 @ ConnectionStrings.com</span><span class="sxs-lookup"><span data-stu-id="605bb-218">Database Connection Strings @ ConnectionStrings.com</span></span>](http://www.connectionstrings.com/)
- [<span data-ttu-id="605bb-219">不會執行實際執行 ASP.NET 應用程式與`debug="true"`啟用</span><span class="sxs-lookup"><span data-stu-id="605bb-219">Don't Run Production ASP.NET Applications with `debug="true"` Enabled</span></span>](https://weblogs.asp.net/scottgu/Don_1920_t-run-production-ASP.NET-Applications-with-debug_3D001D20_true_1D20_-enabled)
- [<span data-ttu-id="605bb-220">依正常程序回應未處理的例外狀況-顯示使用者易記的錯誤頁面</span><span class="sxs-lookup"><span data-stu-id="605bb-220">Gracefully Responding to Unhandled Exceptions - Displaying User-Friendly Error Pages</span></span>](http://aspnet.4guysfromrolla.com/articles/090606-1.aspx)
- [<span data-ttu-id="605bb-221">How Do i:使用 Visual Studio 2008 Web 部署專案嗎？</span><span class="sxs-lookup"><span data-stu-id="605bb-221">How Do I: Use a Visual Studio 2008 Web Deployment Project?</span></span>](../../../videos/how-do-i/how-do-i-use-a-visual-studio-2008-web-deployment-project.md)
- [<span data-ttu-id="605bb-222">部署資料庫時的重要組態設定</span><span class="sxs-lookup"><span data-stu-id="605bb-222">Key Configuration Settings When Deploying a Database</span></span>](http://aspnet.4guysfromrolla.com/articles/121008-1.aspx)
- <span data-ttu-id="605bb-223">[Visual Studio 2008 Web 部署專案下載](https://www.microsoft.com/downloads/details.aspx?FamilyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&amp;displaylang=en) | [Visual Studio 2005 Web 部署專案下載](https://download.microsoft.com/download/9/4/9/9496adc4-574e-4043-bb70-bc841e27f13c/WebDeploymentSetup.msi)</span><span class="sxs-lookup"><span data-stu-id="605bb-223">[Visual Studio 2008 Web Deployment Projects Download](https://www.microsoft.com/downloads/details.aspx?FamilyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&amp;displaylang=en) | [Visual Studio 2005 Web Deployment Projects Download](https://download.microsoft.com/download/9/4/9/9496adc4-574e-4043-bb70-bc841e27f13c/WebDeploymentSetup.msi)</span></span>
- <span data-ttu-id="605bb-224">[VS 2008 Web 部署專案](https://weblogs.asp.net/scottgu/archive/2005/11/06/429723.aspx) | [VS 2008 Web 部署專案支援發行](https://weblogs.asp.net/scottgu/archive/2008/01/28/vs-2008-web-deployment-project-support-released.aspx)</span><span class="sxs-lookup"><span data-stu-id="605bb-224">[VS 2008 Web Deployment Projects](https://weblogs.asp.net/scottgu/archive/2005/11/06/429723.aspx) | [VS 2008 Web Deployment Project Support Released](https://weblogs.asp.net/scottgu/archive/2008/01/28/vs-2008-web-deployment-project-support-released.aspx)</span></span>
- [<span data-ttu-id="605bb-225">Web 部署專案</span><span class="sxs-lookup"><span data-stu-id="605bb-225">Web Deployment Projects</span></span>](https://msdn.microsoft.com/magazine/cc163448.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="605bb-226">[上一頁](deploying-your-site-using-visual-studio-cs.md)
> [下一頁](core-differences-between-iis-and-the-asp-net-development-server-cs.md)</span><span class="sxs-lookup"><span data-stu-id="605bb-226">[Previous](deploying-your-site-using-visual-studio-cs.md)
[Next](core-differences-between-iis-and-the-asp-net-development-server-cs.md)</span></span>
