---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/strategies-for-database-development-and-deployment-vb
title: 資料庫開發及部署 (VB) 的策略 |Microsoft Docs
author: rick-anderson
description: 部署第一次的資料導向應用程式時可以盲目地將資料庫複製到生產環境的開發環境中。 B...
ms.author: riande
ms.date: 04/23/2009
ms.assetid: 07b8905d-78ac-4252-97fb-8675b3fb0bbf
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/strategies-for-database-development-and-deployment-vb
msc.type: authoredcontent
ms.openlocfilehash: afd287836337d0f9411daac805c3e9bcbb2dbadb
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/17/2019
ms.locfileid: "59385068"
---
# <a name="strategies-for-database-development-and-deployment-vb"></a><span data-ttu-id="80ace-104">資料庫開發及部署策略 (VB)</span><span class="sxs-lookup"><span data-stu-id="80ace-104">Strategies for Database Development and Deployment (VB)</span></span>

<span data-ttu-id="80ace-105">藉由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="80ace-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

[<span data-ttu-id="80ace-106">下載 PDF</span><span class="sxs-lookup"><span data-stu-id="80ace-106">Download PDF</span></span>](http://download.microsoft.com/download/C/3/9/C391A649-B357-4A7B-BAA4-48C96871FEA6/aspnet_tutorial10_DBDevel_vb.pdf)

> <span data-ttu-id="80ace-107">部署第一次的資料導向應用程式時可以盲目地將資料庫複製到生產環境的開發環境中。</span><span class="sxs-lookup"><span data-stu-id="80ace-107">When deploying a data-driven application for the first time you can blindly copy the database in the development environment to the production environment.</span></span> <span data-ttu-id="80ace-108">但是，執行 blind 在後續的部署中的複本將會覆寫任何進入實際執行資料庫的資料。</span><span class="sxs-lookup"><span data-stu-id="80ace-108">But performing a blind copy in subsequent deployments will overwrite any data entered into the production database.</span></span> <span data-ttu-id="80ace-109">相反地，將資料庫部署，涉及套用上次部署到實際執行資料庫後，開發資料庫所做的變更。</span><span class="sxs-lookup"><span data-stu-id="80ace-109">Instead, deploying a database involves applying the changes made to the development database since the last deployment onto the production database.</span></span> <span data-ttu-id="80ace-110">本教學課程會檢查這些挑戰，並提供各種不同的策略，可協助 chronicling 和套用上次部署後對資料庫進行的變更。</span><span class="sxs-lookup"><span data-stu-id="80ace-110">This tutorial examines these challenges and offers various strategies to assist with chronicling and applying the changes made to the database since the last deployment.</span></span>


## <a name="introduction"></a><span data-ttu-id="80ace-111">簡介</span><span class="sxs-lookup"><span data-stu-id="80ace-111">Introduction</span></span>

<span data-ttu-id="80ace-112">先前的教學課程所述，部署 ASP.NET 應用程式需要相關的內容複製到生產環境的開發環境。</span><span class="sxs-lookup"><span data-stu-id="80ace-112">As discussed in previous tutorials, deploying an ASP.NET application entails copying the pertinent content from the development environment to the production environment.</span></span> <span data-ttu-id="80ace-113">部署不是一次性事件，但而是會驅使每次發行新版本的軟體，或當 bug 或已找出並解決安全性考量。</span><span class="sxs-lookup"><span data-stu-id="80ace-113">Deployment is not a one-time event, but rather something that happens every time a new version of the software is released or when bugs or security concerns have been identified and addressed.</span></span> <span data-ttu-id="80ace-114">當複製的 ASP.NET 網頁時，影像、 JavaScript 檔案和其他這類檔案至生產環境，您不需要擔心如何使用這些檔案已變更上次部署後。</span><span class="sxs-lookup"><span data-stu-id="80ace-114">When copying ASP.NET pages, images, JavaScript files, and other such files to the production environment you do not need to concern yourself with how these file have been changed since the last deployment.</span></span> <span data-ttu-id="80ace-115">您可以盲目地將檔案複製到生產環境中，覆寫現有的內容。</span><span class="sxs-lookup"><span data-stu-id="80ace-115">You can blindly copy the file to production, overwriting the existing content.</span></span> <span data-ttu-id="80ace-116">不幸的是，此簡化程序並不支援將資料庫部署。</span><span class="sxs-lookup"><span data-stu-id="80ace-116">Unfortunately, this simplicity does not extend to deploying the database.</span></span>

<span data-ttu-id="80ace-117">部署第一次的資料導向應用程式時可以盲目地將資料庫複製到生產環境的開發環境中。</span><span class="sxs-lookup"><span data-stu-id="80ace-117">When deploying a data-driven application for the first time you can blindly copy the database in the development environment to the production environment.</span></span> <span data-ttu-id="80ace-118">但是，執行 blind 在後續的部署中的複本將會覆寫任何進入實際執行資料庫的資料。</span><span class="sxs-lookup"><span data-stu-id="80ace-118">But performing a blind copy in subsequent deployments will overwrite any data entered into the production database.</span></span> <span data-ttu-id="80ace-119">相反地，部署資料庫時，需要套用*變更*自從上一次部署到生產環境資料庫以來，對開發資料庫。</span><span class="sxs-lookup"><span data-stu-id="80ace-119">Instead, deploying a database involves applying the *changes* made to the development database since the last deployment onto the production database.</span></span> <span data-ttu-id="80ace-120">本教學課程會檢查這些挑戰，並提供各種不同的策略，可協助 chronicling 和套用上次部署後對資料庫進行的變更。</span><span class="sxs-lookup"><span data-stu-id="80ace-120">This tutorial examines these challenges and offers various strategies to assist with chronicling and applying the changes made to the database since the last deployment.</span></span>

## <a name="the-challenges-of-deploying-a-database"></a><span data-ttu-id="80ace-121">部署資料庫上的挑戰</span><span class="sxs-lookup"><span data-stu-id="80ace-121">The Challenges of Deploying a Database</span></span>

<span data-ttu-id="80ace-122">資料驅動的應用程式已部署第一次之前，只有一個資料庫，也就是在開發環境，這就是為什麼部署第一次的資料導向應用程式時即可盲目地資料庫複製中的資料庫開發環境到生產環境。</span><span class="sxs-lookup"><span data-stu-id="80ace-122">Before a data-driven application has been deployed for the first time, there is only one database, namely the database in the development environment, which is why when deploying a data-driven application for the first time you can blindly copy the database in the development environment to the production environment.</span></span> <span data-ttu-id="80ace-123">但一旦部署應用程式有兩個資料庫的複本： 一個在開發和生產環境中的其中一個。</span><span class="sxs-lookup"><span data-stu-id="80ace-123">But once the application has been deployed there are two copies of the database: one in development and one in production.</span></span>

<span data-ttu-id="80ace-124">部署之間的開發和生產環境資料庫可能會變得不同步。雖然生產資料庫 s 結構描述會維持不變，加入新功能時，就可能會變更開發資料庫 s 結構描述。</span><span class="sxs-lookup"><span data-stu-id="80ace-124">Between deployments the development and production databases can become out of sync. While the production database s schema remains unchanged, the development database s schema may change as new features are added.</span></span> <span data-ttu-id="80ace-125">您可能會新增或移除資料行、 資料表、 檢視或預存程序。</span><span class="sxs-lookup"><span data-stu-id="80ace-125">You might add or remove columns, tables, views, or stored procedures.</span></span> <span data-ttu-id="80ace-126">也可能新增至開發資料庫的重要資料。</span><span class="sxs-lookup"><span data-stu-id="80ace-126">There may also be important data that gets added to the development database.</span></span> <span data-ttu-id="80ace-127">許多資料導向的應用程式包含以硬式編碼的特定應用程式不是使用者可編輯的資料填入查閱資料表。</span><span class="sxs-lookup"><span data-stu-id="80ace-127">Many data-driven applications include lookup tables populated with hard-coded, application-specific data that are not user-editable.</span></span> <span data-ttu-id="80ace-128">例如，拍賣網站可能會有下拉式清單中，以說明正在 auctioned 項目的條件的選項：新的、 新的、 良好，和這類公平。</span><span class="sxs-lookup"><span data-stu-id="80ace-128">For example, an auction website might have a drop-down list with choices that describe the condition of the item being auctioned: New, Like New, Good, and Fair.</span></span> <span data-ttu-id="80ace-129">而不是硬式編碼這些選項，直接在下拉式清單中的它通常會比較好將它們放在資料庫資料表。</span><span class="sxs-lookup"><span data-stu-id="80ace-129">Rather than hard-coding these options directly in the drop-down list it is usually better to place them in a database table.</span></span> <span data-ttu-id="80ace-130">如果您在開發期間，名為不佳的新條件加入至資料表再部署應用程式時這個相同的記錄，就必須新增至實際執行資料庫中的查閱資料表。</span><span class="sxs-lookup"><span data-stu-id="80ace-130">If, during development, a new condition named Poor is added to the table then when deploying the application this same record needs to be added to the lookup table in the production database.</span></span>

<span data-ttu-id="80ace-131">在理想情況下，將資料庫部署牽涉到資料庫複製到生產環境的開發。</span><span class="sxs-lookup"><span data-stu-id="80ace-131">Ideally, deploying the database would involve copying the database from development to production.</span></span> <span data-ttu-id="80ace-132">但請記住，您已部署應用程式，並繼續開發之後，實際執行資料庫要填入來自實際使用者的實際資料。</span><span class="sxs-lookup"><span data-stu-id="80ace-132">But keep in mind that after you have deployed the application and resumed development, the production database is being populated with real data from real users.</span></span> <span data-ttu-id="80ace-133">因此，如果您要直接從開發到下一個部署在生產環境中複製資料庫會覆寫生產資料庫，而且其現有的資料遺失。</span><span class="sxs-lookup"><span data-stu-id="80ace-133">Therefore, if you were to simply copy the database from development to production at the next deployment you would overwrite the production database and lose its existing data.</span></span> <span data-ttu-id="80ace-134">最後結果就是，將資料庫部署由套用自從上次部署以來，對開發資料庫的變更。</span><span class="sxs-lookup"><span data-stu-id="80ace-134">The net result is that deploying the database boils down to applying the changes made to the development database since the last deployment.</span></span>

<span data-ttu-id="80ace-135">因為部署資料庫時，需要將結構描述，而且可能資料中的變更套用上次部署後，變更的歷程記錄必須維護 （或在部署階段決定），以便可以在實際執行上套用這些變更。</span><span class="sxs-lookup"><span data-stu-id="80ace-135">Because deploying a database involves applying the changes in the schema and, possibly, the data since the last deployment, a history of changes must be maintained (or determined at deploy-time) so that those changes can be applied on production.</span></span> <span data-ttu-id="80ace-136">有各種不同的管理，並將變更套用至資料模型的技巧。</span><span class="sxs-lookup"><span data-stu-id="80ace-136">There are a variety of techniques for managing and applying changes to the data model.</span></span>

### <a name="defining-the-baseline"></a><span data-ttu-id="80ace-137">定義比較基準</span><span class="sxs-lookup"><span data-stu-id="80ace-137">Defining the Baseline</span></span>

<span data-ttu-id="80ace-138">若要維護您的應用程式的資料庫的變更中，您需要有一些起始狀態的變更會套用至基準。</span><span class="sxs-lookup"><span data-stu-id="80ace-138">To maintain the changes to your application s database you need to have some starting state, a baseline to which the changes are applied to.</span></span> <span data-ttu-id="80ace-139">其中一種方式開始的狀態可能是空的資料庫沒有資料表、 檢視或預存程序。</span><span class="sxs-lookup"><span data-stu-id="80ace-139">At one extreme the starting state could be an empty database with no tables, views, or stored procedures.</span></span> <span data-ttu-id="80ace-140">這類基準會導致大型的變更記錄檔，因為它必須包含建立所有資料庫的資料表、 檢視和預存程序，以及在初始部署後所做的任何變更。</span><span class="sxs-lookup"><span data-stu-id="80ace-140">Such a baseline results in a large change log because it must include the creation of all of the database s tables, views, and stored procedures along with any changes made after the initial deployment.</span></span> <span data-ttu-id="80ace-141">在另一端的範圍中，您可以設定基準為一開始會部署到生產環境資料庫的版本。</span><span class="sxs-lookup"><span data-stu-id="80ace-141">At the other end of the spectrum you could set the baseline as the version of the database that is initially deployed to the production environment.</span></span> <span data-ttu-id="80ace-142">這項選擇會導致許多較小的變更記錄檔，因為它只包含下列第一次部署的資料庫所做的變更。</span><span class="sxs-lookup"><span data-stu-id="80ace-142">This choice results in a much smaller change log because it only includes the changes made to the database following the first deployment.</span></span> <span data-ttu-id="80ace-143">這是我偏好的方法。</span><span class="sxs-lookup"><span data-stu-id="80ace-143">This is the approach I prefer.</span></span> <span data-ttu-id="80ace-144">而且當然可以選擇更多的中介的道路的方法，定義基準之間建立初始資料庫和資料庫第一次部署時，某個時間點。</span><span class="sxs-lookup"><span data-stu-id="80ace-144">And of course you can choose a more middle of the road approach, defining the baseline as some point between the initial creation of the database and when the database is first deployed.</span></span>

<span data-ttu-id="80ace-145">一旦您有選擇基準會考慮產生可執行以重新建立的基準版本的 SQL 指令碼。</span><span class="sxs-lookup"><span data-stu-id="80ace-145">Once you have chosen a baseline consider generating a SQL script that can be executed to recreate the baseline version.</span></span> <span data-ttu-id="80ace-146">這類指令碼可讓您能夠快速地重新建立資料庫的基準版本。</span><span class="sxs-lookup"><span data-stu-id="80ace-146">Such a script makes it possible to quickly recreate the baseline version of the database.</span></span> <span data-ttu-id="80ace-147">這項功能特別適用於較大型的專案，其中可能有多位開發人員處理的專案或其他環境，例如測試或預備環境，其中的每個需要自己的資料庫複本。</span><span class="sxs-lookup"><span data-stu-id="80ace-147">This functionality is especially useful in larger projects, where there may be multiple developers working on the project or additional environments, such as testing or staging, that each need their own copy of the database.</span></span>

<span data-ttu-id="80ace-148">有各種不同的工具來產生基準版本的 SQL 指令碼供您使用。</span><span class="sxs-lookup"><span data-stu-id="80ace-148">There are a variety of tools at your disposal to generate a SQL script of the baseline version.</span></span> <span data-ttu-id="80ace-149">從 SQL Server Management Studio (SSMS) 您可以以滑鼠右鍵按一下資料庫，請移至 工作 子功能表，然後選擇 產生指令碼選項。</span><span class="sxs-lookup"><span data-stu-id="80ace-149">From SQL Server Management Studio (SSMS) you can right-click on the database, go to the Tasks submenu, and choose the Generate Scripts option.</span></span> <span data-ttu-id="80ace-150">這會啟動指令碼精靈，您可以指示來產生此檔案包含 SQL 命令，以建立您的資料庫的物件。</span><span class="sxs-lookup"><span data-stu-id="80ace-150">This launches the Script Wizard, which you can instruct to generate a file that contains the SQL commands to create your database s objects.</span></span> <span data-ttu-id="80ace-151">另一個選項是資料庫發行精靈，可以產生不只在資料庫資料表中建立資料庫結構描述，但是資料的 SQL 命令。</span><span class="sxs-lookup"><span data-stu-id="80ace-151">Another option is the Database Publishing Wizard, which can generate the SQL commands to not only create the database schema, but also the data in the database tables.</span></span> <span data-ttu-id="80ace-152">資料庫發行精靈的詳細檢查的年代*將資料庫部署*教學課程。</span><span class="sxs-lookup"><span data-stu-id="80ace-152">The Database Publishing Wizard was examined in detail back in the *Deploying a Database* tutorial.</span></span> <span data-ttu-id="80ace-153">不論您使用何種工具，您應該會有最終可用來重新建立資料庫的基準版本的指令碼檔案應該需要發生。</span><span class="sxs-lookup"><span data-stu-id="80ace-153">Regardless of what tool you use, in the end you should have a script file that you can use to recreate the baseline version of your database, should the need arise.</span></span>

## <a name="documenting-the-database-changes-in-prose"></a><span data-ttu-id="80ace-154">加入註解文字中的資料庫變更</span><span class="sxs-lookup"><span data-stu-id="80ace-154">Documenting the Database Changes in Prose</span></span>

<span data-ttu-id="80ace-155">在開發階段期間，維持資料模型變更的記錄檔的最簡單方式是在文字中記錄變更。</span><span class="sxs-lookup"><span data-stu-id="80ace-155">The simplest way to maintain a log of changes to the data model during the development phase is to record the changes in prose.</span></span> <span data-ttu-id="80ace-156">例如，如果已部署應用程式的開發期間將新增到新的資料行`Employees`資料表中移除的資料行`Orders`資料表，並加入新的資料表 (`ProductCategories`)，您會維護文字檔案或 Microsoft Word 文件使用下列的歷程記錄：</span><span class="sxs-lookup"><span data-stu-id="80ace-156">For example, if during development of an already-deployed application you add a new column to the `Employees` table, remove a column from the `Orders` table, and add a new table (`ProductCategories`), you would maintain a text file or Microsoft Word document with the following history:</span></span>

<a id="0.8_table01"></a>


| <span data-ttu-id="80ace-157">**變更日期**</span><span class="sxs-lookup"><span data-stu-id="80ace-157">**Change Date**</span></span> | <span data-ttu-id="80ace-158">**變更詳細資料**</span><span class="sxs-lookup"><span data-stu-id="80ace-158">**Change Details**</span></span> |
| --- | --- |
| <span data-ttu-id="80ace-159">2009-02-03:</span><span class="sxs-lookup"><span data-stu-id="80ace-159">2009-02-03:</span></span> | <span data-ttu-id="80ace-160">加入的資料行`DepartmentID`(`int`，NOT NULL) 到`Employees`資料表。</span><span class="sxs-lookup"><span data-stu-id="80ace-160">Added column `DepartmentID` (`int`, NOT NULL) to the `Employees` table.</span></span> <span data-ttu-id="80ace-161">加入從外部索引鍵條件約束`Departments.DepartmentID`至`Employees.DepartmentID`。</span><span class="sxs-lookup"><span data-stu-id="80ace-161">Added a foreign key constraint from `Departments.DepartmentID` to `Employees.DepartmentID`.</span></span> |
| <span data-ttu-id="80ace-162">2009-02-05:</span><span class="sxs-lookup"><span data-stu-id="80ace-162">2009-02-05:</span></span> | <span data-ttu-id="80ace-163">已移除的資料行`TotalWeight`從`Orders`資料表。</span><span class="sxs-lookup"><span data-stu-id="80ace-163">Removed column `TotalWeight` from the `Orders` table.</span></span> <span data-ttu-id="80ace-164">中已擷取的資料相關聯`OrderDetails`記錄。</span><span class="sxs-lookup"><span data-stu-id="80ace-164">Data already captured in associated `OrderDetails` records.</span></span> |
| <span data-ttu-id="80ace-165">2009-02-12:</span><span class="sxs-lookup"><span data-stu-id="80ace-165">2009-02-12:</span></span> | <span data-ttu-id="80ace-166">建立`ProductCategories`資料表。</span><span class="sxs-lookup"><span data-stu-id="80ace-166">Created the `ProductCategories` table.</span></span> <span data-ttu-id="80ace-167">有三個資料行： `ProductCategoryID` (`int`， `IDENTITY`， `NOT NULL`)， `CategoryName` (`nvarchar(50)`， `NOT NULL`)，並`Active`(`bit`， `NOT NULL`)。</span><span class="sxs-lookup"><span data-stu-id="80ace-167">There are three columns: `ProductCategoryID` (`int`, `IDENTITY`, `NOT NULL`), `CategoryName` (`nvarchar(50)`, `NOT NULL`), and `Active` (`bit`, `NOT NULL`).</span></span> <span data-ttu-id="80ace-168">加入至主索引鍵條件約束`ProductCategoryID`，並預設值是 1 到`Active`。</span><span class="sxs-lookup"><span data-stu-id="80ace-168">Added a primary key constraint to `ProductCategoryID`, and a default value of 1 to `Active`.</span></span> |


<span data-ttu-id="80ace-169">有一些缺點，這種方法。</span><span class="sxs-lookup"><span data-stu-id="80ace-169">There are a number of drawbacks to this approach.</span></span> <span data-ttu-id="80ace-170">首先，沒有任何希望自動化。</span><span class="sxs-lookup"><span data-stu-id="80ace-170">For starters, there is no hope for automation.</span></span> <span data-ttu-id="80ace-171">隨時這些變更需要套用至資料庫-例如，當應用程式部署-開發人員必須以手動方式實作每個變更，一次一個。</span><span class="sxs-lookup"><span data-stu-id="80ace-171">Anytime these changes need to be applied to a database - such as when the application is deployed - a developer must manually implement each change, one at a time.</span></span> <span data-ttu-id="80ace-172">此外，如果您需要重新建構特定版本的資料庫從基準線使用的變更記錄檔，這樣做會讓越來越多的時間的記錄檔大小增加時。</span><span class="sxs-lookup"><span data-stu-id="80ace-172">Moreover, if you need to reconstruct a particular version of the database from the baseline using the change log, doing so will take more and more time as the size of the log grows.</span></span> <span data-ttu-id="80ace-173">這個方法的另一個缺點是，保留的清晰度與詳細資料的每個變更記錄項目層級記錄變更的人員。</span><span class="sxs-lookup"><span data-stu-id="80ace-173">Another drawback to this method is that the clarity and level of detail of each change log entry is left to the person recording the change.</span></span> <span data-ttu-id="80ace-174">與多個開發人員小組中一些可能會比其他更詳細、 更容易閱讀，或更精確的項目。</span><span class="sxs-lookup"><span data-stu-id="80ace-174">In a team with multiple developers some may make more detailed, more readable, or more precise entries than others.</span></span> <span data-ttu-id="80ace-175">此外，有錯字和其他人與相關的資料輸入錯誤都可能。</span><span class="sxs-lookup"><span data-stu-id="80ace-175">Also, typos and other human-related data entry errors are possible.</span></span>

<span data-ttu-id="80ace-176">加入註解文字中的資料庫變更的主要優點是簡單。</span><span class="sxs-lookup"><span data-stu-id="80ace-176">The primary benefit of documenting the database changes in prose is simplicity.</span></span> <span data-ttu-id="80ace-177">您不 t 需要熟悉建立和改變資料庫物件的 SQL 語法。</span><span class="sxs-lookup"><span data-stu-id="80ace-177">You don t need familiarity with the SQL syntax for creating and altering database objects.</span></span> <span data-ttu-id="80ace-178">相反地，您可以變更記錄中的文字，並透過 SQL Server Management Studio s 圖形化使用者介面實作它們。</span><span class="sxs-lookup"><span data-stu-id="80ace-178">Instead, you can record the changes in prose and implement them through SQL Server Management Studio s graphical user interface.</span></span>

<span data-ttu-id="80ace-179">維護您的變更記錄檔中的文字是無可否認地，不會很複雜，也不會使用特定的專案，例如在範圍內，大型的經常變更的資料模型，或是牽涉到多個開發人員。</span><span class="sxs-lookup"><span data-stu-id="80ace-179">Maintaining your change log in prose is, admittedly, not very sophisticated and won't work well with certain projects, such as ones that are large in scope, have frequent changes to the data model, or involve multiple developers.</span></span> <span data-ttu-id="80ace-180">但是，我曾看過這種方法很適用於小型的工時專案具有只有偶爾變更的資料模型，其中單一的開發人員並沒有強式的背景中建立和改變資料庫物件的 SQL 語法。</span><span class="sxs-lookup"><span data-stu-id="80ace-180">But I have seen this approach work quite well in small, one-man projects that have only occasional changes to the data model and where the solo developer does not have a strong background in the SQL syntax for creating and altering database objects.</span></span>

> [!NOTE]
> <span data-ttu-id="80ace-181">雖然變更記錄檔中的資訊，技術上來說，只需要部署階段建議保留變更的歷程記錄。</span><span class="sxs-lookup"><span data-stu-id="80ace-181">While the information in the change log is, technically, only needed until deploy-time, I recommend keeping a history of changes.</span></span> <span data-ttu-id="80ace-182">但是，而不是維護單一日益增長，變更記錄檔，請考慮讓每個資料庫版本的不同的變更記錄檔。</span><span class="sxs-lookup"><span data-stu-id="80ace-182">But rather than maintaining a single, ever growing change log file, consider having a different change log file for each database version.</span></span> <span data-ttu-id="80ace-183">通常您會想要版本資料庫每個部署的時間。</span><span class="sxs-lookup"><span data-stu-id="80ace-183">Typically you will want to version the database each time it is deployed.</span></span> <span data-ttu-id="80ace-184">藉由維護的變更記錄檔記錄您可以從基準中，重新建立任何資料庫版本藉由執行從第 1 版的變更記錄檔指令碼，並繼續執行直到您到達版本需要重新建立。</span><span class="sxs-lookup"><span data-stu-id="80ace-184">By maintaining a log of change logs you can, starting from the baseline, recreate any database version by executing the change log scripts starting from version 1 and continuing until you reach the version you need to recreate.</span></span>


## <a name="recording-the-sql-change-statements"></a><span data-ttu-id="80ace-185">記錄 SQL 變更陳述式</span><span class="sxs-lookup"><span data-stu-id="80ace-185">Recording the SQL Change Statements</span></span>

<span data-ttu-id="80ace-186">維護變更記錄檔中的文字的主要缺點是缺乏自動化。</span><span class="sxs-lookup"><span data-stu-id="80ace-186">The primary drawback of maintaining the change log in prose is the lack of automation.</span></span> <span data-ttu-id="80ace-187">在理想情況下，實作在部署階段的生產環境資料庫的資料庫變更會簡單，只要按一下按鈕以執行指令碼，而不需要以手動方式執行的指示清單。</span><span class="sxs-lookup"><span data-stu-id="80ace-187">Ideally, implementing the database changes to the production database at deploy-time would be as easy as clicking a button to execute a script rather than having to manually perform a list of instructions.</span></span> <span data-ttu-id="80ace-188">這類自動化就可以藉由維護變更記錄檔，其中包含用來改變資料模型的 SQL 命令。</span><span class="sxs-lookup"><span data-stu-id="80ace-188">Such automation is possible by maintaining a change log that contains those SQL commands used to alter the data model.</span></span>

<span data-ttu-id="80ace-189">SQL 語法包含一些建立和修改各種資料庫物件的陳述式。</span><span class="sxs-lookup"><span data-stu-id="80ace-189">The SQL syntax includes a number of statements for creating and modifying various database objects.</span></span> <span data-ttu-id="80ace-190">例如， [ *CREATE TABLE 陳述式*](https://msdn.microsoft.com/library/ms174979.aspx)、 執行時，建立新的資料表，使用指定的資料行和條件約束。</span><span class="sxs-lookup"><span data-stu-id="80ace-190">For example, the [*CREATE TABLE statement*](https://msdn.microsoft.com/library/ms174979.aspx), when executed, creates a new table with the specified columns and constraints.</span></span> <span data-ttu-id="80ace-191">[ *ALTER TABLE 陳述式*](https://msdn.microsoft.com/library/ms190273.aspx)修改現有的資料表，新增、 移除或修改其資料行或條件約束。</span><span class="sxs-lookup"><span data-stu-id="80ace-191">The [*ALTER TABLE statement*](https://msdn.microsoft.com/library/ms190273.aspx) modifies an existing table, adding, removing, or modifying its columns or constraints.</span></span> <span data-ttu-id="80ace-192">另外還有陳述式來建立、 修改和卸除索引、 檢視、 使用者定義函數、 預存程序、 觸發程序和其他資料庫物件。</span><span class="sxs-lookup"><span data-stu-id="80ace-192">There are also statements to create, modify, and drop indexes, views, user-defined functions, stored procedures, triggers, and other database objects.</span></span>

<span data-ttu-id="80ace-193">回到先前的範例中，映像新增到新的資料行的已部署應用程式的開發過程`Employees`資料表中移除的資料行`Orders`資料表，並加入新的資料表 (`ProductCategories`)。</span><span class="sxs-lookup"><span data-stu-id="80ace-193">Returning to our earlier example, image that during development of an already-deployed application you add a new column to the `Employees` table, remove a column from the `Orders` table, and add a new table (`ProductCategories`).</span></span> <span data-ttu-id="80ace-194">這類動作會導致變更記錄檔，使用下列 SQL 命令：</span><span class="sxs-lookup"><span data-stu-id="80ace-194">Such actions would result in a change log file with the following SQL commands:</span></span>

[!code-sql[Main](strategies-for-database-development-and-deployment-vb/samples/sample1.sql)]

<span data-ttu-id="80ace-195">將這些變更推送到生產資料庫，在部署階段是一種單鍵操作： 開啟 SQL Server Management Studio、 連接到您的生產環境資料庫、 開啟 [新增查詢] 視窗、 貼上的變更記錄檔中，內容和按一下 [執行] 以執行指令碼。</span><span class="sxs-lookup"><span data-stu-id="80ace-195">Pushing these changes to the production database at deploy-time is a one-click operation: open SQL Server Management Studio, connect to your production database, open a New Query window, paste the contents of the change log, and click Execute to run the script.</span></span>

## <a name="using-a-comparison-tool-to-synchronize-the-data-models"></a><span data-ttu-id="80ace-196">使用的比較工具來同步處理的資料模型</span><span class="sxs-lookup"><span data-stu-id="80ace-196">Using a Comparison Tool to Synchronize the Data Models</span></span>

<span data-ttu-id="80ace-197">加入註解文字中的資料庫變更很容易，但是實作變更需要開發人員每一項變更其中一個在生產資料庫上一次;記錄變更的 SQL 命令會使快速按一下按鈕，即可輕鬆地在生產資料庫上實作這些變更，但需要學習和精通 SQL 陳述式和語法建立和改變資料庫物件。</span><span class="sxs-lookup"><span data-stu-id="80ace-197">Documenting database changes in prose is easy, but implementing the changes requires a developer to make each change on the production database one at a time; documenting the change SQL commands makes implementing those changes on the production database as easy and quick as clicking a button, but requires learning and mastering the SQL statements and syntax for creating and altering database objects.</span></span> <span data-ttu-id="80ace-198">資料庫的比較工具需要最好的這兩種方法，並捨棄最壞的情況。</span><span class="sxs-lookup"><span data-stu-id="80ace-198">Database comparison tools take the best from both approaches and discard the worst.</span></span>

<span data-ttu-id="80ace-199">資料庫比較工具比較結構描述或兩個資料庫的資料，並顯示摘要報告，顯示您的資料庫有何不同。</span><span class="sxs-lookup"><span data-stu-id="80ace-199">A database comparison tool compares the schema or data of two databases and displays a summary report showing you how the databases differ.</span></span> <span data-ttu-id="80ace-200">然後，您也可以使用按一下按鈕時，您可以產生同步處理一或多個資料庫物件的 SQL 命令。</span><span class="sxs-lookup"><span data-stu-id="80ace-200">Then, with the click of a button, you can generate the SQL commands for synchronizing one or more database objects.</span></span> <span data-ttu-id="80ace-201">簡單的說，您可以使用資料庫比較工具來比較開發和生產資料庫，在部署階段，產生此檔案包含 SQL 命令，執行時，會將變更套用至實際執行資料庫 s 結構描述因此它鏡像開發資料庫 s 結構描述。</span><span class="sxs-lookup"><span data-stu-id="80ace-201">In a nutshell, you can use a database comparison tool to compare the development and production databases at deploy-time, generating a file that contains the SQL commands that, when executed, will apply the changes to the production database s schema so that it mirrors the development database s schema.</span></span>

<span data-ttu-id="80ace-202">有各種不同的多家廠商所提供的協力廠商資料庫比較工具。</span><span class="sxs-lookup"><span data-stu-id="80ace-202">There are a variety of third-party database comparison tools offered by many different vendors.</span></span> <span data-ttu-id="80ace-203">其中一個範例是[ *SQL 比較*](http://www.red-gate.com/products/SQL_Compare/)，依[ *Red Gate Software*](http://www.red-gate.com/)。</span><span class="sxs-lookup"><span data-stu-id="80ace-203">One such example is [*SQL Compare*](http://www.red-gate.com/products/SQL_Compare/), by [*Red Gate Software*](http://www.red-gate.com/).</span></span> <span data-ttu-id="80ace-204">可讓 s 逐步解說使用 「 SQL 比較來比較和同步處理的開發和生產環境資料庫結構描述的程序。</span><span class="sxs-lookup"><span data-stu-id="80ace-204">Let s walk through the process of using SQL Compare to compare and synchronize the development and production databases schemas.</span></span>

> [!NOTE]
> <span data-ttu-id="80ace-205">在撰寫本文時最新版 SQL 比較是版本 7.1 中，Standard Edition 為 $ 395 美元的成本計算方式。</span><span class="sxs-lookup"><span data-stu-id="80ace-205">At the time of this writing the current version of SQL Compare was version 7.1, with the Standard Edition costing $395.</span></span> <span data-ttu-id="80ace-206">您可以遵循下載 14 天的免費試用。</span><span class="sxs-lookup"><span data-stu-id="80ace-206">You can follow along by downloading a free 14-day trial.</span></span>


<span data-ttu-id="80ace-207">SQL 比較啟動時比較專案 對話方塊隨即開啟，顯示已儲存的 「 SQL 比較 」 專案。</span><span class="sxs-lookup"><span data-stu-id="80ace-207">When SQL Compare starts the Comparison Projects dialog box opens, showing the saved SQL Compare projects.</span></span> <span data-ttu-id="80ace-208">建立新的專案。</span><span class="sxs-lookup"><span data-stu-id="80ace-208">Create a new project.</span></span> <span data-ttu-id="80ace-209">這會啟動 專案組態精靈，它會提示您資料庫的相關資訊的比較 （見 圖 1）。</span><span class="sxs-lookup"><span data-stu-id="80ace-209">This launches the Project Configuration wizard, which prompts for information about the databases to compare (see Figure 1).</span></span> <span data-ttu-id="80ace-210">輸入開發和生產環境資料庫的資訊。</span><span class="sxs-lookup"><span data-stu-id="80ace-210">Enter the information for the development and production environment databases.</span></span>


<span data-ttu-id="80ace-211">[![比較開發和生產資料庫](strategies-for-database-development-and-deployment-vb/_static/image2.jpg)](strategies-for-database-development-and-deployment-vb/_static/image1.jpg)</span><span class="sxs-lookup"><span data-stu-id="80ace-211">[![Compare the Development and Production Databases](strategies-for-database-development-and-deployment-vb/_static/image2.jpg)](strategies-for-database-development-and-deployment-vb/_static/image1.jpg)</span></span>

<span data-ttu-id="80ace-212">**圖 1**:比較開發和生產資料庫 ([按一下以檢視完整大小的影像](strategies-for-database-development-and-deployment-vb/_static/image3.jpg))</span><span class="sxs-lookup"><span data-stu-id="80ace-212">**Figure 1**: Compare the Development and Production Databases ([Click to view full-size image](strategies-for-database-development-and-deployment-vb/_static/image3.jpg))</span></span>


> [!NOTE]
> <span data-ttu-id="80ace-213">如果您的開發環境資料庫是 SQL Express Edition 資料庫中的檔案`App_Data`資料夾，您必須在 SQL Server Express 資料庫伺服器中註冊資料庫，才能從 [圖 1] 所示的對話方塊中選取的網站。</span><span class="sxs-lookup"><span data-stu-id="80ace-213">If your development environment database is a SQL Express Edition database file in the `App_Data` folder of your website you will need to register the database in the SQL Server Express database server in order to select it from the dialog box shown in Figure 1.</span></span> <span data-ttu-id="80ace-214">若要這麼做最簡單的方式是開啟 SQL Server Management Studio (SSMS)、 連接到 SQL Server Express 資料庫伺服器和附加資料庫。</span><span class="sxs-lookup"><span data-stu-id="80ace-214">The easiest way to accomplish this is to open SQL Server Management Studio (SSMS), connect to the SQL Server Express database server, and attach the database.</span></span> <span data-ttu-id="80ace-215">如果您沒有 SSMS 安裝在您的電腦上您可以下載並安裝免費[ *SQL Server 2008 Management Studio Basic 版*](https://www.microsoft.com/downloads/details.aspx?FamilyId=7522A683-4CB2-454E-B908-E805E9BD4E28&amp;displaylang=en)。</span><span class="sxs-lookup"><span data-stu-id="80ace-215">If you do not have SSMS installed on your computer you can download and install the free [*SQL Server 2008 Management Studio Basic version*](https://www.microsoft.com/downloads/details.aspx?FamilyId=7522A683-4CB2-454E-B908-E805E9BD4E28&amp;displaylang=en).</span></span>


<span data-ttu-id="80ace-216">選取要比較的資料庫，您也可以指定各種比較設定從 [選項] 索引標籤。您可能想要開啟的其中一個選項是 「 略過條件約束和索引名稱。 」</span><span class="sxs-lookup"><span data-stu-id="80ace-216">In addition to selecting the databases to compare, you can also specify a variety of comparison settings from the Options tab. One option you may want to turn on is the "Ignore constraint and index names."</span></span> <span data-ttu-id="80ace-217">您應該記得，在先前的教學課程中我們已新增應用程式服務來開發和生產環境資料庫的資料庫物件。</span><span class="sxs-lookup"><span data-stu-id="80ace-217">Recall that in the preceding tutorial we added the application services database objects to the development and production databases.</span></span> <span data-ttu-id="80ace-218">如果您使用`aspnet_regsql.exe`工具，以在生產資料庫上建立這些物件，則您會發現開發和生產環境資料庫之間的主索引鍵和唯一條件約束名稱不同。</span><span class="sxs-lookup"><span data-stu-id="80ace-218">If you used the `aspnet_regsql.exe` tool to create these objects on the production database then you will find that the primary key and unique constraint names differ between the development and production databases.</span></span> <span data-ttu-id="80ace-219">因此，SQL 比較會標示所有做為不同的應用程式服務資料表。</span><span class="sxs-lookup"><span data-stu-id="80ace-219">Consequently, SQL Compare will flag all of the application services tables as differing.</span></span> <span data-ttu-id="80ace-220">您可以將保留 「 略過條件約束和索引名稱 」 未核取和同步處理的條件約束名稱，或 SQL 比較要略過這些差異。</span><span class="sxs-lookup"><span data-stu-id="80ace-220">You can either leave the "Ignore constraint and index names" unchecked and synchronize the constraint names, or instruct SQL Compare to ignore these differences.</span></span>

<span data-ttu-id="80ace-221">選取的資料庫之後比較 （和檢閱的比較選項），按一下 [開始比較現在比較] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="80ace-221">After selecting the databases to compare (and reviewing the comparison options), click the Compare Now button to begin the comparison.</span></span> <span data-ttu-id="80ace-222">接下來的幾秒，透過 SQL 比較會檢查兩個資料庫的結構描述，並產生報告有何不同。</span><span class="sxs-lookup"><span data-stu-id="80ace-222">Over the next several seconds, SQL Compare examines the schemas of the two databases and generates a report of how they differ.</span></span> <span data-ttu-id="80ace-223">我已特意不會進行一些修改，以顯示 SQL 比較介面中記下這類不一致的地方是如何開發資料庫。</span><span class="sxs-lookup"><span data-stu-id="80ace-223">I ve purposefully made some modifications to the development database to show how such discrepancies are noted in the SQL Compare interface.</span></span> <span data-ttu-id="80ace-224">如 [圖 2] 所示，我加入 ve`BirthDate`資料行`Authors`移除的資料表`ISBN`資料行`Books`資料表，並加入新的資料表， `Ratings`，這要讓使用者瀏覽站台速度的檢閱的書籍。</span><span class="sxs-lookup"><span data-stu-id="80ace-224">As Figure 2 shows, I ve added a `BirthDate` column to the `Authors` table, removed the `ISBN` column from the `Books` table, and added a new table, `Ratings`, which is meant to let users visiting the site rate the reviewed books.</span></span>

> [!NOTE]
> <span data-ttu-id="80ace-225">在本教學課程中所做的資料模型變更是為了說明如何使用資料庫比較工具。</span><span class="sxs-lookup"><span data-stu-id="80ace-225">The data model changes made in this tutorial were done to illustrate using a database comparison tool.</span></span> <span data-ttu-id="80ace-226">您不會在資料庫中找到這些變更，在未來的教學課程。</span><span class="sxs-lookup"><span data-stu-id="80ace-226">You will not find these changes in the database in future tutorials.</span></span>


<span data-ttu-id="80ace-227">[![SQL 比較列出開發和生產資料庫之間的差異](strategies-for-database-development-and-deployment-vb/_static/image5.jpg)](strategies-for-database-development-and-deployment-vb/_static/image4.jpg)</span><span class="sxs-lookup"><span data-stu-id="80ace-227">[![SQL Compare Lists the Differences Between the Development and Production Databases](strategies-for-database-development-and-deployment-vb/_static/image5.jpg)](strategies-for-database-development-and-deployment-vb/_static/image4.jpg)</span></span>

<span data-ttu-id="80ace-228">**圖 2**:SQL 比較列出開發之間的差異和生產資料庫 ([按一下以檢視完整大小的影像](strategies-for-database-development-and-deployment-vb/_static/image6.jpg))</span><span class="sxs-lookup"><span data-stu-id="80ace-228">**Figure 2**: SQL Compare Lists the Differences Between the Development and Production Databases ([Click to view full-size image](strategies-for-database-development-and-deployment-vb/_static/image6.jpg))</span></span>


<span data-ttu-id="80ace-229">SQL 比較細分成群組的資料庫物件，快速顯示哪些物件存在於這兩個資料庫，但不同，物件存在於一個資料庫，但不是另一個，並且有哪些物件時完全相同。</span><span class="sxs-lookup"><span data-stu-id="80ace-229">SQL Compare breaks down the database objects into groups, quickly showing you what objects exist in both databases but are different, which objects exist in one database but not the other, and which objects are identical.</span></span> <span data-ttu-id="80ace-230">如您所見，有兩個資料庫中存在但為不同的兩個物件：`Authors`資料表，它有新增的資料行，而`Books`有一個移除的資料表。</span><span class="sxs-lookup"><span data-stu-id="80ace-230">As you can see, there are two objects that exist in both databases but are different: the `Authors` table, which had a column added, and the `Books` table, which had one removed.</span></span> <span data-ttu-id="80ace-231">只存在於開發資料庫，也就是新建立的一個物件`Ratings`資料表。</span><span class="sxs-lookup"><span data-stu-id="80ace-231">There is one object that exists only in the development database, namely the newly created `Ratings` table.</span></span> <span data-ttu-id="80ace-232">而且有兩個資料庫中相同的 117 物件。</span><span class="sxs-lookup"><span data-stu-id="80ace-232">And there are 117 objects that are identical in both databases.</span></span>

<span data-ttu-id="80ace-233">選取的資料庫物件時，會顯示差異 視窗中，因為它會顯示這些物件有何不同。</span><span class="sxs-lookup"><span data-stu-id="80ace-233">Selecting a database object displays the SQL Differences window, which shows how these objects differ.</span></span> <span data-ttu-id="80ace-234">SQL 差異視窗中，顯示在底部 [圖 2] 中反白顯示，`Authors`開發資料庫中的資料表有`BirthDate`資料行中找不到`Authors`生產資料庫上的資料表。</span><span class="sxs-lookup"><span data-stu-id="80ace-234">The SQL Differences window, displayed at the bottom in Figure 2, highlights that the `Authors` table in the development database has the `BirthDate` column, which is not found in the `Authors` table on the production database.</span></span>

<span data-ttu-id="80ace-235">檢閱差異，並選取您想要同步處理哪些的物件之後, 的下一個步驟是產生的 SQL 命令來更新實際執行資料庫 s 結構描述所需符合開發資料庫。</span><span class="sxs-lookup"><span data-stu-id="80ace-235">After reviewing the differences and selecting which objects you want to synchronize, the next step is to generate the SQL commands needed to update the production database s schema to match the development database.</span></span> <span data-ttu-id="80ace-236">這是透過同步處理精靈 」 來完成。</span><span class="sxs-lookup"><span data-stu-id="80ace-236">This is accomplished through the Synchronization Wizard.</span></span> <span data-ttu-id="80ace-237">同步處理精靈 」 確認哪些物件同步處理，並摘要說明動作計劃 （請參閱 [圖 3]）。</span><span class="sxs-lookup"><span data-stu-id="80ace-237">The Synchronization Wizard confirms what objects to synchronize and summarizes the action plan (see Figure 3).</span></span> <span data-ttu-id="80ace-238">您可以立即同步處理資料庫，或產生含有可以暇地執行的 SQL 命令的指令碼。</span><span class="sxs-lookup"><span data-stu-id="80ace-238">You can synchronize the databases immediately or generate a script with the SQL commands that can be run at your leisure.</span></span>


<span data-ttu-id="80ace-239">[![使用同步處理精靈 」 來同步處理您的資料庫結構描述](strategies-for-database-development-and-deployment-vb/_static/image8.jpg)](strategies-for-database-development-and-deployment-vb/_static/image7.jpg)</span><span class="sxs-lookup"><span data-stu-id="80ace-239">[![Use the Synchronization Wizard to Synchronize Your Databases Schemas](strategies-for-database-development-and-deployment-vb/_static/image8.jpg)](strategies-for-database-development-and-deployment-vb/_static/image7.jpg)</span></span>

<span data-ttu-id="80ace-240">**[圖 3**:使用同步處理精靈] 來同步處理您的資料庫結構描述 ([按一下以檢視完整大小的影像](strategies-for-database-development-and-deployment-vb/_static/image9.jpg))</span><span class="sxs-lookup"><span data-stu-id="80ace-240">**Figure 3**: Use the Synchronization Wizard to Synchronize Your Databases Schemas ([Click to view full-size image](strategies-for-database-development-and-deployment-vb/_static/image9.jpg))</span></span>


<span data-ttu-id="80ace-241">資料庫的比較工具，例如 Red Gate Software 的 SQL 比較，請將變更套用至開發資料庫結構描述一樣簡單，只要動動滑鼠按一下的生產環境資料庫。</span><span class="sxs-lookup"><span data-stu-id="80ace-241">Database comparison tools like Red Gate Software s SQL Compare make applying the changes to the development database schema to the production database as easy as point and click.</span></span>

> [!NOTE]
> <span data-ttu-id="80ace-242">SQL 比較比較並同步處理兩個資料庫*結構描述*。</span><span class="sxs-lookup"><span data-stu-id="80ace-242">SQL Compare compares and synchronizes two databases *schemas*.</span></span> <span data-ttu-id="80ace-243">不幸的是，它不會比較並同步處理兩個資料庫資料表中的資料。</span><span class="sxs-lookup"><span data-stu-id="80ace-243">Unfortunately, it does not compare and synchronize the data within two databases tables.</span></span> <span data-ttu-id="80ace-244">Red Gate Software 提供的產品，名為[ *SQL Data Compare* ](http://www.red-gate.com/products/SQL_Data_Compare/) ，比較並同步處理兩個資料庫之間的資料，但它是個別的產品，從 SQL 比較，另一個為 $ 395 美元的成本。</span><span class="sxs-lookup"><span data-stu-id="80ace-244">Red Gate Software does offer a product named [*SQL Data Compare*](http://www.red-gate.com/products/SQL_Data_Compare/) that compares and synchronizes the data between two databases, but it is a separate product from SQL Compare and costs another $395.</span></span>


## <a name="taking-the-application-offline-during-deployment"></a><span data-ttu-id="80ace-245">讓應用程式離線部署期間</span><span class="sxs-lookup"><span data-stu-id="80ace-245">Taking the Application Offline During Deployment</span></span>

<span data-ttu-id="80ace-246">因為我們已看到在這些教學課程中，整個部署是包含多個步驟的程序： 從開發環境的 ASP.NET 網頁、 主版頁面、 CSS 檔案、 JavaScript 檔案、 影像和其他必要的內容複製到實際執行環境;複製實際執行環境特定組態資訊，如有需要和上次部署後，將變更套用至資料模型。</span><span class="sxs-lookup"><span data-stu-id="80ace-246">As we ve seen throughout these tutorials, deployment is a process that involves multiple steps: copying the ASP.NET pages, master pages, CSS files, JavaScript files, images, and other necessary content from the development environment to the production environment; copying up the production environment-specific configuration information, if needed; and applying the changes to the data model since the last deployment.</span></span> <span data-ttu-id="80ace-247">根據檔案的數目和您的資料庫變更的複雜性，這些步驟可以花費幾秒鐘到幾分鐘的時間完成。</span><span class="sxs-lookup"><span data-stu-id="80ace-247">Depending on the number of files and the complexity of your database changes, these steps can take anywhere from a few seconds to several minutes to complete.</span></span> <span data-ttu-id="80ace-248">在此時段期間的 web 應用程式是在 flux 中，瀏覽網站的使用者可能會遇到錯誤或非預期的行為。</span><span class="sxs-lookup"><span data-stu-id="80ace-248">During this window the web application is in flux and users visiting the site may experience errors or unexpected behavior.</span></span>

<span data-ttu-id="80ace-249">部署網站時最好是 「 離線 」 需要 web 應用程式，直到部署完成為止。</span><span class="sxs-lookup"><span data-stu-id="80ace-249">When deploying a website it is best to take the web application "offline" until deployment has completed.</span></span> <span data-ttu-id="80ace-250">離線應用程式 （並使其備份，一旦完成部署程序） 是簡單，只要上傳檔案，然後再將其刪除。</span><span class="sxs-lookup"><span data-stu-id="80ace-250">Taking the application offline (and bringing it back up once the deployment process has finished) is as easy as uploading a file and then deleting it.</span></span> <span data-ttu-id="80ace-251">開始使用 ASP.NET 2.0 中，名為的檔案存在`app_offline.htm`中之應用程式根目錄會整個網站 「 離線 」。</span><span class="sxs-lookup"><span data-stu-id="80ace-251">Starting with ASP.NET 2.0, the mere presence of a file named `app_offline.htm` in the application s root directory takes the entire website "offline."</span></span> <span data-ttu-id="80ace-252">任何在該網站上的 ASP.NET 頁面的要求自動回應的內容`app_offline.htm`檔案。</span><span class="sxs-lookup"><span data-stu-id="80ace-252">Any request to an ASP.NET page on that site is automatically responded with the contents of the `app_offline.htm` file.</span></span> <span data-ttu-id="80ace-253">一旦移除該檔案之後，應用程式恢復上線。</span><span class="sxs-lookup"><span data-stu-id="80ace-253">Once that file is removed, the application comes back online.</span></span>

<span data-ttu-id="80ace-254">取得應用程式離線，然後部署，很簡單，只要上傳`app_offline.htm`檔案到生產環境 s 根目錄之前開始部署程序，並再將其刪除 （或重新命名為其他項目） 一次部署已完成。</span><span class="sxs-lookup"><span data-stu-id="80ace-254">Taking an application offline during deployment, then, is as simple as uploading an `app_offline.htm` file to the production environment s root directory prior to beginning the deployment process and then deleting it (or renaming it to something else) once deployment is complete.</span></span> <span data-ttu-id="80ace-255">如需這項技術的詳細資訊請參閱 John Peterson 的文章中，採取[*離線 ASP.NET 應用程式*](http://www.15seconds.com/issue/061207.htm)。</span><span class="sxs-lookup"><span data-stu-id="80ace-255">For more information on this technique refer to John Peterson s article, Taking an [*ASP.NET Application Offline*](http://www.15seconds.com/issue/061207.htm).</span></span>

## <a name="summary"></a><span data-ttu-id="80ace-256">總結</span><span class="sxs-lookup"><span data-stu-id="80ace-256">Summary</span></span>

<span data-ttu-id="80ace-257">主要的挑戰，資料驅動的應用程式部署都著重於部署資料庫。</span><span class="sxs-lookup"><span data-stu-id="80ace-257">The main challenge in deploying a data-driven application centers around deploying the database.</span></span> <span data-ttu-id="80ace-258">因為有兩個版本的資料庫-一個開發環境中，一個在生產環境中這些兩個資料庫結構描述可能會不同步，因為在開發過程中會加入新的功能。</span><span class="sxs-lookup"><span data-stu-id="80ace-258">Because there are two versions of the database - one in the development environment and one in the production environment - these two databases schemas can become out of sync as new features are added in development.</span></span> <span data-ttu-id="80ace-259">更多，因為做為填入實際資料來自實際使用者實際執行資料庫，您無法覆寫的生產環境資料庫修改的開發資料庫與部署應用程式 （ASP.NET 網頁，構成檔案時，就如同哪些 s映像檔...等等）。</span><span class="sxs-lookup"><span data-stu-id="80ace-259">What s more, because the production database as being populated with real data from real users, you cannot overwrite the production database with the modified development database like you can when deploying the files that make up the application (the ASP.NET pages, image files, and so forth).</span></span> <span data-ttu-id="80ace-260">相反地，將資料庫部署，需要實作的實際執行資料庫開發資料庫上次部署後變更一組精確。</span><span class="sxs-lookup"><span data-stu-id="80ace-260">Instead, deploying a database entails implementing the precise set of changes made to the development database on the production database since the last deployment.</span></span>

<span data-ttu-id="80ace-261">本教學課程探討了三項技術來維護及套用資料庫變更的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="80ace-261">This tutorial looked at three techniques for maintaining and applying a log of database changes.</span></span> <span data-ttu-id="80ace-262">簡單的方法是在文字中記錄變更。</span><span class="sxs-lookup"><span data-stu-id="80ace-262">The simplest approach is to record the changes in prose.</span></span> <span data-ttu-id="80ace-263">雖然這種做法在生產資料庫是手動程序上實作這些變更，它不需要知道 SQL 命令來建立和改變資料庫物件。</span><span class="sxs-lookup"><span data-stu-id="80ace-263">While this tactic makes implementing these changes on the production database a manual process, it does not require knowledge of the SQL commands for creating and altering database objects.</span></span> <span data-ttu-id="80ace-264">更複雜的方法，和另一個則是更為可行較大的專案或專案中與多位開發人員，是將變更記錄為一系列的 SQL 命令。</span><span class="sxs-lookup"><span data-stu-id="80ace-264">A more sophisticated approach, and one that is much more palatable in larger projects or projects with multiple developers, is to record the changes as a series of SQL commands.</span></span> <span data-ttu-id="80ace-265">這可大幅則推出這些變更到目標資料庫。</span><span class="sxs-lookup"><span data-stu-id="80ace-265">This greatly hastens rolling out these changes to the target database.</span></span> <span data-ttu-id="80ace-266">這兩種方法的最佳可藉由使用資料庫比較工具，例如 Red Gate Software 的 SQL 比較。</span><span class="sxs-lookup"><span data-stu-id="80ace-266">The best of both approaches can be achieved by using a database comparison tool, such as Red Gate Software s SQL Compare.</span></span>

<span data-ttu-id="80ace-267">本教學課程結束時，我們著重於部署的資料導向應用程式。</span><span class="sxs-lookup"><span data-stu-id="80ace-267">This tutorial concludes our focus on deploying a data-driven application.</span></span> <span data-ttu-id="80ace-268">下一組教學課程探討如何在生產環境中的錯誤回應。</span><span class="sxs-lookup"><span data-stu-id="80ace-268">The next set of tutorials looks at how to respond to errors in the production environment.</span></span> <span data-ttu-id="80ace-269">我們將探討如何顯示易懂的錯誤頁面，而是而不是黃色的人員死亡畫面。</span><span class="sxs-lookup"><span data-stu-id="80ace-269">We'll look at how to display a friendly error page rather instead of the Yellow Screen of Death.</span></span> <span data-ttu-id="80ace-270">看如何將記錄錯誤 s 詳細資料以及如何發生這類錯誤時發出警示。</span><span class="sxs-lookup"><span data-stu-id="80ace-270">And we'll see how to log the error s details and how to alert you when such errors occur.</span></span>

<span data-ttu-id="80ace-271">快樂地寫程式 ！</span><span class="sxs-lookup"><span data-stu-id="80ace-271">Happy Programming!</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="80ace-272">[上一頁](configuring-a-website-that-uses-application-services-vb.md)
> [下一頁](displaying-a-custom-error-page-vb.md)</span><span class="sxs-lookup"><span data-stu-id="80ace-272">[Previous](configuring-a-website-that-uses-application-services-vb.md)
[Next](displaying-a-custom-error-page-vb.md)</span></span>
