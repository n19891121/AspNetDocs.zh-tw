---
uid: web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-3
title: 開始使用 Entity Framework 4.0 Database 中第一次與 ASP.NET 4 Web Form-第 3 部分 |Microsoft Docs
author: tdykstra
description: Contoso 大學範例 web 應用程式會示範如何建立使用 Entity Framework 的 ASP.NET Web Forms 應用程式。 範例應用程式是...
ms.author: riande
ms.date: 12/03/2010
ms.assetid: ccdc3f8c-2568-40a7-8f8b-3c23d2e05388
msc.legacyurl: /web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-3
msc.type: authoredcontent
ms.openlocfilehash: 8f3eced3c482291203383c53aa97b97101839cce
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/17/2019
ms.locfileid: "59392816"
---
# <a name="getting-started-with-entity-framework-40-database-first-and-aspnet-4-web-forms---part-3"></a><span data-ttu-id="12d4b-104">開始使用 Entity Framework 4.0 Database 中第一次和 ASP.NET 4 Web Form-第 3 部分</span><span class="sxs-lookup"><span data-stu-id="12d4b-104">Getting Started with Entity Framework 4.0 Database First and ASP.NET 4 Web Forms - Part 3</span></span>

<span data-ttu-id="12d4b-105">藉由[Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="12d4b-105">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

> <span data-ttu-id="12d4b-106">Contoso 大學範例 web 應用程式會示範如何建立使用 Entity Framework 4.0 和 Visual Studio 2010 的 ASP.NET Web Forms 應用程式。</span><span class="sxs-lookup"><span data-stu-id="12d4b-106">The Contoso University sample web application demonstrates how to create ASP.NET Web Forms applications using the Entity Framework 4.0 and Visual Studio 2010.</span></span> <span data-ttu-id="12d4b-107">教學課程系列的相關資訊，請參閱[系列的第一個教學課程](the-entity-framework-and-aspnet-getting-started-part-1.md)</span><span class="sxs-lookup"><span data-stu-id="12d4b-107">For information about the tutorial series, see [the first tutorial in the series](the-entity-framework-and-aspnet-getting-started-part-1.md)</span></span>


## <a name="filtering-ordering-and-grouping-data"></a><span data-ttu-id="12d4b-108">篩選、 排序和分組資料</span><span class="sxs-lookup"><span data-stu-id="12d4b-108">Filtering, Ordering, and Grouping Data</span></span>

<span data-ttu-id="12d4b-109">在您使用先前的教學課程中`EntityDataSource`控制項來顯示和編輯資料。</span><span class="sxs-lookup"><span data-stu-id="12d4b-109">In the previous tutorial you used the `EntityDataSource` control to display and edit data.</span></span> <span data-ttu-id="12d4b-110">在本教學課程中，您將篩選、 排序和分組資料。</span><span class="sxs-lookup"><span data-stu-id="12d4b-110">In this tutorial you'll filter, order, and group data.</span></span> <span data-ttu-id="12d4b-111">當您執行此動作所設定的屬性，`EntityDataSource`控制項，語法是不同於其他資料來源控制項。</span><span class="sxs-lookup"><span data-stu-id="12d4b-111">When you do this by setting properties of the `EntityDataSource` control, the syntax is different from other data source controls.</span></span> <span data-ttu-id="12d4b-112">如您所見，不過，您可以使用`QueryExtender`控制這些差異降到最低。</span><span class="sxs-lookup"><span data-stu-id="12d4b-112">As you'll see, however, you can use the `QueryExtender` control to minimize these differences.</span></span>

<span data-ttu-id="12d4b-113">您將會變更*Students.aspx*頁面，即可篩選適用於學生，依名稱，並搜尋名稱排序。</span><span class="sxs-lookup"><span data-stu-id="12d4b-113">You'll change the *Students.aspx* page to filter for students, sort by name, and search on name.</span></span> <span data-ttu-id="12d4b-114">您也會變更*Courses.aspx*頁面，即可依名稱顯示所選的科系與課程搜尋的課程。</span><span class="sxs-lookup"><span data-stu-id="12d4b-114">You'll also change the *Courses.aspx* page to display courses for the selected department and search for courses by name.</span></span> <span data-ttu-id="12d4b-115">最後，您將新增至學生統計資料*about.aspx 的網頁*頁面。</span><span class="sxs-lookup"><span data-stu-id="12d4b-115">Finally, you'll add student statistics to the *About.aspx* page.</span></span>

<span data-ttu-id="12d4b-116">[![Image02](the-entity-framework-and-aspnet-getting-started-part-3/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="12d4b-116">[![Image02](the-entity-framework-and-aspnet-getting-started-part-3/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image1.png)</span></span>

<span data-ttu-id="12d4b-117">[![Image11](the-entity-framework-and-aspnet-getting-started-part-3/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="12d4b-117">[![Image11](the-entity-framework-and-aspnet-getting-started-part-3/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image3.png)</span></span>

<span data-ttu-id="12d4b-118">[![Image10](the-entity-framework-and-aspnet-getting-started-part-3/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="12d4b-118">[![Image10](the-entity-framework-and-aspnet-getting-started-part-3/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image5.png)</span></span>

<span data-ttu-id="12d4b-119">[![Image14](the-entity-framework-and-aspnet-getting-started-part-3/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="12d4b-119">[![Image14](the-entity-framework-and-aspnet-getting-started-part-3/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image7.png)</span></span>

## <a name="using-the-entitydatasource-where-property-to-filter-data"></a><span data-ttu-id="12d4b-120">使用 EntityDataSource"Where"屬性來篩選資料</span><span class="sxs-lookup"><span data-stu-id="12d4b-120">Using the EntityDataSource "Where" Property to Filter Data</span></span>

<span data-ttu-id="12d4b-121">開啟*Students.aspx*您在上一個教學課程中建立的頁面。</span><span class="sxs-lookup"><span data-stu-id="12d4b-121">Open the *Students.aspx* page that you created in the previous tutorial.</span></span> <span data-ttu-id="12d4b-122">以目前設定，`GridView`頁面中的控制項顯示的所有名稱`People`實體集。</span><span class="sxs-lookup"><span data-stu-id="12d4b-122">As currently configured, the `GridView` control in the page displays all the names from the `People` entity set.</span></span> <span data-ttu-id="12d4b-123">不過，您想要顯示只有學生才，您可以找到選取`Person`具有非 null 的註冊日期的實體。</span><span class="sxs-lookup"><span data-stu-id="12d4b-123">However, you want to show only students, which you can find by selecting `Person` entities that have non-null enrollment dates.</span></span>

<span data-ttu-id="12d4b-124">若要切換**設計**檢視，並選取`EntityDataSource`控制項。</span><span class="sxs-lookup"><span data-stu-id="12d4b-124">Switch to **Design** view and select the `EntityDataSource` control.</span></span> <span data-ttu-id="12d4b-125">在 [屬性]  視窗中，將 `Where` 屬性設定為 `it.EnrollmentDate is not null`。</span><span class="sxs-lookup"><span data-stu-id="12d4b-125">In the **Properties** window, set the `Where` property to `it.EnrollmentDate is not null`.</span></span>

<span data-ttu-id="12d4b-126">[![Image01](the-entity-framework-and-aspnet-getting-started-part-3/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="12d4b-126">[![Image01](the-entity-framework-and-aspnet-getting-started-part-3/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image9.png)</span></span>

<span data-ttu-id="12d4b-127">您在中使用的語法`Where`屬性`EntityDataSource`控制項是 Entity SQL。</span><span class="sxs-lookup"><span data-stu-id="12d4b-127">The syntax you use in the `Where` property of the `EntityDataSource` control is Entity SQL.</span></span> <span data-ttu-id="12d4b-128">Entity SQL 是類似於 TRANSACT-SQL，但會在自訂實體，而不是資料庫物件的使用。</span><span class="sxs-lookup"><span data-stu-id="12d4b-128">Entity SQL is similar to Transact-SQL, but it's customized for use with entities rather than database objects.</span></span> <span data-ttu-id="12d4b-129">在運算式中`it.EnrollmentDate is not null`，這個字`it`表示查詢所傳回之實體的參考。</span><span class="sxs-lookup"><span data-stu-id="12d4b-129">In the expression `it.EnrollmentDate is not null`, the word `it` represents a reference to the entity returned by the query.</span></span> <span data-ttu-id="12d4b-130">因此，`it.EnrollmentDate`是指`EnrollmentDate`屬性`Person`實體，`EntityDataSource`控制傳回。</span><span class="sxs-lookup"><span data-stu-id="12d4b-130">Therefore, `it.EnrollmentDate` refers to the `EnrollmentDate` property of the `Person` entity that the `EntityDataSource` control returns.</span></span>

<span data-ttu-id="12d4b-131">執行網頁。</span><span class="sxs-lookup"><span data-stu-id="12d4b-131">Run the page.</span></span> <span data-ttu-id="12d4b-132">學生清單現在包含只學生。</span><span class="sxs-lookup"><span data-stu-id="12d4b-132">The students list now contains only students.</span></span> <span data-ttu-id="12d4b-133">(其中顯示沒有資料列沒有註冊日期。)</span><span class="sxs-lookup"><span data-stu-id="12d4b-133">(There are no rows displayed where there's no enrollment date.)</span></span>

<span data-ttu-id="12d4b-134">[![Image02](the-entity-framework-and-aspnet-getting-started-part-3/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="12d4b-134">[![Image02](the-entity-framework-and-aspnet-getting-started-part-3/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image11.png)</span></span>

## <a name="using-the-entitydatasource-orderby-property-to-order-data"></a><span data-ttu-id="12d4b-135">使用順序資料 EntityDataSource"OrderBy 」 屬性</span><span class="sxs-lookup"><span data-stu-id="12d4b-135">Using the EntityDataSource "OrderBy" Property to Order Data</span></span>

<span data-ttu-id="12d4b-136">您也想要第一次顯示時，會以姓名順序排列此清單。</span><span class="sxs-lookup"><span data-stu-id="12d4b-136">You also want this list to be in name order when it's first displayed.</span></span> <span data-ttu-id="12d4b-137">與*Students.aspx*仍在中開啟頁面**設計** 檢視中，且`EntityDataSource`仍已選取控制項，在**屬性** 視窗中設定**OrderBy**屬性設`it.LastName`。</span><span class="sxs-lookup"><span data-stu-id="12d4b-137">With the *Students.aspx* page still open in **Design** view, and with the `EntityDataSource` control still selected, in the **Properties** window set the **OrderBy** property to `it.LastName`.</span></span>

<span data-ttu-id="12d4b-138">[![Image05](the-entity-framework-and-aspnet-getting-started-part-3/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="12d4b-138">[![Image05](the-entity-framework-and-aspnet-getting-started-part-3/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image13.png)</span></span>

<span data-ttu-id="12d4b-139">執行網頁。</span><span class="sxs-lookup"><span data-stu-id="12d4b-139">Run the page.</span></span> <span data-ttu-id="12d4b-140">學生清單現在是依據姓氏的順序。</span><span class="sxs-lookup"><span data-stu-id="12d4b-140">The students list is now in order by last name.</span></span>

<span data-ttu-id="12d4b-141">[![Image04](the-entity-framework-and-aspnet-getting-started-part-3/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="12d4b-141">[![Image04](the-entity-framework-and-aspnet-getting-started-part-3/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image15.png)</span></span>

## <a name="using-a-control-parameter-to-set-the-where-property"></a><span data-ttu-id="12d4b-142">若要設定的"Where"屬性中使用控制項參數</span><span class="sxs-lookup"><span data-stu-id="12d4b-142">Using a Control Parameter to Set the "Where" Property</span></span>

<span data-ttu-id="12d4b-143">因為與其他資料來源控制項，您可以傳遞參數值來`Where`屬性。</span><span class="sxs-lookup"><span data-stu-id="12d4b-143">As with other data source controls, you can pass parameter values to the `Where` property.</span></span> <span data-ttu-id="12d4b-144">在  *Courses.aspx*頁面上，您在本教學課程第 2 部分中建立，您可以使用這個方法，以顯示相關聯的使用者從下拉式清單中選取部門的課程。</span><span class="sxs-lookup"><span data-stu-id="12d4b-144">On the *Courses.aspx* page that you created in part 2 of the tutorial, you can use this method to display courses that are associated with the department that a user selects from the drop-down list.</span></span>

<span data-ttu-id="12d4b-145">開啟*Courses.aspx* ，並切換至**設計**檢視。</span><span class="sxs-lookup"><span data-stu-id="12d4b-145">Open *Courses.aspx* and switch to **Design** view.</span></span> <span data-ttu-id="12d4b-146">新增第二`EntityDataSource`控制項加入頁面，並將它命名`CoursesEntityDataSource`。</span><span class="sxs-lookup"><span data-stu-id="12d4b-146">Add a second `EntityDataSource` control to the page, and name it `CoursesEntityDataSource`.</span></span> <span data-ttu-id="12d4b-147">將其連接到`SchoolEntities`模型，然後選取`Courses`作為**EntitySetName**值。</span><span class="sxs-lookup"><span data-stu-id="12d4b-147">Connect it to the `SchoolEntities` model, and select `Courses` as the **EntitySetName** value.</span></span>

<span data-ttu-id="12d4b-148">在 [**屬性**] 視窗中，按一下中的省略符號**其中**屬性方塊中。</span><span class="sxs-lookup"><span data-stu-id="12d4b-148">In the **Properties** window, click the ellipsis in the **Where** property box.</span></span> <span data-ttu-id="12d4b-149">(請確定`CoursesEntityDataSource`仍會使用之前為已選取控制項**屬性**視窗。)</span><span class="sxs-lookup"><span data-stu-id="12d4b-149">(Make sure the `CoursesEntityDataSource` control is still selected before using the **Properties** window.)</span></span>

<span data-ttu-id="12d4b-150">[![Image06](the-entity-framework-and-aspnet-getting-started-part-3/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="12d4b-150">[![Image06](the-entity-framework-and-aspnet-getting-started-part-3/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image17.png)</span></span>

<span data-ttu-id="12d4b-151">**運算式編輯器**對話方塊隨即出現。</span><span class="sxs-lookup"><span data-stu-id="12d4b-151">The **Expression Editor** dialog box is displayed.</span></span> <span data-ttu-id="12d4b-152">在此對話方塊中，選取**自動產生 Where 運算式會根據提供的參數**，然後按一下**加入參數**。</span><span class="sxs-lookup"><span data-stu-id="12d4b-152">In this dialog box, select **Automatically generate the Where expression based on the provided parameters**, and then click **Add Parameter**.</span></span> <span data-ttu-id="12d4b-153">將參數命名`DepartmentID`，選取**控制**作為**參數來源**值，然後選取**DepartmentsDropDownList**為**ControlID**值。</span><span class="sxs-lookup"><span data-stu-id="12d4b-153">Name the parameter `DepartmentID`, select **Control** as the **Parameter source** value, and select **DepartmentsDropDownList** as the **ControlID** value.</span></span>

<span data-ttu-id="12d4b-154">[![Image07](the-entity-framework-and-aspnet-getting-started-part-3/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="12d4b-154">[![Image07](the-entity-framework-and-aspnet-getting-started-part-3/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image19.png)</span></span>

<span data-ttu-id="12d4b-155">按一下 [**顯示進階屬性**，然後在**屬性**視窗**運算式編輯器**] 對話方塊中，變更`Type`屬性設`Int32`。</span><span class="sxs-lookup"><span data-stu-id="12d4b-155">Click **Show advanced properties**, and in the **Properties** window of the **Expression Editor** dialog box, change the `Type` property to `Int32`.</span></span>

<span data-ttu-id="12d4b-156">[![Image15](the-entity-framework-and-aspnet-getting-started-part-3/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="12d4b-156">[![Image15](the-entity-framework-and-aspnet-getting-started-part-3/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image21.png)</span></span>

<span data-ttu-id="12d4b-157">當您完成時，按一下**確定**。</span><span class="sxs-lookup"><span data-stu-id="12d4b-157">When you're done, click **OK**.</span></span>

<span data-ttu-id="12d4b-158">下拉式清單底下，新增`GridView`至頁面控制項並命名它`CoursesGridView`。</span><span class="sxs-lookup"><span data-stu-id="12d4b-158">Below the drop-down list, add a `GridView` control to the page and name it `CoursesGridView`.</span></span> <span data-ttu-id="12d4b-159">將其連接到`CoursesEntityDataSource`資料來源控制項，按一下**重新整理結構描述**，按一下 **編輯資料行**，並移除`DepartmentID`資料行。</span><span class="sxs-lookup"><span data-stu-id="12d4b-159">Connect it to the `CoursesEntityDataSource` data source control, click **Refresh Schema**, click **Edit Columns**, and remove the `DepartmentID` column.</span></span> <span data-ttu-id="12d4b-160">`GridView`控制項標記類似下列的範例。</span><span class="sxs-lookup"><span data-stu-id="12d4b-160">The `GridView` control markup resembles the following example.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample1.aspx)]

<span data-ttu-id="12d4b-161">當使用者變更下拉式清單中的所選取的部門時，您會想自動變更的相關課程的清單。</span><span class="sxs-lookup"><span data-stu-id="12d4b-161">When the user changes the selected department in the drop-down list, you want the list of associated courses to change automatically.</span></span> <span data-ttu-id="12d4b-162">若要將此動作，請選取下拉式清單中，然後在**屬性** 視窗中設定`AutoPostBack`屬性設`True`。</span><span class="sxs-lookup"><span data-stu-id="12d4b-162">To make this happen, select the drop-down list, and in the **Properties** window set the `AutoPostBack` property to `True`.</span></span>

<span data-ttu-id="12d4b-163">[![Image08](the-entity-framework-and-aspnet-getting-started-part-3/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="12d4b-163">[![Image08](the-entity-framework-and-aspnet-getting-started-part-3/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image23.png)</span></span>

<span data-ttu-id="12d4b-164">既然您完成使用設計工具時，切換至**來源**檢視，並取代`ConnectionString`並`DefaultContainer`的屬性名稱`CoursesEntityDataSource`用來控制`ContextTypeName="ContosoUniversity.DAL.SchoolEntities"`屬性。</span><span class="sxs-lookup"><span data-stu-id="12d4b-164">Now that you're finished using the designer, switch to **Source** view and replace the `ConnectionString` and `DefaultContainer` name properties of the `CoursesEntityDataSource` control with the `ContextTypeName="ContosoUniversity.DAL.SchoolEntities"` attribute.</span></span> <span data-ttu-id="12d4b-165">當您完成時，控制項的標記看起來如下列範例所示。</span><span class="sxs-lookup"><span data-stu-id="12d4b-165">When you're done, the markup for the control will look like the following example.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample2.aspx)]

<span data-ttu-id="12d4b-166">執行網頁，並使用下拉式清單選取不同的部門。</span><span class="sxs-lookup"><span data-stu-id="12d4b-166">Run the page and use the drop-down list to select different departments.</span></span> <span data-ttu-id="12d4b-167">所選科系所提供的課程會顯示在`GridView`控制項。</span><span class="sxs-lookup"><span data-stu-id="12d4b-167">Only courses that are offered by the selected department are displayed in the `GridView` control.</span></span>

<span data-ttu-id="12d4b-168">[![Image09](the-entity-framework-and-aspnet-getting-started-part-3/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="12d4b-168">[![Image09](the-entity-framework-and-aspnet-getting-started-part-3/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image25.png)</span></span>

## <a name="using-the-entitydatasource-groupby-property-to-group-data"></a><span data-ttu-id="12d4b-169">使用 [EntityDataSource]"GroupBy"屬性，來分組資料</span><span class="sxs-lookup"><span data-stu-id="12d4b-169">Using the EntityDataSource "GroupBy" Property to Group Data</span></span>

<span data-ttu-id="12d4b-170">假設 Contoso 大學想要將一些學生主體統計資料放在其 [關於] 頁面上。</span><span class="sxs-lookup"><span data-stu-id="12d4b-170">Suppose Contoso University wants to put some student-body statistics on its About page.</span></span> <span data-ttu-id="12d4b-171">具體來說，它想要顯示學生人數的細目，他們必須已註冊的日期。</span><span class="sxs-lookup"><span data-stu-id="12d4b-171">Specifically, it wants to show a breakdown of numbers of students by the date they enrolled.</span></span>

<span data-ttu-id="12d4b-172">開啟*about.aspx 的網頁*，然後在**來源**檢視中，取代現有的內容`BodyContent`之間使用 「 學生主體統計資料 」 來控制`h2`標記：</span><span class="sxs-lookup"><span data-stu-id="12d4b-172">Open *About.aspx*, and in **Source** view, replace the existing contents of the `BodyContent` control with "Student Body Statistics" between `h2` tags:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample3.aspx)]

<span data-ttu-id="12d4b-173">在標題中加`EntityDataSource`控制項並命名它`StudentStatisticsEntityDataSource`。</span><span class="sxs-lookup"><span data-stu-id="12d4b-173">After the heading, add an `EntityDataSource` control and name it `StudentStatisticsEntityDataSource`.</span></span> <span data-ttu-id="12d4b-174">將其連接到`SchoolEntities`，選取`People`實體集，並保留**選取**方塊在精靈中保持不變。</span><span class="sxs-lookup"><span data-stu-id="12d4b-174">Connect it to `SchoolEntities`, select the `People` entity set, and leave the **Select** box in the wizard unchanged.</span></span> <span data-ttu-id="12d4b-175">在 設定下列屬性**屬性**視窗：</span><span class="sxs-lookup"><span data-stu-id="12d4b-175">Set the following properties in the **Properties** window:</span></span>

- <span data-ttu-id="12d4b-176">若要篩選只學生版，請設定`Where`屬性設`it.EnrollmentDate is not null`。</span><span class="sxs-lookup"><span data-stu-id="12d4b-176">To filter for students only, set the `Where` property to `it.EnrollmentDate is not null`.</span></span>
- <span data-ttu-id="12d4b-177">若要依註冊日期將結果分組，將`GroupBy`屬性設`it.EnrollmentDate`。</span><span class="sxs-lookup"><span data-stu-id="12d4b-177">To group the results by the enrollment date, set the `GroupBy` property to `it.EnrollmentDate`.</span></span>
- <span data-ttu-id="12d4b-178">若要選取的註冊日期和學生數目，設定`Select`屬性設`it.EnrollmentDate, Count(it.EnrollmentDate) AS NumberOfStudents`。</span><span class="sxs-lookup"><span data-stu-id="12d4b-178">To select the enrollment date and the number of students, set the `Select` property to `it.EnrollmentDate, Count(it.EnrollmentDate) AS NumberOfStudents`.</span></span>
- <span data-ttu-id="12d4b-179">若要依註冊日期排序結果，將`OrderBy`屬性設`it.EnrollmentDate`。</span><span class="sxs-lookup"><span data-stu-id="12d4b-179">To order the results by the enrollment date, set the `OrderBy` property to `it.EnrollmentDate`.</span></span>

<span data-ttu-id="12d4b-180">在**來源**檢視中，取代`ConnectionString`並`DefaultContainer`使用的屬性名稱`ContextTypeName`屬性。</span><span class="sxs-lookup"><span data-stu-id="12d4b-180">In **Source** view, replace the `ConnectionString` and `DefaultContainer` name properties with a `ContextTypeName` property.</span></span> <span data-ttu-id="12d4b-181">`EntityDataSource`控制項標記現在類似下列的範例。</span><span class="sxs-lookup"><span data-stu-id="12d4b-181">The `EntityDataSource` control markup now resembles the following example.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample4.aspx)]

<span data-ttu-id="12d4b-182">語法`Select`， `GroupBy`，並`Where`屬性，類似於 TRANSACT-SQL 除了`it`關鍵字，指定目前的實體。</span><span class="sxs-lookup"><span data-stu-id="12d4b-182">The syntax of the `Select`, `GroupBy`, and `Where` properties resembles Transact-SQL except for the `it` keyword that specifies the current entity.</span></span>

<span data-ttu-id="12d4b-183">加入下列標記建立`GridView`控制項來顯示資料。</span><span class="sxs-lookup"><span data-stu-id="12d4b-183">Add the following markup to create a `GridView` control to display the data.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample5.aspx)]

<span data-ttu-id="12d4b-184">執行頁面，以查看顯示依註冊日期的學生數目的清單。</span><span class="sxs-lookup"><span data-stu-id="12d4b-184">Run the page to see a list showing the number of students by enrollment date.</span></span>

<span data-ttu-id="12d4b-185">[![Image10](the-entity-framework-and-aspnet-getting-started-part-3/_static/image28.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="12d4b-185">[![Image10](the-entity-framework-and-aspnet-getting-started-part-3/_static/image28.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image27.png)</span></span>

## <a name="using-the-queryextender-control-for-filtering-and-ordering"></a><span data-ttu-id="12d4b-186">QueryExtender 控制項用於篩選和排序</span><span class="sxs-lookup"><span data-stu-id="12d4b-186">Using the QueryExtender Control for Filtering and Ordering</span></span>

<span data-ttu-id="12d4b-187">`QueryExtender`控制項可用來指定篩選和排序在標記中。</span><span class="sxs-lookup"><span data-stu-id="12d4b-187">The `QueryExtender` control provides a way to specify filtering and sorting in markup.</span></span> <span data-ttu-id="12d4b-188">語法與您正在使用資料庫管理系統 (DBMS) 無關。</span><span class="sxs-lookup"><span data-stu-id="12d4b-188">The syntax is independent of the database management system (DBMS) you're using.</span></span> <span data-ttu-id="12d4b-189">它也是通常獨立的 Entity Framework，與您用於導覽屬性的語法是 Entity Framework 唯一的例外狀況。</span><span class="sxs-lookup"><span data-stu-id="12d4b-189">It's also generally independent of the Entity Framework, with the exception that syntax you use for navigation properties is unique to the Entity Framework.</span></span>

<span data-ttu-id="12d4b-190">在本教學課程的這個部分您將使用`QueryExtender`控制項以篩選和訂單資料，以及其中一個排序依據欄位將會瀏覽屬性。</span><span class="sxs-lookup"><span data-stu-id="12d4b-190">In this part of the tutorial you'll use a `QueryExtender` control to filter and order data, and one of the order-by fields will be a navigation property.</span></span>

<span data-ttu-id="12d4b-191">(如果您想要使用的程式碼而非標記，來擴充透過自動產生的查詢`EntityDataSource`控制項，您可以這麼做處理`QueryCreated`事件。</span><span class="sxs-lookup"><span data-stu-id="12d4b-191">(If you prefer to use code instead of markup to extend the queries that are automatically generated by the `EntityDataSource` control, you can do that by handling the `QueryCreated` event.</span></span> <span data-ttu-id="12d4b-192">這是如何`QueryExtender`控制項延伸`EntityDataSource`也控制查詢。)</span><span class="sxs-lookup"><span data-stu-id="12d4b-192">This is how the `QueryExtender` control extends `EntityDataSource` control queries also.)</span></span>

<span data-ttu-id="12d4b-193">開啟*Courses.aspx*頁面上，與您先前新增的標記，下方插入下列標記來建立標題，文字方塊中輸入搜尋字串、 一個 [搜尋] 按鈕和`EntityDataSource`來繫結控制項`Courses`實體集。</span><span class="sxs-lookup"><span data-stu-id="12d4b-193">Open the *Courses.aspx* page, and below the markup you added previously, insert the following markup to create a heading, a text box for entering search strings, a search button, and an `EntityDataSource` control that's bound to the `Courses` entity set.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample6.aspx)]

<span data-ttu-id="12d4b-194">請注意，`EntityDataSource`控制項的`Include`屬性設定為`Department`。</span><span class="sxs-lookup"><span data-stu-id="12d4b-194">Notice that the `EntityDataSource` control's `Include` property is set to `Department`.</span></span> <span data-ttu-id="12d4b-195">在資料庫中，`Course`資料表不包含部門名稱，它包含`DepartmentID`外部索引鍵資料行。</span><span class="sxs-lookup"><span data-stu-id="12d4b-195">In the database, the `Course` table does not contain the department name; it contains a `DepartmentID` foreign key column.</span></span> <span data-ttu-id="12d4b-196">如果您已取得部門名稱，連同課程資料查詢，直接的資料庫，您必須加入`Course`和`Department`資料表。</span><span class="sxs-lookup"><span data-stu-id="12d4b-196">If you were querying the database directly, to get the department name along with course data, you would have to join the `Course` and `Department` tables.</span></span> <span data-ttu-id="12d4b-197">藉由設定`Include`屬性，以`Department`，指定 Entity Framework 怎麼取得相關的工作`Department`實體，當它取得`Course`實體。</span><span class="sxs-lookup"><span data-stu-id="12d4b-197">By setting the `Include` property to `Department`, you specify that the Entity Framework should do the work of getting the related `Department` entity when it gets a `Course` entity.</span></span> <span data-ttu-id="12d4b-198">`Department`接著會儲存在實體`Department`導覽屬性`Course`實體。</span><span class="sxs-lookup"><span data-stu-id="12d4b-198">The `Department` entity is then stored in the `Department` navigation property of the `Course` entity.</span></span> <span data-ttu-id="12d4b-199">(根據預設，`SchoolEntities`類別所產生的資料模型設計工具會擷取相關的資料，當有需要以及您已資料來源控制項繫結至該類別，所以設定`Include`屬性不是必要。</span><span class="sxs-lookup"><span data-stu-id="12d4b-199">(By default, the `SchoolEntities` class that was generated by the data model designer retrieves related data when it's needed, and you've bound the data source control to that class, so setting the `Include` property is not necessary.</span></span> <span data-ttu-id="12d4b-200">不過，將它設定可以改善效能的頁面上，因為 Entity Framework 會將個別呼叫擷取資料的資料庫`Course`實體和相關`Department`實體。)</span><span class="sxs-lookup"><span data-stu-id="12d4b-200">However, setting it improves performance of the page, because otherwise the Entity Framework would make separate calls to the database to retrieve data for the `Course` entities and for the related `Department` entities.)</span></span>

<span data-ttu-id="12d4b-201">在後`EntityDataSource`控制您剛剛建立，插入下列標記來建立`QueryExtender`繫結的控制項`EntityDataSource`控制項。</span><span class="sxs-lookup"><span data-stu-id="12d4b-201">After the `EntityDataSource` control you just created, insert the following markup to create a `QueryExtender` control that's bound to that `EntityDataSource` control.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample7.aspx)]

<span data-ttu-id="12d4b-202">`SearchExpression`項目會指定您想要選取的課程標題符合在文字方塊中輸入的值。</span><span class="sxs-lookup"><span data-stu-id="12d4b-202">The `SearchExpression` element specifies that you want to select courses whose titles match the value entered in the text box.</span></span> <span data-ttu-id="12d4b-203">只會在文字方塊中輸入的字元數目的比較，因為`SearchType`屬性會指定`StartsWith`。</span><span class="sxs-lookup"><span data-stu-id="12d4b-203">Only as many characters as are entered in the text box will be compared, because the `SearchType` property specifies `StartsWith`.</span></span>

<span data-ttu-id="12d4b-204">`OrderByExpression`項目會指定結果集，會依據部門名稱內的課程標題進行排序。</span><span class="sxs-lookup"><span data-stu-id="12d4b-204">The `OrderByExpression` element specifies that the result set will be ordered by course title within department name.</span></span> <span data-ttu-id="12d4b-205">請注意指定部門名稱的方式： `Department.Name`。</span><span class="sxs-lookup"><span data-stu-id="12d4b-205">Notice how department name is specified: `Department.Name`.</span></span> <span data-ttu-id="12d4b-206">因為之間的關聯`Course`實體和`Department`實體是一對一，`Department`導覽屬性會包含`Department`實體。</span><span class="sxs-lookup"><span data-stu-id="12d4b-206">Because the association between the `Course` entity and the `Department` entity is one-to-one, the `Department` navigation property contains a `Department` entity.</span></span> <span data-ttu-id="12d4b-207">（如果這是一對多關聯性時，此屬性會包含集合）。若要取得的部門名稱，您必須指定`Name`屬性`Department`實體。</span><span class="sxs-lookup"><span data-stu-id="12d4b-207">(If this were a one-to-many relationship, the property would contain a collection.) To get the department name, you must specify the `Name` property of the `Department` entity.</span></span>

<span data-ttu-id="12d4b-208">最後，新增`GridView`控制項來顯示課程清單：</span><span class="sxs-lookup"><span data-stu-id="12d4b-208">Finally, add a `GridView` control to display the list of courses:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample8.aspx)]

<span data-ttu-id="12d4b-209">第一個資料行是範本欄位顯示部門名稱。</span><span class="sxs-lookup"><span data-stu-id="12d4b-209">The first column is a template field that displays the department name.</span></span> <span data-ttu-id="12d4b-210">資料繫結運算式會指定`Department.Name`如同您在中所見，`QueryExtender`控制項。</span><span class="sxs-lookup"><span data-stu-id="12d4b-210">The databinding expression specifies `Department.Name`, just as you saw in the `QueryExtender` control.</span></span>

<span data-ttu-id="12d4b-211">執行網頁。</span><span class="sxs-lookup"><span data-stu-id="12d4b-211">Run the page.</span></span> <span data-ttu-id="12d4b-212">初始顯示一份所有課程為了依部門和課程標題。</span><span class="sxs-lookup"><span data-stu-id="12d4b-212">The initial display shows a list of all courses in order by department and then by course title.</span></span>

<span data-ttu-id="12d4b-213">[![Image11](the-entity-framework-and-aspnet-getting-started-part-3/_static/image30.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="12d4b-213">[![Image11](the-entity-framework-and-aspnet-getting-started-part-3/_static/image30.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image29.png)</span></span>

<span data-ttu-id="12d4b-214">輸入"m"，然後按一下**搜尋**來查看所有課程標題開頭為"m"（搜尋是不區分大小寫）。</span><span class="sxs-lookup"><span data-stu-id="12d4b-214">Enter an "m" and click **Search** to see all courses whose titles begin with "m" (the search is not case sensitive).</span></span>

<span data-ttu-id="12d4b-215">[![Image12](the-entity-framework-and-aspnet-getting-started-part-3/_static/image32.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="12d4b-215">[![Image12](the-entity-framework-and-aspnet-getting-started-part-3/_static/image32.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image31.png)</span></span>

## <a name="using-the-like-operator-to-filter-data"></a><span data-ttu-id="12d4b-216">使用"Like"運算子來篩選資料</span><span class="sxs-lookup"><span data-stu-id="12d4b-216">Using the "Like" Operator to Filter Data</span></span>

<span data-ttu-id="12d4b-217">您可以達到的效果類似於`QueryExtender`控制項的`StartsWith`， `Contains`，和`EndsWith`搜尋使用的型別`Like`中的運算子`EntityDataSource`控制項的`Where`屬性。</span><span class="sxs-lookup"><span data-stu-id="12d4b-217">You can achieve an effect similar to the `QueryExtender` control's `StartsWith`, `Contains`, and `EndsWith` search types by using a `Like` operator in the `EntityDataSource` control's `Where` property.</span></span> <span data-ttu-id="12d4b-218">在本教學課程的這個部分，您會看到如何使用`Like`依名稱搜尋適用於學生的運算子。</span><span class="sxs-lookup"><span data-stu-id="12d4b-218">In this part of the tutorial, you'll see how to use the `Like` operator to search for a student by name.</span></span>

<span data-ttu-id="12d4b-219">開啟*Students.aspx*中**來源**檢視。</span><span class="sxs-lookup"><span data-stu-id="12d4b-219">Open *Students.aspx* in **Source** view.</span></span> <span data-ttu-id="12d4b-220">之後`GridView`控制項，加入下列標記：</span><span class="sxs-lookup"><span data-stu-id="12d4b-220">After the `GridView` control, add the following markup:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample9.aspx)]

<span data-ttu-id="12d4b-221">此標記是類似於什麼您稍早已見過除了`Where`屬性值。</span><span class="sxs-lookup"><span data-stu-id="12d4b-221">This markup is similar to what you've seen earlier except for the `Where` property value.</span></span> <span data-ttu-id="12d4b-222">第二部分`Where`運算式定義的子字串搜尋 (`LIKE %FirstMidName% or LIKE %LastName%`)，無論在文字方塊中輸入的第一個和最後一個名稱中搜尋。</span><span class="sxs-lookup"><span data-stu-id="12d4b-222">The second part of the `Where` expression defines a substring search (`LIKE %FirstMidName% or LIKE %LastName%`) that searches both the first and last names for whatever is entered in the text box.</span></span>

<span data-ttu-id="12d4b-223">執行網頁。</span><span class="sxs-lookup"><span data-stu-id="12d4b-223">Run the page.</span></span> <span data-ttu-id="12d4b-224">一開始您看到的所有學生的預設值，因為`StudentName`參數是"%"。</span><span class="sxs-lookup"><span data-stu-id="12d4b-224">Initially you see all of the students because the default value for the `StudentName` parameter is "%".</span></span>

<span data-ttu-id="12d4b-225">[![Image13](the-entity-framework-and-aspnet-getting-started-part-3/_static/image34.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="12d4b-225">[![Image13](the-entity-framework-and-aspnet-getting-started-part-3/_static/image34.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image33.png)</span></span>

<span data-ttu-id="12d4b-226">在文字方塊中輸入字母"g"，然後按一下**搜尋**。</span><span class="sxs-lookup"><span data-stu-id="12d4b-226">Enter the letter "g" in the text box and click **Search**.</span></span> <span data-ttu-id="12d4b-227">您看到的第一個或最後一個名稱中有"g"的學生的清單。</span><span class="sxs-lookup"><span data-stu-id="12d4b-227">You see a list of students that have a "g" in either the first or last name.</span></span>

<span data-ttu-id="12d4b-228">[![Image14](the-entity-framework-and-aspnet-getting-started-part-3/_static/image36.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="12d4b-228">[![Image14](the-entity-framework-and-aspnet-getting-started-part-3/_static/image36.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image35.png)</span></span>

<span data-ttu-id="12d4b-229">您已經顯示、 更新、 篩選、 排序，並分組資料，從個別的資料表。</span><span class="sxs-lookup"><span data-stu-id="12d4b-229">You've now displayed, updated, filtered, ordered, and grouped data from individual tables.</span></span> <span data-ttu-id="12d4b-230">在下一個教學課程中，您會開始處理相關的資料 （一對多案例）。</span><span class="sxs-lookup"><span data-stu-id="12d4b-230">In the next tutorial you'll begin to work with related data (master-detail scenarios).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="12d4b-231">[上一頁](the-entity-framework-and-aspnet-getting-started-part-2.md)
> [下一頁](the-entity-framework-and-aspnet-getting-started-part-4.md)</span><span class="sxs-lookup"><span data-stu-id="12d4b-231">[Previous](the-entity-framework-and-aspnet-getting-started-part-2.md)
[Next](the-entity-framework-and-aspnet-getting-started-part-4.md)</span></span>
