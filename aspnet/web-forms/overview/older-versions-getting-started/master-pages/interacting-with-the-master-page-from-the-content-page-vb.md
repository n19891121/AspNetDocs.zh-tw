---
uid: web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-master-page-from-the-content-page-vb
title: 從內容頁與主版頁面互動（VB） |Microsoft Docs
author: rick-anderson
description: 從 [內容] 頁面中的程式碼，檢查如何呼叫主版頁面的方法、設定屬性等等。
ms.author: riande
ms.date: 07/11/2008
ms.assetid: 081fe010-ba0f-4e7d-b4ba-774840b601c2
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-master-page-from-the-content-page-vb
msc.type: authoredcontent
ms.openlocfilehash: fe1f7b80b26ff25c1ce744e4f823e3fb35eea074
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/06/2020
ms.locfileid: "78548213"
---
# <a name="interacting-with-the-master-page-from-the-content-page-vb"></a><span data-ttu-id="5ec06-103">從內容頁面與主版頁互動 (VB)</span><span class="sxs-lookup"><span data-stu-id="5ec06-103">Interacting with the Master Page from the Content Page (VB)</span></span>

<span data-ttu-id="5ec06-104">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="5ec06-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="5ec06-105">[下載程式代碼](https://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_06_VB.zip)或[下載 PDF](https://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_06_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="5ec06-105">[Download Code](https://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_06_VB.zip) or [Download PDF](https://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_06_VB.pdf)</span></span>

> <span data-ttu-id="5ec06-106">從 [內容] 頁面中的程式碼，檢查如何呼叫主版頁面的方法、設定屬性等等。</span><span class="sxs-lookup"><span data-stu-id="5ec06-106">Examines how to call methods, set properties, etc. of the Master Page from code in the Content Page.</span></span>

## <a name="introduction"></a><span data-ttu-id="5ec06-107">簡介</span><span class="sxs-lookup"><span data-stu-id="5ec06-107">Introduction</span></span>

<span data-ttu-id="5ec06-108">在過去五個教學課程中，我們探討了如何建立主版頁面、定義內容區域、將 ASP.NET 網頁系結至主版頁面，以及定義頁面特定內容。</span><span class="sxs-lookup"><span data-stu-id="5ec06-108">Over the course of the past five tutorials we have looked at how to create a master page, define content regions, bind ASP.NET pages to a master page, and define page-specific content.</span></span> <span data-ttu-id="5ec06-109">當訪客要求特定的內容頁面時，內容和主版頁面的標記會在執行時間進行融合，導致整合控制項階層的呈現。</span><span class="sxs-lookup"><span data-stu-id="5ec06-109">When a visitor requests a particular content page, the content and master pages' markup are fused at runtime, resulting in the rendering of a unified control hierarchy.</span></span> <span data-ttu-id="5ec06-110">因此，我們已經看過主版頁面和其中一個內容頁面可以互動的方式： [內容] 頁面會將標記拼寫為 transfuse 至主版頁面的 ContentPlaceHolder 控制項。</span><span class="sxs-lookup"><span data-stu-id="5ec06-110">Therefore, we have already seen one way in which the master page and one of its content pages can interact: the content page spells out the markup to transfuse into the master page's ContentPlaceHolder controls.</span></span>

<span data-ttu-id="5ec06-111">我們還必須檢查主版頁面和內容頁面如何以程式設計方式進行互動。</span><span class="sxs-lookup"><span data-stu-id="5ec06-111">What we have yet to examine is how the master page and content page can interact programmatically.</span></span> <span data-ttu-id="5ec06-112">除了定義主版頁面的 ContentPlaceHolder 控制項標記以外，[內容] 頁面也可以將值指派給其主版頁面的公用屬性，並叫用其公用方法。</span><span class="sxs-lookup"><span data-stu-id="5ec06-112">In addition to defining the markup for the master page's ContentPlaceHolder controls, a content page can also assign values to its master page's public properties and invoke its public methods.</span></span> <span data-ttu-id="5ec06-113">同樣地，主版頁面也可以與其內容頁面互動。</span><span class="sxs-lookup"><span data-stu-id="5ec06-113">Similarly, a master page may interact with its content pages.</span></span> <span data-ttu-id="5ec06-114">雖然主要和內容頁面之間的程式設計互動不如其宣告式標記之間的互動，但是在許多情況下都需要這類的程式設計互動。</span><span class="sxs-lookup"><span data-stu-id="5ec06-114">While programmatic interaction between a master and content page is less common than the interaction between their declarative markups, there are many scenarios where such programmatic interaction is needed.</span></span>

<span data-ttu-id="5ec06-115">在本教學課程中，我們會檢查內容頁面如何以程式設計方式與主版頁面互動;在下一個教學課程中，我們將探討主版頁面如何與內容頁面互動。</span><span class="sxs-lookup"><span data-stu-id="5ec06-115">In this tutorial we examine how a content page can programmatically interact with its master page; in the next tutorial we will look at how the master page can similarly interact with its content pages.</span></span>

## <a name="examples-of-programmatic-interaction-between-a-content-page-and-its-master-page"></a><span data-ttu-id="5ec06-116">內容頁與主版頁面之間的程式設計互動範例</span><span class="sxs-lookup"><span data-stu-id="5ec06-116">Examples of Programmatic Interaction Between a Content Page and its Master Page</span></span>

<span data-ttu-id="5ec06-117">當頁面的特定區域需要以逐頁進行設定時，我們會使用 ContentPlaceHolder 控制項。</span><span class="sxs-lookup"><span data-stu-id="5ec06-117">When a particular region of a page needs to be configured on a page-by-page basis, we use a ContentPlaceHolder control.</span></span> <span data-ttu-id="5ec06-118">但是，大部分的頁面需要發出特定輸出，但少數頁面需要自訂以顯示其他內容的情況呢？</span><span class="sxs-lookup"><span data-stu-id="5ec06-118">But what about situations where the majority of pages need to emit a certain output, but a small number of pages need to customize it to show something else?</span></span> <span data-ttu-id="5ec06-119">我們在[*多 ContentPlaceHolders 和預設內容*](multiple-contentplaceholders-and-default-content-vb.md)教學課程中檢查過的其中一個範例，牽涉到在每個頁面上顯示登入介面。</span><span class="sxs-lookup"><span data-stu-id="5ec06-119">One such example, which we examined in the [*Multiple ContentPlaceHolders and Default Content*](multiple-contentplaceholders-and-default-content-vb.md) tutorial, involves displaying a login interface on each page.</span></span> <span data-ttu-id="5ec06-120">雖然大部分的頁面都應該包含登入介面，但應該隱藏幾個頁面，例如：主要登入頁面（`Login.aspx`）;[建立帳戶] 頁面;和其他僅供已驗證的使用者存取的頁面。</span><span class="sxs-lookup"><span data-stu-id="5ec06-120">While most pages should include a login interface, it should be suppressed for a handful of pages, such as: the main login page (`Login.aspx`); the Create Account page; and other pages that are only accessible to authenticated users.</span></span> <span data-ttu-id="5ec06-121">[*多 ContentPlaceHolders 和預設內容*](multiple-contentplaceholders-and-default-content-vb.md)教學課程示範如何在主版頁面中定義 ContentPlaceHolder 的預設內容，以及如何在不需要預設內容的頁面中覆寫它。</span><span class="sxs-lookup"><span data-stu-id="5ec06-121">The [*Multiple ContentPlaceHolders and Default Content*](multiple-contentplaceholders-and-default-content-vb.md) tutorial showed how to define the default content for a ContentPlaceHolder in the master page and then how to override it in those pages where the default content was not wanted.</span></span>

<span data-ttu-id="5ec06-122">另一個選項是在主版頁面中建立公用屬性或方法，以指出是否要顯示或隱藏登入介面。</span><span class="sxs-lookup"><span data-stu-id="5ec06-122">Another option is to create a public property or method within the master page that indicates whether to show or hide the login interface.</span></span> <span data-ttu-id="5ec06-123">例如，主版頁面可能包含名為 `ShowLoginUI` 的公用屬性，其值是用來設定主版頁面中登入控制項的 `Visible` 屬性。</span><span class="sxs-lookup"><span data-stu-id="5ec06-123">For example, the master page might include a public property named `ShowLoginUI` whose value was used to set the `Visible` property of the Login control in the master page.</span></span> <span data-ttu-id="5ec06-124">應隱藏登入使用者介面的內容頁面，可以透過程式設計的方式，將 `ShowLoginUI` 屬性設定為 `False`。</span><span class="sxs-lookup"><span data-stu-id="5ec06-124">Those content pages where the login user interface should be suppressed could then programmatically set the `ShowLoginUI` property to `False`.</span></span>

<span data-ttu-id="5ec06-125">當主版頁面中顯示的資料需要在 [內容] 頁面中過了後重新整理時，可能會發生最常見的內容和主版頁面互動範例。</span><span class="sxs-lookup"><span data-stu-id="5ec06-125">Perhaps the most common example of content and master page interaction occurs when data displayed in the master page needs to be refreshed after some action has transpired in the content page.</span></span> <span data-ttu-id="5ec06-126">假設有一個包含 GridView 的主版頁面，其中顯示來自特定資料庫資料表的五個最近新增的記錄，而且其中一個內容頁麵包含一個介面，可將新記錄加入至同一個資料表。</span><span class="sxs-lookup"><span data-stu-id="5ec06-126">Consider a master page that includes a GridView that displays the five most recently added records from a particular database table, and that one of its content pages includes an interface for adding new records to that same table.</span></span>

<span data-ttu-id="5ec06-127">當使用者造訪頁面以新增記錄時，她會看到最近新增的五筆記錄顯示在主版頁面中。</span><span class="sxs-lookup"><span data-stu-id="5ec06-127">When a user visits the page to add a new record, she sees the five most recently added records displayed in the master page.</span></span> <span data-ttu-id="5ec06-128">填入新記錄之資料行的值之後，她提交表單。</span><span class="sxs-lookup"><span data-stu-id="5ec06-128">After filling in the values for the new record's columns, she submits the form.</span></span> <span data-ttu-id="5ec06-129">假設主版頁面中的 GridView 將其 `EnableViewState` 屬性設為 True （預設值），則會從 view 狀態重載其內容，因此，即使剛將較新的記錄新增至資料庫，也會顯示五筆相同的記錄。</span><span class="sxs-lookup"><span data-stu-id="5ec06-129">Assuming that the GridView in the master page has its `EnableViewState` property set to True (the default), its content is reloaded from view state and, consequently, the five same records are displayed even though a newer record was just added to the database.</span></span> <span data-ttu-id="5ec06-130">這可能會造成使用者的混淆。</span><span class="sxs-lookup"><span data-stu-id="5ec06-130">This may confuse the user.</span></span>

> [!NOTE]
> <span data-ttu-id="5ec06-131">即使您停用 GridView 的 view 狀態，使其在每次回傳時重新系結至其基礎資料來源，它仍然不會顯示剛剛加入的記錄，因為資料會系結至比新記錄新增至 datab 時更早在頁面生命週期中的 GridViewase.</span><span class="sxs-lookup"><span data-stu-id="5ec06-131">Even if you disable the GridView's view state so that it rebinds to its underlying data source on every postback, it still won't show the just-added record because the data is bound to the GridView earlier in the page lifecycle than when the new record is added to the database.</span></span>

<span data-ttu-id="5ec06-132">若要解決此問題，使剛加入的記錄在回傳時顯示在主版頁面的 GridView 中，我們需要在新記錄新增至資料庫*之後*，指示 GridView 重新系結至其資料來源。</span><span class="sxs-lookup"><span data-stu-id="5ec06-132">To remedy this so that the just-added record is displayed in the master page's GridView on postback we need to instruct the GridView to rebind to its data source *after* the new record has been added to the database.</span></span> <span data-ttu-id="5ec06-133">這需要在內容和主版頁面之間進行互動，因為用於新增新記錄（及其事件處理常式）的介面位於 [內容] 頁面中，但需要重新整理的 GridView 是在主版頁面中。</span><span class="sxs-lookup"><span data-stu-id="5ec06-133">This requires interaction between the content and master pages because the interface for adding the new record (and its event handlers) are in the content page but the GridView that needs to be refreshed is in the master page.</span></span>

<span data-ttu-id="5ec06-134">因為從內容頁面中的事件處理常式重新整理主版頁面的顯示是內容和主版頁面互動的最常見需求之一，所以讓我們更詳細地探索這個主題。</span><span class="sxs-lookup"><span data-stu-id="5ec06-134">Because refreshing the master page's display from an event handler in the content page is one of the most common needs for content and master page interaction, let's explore this topic in more detail.</span></span> <span data-ttu-id="5ec06-135">本教學課程的下載包含網站 `App_Data` 資料夾中名為 `NORTHWIND.MDF` 的 Microsoft SQL Server 2005 Express Edition 資料庫。</span><span class="sxs-lookup"><span data-stu-id="5ec06-135">The download for this tutorial includes a Microsoft SQL Server 2005 Express Edition database named `NORTHWIND.MDF` in the website's `App_Data` folder.</span></span> <span data-ttu-id="5ec06-136">Northwind 資料庫會儲存一家虛構公司 Northwind 商貿的產品、員工和銷售資訊。</span><span class="sxs-lookup"><span data-stu-id="5ec06-136">The Northwind database stores product, employee, and sales information for a fictitious company, Northwind Traders.</span></span>

<span data-ttu-id="5ec06-137">步驟1會逐步解說如何在主版頁面中顯示 GridView 的五個最近新增的產品。</span><span class="sxs-lookup"><span data-stu-id="5ec06-137">Step 1 walks through displaying the five most recently added products in a GridView in the master page.</span></span> <span data-ttu-id="5ec06-138">步驟2會建立用於加入新產品的內容頁面。</span><span class="sxs-lookup"><span data-stu-id="5ec06-138">Step 2 creates a content page for adding new products.</span></span> <span data-ttu-id="5ec06-139">步驟3探討如何在主版頁面中建立公用屬性和方法，而步驟4則說明如何以程式設計方式，從 [內容] 頁面使用這些屬性和方法進行介面化。</span><span class="sxs-lookup"><span data-stu-id="5ec06-139">Step 3 looks at how to create public properties and methods in the master page, and Step 4 illustrates how to programmatically interface with these properties and methods from the content page.</span></span>

> [!NOTE]
> <span data-ttu-id="5ec06-140">本教學課程不會深入探討在 ASP.NET 中使用資料的細節。</span><span class="sxs-lookup"><span data-stu-id="5ec06-140">This tutorial does not delve into the specifics of working with data in ASP.NET.</span></span> <span data-ttu-id="5ec06-141">設定主版頁面以顯示資料和 [內容] 頁面以進行插入資料的步驟已完成，但已 breezy。</span><span class="sxs-lookup"><span data-stu-id="5ec06-141">The steps for setting up the master page to display data and the content page for inserting data are complete, yet breezy.</span></span> <span data-ttu-id="5ec06-142">若要深入瞭解如何顯示及插入資料，以及如何使用 SqlDataSource 和 GridView 控制項，請參閱本教學課程結尾的進一步閱讀一節中的資源。</span><span class="sxs-lookup"><span data-stu-id="5ec06-142">For a more in-depth look at displaying and inserting data and using the SqlDataSource and GridView controls, consult the resources in the Further Readings section at the end of this tutorial.</span></span>

## <a name="step-1-displaying-the-five-most-recently-added-products-in-the-master-page"></a><span data-ttu-id="5ec06-143">步驟1：在主版頁面中顯示五個最近新增的產品</span><span class="sxs-lookup"><span data-stu-id="5ec06-143">Step 1: Displaying the Five Most Recently Added Products in the Master Page</span></span>

<span data-ttu-id="5ec06-144">開啟 [網站] 主版頁面，並將標籤和 GridView 控制項新增至 `leftContent` `<div>`。</span><span class="sxs-lookup"><span data-stu-id="5ec06-144">Open the Site.master master page and add a Label and a GridView control to the `leftContent` `<div>`.</span></span> <span data-ttu-id="5ec06-145">清除標籤的 [`Text`] 屬性，將其 [`EnableViewState`] 屬性設為 [`False`]，並將其 `ID` 屬性設定為 [`GridMessage`]。將 GridView 的 `ID` 屬性設定為 [`RecentProducts`]。</span><span class="sxs-lookup"><span data-stu-id="5ec06-145">Clear out the Label's `Text` property, set its `EnableViewState` property to `False`, and its `ID` property to `GridMessage`; set the GridView's `ID` property to `RecentProducts`.</span></span> <span data-ttu-id="5ec06-146">接下來，從設計工具展開 GridView 的智慧標籤，並選擇將其系結至新的資料來源。</span><span class="sxs-lookup"><span data-stu-id="5ec06-146">Next, from the Designer, expand the GridView's smart tag and choose to bind it to a new data source.</span></span> <span data-ttu-id="5ec06-147">這會啟動 [資料來源設定向導]。</span><span class="sxs-lookup"><span data-stu-id="5ec06-147">This launches the Data Source Configuration wizard.</span></span> <span data-ttu-id="5ec06-148">由於 [`App_Data`] 資料夾中的 Northwind 資料庫是 Microsoft SQL Server 資料庫，因此請選擇建立 SqlDataSource，方法是選取（請參閱 [圖 1]）。將 SqlDataSource 命名為 `RecentProductsDataSource`。</span><span class="sxs-lookup"><span data-stu-id="5ec06-148">Because the Northwind database in the `App_Data` folder is a Microsoft SQL Server database, choose to create a SqlDataSource by selecting (see Figure 1); name the SqlDataSource `RecentProductsDataSource`.</span></span>

<span data-ttu-id="5ec06-149">[![將 GridView 系結至名為 RecentProductsDataSource 的 SqlDataSource 控制項](interacting-with-the-master-page-from-the-content-page-vb/_static/image2.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="5ec06-149">[![Bind the GridView to a SqlDataSource Control Named RecentProductsDataSource](interacting-with-the-master-page-from-the-content-page-vb/_static/image2.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image1.png)</span></span>

<span data-ttu-id="5ec06-150">**圖 01**：將 GridView 系結至名為 `RecentProductsDataSource` 的 SqlDataSource 控制項（[按一下以查看完整大小的影像](interacting-with-the-master-page-from-the-content-page-vb/_static/image3.png)）</span><span class="sxs-lookup"><span data-stu-id="5ec06-150">**Figure 01**: Bind the GridView to a SqlDataSource Control Named `RecentProductsDataSource` ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image3.png))</span></span>

<span data-ttu-id="5ec06-151">下一個步驟會要求我們指定要連接的資料庫。</span><span class="sxs-lookup"><span data-stu-id="5ec06-151">The next step asks us to specify what database to connect to.</span></span> <span data-ttu-id="5ec06-152">從下拉式清單中選擇 [`NORTHWIND.MDF` 資料庫檔案]，然後按 [下一步]。</span><span class="sxs-lookup"><span data-stu-id="5ec06-152">Choose the `NORTHWIND.MDF` database file from the drop-down list and click Next.</span></span> <span data-ttu-id="5ec06-153">因為這是我們第一次使用此資料庫，所以嚮導會提供將連接字串儲存在 `Web.config`中。</span><span class="sxs-lookup"><span data-stu-id="5ec06-153">Because this is the first time we've used this database, the wizard will offer to store the connection string in `Web.config`.</span></span> <span data-ttu-id="5ec06-154">讓它使用名稱 `NorthwindConnectionString`來儲存連接字串。</span><span class="sxs-lookup"><span data-stu-id="5ec06-154">Have it store the connection string using the name `NorthwindConnectionString`.</span></span>

<span data-ttu-id="5ec06-155">[![連接到 Northwind 資料庫](interacting-with-the-master-page-from-the-content-page-vb/_static/image5.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="5ec06-155">[![Connect to the Northwind Database](interacting-with-the-master-page-from-the-content-page-vb/_static/image5.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image4.png)</span></span>

<span data-ttu-id="5ec06-156">**圖 02**：連接到 Northwind 資料庫（[按一下以觀看完整大小的影像](interacting-with-the-master-page-from-the-content-page-vb/_static/image6.png)）</span><span class="sxs-lookup"><span data-stu-id="5ec06-156">**Figure 02**: Connect to the Northwind Database  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image6.png))</span></span>

<span data-ttu-id="5ec06-157">[設定資料來源] 嚮導會提供兩種方法，讓我們指定用來抓取資料的查詢：</span><span class="sxs-lookup"><span data-stu-id="5ec06-157">The Configure Data Source wizard provides two means by which we can specify the query used to retrieve data:</span></span>

- <span data-ttu-id="5ec06-158">藉由指定自訂 SQL 語句或預存程式，或</span><span class="sxs-lookup"><span data-stu-id="5ec06-158">By specifying a custom SQL statement or stored procedure, or</span></span>
- <span data-ttu-id="5ec06-159">藉由挑選資料表或視圖，然後指定要傳回的資料行</span><span class="sxs-lookup"><span data-stu-id="5ec06-159">By picking a table or view and then specifying the columns to return</span></span>

<span data-ttu-id="5ec06-160">因為我們只想要傳回五個最近新增的產品，所以我們需要指定自訂的 SQL 語句。</span><span class="sxs-lookup"><span data-stu-id="5ec06-160">Because we want to return just the five most recently added products, we need to specify a custom SQL statement.</span></span> <span data-ttu-id="5ec06-161">使用下列 `SELECT` 查詢：</span><span class="sxs-lookup"><span data-stu-id="5ec06-161">Use the following `SELECT` query:</span></span>

[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample1.sql)]

<span data-ttu-id="5ec06-162">`TOP 5` 關鍵字只會傳回查詢中的前五筆記錄。</span><span class="sxs-lookup"><span data-stu-id="5ec06-162">The `TOP 5` keyword returns only the first five records from the query.</span></span> <span data-ttu-id="5ec06-163">`Products` 資料表的主鍵（`ProductID`）是 `IDENTITY` 的資料行，可確保新增至資料表的每個新產品都有比前一個專案更大的值。</span><span class="sxs-lookup"><span data-stu-id="5ec06-163">The `Products` table's primary key, `ProductID`, is an `IDENTITY` column, which assures us that each new product added to the table will have a larger value than the previous entry.</span></span> <span data-ttu-id="5ec06-164">因此，依 `ProductID` 以遞減順序排序結果，會傳回從最近建立的產品開始。</span><span class="sxs-lookup"><span data-stu-id="5ec06-164">Therefore, sorting the results by `ProductID` in descending order returns the products starting with the most recently created ones.</span></span>

<span data-ttu-id="5ec06-165">[![傳回最近新增的五個產品](interacting-with-the-master-page-from-the-content-page-vb/_static/image8.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="5ec06-165">[![Return the Five Most Recently Added Products](interacting-with-the-master-page-from-the-content-page-vb/_static/image8.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image7.png)</span></span>

<span data-ttu-id="5ec06-166">**圖 03**：傳回最近新增的五個產品（[按一下以觀看完整大小的影像](interacting-with-the-master-page-from-the-content-page-vb/_static/image9.png)）</span><span class="sxs-lookup"><span data-stu-id="5ec06-166">**Figure 03**: Return the Five Most Recently Added Products  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image9.png))</span></span>

<span data-ttu-id="5ec06-167">完成 wizard 之後，Visual Studio 會為 GridView 產生兩個 BoundFields，以顯示從資料庫傳回的 `ProductName` 和 `UnitPrice` 欄位。</span><span class="sxs-lookup"><span data-stu-id="5ec06-167">After completing the wizard, Visual Studio generates two BoundFields for the GridView to display the `ProductName` and `UnitPrice` fields returned from the database.</span></span> <span data-ttu-id="5ec06-168">此時，主版頁面的宣告式標記應該包含類似下列的標記：</span><span class="sxs-lookup"><span data-stu-id="5ec06-168">At this point your master page's declarative markup should include markup similar to the following:</span></span>

[!code-aspx[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample2.aspx)]

<span data-ttu-id="5ec06-169">如您所見，標記包含：標籤 Web 控制項（`GridMessage`）;GridView `RecentProducts`，有兩個 BoundFields;和 SqlDataSource 控制項，它會傳回最近新增的五個產品。</span><span class="sxs-lookup"><span data-stu-id="5ec06-169">As you can see, the markup contains: the Label Web control (`GridMessage`); the GridView `RecentProducts`, with two BoundFields; and a SqlDataSource control that returns the five most recently added products.</span></span>

<span data-ttu-id="5ec06-170">建立此 GridView 並設定其 SqlDataSource 控制項之後，請透過瀏覽器造訪網站。</span><span class="sxs-lookup"><span data-stu-id="5ec06-170">With this GridView created and its SqlDataSource control configured, visit the website through a browser.</span></span> <span data-ttu-id="5ec06-171">如 [圖 4] 所示，您會在左下角看到一個方格，其中列出五個最近新增的產品。</span><span class="sxs-lookup"><span data-stu-id="5ec06-171">As Figure 4 shows, you will see a grid in the lower left corner that lists the five most recently added products.</span></span>

<span data-ttu-id="5ec06-172">[![GridView 會顯示最近新增的五個產品](interacting-with-the-master-page-from-the-content-page-vb/_static/image11.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="5ec06-172">[![The GridView Displays the Five Most Recently Added Products](interacting-with-the-master-page-from-the-content-page-vb/_static/image11.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image10.png)</span></span>

<span data-ttu-id="5ec06-173">**圖 04**： GridView 會顯示最近新增的五個產品（[按一下以觀看完整大小的影像](interacting-with-the-master-page-from-the-content-page-vb/_static/image12.png)）</span><span class="sxs-lookup"><span data-stu-id="5ec06-173">**Figure 04**: The GridView Displays the Five Most Recently Added Products ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image12.png))</span></span>

> [!NOTE]
> <span data-ttu-id="5ec06-174">請隨意清除 GridView 的外觀。</span><span class="sxs-lookup"><span data-stu-id="5ec06-174">Feel free to clean up the appearance of the GridView.</span></span> <span data-ttu-id="5ec06-175">某些建議包括將顯示的 `UnitPrice` 值格式化為貨幣，以及使用背景色彩和字型來改善方格的外觀。</span><span class="sxs-lookup"><span data-stu-id="5ec06-175">Some suggestions include formatting the displayed `UnitPrice` value as a currency and using background colors and fonts to improve the grid's appearance.</span></span>

## <a name="step-2-creating-a-content-page-to-add-new-products"></a><span data-ttu-id="5ec06-176">步驟2：建立內容頁面以新增產品</span><span class="sxs-lookup"><span data-stu-id="5ec06-176">Step 2: Creating a Content Page to Add New Products</span></span>

<span data-ttu-id="5ec06-177">我們的下一個工作是建立一個內容頁面，讓使用者可以從中將新產品加入 `Products` 資料表。</span><span class="sxs-lookup"><span data-stu-id="5ec06-177">Our next task is to create a content page from which a user can add a new product to the `Products` table.</span></span> <span data-ttu-id="5ec06-178">將新的 [內容] 頁面新增至名為 `AddProduct.aspx`的 `Admin` 資料夾，並務必將它系結至 `Site.master` 主版頁面。</span><span class="sxs-lookup"><span data-stu-id="5ec06-178">Add a new content page to the `Admin` folder named `AddProduct.aspx`, making sure to bind it to the `Site.master` master page.</span></span> <span data-ttu-id="5ec06-179">[圖 5] 顯示此頁面新增至網站後的方案總管。</span><span class="sxs-lookup"><span data-stu-id="5ec06-179">Figure 5 shows the Solution Explorer after this page has been added to the website.</span></span>

<span data-ttu-id="5ec06-180">[![將新的 ASP.NET 網頁新增至管理資料夾](interacting-with-the-master-page-from-the-content-page-vb/_static/image14.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="5ec06-180">[![Add a New ASP.NET Page to the Admin Folder](interacting-with-the-master-page-from-the-content-page-vb/_static/image14.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image13.png)</span></span>

<span data-ttu-id="5ec06-181">**圖 05**：將新的 [ASP.NET] 頁面新增至 [`Admin`] 資料夾（[按一下以查看完整大小的影像](interacting-with-the-master-page-from-the-content-page-vb/_static/image15.png)）</span><span class="sxs-lookup"><span data-stu-id="5ec06-181">**Figure 05**: Add a New ASP.NET Page to the `Admin` Folder ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image15.png))</span></span>

<span data-ttu-id="5ec06-182">回想一下，在[*主版頁面教學課程中指定標題、中繼標記和其他 HTML 標頭*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md)時，我們建立了名為 `BasePage` 的自訂基底頁面類別，如果未明確設定，則會產生頁面標題。</span><span class="sxs-lookup"><span data-stu-id="5ec06-182">Recall that in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial we created a custom base page class named `BasePage` that generated the page's title if it was not explicitly set.</span></span> <span data-ttu-id="5ec06-183">移至 `AddProduct.aspx` 頁面的程式碼後置類別，並讓它衍生自 `BasePage` （而不是從 `System.Web.UI.Page`）。</span><span class="sxs-lookup"><span data-stu-id="5ec06-183">Go to the `AddProduct.aspx` page's code-behind class and have it derive from `BasePage` (instead of from `System.Web.UI.Page`).</span></span>

<span data-ttu-id="5ec06-184">最後，更新 `Web.sitemap` 檔案以包含此課程的專案。</span><span class="sxs-lookup"><span data-stu-id="5ec06-184">Finally, update the `Web.sitemap` file to include an entry for this lesson.</span></span> <span data-ttu-id="5ec06-185">在 [控制項 ID 命名問題] 課程的 `<siteMapNode>` 下方新增下列標記：</span><span class="sxs-lookup"><span data-stu-id="5ec06-185">Add the following markup beneath the `<siteMapNode>` for the Control ID Naming Issues lesson:</span></span>

[!code-xml[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample3.xml)]

<span data-ttu-id="5ec06-186">如 [圖 6] 所示，加入此 `<siteMapNode>` 元素會反映在課程清單中。</span><span class="sxs-lookup"><span data-stu-id="5ec06-186">As shown in Figure 6, the addition of this `<siteMapNode>` element is reflected in the Lessons list.</span></span>

<span data-ttu-id="5ec06-187">返回 `AddProduct.aspx`。</span><span class="sxs-lookup"><span data-stu-id="5ec06-187">Return to `AddProduct.aspx`.</span></span> <span data-ttu-id="5ec06-188">在 [`MainContent` ContentPlaceHolder] 的內容控制項中，新增 DetailsView 控制項並將其命名為 `NewProduct`。</span><span class="sxs-lookup"><span data-stu-id="5ec06-188">In the Content control for the `MainContent` ContentPlaceHolder, add a DetailsView control and name it `NewProduct`.</span></span> <span data-ttu-id="5ec06-189">將 DetailsView 系結至名為 `NewProductDataSource`的新 SqlDataSource 控制項。</span><span class="sxs-lookup"><span data-stu-id="5ec06-189">Bind the DetailsView to a new SqlDataSource control named `NewProductDataSource`.</span></span> <span data-ttu-id="5ec06-190">如同步驟1中的 SqlDataSource，請設定 wizard，讓它使用 Northwind 資料庫，然後選擇指定自訂的 SQL 語句。</span><span class="sxs-lookup"><span data-stu-id="5ec06-190">Like with the SqlDataSource in Step 1, configure the wizard so that it uses the Northwind database and choose to specify a custom SQL statement.</span></span> <span data-ttu-id="5ec06-191">因為 DetailsView 將用來將專案加入至資料庫，所以我們需要同時指定 `SELECT` 語句和 `INSERT` 語句。</span><span class="sxs-lookup"><span data-stu-id="5ec06-191">Because the DetailsView will be used to add items to the database, we need to specify both a `SELECT` statement and an `INSERT` statement.</span></span> <span data-ttu-id="5ec06-192">使用下列 `SELECT` 查詢：</span><span class="sxs-lookup"><span data-stu-id="5ec06-192">Use the following `SELECT` query:</span></span>

[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample4.sql)]

<span data-ttu-id="5ec06-193">然後，在 [插入] 索引標籤中，新增下列 `INSERT` 語句：</span><span class="sxs-lookup"><span data-stu-id="5ec06-193">Then, from the INSERT tab, add the following `INSERT` statement:</span></span>

[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample5.sql)]

<span data-ttu-id="5ec06-194">完成嚮導之後，請移至 DetailsView 的智慧標籤，然後勾選 [啟用插入] 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="5ec06-194">After completing the wizard go to the DetailsView's smart tag and check the "Enable Inserting" checkbox.</span></span> <span data-ttu-id="5ec06-195">這會將 CommandField 新增至 DetailsView，並將其 `ShowInsertButton` 屬性設定為 True。</span><span class="sxs-lookup"><span data-stu-id="5ec06-195">This adds a CommandField to the DetailsView with its `ShowInsertButton` property set to True.</span></span> <span data-ttu-id="5ec06-196">由於此 DetailsView 只會用於插入資料，因此請將 DetailsView 的 `DefaultMode` 屬性設定為 `Insert`。</span><span class="sxs-lookup"><span data-stu-id="5ec06-196">Because this DetailsView will be used solely for inserting data, set the DetailsView's `DefaultMode` property to `Insert`.</span></span>

<span data-ttu-id="5ec06-197">這樣就全部完成了！</span><span class="sxs-lookup"><span data-stu-id="5ec06-197">That's all there is to it!</span></span> <span data-ttu-id="5ec06-198">讓我們來測試此頁面。</span><span class="sxs-lookup"><span data-stu-id="5ec06-198">Let's test this page.</span></span> <span data-ttu-id="5ec06-199">請透過瀏覽器造訪 `AddProduct.aspx`、輸入名稱和價格（請參閱 [圖 6]）。</span><span class="sxs-lookup"><span data-stu-id="5ec06-199">Visit `AddProduct.aspx` through a browser, enter a name and price (see Figure 6).</span></span>

<span data-ttu-id="5ec06-200">[![將新產品新增至資料庫](interacting-with-the-master-page-from-the-content-page-vb/_static/image17.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="5ec06-200">[![Add a New Product to the Database](interacting-with-the-master-page-from-the-content-page-vb/_static/image17.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image16.png)</span></span>

<span data-ttu-id="5ec06-201">**圖 06**：將新產品新增至資料庫（[按一下以觀看完整大小的影像](interacting-with-the-master-page-from-the-content-page-vb/_static/image18.png)）</span><span class="sxs-lookup"><span data-stu-id="5ec06-201">**Figure 06**: Add a New Product to the Database  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image18.png))</span></span>

<span data-ttu-id="5ec06-202">輸入新產品的名稱和價格之後，請按一下 [插入] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="5ec06-202">After typing in the name and price for your new product, click the Insert button.</span></span> <span data-ttu-id="5ec06-203">這會導致表單回傳。</span><span class="sxs-lookup"><span data-stu-id="5ec06-203">This causes the form to postback.</span></span> <span data-ttu-id="5ec06-204">在回傳時，會執行 SqlDataSource 控制項的 `INSERT` 語句;它的兩個參數會填入使用者在 DetailsView 的兩個 TextBox 控制項中輸入的值。</span><span class="sxs-lookup"><span data-stu-id="5ec06-204">On postback, the SqlDataSource control's `INSERT` statement is executed; its two parameters are populated with the user-entered values in the DetailsView's two TextBox controls.</span></span> <span data-ttu-id="5ec06-205">可惜的是，沒有任何視覺效果的意見反應表示已發生插入。</span><span class="sxs-lookup"><span data-stu-id="5ec06-205">Unfortunately, there is no visual feedback that an insert has occurred.</span></span> <span data-ttu-id="5ec06-206">顯示訊息，確認已加入新記錄是很好的做法。</span><span class="sxs-lookup"><span data-stu-id="5ec06-206">It would be nice to have a message displayed, confirming that a new record has been added.</span></span> <span data-ttu-id="5ec06-207">我將此做為讀者的練習。</span><span class="sxs-lookup"><span data-stu-id="5ec06-207">I leave this as an exercise for the reader.</span></span> <span data-ttu-id="5ec06-208">此外，從 DetailsView 新增記錄之後，主頁面中的 GridView 仍然會顯示與之前相同的五筆記錄;它不包含剛新增的記錄。</span><span class="sxs-lookup"><span data-stu-id="5ec06-208">Also, after adding a new record from the DetailsView the GridView in the master page still shows the same five records as before; it does not include the just-added record.</span></span> <span data-ttu-id="5ec06-209">我們將在接下來的步驟中探討如何解決此問題。</span><span class="sxs-lookup"><span data-stu-id="5ec06-209">We'll examine how to remedy this in the upcoming steps.</span></span>

> [!NOTE]
> <span data-ttu-id="5ec06-210">除了新增某種形式的視覺效果意見反應，插入已成功，我也建議您也更新 DetailsView 的插入介面，以包含驗證。</span><span class="sxs-lookup"><span data-stu-id="5ec06-210">In addition to adding some form of visual feedback that the insert has succeeded, I'd encourage you to also update the DetailsView's inserting interface to include validation.</span></span> <span data-ttu-id="5ec06-211">目前沒有驗證。</span><span class="sxs-lookup"><span data-stu-id="5ec06-211">Currently, there is no validation.</span></span> <span data-ttu-id="5ec06-212">如果使用者在 [`UnitPrice`] 欄位中輸入不正確值，例如「太昂貴」，當系統嘗試將該字串轉換成十進位時，就會在回傳時擲回例外狀況（exception）。</span><span class="sxs-lookup"><span data-stu-id="5ec06-212">If a user enters an invalid value for the `UnitPrice` field, such as "Too expensive," an exception will be thrown on postback when the system attempts to convert that string into a decimal.</span></span> <span data-ttu-id="5ec06-213">如需自訂插入介面的詳細資訊，請參閱[使用資料教學課程系列](../../data-access/index.md)中的[*自訂資料修改介面*教學](https://asp.net/learn/data-access/tutorial-20-vb.aspx)課程。</span><span class="sxs-lookup"><span data-stu-id="5ec06-213">For more information on customizing the inserting interface, refer to the [*Customizing the Data Modification Interface* tutorial](https://asp.net/learn/data-access/tutorial-20-vb.aspx) from my [Working with Data tutorial series](../../data-access/index.md).</span></span>

## <a name="step-3-creating-public-properties-and-methods-in-the-master-page"></a><span data-ttu-id="5ec06-214">步驟3：在主版頁面中建立公用屬性和方法</span><span class="sxs-lookup"><span data-stu-id="5ec06-214">Step 3: Creating Public Properties and Methods in the Master Page</span></span>

<span data-ttu-id="5ec06-215">在步驟1中，我們已在主版頁面中，將名為 `GridMessage` 的標籤 Web 控制項新增至 GridView。</span><span class="sxs-lookup"><span data-stu-id="5ec06-215">In Step 1 we added a Label Web control named `GridMessage` above the GridView in the master page.</span></span> <span data-ttu-id="5ec06-216">此標籤的目的是要選擇性地顯示訊息。</span><span class="sxs-lookup"><span data-stu-id="5ec06-216">This Label is intended to optionally display a message.</span></span> <span data-ttu-id="5ec06-217">例如，將新記錄加入至 `Products` 資料表之後，我們可能會想要顯示訊息：「*ProductName*已新增至資料庫」。</span><span class="sxs-lookup"><span data-stu-id="5ec06-217">For example, after adding a new record to the `Products` table, we might want to show a message that reads: "*ProductName* has been added to the database."</span></span> <span data-ttu-id="5ec06-218">我們不會在主版頁面中將此標籤的文字硬式編碼，而是要讓 [內容] 頁面可以自訂該訊息。</span><span class="sxs-lookup"><span data-stu-id="5ec06-218">Rather than hard-code the text for this Label in the master page, we might want the message to be customizable by the content page.</span></span>

<span data-ttu-id="5ec06-219">因為 Label 控制項會實作為主版頁面中受保護的成員變數，所以無法直接從內容頁面存取。</span><span class="sxs-lookup"><span data-stu-id="5ec06-219">Because the Label control is implemented as a protected member variable within the master page it cannot be accessed directly from content pages.</span></span> <span data-ttu-id="5ec06-220">若要從 [內容] 頁面使用主版頁面內的標籤（也就是，在主版頁面中的任何 Web 控制項），我們必須在主版頁面中建立公開該 Web 控制項的公用屬性，或作為其其中一個屬性可為的 proxy 存取.</span><span class="sxs-lookup"><span data-stu-id="5ec06-220">In order to work with the Label within a master page from the content page (or, for that matter, any Web control in the master page) we need to create a public property in the master page that exposes the Web control or serves as a proxy by which one of its properties can be accessed.</span></span> <span data-ttu-id="5ec06-221">將下列語法新增至主版頁面的程式碼後置類別，以公開卷標的 `Text` 屬性：</span><span class="sxs-lookup"><span data-stu-id="5ec06-221">Add the following syntax to the master page's code-behind class to expose the Label's `Text` property:</span></span>

[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample6.vb)]

<span data-ttu-id="5ec06-222">從內容頁面將新的記錄新增至 `Products` 資料表時，主版頁面中的 `RecentProducts` GridView 必須重新系結至其基礎資料來源。</span><span class="sxs-lookup"><span data-stu-id="5ec06-222">When a new record is added to the `Products` table from a content page the `RecentProducts` GridView in the master page needs to rebind to its underlying data source.</span></span> <span data-ttu-id="5ec06-223">若要重新系結 GridView，請呼叫其 `DataBind` 方法。</span><span class="sxs-lookup"><span data-stu-id="5ec06-223">To rebind the GridView call its `DataBind` method.</span></span> <span data-ttu-id="5ec06-224">因為主版頁面中的 GridView 無法以程式設計方式存取內容頁面，所以我們需要在主版頁面中建立公用方法，當呼叫它時，會將資料重新系結至 GridView。</span><span class="sxs-lookup"><span data-stu-id="5ec06-224">Because the GridView in the master page is not programmatically accessible to the content pages, we need to create a public method in the master page that, when called, rebinds the data to the GridView.</span></span> <span data-ttu-id="5ec06-225">將下列方法新增至主版頁面的程式碼後置類別：</span><span class="sxs-lookup"><span data-stu-id="5ec06-225">Add the following method to the master page's code-behind class:</span></span>

[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample7.vb)]

<span data-ttu-id="5ec06-226">當 `GridMessageText` 屬性和 `RefreshRecentProductsGrid` 方法備妥時，任何內容頁面都可以透過程式設計方式設定或讀取 `GridMessage` 標籤 `Text` 屬性的值，或將資料重新系結至 `RecentProducts` GridView。</span><span class="sxs-lookup"><span data-stu-id="5ec06-226">With the `GridMessageText` property and `RefreshRecentProductsGrid` method in place, any content page can programmatically set or read the value of the `GridMessage` Label's `Text` property or rebind the data to the `RecentProducts` GridView.</span></span> <span data-ttu-id="5ec06-227">步驟4會檢查如何從內容頁面存取主版頁面的公用屬性和方法。</span><span class="sxs-lookup"><span data-stu-id="5ec06-227">Step 4 examines how to access the master page's public properties and methods from a content page.</span></span>

> [!NOTE]
> <span data-ttu-id="5ec06-228">別忘了將主版頁面的屬性和方法標示為 `Public`。</span><span class="sxs-lookup"><span data-stu-id="5ec06-228">Don't forget to mark the master page's properties and methods as `Public`.</span></span> <span data-ttu-id="5ec06-229">如果您未明確將這些屬性和方法表示為 `Public`，就無法從 [內容] 頁面存取它們。</span><span class="sxs-lookup"><span data-stu-id="5ec06-229">If you do not explicitly denote these properties and methods as `Public`, they will not be accessible from the content page.</span></span>

## <a name="step-4-calling-the-master-pages-public-members-from-a-content-page"></a><span data-ttu-id="5ec06-230">步驟4：從內容頁面呼叫主版頁面的公用成員</span><span class="sxs-lookup"><span data-stu-id="5ec06-230">Step 4: Calling the Master Page's Public Members from a Content Page</span></span>

<span data-ttu-id="5ec06-231">既然主版頁面具有必要的公用屬性和方法，我們就準備好從 `AddProduct.aspx` 內容頁面叫用這些屬性和方法。</span><span class="sxs-lookup"><span data-stu-id="5ec06-231">Now that the master page has the necessary public properties and methods, we're ready to invoke these properties and methods from the `AddProduct.aspx` content page.</span></span> <span data-ttu-id="5ec06-232">具體而言，我們需要設定主版頁面的 `GridMessageText` 屬性，並在新產品新增至資料庫之後，呼叫其 `RefreshRecentProductsGrid` 方法。</span><span class="sxs-lookup"><span data-stu-id="5ec06-232">Specifically, we need to set the master page's `GridMessageText` property and call its `RefreshRecentProductsGrid` method after the new product has been added to the database.</span></span> <span data-ttu-id="5ec06-233">所有的 ASP.NET 資料 Web 控制項都會在完成各種工作之前和之後引發事件，讓網頁開發人員輕鬆地在工作之前或之後採取一些程式設計動作。</span><span class="sxs-lookup"><span data-stu-id="5ec06-233">All the ASP.NET data Web controls fire events immediately before and after completing various tasks, which make it easy for page developers to take some programmatic action either before or after the task.</span></span> <span data-ttu-id="5ec06-234">例如，當使用者按一下 DetailsView 的 [插入] 按鈕時，在回傳時，DetailsView 會在開始插入工作流程之前引發其 `ItemInserting` 事件。</span><span class="sxs-lookup"><span data-stu-id="5ec06-234">For example, when the end user clicks the DetailsView's Insert button, on postback the DetailsView raises its `ItemInserting` event before beginning the inserting workflow.</span></span> <span data-ttu-id="5ec06-235">然後，它會將記錄插入資料庫中。</span><span class="sxs-lookup"><span data-stu-id="5ec06-235">It then inserts the record into the database.</span></span> <span data-ttu-id="5ec06-236">之後，DetailsView 會引發它的 `ItemInserted` 事件。</span><span class="sxs-lookup"><span data-stu-id="5ec06-236">Following that, the DetailsView raises its `ItemInserted` event.</span></span> <span data-ttu-id="5ec06-237">因此，若要在新增產品之後使用主版頁面，請為 DetailsView 的 `ItemInserted` 事件建立事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="5ec06-237">Therefore, in order to work with the master page after the new product has been added, create an event handler for the DetailsView's `ItemInserted` event.</span></span>

<span data-ttu-id="5ec06-238">有兩種方式可讓內容頁面以程式設計方式與主版頁面互動：</span><span class="sxs-lookup"><span data-stu-id="5ec06-238">There are two ways that a content page can programmatically interface with its master page:</span></span>

- <span data-ttu-id="5ec06-239">使用 `Page.Master` 屬性，它會將鬆散類型的參考傳回主版頁面，或</span><span class="sxs-lookup"><span data-stu-id="5ec06-239">Using the `Page.Master` property, which returns a loosely-typed reference to the master page, or</span></span>
- <span data-ttu-id="5ec06-240">透過 `@MasterType` 指示詞指定頁面的主版頁面類型或檔案路徑;這會自動將強型別屬性加入至名為 `Master`的頁面。</span><span class="sxs-lookup"><span data-stu-id="5ec06-240">Specify the page's master page type or file path via a `@MasterType` directive; this automatically adds a strongly-typed property to the page named `Master`.</span></span>

<span data-ttu-id="5ec06-241">讓我們來探討這兩種方法。</span><span class="sxs-lookup"><span data-stu-id="5ec06-241">Let's examine both approaches.</span></span>

### <a name="using-the-loosely-typedpagemasterproperty"></a><span data-ttu-id="5ec06-242">使用鬆散類型的`Page.Master`屬性</span><span class="sxs-lookup"><span data-stu-id="5ec06-242">Using the Loosely-Typed`Page.Master`Property</span></span>

<span data-ttu-id="5ec06-243">所有 ASP.NET 的網頁都必須衍生自位於 `System.Web.UI` 命名空間的 `Page` 類別。</span><span class="sxs-lookup"><span data-stu-id="5ec06-243">All ASP.NET web pages must derive from the `Page` class, which is located in the `System.Web.UI` namespace.</span></span> <span data-ttu-id="5ec06-244">`Page` 類別包含[`Master` 屬性](https://msdn.microsoft.com/library/system.web.ui.page.master.aspx)，可傳回頁面主版頁面的參考。</span><span class="sxs-lookup"><span data-stu-id="5ec06-244">The `Page` class includes a [`Master` property](https://msdn.microsoft.com/library/system.web.ui.page.master.aspx) that returns a reference to the page's master page.</span></span> <span data-ttu-id="5ec06-245">如果頁面沒有主版頁面 `Master` 會傳回 `Nothing`。</span><span class="sxs-lookup"><span data-stu-id="5ec06-245">If the page does not have a master page `Master` returns `Nothing`.</span></span>

<span data-ttu-id="5ec06-246">`Master` 屬性會傳回類型為[`MasterPage`](https://msdn.microsoft.com/library/system.web.ui.masterpage.aspx) （也位於 `System.Web.UI` 命名空間）的物件，這是所有主頁面衍生來源的基底類型。</span><span class="sxs-lookup"><span data-stu-id="5ec06-246">The `Master` property returns an object of type [`MasterPage`](https://msdn.microsoft.com/library/system.web.ui.masterpage.aspx) (also located in the `System.Web.UI` namespace) which is the base type from which all master pages derive from.</span></span> <span data-ttu-id="5ec06-247">因此，若要使用在網站主版頁面中定義的公用屬性或方法，我們必須將從 `Master` 屬性傳回的 `MasterPage` 物件，轉換為適當的型別。</span><span class="sxs-lookup"><span data-stu-id="5ec06-247">Therefore, to use public properties or methods defined in our website's master page we must cast the `MasterPage` object returned from the `Master` property to the appropriate type.</span></span> <span data-ttu-id="5ec06-248">因為我們將主版分頁檔命名為 `Site.master`，所以程式碼後置類別的名稱 `Site`。</span><span class="sxs-lookup"><span data-stu-id="5ec06-248">Because we named our master page file `Site.master`, the code-behind class was named `Site`.</span></span> <span data-ttu-id="5ec06-249">因此，下列程式碼會將 `Page.Master` 屬性轉換為 `Site` 類別的實例。</span><span class="sxs-lookup"><span data-stu-id="5ec06-249">Therefore, the following code casts the `Page.Master` property to an instance of the `Site` class.</span></span>

[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample8.vb)]

<span data-ttu-id="5ec06-250">既然我們已將鬆散類型的 `Page.Master` 屬性轉換至網站類型，我們就可以參考網站特定的屬性和方法。</span><span class="sxs-lookup"><span data-stu-id="5ec06-250">Now that we have casted the loosely-typed `Page.Master` property to the Site type we can reference the properties and methods specific to Site.</span></span> <span data-ttu-id="5ec06-251">如 [圖 7] 所示，[公用] 屬性 `GridMessageText` 會出現在 [IntelliSense] 下拉式集中。</span><span class="sxs-lookup"><span data-stu-id="5ec06-251">As Figure 7 shows, the public property `GridMessageText` appears in the IntelliSense drop-down.</span></span>

<span data-ttu-id="5ec06-252">[![IntelliSense 顯示主版頁面的公用屬性和方法](interacting-with-the-master-page-from-the-content-page-vb/_static/image20.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="5ec06-252">[![IntelliSense Shows our Master Page's Public Properties and Methods](interacting-with-the-master-page-from-the-content-page-vb/_static/image20.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image19.png)</span></span>

<span data-ttu-id="5ec06-253">**圖 07**： IntelliSense 顯示主版頁面的公用屬性和方法（[按一下以查看完整大小的影像](interacting-with-the-master-page-from-the-content-page-vb/_static/image21.png)）</span><span class="sxs-lookup"><span data-stu-id="5ec06-253">**Figure 07**: IntelliSense Shows our Master Page's Public Properties and Methods ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image21.png))</span></span>

> [!NOTE]
> <span data-ttu-id="5ec06-254">如果您將主版分頁檔命名為 `MasterPage.master` 則會 `MasterPage`主版頁面的程式碼後置類別名稱。</span><span class="sxs-lookup"><span data-stu-id="5ec06-254">If you named your master page file `MasterPage.master` then the master page's code-behind class name is `MasterPage`.</span></span> <span data-ttu-id="5ec06-255">從類型 `System.Web.UI.MasterPage` 轉換成您的 `MasterPage` 類別時，這可能會導致不明確的程式碼。</span><span class="sxs-lookup"><span data-stu-id="5ec06-255">This can lead to ambiguous code when casting from the type `System.Web.UI.MasterPage` to your `MasterPage` class.</span></span> <span data-ttu-id="5ec06-256">簡單地說，您必須完整限定要轉換成的類型，這在使用網站專案模型時可能有點困難。</span><span class="sxs-lookup"><span data-stu-id="5ec06-256">In short, you need to fully qualify the type you are casting to, which can be a little tricky when using the Web Site Project model.</span></span> <span data-ttu-id="5ec06-257">我的建議是確定當您建立主版頁面時，您將它命名為 `MasterPage.master` 或更好的名稱，以建立主版頁面的強型別參考。</span><span class="sxs-lookup"><span data-stu-id="5ec06-257">My suggestion would be to either make sure that when you create your master page you name it something other than `MasterPage.master` or, even better, create a strongly-typed reference to the master page.</span></span>

### <a name="creating-a-strongly-typed-reference-with-themastertypedirective"></a><span data-ttu-id="5ec06-258">使用`@MasterType`指示詞建立強型別參考</span><span class="sxs-lookup"><span data-stu-id="5ec06-258">Creating a Strongly-Typed Reference with the`@MasterType`Directive</span></span>

<span data-ttu-id="5ec06-259">如果您仔細查看，您可以看到 ASP.NET 網頁的程式碼後置類別是部分類別（請注意類別定義中的 `Partial` 關鍵字）。</span><span class="sxs-lookup"><span data-stu-id="5ec06-259">If you look closely you can see that an ASP.NET page's code-behind class is a partial class (note the `Partial` keyword in the class definition).</span></span> <span data-ttu-id="5ec06-260">部分類別是在和C# Visual Basic with.NET Framework 2.0 中引進，簡而言之，允許在多個檔案之間定義類別的成員。</span><span class="sxs-lookup"><span data-stu-id="5ec06-260">Partial classes were introduced in C# and Visual Basic with.NET Framework 2.0 and, in a nutshell, allow for a class's members to be defined across multiple files.</span></span> <span data-ttu-id="5ec06-261">程式碼後置類別檔案 `AddProduct.aspx.vb`，例如，包含我們的網頁開發人員所建立的程式碼。</span><span class="sxs-lookup"><span data-stu-id="5ec06-261">The code-behind class file - `AddProduct.aspx.vb`, for example - contains the code that we, the page developer, create.</span></span> <span data-ttu-id="5ec06-262">除了我們的程式碼之外，ASP.NET 引擎會在中自動建立具有屬性和事件處理常式的個別類別檔案，將宣告式標記轉譯成頁面的類別階層。</span><span class="sxs-lookup"><span data-stu-id="5ec06-262">In addition to our code, the ASP.NET engine automatically creates a separate class file with properties and event handlers in that translate the declarative markup into the page's class hierarchy.</span></span>

<span data-ttu-id="5ec06-263">每當流覽 ASP.NET 網頁時，就會產生自動產生程式碼，鋪路一種方法來取得一些有趣且有用的可能性。</span><span class="sxs-lookup"><span data-stu-id="5ec06-263">The automatic code generation that occurs whenever an ASP.NET page is visited paves the way for some rather interesting and useful possibilities.</span></span> <span data-ttu-id="5ec06-264">在主版頁面的案例中，如果我們告訴 ASP.NET engine 內容頁面正在使用哪一個主版頁面，就會為我們產生強型別 `Master` 屬性。</span><span class="sxs-lookup"><span data-stu-id="5ec06-264">In the case of master pages, if we tell the ASP.NET engine what master page is being used by our content page it generates a strongly-typed `Master` property for us.</span></span>

<span data-ttu-id="5ec06-265">使用[`@MasterType`](https://msdn.microsoft.com/library/ms228274.aspx)指示詞來通知 ASP.NET 引擎內容頁面的主版頁面類型。</span><span class="sxs-lookup"><span data-stu-id="5ec06-265">Use the [`@MasterType` directive](https://msdn.microsoft.com/library/ms228274.aspx) to inform the ASP.NET engine of the content page's master page type.</span></span> <span data-ttu-id="5ec06-266">`@MasterType` 指示詞可以接受主版頁面的類型名稱或其檔案路徑。</span><span class="sxs-lookup"><span data-stu-id="5ec06-266">The `@MasterType` directive can accept either the type name of the master page or its file path.</span></span> <span data-ttu-id="5ec06-267">若要指定 [`AddProduct.aspx`] 頁面使用 `Site.master` 作為其主版頁面，請將下列指示詞新增至 `AddProduct.aspx`的頂端：</span><span class="sxs-lookup"><span data-stu-id="5ec06-267">To specify that the `AddProduct.aspx` page uses `Site.master` as its master page, add the following directive to the top of `AddProduct.aspx`:</span></span>

[!code-aspx[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample9.aspx)]

<span data-ttu-id="5ec06-268">這個指示詞會指示 ASP.NET 引擎透過名為 `Master`的屬性，將強型別參考新增至主版頁面。</span><span class="sxs-lookup"><span data-stu-id="5ec06-268">This directive instructs the ASP.NET engine to add a strongly-typed reference to the master page through a property named `Master`.</span></span> <span data-ttu-id="5ec06-269">備妥 `@MasterType` 指示詞之後，我們就可以直接透過 `Master` 屬性呼叫 `Site.master` 主版頁面的公用屬性和方法，而不需要任何轉換。</span><span class="sxs-lookup"><span data-stu-id="5ec06-269">With the `@MasterType` directive in place, we can call the `Site.master` master page's public properties and methods directly through the `Master` property without any casts.</span></span>

> [!NOTE]
> <span data-ttu-id="5ec06-270">如果您省略 `@MasterType` 指示詞，語法 `Page.Master` 和 `Master` 會傳回相同的內容：頁面主版頁面的鬆散類型物件。</span><span class="sxs-lookup"><span data-stu-id="5ec06-270">If you omit the `@MasterType` directive, the syntax `Page.Master` and `Master` return the same thing: a loosely-typed object to the page's master page.</span></span> <span data-ttu-id="5ec06-271">如果您包含 `@MasterType` 指示詞，則 `Master` 會傳回指定之主版頁面的強型別參考。</span><span class="sxs-lookup"><span data-stu-id="5ec06-271">If you include the `@MasterType` directive then `Master` returns a strongly-typed reference to the specified master page.</span></span> <span data-ttu-id="5ec06-272">不過，`Page.Master`仍會傳回鬆散類型的參考。</span><span class="sxs-lookup"><span data-stu-id="5ec06-272">`Page.Master`, however, still returns a loosely-typed reference.</span></span> <span data-ttu-id="5ec06-273">如需深入瞭解為什麼會發生這種情況，以及在包含 `@MasterType` 指示詞時如何建立 `Master` 屬性，請參閱[ASP.NET 2.0 中](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx)的[Allen](http://odetocode.com/blogs/scott/default.aspx)的 blog 專案`@MasterType`。</span><span class="sxs-lookup"><span data-stu-id="5ec06-273">For a more thorough look at why this is the case and how the `Master` property is constructed when the `@MasterType` directive is included, see [K. Scott Allen](http://odetocode.com/blogs/scott/default.aspx)'s blog entry [`@MasterType` in ASP.NET 2.0](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx).</span></span>

### <a name="updating-the-master-page-after-adding-a-new-product"></a><span data-ttu-id="5ec06-274">新增新產品後更新主版頁面</span><span class="sxs-lookup"><span data-stu-id="5ec06-274">Updating the Master Page After Adding a New Product</span></span>

<span data-ttu-id="5ec06-275">既然我們已經知道如何從內容頁面叫用主版頁面的公用屬性和方法，我們就準備好更新 `AddProduct.aspx` 頁面，讓主版頁面在加入新產品之後重新整理。</span><span class="sxs-lookup"><span data-stu-id="5ec06-275">Now that we know how to invoke a master page's public properties and methods from a content page, we're ready to update the `AddProduct.aspx` page so that the master page is refreshed after adding a new product.</span></span> <span data-ttu-id="5ec06-276">在步驟4的開頭，我們為 DetailsView 控制項的 `ItemInserting` 事件建立了事件處理常式，這會在新產品新增至資料庫之後立即執行。</span><span class="sxs-lookup"><span data-stu-id="5ec06-276">At the beginning of Step 4 we created an event handler for the DetailsView control's `ItemInserting` event, which executes immediately after the new product has been added to the database.</span></span> <span data-ttu-id="5ec06-277">將以下程式碼新增至該事件處理常式：</span><span class="sxs-lookup"><span data-stu-id="5ec06-277">Add the following code to that event handler:</span></span>

[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample10.vb)]

<span data-ttu-id="5ec06-278">上述程式碼會同時使用鬆散類型的 `Page.Master` 屬性和強型別的 `Master` 屬性。</span><span class="sxs-lookup"><span data-stu-id="5ec06-278">The above code uses both the loosely-typed `Page.Master` property and the strongly-typed `Master` property.</span></span> <span data-ttu-id="5ec06-279">請注意，`GridMessageText` 屬性會設定為「*ProductName*已加入至方格 ...」剛新增的產品值可透過 `e.Values` 集合來存取;如您所見，剛新增的 `ProductName` 值是透過 `e.Values("ProductName")`來存取。</span><span class="sxs-lookup"><span data-stu-id="5ec06-279">Note that the `GridMessageText` property is set to "*ProductName* added to grid..." The just-added product's values are accessible through the `e.Values` collection; as you can see, the just-added `ProductName` value is accessed via `e.Values("ProductName")`.</span></span>

<span data-ttu-id="5ec06-280">[圖 8] 顯示了新產品-Scott 的 Soda 之後的 `AddProduct.aspx` 頁面-已新增至資料庫。</span><span class="sxs-lookup"><span data-stu-id="5ec06-280">Figure 8 shows the `AddProduct.aspx` page immediately after a new product - Scott's Soda - has been added to the database.</span></span> <span data-ttu-id="5ec06-281">請注意，剛新增的產品名稱會在主版頁面的標籤中注明，而 GridView 已重新整理成包含產品和價格。</span><span class="sxs-lookup"><span data-stu-id="5ec06-281">Note that the just-added product name is noted in the master page's Label and that the GridView has been refreshed to include the product and its price.</span></span>

<span data-ttu-id="5ec06-282">[![主版頁面的標籤和 GridView 顯示剛新增的產品](interacting-with-the-master-page-from-the-content-page-vb/_static/image23.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="5ec06-282">[![The Master Page's Label and GridView Show the Just-Added Product](interacting-with-the-master-page-from-the-content-page-vb/_static/image23.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image22.png)</span></span>

<span data-ttu-id="5ec06-283">**圖 08**：主版頁面的標籤和 GridView 顯示剛新增的產品（[按一下以觀看完整大小的影像](interacting-with-the-master-page-from-the-content-page-vb/_static/image24.png)）</span><span class="sxs-lookup"><span data-stu-id="5ec06-283">**Figure 08**: The Master Page's Label and GridView Show the Just-Added Product ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image24.png))</span></span>

## <a name="summary"></a><span data-ttu-id="5ec06-284">總結</span><span class="sxs-lookup"><span data-stu-id="5ec06-284">Summary</span></span>

<span data-ttu-id="5ec06-285">在理想情況下，主版頁面和其內容頁面會彼此獨立，而且不需要任何層級的互動。</span><span class="sxs-lookup"><span data-stu-id="5ec06-285">Ideally, a master page and its content pages are completely separate from one another and require no level of interaction.</span></span> <span data-ttu-id="5ec06-286">雖然主版頁面和內容頁面的設計應該要考慮該目標，但有一些常見的情況是內容頁面必須與主版頁面互動。</span><span class="sxs-lookup"><span data-stu-id="5ec06-286">While master pages and content pages should be designed with that goal in mind, there are a number of common scenarios in which a content page must interface with its master page.</span></span> <span data-ttu-id="5ec06-287">其中一個最常見的原因，是根據 [內容] 頁面中過了的某個動作，來更新主版頁面顯示的特定部分。</span><span class="sxs-lookup"><span data-stu-id="5ec06-287">One of the most common reasons centers around updating a particular portion of the master page display based on some action that transpired in the content page.</span></span>

<span data-ttu-id="5ec06-288">好消息是，讓內容頁面以程式設計方式與主版頁面互動，是相當直接的。</span><span class="sxs-lookup"><span data-stu-id="5ec06-288">The good news is that it's relatively straightforward to have a content page programmatically interact with its master page.</span></span> <span data-ttu-id="5ec06-289">一開始請先在主版頁面中建立公用屬性或方法，以封裝內容頁面必須叫用的功能。</span><span class="sxs-lookup"><span data-stu-id="5ec06-289">Start by creating public properties or methods in the master page that encapsulate the functionality that needs to be invoked by a content page.</span></span> <span data-ttu-id="5ec06-290">然後，在 [內容] 頁面中，透過鬆散類型的 `Page.Master` 屬性來存取主版頁面的屬性和方法，或使用 `@MasterType` 指示詞來建立主版頁面的強型別參考。</span><span class="sxs-lookup"><span data-stu-id="5ec06-290">Then, in the content page, access the master page's properties and methods through the loosely-typed `Page.Master` property or use the `@MasterType` directive to create a strongly-typed reference to the master page.</span></span>

<span data-ttu-id="5ec06-291">在下一個教學課程中，我們將探討如何讓主版頁面以程式設計方式與其中一個內容頁面互動。</span><span class="sxs-lookup"><span data-stu-id="5ec06-291">In the next tutorial we examine how to have the master page programmatically interact with one of its content pages.</span></span>

<span data-ttu-id="5ec06-292">快樂的程式設計！</span><span class="sxs-lookup"><span data-stu-id="5ec06-292">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="5ec06-293">進一步閱讀</span><span class="sxs-lookup"><span data-stu-id="5ec06-293">Further Reading</span></span>

<span data-ttu-id="5ec06-294">如需本教學課程中所討論之主題的詳細資訊，請參閱下列資源：</span><span class="sxs-lookup"><span data-stu-id="5ec06-294">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="5ec06-295">存取和更新 ASP.NET 中的資料</span><span class="sxs-lookup"><span data-stu-id="5ec06-295">Accessing and Updating Data in ASP.NET</span></span>](http://aspnet.4guysfromrolla.com/articles/011106-1.aspx)
- [<span data-ttu-id="5ec06-296">ASP.NET 主版頁面：秘訣、訣竅和陷阱</span><span class="sxs-lookup"><span data-stu-id="5ec06-296">ASP.NET Master Pages: Tips, Tricks, and Traps</span></span>](http://www.odetocode.com/articles/450.aspx)
- [<span data-ttu-id="5ec06-297">ASP.NET 2.0 中的 `@MasterType`</span><span class="sxs-lookup"><span data-stu-id="5ec06-297">`@MasterType` in ASP.NET 2.0</span></span>](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx)
- [<span data-ttu-id="5ec06-298">在內容和主版頁面之間傳遞資訊</span><span class="sxs-lookup"><span data-stu-id="5ec06-298">Passing Information Between Content and Master Pages</span></span>](http://aspnet.4guysfromrolla.com/articles/013107-1.aspx)
- [<span data-ttu-id="5ec06-299">使用 ASP.NET 教學課程中的資料</span><span class="sxs-lookup"><span data-stu-id="5ec06-299">Working with Data in ASP.NET Tutorials</span></span>](../../data-access/index.md)

### <a name="about-the-author"></a><span data-ttu-id="5ec06-300">關於作者</span><span class="sxs-lookup"><span data-stu-id="5ec06-300">About the Author</span></span>

<span data-ttu-id="5ec06-301">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，自1998起，有多個 ASP/ASP. NET 書籍和創辦人的4GuysFromRolla.com。</span><span class="sxs-lookup"><span data-stu-id="5ec06-301">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="5ec06-302">Scott 以獨立的顧問、訓練員和作者的身分運作。</span><span class="sxs-lookup"><span data-stu-id="5ec06-302">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="5ec06-303">他的最新著作是[*在24小時內讓自己的 ASP.NET 3.5*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="5ec06-303">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="5ec06-304">Scott 可以在[mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)或透過他在[http://ScottOnWriting.NET](http://scottonwriting.net/)的 blog。</span><span class="sxs-lookup"><span data-stu-id="5ec06-304">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="5ec06-305">特別感謝</span><span class="sxs-lookup"><span data-stu-id="5ec06-305">Special Thanks To</span></span>

<span data-ttu-id="5ec06-306">本教學課程系列已由許多有用的審核者所審查。</span><span class="sxs-lookup"><span data-stu-id="5ec06-306">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="5ec06-307">本教學課程的領導審查員是 Zack 的。</span><span class="sxs-lookup"><span data-stu-id="5ec06-307">Lead reviewer for this tutorial was Zack Jones.</span></span> <span data-ttu-id="5ec06-308">有興趣複習我即將發行的 MSDN 文章嗎？</span><span class="sxs-lookup"><span data-stu-id="5ec06-308">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="5ec06-309">若是如此，請在[mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)下拉一行</span><span class="sxs-lookup"><span data-stu-id="5ec06-309">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="5ec06-310">[上一頁](control-id-naming-in-content-pages-vb.md)
> [下一頁](interacting-with-the-content-page-from-the-master-page-vb.md)</span><span class="sxs-lookup"><span data-stu-id="5ec06-310">[Previous](control-id-naming-in-content-pages-vb.md)
[Next](interacting-with-the-content-page-from-the-master-page-vb.md)</span></span>
