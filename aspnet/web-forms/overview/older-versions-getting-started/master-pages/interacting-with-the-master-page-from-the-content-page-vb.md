---
uid: web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-master-page-from-the-content-page-vb
title: 從 [內容] 頁面 (VB) 的主版頁面與互動 |Microsoft Docs
author: rick-anderson
description: 檢驗如何呼叫方法，從 [內容] 頁面中的程式碼中設定屬性等的主版頁面。
ms.author: riande
ms.date: 07/11/2008
ms.assetid: 081fe010-ba0f-4e7d-b4ba-774840b601c2
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-master-page-from-the-content-page-vb
msc.type: authoredcontent
ms.openlocfilehash: 04642dbcd62fe24d4e0fa379b90cbf4122c57066
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 05/06/2019
ms.locfileid: "65134069"
---
# <a name="interacting-with-the-master-page-from-the-content-page-vb"></a><span data-ttu-id="e9f07-103">從內容頁面與主版頁互動 (VB)</span><span class="sxs-lookup"><span data-stu-id="e9f07-103">Interacting with the Master Page from the Content Page (VB)</span></span>

<span data-ttu-id="e9f07-104">藉由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="e9f07-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="e9f07-105">[下載程式碼](http://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_06_VB.zip)或[下載 PDF](http://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_06_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="e9f07-105">[Download Code](http://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_06_VB.zip) or [Download PDF](http://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_06_VB.pdf)</span></span>

> <span data-ttu-id="e9f07-106">檢驗如何呼叫方法，從 [內容] 頁面中的程式碼中設定屬性等的主版頁面。</span><span class="sxs-lookup"><span data-stu-id="e9f07-106">Examines how to call methods, set properties, etc. of the Master Page from code in the Content Page.</span></span>

## <a name="introduction"></a><span data-ttu-id="e9f07-107">簡介</span><span class="sxs-lookup"><span data-stu-id="e9f07-107">Introduction</span></span>

<span data-ttu-id="e9f07-108">過去五個教學課程的課程，我們已討論過如何建立主版頁面、 定義內容區域、 繫結的 ASP.NET 頁面主版頁面，然後定義頁面特定內容。</span><span class="sxs-lookup"><span data-stu-id="e9f07-108">Over the course of the past five tutorials we have looked at how to create a master page, define content regions, bind ASP.NET pages to a master page, and define page-specific content.</span></span> <span data-ttu-id="e9f07-109">當訪客要求特定的內容頁面時，會在執行階段，導致 統一的控制項階層架構的轉譯融合內容和主版頁面的標記。</span><span class="sxs-lookup"><span data-stu-id="e9f07-109">When a visitor requests a particular content page, the content and master pages' markup are fused at runtime, resulting in the rendering of a unified control hierarchy.</span></span> <span data-ttu-id="e9f07-110">因此，我們已經看過其中一個方法可以互動的主版頁面和其內容頁面的其中一個: [內容] 頁面詳細說明要 transfuse 主版頁面的 ContentPlaceHolder 控制項的標記。</span><span class="sxs-lookup"><span data-stu-id="e9f07-110">Therefore, we have already seen one way in which the master page and one of its content pages can interact: the content page spells out the markup to transfuse into the master page's ContentPlaceHolder controls.</span></span>

<span data-ttu-id="e9f07-111">我們的成果尚未檢查是主版頁面和內容頁面可以互動方式以程式設計的方式。</span><span class="sxs-lookup"><span data-stu-id="e9f07-111">What we have yet to examine is how the master page and content page can interact programmatically.</span></span> <span data-ttu-id="e9f07-112">除了定義的主版頁面 ContentPlaceHolder 控制項的標記，內容頁面也可以將值指派給其主版頁面的公用屬性，並叫用它的公用方法。</span><span class="sxs-lookup"><span data-stu-id="e9f07-112">In addition to defining the markup for the master page's ContentPlaceHolder controls, a content page can also assign values to its master page's public properties and invoke its public methods.</span></span> <span data-ttu-id="e9f07-113">同樣地，可能會與其內容頁互動主版頁面。</span><span class="sxs-lookup"><span data-stu-id="e9f07-113">Similarly, a master page may interact with its content pages.</span></span> <span data-ttu-id="e9f07-114">較不常見，其宣告式標記之間的互動比以程式設計方式互動的主要和內容頁面時，有許多情況下，需要這類程式設計互動的位置。</span><span class="sxs-lookup"><span data-stu-id="e9f07-114">While programmatic interaction between a master and content page is less common than the interaction between their declarative markups, there are many scenarios where such programmatic interaction is needed.</span></span>

<span data-ttu-id="e9f07-115">在本教學課程中我們將探討如何以程式設計方式進行內容的頁面互動與其主版頁面;在下一個教學課程中，我們將探討主版頁面可以同樣的互動方式使用其內容的頁面。</span><span class="sxs-lookup"><span data-stu-id="e9f07-115">In this tutorial we examine how a content page can programmatically interact with its master page; in the next tutorial we will look at how the master page can similarly interact with its content pages.</span></span>

## <a name="examples-of-programmatic-interaction-between-a-content-page-and-its-master-page"></a><span data-ttu-id="e9f07-116">內容頁面和其主版頁面的程式設計互動的範例</span><span class="sxs-lookup"><span data-stu-id="e9f07-116">Examples of Programmatic Interaction Between a Content Page and its Master Page</span></span>

<span data-ttu-id="e9f07-117">當特定頁面的需要設定頁面的頁面為基礎時，我們會使用 ContentPlaceHolder 控制項。</span><span class="sxs-lookup"><span data-stu-id="e9f07-117">When a particular region of a page needs to be configured on a page-by-page basis, we use a ContentPlaceHolder control.</span></span> <span data-ttu-id="e9f07-118">但大部分的網頁需要發出特定的輸出，但一小部分的頁面的情況下需要加以自訂以顯示其他東西呢？</span><span class="sxs-lookup"><span data-stu-id="e9f07-118">But what about situations where the majority of pages need to emit a certain output, but a small number of pages need to customize it to show something else?</span></span> <span data-ttu-id="e9f07-119">其中一個範例，我們在中檢查這[*多個 ContentPlaceHolders 和預設內容*](multiple-contentplaceholders-and-default-content-vb.md)教學課程中，牽涉到每個頁面上顯示登入介面。</span><span class="sxs-lookup"><span data-stu-id="e9f07-119">One such example, which we examined in the [*Multiple ContentPlaceHolders and Default Content*](multiple-contentplaceholders-and-default-content-vb.md) tutorial, involves displaying a login interface on each page.</span></span> <span data-ttu-id="e9f07-120">雖然大部分頁面都應該包含登入介面，它應該隱藏少數幾個頁面，例如： 主要登入頁面 (`Login.aspx`); 建立帳戶 頁面中，與其他頁面，才可存取已驗證的使用者。</span><span class="sxs-lookup"><span data-stu-id="e9f07-120">While most pages should include a login interface, it should be suppressed for a handful of pages, such as: the main login page (`Login.aspx`); the Create Account page; and other pages that are only accessible to authenticated users.</span></span> <span data-ttu-id="e9f07-121">[*多個 ContentPlaceHolders 和預設內容*](multiple-contentplaceholders-and-default-content-vb.md)教學課程示範了如何為 ContentPlaceHolder 主版頁面中定義的預設內容，然後如何覆寫它，這些頁面的位置預設的內容已不想要的。</span><span class="sxs-lookup"><span data-stu-id="e9f07-121">The [*Multiple ContentPlaceHolders and Default Content*](multiple-contentplaceholders-and-default-content-vb.md) tutorial showed how to define the default content for a ContentPlaceHolder in the master page and then how to override it in those pages where the default content was not wanted.</span></span>

<span data-ttu-id="e9f07-122">另一個選項是建立的公用屬性或主版頁面，指出是否要顯示或隱藏登入介面中的方法。</span><span class="sxs-lookup"><span data-stu-id="e9f07-122">Another option is to create a public property or method within the master page that indicates whether to show or hide the login interface.</span></span> <span data-ttu-id="e9f07-123">例如，主版頁面可能包含名為公用屬性`ShowLoginUI`其值用來設定`Visible`主版頁面中的登入控制項的屬性。</span><span class="sxs-lookup"><span data-stu-id="e9f07-123">For example, the master page might include a public property named `ShowLoginUI` whose value was used to set the `Visible` property of the Login control in the master page.</span></span> <span data-ttu-id="e9f07-124">然後可以透過程式設計方式設定這些登入使用者介面應該隱藏其中的內容頁面`ShowLoginUI`屬性設`False`。</span><span class="sxs-lookup"><span data-stu-id="e9f07-124">Those content pages where the login user interface should be suppressed could then programmatically set the `ShowLoginUI` property to `False`.</span></span>

<span data-ttu-id="e9f07-125">可能是主版頁面需要重新整理後的某些動作發生在 [內容] 頁面中顯示的資料時，就會發生的內容和主版頁面互動最常見的範例。</span><span class="sxs-lookup"><span data-stu-id="e9f07-125">Perhaps the most common example of content and master page interaction occurs when data displayed in the master page needs to be refreshed after some action has transpired in the content page.</span></span> <span data-ttu-id="e9f07-126">請考慮從特定的資料庫資料表時，主版頁面，其中包含的 GridView 會顯示五個最近新增的記錄，其中一種其內容頁包含的介面，將新記錄新增至該相同的資料表。</span><span class="sxs-lookup"><span data-stu-id="e9f07-126">Consider a master page that includes a GridView that displays the five most recently added records from a particular database table, and that one of its content pages includes an interface for adding new records to that same table.</span></span>

<span data-ttu-id="e9f07-127">當使用者造訪的頁面，即可加入新的記錄時，她會看到五個最新加入的主版頁面中顯示的記錄。</span><span class="sxs-lookup"><span data-stu-id="e9f07-127">When a user visits the page to add a new record, she sees the five most recently added records displayed in the master page.</span></span> <span data-ttu-id="e9f07-128">之後填入新資料錄的資料行的值，她送出表單。</span><span class="sxs-lookup"><span data-stu-id="e9f07-128">After filling in the values for the new record's columns, she submits the form.</span></span> <span data-ttu-id="e9f07-129">假設 GridView 的主版頁面中有其`EnableViewState`屬性設為 True （預設值），其內容會重新載入從檢視狀態，即使較新的記錄剛新增到資料庫，因此，顯示五個相同的資料錄。</span><span class="sxs-lookup"><span data-stu-id="e9f07-129">Assuming that the GridView in the master page has its `EnableViewState` property set to True (the default), its content is reloaded from view state and, consequently, the five same records are displayed even though a newer record was just added to the database.</span></span> <span data-ttu-id="e9f07-130">這可能會混淆使用者。</span><span class="sxs-lookup"><span data-stu-id="e9f07-130">This may confuse the user.</span></span>

> [!NOTE]
> <span data-ttu-id="e9f07-131">即使您停用 GridView 的檢視狀態，讓它重新繫結至每個回傳上其基礎資料來源時，它仍不會顯示剛加入的資料錄因為資料繫結至 GridView 稍早在網頁生命週期，比新記錄新增至資料庫物件時ase。</span><span class="sxs-lookup"><span data-stu-id="e9f07-131">Even if you disable the GridView's view state so that it rebinds to its underlying data source on every postback, it still won't show the just-added record because the data is bound to the GridView earlier in the page lifecycle than when the new record is added to the database.</span></span>

<span data-ttu-id="e9f07-132">若要解決這個問題，因此剛加入的記錄會顯示在主版頁面的回傳，我們必須指示重新繫結至其資料來源 GridView GridView*之後*新記錄加入資料庫。</span><span class="sxs-lookup"><span data-stu-id="e9f07-132">To remedy this so that the just-added record is displayed in the master page's GridView on postback we need to instruct the GridView to rebind to its data source *after* the new record has been added to the database.</span></span> <span data-ttu-id="e9f07-133">因為加入新的記錄 （和其事件處理常式） 會在 [內容] 頁面，但需要重新整理的 GridView 介面是主版頁面中，這會需要的內容和主版頁面之間的互動。</span><span class="sxs-lookup"><span data-stu-id="e9f07-133">This requires interaction between the content and master pages because the interface for adding the new record (and its event handlers) are in the content page but the GridView that needs to be refreshed is in the master page.</span></span>

<span data-ttu-id="e9f07-134">因為重新整理從 [內容] 頁面中的事件處理常式的主版頁面的顯示是其中一個最常見的需求，內容和主版頁面互動，讓我們來探索此主題的更多詳細資料。</span><span class="sxs-lookup"><span data-stu-id="e9f07-134">Because refreshing the master page's display from an event handler in the content page is one of the most common needs for content and master page interaction, let's explore this topic in more detail.</span></span> <span data-ttu-id="e9f07-135">本教學課程中下載包含名為 Microsoft SQL Server 2005 Express 的 Edition 資料庫`NORTHWIND.MDF`中網站的`App_Data`資料夾。</span><span class="sxs-lookup"><span data-stu-id="e9f07-135">The download for this tutorial includes a Microsoft SQL Server 2005 Express Edition database named `NORTHWIND.MDF` in the website's `App_Data` folder.</span></span> <span data-ttu-id="e9f07-136">Northwind 資料庫會儲存產品、 員工及針對虛構的公司，Northwind Traders 的銷售資訊。</span><span class="sxs-lookup"><span data-stu-id="e9f07-136">The Northwind database stores product, employee, and sales information for a fictitious company, Northwind Traders.</span></span>

<span data-ttu-id="e9f07-137">步驟 1 逐步顯示五個最近新增產品 GridView 中的主版頁面中。</span><span class="sxs-lookup"><span data-stu-id="e9f07-137">Step 1 walks through displaying the five most recently added products in a GridView in the master page.</span></span> <span data-ttu-id="e9f07-138">步驟 2 建立的內容頁面中加入新的產品。</span><span class="sxs-lookup"><span data-stu-id="e9f07-138">Step 2 creates a content page for adding new products.</span></span> <span data-ttu-id="e9f07-139">探討如何建立主版頁面中中的公用屬性和方法的步驟 3 和步驟 4 說明如何以程式設計方式使用這些屬性和方法，從 [內容] 頁面的介面。</span><span class="sxs-lookup"><span data-stu-id="e9f07-139">Step 3 looks at how to create public properties and methods in the master page, and Step 4 illustrates how to programmatically interface with these properties and methods from the content page.</span></span>

> [!NOTE]
> <span data-ttu-id="e9f07-140">本教學課程不會不深入探討在 ASP.NET 中使用資料的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="e9f07-140">This tutorial does not delve into the specifics of working with data in ASP.NET.</span></span> <span data-ttu-id="e9f07-141">設定主版頁面，以顯示資料和插入資料的 [內容] 頁面的步驟會完成，尚未 breezy。</span><span class="sxs-lookup"><span data-stu-id="e9f07-141">The steps for setting up the master page to display data and the content page for inserting data are complete, yet breezy.</span></span> <span data-ttu-id="e9f07-142">如需更深入了解顯示和插入資料並使用 SqlDataSource 和 GridView 控制項，請參閱在本教學課程結尾處的進一步的讀數一節中的資源。</span><span class="sxs-lookup"><span data-stu-id="e9f07-142">For a more in-depth look at displaying and inserting data and using the SqlDataSource and GridView controls, consult the resources in the Further Readings section at the end of this tutorial.</span></span>

## <a name="step-1-displaying-the-five-most-recently-added-products-in-the-master-page"></a><span data-ttu-id="e9f07-143">步驟 1：顯示五個最新加入主版頁面的產品</span><span class="sxs-lookup"><span data-stu-id="e9f07-143">Step 1: Displaying the Five Most Recently Added Products in the Master Page</span></span>

<span data-ttu-id="e9f07-144">開啟 Site.master 主版頁面，然後新增一個 Label 和 GridView 控制項`leftContent` `<div>`。</span><span class="sxs-lookup"><span data-stu-id="e9f07-144">Open the Site.master master page and add a Label and a GridView control to the `leftContent` `<div>`.</span></span> <span data-ttu-id="e9f07-145">清除標籤`Text`屬性，設定其`EnableViewState`屬性設`False`，並將其`ID`屬性設`GridMessage`; 設定 GridView 的`ID`屬性設`RecentProducts`。</span><span class="sxs-lookup"><span data-stu-id="e9f07-145">Clear out the Label's `Text` property, set its `EnableViewState` property to `False`, and its `ID` property to `GridMessage`; set the GridView's `ID` property to `RecentProducts`.</span></span> <span data-ttu-id="e9f07-146">接下來，從設計工具中，展開 GridView 的智慧標籤，然後選擇繫結至新的資料來源。</span><span class="sxs-lookup"><span data-stu-id="e9f07-146">Next, from the Designer, expand the GridView's smart tag and choose to bind it to a new data source.</span></span> <span data-ttu-id="e9f07-147">這會啟動 資料來源組態精靈。</span><span class="sxs-lookup"><span data-stu-id="e9f07-147">This launches the Data Source Configuration wizard.</span></span> <span data-ttu-id="e9f07-148">因為 Northwind 資料庫中`App_Data`資料夾是 Microsoft SQL Server 資料庫中，選擇 選取 （請參閱 圖 1） 建立 SqlDataSource; 名稱 SqlDataSource `RecentProductsDataSource`。</span><span class="sxs-lookup"><span data-stu-id="e9f07-148">Because the Northwind database in the `App_Data` folder is a Microsoft SQL Server database, choose to create a SqlDataSource by selecting (see Figure 1); name the SqlDataSource `RecentProductsDataSource`.</span></span>

<span data-ttu-id="e9f07-149">[![繫結至名為 RecentProductsDataSource SqlDataSource 控制項的 GridView](interacting-with-the-master-page-from-the-content-page-vb/_static/image2.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="e9f07-149">[![Bind the GridView to a SqlDataSource Control Named RecentProductsDataSource](interacting-with-the-master-page-from-the-content-page-vb/_static/image2.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image1.png)</span></span>

<span data-ttu-id="e9f07-150">**圖 01**:SqlDataSource 控制項名為繫結 GridView `RecentProductsDataSource` ([按一下以檢視完整大小的影像](interacting-with-the-master-page-from-the-content-page-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="e9f07-150">**Figure 01**: Bind the GridView to a SqlDataSource Control Named `RecentProductsDataSource` ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image3.png))</span></span>

<span data-ttu-id="e9f07-151">下一個步驟會要求我們指定項目連接到資料庫。</span><span class="sxs-lookup"><span data-stu-id="e9f07-151">The next step asks us to specify what database to connect to.</span></span> <span data-ttu-id="e9f07-152">選擇`NORTHWIND.MDF`資料庫檔案，從下拉式清單中，按一下 [下一步]。</span><span class="sxs-lookup"><span data-stu-id="e9f07-152">Choose the `NORTHWIND.MDF` database file from the drop-down list and click Next.</span></span> <span data-ttu-id="e9f07-153">因為這是我們使用此資料庫的第一次時，精靈會將提供給連接字串儲存在`Web.config`。</span><span class="sxs-lookup"><span data-stu-id="e9f07-153">Because this is the first time we've used this database, the wizard will offer to store the connection string in `Web.config`.</span></span> <span data-ttu-id="e9f07-154">它使用的名稱將連接字串儲存`NorthwindConnectionString`。</span><span class="sxs-lookup"><span data-stu-id="e9f07-154">Have it store the connection string using the name `NorthwindConnectionString`.</span></span>

<span data-ttu-id="e9f07-155">[![連接到 Northwind 資料庫](interacting-with-the-master-page-from-the-content-page-vb/_static/image5.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="e9f07-155">[![Connect to the Northwind Database](interacting-with-the-master-page-from-the-content-page-vb/_static/image5.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image4.png)</span></span>

<span data-ttu-id="e9f07-156">**圖 02**:連接到 Northwind 資料庫 ([按一下以檢視完整大小的影像](interacting-with-the-master-page-from-the-content-page-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="e9f07-156">**Figure 02**: Connect to the Northwind Database  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image6.png))</span></span>

<span data-ttu-id="e9f07-157">設定資料來源精靈會提供兩種方法，我們可以指定用來擷取資料的查詢：</span><span class="sxs-lookup"><span data-stu-id="e9f07-157">The Configure Data Source wizard provides two means by which we can specify the query used to retrieve data:</span></span>

- <span data-ttu-id="e9f07-158">藉由指定自訂 SQL 陳述式或預存程序，或</span><span class="sxs-lookup"><span data-stu-id="e9f07-158">By specifying a custom SQL statement or stored procedure, or</span></span>
- <span data-ttu-id="e9f07-159">挑選資料表或檢視表，，然後指定要傳回的資料行</span><span class="sxs-lookup"><span data-stu-id="e9f07-159">By picking a table or view and then specifying the columns to return</span></span>

<span data-ttu-id="e9f07-160">因為我們想要傳回只是五個最近新增的產品，我們需要指定自訂的 SQL 陳述式。</span><span class="sxs-lookup"><span data-stu-id="e9f07-160">Because we want to return just the five most recently added products, we need to specify a custom SQL statement.</span></span> <span data-ttu-id="e9f07-161">使用下列項目`SELECT`查詢：</span><span class="sxs-lookup"><span data-stu-id="e9f07-161">Use the following `SELECT` query:</span></span>

[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample1.sql)]

<span data-ttu-id="e9f07-162">`TOP 5`關鍵字的查詢傳回前五筆記錄。</span><span class="sxs-lookup"><span data-stu-id="e9f07-162">The `TOP 5` keyword returns only the first five records from the query.</span></span> <span data-ttu-id="e9f07-163">`Products`資料表的主索引鍵`ProductID`，是`IDENTITY`資料行，以確保我們每個新的產品加入至資料表會有較大的值，比先前的項目。</span><span class="sxs-lookup"><span data-stu-id="e9f07-163">The `Products` table's primary key, `ProductID`, is an `IDENTITY` column, which assures us that each new product added to the table will have a larger value than the previous entry.</span></span> <span data-ttu-id="e9f07-164">因此，排序結果`ProductID`以遞減順序傳回開頭為最新建立的產品。</span><span class="sxs-lookup"><span data-stu-id="e9f07-164">Therefore, sorting the results by `ProductID` in descending order returns the products starting with the most recently created ones.</span></span>

<span data-ttu-id="e9f07-165">[![傳回 5 個最近新增的產品](interacting-with-the-master-page-from-the-content-page-vb/_static/image8.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="e9f07-165">[![Return the Five Most Recently Added Products](interacting-with-the-master-page-from-the-content-page-vb/_static/image8.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image7.png)</span></span>

<span data-ttu-id="e9f07-166">**圖 03**:傳回五個最最近新增的產品 ([按一下以檢視完整大小的影像](interacting-with-the-master-page-from-the-content-page-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="e9f07-166">**Figure 03**: Return the Five Most Recently Added Products  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image9.png))</span></span>

<span data-ttu-id="e9f07-167">完成精靈之後，Visual Studio 會產生如 GridView，以顯示兩個 BoundFields`ProductName`和`UnitPrice`從資料庫傳回的欄位。</span><span class="sxs-lookup"><span data-stu-id="e9f07-167">After completing the wizard, Visual Studio generates two BoundFields for the GridView to display the `ProductName` and `UnitPrice` fields returned from the database.</span></span> <span data-ttu-id="e9f07-168">目前主版頁面的宣告式標記應包含標記如下所示：</span><span class="sxs-lookup"><span data-stu-id="e9f07-168">At this point your master page's declarative markup should include markup similar to the following:</span></span>

[!code-aspx[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample2.aspx)]

<span data-ttu-id="e9f07-169">如您所見，標記包含： 標籤 Web 控制項 (`GridMessage`); GridView `RecentProducts`，兩個 BoundFields; 它會傳回 5 個最近新增的產品 SqlDataSource 控制項。</span><span class="sxs-lookup"><span data-stu-id="e9f07-169">As you can see, the markup contains: the Label Web control (`GridMessage`); the GridView `RecentProducts`, with two BoundFields; and a SqlDataSource control that returns the five most recently added products.</span></span>

<span data-ttu-id="e9f07-170">以此方式建立的 GridView 和設定，其 SqlDataSource 控制項瀏覽的網站，透過瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="e9f07-170">With this GridView created and its SqlDataSource control configured, visit the website through a browser.</span></span> <span data-ttu-id="e9f07-171">如 [圖 4] 所示，您會看到在左下角會列出五個最新的方格加入產品。</span><span class="sxs-lookup"><span data-stu-id="e9f07-171">As Figure 4 shows, you will see a grid in the lower left corner that lists the five most recently added products.</span></span>

<span data-ttu-id="e9f07-172">[![GridView 會顯示五個最近新增的產品](interacting-with-the-master-page-from-the-content-page-vb/_static/image11.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="e9f07-172">[![The GridView Displays the Five Most Recently Added Products](interacting-with-the-master-page-from-the-content-page-vb/_static/image11.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image10.png)</span></span>

<span data-ttu-id="e9f07-173">**圖 04**:GridView 會顯示五個最最近新增的產品 ([按一下以檢視完整大小的影像](interacting-with-the-master-page-from-the-content-page-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="e9f07-173">**Figure 04**: The GridView Displays the Five Most Recently Added Products ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image12.png))</span></span>

> [!NOTE]
> <span data-ttu-id="e9f07-174">請放心清除 GridView 的外觀。</span><span class="sxs-lookup"><span data-stu-id="e9f07-174">Feel free to clean up the appearance of the GridView.</span></span> <span data-ttu-id="e9f07-175">格式化顯示的一些建議包括`UnitPrice`值做為貨幣，並使用背景色彩和字型來改善格線的外觀。</span><span class="sxs-lookup"><span data-stu-id="e9f07-175">Some suggestions include formatting the displayed `UnitPrice` value as a currency and using background colors and fonts to improve the grid's appearance.</span></span>

## <a name="step-2-creating-a-content-page-to-add-new-products"></a><span data-ttu-id="e9f07-176">步驟 2：建立內容的頁面，即可加入新的產品</span><span class="sxs-lookup"><span data-stu-id="e9f07-176">Step 2: Creating a Content Page to Add New Products</span></span>

<span data-ttu-id="e9f07-177">下一步是建立內容頁面，使用者可以從此處新增的新產品`Products`資料表。</span><span class="sxs-lookup"><span data-stu-id="e9f07-177">Our next task is to create a content page from which a user can add a new product to the `Products` table.</span></span> <span data-ttu-id="e9f07-178">加入新的內容頁面，以便`Admin`名為資料夾`AddProduct.aspx`，並確定將它繫結`Site.master`主版頁面。</span><span class="sxs-lookup"><span data-stu-id="e9f07-178">Add a new content page to the `Admin` folder named `AddProduct.aspx`, making sure to bind it to the `Site.master` master page.</span></span> <span data-ttu-id="e9f07-179">此頁面已加入至網站之後，圖 5 顯示 方案總管。</span><span class="sxs-lookup"><span data-stu-id="e9f07-179">Figure 5 shows the Solution Explorer after this page has been added to the website.</span></span>

<span data-ttu-id="e9f07-180">[![將新的 ASP.NET 網頁新增至 [Admin] 資料夾](interacting-with-the-master-page-from-the-content-page-vb/_static/image14.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="e9f07-180">[![Add a New ASP.NET Page to the Admin Folder](interacting-with-the-master-page-from-the-content-page-vb/_static/image14.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image13.png)</span></span>

<span data-ttu-id="e9f07-181">**圖 05**:加入新的 ASP.NET 頁面，以便`Admin`資料夾 ([按一下以檢視完整大小的影像](interacting-with-the-master-page-from-the-content-page-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="e9f07-181">**Figure 05**: Add a New ASP.NET Page to the `Admin` Folder ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image15.png))</span></span>

<span data-ttu-id="e9f07-182">請注意，在[*指定主版頁面的標題、 中繼標籤及其他 HTML 標頭*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md)教學課程中我們建立名為自訂的基底頁面類別`BasePage`如果它已產生頁面的標題未明確設定。</span><span class="sxs-lookup"><span data-stu-id="e9f07-182">Recall that in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial we created a custom base page class named `BasePage` that generated the page's title if it was not explicitly set.</span></span> <span data-ttu-id="e9f07-183">移至`AddProduct.aspx`頁面的程式碼後置類別，並讓它衍生自`BasePage`(而不是從`System.Web.UI.Page`)。</span><span class="sxs-lookup"><span data-stu-id="e9f07-183">Go to the `AddProduct.aspx` page's code-behind class and have it derive from `BasePage` (instead of from `System.Web.UI.Page`).</span></span>

<span data-ttu-id="e9f07-184">最後，更新`Web.sitemap`檔案，以包含這一課中的項目。</span><span class="sxs-lookup"><span data-stu-id="e9f07-184">Finally, update the `Web.sitemap` file to include an entry for this lesson.</span></span> <span data-ttu-id="e9f07-185">加入下列標記下方`<siteMapNode>`控制項識別碼命名的問題一課：</span><span class="sxs-lookup"><span data-stu-id="e9f07-185">Add the following markup beneath the `<siteMapNode>` for the Control ID Naming Issues lesson:</span></span>

[!code-xml[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample3.xml)]

<span data-ttu-id="e9f07-186">圖 6，新增此所示`<siteMapNode>`項目會反映在課程清單。</span><span class="sxs-lookup"><span data-stu-id="e9f07-186">As shown in Figure 6, the addition of this `<siteMapNode>` element is reflected in the Lessons list.</span></span>

<span data-ttu-id="e9f07-187">返回`AddProduct.aspx`。</span><span class="sxs-lookup"><span data-stu-id="e9f07-187">Return to `AddProduct.aspx`.</span></span> <span data-ttu-id="e9f07-188">在適用於內容的控制項`MainContent`ContentPlaceHolder，新增 DetailsView 控制項並將它命名`NewProduct`。</span><span class="sxs-lookup"><span data-stu-id="e9f07-188">In the Content control for the `MainContent` ContentPlaceHolder, add a DetailsView control and name it `NewProduct`.</span></span> <span data-ttu-id="e9f07-189">繫結至新的 SqlDataSource 控制項，名為的 DetailsView `NewProductDataSource`。</span><span class="sxs-lookup"><span data-stu-id="e9f07-189">Bind the DetailsView to a new SqlDataSource control named `NewProductDataSource`.</span></span> <span data-ttu-id="e9f07-190">例如，以 sqldatasource 進行步驟 1 中，設定精靈，讓它使用 Northwind 資料庫，以及選擇指定自訂的 SQL 陳述式。</span><span class="sxs-lookup"><span data-stu-id="e9f07-190">Like with the SqlDataSource in Step 1, configure the wizard so that it uses the Northwind database and choose to specify a custom SQL statement.</span></span> <span data-ttu-id="e9f07-191">因為 DetailsView 會用來將項目加入至資料庫中，我們需要同時指定`SELECT`陳述式和`INSERT`陳述式。</span><span class="sxs-lookup"><span data-stu-id="e9f07-191">Because the DetailsView will be used to add items to the database, we need to specify both a `SELECT` statement and an `INSERT` statement.</span></span> <span data-ttu-id="e9f07-192">使用下列項目`SELECT`查詢：</span><span class="sxs-lookup"><span data-stu-id="e9f07-192">Use the following `SELECT` query:</span></span>

[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample4.sql)]

<span data-ttu-id="e9f07-193">然後，從 [插入] 索引標籤中，新增下列`INSERT`陳述式：</span><span class="sxs-lookup"><span data-stu-id="e9f07-193">Then, from the INSERT tab, add the following `INSERT` statement:</span></span>

[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample5.sql)]

<span data-ttu-id="e9f07-194">完成精靈之後移至 DetailsView 的智慧標籤並選取 「 啟用插入 」 的核取方塊。</span><span class="sxs-lookup"><span data-stu-id="e9f07-194">After completing the wizard go to the DetailsView's smart tag and check the "Enable Inserting" checkbox.</span></span> <span data-ttu-id="e9f07-195">這樣會增加與 DetailsView CommandField 其`ShowInsertButton`屬性設為 True。</span><span class="sxs-lookup"><span data-stu-id="e9f07-195">This adds a CommandField to the DetailsView with its `ShowInsertButton` property set to True.</span></span> <span data-ttu-id="e9f07-196">因為此 DetailsView 將用於僅用於插入資料，設定 DetailsView`DefaultMode`屬性設`Insert`。</span><span class="sxs-lookup"><span data-stu-id="e9f07-196">Because this DetailsView will be used solely for inserting data, set the DetailsView's `DefaultMode` property to `Insert`.</span></span>

<span data-ttu-id="e9f07-197">這樣就全部完成了！</span><span class="sxs-lookup"><span data-stu-id="e9f07-197">That's all there is to it!</span></span> <span data-ttu-id="e9f07-198">我們來測試此頁面。</span><span class="sxs-lookup"><span data-stu-id="e9f07-198">Let's test this page.</span></span> <span data-ttu-id="e9f07-199">請瀏覽`AddProduct.aspx`透過瀏覽器中，輸入 （請參閱 圖 6） 的名稱和價格。</span><span class="sxs-lookup"><span data-stu-id="e9f07-199">Visit `AddProduct.aspx` through a browser, enter a name and price (see Figure 6).</span></span>

<span data-ttu-id="e9f07-200">[![將新的產品加入至資料庫](interacting-with-the-master-page-from-the-content-page-vb/_static/image17.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="e9f07-200">[![Add a New Product to the Database](interacting-with-the-master-page-from-the-content-page-vb/_static/image17.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image16.png)</span></span>

<span data-ttu-id="e9f07-201">**圖 06**:將新的產品加入至資料庫 ([按一下以檢視完整大小的影像](interacting-with-the-master-page-from-the-content-page-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="e9f07-201">**Figure 06**: Add a New Product to the Database  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image18.png))</span></span>

<span data-ttu-id="e9f07-202">輸入之後的名稱和新的產品價格中，按一下 [插入] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="e9f07-202">After typing in the name and price for your new product, click the Insert button.</span></span> <span data-ttu-id="e9f07-203">這會導致表單回傳。</span><span class="sxs-lookup"><span data-stu-id="e9f07-203">This causes the form to postback.</span></span> <span data-ttu-id="e9f07-204">在回傳時，SqlDataSource 控制項的`INSERT`陳述式; 它的兩個參數會填入使用者輸入的值，在兩個文字方塊控制項 DetailsView。</span><span class="sxs-lookup"><span data-stu-id="e9f07-204">On postback, the SqlDataSource control's `INSERT` statement is executed; its two parameters are populated with the user-entered values in the DetailsView's two TextBox controls.</span></span> <span data-ttu-id="e9f07-205">不幸的是，發生插入沒有視覺回應。</span><span class="sxs-lookup"><span data-stu-id="e9f07-205">Unfortunately, there is no visual feedback that an insert has occurred.</span></span> <span data-ttu-id="e9f07-206">它會是可有可無的訊息，確認已新增新的記錄。</span><span class="sxs-lookup"><span data-stu-id="e9f07-206">It would be nice to have a message displayed, confirming that a new record has been added.</span></span> <span data-ttu-id="e9f07-207">我不要更動此練習的讀取器。</span><span class="sxs-lookup"><span data-stu-id="e9f07-207">I leave this as an exercise for the reader.</span></span> <span data-ttu-id="e9f07-208">此外之後加入新的記錄從 DetailsView, GridView 的主版頁面中仍會顯示五個記錄與相同之前;它不包含剛加入的記錄。</span><span class="sxs-lookup"><span data-stu-id="e9f07-208">Also, after adding a new record from the DetailsView the GridView in the master page still shows the same five records as before; it does not include the just-added record.</span></span> <span data-ttu-id="e9f07-209">我們將檢驗如何解決這個問題在後續的步驟。</span><span class="sxs-lookup"><span data-stu-id="e9f07-209">We'll examine how to remedy this in the upcoming steps.</span></span>

> [!NOTE]
> <span data-ttu-id="e9f07-210">除了新增某種形式的成功插入的視覺化回應，我會建議您一併更新以包含驗證的 DetailsView 插入介面。</span><span class="sxs-lookup"><span data-stu-id="e9f07-210">In addition to adding some form of visual feedback that the insert has succeeded, I'd encourage you to also update the DetailsView's inserting interface to include validation.</span></span> <span data-ttu-id="e9f07-211">目前沒有任何驗證。</span><span class="sxs-lookup"><span data-stu-id="e9f07-211">Currently, there is no validation.</span></span> <span data-ttu-id="e9f07-212">如果使用者輸入的值為 「 無效 」`UnitPrice`欄位，例如 「 太昂貴，"將會擲回例外狀況在回傳時，系統會嘗試將該字串轉換成十進位數。</span><span class="sxs-lookup"><span data-stu-id="e9f07-212">If a user enters an invalid value for the `UnitPrice` field, such as "Too expensive," an exception will be thrown on postback when the system attempts to convert that string into a decimal.</span></span> <span data-ttu-id="e9f07-213">如需有關自訂插入介面，請參閱[*自訂資料修改介面*教學課程](https://asp.net/learn/data-access/tutorial-20-vb.aspx)從我[使用資料教學課程系列](../../data-access/index.md).</span><span class="sxs-lookup"><span data-stu-id="e9f07-213">For more information on customizing the inserting interface, refer to the [*Customizing the Data Modification Interface* tutorial](https://asp.net/learn/data-access/tutorial-20-vb.aspx) from my [Working with Data tutorial series](../../data-access/index.md).</span></span>

## <a name="step-3-creating-public-properties-and-methods-in-the-master-page"></a><span data-ttu-id="e9f07-214">步驟 3：建立主版頁面的公用屬性和方法</span><span class="sxs-lookup"><span data-stu-id="e9f07-214">Step 3: Creating Public Properties and Methods in the Master Page</span></span>

<span data-ttu-id="e9f07-215">在步驟 1 中，我們新增標籤 Web 控制項，名為`GridMessage`上方 GridView 的主版頁面中。</span><span class="sxs-lookup"><span data-stu-id="e9f07-215">In Step 1 we added a Label Web control named `GridMessage` above the GridView in the master page.</span></span> <span data-ttu-id="e9f07-216">此標籤被要選擇性地顯示一則訊息。</span><span class="sxs-lookup"><span data-stu-id="e9f07-216">This Label is intended to optionally display a message.</span></span> <span data-ttu-id="e9f07-217">比方說之後加入新的記錄，以,`Products`資料表中，我們可能會想要顯示讀取的訊息：「*ProductName*已加入至資料庫。 」</span><span class="sxs-lookup"><span data-stu-id="e9f07-217">For example, after adding a new record to the `Products` table, we might want to show a message that reads: "*ProductName* has been added to the database."</span></span> <span data-ttu-id="e9f07-218">與其硬式編碼主版頁面中此標籤的文字，我們可能會想要的 [內容] 頁面可自訂訊息。</span><span class="sxs-lookup"><span data-stu-id="e9f07-218">Rather than hard-code the text for this Label in the master page, we might want the message to be customizable by the content page.</span></span>

<span data-ttu-id="e9f07-219">因為標籤控制項會實作為內無法直接從內容頁面存取主版頁面的受保護的成員變數中。</span><span class="sxs-lookup"><span data-stu-id="e9f07-219">Because the Label control is implemented as a protected member variable within the master page it cannot be accessed directly from content pages.</span></span> <span data-ttu-id="e9f07-220">若要使用主版頁面的 [內容] 頁面 （或就此而言，主版頁面中的任何 Web 控制項） 中的標籤，我們需要建立主版頁面公開的 Web 控制項，或做為 proxy 的其中一個屬性可以是公用屬性 存取。</span><span class="sxs-lookup"><span data-stu-id="e9f07-220">In order to work with the Label within a master page from the content page (or, for that matter, any Web control in the master page) we need to create a public property in the master page that exposes the Web control or serves as a proxy by which one of its properties can be accessed.</span></span> <span data-ttu-id="e9f07-221">將下列語法新增至主版頁面的程式碼後置類別，以公開 （expose） 的標籤`Text`屬性：</span><span class="sxs-lookup"><span data-stu-id="e9f07-221">Add the following syntax to the master page's code-behind class to expose the Label's `Text` property:</span></span>

[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample6.vb)]

<span data-ttu-id="e9f07-222">若要新增新的記錄時`Products`資料表從內容頁面`RecentProducts`主版頁面中的 GridView 需要重新繫結至其基礎資料來源。</span><span class="sxs-lookup"><span data-stu-id="e9f07-222">When a new record is added to the `Products` table from a content page the `RecentProducts` GridView in the master page needs to rebind to its underlying data source.</span></span> <span data-ttu-id="e9f07-223">若要重新繫結 GridView 呼叫其`DataBind`方法。</span><span class="sxs-lookup"><span data-stu-id="e9f07-223">To rebind the GridView call its `DataBind` method.</span></span> <span data-ttu-id="e9f07-224">主版頁面中的 GridView 不是以程式設計方式存取內容的頁面，因為我們需要建立的公用方法主版頁面中，呼叫時，會重新繫結至 GridView 資料。</span><span class="sxs-lookup"><span data-stu-id="e9f07-224">Because the GridView in the master page is not programmatically accessible to the content pages, we need to create a public method in the master page that, when called, rebinds the data to the GridView.</span></span> <span data-ttu-id="e9f07-225">將下列方法新增至主版頁面的程式碼後置類別：</span><span class="sxs-lookup"><span data-stu-id="e9f07-225">Add the following method to the master page's code-behind class:</span></span>

[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample7.vb)]

<span data-ttu-id="e9f07-226">與`GridMessageText`屬性和`RefreshRecentProductsGrid`方法中的地方，任何內容的頁面可以以程式設計方式設定或讀取的值`GridMessage`標籤`Text`屬性或重新繫結至資料`RecentProducts`GridView。</span><span class="sxs-lookup"><span data-stu-id="e9f07-226">With the `GridMessageText` property and `RefreshRecentProductsGrid` method in place, any content page can programmatically set or read the value of the `GridMessage` Label's `Text` property or rebind the data to the `RecentProducts` GridView.</span></span> <span data-ttu-id="e9f07-227">步驟 4 會檢驗如何從內容頁面存取主版頁面的公用屬性和方法。</span><span class="sxs-lookup"><span data-stu-id="e9f07-227">Step 4 examines how to access the master page's public properties and methods from a content page.</span></span>

> [!NOTE]
> <span data-ttu-id="e9f07-228">別忘了將主版頁面的屬性和方法`Public`。</span><span class="sxs-lookup"><span data-stu-id="e9f07-228">Don't forget to mark the master page's properties and methods as `Public`.</span></span> <span data-ttu-id="e9f07-229">如果您不明確地代表這些屬性和方法`Public`，他們將無法從 [內容] 頁面。</span><span class="sxs-lookup"><span data-stu-id="e9f07-229">If you do not explicitly denote these properties and methods as `Public`, they will not be accessible from the content page.</span></span>

## <a name="step-4-calling-the-master-pages-public-members-from-a-content-page"></a><span data-ttu-id="e9f07-230">步驟 4：從內容頁面呼叫主版頁面的公用成員</span><span class="sxs-lookup"><span data-stu-id="e9f07-230">Step 4: Calling the Master Page's Public Members from a Content Page</span></span>

<span data-ttu-id="e9f07-231">現在，主版頁面的所需的公用屬性和方法，我們已經準備好叫用這些屬性和方法，從`AddProduct.aspx`內容頁面。</span><span class="sxs-lookup"><span data-stu-id="e9f07-231">Now that the master page has the necessary public properties and methods, we're ready to invoke these properties and methods from the `AddProduct.aspx` content page.</span></span> <span data-ttu-id="e9f07-232">具體而言，我們需要設定主版頁面`GridMessageText`屬性並呼叫其`RefreshRecentProductsGrid`方法之後新產品已經新增到資料庫。</span><span class="sxs-lookup"><span data-stu-id="e9f07-232">Specifically, we need to set the master page's `GridMessageText` property and call its `RefreshRecentProductsGrid` method after the new product has been added to the database.</span></span> <span data-ttu-id="e9f07-233">所有 ASP.NET 資料 Web 控制項都引發事件，前後立即完成各種工作，讓您輕鬆網頁程式開發人員採取一些程式設計之前或之後的工作。</span><span class="sxs-lookup"><span data-stu-id="e9f07-233">All the ASP.NET data Web controls fire events immediately before and after completing various tasks, which make it easy for page developers to take some programmatic action either before or after the task.</span></span> <span data-ttu-id="e9f07-234">例如，當使用者按一下 DetailsView 的 [插入] 按鈕，在回傳 DetailsView 引發其`ItemInserting`開始插入的工作流程之前的事件。</span><span class="sxs-lookup"><span data-stu-id="e9f07-234">For example, when the end user clicks the DetailsView's Insert button, on postback the DetailsView raises its `ItemInserting` event before beginning the inserting workflow.</span></span> <span data-ttu-id="e9f07-235">然後，它會將記錄插入資料庫。</span><span class="sxs-lookup"><span data-stu-id="e9f07-235">It then inserts the record into the database.</span></span> <span data-ttu-id="e9f07-236">接下來，DetailsView 會引發其`ItemInserted`事件。</span><span class="sxs-lookup"><span data-stu-id="e9f07-236">Following that, the DetailsView raises its `ItemInserted` event.</span></span> <span data-ttu-id="e9f07-237">因此，若要加入新的產品後，請使用主版頁面，建立事件處理常式的 DetailsView`ItemInserted`事件。</span><span class="sxs-lookup"><span data-stu-id="e9f07-237">Therefore, in order to work with the master page after the new product has been added, create an event handler for the DetailsView's `ItemInserted` event.</span></span>

<span data-ttu-id="e9f07-238">有兩個內容頁面可以以程式設計方式介面與其主版頁面的方式：</span><span class="sxs-lookup"><span data-stu-id="e9f07-238">There are two ways that a content page can programmatically interface with its master page:</span></span>

- <span data-ttu-id="e9f07-239">使用`Page.Master`屬性，會傳回主版頁面的鬆散型別參考，或</span><span class="sxs-lookup"><span data-stu-id="e9f07-239">Using the `Page.Master` property, which returns a loosely-typed reference to the master page, or</span></span>
- <span data-ttu-id="e9f07-240">在頁面的主版頁面類型或檔案以指定的路徑`@MasterType`指示詞; 這會自動將強型別屬性加入至名為頁面`Master`。</span><span class="sxs-lookup"><span data-stu-id="e9f07-240">Specify the page's master page type or file path via a `@MasterType` directive; this automatically adds a strongly-typed property to the page named `Master`.</span></span>

<span data-ttu-id="e9f07-241">讓我們來檢查這兩種方法。</span><span class="sxs-lookup"><span data-stu-id="e9f07-241">Let's examine both approaches.</span></span>

### <a name="using-the-loosely-typedpagemasterproperty"></a><span data-ttu-id="e9f07-242">使用鬆散型別`Page.Master`屬性</span><span class="sxs-lookup"><span data-stu-id="e9f07-242">Using the Loosely-Typed`Page.Master`Property</span></span>

<span data-ttu-id="e9f07-243">所有的 ASP.NET 網頁必須衍生自`Page`類別，其位於`System.Web.UI`命名空間。</span><span class="sxs-lookup"><span data-stu-id="e9f07-243">All ASP.NET web pages must derive from the `Page` class, which is located in the `System.Web.UI` namespace.</span></span> <span data-ttu-id="e9f07-244">`Page`類別包含[`Master`屬性](https://msdn.microsoft.com/library/system.web.ui.page.master.aspx)傳回頁面的主版頁面的參考。</span><span class="sxs-lookup"><span data-stu-id="e9f07-244">The `Page` class includes a [`Master` property](https://msdn.microsoft.com/library/system.web.ui.page.master.aspx) that returns a reference to the page's master page.</span></span> <span data-ttu-id="e9f07-245">如果網頁沒有主版頁面`Master`傳回`Nothing`。</span><span class="sxs-lookup"><span data-stu-id="e9f07-245">If the page does not have a master page `Master` returns `Nothing`.</span></span>

<span data-ttu-id="e9f07-246">`Master`屬性會傳回類型的物件[ `MasterPage` ](https://msdn.microsoft.com/library/system.web.ui.masterpage.aspx) (同樣位於`System.Web.UI`命名空間) 這是從中所有主版頁面衍生自的基底類型。</span><span class="sxs-lookup"><span data-stu-id="e9f07-246">The `Master` property returns an object of type [`MasterPage`](https://msdn.microsoft.com/library/system.web.ui.masterpage.aspx) (also located in the `System.Web.UI` namespace) which is the base type from which all master pages derive from.</span></span> <span data-ttu-id="e9f07-247">因此，若要使用的公用屬性或方法定義於我們的網站主版頁面，我們必須轉型`MasterPage`所傳回的物件`Master`適當類型的屬性。</span><span class="sxs-lookup"><span data-stu-id="e9f07-247">Therefore, to use public properties or methods defined in our website's master page we must cast the `MasterPage` object returned from the `Master` property to the appropriate type.</span></span> <span data-ttu-id="e9f07-248">因為我們命名為我們的主版頁面檔案`Site.master`，程式碼後置類別命名為`Site`。</span><span class="sxs-lookup"><span data-stu-id="e9f07-248">Because we named our master page file `Site.master`, the code-behind class was named `Site`.</span></span> <span data-ttu-id="e9f07-249">因此，下列程式碼轉換`Page.Master`的執行個體的內容`Site`類別。</span><span class="sxs-lookup"><span data-stu-id="e9f07-249">Therefore, the following code casts the `Page.Master` property to an instance of the `Site` class.</span></span>

[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample8.vb)]

<span data-ttu-id="e9f07-250">既然我們已經轉換鬆散型別`Page.Master`屬性至站台類型，我們可以參考的屬性和方法的特定站台。</span><span class="sxs-lookup"><span data-stu-id="e9f07-250">Now that we have casted the loosely-typed `Page.Master` property to the Site type we can reference the properties and methods specific to Site.</span></span> <span data-ttu-id="e9f07-251">如 [圖 7] 所示，公用屬性`GridMessageText`出現在 IntelliSense 下拉式清單中。</span><span class="sxs-lookup"><span data-stu-id="e9f07-251">As Figure 7 shows, the public property `GridMessageText` appears in the IntelliSense drop-down.</span></span>

<span data-ttu-id="e9f07-252">[![IntelliSense 會顯示我們主頁公用屬性和方法](interacting-with-the-master-page-from-the-content-page-vb/_static/image20.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="e9f07-252">[![IntelliSense Shows our Master Page's Public Properties and Methods](interacting-with-the-master-page-from-the-content-page-vb/_static/image20.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image19.png)</span></span>

<span data-ttu-id="e9f07-253">**圖 07**:IntelliSense 會顯示我們主頁公用屬性和方法 ([按一下以檢視完整大小的影像](interacting-with-the-master-page-from-the-content-page-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="e9f07-253">**Figure 07**: IntelliSense Shows our Master Page's Public Properties and Methods ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image21.png))</span></span>

> [!NOTE]
> <span data-ttu-id="e9f07-254">如果名為您的主版頁面檔案`MasterPage.master`則主版頁面的程式碼後置類別名稱就是`MasterPage`。</span><span class="sxs-lookup"><span data-stu-id="e9f07-254">If you named your master page file `MasterPage.master` then the master page's code-behind class name is `MasterPage`.</span></span> <span data-ttu-id="e9f07-255">這可能會導致模稜兩可的程式碼從型別轉型時`System.Web.UI.MasterPage`到您`MasterPage`類別。</span><span class="sxs-lookup"><span data-stu-id="e9f07-255">This can lead to ambiguous code when casting from the type `System.Web.UI.MasterPage` to your `MasterPage` class.</span></span> <span data-ttu-id="e9f07-256">簡單地說，您需要完整限定的類型為，可能會較難使用網站專案模型時。</span><span class="sxs-lookup"><span data-stu-id="e9f07-256">In short, you need to fully qualify the type you are casting to, which can be a little tricky when using the Web Site Project model.</span></span> <span data-ttu-id="e9f07-257">我的建議是確認您的主版頁面建立時您將它命名的項目以外的其他`MasterPage.master`或更棒的是，建立主版頁面的強型別參考。</span><span class="sxs-lookup"><span data-stu-id="e9f07-257">My suggestion would be to either make sure that when you create your master page you name it something other than `MasterPage.master` or, even better, create a strongly-typed reference to the master page.</span></span>

### <a name="creating-a-strongly-typed-reference-with-themastertypedirective"></a><span data-ttu-id="e9f07-258">建立強型別參考與`@MasterType`指示詞</span><span class="sxs-lookup"><span data-stu-id="e9f07-258">Creating a Strongly-Typed Reference with the`@MasterType`Directive</span></span>

<span data-ttu-id="e9f07-259">如果您仔細看您可以看到 ASP.NET 網頁的程式碼後置類別是部分類別 (請注意`Partial`類別定義中的關鍵字)。</span><span class="sxs-lookup"><span data-stu-id="e9f07-259">If you look closely you can see that an ASP.NET page's code-behind class is a partial class (note the `Partial` keyword in the class definition).</span></span> <span data-ttu-id="e9f07-260">部分類別在 C# 和 Visual Basic.net Framework 2.0 中推出，和簡單的說，允許跨多個檔案中定義的類別的成員。</span><span class="sxs-lookup"><span data-stu-id="e9f07-260">Partial classes were introduced in C# and Visual Basic with.NET Framework 2.0 and, in a nutshell, allow for a class's members to be defined across multiple files.</span></span> <span data-ttu-id="e9f07-261">程式碼後置類別檔中- `AddProduct.aspx.vb`，例如，包含頁面開發人員，我們建立的程式碼。</span><span class="sxs-lookup"><span data-stu-id="e9f07-261">The code-behind class file - `AddProduct.aspx.vb`, for example - contains the code that we, the page developer, create.</span></span> <span data-ttu-id="e9f07-262">除了我們的程式碼中，ASP.NET 引擎會自動建立個別的類別檔案屬性和事件處理常式中，會轉譯頁面的類別階層架構中的宣告式標記。</span><span class="sxs-lookup"><span data-stu-id="e9f07-262">In addition to our code, the ASP.NET engine automatically creates a separate class file with properties and event handlers in that translate the declarative markup into the page's class hierarchy.</span></span>

<span data-ttu-id="e9f07-263">只要瀏覽 ASP.NET 網頁時，就會發生自動程式碼產生奠定一些相當有趣且實用的可能性。</span><span class="sxs-lookup"><span data-stu-id="e9f07-263">The automatic code generation that occurs whenever an ASP.NET page is visited paves the way for some rather interesting and useful possibilities.</span></span> <span data-ttu-id="e9f07-264">在主版頁面的情況下如果我們告訴我們的內容頁面正在使用哪些主版頁面的 ASP.NET 引擎就會產生強型別`Master`為我們的屬性。</span><span class="sxs-lookup"><span data-stu-id="e9f07-264">In the case of master pages, if we tell the ASP.NET engine what master page is being used by our content page it generates a strongly-typed `Master` property for us.</span></span>

<span data-ttu-id="e9f07-265">使用[`@MasterType`指示詞](https://msdn.microsoft.com/library/ms228274.aspx)，告知 ASP.NET 引擎的 [內容] 頁面的主版頁面類型。</span><span class="sxs-lookup"><span data-stu-id="e9f07-265">Use the [`@MasterType` directive](https://msdn.microsoft.com/library/ms228274.aspx) to inform the ASP.NET engine of the content page's master page type.</span></span> <span data-ttu-id="e9f07-266">`@MasterType`指示詞可接受的類型名稱的主版頁面或檔案路徑。</span><span class="sxs-lookup"><span data-stu-id="e9f07-266">The `@MasterType` directive can accept either the type name of the master page or its file path.</span></span> <span data-ttu-id="e9f07-267">若要指定`AddProduct.aspx`頁面上使用`Site.master`作為其主版頁面的頂端加入下列指示詞`AddProduct.aspx`:</span><span class="sxs-lookup"><span data-stu-id="e9f07-267">To specify that the `AddProduct.aspx` page uses `Site.master` as its master page, add the following directive to the top of `AddProduct.aspx`:</span></span>

[!code-aspx[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample9.aspx)]

<span data-ttu-id="e9f07-268">這個指示詞會指示 ASP.NET 引擎加入主版頁面，透過名為屬性的強型別參考`Master`。</span><span class="sxs-lookup"><span data-stu-id="e9f07-268">This directive instructs the ASP.NET engine to add a strongly-typed reference to the master page through a property named `Master`.</span></span> <span data-ttu-id="e9f07-269">與`@MasterType`我們可以呼叫指示詞就地`Site.master`主要頁面上的公用屬性和方法直接透過`Master`屬性，而不需要任何轉換 （cast）。</span><span class="sxs-lookup"><span data-stu-id="e9f07-269">With the `@MasterType` directive in place, we can call the `Site.master` master page's public properties and methods directly through the `Master` property without any casts.</span></span>

> [!NOTE]
> <span data-ttu-id="e9f07-270">如果您省略`@MasterType`指示詞，則語法`Page.Master`和`Master`傳回相同的動作： 在頁面的主版頁面的鬆散型別物件。</span><span class="sxs-lookup"><span data-stu-id="e9f07-270">If you omit the `@MasterType` directive, the syntax `Page.Master` and `Master` return the same thing: a loosely-typed object to the page's master page.</span></span> <span data-ttu-id="e9f07-271">如果您納入`@MasterType`指示詞再`Master`傳回指定的主版頁面的強型別參考。</span><span class="sxs-lookup"><span data-stu-id="e9f07-271">If you include the `@MasterType` directive then `Master` returns a strongly-typed reference to the specified master page.</span></span> <span data-ttu-id="e9f07-272">`Page.Master`不過，仍會傳回鬆散型別參考。</span><span class="sxs-lookup"><span data-stu-id="e9f07-272">`Page.Master`, however, still returns a loosely-typed reference.</span></span> <span data-ttu-id="e9f07-273">針對更徹底的了解為什麼是這樣的情況以及如何`Master`屬性的建構時`@MasterType`指示詞之後，請參閱[K.Scott Allen](http://odetocode.com/blogs/scott/default.aspx)的部落格項目[`@MasterType`在 ASP.NET 2.0](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx).</span><span class="sxs-lookup"><span data-stu-id="e9f07-273">For a more thorough look at why this is the case and how the `Master` property is constructed when the `@MasterType` directive is included, see [K. Scott Allen](http://odetocode.com/blogs/scott/default.aspx)'s blog entry [`@MasterType` in ASP.NET 2.0](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx).</span></span>

### <a name="updating-the-master-page-after-adding-a-new-product"></a><span data-ttu-id="e9f07-274">在之後加入新的產品更新主版頁面</span><span class="sxs-lookup"><span data-stu-id="e9f07-274">Updating the Master Page After Adding a New Product</span></span>

<span data-ttu-id="e9f07-275">既然我們已經知道如何叫用主版頁面的公用屬性和方法，從內容頁面，我們已經準備好更新`AddProduct.aspx`頁面，如此主版頁面會重新整理之後加入新的產品。</span><span class="sxs-lookup"><span data-stu-id="e9f07-275">Now that we know how to invoke a master page's public properties and methods from a content page, we're ready to update the `AddProduct.aspx` page so that the master page is refreshed after adding a new product.</span></span> <span data-ttu-id="e9f07-276">在步驟 4 開始，我們建立 DetailsView 控制項的事件處理常式`ItemInserting`事件，它會立即在新產品已經新增到資料庫之後，才執行。</span><span class="sxs-lookup"><span data-stu-id="e9f07-276">At the beginning of Step 4 we created an event handler for the DetailsView control's `ItemInserting` event, which executes immediately after the new product has been added to the database.</span></span> <span data-ttu-id="e9f07-277">將下列程式碼新增至該事件處理常式中：</span><span class="sxs-lookup"><span data-stu-id="e9f07-277">Add the following code to that event handler:</span></span>

[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample10.vb)]

<span data-ttu-id="e9f07-278">上述程式碼會使用這兩個鬆散型`Page.Master`屬性的強型別`Master`屬性。</span><span class="sxs-lookup"><span data-stu-id="e9f07-278">The above code uses both the loosely-typed `Page.Master` property and the strongly-typed `Master` property.</span></span> <span data-ttu-id="e9f07-279">請注意，`GridMessageText`屬性設定為"*ProductName*新增至資料格...」剛加入之產品的值是可透過存取`e.Values`集合，您可以看到，剛`ProductName`的值透過存取`e.Values("ProductName")`。</span><span class="sxs-lookup"><span data-stu-id="e9f07-279">Note that the `GridMessageText` property is set to "*ProductName* added to grid..." The just-added product's values are accessible through the `e.Values` collection; as you can see, the just-added `ProductName` value is accessed via `e.Values("ProductName")`.</span></span>

<span data-ttu-id="e9f07-280">[圖 8] 顯示`AddProduct.aspx`之後將新的產品-Scott Soda-立即的頁面已加入至資料庫。</span><span class="sxs-lookup"><span data-stu-id="e9f07-280">Figure 8 shows the `AddProduct.aspx` page immediately after a new product - Scott's Soda - has been added to the database.</span></span> <span data-ttu-id="e9f07-281">請注意，主版頁面的標籤中註明剛加入的產品名稱和 GridView 已經過改版，包括產品，而且其價格。</span><span class="sxs-lookup"><span data-stu-id="e9f07-281">Note that the just-added product name is noted in the master page's Label and that the GridView has been refreshed to include the product and its price.</span></span>

<span data-ttu-id="e9f07-282">[![主版頁面的標籤和 GridView 會顯示剛加入的產品](interacting-with-the-master-page-from-the-content-page-vb/_static/image23.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="e9f07-282">[![The Master Page's Label and GridView Show the Just-Added Product](interacting-with-the-master-page-from-the-content-page-vb/_static/image23.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image22.png)</span></span>

<span data-ttu-id="e9f07-283">**圖 08**:主版頁面的標籤和 GridView 顯示 Just-Added 產品 ([按一下以檢視完整大小的影像](interacting-with-the-master-page-from-the-content-page-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="e9f07-283">**Figure 08**: The Master Page's Label and GridView Show the Just-Added Product ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image24.png))</span></span>

## <a name="summary"></a><span data-ttu-id="e9f07-284">總結</span><span class="sxs-lookup"><span data-stu-id="e9f07-284">Summary</span></span>

<span data-ttu-id="e9f07-285">在理想情況下，主版頁面和其內容的頁面是完全獨立的另一個，並需要互動的任何層級。</span><span class="sxs-lookup"><span data-stu-id="e9f07-285">Ideally, a master page and its content pages are completely separate from one another and require no level of interaction.</span></span> <span data-ttu-id="e9f07-286">雖然主版頁面和內容頁面應該設計的心，有幾個常見的案例中內容的頁面必須與其主版頁面互動。</span><span class="sxs-lookup"><span data-stu-id="e9f07-286">While master pages and content pages should be designed with that goal in mind, there are a number of common scenarios in which a content page must interface with its master page.</span></span> <span data-ttu-id="e9f07-287">其中一個最常見的原因都著重於更新主版頁面顯示根據該批 [內容] 頁面中的某些動作的特定部分。</span><span class="sxs-lookup"><span data-stu-id="e9f07-287">One of the most common reasons centers around updating a particular portion of the master page display based on some action that transpired in the content page.</span></span>

<span data-ttu-id="e9f07-288">好消息是相當容易就能以程式設計的方式互動其主版頁面的內容頁面。</span><span class="sxs-lookup"><span data-stu-id="e9f07-288">The good news is that it's relatively straightforward to have a content page programmatically interact with its master page.</span></span> <span data-ttu-id="e9f07-289">開始建立封裝的功能，需要的內容頁面所叫用主版頁面中的公用屬性或方法。</span><span class="sxs-lookup"><span data-stu-id="e9f07-289">Start by creating public properties or methods in the master page that encapsulate the functionality that needs to be invoked by a content page.</span></span> <span data-ttu-id="e9f07-290">然後，在 [內容] 頁面存取主版頁面的屬性和方法透過鬆散型別`Page.Master`屬性或使用`@MasterType`指示詞，以建立主版頁面的強型別參考。</span><span class="sxs-lookup"><span data-stu-id="e9f07-290">Then, in the content page, access the master page's properties and methods through the loosely-typed `Page.Master` property or use the `@MasterType` directive to create a strongly-typed reference to the master page.</span></span>

<span data-ttu-id="e9f07-291">在下一個教學課程中，我們會檢驗如何以程式設計的方式互動的其中一個其內容頁的主版頁面。</span><span class="sxs-lookup"><span data-stu-id="e9f07-291">In the next tutorial we examine how to have the master page programmatically interact with one of its content pages.</span></span>

<span data-ttu-id="e9f07-292">快樂地寫程式 ！</span><span class="sxs-lookup"><span data-stu-id="e9f07-292">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="e9f07-293">進一步閱讀</span><span class="sxs-lookup"><span data-stu-id="e9f07-293">Further Reading</span></span>

<span data-ttu-id="e9f07-294">如需有關在本教學課程所討論的主題的詳細資訊，請參閱下列資源：</span><span class="sxs-lookup"><span data-stu-id="e9f07-294">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="e9f07-295">存取及更新在 ASP.NET 中的資料</span><span class="sxs-lookup"><span data-stu-id="e9f07-295">Accessing and Updating Data in ASP.NET</span></span>](http://aspnet.4guysfromrolla.com/articles/011106-1.aspx)
- [<span data-ttu-id="e9f07-296">ASP.NET 主版頁面：秘訣、 技巧和陷阱</span><span class="sxs-lookup"><span data-stu-id="e9f07-296">ASP.NET Master Pages: Tips, Tricks, and Traps</span></span>](http://www.odetocode.com/articles/450.aspx)
- [<span data-ttu-id="e9f07-297">`@MasterType` 在 ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="e9f07-297">`@MasterType` in ASP.NET 2.0</span></span>](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx)
- [<span data-ttu-id="e9f07-298">內容與主版頁面之間傳遞資訊</span><span class="sxs-lookup"><span data-stu-id="e9f07-298">Passing Information Between Content and Master Pages</span></span>](http://aspnet.4guysfromrolla.com/articles/013107-1.aspx)
- [<span data-ttu-id="e9f07-299">在 ASP.NET 教學課程中使用的資料</span><span class="sxs-lookup"><span data-stu-id="e9f07-299">Working with Data in ASP.NET Tutorials</span></span>](../../data-access/index.md)

### <a name="about-the-author"></a><span data-ttu-id="e9f07-300">關於作者</span><span class="sxs-lookup"><span data-stu-id="e9f07-300">About the Author</span></span>

<span data-ttu-id="e9f07-301">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，作者的多個 ASP 本書籍，他是 4GuysFromRolla.com 的創辦人，一直從事 Microsoft Web 技術自 1998 年。</span><span class="sxs-lookup"><span data-stu-id="e9f07-301">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="e9f07-302">Scott 會擔任獨立的顧問、 培訓講師和作家。</span><span class="sxs-lookup"><span data-stu-id="e9f07-302">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="e9f07-303">他最新的著作是[ *Sams 教導您自己 ASP.NET 3.5 24 小時內*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="e9f07-303">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="e9f07-304">Scott 要聯絡[ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com)或透過他的部落格[ http://ScottOnWriting.NET ](http://scottonwriting.net/)。</span><span class="sxs-lookup"><span data-stu-id="e9f07-304">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="e9f07-305">特別感謝</span><span class="sxs-lookup"><span data-stu-id="e9f07-305">Special Thanks To</span></span>

<span data-ttu-id="e9f07-306">本教學課程系列是由許多實用的檢閱者檢閱。</span><span class="sxs-lookup"><span data-stu-id="e9f07-306">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="e9f07-307">本教學課程中的潛在客戶檢閱者已 Zack Jones。</span><span class="sxs-lookup"><span data-stu-id="e9f07-307">Lead reviewer for this tutorial was Zack Jones.</span></span> <span data-ttu-id="e9f07-308">有興趣檢閱我即將推出的 MSDN 文章嗎？</span><span class="sxs-lookup"><span data-stu-id="e9f07-308">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="e9f07-309">如果是這樣，psychic 在 [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="e9f07-309">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="e9f07-310">[上一頁](control-id-naming-in-content-pages-vb.md)
> [下一頁](interacting-with-the-content-page-from-the-master-page-vb.md)</span><span class="sxs-lookup"><span data-stu-id="e9f07-310">[Previous](control-id-naming-in-content-pages-vb.md)
[Next](interacting-with-the-content-page-from-the-master-page-vb.md)</span></span>
