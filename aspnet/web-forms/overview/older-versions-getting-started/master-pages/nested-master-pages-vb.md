---
uid: web-forms/overview/older-versions-getting-started/master-pages/nested-master-pages-vb
title: 嵌套主版頁面（VB） |Microsoft Docs
author: rick-anderson
description: 示範如何在另一個主版頁面上嵌套。
ms.author: riande
ms.date: 07/28/2008
ms.assetid: 14d9aa1b-4dca-43a0-aa9d-a6e891fee019
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/nested-master-pages-vb
msc.type: authoredcontent
ms.openlocfilehash: 9bb39712855c37f5cbcbb447f7691e9451b8dc92
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/28/2019
ms.locfileid: "74642090"
---
# <a name="nested-master-pages-vb"></a><span data-ttu-id="f5c3f-103">巢狀主版頁面 (VB)</span><span class="sxs-lookup"><span data-stu-id="f5c3f-103">Nested Master Pages (VB)</span></span>

<span data-ttu-id="f5c3f-104">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="f5c3f-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="f5c3f-105">[下載程式代碼](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_10_VB.zip)或[下載 PDF](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_10_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="f5c3f-105">[Download Code](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_10_VB.zip) or [Download PDF](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_10_VB.pdf)</span></span>

> <span data-ttu-id="f5c3f-106">示範如何在另一個主版頁面上嵌套。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-106">Shows how to nest one master page within another.</span></span>

## <a name="introduction"></a><span data-ttu-id="f5c3f-107">簡介</span><span class="sxs-lookup"><span data-stu-id="f5c3f-107">Introduction</span></span>

<span data-ttu-id="f5c3f-108">在過去九個教學課程中，我們已瞭解如何使用主版頁面來執行全網站的版面配置。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-108">Over the course of the past nine tutorials we have seen how to implement a site-wide layout with master pages.</span></span> <span data-ttu-id="f5c3f-109">簡言之，主版頁面可讓我們（網頁開發人員）在主版頁面中定義一般標記，以及在內容頁面上依據內容頁面自訂的特定區域。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-109">In a nutshell, master pages allow us, the page developer, to define common markup in the master page along with specific regions that can be customized on a content page-by-content page basis.</span></span> <span data-ttu-id="f5c3f-110">主版頁面中的 ContentPlaceHolder 控制項指出可自訂的區域;ContentPlaceHolder 控制項的自訂標記會透過內容控制項在內容頁面中定義。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-110">The ContentPlaceHolder controls in a master page indicate the customizable regions; the customized markup for the ContentPlaceHolder controls are defined in the content page via Content controls.</span></span>

<span data-ttu-id="f5c3f-111">如果您在整個網站上使用單一版面配置，我們目前所探索到的主版頁面技術就很好用。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-111">The master page techniques we've explored thus far are great if you have a single layout used across the entire site.</span></span> <span data-ttu-id="f5c3f-112">不過，許多大型網站的網站版面配置會在各種不同的區段中進行自訂。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-112">However, many large websites have a site layout that is customized across various sections.</span></span> <span data-ttu-id="f5c3f-113">例如，請考慮醫院員工用來管理患者資訊、活動和帳單的醫療保健應用程式。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-113">For example, consider a health care application used by hospital staff to manage patient information, activities, and billing.</span></span> <span data-ttu-id="f5c3f-114">在此應用程式中，可能會有三種類型的網頁：</span><span class="sxs-lookup"><span data-stu-id="f5c3f-114">There may be three types of web pages in this application:</span></span>

- <span data-ttu-id="f5c3f-115">員工成員的特定頁面，員工可以在其中更新可用性、查看排程或要求假期時間。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-115">Staff member-specific pages where staff members can update availability, view schedules, or request vacation time.</span></span>
- <span data-ttu-id="f5c3f-116">員工成員可在其中查看或編輯特定患者資訊的患者特定頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-116">Patient-specific pages where staff members view or edit information for a specific patient.</span></span>
- <span data-ttu-id="f5c3f-117">會計審查目前理賠狀態和財務報告的計費特定頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-117">Billing-specific pages where accountants review current claim statuses and financial reports.</span></span>

<span data-ttu-id="f5c3f-118">每個頁面都可能共用一般的版面配置，例如橫跨頂端的功能表，以及底部的一系列常用的連結。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-118">Every page might share a common layout, such as a menu across the top and a series of frequently used links along the bottom.</span></span> <span data-ttu-id="f5c3f-119">但員工-、患者和計費特定頁面可能需要自訂此一般版面配置。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-119">But the staff-, patient-, and billing-specific pages may need to customize this generic layout.</span></span> <span data-ttu-id="f5c3f-120">例如，可能所有的員工專屬頁面都應該包含行事曆和工作清單，以顯示目前登入的使用者可用性和每日排程。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-120">For example, perhaps all staff-specific pages should include a calendar and task list showing the currently logged on user's availability and daily schedule.</span></span> <span data-ttu-id="f5c3f-121">可能所有的患者特定頁面都需要顯示其資訊正在編輯之患者的名稱、位址和保險資訊。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-121">Perhaps all patient-specific pages need to show the name, address, and insurance information for the patient whose information is being edited.</span></span>

<span data-ttu-id="f5c3f-122">您可以使用*嵌套主版頁面*來建立這類自訂的版面配置。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-122">It's possible to create such customized layouts by using *nested master pages*.</span></span> <span data-ttu-id="f5c3f-123">若要執行上述案例，我們首先要建立一個主版頁面，定義網站範圍的版面配置、功能表和頁尾內容，以及定義可自訂區域的 ContentPlaceHolders。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-123">To implement the above scenario, we would start by creating a master page that defined the site-wide layout, the menu and footer content, with ContentPlaceHolders defining the customizable regions.</span></span> <span data-ttu-id="f5c3f-124">接著，我們會建立三個嵌套的主版頁面，每個網頁類型各一個。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-124">We would then create three nested master pages, one for each type of web page.</span></span> <span data-ttu-id="f5c3f-125">每個嵌套的主版頁面都會定義使用主版頁面的內容頁面類型之間的內容。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-125">Each nested master page would define the content among the type of content pages that use the master page.</span></span> <span data-ttu-id="f5c3f-126">換句話說，適用于患者特定內容頁面的嵌套主版頁面會包含標記和程式設計邏輯，以顯示所編輯之患者的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-126">In other words, the nested master page for patient-specific content pages would include markup and programmatic logic for displaying information about the patient being edited.</span></span> <span data-ttu-id="f5c3f-127">在建立新的患者特定頁面時，我們會將它系結到這個嵌套的主版頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-127">When creating a new patient-specific page we would bind it to this nested master page.</span></span>

<span data-ttu-id="f5c3f-128">本教學課程一開始會強調嵌套主版頁面的優點。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-128">This tutorial starts by highlighting the benefits of nested master pages.</span></span> <span data-ttu-id="f5c3f-129">接著，它會示範如何建立和使用嵌套主版頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-129">It then shows how to create and use nested master pages.</span></span>

> [!NOTE]
> <span data-ttu-id="f5c3f-130">從2.0 版的 .NET Framework 開始可能會有嵌套的主版頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-130">Nested master pages have been possible since version 2.0 of the .NET Framework.</span></span> <span data-ttu-id="f5c3f-131">不過，Visual Studio 2005 並未包含針對嵌套主版頁面的設計階段支援。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-131">However, Visual Studio 2005 did not include design-time support for nested master pages.</span></span> <span data-ttu-id="f5c3f-132">好消息是，Visual Studio 2008 針對嵌套主版頁面提供了豐富的設計階段體驗。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-132">The good news is that Visual Studio 2008 offers a rich design-time experience for nested master pages.</span></span> <span data-ttu-id="f5c3f-133">如果您有興趣使用嵌套的主版頁面，但仍在使用 Visual Studio 2005，請查看[Scott Guthrie](https://weblogs.asp.net/scottgu/)的 blog 專案，這是[在 VS 2005 設計階段中嵌套主版頁面的秘訣](https://weblogs.asp.net/scottgu/archive/2005/11/11/430382.aspx)。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-133">If you are interested in using nested master pages but are still using Visual Studio 2005, check out [Scott Guthrie](https://weblogs.asp.net/scottgu/)'s blog entry, [Tips for Nested Master Pages in VS 2005 Design-Time](https://weblogs.asp.net/scottgu/archive/2005/11/11/430382.aspx).</span></span>

## <a name="the-benefits-of-nested-master-pages"></a><span data-ttu-id="f5c3f-134">嵌套主版頁面的優點</span><span class="sxs-lookup"><span data-stu-id="f5c3f-134">The Benefits of Nested Master Pages</span></span>

<span data-ttu-id="f5c3f-135">許多網站的網站設計，以及特定頁面類型特有的自訂設計都有。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-135">Many websites have an overarching site design as well as more customized designs specific to certain types of pages.</span></span> <span data-ttu-id="f5c3f-136">比方說，在我們的示範 web 應用程式中，我們建立了一個基本的管理區段（`~/Admin` 資料夾中的頁面）。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-136">For instance, in our demo web application we have created a rudimentary Administration section (the pages in the `~/Admin` folder).</span></span> <span data-ttu-id="f5c3f-137">[`~/Admin`] 資料夾中的網頁目前使用的主版頁面與不在 [系統管理] 區段中的頁面（也就是 `Site.master` 或 `Alternate.master`，視使用者的選擇而定）。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-137">Currently the web pages in the `~/Admin` folder use the same master page as those pages not in the administration section (namely, `Site.master` or `Alternate.master`, depending on the user's selection).</span></span>

> [!NOTE]
> <span data-ttu-id="f5c3f-138">現在，假設我們的網站只有一個主版頁面，`Site.master`。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-138">For now, pretend that our site has just one master page, `Site.master`.</span></span> <span data-ttu-id="f5c3f-139">我們將在本教學課程稍後的使用 [管理] 區段中的 [使用嵌套的主版頁面] 開頭的兩個（或多個）主版頁面中，使用嵌套主版頁面來處理。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-139">We'll address using nested master pages with two (or more) master pages starting with "Using a Nested Master Page for the Administration Section" later in this tutorial.</span></span>

<span data-ttu-id="f5c3f-140">假設我們要求您自訂管理頁面的版面配置，以包含其他資訊或網站中其他頁面不會顯示的連結。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-140">Imagine that we were asked to customize the layout of the Administration pages to include additional information or links that would not otherwise be present in other pages in the site.</span></span> <span data-ttu-id="f5c3f-141">有四種方法可實行這項需求：</span><span class="sxs-lookup"><span data-stu-id="f5c3f-141">There are four techniques to implement this requirement:</span></span>

1. <span data-ttu-id="f5c3f-142">手動將管理特定的資訊和連結新增至 `~/Admin` 資料夾中的每個內容頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-142">Manually add the Administration-specific information and links to every content page in the `~/Admin` folder.</span></span>
2. <span data-ttu-id="f5c3f-143">更新 `Site.master` 主版頁面以包含管理區段特定的資訊和連結，然後將程式碼新增至主版頁面，根據是否正在流覽其中一個管理頁面來顯示或隱藏這些區段。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-143">Update the `Site.master` master page to include the Administration section-specific information and links, and then add code to the master page to show or hide these sections based on whether one of the Administration pages is being visited.</span></span>
3. <span data-ttu-id="f5c3f-144">特別針對 [系統管理] 區段建立新的主版頁面、[從 `Site.master`複製標記]、新增 [管理] 區段特定的資訊和連結，然後更新 [`~/Admin`] 資料夾中的 [內容] 頁面，以使用此新的主版頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-144">Create a new master page specifically for the Administration section, copy over the markup from `Site.master`, add the Administration section-specific information and links, and then update the content pages in the `~/Admin` folder to use this new master page.</span></span>
4. <span data-ttu-id="f5c3f-145">建立系結至 `Site.master` 的嵌套主版頁面，並讓 `~/Admin` 資料夾中的內容頁使用這個新的嵌套主版頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-145">Create a nested master page that binds to `Site.master` and have the content pages in the `~/Admin` folder use this new nested master page.</span></span> <span data-ttu-id="f5c3f-146">這個嵌套的主版頁面只會包含系統管理頁面的其他資訊和連結，而且不需要重複已在 `Site.master`中定義的標記。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-146">This nested master page would include just the additional information and links specific to the Administration pages and would not need to repeat the markup already defined in `Site.master`.</span></span>

<span data-ttu-id="f5c3f-147">第一個選項是最少的可行。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-147">The first option is the least palatable.</span></span> <span data-ttu-id="f5c3f-148">使用主版頁面的重點在於，您必須手動將一般標記複製並貼到新的 ASP.NET 網頁。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-148">The whole point of using master pages is to move away from having to manually copy and paste common markup to new ASP.NET pages.</span></span> <span data-ttu-id="f5c3f-149">第二個選項是可接受的，但可讓應用程式的維護變得較少，因為它會以僅偶爾顯示的標記 bulks 主版頁面，而且需要開發人員編輯主版頁面以解決此標記，而且必須記住何時，確切地，會顯示特定標記，而不是隱藏。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-149">The second option is acceptable, but makes the application less maintainable as it bulks up the master pages with markup that is only occasionally displayed and requires developers editing the master page to work around this markup and to have to remember when, exactly, certain markup is displayed versus when it is hidden.</span></span> <span data-ttu-id="f5c3f-150">這種方法比較不 tenable，因為自訂更多類型的網頁需要此單一主版頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-150">This approach would be less tenable as customizations from more and more types of web pages needed to be accommodated by this single master page.</span></span>

<span data-ttu-id="f5c3f-151">第三個選項會移除使用第二個選項所呈現的雜亂和複雜性問題。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-151">The third option removes the clutter and complexity issues the surfaced with the second option.</span></span> <span data-ttu-id="f5c3f-152">不過，第三個主要缺點是，它需要我們將一般版面配置從 `Site.master` 複製並貼到新的管理區段特定的主版頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-152">However, option three's main drawback is that it requires us to copy and paste the common layout from `Site.master` to the new Administration section-specific master page.</span></span> <span data-ttu-id="f5c3f-153">如果稍後決定變更全網站的版面配置，我們必須記得在兩個地方進行變更。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-153">If we later decide to change the site-wide layout we have to remember to change it in two places.</span></span>

<span data-ttu-id="f5c3f-154">第四個選項 [嵌套主版頁面] 提供了第二個和第三個選項的最佳選擇。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-154">The fourth option, nested master pages, give us the best of the second and third options.</span></span> <span data-ttu-id="f5c3f-155">全網站的版面配置資訊會保留在一個檔案中，也就是最上層主版頁面，而特定區域特定的內容則會分成不同的檔案。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-155">The site-wide layout information is maintained in one file - the top-level master page - while the content specific to particular regions is separated out into different files.</span></span>

<span data-ttu-id="f5c3f-156">本教學課程一開始會介紹如何建立和使用簡單的嵌套主版頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-156">This tutorial starts with a look at creating and using a simple nested master page.</span></span> <span data-ttu-id="f5c3f-157">我們會建立全新的頂層主版頁面、兩個嵌套主版頁面，以及兩個內容頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-157">We create a brand new top-level master page, two nested master pages, and two content pages.</span></span> <span data-ttu-id="f5c3f-158">從「使用適用于系統管理的內嵌主版頁面」一節，我們將探討如何更新現有的主版頁面架構，以包含使用嵌套主版頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-158">Starting with "Using a Nested Master Page for the Administration Section," we look at updating our existing master page architecture to include the use of nested master pages.</span></span> <span data-ttu-id="f5c3f-159">具體而言，我們會建立一個嵌套的主版頁面，並用它在 [`~/Admin`] 資料夾中包含內容頁面的其他自訂內容。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-159">Specifically, we create a nested master page and use it to include additional custom content for the content pages in the `~/Admin` folder.</span></span>

## <a name="step-1-creating-a-simple-top-level-master-page"></a><span data-ttu-id="f5c3f-160">步驟1：建立簡單的頂層主版頁面</span><span class="sxs-lookup"><span data-stu-id="f5c3f-160">Step 1: Creating a Simple Top-Level Master Page</span></span>

<span data-ttu-id="f5c3f-161">根據其中一個現有的主版頁面建立嵌套的主要頁面，然後將現有的內容頁更新為使用這個新的嵌套主版頁面，而不是最上層的主版頁面，因為現有的內容頁已經預期在最上層主版頁面中定義的 ContentPlaceHolder 控制項。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-161">Creating a nested master based on one of the existing master pages and then updating an existing content page to use this new nested master page instead of the top-level master page entails some complexity because the existing content pages already expect certain ContentPlaceHolder controls defined in the top-level master page.</span></span> <span data-ttu-id="f5c3f-162">因此，嵌套主版頁面也必須包含具有相同名稱的相同 ContentPlaceHolder 控制項。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-162">Therefore, the nested master page must also include the same ContentPlaceHolder controls with the same names.</span></span> <span data-ttu-id="f5c3f-163">此外，我們的特定示範應用程式會根據使用者的喜好設定，以動態方式指派給內容頁面的兩個主版頁面（`Site.master` 和 `Alternate.master`），這會進一步增加這種複雜性。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-163">Furthermore, our particular demo application has two master pages (`Site.master` and `Alternate.master`) that are dynamically assigned to a content page based on a user's preferences, which further adds to this complexity.</span></span> <span data-ttu-id="f5c3f-164">我們將在本教學課程稍後的更新現有的應用程式以使用嵌套主版頁面，但讓我們先專注于簡單的嵌套主版頁面範例。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-164">We will look at updating the existing application to use nested master pages later in this tutorial, but let's first focus on a simple nested master pages example.</span></span>

<span data-ttu-id="f5c3f-165">建立名為 `NestedMasterPages` 的新資料夾，然後將新的主版分頁檔新增至名為 `Simple.master`的資料夾。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-165">Create a new folder named `NestedMasterPages` and then add a new master page file to that folder named `Simple.master`.</span></span> <span data-ttu-id="f5c3f-166">（請參閱 [圖 1]，以取得在新增這個資料夾和檔案之後，方案總管的螢幕擷取畫面）。將 `AlternateStyles.css` 樣式表單檔案從方案總管拖曳到設計工具上。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-166">(See Figure 1 for a screen shot of the Solution Explorer after this folder and file have been added.) Drag the `AlternateStyles.css` style sheet file from the Solution Explorer onto the Designer.</span></span> <span data-ttu-id="f5c3f-167">這樣會將 `<link>` 專案加入至 `<head>` 元素中的樣式表單檔案，在此之後，主版頁面的 `<head>` 元素的標記看起來應該像這樣：</span><span class="sxs-lookup"><span data-stu-id="f5c3f-167">This adds a `<link>` element to the style sheet file in the `<head>` element, after which the master page's `<head>` element's markup should look like:</span></span>

[!code-aspx[Main](nested-master-pages-vb/samples/sample1.aspx)]

<span data-ttu-id="f5c3f-168">接下來，在 `Simple.master`的 Web 表單中新增下列標記：</span><span class="sxs-lookup"><span data-stu-id="f5c3f-168">Next, add the following markup within the Web Form of `Simple.master`:</span></span>

[!code-aspx[Main](nested-master-pages-vb/samples/sample2.aspx)]

<span data-ttu-id="f5c3f-169">此標記會顯示標題為「嵌套主版頁面（簡單）」的連結，其位於頁面頂端的海軍藍背景上的大白色字型。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-169">This markup displays a link titled "Nested Master Pages (Simple)" at the top of the page in a large white font on a navy background.</span></span> <span data-ttu-id="f5c3f-170">底下是 `MainContent` ContentPlaceHolder。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-170">Beneath that is the `MainContent` ContentPlaceHolder.</span></span> <span data-ttu-id="f5c3f-171">[圖 1] 顯示在 Visual Studio 設計工具中載入時的 `Simple.master` 主版頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-171">Figure 1 shows the `Simple.master` master page when loaded in the Visual Studio Designer.</span></span>

<span data-ttu-id="f5c3f-172">[![嵌套的主版頁面定義 [管理] 區段中頁面的特定內容](nested-master-pages-vb/_static/image2.png)](nested-master-pages-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="f5c3f-172">[![The Nested Master Page Defines Content Specific to the Pages in the Administration Section](nested-master-pages-vb/_static/image2.png)](nested-master-pages-vb/_static/image1.png)</span></span>

<span data-ttu-id="f5c3f-173">**圖 01**：嵌套的主版頁面定義 [系統管理] 區段中頁面的特定內容（[按一下以查看完整大小的影像](nested-master-pages-vb/_static/image3.png)）</span><span class="sxs-lookup"><span data-stu-id="f5c3f-173">**Figure 01**: The Nested Master Page Defines Content Specific to the Pages in the Administration Section ([Click to view full-size image](nested-master-pages-vb/_static/image3.png))</span></span>

## <a name="step-2-creating-a-simple-nested-master-page"></a><span data-ttu-id="f5c3f-174">步驟2：建立簡單的嵌套主版頁面</span><span class="sxs-lookup"><span data-stu-id="f5c3f-174">Step 2: Creating a Simple Nested Master Page</span></span>

<span data-ttu-id="f5c3f-175">`Simple.master` 包含兩個 ContentPlaceHolder 控制項：我們在 Web 表單中新增的 `MainContent` ContentPlaceHolder，以及 `<head>` 元素中的 `head` ContentPlaceHolder。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-175">`Simple.master` contains two ContentPlaceHolder controls: the `MainContent` ContentPlaceHolder we added within the Web Form along with the `head` ContentPlaceHolder in the `<head>` element.</span></span> <span data-ttu-id="f5c3f-176">如果我們要建立內容頁面，並將它系結至 `Simple.master` [內容] 頁面會有兩個參考這兩個 ContentPlaceHolders 的內容控制項。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-176">If we were to create a content page and bind it to `Simple.master` the content page would have two Content controls referencing the two ContentPlaceHolders.</span></span> <span data-ttu-id="f5c3f-177">同樣地，如果我們建立一個嵌套的主版頁面，並將它系結至 `Simple.master` 則嵌套的主版頁面會有兩個內容控制項。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-177">Similarly, if we create a nested master page and bind it to `Simple.master` then the nested master page will have two Content controls.</span></span>

<span data-ttu-id="f5c3f-178">讓我們將新的嵌套主版頁面新增至名為 `SimpleNested.master`的 `NestedMasterPages` 資料夾。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-178">Let's add a new nested master page to the `NestedMasterPages` folder named `SimpleNested.master`.</span></span> <span data-ttu-id="f5c3f-179">以滑鼠右鍵按一下 [`NestedMasterPages`] 資料夾，然後選擇 [加入新專案]。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-179">Right-click on the `NestedMasterPages` folder and choose Add New Item.</span></span> <span data-ttu-id="f5c3f-180">這會顯示 [圖 2] 所示的 [新增專案] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-180">This brings up the Add New Item dialog box shown in Figure 2.</span></span> <span data-ttu-id="f5c3f-181">選取主版頁面範本類型，並輸入新主版頁面的名稱。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-181">Select the Master Page template type and type in the name of the new master page.</span></span> <span data-ttu-id="f5c3f-182">若要指出新的主版頁面應該是嵌套的主版頁面，請核取 [選取主版頁面] 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-182">To indicate that the new master page should be a nested master page, check the "Select master page" checkbox.</span></span>

<span data-ttu-id="f5c3f-183">接下來，按一下 [新增] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-183">Next, click the Add button.</span></span> <span data-ttu-id="f5c3f-184">這會顯示將內容頁系結至主版頁面時，所看到的相同 [選取主版頁面] 對話方塊（請參閱 [圖 3]）。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-184">This will display the same Select a Master Page dialog box you see when binding a content page to a master page (see Figure 3).</span></span> <span data-ttu-id="f5c3f-185">選擇 [`NestedMasterPages`] 資料夾中的 [`Simple.master` 主版] 頁面，然後按一下 [確定]。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-185">Choose the `Simple.master` master page in the `NestedMasterPages` folder and click OK.</span></span>

> [!NOTE]
> <span data-ttu-id="f5c3f-186">如果您使用 Web 應用程式專案模型（而不是網站專案模型）來建立 ASP.NET 網站，則 [圖 2] 所示的 [新增專案] 對話方塊中不會顯示 [選取主版頁面] 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-186">If you created your ASP.NET website using the Web Application Project model instead of the Web Site Project model you will not see the "Select master page" checkbox in the Add New Item dialog box shown in Figure 2.</span></span> <span data-ttu-id="f5c3f-187">若要在使用 Web 應用程式專案模型時建立嵌套主版頁面，您必須選擇 [嵌套的主版頁面] 範本（而不是 [主版頁面] 範本）。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-187">To create a nested master page when using the Web Application Project model you must choose the Nested Master Page template (instead of the Master Page template).</span></span> <span data-ttu-id="f5c3f-188">選取嵌套的主版頁面範本並按一下 [新增] 之後，[圖 3] 所示的 [選取主版頁面] 對話方塊隨即出現。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-188">After selecting the Nested Master Page template and clicking Add, the same Select a Master Page dialog box shown in Figure 3 will appear.</span></span>

<span data-ttu-id="f5c3f-189">[![檢查 &quot;選取 [主版頁面]&quot; 核取方塊以新增嵌套的主版頁面](nested-master-pages-vb/_static/image5.png)](nested-master-pages-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="f5c3f-189">[![Check the &quot;Select master page&quot; Checkbox to Add a Nested Master Page](nested-master-pages-vb/_static/image5.png)](nested-master-pages-vb/_static/image4.png)</span></span>

<span data-ttu-id="f5c3f-190">**圖 02**：核取 [選取主版頁面] 核取方塊以新增嵌套的主版頁面（[按一下以觀看完整大小的影像](nested-master-pages-vb/_static/image6.png)）</span><span class="sxs-lookup"><span data-stu-id="f5c3f-190">**Figure 02**: Check the "Select master page" Checkbox to Add a Nested Master Page ([Click to view full-size image](nested-master-pages-vb/_static/image6.png))</span></span>

<span data-ttu-id="f5c3f-191">[![將嵌套的主版頁面系結至簡單的主要主版頁面](nested-master-pages-vb/_static/image8.png)](nested-master-pages-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="f5c3f-191">[![Bind the Nested Master Page to the Simple.master Master Page](nested-master-pages-vb/_static/image8.png)](nested-master-pages-vb/_static/image7.png)</span></span>

<span data-ttu-id="f5c3f-192">**圖 03**：將嵌套的主版頁面系結至 `Simple.master` 主版頁面（[按一下以查看完整大小的影像](nested-master-pages-vb/_static/image9.png)）</span><span class="sxs-lookup"><span data-stu-id="f5c3f-192">**Figure 03**: Bind the Nested Master Page to the `Simple.master` Master Page ([Click to view full-size image](nested-master-pages-vb/_static/image9.png))</span></span>

<span data-ttu-id="f5c3f-193">如下所示，嵌套主版頁面的宣告式標記包含兩個內容控制項，其中參考最上層主版頁面的兩個 ContentPlaceHolder 控制項。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-193">The nested master page's declarative markup, shown below, contains two Content controls referencing the top-level master page's two ContentPlaceHolder controls.</span></span>

[!code-aspx[Main](nested-master-pages-vb/samples/sample3.aspx)]

<span data-ttu-id="f5c3f-194">除了 `<%@ Master %>` 指示詞之外，嵌套主版頁面的初始宣告式標記與將內容頁系結至相同的最上層主版頁面時一開始產生的標記相同。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-194">Except for the `<%@ Master %>` directive, the nested master page's initial declarative markup is identical to the markup that is initially generated when binding a content page to the same top-level master page.</span></span> <span data-ttu-id="f5c3f-195">如同內容頁的 `<%@ Page %>` 指示詞，這裡的 `<%@ Master %>` 指示詞包含一個 `MasterPageFile` 屬性，可指定嵌套主版頁面的父主版頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-195">Like a content page's `<%@ Page %>` directive, the `<%@ Master %>` directive here includes a `MasterPageFile` attribute that specifies the nested master page's parent master page.</span></span> <span data-ttu-id="f5c3f-196">嵌套主版頁面和系結至相同頂層主版頁面的內容頁面之間的主要差異在於，嵌套主版頁面可以包含 ContentPlaceHolder 控制項。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-196">The main difference between the nested master page and a content page bound to the same top-level master page is that the nested master page can include ContentPlaceHolder controls.</span></span> <span data-ttu-id="f5c3f-197">嵌套主版頁面的 ContentPlaceHolder 控制項會定義內容頁面可以自訂標記的區域。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-197">The nested master page's ContentPlaceHolder controls define the regions where the content pages can customize the markup.</span></span>

<span data-ttu-id="f5c3f-198">更新此嵌套的主版頁面，使其顯示 "Hello，from SimpleNested！" 文字</span><span class="sxs-lookup"><span data-stu-id="f5c3f-198">Update this nested master page so that it displays the text "Hello, from SimpleNested!"</span></span> <span data-ttu-id="f5c3f-199">在對應至 `MainContent` ContentPlaceHolder 控制項的內容控制項中。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-199">in the Content control that corresponds to the `MainContent` ContentPlaceHolder control.</span></span>

[!code-aspx[Main](nested-master-pages-vb/samples/sample4.aspx)]

<span data-ttu-id="f5c3f-200">進行這種新增之後，請儲存嵌套的主版頁面，然後將新的內容頁面新增至名為 `Default.aspx`的 `NestedMasterPages` 資料夾，並將它系結至 `SimpleNested.master` 主版頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-200">After making this addition, save the nested master page and then add a new content page to the `NestedMasterPages` folder named `Default.aspx`, and bind it to the `SimpleNested.master` master page.</span></span> <span data-ttu-id="f5c3f-201">新增此頁面時，您可能會很驚訝地發現它沒有包含任何內容控制項（請參閱 [圖 4]）！</span><span class="sxs-lookup"><span data-stu-id="f5c3f-201">Upon adding this page you may be surprised to see that it contains no Content controls (see Figure 4)!</span></span> <span data-ttu-id="f5c3f-202">內容頁面只能存取其*父*主版頁面的 ContentPlaceHolders。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-202">A content page can only access its *parent* master page's ContentPlaceHolders.</span></span> <span data-ttu-id="f5c3f-203">`SimpleNested.master` 不包含任何 ContentPlaceHolder 控制項;因此，系結至此主版頁面的任何內容頁面都不能包含任何內容控制項。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-203">`SimpleNested.master` does not contain any ContentPlaceHolder controls; therefore, any content page bound to this master page cannot contain any Content controls.</span></span>

<span data-ttu-id="f5c3f-204">[![[新增內容] 頁面未包含內容控制項](nested-master-pages-vb/_static/image11.png)](nested-master-pages-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="f5c3f-204">[![The New Content Page Contains No Content Controls](nested-master-pages-vb/_static/image11.png)](nested-master-pages-vb/_static/image10.png)</span></span>

<span data-ttu-id="f5c3f-205">**圖 04**： [新增內容] 頁面未包含內容控制項（[按一下以觀看完整大小的影像](nested-master-pages-vb/_static/image12.png)）</span><span class="sxs-lookup"><span data-stu-id="f5c3f-205">**Figure 04**: The New Content Page Contains No Content Controls ([Click to view full-size image](nested-master-pages-vb/_static/image12.png))</span></span>

<span data-ttu-id="f5c3f-206">我們需要更新嵌套主版頁面（`SimpleNested.master`），以包含 ContentPlaceHolder 控制項。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-206">What we need to do is update the nested master page (`SimpleNested.master`) to include ContentPlaceHolder controls.</span></span> <span data-ttu-id="f5c3f-207">一般來說，您會希望您的嵌套主版頁面包含其父主版頁面所定義之每個 ContentPlaceHolder 的 ContentPlaceHolder，藉此允許其子主版頁面或內容頁使用任何頂層主版頁面的 ContentPlaceHoldercontrols.</span><span class="sxs-lookup"><span data-stu-id="f5c3f-207">Typically you'll want your nested master pages to include a ContentPlaceHolder for each ContentPlaceHolder defined by its parent master page, thereby allowing its child master page or content page to work with any of the top-level master page's ContentPlaceHolder controls.</span></span>

<span data-ttu-id="f5c3f-208">更新 `SimpleNested.master` 主版頁面，以在其兩個內容控制項中包含 ContentPlaceHolder。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-208">Update the `SimpleNested.master` master page to include a ContentPlaceHolder in its two Content controls.</span></span> <span data-ttu-id="f5c3f-209">提供 ContentPlaceHolder 控制項與內容控制項所參考之 ContentPlaceHolder 控制項相同的名稱。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-209">Give the ContentPlaceHolder controls the same name as the ContentPlaceHolder control their Content control refers to.</span></span> <span data-ttu-id="f5c3f-210">也就是在 `SimpleNested.master` 中，將名為 `MainContent` 的 ContentPlaceHolder 控制項新增至參考 `Simple.master`中 `MainContent` ContentPlaceHolder 的內容控制項。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-210">That is, add a ContentPlaceHolder control named `MainContent` to the Content control in `SimpleNested.master` that references the `MainContent` ContentPlaceHolder in `Simple.master`.</span></span> <span data-ttu-id="f5c3f-211">在參考 `head` ContentPlaceHolder 的內容控制項中執行相同的動作。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-211">Do the same thing in the Content control that references the `head` ContentPlaceHolder.</span></span>

> [!NOTE]
> <span data-ttu-id="f5c3f-212">雖然我建議將嵌套主版頁面中的 ContentPlaceHolder 控制項命名為與頂層主版頁面中的 ContentPlaceHolders 相同，但不需要此命名對稱。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-212">While I recommend naming the ContentPlaceHolder controls in the nested master page the same as the ContentPlaceHolders in the top-level master page, this naming symmetry is not required.</span></span> <span data-ttu-id="f5c3f-213">您可以用您喜歡的任何名稱，在您的嵌套主版頁面中提供 ContentPlaceHolder 控制項。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-213">You can give the ContentPlaceHolder controls in your nested master page any name you like.</span></span> <span data-ttu-id="f5c3f-214">不過，如果我的頂層主版頁面和嵌套主版頁面使用相同的名稱，我覺得比較容易記住，ContentPlaceHolders 會與頁面的哪些區域相對應。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-214">However, I find it easier to remember what ContentPlaceHolders correspond with what regions of the page if my top-level master page and nested master pages use the same names.</span></span>

<span data-ttu-id="f5c3f-215">新增這些專案之後，您 `SimpleNested.master` 主版頁面的宣告式標記看起來應該像下面這樣：</span><span class="sxs-lookup"><span data-stu-id="f5c3f-215">After making these additions your `SimpleNested.master` master page's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](nested-master-pages-vb/samples/sample5.aspx)]

<span data-ttu-id="f5c3f-216">刪除剛建立的 `Default.aspx` 內容頁面，然後將它重新加入，並將它系結至 `SimpleNested.master` 主版頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-216">Delete the `Default.aspx` content page we just created and then re-add it, binding it to the `SimpleNested.master` master page.</span></span> <span data-ttu-id="f5c3f-217">這次 Visual Studio 會將兩個內容控制項新增至 `Default.aspx`，並參考目前在 `SimpleNested.master` 中定義的 ContentPlaceHolders （請參閱 [圖 6]）。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-217">This time Visual Studio adds two Content controls to the `Default.aspx`, referencing the ContentPlaceHolders now defined in `SimpleNested.master` (see Figure 6).</span></span> <span data-ttu-id="f5c3f-218">加入文字 "Hello，from default.aspx！"</span><span class="sxs-lookup"><span data-stu-id="f5c3f-218">Add the text, "Hello, from Default.aspx!"</span></span> <span data-ttu-id="f5c3f-219">在 `MainContent`參考的內容控制項中。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-219">in the Content control that referenced `MainContent`.</span></span>

<span data-ttu-id="f5c3f-220">[圖 5] 顯示這裡所牽涉到的三個實體-`Simple.master`、`SimpleNested.master`和 `Default.aspx`，以及它們彼此之間的關聯性。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-220">Figure 5 shows the three entities involved here - `Simple.master`, `SimpleNested.master`, and `Default.aspx` - and how they relate to one another.</span></span> <span data-ttu-id="f5c3f-221">如圖所示，嵌套的主版頁面會執行其父系 ContentPlaceHolder 的內容控制項。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-221">As the diagram shows, the nested master page implements Content controls for its parent's ContentPlaceHolder.</span></span> <span data-ttu-id="f5c3f-222">如果這些區域需要可供 [內容] 頁面存取，則嵌套的主版頁面必須將自己的 ContentPlaceHolders 新增至內容控制項。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-222">If these regions need to be accessible to the content page, the nested master page must add its own ContentPlaceHolders to the Content controls.</span></span>

<span data-ttu-id="f5c3f-223">[![最上層和嵌套主版頁面，指示內容頁面的版面配置](nested-master-pages-vb/_static/image14.png)](nested-master-pages-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="f5c3f-223">[![The Top-Level and Nested Master Pages Dictate the Content Page's Layout](nested-master-pages-vb/_static/image14.png)](nested-master-pages-vb/_static/image13.png)</span></span>

<span data-ttu-id="f5c3f-224">**圖 05**：最上層和嵌套主版頁面會指示內容頁面的版面配置（[按一下以觀看完整大小的影像](nested-master-pages-vb/_static/image15.png)）</span><span class="sxs-lookup"><span data-stu-id="f5c3f-224">**Figure 05**: The Top-Level and Nested Master Pages Dictate the Content Page's Layout ([Click to view full-size image](nested-master-pages-vb/_static/image15.png))</span></span>

<span data-ttu-id="f5c3f-225">此行為說明內容頁或主版頁面只 cognizant 其父主版頁面的方式。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-225">This behavior illustrates how a content page or master page is only cognizant of its parent master page.</span></span> <span data-ttu-id="f5c3f-226">Visual Studio 的設計工具也會指出這個行為。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-226">This behavior is also indicated by the Visual Studio Designer.</span></span> <span data-ttu-id="f5c3f-227">[圖 6] 顯示 `Default.aspx`的設計工具。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-227">Figure 6 shows the Designer for `Default.aspx`.</span></span> <span data-ttu-id="f5c3f-228">雖然設計工具清楚地顯示可從 [內容] 頁面編輯哪些區域，以及哪些部分不存在，但它並不會區分哪些不可編輯的區域是來自于嵌套的主版頁面，以及哪些地區是來自最上層主版頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-228">While the Designer clearly shows what regions are editable from the content page and what portions aren't, it doesn't disambiguate what non-editable regions are from the nested master page and what regions are from the top-level master page.</span></span>

<span data-ttu-id="f5c3f-229">[![[內容] 頁面現在包含已嵌套主版頁面 ContentPlaceHolders 的內容控制項](nested-master-pages-vb/_static/image17.png)](nested-master-pages-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="f5c3f-229">[![The Content Page Now Includes Content Controls for the Nested Master Page's ContentPlaceHolders](nested-master-pages-vb/_static/image17.png)](nested-master-pages-vb/_static/image16.png)</span></span>

<span data-ttu-id="f5c3f-230">**圖 06**： [內容] 頁面現在包含嵌套主版頁面 ContentPlaceHolders 的內容控制項（[按一下以觀看完整大小的影像](nested-master-pages-vb/_static/image18.png)）</span><span class="sxs-lookup"><span data-stu-id="f5c3f-230">**Figure 06**: The Content Page Now Includes Content Controls for the Nested Master Page's ContentPlaceHolders ([Click to view full-size image](nested-master-pages-vb/_static/image18.png))</span></span>

## <a name="step-3-adding-a-second-simple-nested-master-page"></a><span data-ttu-id="f5c3f-231">步驟3：新增第二個簡單的嵌套主版頁面</span><span class="sxs-lookup"><span data-stu-id="f5c3f-231">Step 3: Adding a Second Simple Nested Master Page</span></span>

<span data-ttu-id="f5c3f-232">當有多個嵌套主版頁面時，嵌套主版頁面的優點較明顯。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-232">The benefit of nested master pages is more evident when there are multiple nested master pages.</span></span> <span data-ttu-id="f5c3f-233">為了說明這項優點，請在 [`NestedMasterPages`] 資料夾中建立另一個嵌套的主版頁面;將這個新的嵌套主版頁面命名為 `SimpleNestedAlternate.master`，並將它系結至 `Simple.master` 主版頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-233">To illustrate this benefit, create another nested master page in the `NestedMasterPages` folder; name this new nested master page `SimpleNestedAlternate.master` and bind it to the `Simple.master` master page.</span></span> <span data-ttu-id="f5c3f-234">在嵌套主版頁面的兩個內容控制項中新增 ContentPlaceHolder 控制項，就像我們在步驟2中所做的一樣。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-234">Add ContentPlaceHolder controls in the nested master page's two Content controls like we did in Step 2.</span></span> <span data-ttu-id="f5c3f-235">同時新增 "Hello，from SimpleNestedAlternate！" 文字</span><span class="sxs-lookup"><span data-stu-id="f5c3f-235">Also add the text, "Hello, from SimpleNestedAlternate!"</span></span> <span data-ttu-id="f5c3f-236">在對應至頂層主版頁面的內容控制項中，`MainContent` ContentPlaceHolder。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-236">in the Content control that corresponds to the top-level master page's `MainContent` ContentPlaceHolder.</span></span> <span data-ttu-id="f5c3f-237">進行這些變更之後，新的嵌套主版頁面的宣告式標記看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="f5c3f-237">After making these changes your new nested master page's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](nested-master-pages-vb/samples/sample6.aspx)]

<span data-ttu-id="f5c3f-238">在 `NestedMasterPages` 資料夾中建立名為 `Alternate.aspx` 的內容頁面，並將它系結至 `SimpleNestedAlternate.master` 的嵌套主版頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-238">Create a content page named `Alternate.aspx` in the `NestedMasterPages` folder and bind it to the `SimpleNestedAlternate.master` nested master page.</span></span> <span data-ttu-id="f5c3f-239">新增 "Hello，from 替代！" 文字</span><span class="sxs-lookup"><span data-stu-id="f5c3f-239">Add the text, "Hello, from Alternate!"</span></span> <span data-ttu-id="f5c3f-240">在對應至 `MainContent`的內容控制項中。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-240">in the Content control that corresponds to `MainContent`.</span></span> <span data-ttu-id="f5c3f-241">[圖 7] 顯示透過 Visual Studio 設計工具觀看 `Alternate.aspx`。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-241">Figure 7 shows `Alternate.aspx` when viewed through the Visual Studio Designer.</span></span>

<span data-ttu-id="f5c3f-242">[![的 default.aspx 會系結至 SimpleNestedAlternate 主版頁面](nested-master-pages-vb/_static/image20.png)](nested-master-pages-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="f5c3f-242">[![Alternate.aspx is Bound to the SimpleNestedAlternate.master Master Page](nested-master-pages-vb/_static/image20.png)](nested-master-pages-vb/_static/image19.png)</span></span>

<span data-ttu-id="f5c3f-243">**圖 07**： `Alternate.aspx` 系結至 `SimpleNestedAlternate.master` 主版頁面（[按一下以觀看完整大小的影像](nested-master-pages-vb/_static/image21.png)）</span><span class="sxs-lookup"><span data-stu-id="f5c3f-243">**Figure 07**: `Alternate.aspx` is Bound to the `SimpleNestedAlternate.master` Master Page ([Click to view full-size image](nested-master-pages-vb/_static/image21.png))</span></span>

<span data-ttu-id="f5c3f-244">將 [圖 7] 中的設計工具與 [圖 6] 中的設計工具做比較。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-244">Compare the Designer in Figure 7 to the Designer in Figure 6.</span></span> <span data-ttu-id="f5c3f-245">這兩個內容頁面共用最上層主版頁面（`Simple.master`）中所定義的相同配置，也就是「嵌套主版頁面教學課程（簡單）」標題。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-245">Both content pages share the same layout defined in the top-level master page (`Simple.master`), namely the "Nested Master Pages Tutorial (Simple)" title.</span></span> <span data-ttu-id="f5c3f-246">同時在其父主版頁面中定義了不同的內容，也就是 "Hello，from SimpleNested！"</span><span class="sxs-lookup"><span data-stu-id="f5c3f-246">Yet both have distinct content defined in their parent master pages - the text "Hello, from SimpleNested!"</span></span> <span data-ttu-id="f5c3f-247">在 [圖 6] 和 "Hello，from SimpleNestedAlternate！"</span><span class="sxs-lookup"><span data-stu-id="f5c3f-247">in Figure 6 and "Hello, from SimpleNestedAlternate!"</span></span> <span data-ttu-id="f5c3f-248">如 [圖 7] 所示。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-248">in Figure 7.</span></span> <span data-ttu-id="f5c3f-249">不過，這裡的差異很簡單，但您可以擴充此範例，以包含更有意義的差異。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-249">Granted, these differences here are trivial, but you could extend this example to include more meaningful differences.</span></span> <span data-ttu-id="f5c3f-250">例如，`SimpleNested.master` 頁面可能會包含一個功能表，其中包含其內容頁面特有的選項，而 `SimpleNestedAlternate.master` 可能會有與系結至它的內容頁面相關的資訊。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-250">For instance, the `SimpleNested.master` page might include a menu with options specific to its content pages, whereas `SimpleNestedAlternate.master` might have information pertinent to the content pages that bind to it.</span></span>

<span data-ttu-id="f5c3f-251">現在，假設我們需要變更整體的網站版面配置。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-251">Now, imagine that we needed to make a change to the overarching site layout.</span></span> <span data-ttu-id="f5c3f-252">例如，假設我們想要將通用連結清單新增至所有內容頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-252">For example, imagine that we wanted to add a list of common links to all content pages.</span></span> <span data-ttu-id="f5c3f-253">為了達到此目的，我們會更新頂層主版頁面，`Simple.master`。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-253">To accomplish this we update the top-level master page, `Simple.master`.</span></span> <span data-ttu-id="f5c3f-254">任何變更都會立即反映在其嵌套主版頁面中，並依擴充功能的內容頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-254">Any changes there are immediately reflected in its nested master pages and, by extension, their content pages.</span></span>

<span data-ttu-id="f5c3f-255">為了示範我們可以變更主要網站版面配置的便利性，請開啟 `Simple.master` 主版頁面，並在 `topContent` 和 `mainContent` `<div>` 專案之間新增下列標記：</span><span class="sxs-lookup"><span data-stu-id="f5c3f-255">To demonstrate the ease with which we can change the overarching site layout, open the `Simple.master` master page and add the following markup between the `topContent` and `mainContent` `<div>` elements:</span></span>

[!code-aspx[Main](nested-master-pages-vb/samples/sample7.aspx)]

<span data-ttu-id="f5c3f-256">這會在系結至 `Simple.master`、`SimpleNested.master`或 `SimpleNestedAlternate.master`的每個頁面頂端加上兩個連結。這些變更會立即套用至所有的嵌套主版頁面及其內容頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-256">This adds two links to the top of every page that binds to `Simple.master`, `SimpleNested.master`, or `SimpleNestedAlternate.master`; these changes apply to all nested master pages and their content pages immediately.</span></span> <span data-ttu-id="f5c3f-257">[圖 8] 顯示透過瀏覽器觀看 `Alternate.aspx`。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-257">Figure 8 shows `Alternate.aspx` when viewed through a browser.</span></span> <span data-ttu-id="f5c3f-258">請注意，在頁面頂端新增連結（相較于 [圖 7]）。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-258">Note the addition of the links at the top of the page (compared to Figure 7).</span></span>

<span data-ttu-id="f5c3f-259">[![變更為頂層主版頁面，會立即反映在其嵌套主版頁面及其內容頁面中](nested-master-pages-vb/_static/image23.png)](nested-master-pages-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="f5c3f-259">[![Changed to the Top-Level Master Page are Immediately Reflected in its Nested Master Pages and Their Content Pages](nested-master-pages-vb/_static/image23.png)](nested-master-pages-vb/_static/image22.png)</span></span>

<span data-ttu-id="f5c3f-260">**圖 08**：變更為最上層主版頁面會立即反映在其嵌套主版頁面及其內容頁面中（[按一下以查看完整大小的影像](nested-master-pages-vb/_static/image24.png)）</span><span class="sxs-lookup"><span data-stu-id="f5c3f-260">**Figure 08**: Changed to the Top-Level Master Page are Immediately Reflected in its Nested Master Pages and Their Content Pages ([Click to view full-size image](nested-master-pages-vb/_static/image24.png))</span></span>

## <a name="using-a-nested-master-page-for-the-administration-section"></a><span data-ttu-id="f5c3f-261">使用系統管理區段的嵌套主版頁面</span><span class="sxs-lookup"><span data-stu-id="f5c3f-261">Using a Nested Master Page for the Administration Section</span></span>

<span data-ttu-id="f5c3f-262">此時，我們已經探討了嵌套主版頁面的優點，並瞭解如何在 ASP.NET 應用程式中建立和使用它們。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-262">At this point we have looked at the advantages of nested master pages and have seen how to create and use them in an ASP.NET application.</span></span> <span data-ttu-id="f5c3f-263">不過，步驟1、2和3中的範例牽涉到建立新的最上層主版頁面、新的嵌套主版頁面，以及新的內容頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-263">The examples in Steps 1, 2, and 3, however, involved creating a new top-level master page, new nested master pages, and new content pages.</span></span> <span data-ttu-id="f5c3f-264">如何使用現有的最上層主版頁面和內容頁面，將新的嵌套主版頁面新增至網站？</span><span class="sxs-lookup"><span data-stu-id="f5c3f-264">What about adding a new nested master page to a website with an existing top-level master page and content pages?</span></span>

<span data-ttu-id="f5c3f-265">將嵌套的主版頁面整合到現有的網站，並將它與現有的內容頁面建立關聯，需要比從頭開始的工作還多。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-265">Integrating a nested master page into an existing website and associating it with existing content pages requires a bit more effort than starting from scratch.</span></span> <span data-ttu-id="f5c3f-266">步驟4、5、6和7會探索這些挑戰，因為我們會擴充我們的示範應用程式，以包含名為 `AdminNested.master` 的新的嵌套主版頁面，其中包含系統管理員的指示，並由 `~/Admin` 資料夾中的 ASP.NET 網頁使用。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-266">Steps 4, 5, 6, and 7 explore these challenges as we augment our demo application to include a new nested master page named `AdminNested.master` that contains instructions for the administrator and is used by the ASP.NET pages in the `~/Admin` folder.</span></span>

<span data-ttu-id="f5c3f-267">將嵌套的主版頁面整合到示範應用程式中，會帶來下列障礙：</span><span class="sxs-lookup"><span data-stu-id="f5c3f-267">Integrating a nested master page into our demo application introduces the following hurdles:</span></span>

- <span data-ttu-id="f5c3f-268">[`~/Admin`] 資料夾中的現有內容頁面，會有其主版頁面的特定期望。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-268">The existing content pages in the `~/Admin` folder have certain expectations from their master page.</span></span> <span data-ttu-id="f5c3f-269">對於初學者來說，他們預期會出現某些 ContentPlaceHolder 控制項。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-269">For starters, they expect certain ContentPlaceHolder controls to be present.</span></span> <span data-ttu-id="f5c3f-270">此外，`~/Admin/AddProduct.aspx` 和 `~/Admin/Products.aspx` 頁面會呼叫主版頁面的公用 `RefreshRecentProductsGrid` 方法、設定其 `GridMessageText` 屬性，或具有其 `PricesDoubled` 事件的事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-270">Furthermore, the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages call the master page's public `RefreshRecentProductsGrid` method, set its `GridMessageText` property, or have an event handler for its `PricesDoubled` event.</span></span> <span data-ttu-id="f5c3f-271">因此，我們的嵌套主版頁面必須提供相同的 ContentPlaceHolders 和 public 成員。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-271">Consequently, our nested master page must provide the same ContentPlaceHolders and public members.</span></span>
- <span data-ttu-id="f5c3f-272">在先前的教學課程中，我們增強了 `BasePage` 類別，以根據會話變數動態設定 `Page` 物件的 `MasterPageFile` 屬性。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-272">In the preceding tutorial we enhanced the `BasePage` class to dynamically set the `Page` object's `MasterPageFile` property based on a Session variable.</span></span> <span data-ttu-id="f5c3f-273">如何在使用嵌套主版頁面時支援動態主版頁面？</span><span class="sxs-lookup"><span data-stu-id="f5c3f-273">How to we support dynamic master pages when using nested master pages?</span></span>

<span data-ttu-id="f5c3f-274">這兩個挑戰會在我們建立嵌套的主版頁面時呈現，並從現有的內容頁面加以使用。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-274">These two challenges will surface as we build the nested master page and use it from our existing content pages.</span></span> <span data-ttu-id="f5c3f-275">我們會在這些問題發生時加以調查並加以克服。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-275">We'll investigate and surmount these issues as they arise.</span></span>

## <a name="step-4-creating-the-nested-master-page"></a><span data-ttu-id="f5c3f-276">步驟4：建立嵌套的主版頁面</span><span class="sxs-lookup"><span data-stu-id="f5c3f-276">Step 4: Creating the Nested Master Page</span></span>

<span data-ttu-id="f5c3f-277">我們的第一項工作是建立可供 [管理] 區段中的頁面使用的嵌套主版頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-277">Our first task is to create the nested master page to be used by the pages in the Administration section.</span></span> <span data-ttu-id="f5c3f-278">如我們在步驟2所見，加入新的嵌套主版頁面時，我們必須指定嵌套主版頁面的父主版頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-278">As we saw in Step 2, when adding a new nested master page we need to specify the nested master page's parent master page.</span></span> <span data-ttu-id="f5c3f-279">但我們有兩個最上層主版頁面： `Site.master` 和 `Alternate.master`。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-279">But we have two top-level master pages: `Site.master` and `Alternate.master`.</span></span> <span data-ttu-id="f5c3f-280">回想一下，我們已在先前的教學課程中建立 `Alternate.master`，並在 `BasePage` 類別中撰寫程式碼，在執行時間將 `Page` 物件的 `MasterPageFile` 屬性設定為 `Site.master` 或 `Alternate.master` （視 `MyMasterPage` 會話變數的值而定）。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-280">Recall that we created `Alternate.master` in the preceding tutorial and wrote code in the `BasePage` class that set the `Page` object's `MasterPageFile` property at runtime to either `Site.master` or `Alternate.master` depending on the value of the `MyMasterPage` Session variable.</span></span>

<span data-ttu-id="f5c3f-281">如何設定我們的嵌套主版頁面，使其使用適當的頂層主版頁面？</span><span class="sxs-lookup"><span data-stu-id="f5c3f-281">How do we configure our nested master page so that it uses the appropriate top-level master page?</span></span> <span data-ttu-id="f5c3f-282">我們有兩個選項：</span><span class="sxs-lookup"><span data-stu-id="f5c3f-282">We have two options:</span></span>

- <span data-ttu-id="f5c3f-283">建立兩個嵌套的主版頁面，`AdminNestedSite.master` 和 `AdminNestedAlternate.master`，並分別將它們系結至頂層主版頁面 `Site.master` 和 `Alternate.master`。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-283">Create two nested master pages, `AdminNestedSite.master` and `AdminNestedAlternate.master`, and bind them to the top-level master pages `Site.master` and `Alternate.master`, respectively.</span></span> <span data-ttu-id="f5c3f-284">在 `BasePage`中，我們會將 `Page` 物件的 `MasterPageFile` 設定為適當的嵌套主版頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-284">In `BasePage`, then, we'd set the `Page` object's `MasterPageFile` to the appropriate nested master page.</span></span>
- <span data-ttu-id="f5c3f-285">建立單一的嵌套主版頁面，並讓內容頁面使用這個特定的主版頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-285">Create a single nested master page and have the content pages use this particular master page.</span></span> <span data-ttu-id="f5c3f-286">然後，在執行時間，我們需要在執行時間將嵌套主版頁面的 `MasterPageFile` 屬性設定為適當的頂層主版頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-286">Then, at runtime, we'd need to set the nested master page's `MasterPageFile` property to the appropriate top-level master page at runtime.</span></span> <span data-ttu-id="f5c3f-287">（您可能已經知道，主版頁面也有 `MasterPageFile` 的屬性）。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-287">(As you might have figured out by now, master pages also have a `MasterPageFile` property.)</span></span>

<span data-ttu-id="f5c3f-288">讓我們使用第二個選項。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-288">Let's use the second option.</span></span> <span data-ttu-id="f5c3f-289">在名為 `AdminNested.master`的 `~/Admin` 資料夾中，建立單一的嵌套主版分頁檔。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-289">Create a single nested master page file in the `~/Admin` folder named `AdminNested.master`.</span></span> <span data-ttu-id="f5c3f-290">由於 `Site.master` 和 `Alternate.master` 都有相同的 ContentPlaceHolder 控制項集合，雖然我建議您將它系結至 `Site.master` 以求一致。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-290">Because both `Site.master` and `Alternate.master` have the same set of ContentPlaceHolder controls, it doesn't matter what master page you bind it to, although I encourage you to bind it to `Site.master` for consistency's sake.</span></span>

<span data-ttu-id="f5c3f-291">[![將嵌套的主版頁面新增至 ~/Admin 資料夾。](nested-master-pages-vb/_static/image26.png)](nested-master-pages-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="f5c3f-291">[![Add a Nested Master Page to the ~/Admin Folder.](nested-master-pages-vb/_static/image26.png)](nested-master-pages-vb/_static/image25.png)</span></span>

<span data-ttu-id="f5c3f-292">**圖 09**：將嵌套的主版頁面新增至 `~/Admin` 資料夾。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-292">**Figure 09**: Add a Nested Master Page to the `~/Admin` Folder.</span></span> <span data-ttu-id="f5c3f-293">（[按一下以查看完整大小的影像](nested-master-pages-vb/_static/image27.png)）</span><span class="sxs-lookup"><span data-stu-id="f5c3f-293">([Click to view full-size image](nested-master-pages-vb/_static/image27.png))</span></span>

<span data-ttu-id="f5c3f-294">因為嵌套的主版頁面會系結至具有四個 ContentPlaceHolder 控制項的主版頁面，Visual Studio 將四個內容控制項加入至新的嵌套主版頁面檔案的初始標記中。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-294">Because the nested master page is bound to a master page with four ContentPlaceHolder controls, Visual Studio adds four Content controls to the new nested master page file's initial markup.</span></span> <span data-ttu-id="f5c3f-295">就像我們在步驟2和3中所做的一樣，在每個內容控制項中新增 ContentPlaceHolder 控制項，並提供與最上層主版頁面 ContentPlaceHolder 控制項相同的名稱。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-295">Like we did in Steps 2 and 3, add a ContentPlaceHolder control in each Content control, giving it the same name as the top-level master page's ContentPlaceHolder control.</span></span> <span data-ttu-id="f5c3f-296">此外，將下列標記新增至對應至 `MainContent` ContentPlaceHolder 的內容控制項：</span><span class="sxs-lookup"><span data-stu-id="f5c3f-296">Also add the following markup to the Content control that corresponds to the `MainContent` ContentPlaceHolder:</span></span>

[!code-html[Main](nested-master-pages-vb/samples/sample8.html)]

<span data-ttu-id="f5c3f-297">接下來，在 `Styles.css` 和 `AlternateStyles.css` CSS 檔案中定義 `instructions` CSS 類別。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-297">Next, define the `instructions` CSS class in the `Styles.css` and `AlternateStyles.css` CSS files.</span></span> <span data-ttu-id="f5c3f-298">下列 CSS 規則會導致以淺黃色背景色彩和黑色實心框線顯示樣式為 `instructions` 類別的 HTML 專案：</span><span class="sxs-lookup"><span data-stu-id="f5c3f-298">The following CSS rules cause HTML elements styled with the `instructions` class to be displayed with a light yellow background color and a black, solid border:</span></span>

[!code-css[Main](nested-master-pages-vb/samples/sample9.css)]

<span data-ttu-id="f5c3f-299">由於此標記已新增至嵌套的主版頁面，因此它只會出現在使用此嵌套主版頁面的頁面中（也就是 [管理] 區段中的頁面）。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-299">Because this markup has been added to the nested master page, it will only appear in those pages that use this nested master page (namely, the pages in the Administration section).</span></span>

<span data-ttu-id="f5c3f-300">將這些專案新增至您的嵌套主版頁面之後，其宣告式標記看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="f5c3f-300">After making these additions to your nested master page, its declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](nested-master-pages-vb/samples/sample10.aspx)]

<span data-ttu-id="f5c3f-301">請注意，每個內容控制項都有一個 ContentPlaceHolder 控制項，而且 ContentPlaceHolder 控制項的 `ID` 屬性會被指派與頂層主版頁面中對應的 ContentPlaceHolder 控制項相同的值。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-301">Note that each Content control has a ContentPlaceHolder control and that the ContentPlaceHolder controls' `ID` properties are assigned the same values as the corresponding ContentPlaceHolder controls in the top-level master page.</span></span> <span data-ttu-id="f5c3f-302">此外，[管理] 區段特定標記會出現在 [`MainContent`] ContentPlaceHolder 中。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-302">Moreover, the Administration section-specific markup appears in the `MainContent` ContentPlaceHolder.</span></span>

<span data-ttu-id="f5c3f-303">[圖 10] 顯示透過 Visual Studio 的設計工具觀看時，`AdminNested.master` 的嵌套主版頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-303">Figure 10 shows the `AdminNested.master` nested master page when viewed through Visual Studio's Designer.</span></span> <span data-ttu-id="f5c3f-304">您可以在 `MainContent` 內容控制項頂端的黃色方塊中查看指示。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-304">You can see the instructions in the yellow box at the top of the `MainContent` Content control.</span></span>

<span data-ttu-id="f5c3f-305">[![嵌套的主版頁面延伸頂層主版頁面，以包含系統管理員的指示。](nested-master-pages-vb/_static/image29.png)](nested-master-pages-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="f5c3f-305">[![The Nested Master Page Extends the Top-Level Master Page to Include Instructions for the Administrator.](nested-master-pages-vb/_static/image29.png)](nested-master-pages-vb/_static/image28.png)</span></span>

<span data-ttu-id="f5c3f-306">**圖 10**：此嵌套主版頁面會擴充最上層主版頁面，以包含系統管理員的指示。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-306">**Figure 10**: The Nested Master Page Extends the Top-Level Master Page to Include Instructions for the Administrator.</span></span> <span data-ttu-id="f5c3f-307">（[按一下以查看完整大小的影像](nested-master-pages-vb/_static/image30.png)）</span><span class="sxs-lookup"><span data-stu-id="f5c3f-307">([Click to view full-size image](nested-master-pages-vb/_static/image30.png))</span></span>

## <a name="step-5-updating-the-existing-content-pages-to-use-the-new-nested-master-page"></a><span data-ttu-id="f5c3f-308">步驟5：更新現有的內容頁面以使用新的嵌套主版頁面</span><span class="sxs-lookup"><span data-stu-id="f5c3f-308">Step 5: Updating the Existing Content Pages to Use the New Nested Master Page</span></span>

<span data-ttu-id="f5c3f-309">每當我們將新的內容頁新增至 [管理] 區段時，我們需要將它系結到剛才建立的 `AdminNested.master` 主版頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-309">Anytime we add a new content page to the Administration section we need to bind it to the `AdminNested.master` master page we just created.</span></span> <span data-ttu-id="f5c3f-310">但是現有的內容頁面呢？</span><span class="sxs-lookup"><span data-stu-id="f5c3f-310">But what about the existing content pages?</span></span> <span data-ttu-id="f5c3f-311">目前，網站中的所有內容頁都是衍生自 `BasePage` 類別，它會在執行時間以程式設計方式設定內容頁面的主版頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-311">Currently, all content pages in the site derive from the `BasePage` class, which programmatically sets the content page's master page at runtime.</span></span> <span data-ttu-id="f5c3f-312">這不是我們想要用於 [管理] 區段中的內容頁面的行為。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-312">This is not the behavior we want for the content pages in the Administration section.</span></span> <span data-ttu-id="f5c3f-313">相反地，我們希望這些內容頁一律使用 [`AdminNested.master`] 頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-313">Instead, we want these content pages to always use the `AdminNested.master` page.</span></span> <span data-ttu-id="f5c3f-314">這會負責在執行時間選擇正確的最上層內容頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-314">It will be the responsibility of the nested master page to choose the right top-level content page at runtime.</span></span>

<span data-ttu-id="f5c3f-315">若要達到此所需行為的最佳方式，就是建立新的自訂基底頁面類別，名為 `AdminBasePage` 以擴充 `BasePage` 類別。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-315">To best way to achieve this desired behavior is to create a new custom base page class named `AdminBasePage` that extends the `BasePage` class.</span></span> <span data-ttu-id="f5c3f-316">`AdminBasePage` 可以接著覆寫 `SetMasterPageFile`，並將 `Page` 物件的 `MasterPageFile` 設定為硬式編碼值 "~/Admin/AdminNested.master"。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-316">`AdminBasePage` can then override the `SetMasterPageFile` and set the `Page` object's `MasterPageFile` to the hard-coded value "~/Admin/AdminNested.master".</span></span> <span data-ttu-id="f5c3f-317">如此一來，衍生自 `AdminBasePage` 的任何頁面都會使用 `AdminNested.master`，而衍生自 `BasePage` 的任何頁面，都會根據 `MyMasterPage` 會話變數的值，將其 `MasterPageFile` 屬性動態設定為 "~/Site.master" 或 "~/Alternate.master"。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-317">In this way, any page that derives from `AdminBasePage` will use `AdminNested.master`, whereas any page that derives from `BasePage` will have its `MasterPageFile` property set dynamically to either "~/Site.master" or "~/Alternate.master" based on the value of the `MyMasterPage` Session variable.</span></span>

<span data-ttu-id="f5c3f-318">首先，將新的類別檔案新增至名為 `AdminBasePage.vb`的 `App_Code` 資料夾。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-318">Start by adding a new class file to the `App_Code` folder named `AdminBasePage.vb`.</span></span> <span data-ttu-id="f5c3f-319">讓 `AdminBasePage` 擴充 `BasePage`，然後覆寫 `SetMasterPageFile` 方法。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-319">Have `AdminBasePage` extend `BasePage` and then override the `SetMasterPageFile` method.</span></span> <span data-ttu-id="f5c3f-320">在該方法中，請將值指派給 `MasterPageFile` "~/Admin/AdminNested.master"。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-320">In that method assign the `MasterPageFile` the value "~/Admin/AdminNested.master".</span></span> <span data-ttu-id="f5c3f-321">進行這些變更之後，您的類別檔案看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="f5c3f-321">After making these changes your class file should look similar to the following:</span></span>

[!code-vb[Main](nested-master-pages-vb/samples/sample11.vb)]

<span data-ttu-id="f5c3f-322">我們現在必須讓 [系統管理] 區段中的現有內容頁面衍生自 `AdminBasePage`，而不是 `BasePage`。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-322">We now need to have the existing content pages in the Administration section derive from `AdminBasePage` instead of `BasePage`.</span></span> <span data-ttu-id="f5c3f-323">移至 [`~/Admin`] 資料夾中每個內容頁面的程式碼後置類別檔案，並進行這項變更。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-323">Go to the code-behind class file for each content page in the `~/Admin` folder and make this change.</span></span> <span data-ttu-id="f5c3f-324">例如，在 `~/Admin/Default.aspx` 您會變更程式碼後置類別宣告，從：</span><span class="sxs-lookup"><span data-stu-id="f5c3f-324">For example, in `~/Admin/Default.aspx` you'd change the code-behind class declaration from:</span></span>

[!code-vb[Main](nested-master-pages-vb/samples/sample12.vb)]

<span data-ttu-id="f5c3f-325">收件者：</span><span class="sxs-lookup"><span data-stu-id="f5c3f-325">To:</span></span>

[!code-vb[Main](nested-master-pages-vb/samples/sample13.vb)]

<span data-ttu-id="f5c3f-326">[圖 11] 說明頂層主版頁面（`Site.master` 或 `Alternate.master`）、嵌套主版頁面（`AdminNested.master`），以及管理區段內容頁面彼此之間的關聯性。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-326">Figure 11 depicts how the top-level master page (`Site.master` or `Alternate.master`), the nested master page (`AdminNested.master`), and the Administration section content pages relate to one another.</span></span>

<span data-ttu-id="f5c3f-327">[![嵌套的主版頁面定義 [管理] 區段中頁面的特定內容](nested-master-pages-vb/_static/image32.png)](nested-master-pages-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="f5c3f-327">[![The Nested Master Page Defines Content Specific to the Pages in the Administration Section](nested-master-pages-vb/_static/image32.png)](nested-master-pages-vb/_static/image31.png)</span></span>

<span data-ttu-id="f5c3f-328">**圖 11**：嵌套的主版頁面定義 [系統管理] 區段中頁面的特定內容（[按一下以查看完整大小的影像](nested-master-pages-vb/_static/image33.png)）</span><span class="sxs-lookup"><span data-stu-id="f5c3f-328">**Figure 11**: The Nested Master Page Defines Content Specific to the Pages in the Administration Section ([Click to view full-size image](nested-master-pages-vb/_static/image33.png))</span></span>

## <a name="step-6-mirroring-the-master-pages-public-methods-and-properties"></a><span data-ttu-id="f5c3f-329">步驟6：鏡像主版頁面的公用方法與屬性</span><span class="sxs-lookup"><span data-stu-id="f5c3f-329">Step 6: Mirroring the Master Page's Public Methods and Properties</span></span>

<span data-ttu-id="f5c3f-330">回想一下，`~/Admin/AddProduct.aspx` 和 `~/Admin/Products.aspx` 頁面會以程式設計方式與主版頁面互動： `~/Admin/AddProduct.aspx` 會呼叫主版頁面的公用 `RefreshRecentProductsGrid` 方法，並設定其 `GridMessageText` 屬性。`~/Admin/Products.aspx` 具有 `PricesDoubled` 事件的事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-330">Recall that the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages interact programmatically with the master page: `~/Admin/AddProduct.aspx` calls the master page's public `RefreshRecentProductsGrid` method and sets its `GridMessageText` property; `~/Admin/Products.aspx` has an event handler for the `PricesDoubled` event.</span></span> <span data-ttu-id="f5c3f-331">在先前的教學課程中，我們建立了定義這些公用成員的 `MustInherit` `BaseMasterPage` 類別。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-331">In the preceding tutorial we created a `MustInherit` `BaseMasterPage` class that defined these public members.</span></span>

<span data-ttu-id="f5c3f-332">[`~/Admin/AddProduct.aspx`] 和 [`~/Admin/Products.aspx`] 頁面會假設其主版頁面衍生自 `BaseMasterPage` 類別。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-332">The `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages assume that their master page derives from the `BaseMasterPage` class.</span></span> <span data-ttu-id="f5c3f-333">不過，[`AdminNested.master`] 頁面目前會擴充 `System.Web.UI.MasterPage` 類別。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-333">The `AdminNested.master` page, however, currently extends the `System.Web.UI.MasterPage` class.</span></span> <span data-ttu-id="f5c3f-334">如此一來，當造訪 `~/Admin/Products.aspx` 會擲回 `InvalidCastException` 一則訊息：「無法將類型為 ' ASP. admin\_adminnested\_master ' 的物件轉型為 ' BaseMasterPage '」。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-334">As a result, when visiting `~/Admin/Products.aspx` an `InvalidCastException` is thrown with the message: "Unable to cast object of type 'ASP.admin\_adminnested\_master' to type 'BaseMasterPage'."</span></span>

<span data-ttu-id="f5c3f-335">若要修正此問題，我們必須將 `AdminNested.master` 程式碼後置類別延伸 `BaseMasterPage`。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-335">To fix this we need to have the `AdminNested.master` code-behind class extend `BaseMasterPage`.</span></span> <span data-ttu-id="f5c3f-336">從下列內容更新嵌套主版頁面的程式碼後置類別宣告：</span><span class="sxs-lookup"><span data-stu-id="f5c3f-336">Update the nested master page's code-behind class declaration from:</span></span>

[!code-vb[Main](nested-master-pages-vb/samples/sample14.vb)]

<span data-ttu-id="f5c3f-337">收件者：</span><span class="sxs-lookup"><span data-stu-id="f5c3f-337">To:</span></span>

[!code-vb[Main](nested-master-pages-vb/samples/sample15.vb)]

<span data-ttu-id="f5c3f-338">我們尚未完成。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-338">We're not done yet.</span></span> <span data-ttu-id="f5c3f-339">我們需要覆寫標示為 `MustOverride`的成員，亦即 `RefreshRecentProductsGrid` 和 `GridMessageText`。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-339">We need to override the members marked as `MustOverride`, namely `RefreshRecentProductsGrid` and `GridMessageText`.</span></span> <span data-ttu-id="f5c3f-340">這些成員是由最上層主版頁面用來更新其使用者介面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-340">These members are used by the top-level master pages to update their user interfaces.</span></span> <span data-ttu-id="f5c3f-341">（實際上，只有 `Site.master` 主版頁面會使用這些方法，雖然兩個最上層主版頁面都會執行這些方法，因為兩者都是擴充 `BaseMasterPage`）。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-341">(Actually, only the `Site.master` master page uses these methods, although both top-level master pages implement these methods, since both extend `BaseMasterPage`.)</span></span>

<span data-ttu-id="f5c3f-342">雖然我們需要在 `AdminNested.master`中執行這些成員，但這些所有的實作為只需要在嵌套主版頁面所使用的最上層主版頁面中呼叫相同的成員。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-342">While we need to implement these members in `AdminNested.master`, all these implementations need to do is simply call the same member in the top-level master page used by the nested master page.</span></span> <span data-ttu-id="f5c3f-343">例如，當 [管理] 區段中的 [內容] 頁面呼叫了嵌套主版頁面的 `RefreshRecentProductsGrid` 方法時，所有的嵌套主版頁面都必須執行，然後再呼叫 `Site.master` 或 `Alternate.master`的 `RefreshRecentProductsGrid` 方法。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-343">For instance, when a content page in the Administration section calls the nested master page's `RefreshRecentProductsGrid` method, all the nested master page needs to do is, in turn, call `Site.master` or `Alternate.master`'s `RefreshRecentProductsGrid` method.</span></span>

<span data-ttu-id="f5c3f-344">若要達到此目的，請從將下列 `@MasterType` 指示詞新增至 `AdminNested.master`頂端開始：</span><span class="sxs-lookup"><span data-stu-id="f5c3f-344">To achieve this, start by adding the following `@MasterType` directive to the top of `AdminNested.master`:</span></span>

[!code-aspx[Main](nested-master-pages-vb/samples/sample16.aspx)]

<span data-ttu-id="f5c3f-345">回想一下，`@MasterType` 指示詞會將強型別屬性加入名為 `Master`的程式碼後置類別。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-345">Recall that the `@MasterType` directive adds a strongly-typed property to the code-behind class named `Master`.</span></span> <span data-ttu-id="f5c3f-346">然後覆寫 `RefreshRecentProductsGrid` 和 `GridMessageText` 成員，直接將呼叫委派給 `Master`的對應方法：</span><span class="sxs-lookup"><span data-stu-id="f5c3f-346">Then override the `RefreshRecentProductsGrid` and `GridMessageText` members and simply delegate the call to the `Master`'s corresponding method:</span></span>

[!code-vb[Main](nested-master-pages-vb/samples/sample17.vb)]

<span data-ttu-id="f5c3f-347">備妥此程式碼之後，您應該能夠造訪並使用 [系統管理] 區段中的內容頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-347">With this code in place, you should be able to visit and use the content pages in the Administration section.</span></span> <span data-ttu-id="f5c3f-348">[圖 12] 顯示透過瀏覽器觀看時的 `~/Admin/Products.aspx` 頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-348">Figure 12 shows the `~/Admin/Products.aspx` page when viewed through a browser.</span></span> <span data-ttu-id="f5c3f-349">如您所見，此頁面包含 [系統管理指示] 方塊，此方塊定義于嵌套的主版頁面中。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-349">As you can see, the page includes the Administration Instructions box, which is defined in the nested master page.</span></span>

<span data-ttu-id="f5c3f-350">[![[管理] 區段中的內容頁麵包含每個頁面頂端的指示](nested-master-pages-vb/_static/image35.png)](nested-master-pages-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="f5c3f-350">[![The Content Pages in the Administration Section Include Instructions at the Top of Each Page](nested-master-pages-vb/_static/image35.png)](nested-master-pages-vb/_static/image34.png)</span></span>

<span data-ttu-id="f5c3f-351">**圖 12**： [管理] 區段中的 [內容] 頁面包含每個頁面頂端的指示（[按一下以查看完整大小的影像](nested-master-pages-vb/_static/image36.png)）</span><span class="sxs-lookup"><span data-stu-id="f5c3f-351">**Figure 12**: The Content Pages in the Administration Section Include Instructions at the Top of Each Page ([Click to view full-size image](nested-master-pages-vb/_static/image36.png))</span></span>

## <a name="step-7-using-the-appropriate-top-level-master-page-at-runtime"></a><span data-ttu-id="f5c3f-352">步驟7：在執行時間使用適當的最上層主版頁面</span><span class="sxs-lookup"><span data-stu-id="f5c3f-352">Step 7: Using the Appropriate Top-Level Master Page at Runtime</span></span>

<span data-ttu-id="f5c3f-353">雖然 [管理] 區段中的所有 [內容] 頁面都有完整的功能，但它們全都使用相同的最上層主版頁面，並忽略使用者在 `ChooseMasterPage.aspx`選取的主版頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-353">While all the content pages in the Administration section are fully functional, they all use the same top-level master page and ignore the master page selected by the user at `ChooseMasterPage.aspx`.</span></span> <span data-ttu-id="f5c3f-354">此行為的原因是，嵌套主版頁面的 `MasterPageFile` 屬性會在其 `<%@ Master %>` 指示詞中以靜態方式設定為 `Site.master`。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-354">This behavior is due to the fact that the nested master page has its `MasterPageFile` property statically set to `Site.master` in its `<%@ Master %>` directive.</span></span>

<span data-ttu-id="f5c3f-355">若要使用使用者選取的最上層主版頁面，我們必須將 `AdminNested.master`的 `MasterPageFile` 屬性設定為 `MyMasterPage` 會話變數中的值。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-355">To use the top-level master page selected by the end user we need to set the `AdminNested.master`'s `MasterPageFile` property to the value in the `MyMasterPage` Session variable.</span></span> <span data-ttu-id="f5c3f-356">因為我們會在 `BasePage`中設定內容頁的 `MasterPageFile` 屬性，所以您可能會想要在 `BaseMasterPage` 或 `AdminNested.master`的程式碼後置類別中，設定嵌套主版頁面的 `MasterPageFile` 屬性。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-356">Because we set the content pages' `MasterPageFile` properties in `BasePage`, you may think that we would set the nested master page's `MasterPageFile` property in `BaseMasterPage` or in the `AdminNested.master`'s code-behind class.</span></span> <span data-ttu-id="f5c3f-357">不過，這樣做並不可行，因為我們必須在 PreInit 階段結束時設定 `MasterPageFile` 屬性。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-357">This won't work, however, because we need to have set the `MasterPageFile` property by the end of the PreInit stage.</span></span> <span data-ttu-id="f5c3f-358">我們可以用程式設計的方式，從主版頁面進入頁面生命週期的最早時間是 Init 階段（發生在 PreInit 階段之後）。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-358">The earliest time that we can programmatically tap into the page lifecycle from a master page is the Init stage (which occurs after the PreInit stage).</span></span>

<span data-ttu-id="f5c3f-359">因此，我們需要從 [內容] 頁面設定嵌套主版頁面的 [`MasterPageFile`] 屬性。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-359">Therefore, we need to set the nested master page's `MasterPageFile` property from the content pages.</span></span> <span data-ttu-id="f5c3f-360">唯一使用 `AdminNested.master` 主版頁面的內容頁面會衍生自 `AdminBasePage`。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-360">The only content pages that use the `AdminNested.master` master page derive from `AdminBasePage`.</span></span> <span data-ttu-id="f5c3f-361">因此，我們可以將這個邏輯放在該處。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-361">Therefore, we can put this logic there.</span></span> <span data-ttu-id="f5c3f-362">在步驟5中，我們會已覆寫 `SetMasterPageFile` 方法，將 Page 物件的 `MasterPageFile` 屬性設定為 "~/Admin/AdminNested.master"。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-362">In Step 5 we overrode the `SetMasterPageFile` method, setting the Page object's `MasterPageFile` property to "~/Admin/AdminNested.master".</span></span> <span data-ttu-id="f5c3f-363">更新 `SetMasterPageFile`，同時將主版頁面的 `MasterPageFile` 屬性設定為儲存在會話中的結果：</span><span class="sxs-lookup"><span data-stu-id="f5c3f-363">Update `SetMasterPageFile` to also set the master page's `MasterPageFile` property to the result stored in Session:</span></span>

[!code-vb[Main](nested-master-pages-vb/samples/sample18.vb)]

<span data-ttu-id="f5c3f-364">我們在上一個教學課程中新增至 `BasePage` 類別的 `GetMasterPageFileFromSession` 方法，會根據會話變數值傳回適當的主版頁面檔案路徑。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-364">The `GetMasterPageFileFromSession` method, which we added to the `BasePage` class in the preceding tutorial, returns the appropriate master page file path based on the Session variable value.</span></span>

<span data-ttu-id="f5c3f-365">進行這項變更之後，使用者的主版頁面選取範圍會移至 [管理] 區段。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-365">With this change in place, the user's master page selection carries over to the Administration section.</span></span> <span data-ttu-id="f5c3f-366">[圖 13] 顯示的頁面與 [圖 12] 相同，但在使用者將主版頁面選取範圍變更為 `Alternate.master`之後。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-366">Figure 13 shows the same page as Figure 12, but after the user has changed their master page selection to `Alternate.master`.</span></span>

<span data-ttu-id="f5c3f-367">[![[嵌套管理] 頁面使用使用者選取的最上層主版頁面](nested-master-pages-vb/_static/image38.png)](nested-master-pages-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="f5c3f-367">[![The Nested Administration Page Uses the Top-Level Master Page Selected by the User](nested-master-pages-vb/_static/image38.png)](nested-master-pages-vb/_static/image37.png)</span></span>

<span data-ttu-id="f5c3f-368">**圖 13**： [嵌套管理] 頁面使用使用者選取的最上層主版頁面（[按一下以查看完整大小的影像](nested-master-pages-vb/_static/image39.png)）</span><span class="sxs-lookup"><span data-stu-id="f5c3f-368">**Figure 13**: The Nested Administration Page Uses the Top-Level Master Page Selected by the User ([Click to view full-size image](nested-master-pages-vb/_static/image39.png))</span></span>

## <a name="summary"></a><span data-ttu-id="f5c3f-369">總結</span><span class="sxs-lookup"><span data-stu-id="f5c3f-369">Summary</span></span>

<span data-ttu-id="f5c3f-370">與內容頁面系結至主版頁面的方式很類似，您可以將子主版頁面系結至父主版頁面，以建立嵌套的主版頁面。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-370">Much like how content pages can bind to a master page, it is possible to create nested master pages by having a child master page bind to a parent master page.</span></span> <span data-ttu-id="f5c3f-371">子主版頁面可能會定義其父系 ContentPlaceHolders 的內容控制項;然後，它可以將自己的 ContentPlaceHolder 控制項（以及其他標記）新增至這些內容控制項。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-371">The child master page may define Content controls for each of its parent's ContentPlaceHolders; it can then add its own ContentPlaceHolder controls (as well as other markup) to these Content controls.</span></span> <span data-ttu-id="f5c3f-372">在所有頁面都共用整體外觀和操作的大型 web 應用程式中，嵌套主版頁面相當有用，但網站的某些區段則需要唯一的自訂專案。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-372">Nested master pages are quite useful in large web applications where all pages share an overarching look and feel, yet certain sections of the site require unique customizations.</span></span>

<span data-ttu-id="f5c3f-373">快樂的程式設計！</span><span class="sxs-lookup"><span data-stu-id="f5c3f-373">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="f5c3f-374">進一步閱讀</span><span class="sxs-lookup"><span data-stu-id="f5c3f-374">Further Reading</span></span>

<span data-ttu-id="f5c3f-375">如需本教學課程中所討論之主題的詳細資訊，請參閱下列資源：</span><span class="sxs-lookup"><span data-stu-id="f5c3f-375">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="f5c3f-376">嵌套的 ASP.NET 主版頁面</span><span class="sxs-lookup"><span data-stu-id="f5c3f-376">Nested ASP.NET Master Pages</span></span>](https://msdn.microsoft.com/library/x2b3ktt7.aspx)
- [<span data-ttu-id="f5c3f-377">嵌套主版頁面和 VS 2005 設計階段的秘訣</span><span class="sxs-lookup"><span data-stu-id="f5c3f-377">Tips for Nested Master Pages and VS 2005 Design-Time</span></span>](https://weblogs.asp.net/scottgu/archive/2005/11/11/430382.aspx)
- [<span data-ttu-id="f5c3f-378">VS 2008 的嵌套主版頁面支援</span><span class="sxs-lookup"><span data-stu-id="f5c3f-378">VS 2008 Nested Master Page Support</span></span>](https://weblogs.asp.net/scottgu/archive/2007/07/09/vs-2008-nested-master-page-support.aspx)

### <a name="about-the-author"></a><span data-ttu-id="f5c3f-379">關於作者</span><span class="sxs-lookup"><span data-stu-id="f5c3f-379">About the Author</span></span>

<span data-ttu-id="f5c3f-380">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，自1998起，有多個 ASP/ASP. NET 書籍和創辦人的4GuysFromRolla.com。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-380">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="f5c3f-381">Scott 以獨立的顧問、訓練員和作者的身分運作。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-381">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="f5c3f-382">他的最新著作是[*在24小時內讓自己的 ASP.NET 3.5*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-382">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="f5c3f-383">Scott 可以在[mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)或透過他在[http://ScottOnWriting.NET](http://scottonwriting.net/)的 blog。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-383">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="f5c3f-384">特別感謝</span><span class="sxs-lookup"><span data-stu-id="f5c3f-384">Special Thanks To</span></span>

<span data-ttu-id="f5c3f-385">本教學課程系列已由許多有用的審核者所審查。</span><span class="sxs-lookup"><span data-stu-id="f5c3f-385">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="f5c3f-386">有興趣複習我即將發行的 MSDN 文章嗎？</span><span class="sxs-lookup"><span data-stu-id="f5c3f-386">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="f5c3f-387">若是如此，請在[mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)下拉一行</span><span class="sxs-lookup"><span data-stu-id="f5c3f-387">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="f5c3f-388">上一篇</span><span class="sxs-lookup"><span data-stu-id="f5c3f-388">Previous</span></span>](specifying-the-master-page-programmatically-vb.md)
