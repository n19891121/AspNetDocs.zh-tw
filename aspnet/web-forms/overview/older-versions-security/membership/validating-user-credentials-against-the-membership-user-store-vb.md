---
uid: web-forms/overview/older-versions-security/membership/validating-user-credentials-against-the-membership-user-store-vb
title: 針對成員資格使用者存放區驗證使用者認證（VB） |Microsoft Docs
author: rick-anderson
description: 在本教學課程中，我們將探討如何使用程式設計方式和登入控制項，針對成員資格使用者存放區驗證使用者的認證 ...。
ms.author: riande
ms.date: 01/18/2008
ms.assetid: 17772912-b47b-4557-9ce9-80f22df642f7
msc.legacyurl: /web-forms/overview/older-versions-security/membership/validating-user-credentials-against-the-membership-user-store-vb
msc.type: authoredcontent
ms.openlocfilehash: 37574e4cdc86f518d01d12da58cc2862bc77d463
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/06/2020
ms.locfileid: "78527927"
---
# <a name="validating-user-credentials-against-the-membership-user-store-vb"></a><span data-ttu-id="6e3be-103">針對成員資格使用者存放區驗證使用者認證 (VB)</span><span class="sxs-lookup"><span data-stu-id="6e3be-103">Validating User Credentials Against the Membership User Store (VB)</span></span>

<span data-ttu-id="6e3be-104">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="6e3be-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="6e3be-105">[下載程式代碼](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_06_VB.zip)或[下載 PDF](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial06_LoggingIn_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="6e3be-105">[Download Code](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_06_VB.zip) or [Download PDF](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial06_LoggingIn_vb.pdf)</span></span>

> <span data-ttu-id="6e3be-106">在本教學課程中，我們將探討如何使用程式設計方式和登入控制項，針對成員資格使用者存放區驗證使用者的認證。</span><span class="sxs-lookup"><span data-stu-id="6e3be-106">In this tutorial we will examine how to validate a user's credentials against the Membership user store using both programmatic means and the Login control.</span></span> <span data-ttu-id="6e3be-107">我們也將探討如何自訂登入控制項的外觀和行為。</span><span class="sxs-lookup"><span data-stu-id="6e3be-107">We will also look at how to customize the login control's appearance and behavior.</span></span>

## <a name="introduction"></a><span data-ttu-id="6e3be-108">簡介</span><span class="sxs-lookup"><span data-stu-id="6e3be-108">Introduction</span></span>

<span data-ttu-id="6e3be-109">在<a id="Tutorial05"> </a>[先前的教學](creating-user-accounts-vb.md)課程中，我們探討了如何在成員資格架構中建立新的使用者帳戶。</span><span class="sxs-lookup"><span data-stu-id="6e3be-109">In the <a id="Tutorial05"></a>[preceding tutorial](creating-user-accounts-vb.md) we looked at how to create a new user account in the Membership framework.</span></span> <span data-ttu-id="6e3be-110">我們先探討了如何透過 `Membership` 類別的 `CreateUser` 方法以程式設計方式建立使用者帳戶，然後使用 CreateUserWizard Web 控制項進行檢查。</span><span class="sxs-lookup"><span data-stu-id="6e3be-110">We first looked at programmatically creating user accounts via the `Membership` class's `CreateUser` method, and then examined using the CreateUserWizard Web control.</span></span> <span data-ttu-id="6e3be-111">不過，登入頁面目前會針對使用者名稱和密碼配對的硬式編碼清單，驗證提供的認證。</span><span class="sxs-lookup"><span data-stu-id="6e3be-111">However, the login page currently validates the supplied credentials against a hard-coded list of username and password pairs.</span></span> <span data-ttu-id="6e3be-112">我們需要更新登入頁面的邏輯，讓它能夠根據成員資格架構的使用者存放區驗證認證。</span><span class="sxs-lookup"><span data-stu-id="6e3be-112">We need to update the login page's logic so that it validates credentials against the Membership framework's user store.</span></span>

<span data-ttu-id="6e3be-113">就像建立使用者帳戶一樣，認證可以透過程式設計或宣告方式進行驗證。</span><span class="sxs-lookup"><span data-stu-id="6e3be-113">Much like with creating user accounts, credentials can be validated programmatically or declaratively.</span></span> <span data-ttu-id="6e3be-114">成員資格 API 包含一個方法，可讓您以程式設計方式向使用者存放區驗證使用者的認證。</span><span class="sxs-lookup"><span data-stu-id="6e3be-114">The Membership API includes a method for programmatically validating a user's credentials against the user store.</span></span> <span data-ttu-id="6e3be-115">和 ASP.NET 隨附于登入 Web 控制項，它會轉譯使用者介面，其中包含使用者名稱和密碼的文字方塊，以及用來登入的按鈕。</span><span class="sxs-lookup"><span data-stu-id="6e3be-115">And ASP.NET ships with the Login Web control, which renders a user interface with textboxes for the username and password and a button to log in.</span></span>

<span data-ttu-id="6e3be-116">在本教學課程中，我們將探討如何使用程式設計方式和登入控制項，針對成員資格使用者存放區驗證使用者的認證。</span><span class="sxs-lookup"><span data-stu-id="6e3be-116">In this tutorial we will examine how to validate a user's credentials against the Membership user store using both programmatic means and the Login control.</span></span> <span data-ttu-id="6e3be-117">我們也將探討如何自訂登入控制項的外觀和行為。</span><span class="sxs-lookup"><span data-stu-id="6e3be-117">We will also look at how to customize the login control's appearance and behavior.</span></span> <span data-ttu-id="6e3be-118">現在就開始吧！</span><span class="sxs-lookup"><span data-stu-id="6e3be-118">Let's get started!</span></span>

## <a name="step-1-validating-credentials-against-the-membership-user-store"></a><span data-ttu-id="6e3be-119">步驟1：根據成員資格使用者存放區驗證認證</span><span class="sxs-lookup"><span data-stu-id="6e3be-119">Step 1: Validating Credentials Against the Membership User Store</span></span>

<span data-ttu-id="6e3be-120">若是使用表單驗證的網站，使用者可以透過造訪登入頁面並輸入其認證來登入網站。</span><span class="sxs-lookup"><span data-stu-id="6e3be-120">For web sites that use forms authentication, a user logs on to the website by visiting a login page and entering their credentials.</span></span> <span data-ttu-id="6e3be-121">然後，這些認證會與使用者存放區進行比較。</span><span class="sxs-lookup"><span data-stu-id="6e3be-121">These credentials are then compared against the user store.</span></span> <span data-ttu-id="6e3be-122">如果有效，則使用者會被授與表單驗證票證，這是一種安全性權杖，表示訪客的身分識別和真實性。</span><span class="sxs-lookup"><span data-stu-id="6e3be-122">If they are valid, then the user is granted a forms authentication ticket, which is a security token that indicates the identity and authenticity of the visitor.</span></span>

<span data-ttu-id="6e3be-123">若要針對成員資格架構驗證使用者，請使用 `Membership` 類別的[`ValidateUser` 方法](https://msdn.microsoft.com/library/system.web.security.membership.validateuser.aspx)。</span><span class="sxs-lookup"><span data-stu-id="6e3be-123">To validate a user against the Membership framework, use the `Membership` class's [`ValidateUser` method](https://msdn.microsoft.com/library/system.web.security.membership.validateuser.aspx).</span></span> <span data-ttu-id="6e3be-124">`ValidateUser` 方法會接受兩個輸入參數-`username` 和 `password`，並傳回布林值，指出認證是否有效。</span><span class="sxs-lookup"><span data-stu-id="6e3be-124">The `ValidateUser` method takes in two input parameters - `username` and `password` - and returns a Boolean value indicating whether the credentials were valid.</span></span> <span data-ttu-id="6e3be-125">就像我們在上一個教學課程中所檢查的 `CreateUser` 方法一樣，`ValidateUser` 方法會將實際的驗證委派給設定的成員資格提供者。</span><span class="sxs-lookup"><span data-stu-id="6e3be-125">Like with the `CreateUser` method we examined in the previous tutorial, the `ValidateUser` method delegates the actual validation to the configured Membership provider.</span></span>

<span data-ttu-id="6e3be-126">`SqlMembershipProvider` 藉由透過 `aspnet_Membership_GetPasswordWithFormat` 預存程式取得指定使用者的密碼，來驗證提供的認證。</span><span class="sxs-lookup"><span data-stu-id="6e3be-126">The `SqlMembershipProvider` validates the supplied credentials by obtaining the specified user's password via the `aspnet_Membership_GetPasswordWithFormat` stored procedure.</span></span> <span data-ttu-id="6e3be-127">回想一下，`SqlMembershipProvider` 使用下列三種格式的其中一種來儲存使用者的密碼：清除、加密或雜湊。</span><span class="sxs-lookup"><span data-stu-id="6e3be-127">Recall that the `SqlMembershipProvider` stores users' passwords using one of three formats: clear, encrypted, or hashed.</span></span> <span data-ttu-id="6e3be-128">`aspnet_Membership_GetPasswordWithFormat` 預存程式會以其原始格式傳回密碼。</span><span class="sxs-lookup"><span data-stu-id="6e3be-128">The `aspnet_Membership_GetPasswordWithFormat` stored procedure returns the password in its raw format.</span></span> <span data-ttu-id="6e3be-129">對於加密或雜湊的密碼，`SqlMembershipProvider` 會將傳入 `ValidateUser` 方法的 `password` 值轉換為其對等的加密或雜湊狀態，然後將它與從資料庫傳回的內容進行比較。</span><span class="sxs-lookup"><span data-stu-id="6e3be-129">For encrypted or hashed passwords, the `SqlMembershipProvider` transforms the `password` value passed into the `ValidateUser` method into its equivalent encrypted or hashed state and then compares it with what was returned from the database.</span></span> <span data-ttu-id="6e3be-130">如果儲存在資料庫中的密碼符合使用者輸入的格式化密碼，則認證會是有效的。</span><span class="sxs-lookup"><span data-stu-id="6e3be-130">If the password stored in the database matches the formatted password entered by the user, the credentials are valid.</span></span>

<span data-ttu-id="6e3be-131">讓我們更新登入頁面（~/`Login.aspx`），使其根據成員資格架構使用者存放區驗證提供的認證。</span><span class="sxs-lookup"><span data-stu-id="6e3be-131">Let's update our login page (~/`Login.aspx`) so that it validates the supplied credentials against the Membership framework user store.</span></span> <span data-ttu-id="6e3be-132">我們<a id="Tutorial02"> </a>[*已在表單驗*](../introduction/an-overview-of-forms-authentication-vb.md)證教學課程的總覽中建立此登入頁面，建立具有兩個文字方塊的使用者名稱和密碼、[記住我] 核取方塊和 [登入] 按鈕的介面（請參閱 [圖 1]）。</span><span class="sxs-lookup"><span data-stu-id="6e3be-132">We created this login page back in the <a id="Tutorial02"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-vb.md) tutorial, creating an interface with two TextBoxes for the username and password, a Remember Me checkbox, and a Login button (see Figure 1).</span></span> <span data-ttu-id="6e3be-133">此程式碼會針對使用者名稱和密碼配對的硬式編碼清單（Scott/password、Jisun/password 和 Sam/password）來驗證輸入的認證。</span><span class="sxs-lookup"><span data-stu-id="6e3be-133">The code validates the entered credentials against a hard-coded list of username and password pairs (Scott/password, Jisun/password, and Sam/password).</span></span> <span data-ttu-id="6e3be-134"><a id="Tutorial03"></a>在[*表單驗證設定和 Advanced 主題*](../introduction/forms-authentication-configuration-and-advanced-topics-vb.md)教學課程中，我們更新了登入頁面的程式碼，以在表單驗證票證的 `UserData` 屬性中儲存其他資訊。</span><span class="sxs-lookup"><span data-stu-id="6e3be-134">In the <a id="Tutorial03"></a>[*Forms Authentication Configuration and Advanced Topics*](../introduction/forms-authentication-configuration-and-advanced-topics-vb.md) tutorial we updated the login page's code to store additional information in the forms authentication ticket's `UserData` property.</span></span>

<span data-ttu-id="6e3be-135">[![登入頁面的介面包含兩個文字方塊、一個 CheckBoxList 和一個按鈕](validating-user-credentials-against-the-membership-user-store-vb/_static/image2.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="6e3be-135">[![The Login Page's Interface Includes Two TextBoxes, a CheckBoxList, and a Button](validating-user-credentials-against-the-membership-user-store-vb/_static/image2.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image1.png)</span></span>

<span data-ttu-id="6e3be-136">**圖 1**：登入頁面的介面包含兩個文字方塊、一個 CheckBoxList 和一個按鈕（[按一下以查看完整大小的影像](validating-user-credentials-against-the-membership-user-store-vb/_static/image3.png)）</span><span class="sxs-lookup"><span data-stu-id="6e3be-136">**Figure 1**: The Login Page's Interface Includes Two TextBoxes, a CheckBoxList, and a Button  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image3.png))</span></span>

<span data-ttu-id="6e3be-137">登入頁面的使用者介面可以維持不變，但我們需要將登入按鈕的 `Click` 事件處理常式，取代為驗證使用者對成員資格架構使用者存放區的程式碼。</span><span class="sxs-lookup"><span data-stu-id="6e3be-137">The login page's user interface can remain unchanged, but we need to replace the Login button's `Click` event handler with code that validates the user against the Membership framework user store.</span></span> <span data-ttu-id="6e3be-138">更新事件處理常式，使其程式碼看起來如下：</span><span class="sxs-lookup"><span data-stu-id="6e3be-138">Update the event handler so that its code appears as follows:</span></span>

[!code-vb[Main](validating-user-credentials-against-the-membership-user-store-vb/samples/sample1.vb)]

<span data-ttu-id="6e3be-139">這段程式碼很簡單。</span><span class="sxs-lookup"><span data-stu-id="6e3be-139">This code is remarkably simple.</span></span> <span data-ttu-id="6e3be-140">我們一開始會先呼叫 `Membership.ValidateUser` 方法，傳入提供的使用者名稱和密碼。</span><span class="sxs-lookup"><span data-stu-id="6e3be-140">We start by calling the `Membership.ValidateUser` method, passing in the supplied username and password.</span></span> <span data-ttu-id="6e3be-141">如果該方法傳回 True，則會透過 `FormsAuthentication` 類別的 RedirectFromLoginPage 方法，將使用者登入網站。</span><span class="sxs-lookup"><span data-stu-id="6e3be-141">If that method returns True, then the user is signed into the site via the `FormsAuthentication` class's RedirectFromLoginPage method.</span></span> <span data-ttu-id="6e3be-142">（如我們在<a id="Tutorial02"> </a>[*表單驗*](../introduction/an-overview-of-forms-authentication-vb.md)證教學課程中所討論，`FormsAuthentication.RedirectFromLoginPage` 會建立表單驗證票證，然後將使用者重新導向至適當的頁面）。不過，如果認證無效，則會顯示 [`InvalidCredentialsMessage`] 標籤，通知使用者他們的使用者名稱或密碼不正確。</span><span class="sxs-lookup"><span data-stu-id="6e3be-142">(As we discussed in the <a id="Tutorial02"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-vb.md) tutorial, the `FormsAuthentication.RedirectFromLoginPage` creates the forms authentication ticket and then redirects the user to the appropriate page.) If the credentials are invalid, however, the `InvalidCredentialsMessage` Label is displayed, informing the user that their username or password was incorrect.</span></span>

<span data-ttu-id="6e3be-143">這樣就全部完成了！</span><span class="sxs-lookup"><span data-stu-id="6e3be-143">That's all there is to it!</span></span>

<span data-ttu-id="6e3be-144">若要測試登入頁面是否如預期般運作，請嘗試使用您在上一個教學課程中建立的其中一個使用者帳戶來登入。</span><span class="sxs-lookup"><span data-stu-id="6e3be-144">To test that the login page works as expected, attempt to login with one of the user accounts you created in the preceding tutorial.</span></span> <span data-ttu-id="6e3be-145">或者，如果您尚未建立帳戶，請繼續並從 [`~/Membership/CreatingUserAccounts.aspx`] 頁面建立一個。</span><span class="sxs-lookup"><span data-stu-id="6e3be-145">Or, if you have not yet created an account, go ahead and create one from the `~/Membership/CreatingUserAccounts.aspx` page.</span></span>

> [!NOTE]
> <span data-ttu-id="6e3be-146">當使用者輸入自己的認證並提交登入頁面表單時，會透過網際網路將認證（包括她的密碼）以*純文字*格式傳送至 web 伺服器。</span><span class="sxs-lookup"><span data-stu-id="6e3be-146">When the user enters her credentials and submits the login page form, the credentials, including her password, are transmitted over the Internet to the web server in *plain text*.</span></span> <span data-ttu-id="6e3be-147">這表示任何駭客探查網路流量都可以看到使用者名稱和密碼。</span><span class="sxs-lookup"><span data-stu-id="6e3be-147">That means any hacker sniffing the network traffic can see the username and password.</span></span> <span data-ttu-id="6e3be-148">若要避免這種情況，請務必使用[安全通訊端層（SSL）](http://en.wikipedia.org/wiki/Secure_Sockets_Layer)來加密網路流量。</span><span class="sxs-lookup"><span data-stu-id="6e3be-148">To prevent this, it is essential to encrypt the network traffic by using [Secure Socket Layers (SSL)](http://en.wikipedia.org/wiki/Secure_Sockets_Layer).</span></span> <span data-ttu-id="6e3be-149">這可確保在網頁伺服器收到認證（以及整個網頁的 HTML 標籤）後，就會將它們從離開瀏覽器的時間加密。</span><span class="sxs-lookup"><span data-stu-id="6e3be-149">This will ensure that the credentials (as well as the entire page's HTML markup) are encrypted from the moment they leave the browser until they are received by the web server.</span></span>

### <a name="how-the-membership-framework-handles-invalid-login-attempts"></a><span data-ttu-id="6e3be-150">成員資格架構如何處理不正確登入嘗試</span><span class="sxs-lookup"><span data-stu-id="6e3be-150">How the Membership Framework Handles Invalid Login Attempts</span></span>

<span data-ttu-id="6e3be-151">當造訪者到達登入頁面並提交其認證時，其瀏覽器會對登入頁面提出 HTTP 要求。</span><span class="sxs-lookup"><span data-stu-id="6e3be-151">When a visitor reaches the login page and submits their credentials, their browser makes an HTTP request to the login page.</span></span> <span data-ttu-id="6e3be-152">如果認證有效，HTTP 回應會在 cookie 中包含驗證票證。</span><span class="sxs-lookup"><span data-stu-id="6e3be-152">If the credentials are valid, the HTTP response includes the authentication ticket in a cookie.</span></span> <span data-ttu-id="6e3be-153">因此，嘗試侵入您的網站的駭客可能會建立一個程式，將 HTTP 要求以有效的使用者名稱和猜測的密碼，徹底地傳送到登入頁面。</span><span class="sxs-lookup"><span data-stu-id="6e3be-153">Therefore, a hacker attempting to break into your site could create a program that exhaustively sends HTTP requests to the login page with a valid username and a guess at the password.</span></span> <span data-ttu-id="6e3be-154">如果密碼猜測正確，登入頁面將會傳回驗證票證 cookie，此時程式會知道它是否已偶然發現有效的使用者名稱/密碼組。</span><span class="sxs-lookup"><span data-stu-id="6e3be-154">If the password guess is correct, the login page will return the authentication ticket cookie, at which point the program knows it has stumbled upon a valid username/password pair.</span></span> <span data-ttu-id="6e3be-155">透過暴力密碼破解，這類程式或許能夠遇到使用者的密碼，特別是如果密碼很弱。</span><span class="sxs-lookup"><span data-stu-id="6e3be-155">Through brute force, such a program might be able to stumble upon a user's password, especially if the password is weak.</span></span>

<span data-ttu-id="6e3be-156">為避免這類暴力密碼破解攻擊，如果在一段時間內有一定數目的失敗登入嘗試，成員資格架構就會鎖定使用者。</span><span class="sxs-lookup"><span data-stu-id="6e3be-156">To prevent such brute force attacks, the Membership framework locks out a user if there are a certain number of unsuccessful login attempts within a certain period of time.</span></span> <span data-ttu-id="6e3be-157">確切的參數可透過下列兩個成員資格提供者設定設定來設定：</span><span class="sxs-lookup"><span data-stu-id="6e3be-157">The exact parameters are configurable through the following two Membership provider configuration settings:</span></span>

- <span data-ttu-id="6e3be-158">`maxInvalidPasswordAttempts`-指定在帳戶被鎖定之前，使用者允許的無效密碼嘗試次數。預設值為5。</span><span class="sxs-lookup"><span data-stu-id="6e3be-158">`maxInvalidPasswordAttempts` - specifies how many invalid password attempts are allowed for the user within the time period before the account is locked out. The default value is 5.</span></span>
- <span data-ttu-id="6e3be-159">`passwordAttemptWindow`-指出指定的無效登入嘗試次數將導致帳戶遭到鎖定的時間間隔（以分鐘為單位）。預設值為10。</span><span class="sxs-lookup"><span data-stu-id="6e3be-159">`passwordAttemptWindow` - indicates the time period in minutes during which the specified number of invalid login attempts will cause the account to be locked out. The default value is 10.</span></span>

<span data-ttu-id="6e3be-160">如果使用者遭到鎖定，則在系統管理員解除鎖定其帳戶之前，她無法登入。</span><span class="sxs-lookup"><span data-stu-id="6e3be-160">If a user has been locked out, she cannot login until an administrator unlocks her account.</span></span> <span data-ttu-id="6e3be-161">當使用者遭到鎖定時，即使提供有效的認證，`ValidateUser` 方法*一律*會傳回 `False`。</span><span class="sxs-lookup"><span data-stu-id="6e3be-161">When a user is locked out, the `ValidateUser` method will *always* return `False`, even if valid credentials are supplied.</span></span> <span data-ttu-id="6e3be-162">雖然此行為可降低駭客透過暴力密碼破解方式侵入網站的可能性，但最終會鎖定只是忘記密碼的有效使用者，或不小心有 CAPS LOCK 或有不正確的輸入日期。</span><span class="sxs-lookup"><span data-stu-id="6e3be-162">While this behavior lessens the likelihood that a hacker will break into your site through brute force methods, it can end up locking out a valid user who has simply forgotten her password or accidentally has the Caps Lock on or is having a bad typing day.</span></span>

<span data-ttu-id="6e3be-163">可惜的是，沒有任何內建工具可解除鎖定使用者帳戶。</span><span class="sxs-lookup"><span data-stu-id="6e3be-163">Unfortunately, there is no built-in tool for unlocking a user account.</span></span> <span data-ttu-id="6e3be-164">若要解除鎖定帳戶，您可以直接修改資料庫-針對適當的使用者帳戶變更 `aspnet_Membership` 資料表中的 [`IsLockedOut`] 欄位，或建立 web 型介面，其中列出已鎖定的帳戶，並具有可解除鎖定的選項。</span><span class="sxs-lookup"><span data-stu-id="6e3be-164">In order to unlock an account, you can modify the database directly - change the `IsLockedOut` field in the `aspnet_Membership` table for the appropriate user account - or create a web-based interface that lists locked out accounts with options to unlock them.</span></span> <span data-ttu-id="6e3be-165">我們將在未來的教學課程中，檢查建立系統管理介面來完成一般使用者帳戶和角色相關的工作。</span><span class="sxs-lookup"><span data-stu-id="6e3be-165">We will examine creating administrative interfaces for accomplishing common user account- and role-related tasks in a future tutorial.</span></span>

> [!NOTE]
> <span data-ttu-id="6e3be-166">`ValidateUser` 方法的其中一個缺點是，當提供的認證無效時，不會提供任何說明。</span><span class="sxs-lookup"><span data-stu-id="6e3be-166">One downside of the `ValidateUser` method is that when the supplied credentials are invalid, it does not provide any explanation as to why.</span></span> <span data-ttu-id="6e3be-167">認證可能無效，因為使用者存放區中沒有相符的使用者名稱/密碼組，或是使用者尚未核准，或使用者已被鎖定。在步驟4中，我們將瞭解如何在登入嘗試失敗時，向使用者顯示更詳細的訊息。</span><span class="sxs-lookup"><span data-stu-id="6e3be-167">The credentials may be invalid because there is no matching username/password pair in the user store, or because the user has not yet been approved, or because the user has been locked out. In Step 4 we will see how to show a more detailed message to the user when their login attempt fails.</span></span>

## <a name="step-2-collecting-credentials-through-the-login-web-control"></a><span data-ttu-id="6e3be-168">步驟2：透過登入 Web 控制項收集認證</span><span class="sxs-lookup"><span data-stu-id="6e3be-168">Step 2: Collecting Credentials through the Login Web Control</span></span>

<span data-ttu-id="6e3be-169">[登入 Web 控制項](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx)呈現的預設使用者介面，與我們在<a id="Tutorial02"> </a>[*表單驗*](../introduction/an-overview-of-forms-authentication-vb.md)證教學課程的總覽中所建立的介面非常類似。</span><span class="sxs-lookup"><span data-stu-id="6e3be-169">The [Login Web control](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx) renders a default user interface very similar to the one we created back in the <a id="Tutorial02"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-vb.md) tutorial.</span></span> <span data-ttu-id="6e3be-170">使用登入控制項可讓我們完成建立介面以收集訪客認證的工作。</span><span class="sxs-lookup"><span data-stu-id="6e3be-170">Using the Login control saves us the work of having to create the interface to collect the visitor's credentials.</span></span> <span data-ttu-id="6e3be-171">此外，登入控制項會自動登入使用者（假設提交的認證是有效的），因此讓我們不必撰寫任何程式碼。</span><span class="sxs-lookup"><span data-stu-id="6e3be-171">Moreover, the Login control automatically signs in the user (assuming the submitted credentials are valid), thereby saving us from having to write any code.</span></span>

<span data-ttu-id="6e3be-172">讓我們更新 `Login.aspx`，將手動建立的介面和程式碼取代為登入控制項。</span><span class="sxs-lookup"><span data-stu-id="6e3be-172">Let's update `Login.aspx`, replacing the manually created interface and code with a Login control.</span></span> <span data-ttu-id="6e3be-173">從移除 `Login.aspx`中現有的標記和程式碼開始。</span><span class="sxs-lookup"><span data-stu-id="6e3be-173">Start by removing the existing markup and code in `Login.aspx`.</span></span> <span data-ttu-id="6e3be-174">您可以直接將其刪除，或只將其批註。若要將宣告式標記批註，請使用 `<%--` 和 `--%>` 分隔符號將它括住。</span><span class="sxs-lookup"><span data-stu-id="6e3be-174">You may delete it outright, or simply comment it out. To comment out declarative markup, surround it with the `<%--` and `--%>` delimiters.</span></span> <span data-ttu-id="6e3be-175">您可以手動輸入這些分隔符號，或如 [圖 2] 所示，您可以選取要加上批註的文字，然後按一下工具列中的 [批註掉選取的行] 圖示。</span><span class="sxs-lookup"><span data-stu-id="6e3be-175">You can enter these delimiters manually, or, as Figure 2 shows, you may select the text to comment out and then click the Comment out the selected lines icon in the Toolbar.</span></span> <span data-ttu-id="6e3be-176">同樣地，您可以使用 [批註] [選取的行] 圖示，將程式碼後置類別中選取的程式碼標記為批註。</span><span class="sxs-lookup"><span data-stu-id="6e3be-176">Similarly, you can use the Comment out the selected lines icon to comment out the selected code in the code-behind class.</span></span>

<span data-ttu-id="6e3be-177">[![將登入 .aspx 中現有的宣告式標記和原始程式碼批註](validating-user-credentials-against-the-membership-user-store-vb/_static/image5.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="6e3be-177">[![Comment Out the Existing Declarative Markup and Source Code in Login.aspx](validating-user-credentials-against-the-membership-user-store-vb/_static/image5.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image4.png)</span></span>

<span data-ttu-id="6e3be-178">**圖 2**：將登入 .Aspx 中現有的宣告式標記和原始程式碼批註（[按一下以查看完整大小的影像](validating-user-credentials-against-the-membership-user-store-vb/_static/image6.png)）</span><span class="sxs-lookup"><span data-stu-id="6e3be-178">**Figure 2**: Comment Out the Existing Declarative Markup and Source Code in Login.aspx  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image6.png))</span></span>

> [!NOTE]
> <span data-ttu-id="6e3be-179">在 Visual Studio 2005 中觀看宣告式標記時，無法使用 [批註外的選取行] 圖示。</span><span class="sxs-lookup"><span data-stu-id="6e3be-179">The Comment out the selected lines icon is not available when viewing the declarative markup in Visual Studio 2005.</span></span> <span data-ttu-id="6e3be-180">如果您不是使用 Visual Studio 2008，就必須手動新增 `<%--` 和 `--%>` 分隔符號。</span><span class="sxs-lookup"><span data-stu-id="6e3be-180">If you are not using Visual Studio 2008 you will need to manually add the `<%--` and `--%>` delimiters.</span></span>

<span data-ttu-id="6e3be-181">接下來，將登入控制項從 [工具箱] 拖曳至頁面，並將其 [`ID`] 屬性設定為 [`myLogin`]。</span><span class="sxs-lookup"><span data-stu-id="6e3be-181">Next, drag a Login control from the Toolbox on to the page and set its `ID` property to `myLogin`.</span></span> <span data-ttu-id="6e3be-182">此時，您的畫面看起來應該像 [圖 3]。</span><span class="sxs-lookup"><span data-stu-id="6e3be-182">At this point your screen should look similar to Figure 3.</span></span> <span data-ttu-id="6e3be-183">請注意，登入控制項的預設介面包含 [使用者名稱] 和 [密碼] 的 TextBox 控制項、[下次提醒我] 核取方塊和 [登入] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="6e3be-183">Note that the Login control's default interface includes TextBox controls for the username and password, a Remember me next time CheckBox, and a Log In Button.</span></span> <span data-ttu-id="6e3be-184">也有兩個文字方塊的 `RequiredFieldValidator` 控制項。</span><span class="sxs-lookup"><span data-stu-id="6e3be-184">There are also `RequiredFieldValidator` controls for the two TextBoxes.</span></span>

<span data-ttu-id="6e3be-185">[![將登入控制項新增至頁面](validating-user-credentials-against-the-membership-user-store-vb/_static/image8.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="6e3be-185">[![Add a Login Control to the Page](validating-user-credentials-against-the-membership-user-store-vb/_static/image8.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image7.png)</span></span>

<span data-ttu-id="6e3be-186">**圖 3**：將登入控制項新增至頁面（[按一下以查看完整大小的影像](validating-user-credentials-against-the-membership-user-store-vb/_static/image9.png)）</span><span class="sxs-lookup"><span data-stu-id="6e3be-186">**Figure 3**: Add a Login Control to the Page  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image9.png))</span></span>

<span data-ttu-id="6e3be-187">我們已經完成了！</span><span class="sxs-lookup"><span data-stu-id="6e3be-187">And we're done!</span></span> <span data-ttu-id="6e3be-188">按一下 [登入] 控制項的 [登入] 按鈕時，將會發生回傳，而登入控制項將會呼叫 `Membership.ValidateUser` 方法，傳入輸入的使用者名稱和密碼。</span><span class="sxs-lookup"><span data-stu-id="6e3be-188">When the Login control's Log In button is clicked, a postback will occur and the Login control will call the `Membership.ValidateUser` method, passing in the entered username and password.</span></span> <span data-ttu-id="6e3be-189">如果認證無效，登入控制項會顯示一則訊息，說明這種情況。</span><span class="sxs-lookup"><span data-stu-id="6e3be-189">If the credentials are invalid, the Login control displays a message stating such.</span></span> <span data-ttu-id="6e3be-190">不過，如果認證有效，則登入控制項會建立表單驗證票證，並將使用者重新導向至適當的頁面。</span><span class="sxs-lookup"><span data-stu-id="6e3be-190">If, however, the credentials are valid, then the Login control creates the forms authentication ticket and redirects the user to the appropriate page.</span></span>

<span data-ttu-id="6e3be-191">登入控制項會使用四個因素來決定適當的頁面，以便在成功登入時將使用者重新導向至：</span><span class="sxs-lookup"><span data-stu-id="6e3be-191">The Login control uses four factors to determine the appropriate page to redirect the user to upon a successful login:</span></span>

- <span data-ttu-id="6e3be-192">登入控制項是否位於 [表單驗證設定] 中的 `loginUrl` 設定所定義的登入頁面上;此設定的預設值為 `Login.aspx`</span><span class="sxs-lookup"><span data-stu-id="6e3be-192">Whether the Login control is on the login page as defined by `loginUrl` setting in the forms authentication configuration; this setting's default value is `Login.aspx`</span></span>
- <span data-ttu-id="6e3be-193">`ReturnUrl` querystring 參數是否存在</span><span class="sxs-lookup"><span data-stu-id="6e3be-193">The presence of a `ReturnUrl` querystring parameter</span></span>
- <span data-ttu-id="6e3be-194">登入控制項的[`DestinationUrl` 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.destinationpageurl.aspx)值</span><span class="sxs-lookup"><span data-stu-id="6e3be-194">The value of the Login control's [`DestinationUrl` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.destinationpageurl.aspx)</span></span>
- <span data-ttu-id="6e3be-195">[表單驗證設定] 中指定的 `defaultUrl` 值;此設定的預設值為 default.aspx</span><span class="sxs-lookup"><span data-stu-id="6e3be-195">The `defaultUrl` value specified in the forms authentication configuration settings; this setting's default value is Default.aspx</span></span>

<span data-ttu-id="6e3be-196">[圖 4] 說明登入控制項如何使用這四個參數來達到適當的頁面決策。</span><span class="sxs-lookup"><span data-stu-id="6e3be-196">Figure 4 depicts the how the Login control uses these four parameters to arrive at its appropriate page decision.</span></span>

<span data-ttu-id="6e3be-197">[![將登入控制項新增至頁面](validating-user-credentials-against-the-membership-user-store-vb/_static/image11.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="6e3be-197">[![Add a Login Control to the Page](validating-user-credentials-against-the-membership-user-store-vb/_static/image11.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image10.png)</span></span>

<span data-ttu-id="6e3be-198">**圖 4**：將登入控制項新增至頁面（[按一下以查看完整大小的影像](validating-user-credentials-against-the-membership-user-store-vb/_static/image12.png)）</span><span class="sxs-lookup"><span data-stu-id="6e3be-198">**Figure 4**: Add a Login Control to the Page  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image12.png))</span></span>

<span data-ttu-id="6e3be-199">請花點時間透過瀏覽器造訪網站，並在成員資格架構中以現有的使用者身分登入，以測試登入控制項。</span><span class="sxs-lookup"><span data-stu-id="6e3be-199">Take a moment to test out the Login control by visiting the site through a browser and logging in as an existing user in the Membership framework.</span></span>

<span data-ttu-id="6e3be-200">登入控制項的轉譯介面是可高度設定的。</span><span class="sxs-lookup"><span data-stu-id="6e3be-200">The Login control's rendered interface is highly configurable.</span></span> <span data-ttu-id="6e3be-201">有一些屬性會影響其外觀;還有什麼，登入控制項可以轉換成樣板，以精確控制使用者介面專案的版面配置。</span><span class="sxs-lookup"><span data-stu-id="6e3be-201">There are a number of properties that influence its appearance; what's more, the Login control can be converted into a template for precise control over the layout the user interface elements.</span></span> <span data-ttu-id="6e3be-202">此步驟的其餘部分會檢查如何自訂外觀和版面配置。</span><span class="sxs-lookup"><span data-stu-id="6e3be-202">The remainder of this step examines how to customize the appearance and layout.</span></span>

### <a name="customizing-the-login-controls-appearance"></a><span data-ttu-id="6e3be-203">自訂登入控制項的外觀</span><span class="sxs-lookup"><span data-stu-id="6e3be-203">Customizing the Login Control's Appearance</span></span>

<span data-ttu-id="6e3be-204">登入控制項的預設屬性設定會轉譯使用者介面，其中具有標題（登入）、TextBox 和標籤控制項，用於使用者名稱和密碼輸入、[下次提醒我] 核取方塊和 [登入] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="6e3be-204">The Login control's default property settings render a user interface with a title ( Log In ), TextBox and Label controls for the username and password inputs, a Remember me next time CheckBox, and a Log In button.</span></span> <span data-ttu-id="6e3be-205">這些元素的外觀都可以透過登入控制項的許多屬性來設定。</span><span class="sxs-lookup"><span data-stu-id="6e3be-205">The appearances of these elements are all configurable through the Login control's numerous properties.</span></span> <span data-ttu-id="6e3be-206">此外，您可以藉由設定屬性或兩個來新增其他使用者介面專案（例如，建立新使用者帳戶的頁面連結）。</span><span class="sxs-lookup"><span data-stu-id="6e3be-206">Furthermore, additional user interface elements - such as a link to a page to create a new user account - can be added by setting a property or two.</span></span>

<span data-ttu-id="6e3be-207">讓我們花幾分鐘的時間來 gussy 登入控制項的外觀。</span><span class="sxs-lookup"><span data-stu-id="6e3be-207">Let's spend a few moments to gussy up the appearance of our Login control.</span></span> <span data-ttu-id="6e3be-208">因為 [`Login.aspx`] 頁面已在頁面頂端顯示 [登入]，所以登入控制項的標題是多餘的。</span><span class="sxs-lookup"><span data-stu-id="6e3be-208">Since the `Login.aspx` page already has text at the top of the page that says Login, the Login control's title is superfluous.</span></span> <span data-ttu-id="6e3be-209">因此，請清除[`TitleText` 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.titletext.aspx)值，以便移除登入控制項的標題。</span><span class="sxs-lookup"><span data-stu-id="6e3be-209">Therefore, clear out the [`TitleText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.titletext.aspx) value in order to remove the Login control's title.</span></span>

<span data-ttu-id="6e3be-210">您可以分別透過 [ [`UserNameLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.usernamelabeltext.aspx) ] 和 [ [`PasswordLabelText` 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordlabeltext.aspx)]，自訂兩個 TextBox 控制項左邊的 [使用者名稱：] 和 [密碼：] 標籤。</span><span class="sxs-lookup"><span data-stu-id="6e3be-210">The User Name: and Password: Labels to the left of the two TextBox controls can be customized through the [`UserNameLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.usernamelabeltext.aspx) and [`PasswordLabelText` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordlabeltext.aspx), respectively.</span></span> <span data-ttu-id="6e3be-211">讓我們將 [使用者名稱：] 標籤變更為 [讀取 Username：]。</span><span class="sxs-lookup"><span data-stu-id="6e3be-211">Let's change the User Name: Label to read Username:.</span></span> <span data-ttu-id="6e3be-212">[標籤] 和 [TextBox] 樣式可分別透過 [ [`LabelStyle`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.labelstyle.aspx) ] 和 [ [`TextBoxStyle`] 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textboxstyle.aspx)來設定。</span><span class="sxs-lookup"><span data-stu-id="6e3be-212">The Label and TextBox styles are configurable through the [`LabelStyle`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.labelstyle.aspx) and [`TextBoxStyle` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textboxstyle.aspx), respectively.</span></span>

<span data-ttu-id="6e3be-213">您可以透過登入控制項的[`RememberMeText` 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermetext.aspx)來設定 [下次提醒我] 核取方塊的 [文字] 屬性，而其預設的核取狀態則可透過[`RememberMeSet` 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermeset.aspx)（預設為 False）來設定。</span><span class="sxs-lookup"><span data-stu-id="6e3be-213">The Remember me next time CheckBox's Text property can be set through the Login control's [`RememberMeText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermetext.aspx), and its default checked state is configurable through the [`RememberMeSet` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermeset.aspx) (which defaults to False).</span></span> <span data-ttu-id="6e3be-214">請繼續並將 `RememberMeSet` 屬性設為 True，如此一來，預設會核取 [記住我下一個時間] 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="6e3be-214">Go ahead and set the `RememberMeSet` property to True so that the Remember me next time CheckBox will be checked by default.</span></span>

<span data-ttu-id="6e3be-215">登入控制項提供兩個屬性來調整其使用者介面控制項的版面配置。</span><span class="sxs-lookup"><span data-stu-id="6e3be-215">The Login control offers two properties for adjusting the layout of its user interface controls.</span></span> <span data-ttu-id="6e3be-216">[ [`TextLayout`] 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textlayout.aspx)會指出使用者名稱：和密碼：標籤會出現在其對應的文字方塊左邊（預設值）或上方。</span><span class="sxs-lookup"><span data-stu-id="6e3be-216">The [`TextLayout` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textlayout.aspx) indicates whether the Username: and Password: Labels appear to the left of their corresponding TextBoxes (the default), or above them.</span></span> <span data-ttu-id="6e3be-217">[ [`Orientation`] 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.orientation.aspx)會指出使用者名稱和密碼輸入是以垂直方式放在同一個處（另一個上方）或水準放置。</span><span class="sxs-lookup"><span data-stu-id="6e3be-217">The [`Orientation` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.orientation.aspx) indicates whether the username and password inputs are situated vertically (one above the other) or horizontally.</span></span> <span data-ttu-id="6e3be-218">我要將這兩個屬性設為預設值，但我建議您嘗試將這兩個屬性設定為非預設值，以查看產生的效果。</span><span class="sxs-lookup"><span data-stu-id="6e3be-218">I am going to leave these two properties set to their defaults, but I encourage you to try setting these two properties to their non-default values to see the resulting effect.</span></span>

> [!NOTE]
> <span data-ttu-id="6e3be-219">在下一節設定登入控制項的版面配置時，我們將探討如何使用範本來定義版面配置控制項的使用者介面元素的精確配置。</span><span class="sxs-lookup"><span data-stu-id="6e3be-219">In the next section, Configuring the Login Control's Layout, we will look at using templates to define the precise layout of the Layout control's user interface elements.</span></span>

<span data-ttu-id="6e3be-220">將 [ [`CreateUserText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createusertext.aspx) ] 和 [ [`CreateUserUrl` 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createuserurl.aspx)] 設定為 [尚未註冊]，以將登入控制項的屬性設定加以包裝？</span><span class="sxs-lookup"><span data-stu-id="6e3be-220">Wrap up the Login control's property settings by setting the [`CreateUserText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createusertext.aspx) and [`CreateUserUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createuserurl.aspx) to Not registered yet?</span></span> <span data-ttu-id="6e3be-221">建立帳戶！</span><span class="sxs-lookup"><span data-stu-id="6e3be-221">Create an account!</span></span> <span data-ttu-id="6e3be-222">和會分別 `~/Membership/CreatingUserAccounts.aspx`。</span><span class="sxs-lookup"><span data-stu-id="6e3be-222">and `~/Membership/CreatingUserAccounts.aspx`, respectively.</span></span> <span data-ttu-id="6e3be-223">這會將超連結新增至登入控制項的介面，指向我們在<a id="Tutorial05"> </a>[上一個教學](creating-user-accounts-vb.md)課程中建立的頁面。</span><span class="sxs-lookup"><span data-stu-id="6e3be-223">This adds a hyperlink to the Login control's interface pointing to the page we created in the <a id="Tutorial05"></a>[preceding tutorial](creating-user-accounts-vb.md).</span></span> <span data-ttu-id="6e3be-224">登入控制項的[`HelpPageText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppagetext.aspx)和[`HelpPageUrl` 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppageurl.aspx)，以及[`PasswordRecoveryText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoverytext.aspx)和[`PasswordRecoveryUrl` 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoveryurl.aspx)會以相同的方式工作，也就是將連結轉譯成說明頁和密碼修復頁面。</span><span class="sxs-lookup"><span data-stu-id="6e3be-224">The Login control's [`HelpPageText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppagetext.aspx) and [`HelpPageUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppageurl.aspx) and [`PasswordRecoveryText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoverytext.aspx) and [`PasswordRecoveryUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoveryurl.aspx) work in the same manner, rendering links to a help page and a password recovery page.</span></span>

<span data-ttu-id="6e3be-225">進行這些屬性變更之後，您的登入控制項的宣告式標記和外觀看起來應該像 [圖 5] 所示。</span><span class="sxs-lookup"><span data-stu-id="6e3be-225">After making these property changes, your Login control's declarative markup and appearance should look similar to that shown in Figure 5.</span></span>

<span data-ttu-id="6e3be-226">[![登入控制項的屬性值決定其外觀](validating-user-credentials-against-the-membership-user-store-vb/_static/image14.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="6e3be-226">[![The Login Control's Properties' Values Dictate Its Appearance](validating-user-credentials-against-the-membership-user-store-vb/_static/image14.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image13.png)</span></span>

<span data-ttu-id="6e3be-227">**圖 5**：登入控制項的屬性值會決定其外觀（[按一下以查看完整大小的影像](validating-user-credentials-against-the-membership-user-store-vb/_static/image15.png)）</span><span class="sxs-lookup"><span data-stu-id="6e3be-227">**Figure 5**: The Login Control's Properties' Values Dictate Its Appearance  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image15.png))</span></span>

### <a name="configuring-the-login-controls-layout"></a><span data-ttu-id="6e3be-228">設定登入控制項的版面配置</span><span class="sxs-lookup"><span data-stu-id="6e3be-228">Configuring the Login Control's Layout</span></span>

<span data-ttu-id="6e3be-229">登入 Web 控制項的預設使用者介面會在 HTML `<table>`中配置介面。</span><span class="sxs-lookup"><span data-stu-id="6e3be-229">The Login Web control's default user interface lays out the interface in an HTML `<table>`.</span></span> <span data-ttu-id="6e3be-230">但如果我們需要更精確地控制轉譯的輸出，該怎麼辦？</span><span class="sxs-lookup"><span data-stu-id="6e3be-230">But what if we need finer control over the rendered output?</span></span> <span data-ttu-id="6e3be-231">也許我們想要以一系列的 `<div>` 標記來取代 `<table>`。</span><span class="sxs-lookup"><span data-stu-id="6e3be-231">Maybe we want to replace the `<table>` with a series of `<div>` tags.</span></span> <span data-ttu-id="6e3be-232">或者，如果我們的應用程式需要其他認證來進行驗證，該怎麼做？</span><span class="sxs-lookup"><span data-stu-id="6e3be-232">Or what if our application requires additional credentials for authentication?</span></span> <span data-ttu-id="6e3be-233">比方說，許多財務網站都需要使用者不僅提供使用者名稱和密碼，也可以提供個人識別碼（PIN）或其他識別資訊。</span><span class="sxs-lookup"><span data-stu-id="6e3be-233">Many financial websites, for instance, require users to supply not only a username and password, but also a Personal Identification Number (PIN), or other identifying information.</span></span> <span data-ttu-id="6e3be-234">不論原因為何，您都可以將登入控制項轉換成範本，以便明確定義介面的宣告式標記。</span><span class="sxs-lookup"><span data-stu-id="6e3be-234">Whatever the reasons may be, it is possible to convert the Login control into a template, from which we can explicitly define the interface's declarative markup.</span></span>

<span data-ttu-id="6e3be-235">我們需要做兩件事，才能更新登入控制項以收集其他認證：</span><span class="sxs-lookup"><span data-stu-id="6e3be-235">We need to do two things in order to update the Login control to collect additional credentials:</span></span>

1. <span data-ttu-id="6e3be-236">更新登入控制項的介面，以包含用來收集其他認證的 Web 控制項。</span><span class="sxs-lookup"><span data-stu-id="6e3be-236">Update the Login control's interface to include Web control(s) to collect the additional credentials.</span></span>
2. <span data-ttu-id="6e3be-237">覆寫登入控制項的內部驗證邏輯，如此一來，使用者只有在其使用者名稱和密碼有效，而且其其他認證也有效時，才會進行驗證。</span><span class="sxs-lookup"><span data-stu-id="6e3be-237">Override the Login control's internal authentication logic so that a user is only authenticated if their username and password is valid and their additional credentials are valid, too.</span></span>

<span data-ttu-id="6e3be-238">若要完成第一個工作，我們必須將登入控制項轉換為範本，並加入必要的 Web 控制項。</span><span class="sxs-lookup"><span data-stu-id="6e3be-238">To accomplish the first task, we need to convert the Login control into a template and add the necessary Web controls.</span></span> <span data-ttu-id="6e3be-239">就第二個工作而言，登入控制項的驗證邏輯可以藉由建立控制項的[`Authenticate` 事件](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx)的事件處理常式來取代。</span><span class="sxs-lookup"><span data-stu-id="6e3be-239">As for the second task, the Login control's authentication logic can be superseded by creating an event handler for the control's [`Authenticate` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx).</span></span>

<span data-ttu-id="6e3be-240">讓我們更新登入控制項，使其提示使用者輸入使用者名稱、密碼和電子郵件地址，並且只在提供的電子郵件地址與檔案上的電子郵件地址相符時，才驗證使用者。</span><span class="sxs-lookup"><span data-stu-id="6e3be-240">Let's update the Login control so that it prompts users for their username, password, and email address and only authenticates the user if the email address supplied matches their email address on file.</span></span> <span data-ttu-id="6e3be-241">我們必須先將登入控制項的介面轉換為範本。</span><span class="sxs-lookup"><span data-stu-id="6e3be-241">We first need to convert the Login control's interface to a template.</span></span> <span data-ttu-id="6e3be-242">從登入控制項的智慧標籤中，選擇 [轉換成範本] 選項。</span><span class="sxs-lookup"><span data-stu-id="6e3be-242">From the Login control's Smart Tag, choose the Convert to template option.</span></span>

<span data-ttu-id="6e3be-243">[![將登入控制項轉換為範本](validating-user-credentials-against-the-membership-user-store-vb/_static/image17.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="6e3be-243">[![Convert the Login Control to a Template](validating-user-credentials-against-the-membership-user-store-vb/_static/image17.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image16.png)</span></span>

<span data-ttu-id="6e3be-244">**圖 6**：將登入控制項轉換為範本（[按一下以查看完整大小的影像](validating-user-credentials-against-the-membership-user-store-vb/_static/image18.png)）</span><span class="sxs-lookup"><span data-stu-id="6e3be-244">**Figure 6**: Convert the Login Control to a Template  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image18.png))</span></span>

> [!NOTE]
> <span data-ttu-id="6e3be-245">若要將登入控制項還原為其預先範本版本，請按一下控制項智慧標籤中的 [重設] 連結。</span><span class="sxs-lookup"><span data-stu-id="6e3be-245">To revert the Login control to its pre-template version, click the Reset link from the control's Smart Tag.</span></span>

<span data-ttu-id="6e3be-246">將登入控制項轉換為範本，會使用 HTML 專案和 Web 控制項定義使用者介面，將 `LayoutTemplate` 加入控制項的宣告式標記中。</span><span class="sxs-lookup"><span data-stu-id="6e3be-246">Converting the Login control to a template adds a `LayoutTemplate` to the control's declarative markup with HTML elements and Web controls defining the user interface.</span></span> <span data-ttu-id="6e3be-247">如 [圖 7] 所示，將控制項轉換為範本會從屬性視窗中移除一些屬性，例如 `TitleText`、`CreateUserUrl`等等，因為在使用範本時，會忽略這些屬性值。</span><span class="sxs-lookup"><span data-stu-id="6e3be-247">As Figure 7 shows, converting the control to a template removes a number of properties from the Properties window, such as `TitleText`, `CreateUserUrl`, and so forth, since these property values are ignored when using a template.</span></span>

<span data-ttu-id="6e3be-248">[當登入控制項轉換成範本時，可以使用 ![較少的屬性](validating-user-credentials-against-the-membership-user-store-vb/_static/image20.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="6e3be-248">[![Fewer Properties are Available When the Login Control is Converted to a Template](validating-user-credentials-against-the-membership-user-store-vb/_static/image20.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image19.png)</span></span>

<span data-ttu-id="6e3be-249">**圖 7**：當登入控制項轉換成範本時，可以使用較少的屬性（[按一下以查看完整大小的影像](validating-user-credentials-against-the-membership-user-store-vb/_static/image21.png)）</span><span class="sxs-lookup"><span data-stu-id="6e3be-249">**Figure 7**: Fewer Properties are Available When the Login Control is Converted to a Template  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image21.png))</span></span>

<span data-ttu-id="6e3be-250">`LayoutTemplate` 中的 HTML 標籤可能會視需要修改。</span><span class="sxs-lookup"><span data-stu-id="6e3be-250">The HTML markup in the `LayoutTemplate` may be modified as needed.</span></span> <span data-ttu-id="6e3be-251">同樣地，您也可以隨意將任何新的 Web 控制項加入至範本。</span><span class="sxs-lookup"><span data-stu-id="6e3be-251">Likewise, feel free to add any new Web controls to the template.</span></span> <span data-ttu-id="6e3be-252">不過，登入控制項的核心 Web 控制項必須保留在範本中，並保留其指派的 `ID` 值，這點很重要。</span><span class="sxs-lookup"><span data-stu-id="6e3be-252">However, it is important that Login control's core Web controls remain in the template and keep their assigned `ID` values.</span></span> <span data-ttu-id="6e3be-253">特別的是，請勿移除或重新命名 [`UserName`] 或 [`Password` 文字方塊]、[`RememberMe`] 核取方塊、[`LoginButton`] 按鈕、[`FailureText`] 標籤或 [`RequiredFieldValidator`] 控制項。</span><span class="sxs-lookup"><span data-stu-id="6e3be-253">In particular, do not remove or rename the `UserName` or `Password` TextBoxes, the `RememberMe` CheckBox, the `LoginButton` Button, the `FailureText` Label, or the `RequiredFieldValidator` controls.</span></span>

<span data-ttu-id="6e3be-254">若要收集訪客的電子郵件地址，我們必須將 TextBox 新增至範本。</span><span class="sxs-lookup"><span data-stu-id="6e3be-254">To collect the visitor's email address, we need to add a TextBox to the template.</span></span> <span data-ttu-id="6e3be-255">在包含 [`Password`] 文字方塊的資料表資料列（`<tr>`）與保留 [下次提醒我] 核取方塊的資料表資料列之間，加入下列宣告式標記：</span><span class="sxs-lookup"><span data-stu-id="6e3be-255">Add the following declarative markup between the table row (`<tr>`) that contains the `Password` TextBox and the table row that holds the Remember me next time CheckBox:</span></span>

[!code-aspx[Main](validating-user-credentials-against-the-membership-user-store-vb/samples/sample2.aspx)]

<span data-ttu-id="6e3be-256">新增 [`Email`] 文字方塊之後，請透過瀏覽器造訪頁面。</span><span class="sxs-lookup"><span data-stu-id="6e3be-256">After adding the `Email` TextBox, visit the page through a browser.</span></span> <span data-ttu-id="6e3be-257">如 [圖 8] 所示，登入控制項的使用者介面現在包含第三個文字方塊。</span><span class="sxs-lookup"><span data-stu-id="6e3be-257">As Figure 8 shows, the Login control's user interface now includes a third textbox.</span></span>

<span data-ttu-id="6e3be-258">[![登入控制項現在包含使用者電子郵件地址的 Textbox](validating-user-credentials-against-the-membership-user-store-vb/_static/image23.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="6e3be-258">[![The Login Control Now Includes a Textbox for the User's Email Address](validating-user-credentials-against-the-membership-user-store-vb/_static/image23.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image22.png)</span></span>

<span data-ttu-id="6e3be-259">**圖 8**：登入控制項現在包含使用者電子郵件地址的文字方塊（[按一下以觀看完整大小的影像](validating-user-credentials-against-the-membership-user-store-vb/_static/image24.png)）</span><span class="sxs-lookup"><span data-stu-id="6e3be-259">**Figure 8**: The Login Control Now Includes a Textbox for the User's Email Address  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image24.png))</span></span>

<span data-ttu-id="6e3be-260">此時，登入控制項仍會使用 `Membership.ValidateUser` 方法來驗證提供的認證。</span><span class="sxs-lookup"><span data-stu-id="6e3be-260">At this point, the Login control is still using the `Membership.ValidateUser` method to validate the supplied credentials.</span></span> <span data-ttu-id="6e3be-261">同樣地，在 [`Email`] 文字方塊中輸入的值，與使用者是否可以登入無關。</span><span class="sxs-lookup"><span data-stu-id="6e3be-261">Correspondingly, the value entered into the `Email` TextBox has no bearing on whether the user can log in.</span></span> <span data-ttu-id="6e3be-262">在步驟3中，我們將探討如何覆寫登入控制項的驗證邏輯，讓認證只有在使用者名稱和密碼有效，而且提供的電子郵件地址與檔案上的電子郵件地址相符時才會被視為有效。</span><span class="sxs-lookup"><span data-stu-id="6e3be-262">In Step 3 we will look at how to override the Login control's authentication logic so that the credentials are only considered valid if the username and password are valid and the supplied email address matches up with the email address on file.</span></span>

## <a name="step-3-modifying-the-login-controls-authentication-logic"></a><span data-ttu-id="6e3be-263">步驟3：修改登入控制項的驗證邏輯</span><span class="sxs-lookup"><span data-stu-id="6e3be-263">Step 3: Modifying the Login Control's Authentication Logic</span></span>

<span data-ttu-id="6e3be-264">當造訪者提供自己的認證，並按一下 [登入] 按鈕時，回傳接踵而來和 Login 控制項會在其驗證工作流程中進行。</span><span class="sxs-lookup"><span data-stu-id="6e3be-264">When a visitor supplies her credentials and clicks the Log In button, a postback ensues and the Login control progresses through its authentication workflow.</span></span> <span data-ttu-id="6e3be-265">工作流程一開始會引發[`LoggingIn` 事件](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggingin.aspx)。</span><span class="sxs-lookup"><span data-stu-id="6e3be-265">The workflow starts by raising the [`LoggingIn` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggingin.aspx).</span></span> <span data-ttu-id="6e3be-266">任何與此事件相關聯的事件處理常式，都可以藉由將 `e.Cancel` 屬性設定為 `True`來取消登入作業。</span><span class="sxs-lookup"><span data-stu-id="6e3be-266">Any event handlers associated with this event may cancel the log in operation by setting the `e.Cancel` property to `True`.</span></span>

<span data-ttu-id="6e3be-267">如果未取消登入作業，工作流程會藉由引發[`Authenticate` 事件](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx)來進行。</span><span class="sxs-lookup"><span data-stu-id="6e3be-267">If the log in operation is not cancelled, the workflow progresses by raising the [`Authenticate` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx).</span></span> <span data-ttu-id="6e3be-268">如果 `Authenticate` 事件有事件處理常式，則它會負責判斷提供的認證是否有效。</span><span class="sxs-lookup"><span data-stu-id="6e3be-268">If there is an event handler for the `Authenticate` event, then it is responsible for determining whether the supplied credentials are valid or not.</span></span> <span data-ttu-id="6e3be-269">如果未指定任何事件處理常式，登入控制項會使用 `Membership.ValidateUser` 方法來判斷認證的有效性。</span><span class="sxs-lookup"><span data-stu-id="6e3be-269">If no event handler is specified, the Login control uses the `Membership.ValidateUser` method to determine the validity of the credentials.</span></span>

<span data-ttu-id="6e3be-270">如果提供的認證有效，則會建立表單驗證票證、引發[`LoggedIn` 事件](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggedin.aspx)，並將使用者重新導向至適當的頁面。</span><span class="sxs-lookup"><span data-stu-id="6e3be-270">If the supplied credentials are valid, then the forms authentication ticket is created, the [`LoggedIn` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggedin.aspx) is raised, and the user is redirected to the appropriate page.</span></span> <span data-ttu-id="6e3be-271">不過，如果認證被視為無效，則會引發[`LoginError` 事件](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loginerror.aspx)並顯示訊息，通知使用者其認證無效。</span><span class="sxs-lookup"><span data-stu-id="6e3be-271">If, however, the credentials are deemed invalid, then the [`LoginError` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loginerror.aspx) is raised and a message is displayed informing the user that their credentials were invalid.</span></span> <span data-ttu-id="6e3be-272">根據預設，在失敗時，登入控制項只會將其 `FailureText` 標籤控制項的 Text 屬性設定為失敗訊息（您的登入嘗試不會成功。</span><span class="sxs-lookup"><span data-stu-id="6e3be-272">By default, on failure the Login control simply sets its `FailureText` Label control's Text property to a failure message ( Your login attempt was not successful.</span></span> <span data-ttu-id="6e3be-273">請再試一次。</span><span class="sxs-lookup"><span data-stu-id="6e3be-273">Please try again ).</span></span> <span data-ttu-id="6e3be-274">不過，如果登入控制項的[`FailureAction` 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failureaction.aspx)設定為 `RedirectToLoginPage`，則登入控制項會發出 `Response.Redirect` 至登入頁面，附加 querystring 參數 `loginfailure=1` （這會導致登入控制項顯示失敗訊息）。</span><span class="sxs-lookup"><span data-stu-id="6e3be-274">However, if the Login control's [`FailureAction` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failureaction.aspx) is set to `RedirectToLoginPage`, then the Login control issues a `Response.Redirect` to the login page appending the querystring parameter `loginfailure=1` (which causes the Login control to display the failure message).</span></span>

<span data-ttu-id="6e3be-275">[圖 9] 提供驗證工作流程的流程圖。</span><span class="sxs-lookup"><span data-stu-id="6e3be-275">Figure 9 offers a flow chart of the authentication workflow.</span></span>

<span data-ttu-id="6e3be-276">[![登入控制項的驗證工作流程](validating-user-credentials-against-the-membership-user-store-vb/_static/image26.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="6e3be-276">[![The Login Control's Authentication Workflow](validating-user-credentials-against-the-membership-user-store-vb/_static/image26.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image25.png)</span></span>

<span data-ttu-id="6e3be-277">**圖 9**：登入控制項的驗證工作流程（[按一下以查看完整大小的影像](validating-user-credentials-against-the-membership-user-store-vb/_static/image27.png)）</span><span class="sxs-lookup"><span data-stu-id="6e3be-277">**Figure 9**: The Login Control's Authentication Workflow  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image27.png))</span></span>

> [!NOTE]
> <span data-ttu-id="6e3be-278">如果您想要使用 `FailureAction`的 [`RedirectToLogin` 頁面] 選項，請考慮下列案例。</span><span class="sxs-lookup"><span data-stu-id="6e3be-278">If you are wondering when you would use the `FailureAction`'s `RedirectToLogin` page option, consider the following scenario.</span></span> <span data-ttu-id="6e3be-279">現在，我們的 `Site.master` 主版頁面目前在由匿名使用者流覽時，會在左欄中顯示文字 Hello，stranger，但假設我們想要以登入控制項取代該文字。</span><span class="sxs-lookup"><span data-stu-id="6e3be-279">Right now our `Site.master` master page currently has the text, Hello, stranger displayed in the left column when visited by an anonymous user, but imagine that we wanted to replace that text with a Login control.</span></span> <span data-ttu-id="6e3be-280">這可讓匿名使用者從網站上的任何頁面登入，而不需要直接流覽登入頁面。</span><span class="sxs-lookup"><span data-stu-id="6e3be-280">This would allow an anonymous user to log in from any page on the site, instead of requiring them to visit the login page directly.</span></span> <span data-ttu-id="6e3be-281">不過，如果使用者無法透過主版頁面所轉譯的登入控制項登入，則將它們重新導向至登入頁面（`Login.aspx`）可能會有意義，因為該頁面可能包含其他指示、連結和其他說明（例如，建立新帳戶或抓取遺失密碼的連結）未新增至主版頁面。</span><span class="sxs-lookup"><span data-stu-id="6e3be-281">However, if a user was unable to log in via the Login control rendered by the master page, it might make sense to redirect them to the login page (`Login.aspx`) because that page likely includes additional instructions, links, and other help - such as links to create a new account or retrieve a lost password - that were not added to the master page.</span></span>

### <a name="creating-theauthenticateevent-handler"></a><span data-ttu-id="6e3be-282">建立`Authenticate`事件處理常式</span><span class="sxs-lookup"><span data-stu-id="6e3be-282">Creating the`Authenticate`Event Handler</span></span>

<span data-ttu-id="6e3be-283">為了插入我們的自訂驗證邏輯，我們必須為登入控制項的 `Authenticate` 事件建立事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="6e3be-283">In order to plug in our custom authentication logic, we need to create an event handler for the Login control's `Authenticate` event.</span></span> <span data-ttu-id="6e3be-284">建立 `Authenticate` 事件的事件處理常式將會產生下列事件處理常式定義：</span><span class="sxs-lookup"><span data-stu-id="6e3be-284">Creating an event handler for the `Authenticate` event will generate the following event handler definition:</span></span>

[!code-vb[Main](validating-user-credentials-against-the-membership-user-store-vb/samples/sample3.vb)]

<span data-ttu-id="6e3be-285">如您所見，`Authenticate` 事件處理常式會傳遞[`AuthenticateEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.authenticateeventargs.aspx)類型的物件做為第二個輸入參數。</span><span class="sxs-lookup"><span data-stu-id="6e3be-285">As you can see, the `Authenticate` event handler is passed an object of type [`AuthenticateEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.authenticateeventargs.aspx) as its second input parameter.</span></span> <span data-ttu-id="6e3be-286">`AuthenticateEventArgs` 類別包含名為 `Authenticated` 的布林值屬性，可用來指定提供的認證是否有效。</span><span class="sxs-lookup"><span data-stu-id="6e3be-286">The `AuthenticateEventArgs` class contains a Boolean property named `Authenticated` that is used to specify whether the supplied credentials are valid.</span></span> <span data-ttu-id="6e3be-287">然後，我們的工作是在此撰寫程式碼，以判斷提供的認證是否有效，並據以設定 `e.Authenticate` 屬性。</span><span class="sxs-lookup"><span data-stu-id="6e3be-287">Our task, then, is to write code here that determines whether the supplied credentials are valid or not, and to set the `e.Authenticate` property accordingly.</span></span>

### <a name="determining-and-validating-the-supplied-credentials"></a><span data-ttu-id="6e3be-288">判斷和驗證提供的認證</span><span class="sxs-lookup"><span data-stu-id="6e3be-288">Determining and Validating the Supplied Credentials</span></span>

<span data-ttu-id="6e3be-289">使用登入控制項的[`UserName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.username.aspx) ，並[`Password` 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.password.aspx)來決定使用者輸入的使用者名稱和密碼認證。</span><span class="sxs-lookup"><span data-stu-id="6e3be-289">Use the Login control's [`UserName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.username.aspx) and [`Password` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.password.aspx) to determine the username and password credentials entered by the user.</span></span> <span data-ttu-id="6e3be-290">為了判斷輸入至任何其他 Web 控制項的值（例如我們在上一個步驟中新增的 [`Email`] 文字方塊），請使用 `LoginControlID.FindControl`（" *`controlID`* "）來取得範本中 Web 控制項的程式設計參考，其 `ID` 屬性等於 *`controlID`* 。</span><span class="sxs-lookup"><span data-stu-id="6e3be-290">In order to determine the values entered into any additional Web controls (such as the `Email` TextBox we added in the previous step), use `LoginControlID.FindControl`("*`controlID`*") to obtain a programmatic reference to the Web control in the template whose `ID` property is equal to *`controlID`*.</span></span> <span data-ttu-id="6e3be-291">例如，若要取得 `Email` 文字方塊的參考，請使用下列程式碼：</span><span class="sxs-lookup"><span data-stu-id="6e3be-291">For example, to get a reference to the `Email` TextBox, use the following code:</span></span>

`Dim EmailTextBox As TextBox = CType(myLogin.FindControl("Email"), TextBox)`

<span data-ttu-id="6e3be-292">為了驗證使用者的認證，我們必須做兩件事：</span><span class="sxs-lookup"><span data-stu-id="6e3be-292">In order to validate the user's credentials we need to do two things:</span></span>

1. <span data-ttu-id="6e3be-293">確定提供的使用者名稱和密碼有效</span><span class="sxs-lookup"><span data-stu-id="6e3be-293">Ensure that the provided username and password are valid</span></span>
2. <span data-ttu-id="6e3be-294">請確定輸入的電子郵件地址符合嘗試登入之使用者的電子郵件地址</span><span class="sxs-lookup"><span data-stu-id="6e3be-294">Ensure that email address entered matches the email address on file for the user attempting to log in</span></span>

<span data-ttu-id="6e3be-295">若要完成第一次檢查，我們可以直接使用 `Membership.ValidateUser` 方法，如我們在步驟1中所見。</span><span class="sxs-lookup"><span data-stu-id="6e3be-295">To accomplish the first check we can simply use the `Membership.ValidateUser` method like we saw in Step 1.</span></span> <span data-ttu-id="6e3be-296">針對第二個檢查，我們必須判斷使用者的電子郵件地址，讓我們可以將它與輸入 TextBox 控制項的電子郵件地址進行比較。</span><span class="sxs-lookup"><span data-stu-id="6e3be-296">For the second check, we need to determine the user's email address so that we can compare it to the email address they entered into the TextBox control.</span></span> <span data-ttu-id="6e3be-297">若要取得特定使用者的相關資訊，請使用 `Membership` 類別的[`GetUser` 方法](https://msdn.microsoft.com/library/system.web.security.membership.getuser.aspx)。</span><span class="sxs-lookup"><span data-stu-id="6e3be-297">To get information about a particular user, use the `Membership` class's [`GetUser` method](https://msdn.microsoft.com/library/system.web.security.membership.getuser.aspx).</span></span>

<span data-ttu-id="6e3be-298">`GetUser` 方法有許多多載。</span><span class="sxs-lookup"><span data-stu-id="6e3be-298">The `GetUser` method has a number of overloads.</span></span> <span data-ttu-id="6e3be-299">如果在不傳入任何參數的情況下使用，它會傳回目前登入之使用者的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="6e3be-299">If used without passing in any parameters, it returns information about the currently logged in user.</span></span> <span data-ttu-id="6e3be-300">若要取得特定使用者的相關資訊，請呼叫 `GetUser` 傳入其使用者名稱。</span><span class="sxs-lookup"><span data-stu-id="6e3be-300">To get information about a particular user, call `GetUser` passing in their username.</span></span> <span data-ttu-id="6e3be-301">不論是哪一種方式，`GetUser` 都會傳回[`MembershipUser` 物件](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx)，其中包含 `UserName`、`Email`、`IsApproved`、`IsOnline`等等的屬性。</span><span class="sxs-lookup"><span data-stu-id="6e3be-301">Either way, `GetUser` returns a [`MembershipUser` object](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx), which has properties like `UserName`, `Email`, `IsApproved`, `IsOnline`, and so on.</span></span>

<span data-ttu-id="6e3be-302">下列程式碼會實行這兩項檢查。</span><span class="sxs-lookup"><span data-stu-id="6e3be-302">The following code implements these two checks.</span></span> <span data-ttu-id="6e3be-303">如果兩者都通過，則 `e.Authenticate` 會設定為 `True`，否則會指派 `False`。</span><span class="sxs-lookup"><span data-stu-id="6e3be-303">If both pass, then `e.Authenticate` is set to `True`, otherwise it is assigned `False`.</span></span>

[!code-vb[Main](validating-user-credentials-against-the-membership-user-store-vb/samples/sample4.vb)]

<span data-ttu-id="6e3be-304">將此程式碼備妥之後，請嘗試以有效的使用者身分登入，並輸入正確的使用者名稱、密碼和電子郵件地址。</span><span class="sxs-lookup"><span data-stu-id="6e3be-304">With this code in place, attempt to log in as a valid user, entering the correct username, password, and email address.</span></span> <span data-ttu-id="6e3be-305">請重試，但這次特意使用不正確的電子郵件地址（請參閱 [圖 10]）。</span><span class="sxs-lookup"><span data-stu-id="6e3be-305">Try it again, but this time purposefully use an incorrect email address (see Figure 10).</span></span> <span data-ttu-id="6e3be-306">最後，使用不存在的使用者名稱嘗試第三次。</span><span class="sxs-lookup"><span data-stu-id="6e3be-306">Finally, try it a third time using a non-existent username.</span></span> <span data-ttu-id="6e3be-307">在第一個案例中，您應該成功登入網站，但在最後兩個案例中，您應該會看到登入控制項的無效認證訊息。</span><span class="sxs-lookup"><span data-stu-id="6e3be-307">In the first case you should be successfully logged on to the site, but in the last two cases you should see the Login control's invalid credentials message.</span></span>

<span data-ttu-id="6e3be-308">[當提供不正確的電子郵件地址時，![Tito 無法登入](validating-user-credentials-against-the-membership-user-store-vb/_static/image29.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="6e3be-308">[![Tito Cannot Log In When Supplying an Incorrect Email Address](validating-user-credentials-against-the-membership-user-store-vb/_static/image29.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image28.png)</span></span>

<span data-ttu-id="6e3be-309">**圖 10**：當提供不正確的電子郵件地址時，Tito 無法登入（[按一下以觀看完整大小的影像](validating-user-credentials-against-the-membership-user-store-vb/_static/image30.png)）</span><span class="sxs-lookup"><span data-stu-id="6e3be-309">**Figure 10**: Tito Cannot Log In When Supplying an Incorrect Email Address  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image30.png))</span></span>

> [!NOTE]
> <span data-ttu-id="6e3be-310">如步驟1中的成員資格架構如何處理不正確登入嘗試一節中所述，當呼叫 `Membership.ValidateUser` 方法並傳遞不正確認證時，它會追蹤不正確登入嘗試，並在使用者超過指定的時間範圍內的無效嘗試臨界值時，將其鎖定。</span><span class="sxs-lookup"><span data-stu-id="6e3be-310">As discussed in the How the Membership Framework Handles Invalid Login Attempts section in Step 1, when the `Membership.ValidateUser` method is called and passed invalid credentials, it keeps track of the invalid login attempt and locks out the user if they exceed a certain threshold of invalid attempts within a specified time window.</span></span> <span data-ttu-id="6e3be-311">由於我們的自訂驗證邏輯會呼叫 `ValidateUser` 方法，因此有效使用者名稱的密碼不正確會遞增 [不正確登入嘗試] 計數器，但如果使用者名稱和密碼有效，但電子郵件地址不正確，此計數器就不會遞增。</span><span class="sxs-lookup"><span data-stu-id="6e3be-311">Since our custom authentication logic calls the `ValidateUser` method, an incorrect password for a valid username will increment the invalid login attempt counter, but this counter is not incremented in the case where the username and password are valid, but the email address is incorrect.</span></span> <span data-ttu-id="6e3be-312">這種行為很有説明，因為駭客不太可能知道使用者名稱和密碼，而是必須使用暴力密碼破解技術來判斷使用者的電子郵件地址。</span><span class="sxs-lookup"><span data-stu-id="6e3be-312">Chances are, this behavior is suitable, since it's unlikely that a hacker will know the username and password, but have to use brute force techniques to determine the user's email address.</span></span>

## <a name="step-4-improving-the-login-controls-invalid-credentials-message"></a><span data-ttu-id="6e3be-313">步驟4：改善登入控制項的無效認證訊息</span><span class="sxs-lookup"><span data-stu-id="6e3be-313">Step 4: Improving the Login Control's Invalid Credentials Message</span></span>

<span data-ttu-id="6e3be-314">當使用者嘗試使用不正確認證登入時，登入控制項會顯示一則訊息，說明登入嘗試不成功。</span><span class="sxs-lookup"><span data-stu-id="6e3be-314">When a user attempts to log on with invalid credentials, the Login control displays a message explaining that the login attempt was unsuccessful.</span></span> <span data-ttu-id="6e3be-315">特別是，控制項會顯示其[`FailureText` 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failuretext.aspx)所指定的訊息，其預設值為登入嘗試不成功。</span><span class="sxs-lookup"><span data-stu-id="6e3be-315">In particular, the control displays the message specified by its [`FailureText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failuretext.aspx), which has a default value of Your login attempt was not successful.</span></span> <span data-ttu-id="6e3be-316">請重試。</span><span class="sxs-lookup"><span data-stu-id="6e3be-316">Please try again.</span></span>

<span data-ttu-id="6e3be-317">回想一下，使用者的認證可能會有許多原因無效：</span><span class="sxs-lookup"><span data-stu-id="6e3be-317">Recall that there are many reasons why a user's credentials may be invalid:</span></span>

- <span data-ttu-id="6e3be-318">使用者名稱可能不存在</span><span class="sxs-lookup"><span data-stu-id="6e3be-318">The username may not exist</span></span>
- <span data-ttu-id="6e3be-319">使用者名稱已存在，但密碼無效</span><span class="sxs-lookup"><span data-stu-id="6e3be-319">The username exists, but the password is invalid</span></span>
- <span data-ttu-id="6e3be-320">使用者名稱和密碼是有效的，但使用者尚未核准</span><span class="sxs-lookup"><span data-stu-id="6e3be-320">The username and password are valid, but the user is not yet approved</span></span>
- <span data-ttu-id="6e3be-321">使用者名稱和密碼是有效的，但使用者已被鎖定（最有可能的原因是超過指定時間範圍內的無效登入嘗試次數）</span><span class="sxs-lookup"><span data-stu-id="6e3be-321">The username and password are valid, but the user is locked out (most likely because they exceeded the number of invalid login attempts within the specified time frame)</span></span>

<span data-ttu-id="6e3be-322">而使用自訂驗證邏輯時，可能還有其他原因。</span><span class="sxs-lookup"><span data-stu-id="6e3be-322">And there may be other reasons when using custom authentication logic.</span></span> <span data-ttu-id="6e3be-323">例如，使用我們在步驟3中撰寫的程式碼，使用者名稱和密碼可能是有效的，但電子郵件地址可能不正確。</span><span class="sxs-lookup"><span data-stu-id="6e3be-323">For example, with the code we wrote in Step 3, the username and password may be valid, but the email address may be incorrect.</span></span>

<span data-ttu-id="6e3be-324">無論認證為何無效，登入控制項會顯示相同的錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="6e3be-324">Regardless of why the credentials are invalid, the Login control displays the same error message.</span></span> <span data-ttu-id="6e3be-325">對於帳戶尚未核准或已被鎖定的使用者而言，這項意見反應可能會造成混淆。不過有一點工作，我們可以讓登入控制項顯示更適當的訊息。</span><span class="sxs-lookup"><span data-stu-id="6e3be-325">This lack of feedback can be confusing for a user whose account has not yet been approved or who has been locked out. With a little bit of work, though, we can have the Login control display a more appropriate message.</span></span>

<span data-ttu-id="6e3be-326">每當使用者嘗試使用不正確認證登入時，登入控制項會引發其 `LoginError` 事件。</span><span class="sxs-lookup"><span data-stu-id="6e3be-326">Whenever a user attempts to login with invalid credentials the Login control raises its `LoginError` event.</span></span> <span data-ttu-id="6e3be-327">請繼續並建立此事件的事件處理常式，並加入下列程式碼：</span><span class="sxs-lookup"><span data-stu-id="6e3be-327">Go ahead and create an event handler for this event, and add the following code:</span></span>

[!code-vb[Main](validating-user-credentials-against-the-membership-user-store-vb/samples/sample5.vb)]

<span data-ttu-id="6e3be-328">上述程式碼一開始會將登入控制項的 `FailureText` 屬性設定為預設值（您的登入嘗試不會成功。</span><span class="sxs-lookup"><span data-stu-id="6e3be-328">The above code starts by setting the Login control's `FailureText` property to the default value ( Your login attempt was not successful.</span></span> <span data-ttu-id="6e3be-329">請再試一次。</span><span class="sxs-lookup"><span data-stu-id="6e3be-329">Please try again ).</span></span> <span data-ttu-id="6e3be-330">然後，它會檢查提供的使用者名稱是否對應到現有的使用者帳戶。</span><span class="sxs-lookup"><span data-stu-id="6e3be-330">It then checks to see if the username supplied maps to an existing user account.</span></span> <span data-ttu-id="6e3be-331">若是如此，它會查閱產生的 `MembershipUser` 物件的 `IsLockedOut` 和 `IsApproved` 屬性，以判斷帳戶是否已鎖定或尚未核准。</span><span class="sxs-lookup"><span data-stu-id="6e3be-331">If so, it consults the resulting `MembershipUser` object's `IsLockedOut` and `IsApproved` properties to determine if the account has been locked out or has not yet been approved.</span></span> <span data-ttu-id="6e3be-332">不論是哪一種情況，`FailureText` 屬性都會更新為對應的值。</span><span class="sxs-lookup"><span data-stu-id="6e3be-332">In either case, the `FailureText` property is updated to a corresponding value.</span></span>

<span data-ttu-id="6e3be-333">若要測試此程式碼，請特意嘗試以現有的使用者身分登入，但使用的密碼不正確。</span><span class="sxs-lookup"><span data-stu-id="6e3be-333">To test this code, purposefully attempt to log in as an existing user, but use an incorrect password.</span></span> <span data-ttu-id="6e3be-334">在10分鐘時間範圍內的資料列中執行這五次，帳戶將會被鎖定。如 [圖 11] 所示，後續的登入嘗試一律會失敗（即使是使用正確的密碼），但現在會顯示更具描述性的帳戶，因為有太多不正確登入嘗試。</span><span class="sxs-lookup"><span data-stu-id="6e3be-334">Do this five times in a row within a 10 minute time frame and the account will be locked out. As Figure 11 shows, subsequent login attempts will always fail (even with the correct password), but will now display the more descriptive Your account has been locked out because of too many invalid login attempts.</span></span> <span data-ttu-id="6e3be-335">請洽詢系統管理員，以將您的帳戶解除鎖定訊息。</span><span class="sxs-lookup"><span data-stu-id="6e3be-335">Please contact the administrator to have your account unlocked message.</span></span>

<span data-ttu-id="6e3be-336">[![Tito 執行太多不正確登入嘗試，而且已被鎖定](validating-user-credentials-against-the-membership-user-store-vb/_static/image32.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="6e3be-336">[![Tito Performed Too Many Invalid Login Attempts and Has Been Locked Out](validating-user-credentials-against-the-membership-user-store-vb/_static/image32.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image31.png)</span></span>

<span data-ttu-id="6e3be-337">**圖 11**： Tito 執行太多不正確登入嘗試，而且已被鎖定（[按一下以觀看完整大小的影像](validating-user-credentials-against-the-membership-user-store-vb/_static/image33.png)）</span><span class="sxs-lookup"><span data-stu-id="6e3be-337">**Figure 11**: Tito Performed Too Many Invalid Login Attempts and Has Been Locked Out  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image33.png))</span></span>

## <a name="summary"></a><span data-ttu-id="6e3be-338">總結</span><span class="sxs-lookup"><span data-stu-id="6e3be-338">Summary</span></span>

<span data-ttu-id="6e3be-339">在本教學課程之前，我們的登入頁面會針對使用者名稱/密碼配對的硬式編碼清單，驗證所提供的認證。</span><span class="sxs-lookup"><span data-stu-id="6e3be-339">Prior this tutorial, our login page validated the supplied credentials against a hard-coded list of username/password pairs.</span></span> <span data-ttu-id="6e3be-340">在本教學課程中，我們已更新頁面以根據成員資格架構來驗證認證。</span><span class="sxs-lookup"><span data-stu-id="6e3be-340">In this tutorial, we updated the page to validate credentials against the Membership framework.</span></span> <span data-ttu-id="6e3be-341">在步驟1中，我們探討了以程式設計方式使用 `Membership.ValidateUser` 方法。</span><span class="sxs-lookup"><span data-stu-id="6e3be-341">In Step 1 we looked at using the `Membership.ValidateUser` method programmatically.</span></span> <span data-ttu-id="6e3be-342">在步驟2中，我們以登入控制項取代了手動建立的使用者介面和程式碼。</span><span class="sxs-lookup"><span data-stu-id="6e3be-342">In Step 2 we replaced our manually created user interface and code with the Login control.</span></span>

<span data-ttu-id="6e3be-343">登入控制項會呈現標準的登入使用者介面，並根據成員資格架構自動驗證使用者的認證。</span><span class="sxs-lookup"><span data-stu-id="6e3be-343">The Login control renders a standard login user interface and automatically validates the user's credentials against the Membership framework.</span></span> <span data-ttu-id="6e3be-344">此外，在有有效認證的情況下，登入控制項會透過表單驗證，將使用者登入。</span><span class="sxs-lookup"><span data-stu-id="6e3be-344">Moreover, in the event of valid credentials, the Login control signs the user in via forms authentication.</span></span> <span data-ttu-id="6e3be-345">簡言之，只要將登入控制項拖曳至頁面上，就可以使用功能完整的登入使用者體驗，而不需要額外的宣告式標記或程式碼。</span><span class="sxs-lookup"><span data-stu-id="6e3be-345">In short, a fully functional login user experience is available by simply dragging the Login control onto a page, no extra declarative markup or code necessary.</span></span> <span data-ttu-id="6e3be-346">更多的是，登入控制項可高度自訂，讓您能夠更精確地控制所呈現的使用者介面和驗證邏輯。</span><span class="sxs-lookup"><span data-stu-id="6e3be-346">What's more, the Login control is highly customizable, allowing for a fine degree of control over both the rendered user interface and authentication logic.</span></span>

<span data-ttu-id="6e3be-347">此時，我們網站的訪客可以建立新的使用者帳戶並登入網站，但我們尚未探討根據已驗證的使用者來限制頁面的存取權。</span><span class="sxs-lookup"><span data-stu-id="6e3be-347">At this point visitors to our website can create a new user account and log into the site, but we have yet to look at restricting access to pages based on the authenticated user.</span></span> <span data-ttu-id="6e3be-348">目前，任何使用者（已驗證或匿名）都可以在我們的網站上查看任何頁面。</span><span class="sxs-lookup"><span data-stu-id="6e3be-348">Currently, any user, authenticated or anonymous, can view any page on our site.</span></span> <span data-ttu-id="6e3be-349">除了以使用者為基礎控制網站頁面的存取權之外，我們可能會有某些網頁的功能取決於使用者。</span><span class="sxs-lookup"><span data-stu-id="6e3be-349">Along with controlling access to our site's pages on a user-by-user basis, we might have certain pages whose functionality depends on the user.</span></span> <span data-ttu-id="6e3be-350">下一個教學課程將探討如何根據登入的使用者來限制存取和頁面內功能。</span><span class="sxs-lookup"><span data-stu-id="6e3be-350">The next tutorial looks at how to limit access and in-page functionality based on the logged in user.</span></span>

<span data-ttu-id="6e3be-351">快樂的程式設計！</span><span class="sxs-lookup"><span data-stu-id="6e3be-351">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="6e3be-352">進一步閱讀</span><span class="sxs-lookup"><span data-stu-id="6e3be-352">Further Reading</span></span>

<span data-ttu-id="6e3be-353">如需本教學課程中所討論之主題的詳細資訊，請參閱下列資源：</span><span class="sxs-lookup"><span data-stu-id="6e3be-353">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="6e3be-354">將自訂訊息顯示為鎖定和未核准的使用者</span><span class="sxs-lookup"><span data-stu-id="6e3be-354">Displaying Custom Messages to Locked Out and Non-Approved Users</span></span>](http://aspnet.4guysfromrolla.com/articles/050306-1.aspx)
- [<span data-ttu-id="6e3be-355">檢查 ASP.NET 2.0 的成員資格、角色和設定檔</span><span class="sxs-lookup"><span data-stu-id="6e3be-355">Examining ASP.NET 2.0's Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="6e3be-356">如何：建立 ASP.NET 登入頁面</span><span class="sxs-lookup"><span data-stu-id="6e3be-356">How To: Create an ASP.NET Login Page</span></span>](https://msdn.microsoft.com/library/ms178331.aspx)
- [<span data-ttu-id="6e3be-357">登入控制技術檔</span><span class="sxs-lookup"><span data-stu-id="6e3be-357">Login Control Technical Documentation</span></span>](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx)
- [<span data-ttu-id="6e3be-358">使用登入控制項</span><span class="sxs-lookup"><span data-stu-id="6e3be-358">Using the Login Controls</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/security/login.aspx)

### <a name="about-the-author"></a><span data-ttu-id="6e3be-359">關於作者</span><span class="sxs-lookup"><span data-stu-id="6e3be-359">About the Author</span></span>

<span data-ttu-id="6e3be-360">Scott Mitchell，自1998起，有多個 ASP/ASP. NET 書籍和創辦人的4GuysFromRolla.com。</span><span class="sxs-lookup"><span data-stu-id="6e3be-360">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="6e3be-361">Scott 以獨立的顧問、訓練員和作者的身分運作。</span><span class="sxs-lookup"><span data-stu-id="6e3be-361">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="6e3be-362">他的最新著作是 *[在24小時內讓自己的 ASP.NET 2.0](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)* 。</span><span class="sxs-lookup"><span data-stu-id="6e3be-362">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="6e3be-363">Scott 可以在[mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com)或透過他在[http://ScottOnWriting.NET](http://scottonwriting.net/)的 blog。</span><span class="sxs-lookup"><span data-stu-id="6e3be-363">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="6e3be-364">特別感謝</span><span class="sxs-lookup"><span data-stu-id="6e3be-364">Special Thanks To</span></span>

<span data-ttu-id="6e3be-365">本教學課程系列已由許多有用的審核者所審查。</span><span class="sxs-lookup"><span data-stu-id="6e3be-365">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="6e3be-366">本教學課程的領導審查者為 Teresa Murphy 和 Michael Olivero。</span><span class="sxs-lookup"><span data-stu-id="6e3be-366">Lead reviewers for this tutorial were Teresa Murphy and Michael Olivero.</span></span> <span data-ttu-id="6e3be-367">有興趣複習我即將發行的 MSDN 文章嗎？</span><span class="sxs-lookup"><span data-stu-id="6e3be-367">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="6e3be-368">若是如此，請在[mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)的那一行下拉式。</span><span class="sxs-lookup"><span data-stu-id="6e3be-368">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="6e3be-369">[上一頁](creating-user-accounts-vb.md)
> [下一頁](user-based-authorization-vb.md)</span><span class="sxs-lookup"><span data-stu-id="6e3be-369">[Previous](creating-user-accounts-vb.md)
[Next](user-based-authorization-vb.md)</span></span>
