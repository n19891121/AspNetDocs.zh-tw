---
uid: web-forms/overview/moving-to-aspnet-20/configuration-and-instrumentation
title: 設定和檢測 |Microsoft Docs
author: microsoft
description: ASP.NET 2.0 中的設定和檢測有重大變更。 新的 ASP.NET 設定 API 允許將設定變更為 pr 。
ms.author: riande
ms.date: 02/20/2005
ms.assetid: 21ebbaee-7ed8-45ae-b6c1-c27c88342e48
msc.legacyurl: /web-forms/overview/moving-to-aspnet-20/configuration-and-instrumentation
msc.type: authoredcontent
ms.openlocfilehash: cd5bedce5459e8cf8e72df8de69ebd82f2d97789
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/06/2020
ms.locfileid: "78626025"
---
# <a name="configuration-and-instrumentation"></a><span data-ttu-id="1e551-104">設定與檢測</span><span class="sxs-lookup"><span data-stu-id="1e551-104">Configuration and Instrumentation</span></span>

<span data-ttu-id="1e551-105">由[Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="1e551-105">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="1e551-106">ASP.NET 2.0 中的設定和檢測有重大變更。</span><span class="sxs-lookup"><span data-stu-id="1e551-106">There are major changes in configuration and instrumentation in ASP.NET 2.0.</span></span> <span data-ttu-id="1e551-107">新的 ASP.NET 設定 API 可讓您以程式設計方式變更設定。</span><span class="sxs-lookup"><span data-stu-id="1e551-107">The new ASP.NET configuration API allows for configuration changes to be made programmatically.</span></span> <span data-ttu-id="1e551-108">此外，有許多新的設定會允許新的設定和檢測。</span><span class="sxs-lookup"><span data-stu-id="1e551-108">In addition, many new configuration settings exist allow for new configurations and instrumentation.</span></span>

<span data-ttu-id="1e551-109">ASP.NET 2.0 中的設定和檢測有重大變更。</span><span class="sxs-lookup"><span data-stu-id="1e551-109">There are major changes in configuration and instrumentation in ASP.NET 2.0.</span></span> <span data-ttu-id="1e551-110">新的 ASP.NET 設定 API 可讓您以程式設計方式變更設定。</span><span class="sxs-lookup"><span data-stu-id="1e551-110">The new ASP.NET configuration API allows for configuration changes to be made programmatically.</span></span> <span data-ttu-id="1e551-111">此外，有許多新的設定會允許新的設定和檢測。</span><span class="sxs-lookup"><span data-stu-id="1e551-111">In addition, many new configuration settings exist allow for new configurations and instrumentation.</span></span>

<span data-ttu-id="1e551-112">在此課程模組中，我們將討論 ASP.NET 與讀取和寫入 ASP.NET 設定檔相關的設定 API，而且我們也會介紹 ASP.NET 檢測。</span><span class="sxs-lookup"><span data-stu-id="1e551-112">In this module, we will discuss ASP.NET the configuration API as it relates to reading from and writing to ASP.NET configuration files, and we will also cover ASP.NET instrumentation.</span></span> <span data-ttu-id="1e551-113">我們也會討論 ASP.NET 追蹤中提供的新功能。</span><span class="sxs-lookup"><span data-stu-id="1e551-113">We will also cover the new features available in ASP.NET tracing.</span></span>

## <a name="aspnet-configuration-api"></a><span data-ttu-id="1e551-114">ASP.NET 設定 API</span><span class="sxs-lookup"><span data-stu-id="1e551-114">ASP.NET Configuration API</span></span>

<span data-ttu-id="1e551-115">ASP.NET 設定 API 可讓您使用單一程式設計介面來開發、部署和管理應用程式設定資料。</span><span class="sxs-lookup"><span data-stu-id="1e551-115">The ASP.NET configuration API allows you to develop, deploy, and manage application configuration data by using a single programming interface.</span></span> <span data-ttu-id="1e551-116">您可以使用設定 API，以程式設計方式開發和修改完整的 ASP.NET 設定，而不需要直接在設定檔中編輯 XML。</span><span class="sxs-lookup"><span data-stu-id="1e551-116">You can use the configuration API to develop and modify complete ASP.NET configurations programmatically without directly editing the XML in the configuration files.</span></span> <span data-ttu-id="1e551-117">此外，您還可以在主控台應用程式和腳本中使用設定 API，在 Web 管理工具和 Microsoft Management Console （MMC）嵌入式管理單元中進行開發。</span><span class="sxs-lookup"><span data-stu-id="1e551-117">In addition, you can use the configuration API in console applications and scripts that you develop, in Web-based management tools, and in Microsoft Management Console (MMC) snap-ins.</span></span>

<span data-ttu-id="1e551-118">下列兩個設定管理工具會使用設定 API，並隨附于 .NET Framework 版本2.0：</span><span class="sxs-lookup"><span data-stu-id="1e551-118">The following two configuration-management tools use the configuration API and are included with the .NET Framework version 2.0:</span></span>

- <span data-ttu-id="1e551-119">ASP.NET MMC 嵌入式管理單元，它會使用設定 API 來簡化管理工作，從設定階層的所有層級提供本機設定資料的整合式觀點。</span><span class="sxs-lookup"><span data-stu-id="1e551-119">The ASP.NET MMC snap-in, which uses the configuration API to simplify administrative tasks, providing an integrated view of local configuration data from all levels of the configuration hierarchy.</span></span>
- <span data-ttu-id="1e551-120">網站管理工具，可讓您管理本機和遠端應用程式（包括裝載的網站）的配置設定。</span><span class="sxs-lookup"><span data-stu-id="1e551-120">The Web Site Administration Tool, which allows you to manage configuration settings for local and remote applications, including hosted sites.</span></span>

<span data-ttu-id="1e551-121">ASP.NET 設定 API 包含一組 ASP.NET 管理物件，可讓您用來以程式設計的方式來設定網站和應用程式。</span><span class="sxs-lookup"><span data-stu-id="1e551-121">The ASP.NET configuration API comprises a set of ASP.NET management objects that you can use to configure Web sites and applications programmatically.</span></span> <span data-ttu-id="1e551-122">管理物件會實作為 .NET Framework Class Library。</span><span class="sxs-lookup"><span data-stu-id="1e551-122">Management objects are implemented as a .NET Framework class library.</span></span> <span data-ttu-id="1e551-123">設定 API 程式設計模型可在編譯時期強制執行資料類型，以確保程式碼的一致性和可靠性。</span><span class="sxs-lookup"><span data-stu-id="1e551-123">The configuration API programming model helps ensure code consistency and reliability by enforcing data types at compile time.</span></span> <span data-ttu-id="1e551-124">為了讓您更輕鬆地管理應用程式設定，設定 API 可讓您將從設定階層中所有點合併的資料視為單一集合，而不是以不同的個別集合形式來查看資料。設定檔。</span><span class="sxs-lookup"><span data-stu-id="1e551-124">To make it easier to manage application configurations, the configuration API allows you to view data that is merged from all points in the configuration hierarchy as a single collection, instead of viewing the data as separate collections from different configuration files.</span></span> <span data-ttu-id="1e551-125">此外，設定 API 可讓您操作整個應用程式設定，而不需要直接編輯設定檔中的 XML。</span><span class="sxs-lookup"><span data-stu-id="1e551-125">Additionally, the configuration API enables you to manipulate entire application configurations without directly editing the XML in the configuration files.</span></span> <span data-ttu-id="1e551-126">最後，API 會藉由支援系統管理工具（例如網站管理工具）來簡化設定工作。</span><span class="sxs-lookup"><span data-stu-id="1e551-126">Finally, the API simplifies configuration tasks by supporting administrative tools, such as the Web Site Administration Tool.</span></span> <span data-ttu-id="1e551-127">設定 API 可支援在電腦上建立設定檔，並在多部電腦上執行設定腳本，以簡化部署。</span><span class="sxs-lookup"><span data-stu-id="1e551-127">The configuration API simplifies deployment by supporting the creation of configuration files on a computer and running configuration scripts across multiple computers.</span></span>

> [!NOTE]
> <span data-ttu-id="1e551-128">設定 API 不支援建立 IIS 應用程式。</span><span class="sxs-lookup"><span data-stu-id="1e551-128">The configuration API does not support the creation of IIS applications.</span></span>

## <a name="working-with-local-and-remote-configuration-settings"></a><span data-ttu-id="1e551-129">使用本機和遠端設定</span><span class="sxs-lookup"><span data-stu-id="1e551-129">Working with Local and Remote Configuration Settings</span></span>

<span data-ttu-id="1e551-130">Configuration 物件代表套用至特定實體實體（如電腦）或邏輯實體（例如應用程式或網站）之設定的合併視圖。</span><span class="sxs-lookup"><span data-stu-id="1e551-130">A Configuration object represents the merged view of the configuration settings that apply to a specific physical entity, such as a computer, or to a logical entity, such as an application or a Web site.</span></span> <span data-ttu-id="1e551-131">指定的邏輯實體可以存在於本機電腦或遠端伺服器上。</span><span class="sxs-lookup"><span data-stu-id="1e551-131">The specified logical entity can exist on the local computer or on a remote server.</span></span> <span data-ttu-id="1e551-132">當指定的實體沒有任何設定檔存在時，設定物件會代表 Machine.config 檔案所定義的預設設定。</span><span class="sxs-lookup"><span data-stu-id="1e551-132">When no configuration file exists for a specified entity, the Configuration object represents the default configuration settings as defined by the Machine.config file.</span></span>

<span data-ttu-id="1e551-133">您可以使用下列類別中的其中一個 open Configuration 方法來取得設定物件：</span><span class="sxs-lookup"><span data-stu-id="1e551-133">You can get a Configuration object by using one of the open configuration methods from the following classes:</span></span>

1. <span data-ttu-id="1e551-134">如果您的實體是用戶端應用程式，則為 ConfigurationManager 類別。</span><span class="sxs-lookup"><span data-stu-id="1e551-134">The ConfigurationManager class, if your entity is a client application.</span></span>
2. <span data-ttu-id="1e551-135">如果您的實體是 Web 應用程式，則為 WebConfigurationManager 類別。</span><span class="sxs-lookup"><span data-stu-id="1e551-135">The WebConfigurationManager class, if your entity is a Web application.</span></span>

<span data-ttu-id="1e551-136">這些方法會傳回設定物件，而後者會提供必要的方法和屬性來處理基礎的設定檔。</span><span class="sxs-lookup"><span data-stu-id="1e551-136">These methods will return a Configuration object, which in turn provides the required methods and properties to handle the underlying configuration files.</span></span> <span data-ttu-id="1e551-137">您可以存取這些檔案以進行讀取或寫入。</span><span class="sxs-lookup"><span data-stu-id="1e551-137">You can access these files for reading or writing.</span></span>

### <a name="reading"></a><span data-ttu-id="1e551-138">讀取</span><span class="sxs-lookup"><span data-stu-id="1e551-138">Reading</span></span>

<span data-ttu-id="1e551-139">您可以使用 GetSection 或 GetSectionGroup 方法來讀取設定資訊。</span><span class="sxs-lookup"><span data-stu-id="1e551-139">You use the GetSection or GetSectionGroup method to read configuration information.</span></span> <span data-ttu-id="1e551-140">讀取的使用者或處理常式必須具有階層中所有設定檔的讀取權限。</span><span class="sxs-lookup"><span data-stu-id="1e551-140">The user or process that reads must have Read permissions on all of the configuration files in the hierarchy.</span></span>

> [!NOTE]
> <span data-ttu-id="1e551-141">如果您使用採用 path 參數的靜態 GetSection 方法，path 參數必須參考程式碼執行所在的應用程式。</span><span class="sxs-lookup"><span data-stu-id="1e551-141">If you use a static GetSection method that takes a path parameter, the path parameter must refer to the application in which the code is running.</span></span> <span data-ttu-id="1e551-142">否則，會忽略參數，並傳回目前正在執行之應用程式的設定資訊。</span><span class="sxs-lookup"><span data-stu-id="1e551-142">Otherwise, the parameter is ignored and the configuration information for the currently running application is returned.</span></span>

### <a name="writing"></a><span data-ttu-id="1e551-143">撰寫</span><span class="sxs-lookup"><span data-stu-id="1e551-143">Writing</span></span>

<span data-ttu-id="1e551-144">您可以使用其中一個 Save 方法來寫入設定資訊。</span><span class="sxs-lookup"><span data-stu-id="1e551-144">You use one of the Save methods to write configuration information.</span></span> <span data-ttu-id="1e551-145">寫入的使用者或處理常式必須具有目前設定階層層級之設定檔案和目錄的寫入權限，以及階層中所有設定檔的讀取權限。</span><span class="sxs-lookup"><span data-stu-id="1e551-145">The user or process that writes must have Write permissions on the configuration file and directory at the current configuration hierarchy level, as well as Read permissions on all of the configuration files in the hierarchy.</span></span>

<span data-ttu-id="1e551-146">若要產生代表所指定實體之繼承設定的設定檔，請使用下列其中一個儲存配置方法：</span><span class="sxs-lookup"><span data-stu-id="1e551-146">To generate a configuration file that represents the inherited configuration settings for a specified entity, use one of the following save-configuration methods:</span></span>

1. <span data-ttu-id="1e551-147">用來建立新設定檔案的 Save 方法。</span><span class="sxs-lookup"><span data-stu-id="1e551-147">The Save method to create a new configuration file.</span></span>
2. <span data-ttu-id="1e551-148">在另一個位置產生新設定檔案的 SaveAs 方法。</span><span class="sxs-lookup"><span data-stu-id="1e551-148">The SaveAs method to generate a new configuration file at another location.</span></span>

## <a name="configuration-classes-and-namespaces"></a><span data-ttu-id="1e551-149">設定類別和命名空間</span><span class="sxs-lookup"><span data-stu-id="1e551-149">Configuration Classes and Namespaces</span></span>

<span data-ttu-id="1e551-150">許多設定類別和方法彼此類似。</span><span class="sxs-lookup"><span data-stu-id="1e551-150">Many configuration classes and methods are similar to each other.</span></span> <span data-ttu-id="1e551-151">下表描述最常使用的設定類別和命名空間。</span><span class="sxs-lookup"><span data-stu-id="1e551-151">The following table describes the most commonly used configuration classes and namespaces.</span></span>

| <span data-ttu-id="1e551-152">**設定類別或命名空間**</span><span class="sxs-lookup"><span data-stu-id="1e551-152">**Configuration class or namespace**</span></span> | <span data-ttu-id="1e551-153">**說明**</span><span class="sxs-lookup"><span data-stu-id="1e551-153">**Description**</span></span> |
| --- | --- |
| <span data-ttu-id="1e551-154">[System. Configuration](https://msdn.microsoft.com/library/system.configuration.aspx)命名空間</span><span class="sxs-lookup"><span data-stu-id="1e551-154">[System.Configuration](https://msdn.microsoft.com/library/system.configuration.aspx) namespace</span></span> | <span data-ttu-id="1e551-155">包含所有 .NET Framework 應用程式的主要設定類別。</span><span class="sxs-lookup"><span data-stu-id="1e551-155">Contains the main configuration classes for all .NET Framework applications.</span></span> <span data-ttu-id="1e551-156">區段處理常式類別是用來從方法（例如 GetSection 和 GetSectionGroup）取得區段的設定資料。</span><span class="sxs-lookup"><span data-stu-id="1e551-156">Section handler classes are used to obtain configuration data for a section from methods, such as GetSection and GetSectionGroup.</span></span> <span data-ttu-id="1e551-157">這兩種方法不是靜態的。</span><span class="sxs-lookup"><span data-stu-id="1e551-157">These two methods are non-static.</span></span> |
| <span data-ttu-id="1e551-158">Configuration 類別</span><span class="sxs-lookup"><span data-stu-id="1e551-158">System.Configuration.Configuration class</span></span> | <span data-ttu-id="1e551-159">代表電腦、應用程式、Web 目錄或其他資源的一組設定資料。</span><span class="sxs-lookup"><span data-stu-id="1e551-159">Represents a set of configuration data for a computer, application, Web directory, or other resource.</span></span> <span data-ttu-id="1e551-160">此類別包含有用的方法（例如 GetSection 和 GetSectionGroup），可用來更新設定，以及取得區段和區段群組的參考。</span><span class="sxs-lookup"><span data-stu-id="1e551-160">This class contains useful methods, such as GetSection and GetSectionGroup, for updating configuration settings and obtaining references to sections and section groups.</span></span> <span data-ttu-id="1e551-161">這個類別是用來做為取得設計階段設定資料之方法的傳回型別，例如 WebConfigurationManager 和 ConfigurationManager 類別的方法。</span><span class="sxs-lookup"><span data-stu-id="1e551-161">This class is used as a return type for methods that obtain design-time configuration data, such as the methods of the WebConfigurationManager and ConfigurationManager classes.</span></span> |
| <span data-ttu-id="1e551-162">System.web. Configuration 命名空間</span><span class="sxs-lookup"><span data-stu-id="1e551-162">System.Web.Configuration namespace</span></span> | <span data-ttu-id="1e551-163">包含 ASP.NET 設定區段的區段處理常式類別，定義于[ASP.NET Configuration Settings](https://msdn.microsoft.com/library/b5ysx397.aspx)。</span><span class="sxs-lookup"><span data-stu-id="1e551-163">Contains the section handler classes for the ASP.NET configuration sections defined at [ASP.NET Configuration Settings](https://msdn.microsoft.com/library/b5ysx397.aspx).</span></span> <span data-ttu-id="1e551-164">區段處理常式類別是用來從方法（例如 GetSection 和 GetSectionGroup）取得區段的設定資料。</span><span class="sxs-lookup"><span data-stu-id="1e551-164">Section handler classes are used to obtain configuration data for a section from methods, such as GetSection and GetSectionGroup.</span></span> |
| <span data-ttu-id="1e551-165">System.web. WebConfigurationManager 類別</span><span class="sxs-lookup"><span data-stu-id="1e551-165">System.Web.Configuration.WebConfigurationManager class</span></span> | <span data-ttu-id="1e551-166">提供實用的方法來取得執行時間和設計階段設定的參考。</span><span class="sxs-lookup"><span data-stu-id="1e551-166">Provides useful methods for obtaining references to run-time and design-time configuration settings.</span></span> <span data-ttu-id="1e551-167">這些方法會使用 System.object 做為傳回型別。</span><span class="sxs-lookup"><span data-stu-id="1e551-167">These methods use the System.Configuration.Configuration class as a return type.</span></span> <span data-ttu-id="1e551-168">您可以交替使用這個類別的靜態 GetSection 方法，或 ConfigurationManager 類別的非靜態 GetSection 方法。</span><span class="sxs-lookup"><span data-stu-id="1e551-168">You can use the static GetSection method of this class or the non-static GetSection method of the System.Configuration.ConfigurationManager class interchangeably.</span></span> <span data-ttu-id="1e551-169">針對 Web 應用程式設定，建議使用 WebConfigurationManager 類別，而不是 ConfigurationManager 類別。</span><span class="sxs-lookup"><span data-stu-id="1e551-169">For Web application configurations, the System.Web.Configuration.WebConfigurationManager class is recommended instead of the System.Configuration.ConfigurationManager class.</span></span> |
| <span data-ttu-id="1e551-170">[提供者](https://msdn.microsoft.com/library/system.configuration.provider.aspx)命名空間</span><span class="sxs-lookup"><span data-stu-id="1e551-170">[System.Configuration.Provider](https://msdn.microsoft.com/library/system.configuration.provider.aspx) namespace</span></span> | <span data-ttu-id="1e551-171">提供自訂和擴充設定提供者的方法。</span><span class="sxs-lookup"><span data-stu-id="1e551-171">Provides a way to customize and extend the configuration provider.</span></span> <span data-ttu-id="1e551-172">這是設定系統中所有提供者類別的基本類別。</span><span class="sxs-lookup"><span data-stu-id="1e551-172">This is the base class for all provider classes in the configuration system.</span></span> |
| <span data-ttu-id="1e551-173">[System.web. Management](https://msdn.microsoft.com/library/system.web.management.aspx)命名空間</span><span class="sxs-lookup"><span data-stu-id="1e551-173">[System.Web.Management](https://msdn.microsoft.com/library/system.web.management.aspx) namespace</span></span> | <span data-ttu-id="1e551-174">包含用來管理及監視 Web 應用程式健全狀況的類別和介面。</span><span class="sxs-lookup"><span data-stu-id="1e551-174">Contains classes and interfaces for managing and monitoring the health of Web applications.</span></span> <span data-ttu-id="1e551-175">嚴格來說，此命名空間不會被視為設定 API 的一部分。</span><span class="sxs-lookup"><span data-stu-id="1e551-175">Strictly speaking, this namespace is not considered part of the configuration API.</span></span> <span data-ttu-id="1e551-176">例如，追蹤和事件引發是由這個命名空間中的類別來完成。</span><span class="sxs-lookup"><span data-stu-id="1e551-176">For example, tracing and event firing is accomplished by the classes in this namespace.</span></span> |
| <span data-ttu-id="1e551-177">[System.web](https://msdn.microsoft.com/library/system.management.instrumentation.aspx)命名空間</span><span class="sxs-lookup"><span data-stu-id="1e551-177">[System.Management.Instrumentation](https://msdn.microsoft.com/library/system.management.instrumentation.aspx) namespace</span></span> | <span data-ttu-id="1e551-178">提供應用程式檢測所需的類別，透過 Windows Management Instrumentation （WMI）向潛在取用者公開其管理資訊和事件。</span><span class="sxs-lookup"><span data-stu-id="1e551-178">Provides the classes necessary for the instrumentation of applications to expose their management information and events through Windows Management Instrumentation (WMI) to potential consumers.</span></span> <span data-ttu-id="1e551-179">ASP.NET 健全狀況監視會使用 WMI 來傳遞事件。</span><span class="sxs-lookup"><span data-stu-id="1e551-179">ASP.NET health monitoring uses WMI to deliver events.</span></span> <span data-ttu-id="1e551-180">嚴格來說，此命名空間不會被視為設定 API 的一部分。</span><span class="sxs-lookup"><span data-stu-id="1e551-180">Strictly speaking, this namespace is not considered part of the configuration API.</span></span> |

## <a name="reading-from-aspnet-configuration-files"></a><span data-ttu-id="1e551-181">從 ASP.NET 設定檔讀取</span><span class="sxs-lookup"><span data-stu-id="1e551-181">Reading from ASP.NET Configuration Files</span></span>

<span data-ttu-id="1e551-182">WebConfigurationManager 類別是用來從 ASP.NET 設定檔讀取的核心類別。</span><span class="sxs-lookup"><span data-stu-id="1e551-182">The WebConfigurationManager class is the core class for reading from ASP.NET configuration files.</span></span> <span data-ttu-id="1e551-183">基本上，有三個步驟可讀取 ASP.NET 設定檔：</span><span class="sxs-lookup"><span data-stu-id="1e551-183">There are essentially three steps to reading ASP.NET configuration files:</span></span>

1. <span data-ttu-id="1e551-184">使用 OpenWebConfiguration 方法取得設定物件。</span><span class="sxs-lookup"><span data-stu-id="1e551-184">Get a Configuration object using the OpenWebConfiguration method.</span></span>
2. <span data-ttu-id="1e551-185">取得設定檔中所需區段的參考。</span><span class="sxs-lookup"><span data-stu-id="1e551-185">Get a reference to the desired section in the configuration file.</span></span>
3. <span data-ttu-id="1e551-186">從設定檔讀取所需的資訊。</span><span class="sxs-lookup"><span data-stu-id="1e551-186">Read the desired information from the configuration file.</span></span>

<span data-ttu-id="1e551-187">Configuration 物件代表不代表特定的設定檔。</span><span class="sxs-lookup"><span data-stu-id="1e551-187">The Configuration object represents does not represent a particular configuration file.</span></span> <span data-ttu-id="1e551-188">相反地，它代表電腦、應用程式或網站設定的合併視圖。</span><span class="sxs-lookup"><span data-stu-id="1e551-188">Instead, it represents a merged view of the configuration of a computer, application, or Web site.</span></span> <span data-ttu-id="1e551-189">下列程式碼範例會具現化設定物件，代表名為*ProductInfo*的 Web 應用程式的設定。</span><span class="sxs-lookup"><span data-stu-id="1e551-189">The following code sample instantiates a Configuration object representing the configuration of a Web application called *ProductInfo*.</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample1.cs)]

> [!NOTE]
> <span data-ttu-id="1e551-190">請注意，如果/ProductInfo 路徑不存在，則上述程式碼會傳回 machine.config 檔案中指定的預設設定。</span><span class="sxs-lookup"><span data-stu-id="1e551-190">Note that if the /ProductInfo path doesn't exist, the above code will return the default configuration as specified in the machine.config file.</span></span>

<span data-ttu-id="1e551-191">擁有設定物件之後，您就可以使用 GetSection 或 GetSectionGroup 方法來深入探索設定。</span><span class="sxs-lookup"><span data-stu-id="1e551-191">Once you have the Configuration object, you can then use the GetSection or GetSectionGroup method to drill into the configuration settings.</span></span> <span data-ttu-id="1e551-192">下列範例會取得上述 ProductInfo 應用程式之模擬設定的參考：</span><span class="sxs-lookup"><span data-stu-id="1e551-192">The following example gets a reference to the impersonation settings for the above ProductInfo application:</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample2.cs)]

## <a name="writing-to-aspnet-configuration-files"></a><span data-ttu-id="1e551-193">寫入 ASP.NET 設定檔案</span><span class="sxs-lookup"><span data-stu-id="1e551-193">Writing to ASP.NET Configuration Files</span></span>

<span data-ttu-id="1e551-194">如同從設定檔讀取，WebConfigurationManager 類別是寫入 Asp.NET 設定檔的核心。</span><span class="sxs-lookup"><span data-stu-id="1e551-194">As in reading from configuration files, the WebConfigurationManager class is the core for writing to Asp.NET configuration files.</span></span> <span data-ttu-id="1e551-195">寫入 ASP.NET 設定檔的步驟也有三個。</span><span class="sxs-lookup"><span data-stu-id="1e551-195">There are also three steps to writing to ASP.NET configuration files.</span></span>

1. <span data-ttu-id="1e551-196">使用 OpenWebConfiguration 方法取得設定物件。</span><span class="sxs-lookup"><span data-stu-id="1e551-196">Get a Configuration object using the OpenWebConfiguration method.</span></span>
2. <span data-ttu-id="1e551-197">取得設定檔中所需區段的參考。</span><span class="sxs-lookup"><span data-stu-id="1e551-197">Get a reference to the desired section in the configuration file.</span></span>
3. <span data-ttu-id="1e551-198">使用 Save 或 SaveAs 方法，從設定檔案寫入所需的資訊。</span><span class="sxs-lookup"><span data-stu-id="1e551-198">Write the desired information from the configuration file using the Save or SaveAs method.</span></span>

<span data-ttu-id="1e551-199">下列程式碼會將 &lt;編譯&gt; 元素的**debug**屬性變更為 false：</span><span class="sxs-lookup"><span data-stu-id="1e551-199">The following code changes the **debug** attribute of the &lt;compilation&gt; element to false:</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample3.cs)]

<span data-ttu-id="1e551-200">執行此程式碼時，會針對*webApp*應用程式的 web.config 檔案，將 &lt;編譯&gt; 元素的**debug**屬性設為 false。</span><span class="sxs-lookup"><span data-stu-id="1e551-200">When this code is executed, the **debug** attribute of the &lt;compilation&gt; element will be set to false for the *webApp* application's web.config file.</span></span>

## <a name="systemwebmanagement-namespace"></a><span data-ttu-id="1e551-201">System.web. Management 命名空間</span><span class="sxs-lookup"><span data-stu-id="1e551-201">System.Web.Management Namespace</span></span>

<span data-ttu-id="1e551-202">System.web 命名空間提供類別和介面，可用來管理和監視 ASP.NET 應用程式的健全狀況。</span><span class="sxs-lookup"><span data-stu-id="1e551-202">The System.Web.Management namespace provides the classes and interfaces for managing and monitoring the health of ASP.NET applications.</span></span>

<span data-ttu-id="1e551-203">藉由定義將事件與提供者產生關聯的規則，即可完成記錄。</span><span class="sxs-lookup"><span data-stu-id="1e551-203">Logging is accomplished by defining a rule that associates events with a provider.</span></span> <span data-ttu-id="1e551-204">此規則會定義傳送給提供者的事件種類。</span><span class="sxs-lookup"><span data-stu-id="1e551-204">The rule defines the type of events that are sent to the provider.</span></span> <span data-ttu-id="1e551-205">下列基底事件可供您記錄：</span><span class="sxs-lookup"><span data-stu-id="1e551-205">The following base events are available for you to log:</span></span>

| <span data-ttu-id="1e551-206">**WebBaseEvent**</span><span class="sxs-lookup"><span data-stu-id="1e551-206">**WebBaseEvent**</span></span> | <span data-ttu-id="1e551-207">所有事件的基底事件類別。</span><span class="sxs-lookup"><span data-stu-id="1e551-207">The base event class for all events.</span></span> <span data-ttu-id="1e551-208">包含所有事件（例如事件程式碼、事件詳細資料、引發事件的日期和時間、序號、事件訊息和事件詳細資料）所需的屬性。</span><span class="sxs-lookup"><span data-stu-id="1e551-208">Contains the required properties for all events such as event code, event detail code, the date and time the event was raised, sequence number, the event message, and event details.</span></span> |
| --- | --- |
| <span data-ttu-id="1e551-209">**WebManagementEvent**</span><span class="sxs-lookup"><span data-stu-id="1e551-209">**WebManagementEvent**</span></span> | <span data-ttu-id="1e551-210">管理事件的基底事件類別，例如應用程式存留期、要求、錯誤和 audit 事件。</span><span class="sxs-lookup"><span data-stu-id="1e551-210">The base event class for management events, such as application lifetime, request, error, and audit events.</span></span> |
| <span data-ttu-id="1e551-211">**WebHeartbeatEvent**</span><span class="sxs-lookup"><span data-stu-id="1e551-211">**WebHeartbeatEvent**</span></span> | <span data-ttu-id="1e551-212">應用程式定期產生的事件，用來捕捉有用的執行時間狀態資訊。</span><span class="sxs-lookup"><span data-stu-id="1e551-212">The event generated by the application in regular intervals to capture useful runtime state information.</span></span> |
| <span data-ttu-id="1e551-213">**WebAuditEvent**</span><span class="sxs-lookup"><span data-stu-id="1e551-213">**WebAuditEvent**</span></span> | <span data-ttu-id="1e551-214">安全性 audit 事件的基類，用來標示條件，例如授權失敗、解密失敗*等等。*</span><span class="sxs-lookup"><span data-stu-id="1e551-214">The base class for security audit events, which are used to mark conditions such as authorization failure, decryption failure, *etc.*</span></span> |
| <span data-ttu-id="1e551-215">**WebRequestEvent**</span><span class="sxs-lookup"><span data-stu-id="1e551-215">**WebRequestEvent**</span></span> | <span data-ttu-id="1e551-216">所有資訊要求事件的基類。</span><span class="sxs-lookup"><span data-stu-id="1e551-216">The base class for all informational request events.</span></span> |
| <span data-ttu-id="1e551-217">**WebBaseErrorEvent**</span><span class="sxs-lookup"><span data-stu-id="1e551-217">**WebBaseErrorEvent**</span></span> | <span data-ttu-id="1e551-218">所有表示錯誤狀況之事件的基類。</span><span class="sxs-lookup"><span data-stu-id="1e551-218">The base class for all events indicating error conditions.</span></span> |

<span data-ttu-id="1e551-219">可用的提供者類型可讓您將事件輸出傳送至事件檢視器、SQL Server、Windows Management Instrumentation （WMI）和電子郵件。</span><span class="sxs-lookup"><span data-stu-id="1e551-219">The types of providers available allow you to send event output to Event Viewer, SQL Server, Windows Management Instrumentation (WMI), and email.</span></span> <span data-ttu-id="1e551-220">預先設定的提供者和事件對應會減少取得記錄事件輸出所需的工作量。</span><span class="sxs-lookup"><span data-stu-id="1e551-220">The pre-configured providers and event mappings reduce the amount of work necessary to get event output logged.</span></span>

<span data-ttu-id="1e551-221">ASP.NET 2.0 會使用現成的事件記錄提供者，根據啟動和停止的應用程式域記錄事件，以及記錄任何未處理的例外狀況。</span><span class="sxs-lookup"><span data-stu-id="1e551-221">ASP.NET 2.0 uses the Event Log provider out-of-the-box to log events based on application domains starting and stopping, as well as logging any unhandled exceptions.</span></span> <span data-ttu-id="1e551-222">這有助於涵蓋一些基本案例。</span><span class="sxs-lookup"><span data-stu-id="1e551-222">This helps to cover some of the basic scenarios.</span></span> <span data-ttu-id="1e551-223">例如，假設您的應用程式擲回例外狀況，但使用者不會儲存錯誤，而且您無法重現此問題。</span><span class="sxs-lookup"><span data-stu-id="1e551-223">For example, let's say that your application throws an exception, but the user doesn't save the error and you can't reproduce it.</span></span> <span data-ttu-id="1e551-224">使用預設的事件記錄檔規則，您可以收集例外狀況和堆疊資訊，以深入瞭解發生的錯誤類型。</span><span class="sxs-lookup"><span data-stu-id="1e551-224">With the default Event Log rule, you would be able to gather the exception and stack information to get a better idea of what kind of error occurred.</span></span> <span data-ttu-id="1e551-225">如果您的應用程式遺失會話狀態，則會套用另一個範例。</span><span class="sxs-lookup"><span data-stu-id="1e551-225">Another example applies if your application is losing session state.</span></span> <span data-ttu-id="1e551-226">在這種情況下，您可以查看事件記錄檔，以判斷應用程式域是否正在回收，以及為什麼應用程式域是在第一個位置停止的。</span><span class="sxs-lookup"><span data-stu-id="1e551-226">In that case, you can look in the Event Log to determine whether the application domain is recycling, and why the application domain stopped in the first place.</span></span>

<span data-ttu-id="1e551-227">此外，健全狀況監視系統也是可擴充的。</span><span class="sxs-lookup"><span data-stu-id="1e551-227">Also, the health monitoring system is extensible.</span></span> <span data-ttu-id="1e551-228">例如，您可以定義自訂的 Web 事件、在應用程式內引發它們，然後定義規則以將事件資訊傳送給提供者（例如您的電子郵件）。</span><span class="sxs-lookup"><span data-stu-id="1e551-228">For example, you can define custom Web events, fire them within your application, and then define a rule to send the event information to a provider such as your email.</span></span> <span data-ttu-id="1e551-229">這可讓您輕鬆地將檢測與健全狀況監視提供者結合。</span><span class="sxs-lookup"><span data-stu-id="1e551-229">This allows you to easily tie your instrumentation to the health monitoring providers.</span></span> <span data-ttu-id="1e551-230">另舉一個例子，您可以在每次處理訂單時引發事件，並設定一個規則，將每個事件傳送至 SQL Server 資料庫。</span><span class="sxs-lookup"><span data-stu-id="1e551-230">As another example, you could fire an event each time an order is processed and set up a rule that sends each event to the SQL Server database.</span></span> <span data-ttu-id="1e551-231">當使用者無法在資料列中登入多次時，您也可以引發事件，並設定事件以使用以電子郵件為基礎的提供者。</span><span class="sxs-lookup"><span data-stu-id="1e551-231">You could also fire an event when a user fails to log on multiple times in a row, and set up the event to use the email-based providers.</span></span>

<span data-ttu-id="1e551-232">預設提供者和事件的設定會儲存在全域 Web.config 檔案中。</span><span class="sxs-lookup"><span data-stu-id="1e551-232">The configuration for the default providers and events is stored in the global Web.config file.</span></span> <span data-ttu-id="1e551-233">全域 web.config 檔案會將儲存在 machine.config 檔案中的所有網頁型設定儲存在 ASP.NET 1x 中。</span><span class="sxs-lookup"><span data-stu-id="1e551-233">The global Web.config file stores all the Web-based settings that were stored in the Machine.config file in ASP.NET 1x.</span></span> <span data-ttu-id="1e551-234">全域 web.config 檔案位於下列目錄：</span><span class="sxs-lookup"><span data-stu-id="1e551-234">The global Web.config file is located in the following directory:</span></span>

`%windir%\Microsoft.Net\Framework\v2.0.*\config\Web.config`

<span data-ttu-id="1e551-235">全域 Web.config 檔案的 &lt;healthMonitoring&gt; 區段會提供預設的設定。</span><span class="sxs-lookup"><span data-stu-id="1e551-235">The &lt;healthMonitoring&gt; section of the global Web.config file provides default configuration settings.</span></span> <span data-ttu-id="1e551-236">您可以藉由在應用程式的 web.config 檔案中，執行 &lt;healthMonitoring&gt; 區段來覆寫這些設定或設定您自己的設定。</span><span class="sxs-lookup"><span data-stu-id="1e551-236">You can override these setting or configure your own settings by implementing the &lt;healthMonitoring&gt; section in the Web.config file for your application.</span></span>

<span data-ttu-id="1e551-237">全域 Web.config 檔案的 &lt;healthMonitoring&gt; 區段包含下列專案：</span><span class="sxs-lookup"><span data-stu-id="1e551-237">The &lt;healthMonitoring&gt; section of the global Web.config file contains the following items:</span></span>

| <span data-ttu-id="1e551-238">**提供者**</span><span class="sxs-lookup"><span data-stu-id="1e551-238">**providers**</span></span> | <span data-ttu-id="1e551-239">包含為事件檢視器、WMI 和 SQL Server 設定的提供者。</span><span class="sxs-lookup"><span data-stu-id="1e551-239">Contains providers set up for the Event Viewer, WMI, and SQL Server.</span></span> |
| --- | --- |
| <span data-ttu-id="1e551-240">**Healthmonitoring 之 eventmappings**</span><span class="sxs-lookup"><span data-stu-id="1e551-240">**eventMappings**</span></span> | <span data-ttu-id="1e551-241">包含各種 WebBase 類別的對應。</span><span class="sxs-lookup"><span data-stu-id="1e551-241">Contains mappings for the various WebBase classes.</span></span> <span data-ttu-id="1e551-242">如果您產生自己的事件類別，可以擴充此清單。</span><span class="sxs-lookup"><span data-stu-id="1e551-242">You can extend this list if you generate your own event class.</span></span> <span data-ttu-id="1e551-243">產生您自己的事件類別，可讓您更精確地處理您傳送資訊的提供者。</span><span class="sxs-lookup"><span data-stu-id="1e551-243">Generating your own event class gives you finer granularity over the providers you send information to.</span></span> <span data-ttu-id="1e551-244">例如，您可以設定要傳送至 SQL Server 的未處理例外狀況，同時將您自己的自訂事件傳送至電子郵件。</span><span class="sxs-lookup"><span data-stu-id="1e551-244">For example, you could configure unhandled exceptions to be sent to SQL Server, while sending your own custom events to email.</span></span> |
| <span data-ttu-id="1e551-245">**條**</span><span class="sxs-lookup"><span data-stu-id="1e551-245">**rules**</span></span> | <span data-ttu-id="1e551-246">將 Healthmonitoring 之 eventmappings 連結至提供者。</span><span class="sxs-lookup"><span data-stu-id="1e551-246">Links the eventMappings to the provider.</span></span> |
| <span data-ttu-id="1e551-247">**緩衝**</span><span class="sxs-lookup"><span data-stu-id="1e551-247">**buffering**</span></span> | <span data-ttu-id="1e551-248">與 SQL Server 和電子郵件提供者搭配使用，以決定將事件排清至提供者的頻率。</span><span class="sxs-lookup"><span data-stu-id="1e551-248">Used with SQL Server and email providers to determine how often to flush the events to the provider.</span></span> |

<span data-ttu-id="1e551-249">以下是來自全域 Web.config 檔案的程式碼範例。</span><span class="sxs-lookup"><span data-stu-id="1e551-249">Below is a code example from the global Web.config file.</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample4.xml)]

## <a name="how-to-store-events-to-event-viewer"></a><span data-ttu-id="1e551-250">如何將事件儲存至事件檢視器</span><span class="sxs-lookup"><span data-stu-id="1e551-250">How to store events to Event Viewer</span></span>

<span data-ttu-id="1e551-251">如先前所述，在全域 Web.config 檔案中，會為您設定在事件檢視器中記錄事件的提供者。</span><span class="sxs-lookup"><span data-stu-id="1e551-251">As mentioned earlier, the provider for logging events in the Event Viewer is configured for you in the global Web.config file.</span></span> <span data-ttu-id="1e551-252">根據預設，系統會記錄以**WebBaseErrorEvent**和**WebFailureAuditEvent**為基礎的所有事件。</span><span class="sxs-lookup"><span data-stu-id="1e551-252">By default, all events based on **WebBaseErrorEvent** and **WebFailureAuditEvent** are logged.</span></span> <span data-ttu-id="1e551-253">您可以新增其他規則，以將其他資訊記錄到事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="1e551-253">You can add additional rules to log additional information to the Event Log.</span></span> <span data-ttu-id="1e551-254">例如，如果您想要記錄所有事件（也就是以**WebBaseEvent**為*基礎的每*個事件），您可以將下列規則新增至 web.config 檔案：</span><span class="sxs-lookup"><span data-stu-id="1e551-254">For example, if you wanted to log all events (*i.e.*, every event based on **WebBaseEvent**), you could add the following rule to your Web.config file:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample5.xml)]

<span data-ttu-id="1e551-255">此規則會將 [**所有事件**] 事件對應連結至事件記錄檔提供者。</span><span class="sxs-lookup"><span data-stu-id="1e551-255">This rule would link the **All Events** event map to the Event Log provider.</span></span> <span data-ttu-id="1e551-256">EventMapping 和提供者都包含在全域 Web.config 檔案中。</span><span class="sxs-lookup"><span data-stu-id="1e551-256">Both eventMapping and the provider are included in the global Web.config file.</span></span>

## <a name="how-to-store-events-to-sql-server"></a><span data-ttu-id="1e551-257">如何將事件儲存至 SQL Server</span><span class="sxs-lookup"><span data-stu-id="1e551-257">How to store events to SQL Server</span></span>

<span data-ttu-id="1e551-258">這個方法會使用**aspnetdb.mdf**資料庫，這是由 Aspnet\_regsql 所產生。</span><span class="sxs-lookup"><span data-stu-id="1e551-258">This method uses the **ASPNETDB** database, which is generated by the Aspnet\_regsql.exe tool.</span></span> <span data-ttu-id="1e551-259">預設的提供者會使用 LocalSqlServer 連接字串，其使用應用程式中以檔案為基礎的資料庫\_data 資料夾或 SQL Server 的本機 SQLExpress 實例。</span><span class="sxs-lookup"><span data-stu-id="1e551-259">The default provider uses the LocalSqlServer connection string, which uses either a file-based database in the App\_data folder or the local SQLExpress instance of SQL Server.</span></span> <span data-ttu-id="1e551-260">LocalSqlServer 連接字串和 SqlProvider 都是在全域 web.config 檔案中設定。</span><span class="sxs-lookup"><span data-stu-id="1e551-260">Both the LocalSqlServer connection string and the SqlProvider are configured in the global Web.config file.</span></span>

<span data-ttu-id="1e551-261">全域 Web.config 檔案中的 LocalSqlServer 連接字串看起來像這樣：</span><span class="sxs-lookup"><span data-stu-id="1e551-261">The LocalSqlServer connection string in the global Web.config file looks like this:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample6.xml)]

<span data-ttu-id="1e551-262">如果您想要使用另一個 SQL Server 實例，您必須使用 Aspnet\_regsql，此工具可在%windir%\Microsoft.Net\Framework\v2.0. 中找到。\* 資料夾。</span><span class="sxs-lookup"><span data-stu-id="1e551-262">If you want to use another SQL Server instance, you'll need to use the Aspnet\_regsql.exe tool, which can be found in the %windir%\Microsoft.Net\Framework\v2.0.\* folder.</span></span> <span data-ttu-id="1e551-263">使用 Aspnet\_regsql 工具，在 SQL Server 實例上產生自訂**aspnetdb.mdf**資料庫，然後將連接字串新增至您的應用程式佈建檔，然後使用新的連接字串新增提供者。</span><span class="sxs-lookup"><span data-stu-id="1e551-263">Use the Aspnet\_regsql.exe tool to generate a custom **ASPNETDB** database on the SQL Server instance, then add the connection string to your applications configuration file, and then add a provider by using the new connection string.</span></span> <span data-ttu-id="1e551-264">建立**aspnetdb.mdf**資料庫之後，您必須設定規則，將 eventMapping 連結到 sqlProvider。</span><span class="sxs-lookup"><span data-stu-id="1e551-264">Once you have the **ASPNETDB** database created, you'll need to set a rule to link an eventMapping to the sqlProvider.</span></span>

<span data-ttu-id="1e551-265">無論您是使用預設 SqlProvider 或設定自己的提供者，都必須新增連結提供者與事件對應的規則。</span><span class="sxs-lookup"><span data-stu-id="1e551-265">Whether you use the default SqlProvider or configure your own provider, you'll need to add a rule linking the provider with an event map.</span></span> <span data-ttu-id="1e551-266">下列規則會將您先前建立的新提供者連結至 [**所有事件**] 事件對應。</span><span class="sxs-lookup"><span data-stu-id="1e551-266">The following rule links the new provider that you created above to the **All Events** event map.</span></span> <span data-ttu-id="1e551-267">此規則會記錄以**WebBaseEvent**為基礎的所有事件，並將它們傳送至將使用 MYASPNETDB 連接字串的 MySqlWebEventProvider。</span><span class="sxs-lookup"><span data-stu-id="1e551-267">This rule will log all the events based on **WebBaseEvent** and send them to the MySqlWebEventProvider that will use the MYASPNETDB connection string.</span></span> <span data-ttu-id="1e551-268">下列程式碼會新增規則，以將提供者與事件對應連結：</span><span class="sxs-lookup"><span data-stu-id="1e551-268">The following code adds a rule to link the provider with an event map:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample7.xml)]

<span data-ttu-id="1e551-269">如果您只想要將錯誤傳送至 SQL Server，您可以新增下列規則：</span><span class="sxs-lookup"><span data-stu-id="1e551-269">If you wanted to only send errors to SQL Server, you could add the following rule:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample8.xml)]

## <a name="how-to-forward-events-to-wmi"></a><span data-ttu-id="1e551-270">如何將事件轉送至 WMI</span><span class="sxs-lookup"><span data-stu-id="1e551-270">How to forward events to WMI</span></span>

<span data-ttu-id="1e551-271">您也可以將事件轉送至 WMI。</span><span class="sxs-lookup"><span data-stu-id="1e551-271">You can also forward the events to WMI.</span></span> <span data-ttu-id="1e551-272">預設會在全域 Web.config 檔案中為您設定 WMI 提供者。</span><span class="sxs-lookup"><span data-stu-id="1e551-272">The WMI provider is configured for you in the global Web.config file by default.</span></span>

<span data-ttu-id="1e551-273">下列程式碼範例會新增規則，以將事件轉送至 WMI：</span><span class="sxs-lookup"><span data-stu-id="1e551-273">The following code example adds a rule to forward the events to WMI:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample9.xml)]

<span data-ttu-id="1e551-274">您必須新增規則，以將 eventMapping 與提供者產生關聯，以及使用 WMI 接聽程式應用程式來接聽事件。</span><span class="sxs-lookup"><span data-stu-id="1e551-274">You will need to add a rule to associate an eventMapping to the provider, and also a WMI listener application to listen for the events.</span></span> <span data-ttu-id="1e551-275">下列程式碼範例會新增規則，以將 WMI 提供者連結至 [**所有事件**] 事件對應：</span><span class="sxs-lookup"><span data-stu-id="1e551-275">The following code example adds a rule to link the WMI provider to the **All Events** event map:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample10.xml)]

## <a name="how-to-forward-events-to-email"></a><span data-ttu-id="1e551-276">如何將事件轉寄至電子郵件</span><span class="sxs-lookup"><span data-stu-id="1e551-276">How to forward events to email</span></span>

<span data-ttu-id="1e551-277">您也可以將事件轉寄至電子郵件。</span><span class="sxs-lookup"><span data-stu-id="1e551-277">You can also forward events to email.</span></span> <span data-ttu-id="1e551-278">請留意您對應到電子郵件提供者的事件規則，因為您可能會不小心傳送許多可能較適合 SQL Server 或事件記錄檔的資訊。</span><span class="sxs-lookup"><span data-stu-id="1e551-278">Be careful about which event rules you map to your email provider, as you can unintentionally send yourself a lot of information that may be better suited for SQL Server or the Event Log.</span></span> <span data-ttu-id="1e551-279">有兩個電子郵件提供者;SimpleMailWebEventProvider 和 TemplatedMailWebEventProvider。</span><span class="sxs-lookup"><span data-stu-id="1e551-279">There are two email providers; SimpleMailWebEventProvider and TemplatedMailWebEventProvider.</span></span> <span data-ttu-id="1e551-280">每個都具有相同的設定屬性，但「範本」和「detailedTemplateErrors」屬性除外，這兩者都只能在 TemplatedMailWebEventProvider 上使用。</span><span class="sxs-lookup"><span data-stu-id="1e551-280">Each has the same configuration attributes, with the exception of the "template" and "detailedTemplateErrors" attributes, both of which are only available on the TemplatedMailWebEventProvider.</span></span>

> [!NOTE]
> <span data-ttu-id="1e551-281">這兩個電子郵件提供者都不會為您設定。</span><span class="sxs-lookup"><span data-stu-id="1e551-281">Neither of these email providers is configured for you.</span></span> <span data-ttu-id="1e551-282">您必須將它們新增至您的 web.config 檔案。</span><span class="sxs-lookup"><span data-stu-id="1e551-282">You'll need to add them to your Web.config file.</span></span>

<span data-ttu-id="1e551-283">這兩個電子郵件提供者的主要差異在於，SimpleMailWebEventProvider 會在無法修改的一般範本中傳送電子郵件。</span><span class="sxs-lookup"><span data-stu-id="1e551-283">The main difference between these two email providers is that SimpleMailWebEventProvider sends emails in a generic template that cannot be modified.</span></span> <span data-ttu-id="1e551-284">範例 Web.config 檔案會使用下列規則，將此電子郵件提供者新增至已設定的提供者清單：</span><span class="sxs-lookup"><span data-stu-id="1e551-284">The sample Web.config file adds this email provider to the list of configured providers by using the following rule:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample11.xml)]

<span data-ttu-id="1e551-285">也會新增下列規則，以將電子郵件提供者系結至 [**所有事件**] 事件對應：</span><span class="sxs-lookup"><span data-stu-id="1e551-285">The following rule is also added to tie the email provider to the **All Events** event map:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample12.xml)]

## <a name="aspnet-20-tracing"></a><span data-ttu-id="1e551-286">ASP.NET 2.0 追蹤</span><span class="sxs-lookup"><span data-stu-id="1e551-286">ASP.NET 2.0 Tracing</span></span>

<span data-ttu-id="1e551-287">ASP.NET 2.0 中的追蹤有三個主要增強功能。</span><span class="sxs-lookup"><span data-stu-id="1e551-287">There are three major enhancements to tracing in ASP.NET 2.0.</span></span>

1. <span data-ttu-id="1e551-288">整合式追蹤功能</span><span class="sxs-lookup"><span data-stu-id="1e551-288">Integrated tracing functionality</span></span>
2. <span data-ttu-id="1e551-289">以程式設計方式存取追蹤訊息</span><span class="sxs-lookup"><span data-stu-id="1e551-289">Programmatic access to trace messages</span></span>
3. <span data-ttu-id="1e551-290">改良的應用層級追蹤</span><span class="sxs-lookup"><span data-stu-id="1e551-290">Improved application-level tracing</span></span>

## <a name="integrated-tracing-functionality"></a><span data-ttu-id="1e551-291">整合式追蹤功能</span><span class="sxs-lookup"><span data-stu-id="1e551-291">Integrated Tracing Functionality</span></span>

<span data-ttu-id="1e551-292">您現在可以將由 ASP.NET 追蹤發出的訊息路由傳送至 ASP.NET 追蹤輸出，並將這些訊息路由傳送至診斷。</span><span class="sxs-lookup"><span data-stu-id="1e551-292">You can now route messages emitted by the System.Diagnostics.Trace class to ASP.NET tracing output, and route messages emitted by ASP.NET tracing to System.Diagnostics.Trace.</span></span> <span data-ttu-id="1e551-293">您也可以將 ASP.NET 檢測事件轉送到 System.webserver。</span><span class="sxs-lookup"><span data-stu-id="1e551-293">You can also forward ASP.NET instrumentation events to System.Diagnostics.Trace.</span></span> <span data-ttu-id="1e551-294">這項功能是由 &lt;trace&gt; 元素的新**writetodiagnosticstrace 還**屬性所提供。</span><span class="sxs-lookup"><span data-stu-id="1e551-294">This functionality is provided by the new **writeToDiagnosticsTrace** attribute of the &lt;trace&gt; element.</span></span> <span data-ttu-id="1e551-295">當此布林值為 true 時，ASP.NET 追蹤訊息會轉送到系統診斷追蹤基礎結構，供任何已註冊顯示追蹤訊息的接聽程式使用。</span><span class="sxs-lookup"><span data-stu-id="1e551-295">When this Boolean value is true, ASP.NET Trace messages are forwarded to the System.Diagnostics tracing infrastructure for use by any listeners that are registered to display Trace messages.</span></span>

## <a name="programmatic-access-to-trace-messages"></a><span data-ttu-id="1e551-296">以程式設計方式存取追蹤訊息</span><span class="sxs-lookup"><span data-stu-id="1e551-296">Programmatic Access to Trace Messages</span></span>

<span data-ttu-id="1e551-297">ASP.NET 2.0 允許透過**TraceCoNtextRecord**類別和**TraceRecords**集合以程式設計方式存取所有追蹤訊息。</span><span class="sxs-lookup"><span data-stu-id="1e551-297">ASP.NET 2.0 allows for programmatic access to all trace messages via the **TraceContextRecord** class and the **TraceRecords** collection.</span></span> <span data-ttu-id="1e551-298">存取追蹤訊息最有效率的方式是註冊**TraceCoNtextEventHandler**委派（也是 ASP.NET 2.0 中的新功能），以處理新的**tracecoNtext.tracefinished**事件。</span><span class="sxs-lookup"><span data-stu-id="1e551-298">The most efficient way of accessing trace messages is to register a **TraceContextEventHandler** delegate (also new in ASP.NET 2.0) to handle the new **TraceFinished** event.</span></span> <span data-ttu-id="1e551-299">然後您可以視需要對追蹤訊息進行迴圈。</span><span class="sxs-lookup"><span data-stu-id="1e551-299">You can then loop through the trace messages as you wish.</span></span>

<span data-ttu-id="1e551-300">下列程式碼範例將說明這種情況：</span><span class="sxs-lookup"><span data-stu-id="1e551-300">The following code sample illustrates this:</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample13.cs)]

<span data-ttu-id="1e551-301">在上述範例中，我會在 TraceRecords 集合中執行迴圈，然後將每個訊息寫入回應資料流程。</span><span class="sxs-lookup"><span data-stu-id="1e551-301">In the above example, I loop through the TraceRecords collection and then write each message to the Response stream.</span></span>

## <a name="improved-application-level-tracing"></a><span data-ttu-id="1e551-302">改良的應用層級追蹤</span><span class="sxs-lookup"><span data-stu-id="1e551-302">Improved Application-Level Tracing</span></span>

<span data-ttu-id="1e551-303">透過引進 &lt;trace&gt; 元素的新**mostRecent**屬性，即可改善應用層級的追蹤。</span><span class="sxs-lookup"><span data-stu-id="1e551-303">Application-level tracing is improved via the introduction of the new **mostRecent** attribute of the &lt;trace&gt; element.</span></span> <span data-ttu-id="1e551-304">這個屬性會指定是否要顯示最新的應用層級追蹤輸出，以及是否捨棄 requestLimit 所指示之限制以外的較舊追蹤資料。</span><span class="sxs-lookup"><span data-stu-id="1e551-304">This attribute specifies whether the most recent application-level tracing output is displayed and older trace data beyond the limits that are indicated by the requestLimit are discarded.</span></span> <span data-ttu-id="1e551-305">若為 false，則會顯示要求的追蹤資料，直到達到 requestLimit 屬性為止。</span><span class="sxs-lookup"><span data-stu-id="1e551-305">If false, trace data are displayed for requests until the requestLimit attribute is reached.</span></span>

## <a name="aspnet-command-line-tools"></a><span data-ttu-id="1e551-306">ASP.NET 命令列工具</span><span class="sxs-lookup"><span data-stu-id="1e551-306">ASP.NET Command Line Tools</span></span>

<span data-ttu-id="1e551-307">有數個命令列工具可協助設定 ASP.NET。</span><span class="sxs-lookup"><span data-stu-id="1e551-307">There are several command-line tools to aid in configuration of ASP.NET.</span></span> <span data-ttu-id="1e551-308">ASP.NET 開發人員應該熟悉 aspnet\_的 regiis 工具。</span><span class="sxs-lookup"><span data-stu-id="1e551-308">ASP.NET developers should be familiar with the aspnet\_regiis.exe tool.</span></span> <span data-ttu-id="1e551-309">ASP.NET 2.0 提供其他三個命令列工具來協助設定。</span><span class="sxs-lookup"><span data-stu-id="1e551-309">ASP.NET 2.0 provides three other command-line tools to aid in configuration.</span></span>

<span data-ttu-id="1e551-310">下列是可用的命令列工具：</span><span class="sxs-lookup"><span data-stu-id="1e551-310">The following command-line tools are available:</span></span>

| <span data-ttu-id="1e551-311">**工具**</span><span class="sxs-lookup"><span data-stu-id="1e551-311">**Tool**</span></span> | <span data-ttu-id="1e551-312">**使用**</span><span class="sxs-lookup"><span data-stu-id="1e551-312">**Use**</span></span> |
| --- | --- |
| <span data-ttu-id="1e551-313">**aspnet\_regiis .exe**</span><span class="sxs-lookup"><span data-stu-id="1e551-313">**aspnet\_regiis.exe**</span></span> | <span data-ttu-id="1e551-314">允許以 IIS 註冊 ASP.NET。</span><span class="sxs-lookup"><span data-stu-id="1e551-314">Allows for registration of ASP.NET with IIS.</span></span> <span data-ttu-id="1e551-315">此工具有兩個版本，隨附于 ASP.NET 2.0，一個用於32位系統（在架構資料夾中），另一個用於64位系統（在 Framework64 資料夾中）。64位版本將不會安裝在32位作業系統上。</span><span class="sxs-lookup"><span data-stu-id="1e551-315">There are two versions of this tools that ship with ASP.NET 2.0, one for 32-bit systems (in the Framework folder) and one for 64-bit systems (in the Framework64 folder.) The 64-bit version will not be installed on a 32-bit OS.</span></span> |
| <span data-ttu-id="1e551-316">**aspnet\_regsql .exe**</span><span class="sxs-lookup"><span data-stu-id="1e551-316">**aspnet\_regsql.exe**</span></span> | <span data-ttu-id="1e551-317">ASP.NET SQL Server 註冊工具是用來建立 Microsoft SQL Server 資料庫，供 ASP.NET 中的 SQL Server 提供者使用，或是從現有的資料庫新增或移除選項。</span><span class="sxs-lookup"><span data-stu-id="1e551-317">The ASP.NET SQL Server Registration tool is used to create a Microsoft SQL Server database for use by the SQL Server providers in ASP.NET, or to add or remove options from an existing database.</span></span> <span data-ttu-id="1e551-318">Aspnet\_regsql 檔案位於 Web 服務器的 [drive：] \WINDOWS\Microsoft.NET\Framework\versionNumber 資料夾中。</span><span class="sxs-lookup"><span data-stu-id="1e551-318">The Aspnet\_regsql.exe file is located in the [drive:]\WINDOWS\Microsoft.NET\Framework\versionNumber folder on your Web server.</span></span> |
| <span data-ttu-id="1e551-319">**aspnet\_regbrowsers .exe**</span><span class="sxs-lookup"><span data-stu-id="1e551-319">**aspnet\_regbrowsers.exe**</span></span> | <span data-ttu-id="1e551-320">ASP.NET 瀏覽器註冊工具會剖析所有全系統瀏覽器定義，並將其編譯成元件，並將元件安裝到全域組件快取中。</span><span class="sxs-lookup"><span data-stu-id="1e551-320">The ASP.NET Browser Registration tool parses and compiles all system-wide browser definitions into an assembly and installs the assembly into the global assembly cache.</span></span> <span data-ttu-id="1e551-321">此工具會使用瀏覽器定義檔案（。瀏覽器檔案 .NET Framework）。</span><span class="sxs-lookup"><span data-stu-id="1e551-321">The tool uses the browser definition files (.BROWSER files) from the .NET Framework Browsers subdirectory.</span></span> <span data-ttu-id="1e551-322">此工具可在%SystemRoot%\Microsoft.NET\Framework\version\ 目錄中找到。</span><span class="sxs-lookup"><span data-stu-id="1e551-322">The tool can be found in the %SystemRoot%\Microsoft.NET\Framework\version\ directory.</span></span> |
| <span data-ttu-id="1e551-323">**aspnet\_編譯器 .exe**</span><span class="sxs-lookup"><span data-stu-id="1e551-323">**aspnet\_compiler.exe**</span></span> | <span data-ttu-id="1e551-324">ASP.NET 編譯工具可讓您就地編譯 ASP.NET Web 應用程式，或將其部署至目標位置（例如實際伺服器）。</span><span class="sxs-lookup"><span data-stu-id="1e551-324">The ASP.NET Compilation tool enables you to compile an ASP.NET Web application, either in place or for deployment to a target location such as a production server.</span></span> <span data-ttu-id="1e551-325">就地編譯有助於應用程式效能，因為終端使用者在編譯應用程式時，對應用程式的第一個要求不會有延遲。</span><span class="sxs-lookup"><span data-stu-id="1e551-325">In-place compilation helps application performance because end users do not encounter a delay on the first request to the application while the application is compiled.</span></span> |

<span data-ttu-id="1e551-326">因為 aspnet\_regiis 工具不是 ASP.NET 2.0 的新手，所以我們不會在這裡討論。</span><span class="sxs-lookup"><span data-stu-id="1e551-326">Because the aspnet\_regiis.exe tool is not new to ASP.NET 2.0, we will not discuss it here.</span></span>

## <a name="aspnet-sql-server-registration-tool---aspnet_regsqlexe"></a><span data-ttu-id="1e551-327">ASP.NET SQL Server 註冊工具-aspnet\_regsql .exe</span><span class="sxs-lookup"><span data-stu-id="1e551-327">ASP.NET SQL Server Registration Tool - aspnet\_regsql.exe</span></span>

<span data-ttu-id="1e551-328">您可以使用 ASP.NET SQL Server 註冊工具來設定數種類型的選項。</span><span class="sxs-lookup"><span data-stu-id="1e551-328">You can set several types of options using the ASP.NET SQL Server Registration tool.</span></span> <span data-ttu-id="1e551-329">您可以指定 SQL 連接，指定哪些 ASP.NET 應用程式服務會使用 SQL Server 來管理資訊、指出用於 SQL 快取相依性的資料庫或資料表，以及新增或移除使用 SQL Server 來儲存程式和會話狀態的支援。</span><span class="sxs-lookup"><span data-stu-id="1e551-329">You can specify a SQL connection, specify which ASP.NET application services use SQL Server to manage information, indicate which database or table is used for SQL cache dependency, and add or remove support for using SQL Server to store procedures and session state.</span></span>

<span data-ttu-id="1e551-330">有數個 ASP.NET 應用程式服務依賴提供者來管理從資料來源儲存和抓取資料。</span><span class="sxs-lookup"><span data-stu-id="1e551-330">Several ASP.NET application services rely on a provider to manage storing and retrieving data from a data source.</span></span> <span data-ttu-id="1e551-331">每個提供者都是資料來源特有的。</span><span class="sxs-lookup"><span data-stu-id="1e551-331">Each provider is specific to the data source.</span></span> <span data-ttu-id="1e551-332">ASP.NET 包含下列 ASP.NET 功能的 SQL Server 提供者：</span><span class="sxs-lookup"><span data-stu-id="1e551-332">ASP.NET includes a SQL Server provider for the following ASP.NET features:</span></span>

- <span data-ttu-id="1e551-333">成員資格（ [SqlMembershipProvider](https://msdn.microsoft.com/library/system.web.security.sqlmembershipprovider.aspx)類別）。</span><span class="sxs-lookup"><span data-stu-id="1e551-333">Membership (the [SqlMembershipProvider](https://msdn.microsoft.com/library/system.web.security.sqlmembershipprovider.aspx) class).</span></span>
- <span data-ttu-id="1e551-334">角色管理（ [SqlRoleProvider](https://msdn.microsoft.com/library/system.web.security.sqlroleprovider.aspx)類別）。</span><span class="sxs-lookup"><span data-stu-id="1e551-334">Role Management (the [SqlRoleProvider](https://msdn.microsoft.com/library/system.web.security.sqlroleprovider.aspx) class).</span></span>
- <span data-ttu-id="1e551-335">Profile （ [SqlProfileProvider](https://msdn.microsoft.com/library/system.web.profile.sqlprofileprovider.aspx)類別）。</span><span class="sxs-lookup"><span data-stu-id="1e551-335">Profile (the [SqlProfileProvider](https://msdn.microsoft.com/library/system.web.profile.sqlprofileprovider.aspx) class).</span></span>
- <span data-ttu-id="1e551-336">Web 組件個人化（ [SqlPersonalizationProvider](https://msdn.microsoft.com/library/system.web.ui.webcontrols.webparts.sqlpersonalizationprovider.aspx)類別）。</span><span class="sxs-lookup"><span data-stu-id="1e551-336">Web Parts Personalization (the [SqlPersonalizationProvider](https://msdn.microsoft.com/library/system.web.ui.webcontrols.webparts.sqlpersonalizationprovider.aspx) class).</span></span>
- <span data-ttu-id="1e551-337">Web 事件（ [SqlWebEventProvider](https://msdn.microsoft.com/library/system.web.management.sqlwebeventprovider.aspx)類別）。</span><span class="sxs-lookup"><span data-stu-id="1e551-337">Web Events (the [SqlWebEventProvider](https://msdn.microsoft.com/library/system.web.management.sqlwebeventprovider.aspx) class).</span></span>

<span data-ttu-id="1e551-338">當您安裝 ASP.NET 時，伺服器的 machine.config 檔案會包含設定元素，這些專案會針對依賴提供者的每個 ASP.NET 功能指定 SQL Server 提供者。</span><span class="sxs-lookup"><span data-stu-id="1e551-338">When you install ASP.NET, the Machine.config file for your server includes configuration elements that specify SQL Server providers for each of the ASP.NET features that rely on a provider.</span></span> <span data-ttu-id="1e551-339">根據預設，這些提供者會設定為連接到 SQL Server Express 2005 的本機使用者實例。</span><span class="sxs-lookup"><span data-stu-id="1e551-339">These providers are configured, by default, to connect to a local user instance of SQL Server Express 2005.</span></span> <span data-ttu-id="1e551-340">如果您變更了提供者所使用的預設連接字串，則在您可以使用電腦設定中設定的任何 ASP.NET 功能之前，您必須使用 Aspnet\_regsql，為您選擇的功能安裝 SQL Server 資料庫和資料庫元素。</span><span class="sxs-lookup"><span data-stu-id="1e551-340">If you change the default connection string used by the providers, then before you can use any of the ASP.NET features configured in the machine configuration, you must install the SQL Server database and the database elements for your chosen feature using Aspnet\_regsql.exe.</span></span> <span data-ttu-id="1e551-341">如果您使用 SQL 註冊工具指定的資料庫不存在（如果命令列上未指定，則 aspnetdb.mdf 會是預設的資料庫），則目前的使用者必須擁有在 SQL Server 中建立資料庫的許可權，以及建立架構 e資料庫內的 lements。</span><span class="sxs-lookup"><span data-stu-id="1e551-341">If the database that you specify with the SQL registration tool does not already exist (aspnetdb will be the default database if one is not specified on the command line), then the current user must have rights to create databases in SQL Server as well as to create schema elements within a database.</span></span>

### <a name="sql-cache-dependency"></a><span data-ttu-id="1e551-342">SQL 快取相依性</span><span class="sxs-lookup"><span data-stu-id="1e551-342">SQL Cache Dependency</span></span>

<span data-ttu-id="1e551-343">ASP.NET 輸出快取的一項先進功能是 SQL 快取相依性。</span><span class="sxs-lookup"><span data-stu-id="1e551-343">An advanced feature of ASP.NET output caching is SQL cache dependency.</span></span> <span data-ttu-id="1e551-344">SQL 快取相依性支援兩種不同的作業模式：一個使用資料表輪詢的 ASP.NET 執行，另一個使用 SQL Server 2005 的查詢通知功能的第二種模式。</span><span class="sxs-lookup"><span data-stu-id="1e551-344">SQL cache dependency supports two different modes of operation: one that uses an ASP.NET implementation of table polling and a second mode that uses the query notification features of SQL Server 2005.</span></span> <span data-ttu-id="1e551-345">SQL 註冊工具可以用來設定作業的資料表輪詢模式。</span><span class="sxs-lookup"><span data-stu-id="1e551-345">The SQL registration tool can be used to configure the table-polling mode of operation.</span></span>

### <a name="session-state"></a><span data-ttu-id="1e551-346">工作階段狀態</span><span class="sxs-lookup"><span data-stu-id="1e551-346">Session State</span></span>

<span data-ttu-id="1e551-347">根據預設，會話狀態值和資訊會儲存在 ASP.NET 程式的記憶體中。</span><span class="sxs-lookup"><span data-stu-id="1e551-347">By default, session state values and information are stored in memory within the ASP.NET process.</span></span> <span data-ttu-id="1e551-348">或者，您也可以將會話資料儲存在 SQL Server 資料庫中，以供多部 Web 服務器共用。</span><span class="sxs-lookup"><span data-stu-id="1e551-348">Alternatively, you can store session data in a SQL Server database, where it can be shared by multiple Web servers.</span></span> <span data-ttu-id="1e551-349">如果您針對具有 SQL 註冊工具的會話狀態所指定的資料庫不存在，則目前的使用者必須擁有在 SQL Server 中建立資料庫的許可權，以及在資料庫內建立架構元素的許可權。</span><span class="sxs-lookup"><span data-stu-id="1e551-349">If the database that you specify for session state with the SQL registration tool does not already exist, then the current user must have rights to create databases in SQL Server as well as to create schema elements within a database.</span></span> <span data-ttu-id="1e551-350">如果資料庫存在，則目前的使用者必須擁有在現有資料庫中建立架構元素的許可權。</span><span class="sxs-lookup"><span data-stu-id="1e551-350">If the database does exist, then the current user must have rights to create schema elements in the existing database.</span></span>

<span data-ttu-id="1e551-351">若要在 SQL Server 上安裝會話狀態資料庫，請執行 Aspnet\_regsql 工具，並使用命令提供下列資訊：</span><span class="sxs-lookup"><span data-stu-id="1e551-351">To install the session state database on SQL Server, run the Aspnet\_regsql.exe tool and supply the following information with the command:</span></span>

- <span data-ttu-id="1e551-352">使用 **-S**選項的 SQL Server 實例的名稱。</span><span class="sxs-lookup"><span data-stu-id="1e551-352">The name of the SQL Server instance, using the **-S** option.</span></span>
- <span data-ttu-id="1e551-353">具有在執行 SQL Server 的電腦上建立資料庫之許可權的帳戶登入認證。</span><span class="sxs-lookup"><span data-stu-id="1e551-353">The logon credentials for an account that has permission to create a database on a computer running SQL Server.</span></span> <span data-ttu-id="1e551-354">使用 **-E**選項來使用目前登入的使用者，或使用 **-U**選項來指定使用者識別碼以及 **-P**選項來指定密碼。</span><span class="sxs-lookup"><span data-stu-id="1e551-354">Use the **-E** option to use the currently logged-on user, or use the **-U** option to specify a user ID along with the **-P** option to specify a password.</span></span>
- <span data-ttu-id="1e551-355">**-Ssadd**命令列選項，用以新增會話狀態資料庫。</span><span class="sxs-lookup"><span data-stu-id="1e551-355">The **-ssadd** command-line option to add the session state database.</span></span>

<span data-ttu-id="1e551-356">根據預設，您無法使用 Aspnet\_regsql，在執行 SQL Server 2005 Express Edition 的電腦上安裝會話狀態資料庫。</span><span class="sxs-lookup"><span data-stu-id="1e551-356">By default, you cannot use the Aspnet\_regsql.exe tool to install the session state database on a computer running SQL Server 2005 Express Edition.</span></span>

### <a name="the-aspnet-browser-registration-tool---aspnet_regbrowsersexe"></a><span data-ttu-id="1e551-357">ASP.NET 瀏覽器註冊工具-aspnet\_regbrowsers</span><span class="sxs-lookup"><span data-stu-id="1e551-357">The ASP.NET Browser Registration Tool - aspnet\_regbrowsers.exe</span></span>

<span data-ttu-id="1e551-358">在 ASP.NET 版本1.1 中，Machine.config 檔案包含一個稱為 &lt;browserCaps&gt;的區段。</span><span class="sxs-lookup"><span data-stu-id="1e551-358">In ASP.NET version 1.1, the Machine.config file contained a section called &lt;browserCaps&gt;.</span></span> <span data-ttu-id="1e551-359">本章節包含一系列的 XML 專案，這些專案會根據正則運算式定義各種瀏覽器的設定。</span><span class="sxs-lookup"><span data-stu-id="1e551-359">This section contained a series of XML entries that defined the configurations for various browsers based on a regular expression.</span></span> <span data-ttu-id="1e551-360">針對 ASP.NET 版本2.0，這是新的。瀏覽器檔案使用 XML 專案定義特定瀏覽器的參數。</span><span class="sxs-lookup"><span data-stu-id="1e551-360">For ASP.NET version 2.0, a new .BROWSER file defines the parameters of a particular browser using XML entries.</span></span> <span data-ttu-id="1e551-361">您可以藉由加入新的，在新的瀏覽器上加入資訊。瀏覽器檔案至位於系統上%SystemRoot%\Microsoft.NET\Framework\version\CONFIG\Browsers 的資料夾。</span><span class="sxs-lookup"><span data-stu-id="1e551-361">You add information on a new browser by adding a new .BROWSER file to the folder located at %SystemRoot%\Microsoft.NET\Framework\version\CONFIG\Browsers on your system.</span></span>

<span data-ttu-id="1e551-362">因為應用程式在每次需要瀏覽器資訊時都不會讀取 .config 檔案，所以您可以建立新的。瀏覽器檔案並執行 Aspnet\_regbrowsers，將必要的變更新增至元件。</span><span class="sxs-lookup"><span data-stu-id="1e551-362">Because an application is not reading a .config file every time it requires browser information, you can create a new .BROWSER file and run Aspnet\_regbrowsers.exe to add the required changes to the assembly.</span></span> <span data-ttu-id="1e551-363">如此一來，伺服器就可以立即存取新的瀏覽器資訊，因此您不需要關閉任何應用程式來收取資訊。</span><span class="sxs-lookup"><span data-stu-id="1e551-363">This allows the server to access the new browser information immediately so you do not have to shut down any of your applications to pick up the information.</span></span> <span data-ttu-id="1e551-364">應用程式可以透過目前 HttpRequest 的 Browser 屬性來存取瀏覽器功能。</span><span class="sxs-lookup"><span data-stu-id="1e551-364">An application can access browser capabilities through the Browser property of the current HttpRequest.</span></span>

<span data-ttu-id="1e551-365">執行 aspnet\_regbrowser 時，可以使用下列選項：</span><span class="sxs-lookup"><span data-stu-id="1e551-365">The following options are available when running aspnet\_regbrowser.exe:</span></span>

| <span data-ttu-id="1e551-366">**選項**</span><span class="sxs-lookup"><span data-stu-id="1e551-366">**Option**</span></span> | <span data-ttu-id="1e551-367">**說明**</span><span class="sxs-lookup"><span data-stu-id="1e551-367">**Description**</span></span> |
| --- | --- |
| <span data-ttu-id="1e551-368">**-?**</span><span class="sxs-lookup"><span data-stu-id="1e551-368">**-?**</span></span> | <span data-ttu-id="1e551-369">在命令視窗中顯示 Aspnet\_regbbrowsers 的解說文字。</span><span class="sxs-lookup"><span data-stu-id="1e551-369">Displays the Aspnet\_regbbrowsers.exe Help text in the command window.</span></span> |
| <span data-ttu-id="1e551-370">**-i**</span><span class="sxs-lookup"><span data-stu-id="1e551-370">**-i**</span></span> | <span data-ttu-id="1e551-371">建立執行時間瀏覽器功能元件，並將它安裝在全域組件快取中。</span><span class="sxs-lookup"><span data-stu-id="1e551-371">Creates the runtime browser capabilities assembly and installs it in the global assembly cache.</span></span> |
| <span data-ttu-id="1e551-372">**-u**</span><span class="sxs-lookup"><span data-stu-id="1e551-372">**-u**</span></span> | <span data-ttu-id="1e551-373">從全域組件快取卸載執行時間瀏覽器功能元件。</span><span class="sxs-lookup"><span data-stu-id="1e551-373">Uninstalls the runtime browser capabilities assembly from the global assembly cache.</span></span> |

## <a name="the-aspnet-compilation-tool---aspnet_compilerexe"></a><span data-ttu-id="1e551-374">ASP.NET 編譯工具-aspnet\_編譯器 .exe</span><span class="sxs-lookup"><span data-stu-id="1e551-374">The ASP.NET Compilation Tool - aspnet\_compiler.exe</span></span>

<span data-ttu-id="1e551-375">ASP.NET 編譯工具可以用兩種一般方式來使用：適用于部署的就地編譯和編譯，其中指定了目標輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="1e551-375">The ASP.NET Compilation tool can be used in two general ways: for in-place compilation and compilation for deployment, where a target output directory is specified.</span></span>

### <a name="compiling-an-application-in-place"></a>[<span data-ttu-id="1e551-376">就地編譯應用程式</span><span class="sxs-lookup"><span data-stu-id="1e551-376">Compiling an Application in Place</span></span>](https://msdn.microsoft.com/library/ms229863.aspx)

<span data-ttu-id="1e551-377">ASP.NET 編譯工具可以就地編譯應用程式，也就是說，它會模擬對應用程式提出多個要求的行為，因而導致一般編譯。</span><span class="sxs-lookup"><span data-stu-id="1e551-377">The ASP.NET Compilation tool can compile an application in place, that is, it mimics the behavior of making multiple requests to the application, thus causing regular compilation.</span></span> <span data-ttu-id="1e551-378">預先編譯網站的使用者不會因為第一次要求而編譯頁面而遇到延遲。</span><span class="sxs-lookup"><span data-stu-id="1e551-378">Users of a pre-compiled site will not experience a delay caused by compiling the page on first request.</span></span>

<span data-ttu-id="1e551-379">當您就地預先編譯網站時，適用下列專案：</span><span class="sxs-lookup"><span data-stu-id="1e551-379">When you precompile a site in place, the following items apply:</span></span>

- <span data-ttu-id="1e551-380">網站會保留其檔案和目錄結構。</span><span class="sxs-lookup"><span data-stu-id="1e551-380">The site retains its files and directory structure.</span></span>
- <span data-ttu-id="1e551-381">您必須擁有伺服器上網站所使用之所有程式設計語言的編譯器。</span><span class="sxs-lookup"><span data-stu-id="1e551-381">You must have compilers for all programming languages used by the site on the server.</span></span>
- <span data-ttu-id="1e551-382">如果任何檔案編譯失敗，整個網站就無法編譯。</span><span class="sxs-lookup"><span data-stu-id="1e551-382">If any file fails compilation, the entire site fails compilation.</span></span>

<span data-ttu-id="1e551-383">您也可以在將應用程式新增至新的來源檔案後，就地重新編譯。</span><span class="sxs-lookup"><span data-stu-id="1e551-383">You can also recompile an application in place after adding new source files to it.</span></span> <span data-ttu-id="1e551-384">此工具只會編譯新的或已變更的檔案，除非您包含 **-c**選項。</span><span class="sxs-lookup"><span data-stu-id="1e551-384">The tool compiles only the new or changed files unless you include the **-c** option.</span></span>

> [!NOTE]
> <span data-ttu-id="1e551-385">編譯包含嵌套應用程式的應用程式時，不會編譯該嵌套應用程式。</span><span class="sxs-lookup"><span data-stu-id="1e551-385">Compilation of an application that contains a nested application does not compile the nested application.</span></span> <span data-ttu-id="1e551-386">必須個別編譯此嵌套應用程式。</span><span class="sxs-lookup"><span data-stu-id="1e551-386">The nested application must be compiled separately.</span></span>

### <a name="compiling-an-application-for-deployment"></a>[<span data-ttu-id="1e551-387">編譯應用程式以進行部署</span><span class="sxs-lookup"><span data-stu-id="1e551-387">Compiling an Application for Deployment</span></span>](https://msdn.microsoft.com/library/ms229863.aspx)

<span data-ttu-id="1e551-388">您可以藉由指定 targetDir 參數，編譯用於部署的應用程式（編譯至目標位置）。</span><span class="sxs-lookup"><span data-stu-id="1e551-388">You compile an application for deployment (compilation to a target location) by specifying the targetDir parameter.</span></span> <span data-ttu-id="1e551-389">TargetDir 可以是 Web 應用程式的最終位置，也可以進一步部署已編譯的應用程式。</span><span class="sxs-lookup"><span data-stu-id="1e551-389">The targetDir can be the final location for the Web application, or the compiled application can be further deployed.</span></span> <span data-ttu-id="1e551-390">使用 **-u**選項會編譯應用程式，讓您可以對編譯過的應用程式中的某些檔案進行變更，而不需要重新編譯。</span><span class="sxs-lookup"><span data-stu-id="1e551-390">Using the **-u** option compiles the application in such a way that you can make changes to certain files in the compiled application without recompiling it.</span></span> <span data-ttu-id="1e551-391">Aspnet\_cmd.exe 會區分靜態和動態檔案類型，而且在建立產生的應用程式時，會以不同的方式處理它們。</span><span class="sxs-lookup"><span data-stu-id="1e551-391">Aspnet\_compiler.exe makes a distinction between static and dynamic file types, and handles them differently when creating the resulting application.</span></span>

- <span data-ttu-id="1e551-392">靜態檔案類型是沒有相關聯編譯器或組建提供者的檔案，例如名為的檔案具有副檔名，例如 .css、.gif、.htm、.html、.jpg、.js 等等。</span><span class="sxs-lookup"><span data-stu-id="1e551-392">Static file types are those that do not have an associated compiler or build provider, such as files whose named have extensions such as .css, .gif, .htm, .html, .jpg, .js and so on.</span></span> <span data-ttu-id="1e551-393">這些檔案只會複製到目標位置，並保留它們在目錄結構中的相對位置。</span><span class="sxs-lookup"><span data-stu-id="1e551-393">These files are simply copied to the target location, with their relative places in the directory structure preserved.</span></span>
- <span data-ttu-id="1e551-394">動態檔案類型是具有相關聯編譯器或組建提供者的檔案，包括具有 ASP.NET 特定副檔名的檔案，例如 global.asax、.ascx、ashx、.aspx、browser、.master 等等。</span><span class="sxs-lookup"><span data-stu-id="1e551-394">Dynamic file types are those that have an associated compiler or build provider, including files with ASP.NET-specific file name extensions such as .asax, .ascx, .ashx, .aspx, .browser, .master, and so on.</span></span> <span data-ttu-id="1e551-395">ASP.NET 編譯工具會從這些檔案產生元件。</span><span class="sxs-lookup"><span data-stu-id="1e551-395">The ASP.NET Compilation tool generates assemblies from these files.</span></span> <span data-ttu-id="1e551-396">如果省略 **-u**選項，此工具也會建立副檔名為的檔案。已進行編譯，將原始來源檔案對應至其元件。</span><span class="sxs-lookup"><span data-stu-id="1e551-396">If the **-u** option is omitted, the tool also creates files with the file name extension .COMPILED that map the original source files to their assembly.</span></span> <span data-ttu-id="1e551-397">為了確保保留應用程式來源的目錄結構，此工具會在目標應用程式的對應位置中產生預留位置檔案。</span><span class="sxs-lookup"><span data-stu-id="1e551-397">To ensure that the directory structure of the application source is preserved, the tool generates placeholder files in the corresponding locations in the target application.</span></span>

<span data-ttu-id="1e551-398">您必須使用 **-u**選項來表示已編譯之應用程式的內容可以修改。</span><span class="sxs-lookup"><span data-stu-id="1e551-398">You must use the **-u** option to indicate that the content of the compiled application can be modified.</span></span> <span data-ttu-id="1e551-399">否則，會忽略後續的修改或造成執行階段錯誤。</span><span class="sxs-lookup"><span data-stu-id="1e551-399">Otherwise, subsequent modifications are ignored or cause run-time errors.</span></span>

<span data-ttu-id="1e551-400">下表描述當包含 **-u**選項時，ASP.NET 編譯工具如何處理不同的檔案類型。</span><span class="sxs-lookup"><span data-stu-id="1e551-400">The following table describes how the ASP.NET Compilation tool handles different file types when the **-u** option is included.</span></span>

| <span data-ttu-id="1e551-401">**檔案類型**</span><span class="sxs-lookup"><span data-stu-id="1e551-401">**File type**</span></span> | <span data-ttu-id="1e551-402">**編譯器動作**</span><span class="sxs-lookup"><span data-stu-id="1e551-402">**Compiler action**</span></span> |
| --- | --- |
| <span data-ttu-id="1e551-403">.ascx、.aspx、.master</span><span class="sxs-lookup"><span data-stu-id="1e551-403">.ascx, .aspx, .master</span></span> | <span data-ttu-id="1e551-404">這些檔案會分割成標記和原始程式碼，其中包含程式碼後置檔案，以及 &lt;script runat = "server"&gt; 元素中的任何程式碼。</span><span class="sxs-lookup"><span data-stu-id="1e551-404">These files are split into markup and source code, which includes both code-behind files and any code that is enclosed in &lt;script runat="server"&gt; elements.</span></span> <span data-ttu-id="1e551-405">原始程式碼會編譯成元件，其名稱是衍生自雜湊演算法，而元件則放在 Bin 目錄中。</span><span class="sxs-lookup"><span data-stu-id="1e551-405">Source code is compiled into assemblies, with names that are derived from a hashing algorithm, and the assemblies are placed in the Bin directory.</span></span> <span data-ttu-id="1e551-406">任何內嵌程式碼（也就是包含在 **&lt;%** 和 **%&gt;** 方括弧之間的程式碼）都會包含在標記中，而且不會進行編譯。</span><span class="sxs-lookup"><span data-stu-id="1e551-406">Any inline code, that is, code enclosed between the **&lt;%** and **%&gt;** brackets, is included with markup and not compiled.</span></span> <span data-ttu-id="1e551-407">系統會建立與來源檔案相同名稱的新檔案，以包含標記並放在對應的輸出目錄中。</span><span class="sxs-lookup"><span data-stu-id="1e551-407">New files with the same name as the source files are created to contain the markup and placed in the corresponding output directories.</span></span> |
| <span data-ttu-id="1e551-408">. ashx，.asmx</span><span class="sxs-lookup"><span data-stu-id="1e551-408">.ashx, .asmx</span></span> | <span data-ttu-id="1e551-409">這些檔案不會進行編譯，而且會依其方式移至輸出目錄，而不會進行編譯。</span><span class="sxs-lookup"><span data-stu-id="1e551-409">These files are not compiled and are moved to the output directories as is and not compiled.</span></span> <span data-ttu-id="1e551-410">如果您想要編譯器代碼，請將程式碼放入原始程式碼檔案的應用程式\_Code 目錄中。</span><span class="sxs-lookup"><span data-stu-id="1e551-410">If you wish to have the handler code compiled, place the code into source code files in the App\_Code directory.</span></span> |
| <span data-ttu-id="1e551-411">.cs、.vb、. form1.jsl、.cpp （不包含先前所列檔案類型的程式碼後置檔案）</span><span class="sxs-lookup"><span data-stu-id="1e551-411">.cs, .vb, .jsl, .cpp (not including code-behind files for the file types listed earlier)</span></span> | <span data-ttu-id="1e551-412">這些檔案會進行編譯，並以資源的形式包含在參考它們的元件中。</span><span class="sxs-lookup"><span data-stu-id="1e551-412">These files are compiled and included as a resource in assemblies that reference them.</span></span> <span data-ttu-id="1e551-413">來源檔案不會複製到輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="1e551-413">Source files are not copied to the output directory.</span></span> <span data-ttu-id="1e551-414">如果未參考程式碼檔案，則不會進行編譯。</span><span class="sxs-lookup"><span data-stu-id="1e551-414">If a code file is not referenced, it is not compiled.</span></span> |
| <span data-ttu-id="1e551-415">自訂檔案類型</span><span class="sxs-lookup"><span data-stu-id="1e551-415">Custom file types</span></span> | <span data-ttu-id="1e551-416">這些檔案不會經過編譯。</span><span class="sxs-lookup"><span data-stu-id="1e551-416">These files are not compiled.</span></span> <span data-ttu-id="1e551-417">這些檔案會複製到對應的輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="1e551-417">These files are copied to the corresponding output directories.</span></span> |
| <span data-ttu-id="1e551-418">應用程式\_代碼子目錄中的原始程式碼檔</span><span class="sxs-lookup"><span data-stu-id="1e551-418">Source code files in the App\_Code subdirectory</span></span> | <span data-ttu-id="1e551-419">這些檔案會編譯成元件並放在 Bin 目錄中。</span><span class="sxs-lookup"><span data-stu-id="1e551-419">These files are compiled into assemblies and placed in the Bin directory.</span></span> |
| <span data-ttu-id="1e551-420">應用程式\_GlobalResources 子目錄中的 .resx 和資源檔</span><span class="sxs-lookup"><span data-stu-id="1e551-420">.resx and .resource files in the App\_GlobalResources subdirectory</span></span> | <span data-ttu-id="1e551-421">這些檔案會編譯成元件並放在 Bin 目錄中。</span><span class="sxs-lookup"><span data-stu-id="1e551-421">These files are compiled into assemblies and placed in the Bin directory.</span></span> <span data-ttu-id="1e551-422">在主要輸出目錄底下不會建立任何應用程式\_GlobalResources 子目錄，且來原始目錄中的 .resx 或 .resources 檔案不會複製到輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="1e551-422">No App\_GlobalResources subdirectory is created under the main output directory, and no .resx or .resources files located in the source directory are copied to the output directories.</span></span> |
| <span data-ttu-id="1e551-423">應用程式\_LocalResources 子目錄中的 .resx 和資源檔</span><span class="sxs-lookup"><span data-stu-id="1e551-423">.resx and .resource files in the App\_LocalResources subdirectory</span></span> | <span data-ttu-id="1e551-424">這些檔案不會進行編譯，並且會複製到對應的輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="1e551-424">These files are not compiled and are copied to the corresponding output directories.</span></span> |
| <span data-ttu-id="1e551-425">應用程式中的 .skin 檔案\_主題子目錄</span><span class="sxs-lookup"><span data-stu-id="1e551-425">.skin files in the App\_Themes subdirectory</span></span> | <span data-ttu-id="1e551-426">不會編譯該檔案和靜態主題檔案，並將其複製到對應的輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="1e551-426">The .skin files and static theme files are not compiled and are copied to the corresponding output directories.</span></span> |
| <span data-ttu-id="1e551-427">。 browser 的 web.config 靜態檔案類型元件已存在於 Bin 目錄中</span><span class="sxs-lookup"><span data-stu-id="1e551-427">.browser Web.config Static file types Assemblies already present in the Bin directory</span></span> | <span data-ttu-id="1e551-428">這些檔案會依原樣複製到輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="1e551-428">These files are copied as is to the output directories.</span></span> |

<span data-ttu-id="1e551-429">下表描述當省略 **-u**選項時，ASP.NET 編譯工具如何處理不同的檔案類型。</span><span class="sxs-lookup"><span data-stu-id="1e551-429">The following table describes how the ASP.NET Compilation tool handles different file types when the **-u** option is omitted.</span></span>

| <span data-ttu-id="1e551-430">**檔案類型**</span><span class="sxs-lookup"><span data-stu-id="1e551-430">**File type**</span></span> | <span data-ttu-id="1e551-431">**編譯器動作**</span><span class="sxs-lookup"><span data-stu-id="1e551-431">**Compiler action**</span></span> |
| --- | --- |
| <span data-ttu-id="1e551-432">.aspx、.asmx、ashx、.master</span><span class="sxs-lookup"><span data-stu-id="1e551-432">.aspx, .asmx, .ashx, .master</span></span> | <span data-ttu-id="1e551-433">這些檔案會分割成標記和原始程式碼，其中包含程式碼後置檔案，以及 &lt;script runat = "server"&gt; 元素中的任何程式碼。</span><span class="sxs-lookup"><span data-stu-id="1e551-433">These files are split into markup and source code, which includes both code-behind files and any code that is enclosed in &lt;script runat="server"&gt; elements.</span></span> <span data-ttu-id="1e551-434">原始程式碼會編譯成元件，其名稱是從雜湊演算法衍生而來。</span><span class="sxs-lookup"><span data-stu-id="1e551-434">Source code is compiled into assemblies, with names that are derived from a hashing algorithm.</span></span> <span data-ttu-id="1e551-435">產生的元件會放在 Bin 目錄中。</span><span class="sxs-lookup"><span data-stu-id="1e551-435">The resulting assemblies are placed in the Bin directory.</span></span> <span data-ttu-id="1e551-436">任何內嵌程式碼（也就是包含在 **&lt;%** 和 **%&gt;** 方括弧之間的程式碼）都會包含在標記中，而且不會進行編譯。</span><span class="sxs-lookup"><span data-stu-id="1e551-436">Any inline code, that is, code enclosed between the **&lt;%** and **%&gt;** brackets, is included with markup and not compiled.</span></span> <span data-ttu-id="1e551-437">編譯器會建立新的檔案，以包含名稱與來源檔案相同的標記。</span><span class="sxs-lookup"><span data-stu-id="1e551-437">The compiler creates new files to contain the markup with the same name as the source files.</span></span> <span data-ttu-id="1e551-438">這些產生的檔案會放在 Bin 目錄中。</span><span class="sxs-lookup"><span data-stu-id="1e551-438">These resulting files are placed in the Bin directory.</span></span> <span data-ttu-id="1e551-439">編譯器也會建立與原始檔同名但副檔名為的檔案。已編譯，其中包含對應資訊。</span><span class="sxs-lookup"><span data-stu-id="1e551-439">The compiler also creates files with the same name as the source files but with the extension .COMPILED that contain mapping information.</span></span> <span data-ttu-id="1e551-440">該.編譯的檔案會放在輸出目錄中，並對應至來源檔案的原始位置。</span><span class="sxs-lookup"><span data-stu-id="1e551-440">The .COMPILED files are placed in the output directories corresponding to the original location of the source files.</span></span> |
| <span data-ttu-id="1e551-441">.ascx</span><span class="sxs-lookup"><span data-stu-id="1e551-441">.ascx</span></span> | <span data-ttu-id="1e551-442">這些檔案會分割成標記和原始碼。</span><span class="sxs-lookup"><span data-stu-id="1e551-442">These files are split into markup and source code.</span></span> <span data-ttu-id="1e551-443">原始程式碼會編譯成元件並放在 Bin 目錄中，其名稱衍生自雜湊演算法。</span><span class="sxs-lookup"><span data-stu-id="1e551-443">Source code is compiled into assemblies and placed in the Bin directory, with names that are derived from a hashing algorithm.</span></span> <span data-ttu-id="1e551-444">不會產生任何標記檔案。</span><span class="sxs-lookup"><span data-stu-id="1e551-444">No markup files are generated.</span></span> |
| <span data-ttu-id="1e551-445">.cs、.vb、. form1.jsl、.cpp （不包含先前所列檔案類型的程式碼後置檔案）</span><span class="sxs-lookup"><span data-stu-id="1e551-445">.cs, .vb, .jsl, .cpp (not including code-behind files for the file types listed earlier)</span></span> | <span data-ttu-id="1e551-446">從 .ascx、. ashx 或 .aspx 檔案所產生的元件所參考的原始程式碼會編譯成元件並放在 Bin 目錄中。</span><span class="sxs-lookup"><span data-stu-id="1e551-446">Source code that is referenced by the assemblies generated from .ascx, .ashx, or .aspx files is compiled into assemblies and placed in the Bin directory.</span></span> <span data-ttu-id="1e551-447">不會複製任何來源檔案。</span><span class="sxs-lookup"><span data-stu-id="1e551-447">No source files are copied.</span></span> |
| <span data-ttu-id="1e551-448">自訂檔案類型</span><span class="sxs-lookup"><span data-stu-id="1e551-448">Custom file types</span></span> | <span data-ttu-id="1e551-449">這些檔案會進行編譯，就像動態檔案一樣。</span><span class="sxs-lookup"><span data-stu-id="1e551-449">These files are compiled like dynamic files.</span></span> <span data-ttu-id="1e551-450">根據它們所根據的檔案類型，編譯器可以將對應檔放在輸出目錄中。</span><span class="sxs-lookup"><span data-stu-id="1e551-450">Depending on the type of file they are based on, the compiler can place mapping files in the output directories.</span></span> |
| <span data-ttu-id="1e551-451">應用程式中的檔案\_代碼子目錄</span><span class="sxs-lookup"><span data-stu-id="1e551-451">Files in the App\_Code subdirectory</span></span> | <span data-ttu-id="1e551-452">這個子目錄中的原始程式碼檔會編譯成元件並放在 Bin 目錄中。</span><span class="sxs-lookup"><span data-stu-id="1e551-452">Source code files in this subdirectory are compiled into assemblies and placed in the Bin directory.</span></span> |
| <span data-ttu-id="1e551-453">應用程式中的檔案\_GlobalResources 子目錄</span><span class="sxs-lookup"><span data-stu-id="1e551-453">Files in the App\_GlobalResources subdirectory</span></span> | <span data-ttu-id="1e551-454">這些檔案會編譯成元件並放在 Bin 目錄中。</span><span class="sxs-lookup"><span data-stu-id="1e551-454">These files are compiled into assemblies and placed in the Bin directory.</span></span> <span data-ttu-id="1e551-455">主要輸出目錄底下不會建立任何應用程式\_GlobalResources 子目錄。</span><span class="sxs-lookup"><span data-stu-id="1e551-455">No App\_GlobalResources subdirectory is created under the main output directory.</span></span> <span data-ttu-id="1e551-456">如果設定檔指定 appliesTo = "All"，.resx 和 .resources 檔案就會複製到輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="1e551-456">If the configuration file specifies appliesTo="All", .resx and .resources files are copied to the output directories.</span></span> <span data-ttu-id="1e551-457">如果[BuildProvider](https://msdn.microsoft.com/library/system.web.configuration.buildprovider.aspx)參考它們，則不會複製它們。</span><span class="sxs-lookup"><span data-stu-id="1e551-457">They are not copied if they are referenced by a [BuildProvider](https://msdn.microsoft.com/library/system.web.configuration.buildprovider.aspx).</span></span> |
| <span data-ttu-id="1e551-458">應用程式\_LocalResources 子目錄中的 .resx 和資源檔</span><span class="sxs-lookup"><span data-stu-id="1e551-458">.resx and .resource files in the App\_LocalResources subdirectory</span></span> | <span data-ttu-id="1e551-459">這些檔案會編譯成具有唯一名稱並放在 Bin 目錄中的元件。</span><span class="sxs-lookup"><span data-stu-id="1e551-459">These files are compiled into assemblies with unique names and placed in the Bin directory.</span></span> <span data-ttu-id="1e551-460">不會將 .resx 或. 資源檔案複製到輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="1e551-460">No .resx or .resource files are copied to the output directories.</span></span> |
| <span data-ttu-id="1e551-461">應用程式中的 .skin 檔案\_主題子目錄</span><span class="sxs-lookup"><span data-stu-id="1e551-461">.skin files in the App\_Themes subdirectory</span></span> | <span data-ttu-id="1e551-462">主題會編譯成元件並放在 Bin 目錄中。</span><span class="sxs-lookup"><span data-stu-id="1e551-462">Themes are compiled into assemblies and placed in the Bin directory.</span></span> <span data-ttu-id="1e551-463">系統會為 .skin 檔案建立 Stub 檔案，並將其放在對應的輸出目錄中。</span><span class="sxs-lookup"><span data-stu-id="1e551-463">Stub files are created for .skin files and placed in the corresponding output directory.</span></span> <span data-ttu-id="1e551-464">靜態檔案（例如 .css）會複製到輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="1e551-464">Static files (such as .css) are copied to the output directories.</span></span> |
| <span data-ttu-id="1e551-465">。 browser 的 web.config 靜態檔案類型元件已存在於 Bin 目錄中</span><span class="sxs-lookup"><span data-stu-id="1e551-465">.browser Web.config Static file types Assemblies already present in the Bin directory</span></span> | <span data-ttu-id="1e551-466">這些檔案會依原樣複製到輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="1e551-466">These files are copied as is to the output directory.</span></span> |

### <a name="fixed-assembly-names"></a>[<span data-ttu-id="1e551-467">固定的元件名稱</span><span class="sxs-lookup"><span data-stu-id="1e551-467">Fixed Assembly Names</span></span>](https://msdn.microsoft.com/library/ms229863.aspx##)

<span data-ttu-id="1e551-468">在某些情況下，例如使用 MSI Windows Installer 部署 Web 應用程式，需要使用一致的檔案名和內容，以及一致的目錄結構，以識別更新的元件或配置設定。</span><span class="sxs-lookup"><span data-stu-id="1e551-468">Some scenarios, such as deploying a Web application using the MSI Windows Installer, require the use of consistent file names and contents, as well as consistent directory structures to identify assemblies or configuration settings for updates.</span></span> <span data-ttu-id="1e551-469">在這些情況下，您可以使用 **-fixednames**選項，指定 ASP.NET 編譯工具應針對每個原始程式檔編譯元件，而不是使用將多個頁面編譯成元件的。</span><span class="sxs-lookup"><span data-stu-id="1e551-469">In those cases, you can use the **-fixednames** option to specify that the ASP.NET Compilation tool should compile an assembly for each source file instead of using the where multiple pages are compiled into assemblies.</span></span> <span data-ttu-id="1e551-470">這可能會導致大量的元件，因此如果您擔心擴充性，您應該謹慎使用此選項。</span><span class="sxs-lookup"><span data-stu-id="1e551-470">This can lead to a large number of assemblies, so if you are concerned with scalability you should use this option with caution.</span></span>

### <a name="strong-name-compilation"></a>[<span data-ttu-id="1e551-471">強式名稱編譯</span><span class="sxs-lookup"><span data-stu-id="1e551-471">Strong-Name Compilation</span></span>](https://msdn.microsoft.com/library/ms229863.aspx##)

<span data-ttu-id="1e551-472">提供 **-aptca**、 **-delaysign**、 **-keycontainer**和 **-Keyfile**選項，讓您可以使用 Aspnet\_cmd.exe 來建立強式名稱的元件，而不需分別使用[強式名稱工具（sn.exe）](https://msdn.microsoft.com/library/k5b5tt23.aspx) 。</span><span class="sxs-lookup"><span data-stu-id="1e551-472">The **-aptca**, **-delaysign**, **-keycontainer** and **-keyfile** options are provided so that you can use Aspnet\_compiler.exe to create strongly named assemblies without using the [Strong Name Tool (Sn.exe)](https://msdn.microsoft.com/library/k5b5tt23.aspx) separately.</span></span> <span data-ttu-id="1e551-473">這些選項分別對應至**AllowPartiallyTrustedCallersAttribute**、 **AssemblyDelaySignAttribute**、 **AssemblyKeyNameAttribute**和**AssemblyKeyFileAttribute**。</span><span class="sxs-lookup"><span data-stu-id="1e551-473">These options correspond, respectively, to **AllowPartiallyTrustedCallersAttribute**, **AssemblyDelaySignAttribute**, **AssemblyKeyNameAttribute**, and **AssemblyKeyFileAttribute**.</span></span>

<span data-ttu-id="1e551-474">這些屬性的討論不在此課程的範圍內。</span><span class="sxs-lookup"><span data-stu-id="1e551-474">Discussion of these attributes is outside of the scope of this course.</span></span>

## <a name="labs"></a><span data-ttu-id="1e551-475">實驗室</span><span class="sxs-lookup"><span data-stu-id="1e551-475">Labs</span></span>

<span data-ttu-id="1e551-476">下列實驗室都是以先前的實驗室為基礎。</span><span class="sxs-lookup"><span data-stu-id="1e551-476">Each of the following labs builds on the previous labs.</span></span> <span data-ttu-id="1e551-477">您將需要依序執行。</span><span class="sxs-lookup"><span data-stu-id="1e551-477">You will need to do them in order.</span></span>

## <a name="lab-1-using-the-configuration-api"></a><span data-ttu-id="1e551-478">實驗室1：使用設定 API</span><span class="sxs-lookup"><span data-stu-id="1e551-478">Lab 1: Using the Configuration API</span></span>

1. <span data-ttu-id="1e551-479">建立名為*mod9lab*的新網站。</span><span class="sxs-lookup"><span data-stu-id="1e551-479">Create a new Web site called *mod9lab*.</span></span>
2. <span data-ttu-id="1e551-480">將新的 Web 設定檔新增至網站。</span><span class="sxs-lookup"><span data-stu-id="1e551-480">Add a new Web Configuration File to the site.</span></span>
3. <span data-ttu-id="1e551-481">將下列內容新增至 web.config 檔案：</span><span class="sxs-lookup"><span data-stu-id="1e551-481">Add the following to the web.config file:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample14.xml)]

<span data-ttu-id="1e551-482">這可確保您擁有儲存 web.config 檔案變更的許可權。</span><span class="sxs-lookup"><span data-stu-id="1e551-482">This will ensure that you have permission to save changes to the web.config file.</span></span>

1. <span data-ttu-id="1e551-483">將新的標籤控制項加入至 default.aspx，並將識別碼變更為**lblDebugStatus**。</span><span class="sxs-lookup"><span data-stu-id="1e551-483">Add a new Label control to Default.aspx and change the ID to **lblDebugStatus**.</span></span>
2. <span data-ttu-id="1e551-484">將新的按鈕控制項加入 default.aspx。</span><span class="sxs-lookup"><span data-stu-id="1e551-484">Add a new Button control to Default.aspx.</span></span>
3. <span data-ttu-id="1e551-485">將按鈕控制項的 ID 變更為**btnToggleDebug** ，並將文字變更為**切換偵錯工具狀態**。</span><span class="sxs-lookup"><span data-stu-id="1e551-485">Change the Button control's ID to **btnToggleDebug** and the Text to **Toggle Debug Status**.</span></span>
4. <span data-ttu-id="1e551-486">開啟 default.aspx 的程式碼後置檔案的程式碼片段，並為**system.web. Configuration**新增**using**語句，如下所示：</span><span class="sxs-lookup"><span data-stu-id="1e551-486">Open the Code View for the code-behind file of Default.aspx and add a **using** statement for **System.Web.Configuration** as follows:</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample15.cs)]

1. <span data-ttu-id="1e551-487">將兩個私用變數新增至類別，並將頁面\_Init 方法，如下所示：</span><span class="sxs-lookup"><span data-stu-id="1e551-487">Add two private variables to the class and a Page\_Init method as shown below:</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample16.cs)]

1. <span data-ttu-id="1e551-488">將下列程式碼新增至頁面\_載入：</span><span class="sxs-lookup"><span data-stu-id="1e551-488">Add the following code to Page\_Load:</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample17.cs)]

1. <span data-ttu-id="1e551-489">儲存並流覽 default.aspx。</span><span class="sxs-lookup"><span data-stu-id="1e551-489">Save and browse default.aspx.</span></span> <span data-ttu-id="1e551-490">請注意，標籤控制項會顯示目前的「偵錯工具」狀態。</span><span class="sxs-lookup"><span data-stu-id="1e551-490">Notice that the Label control displays the current debug status.</span></span>
2. <span data-ttu-id="1e551-491">按兩下設計工具中的 [Button] 控制項，然後將下列程式碼加入按鈕控制項的 Click 事件中：</span><span class="sxs-lookup"><span data-stu-id="1e551-491">Double-click on the Button control in the designer and add the following code to the Click event for the Button control:</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample18.cs)]

1. <span data-ttu-id="1e551-492">儲存並流覽 default.aspx，然後按一下按鈕。</span><span class="sxs-lookup"><span data-stu-id="1e551-492">Save and browse default.aspx and click the button.</span></span>
2. <span data-ttu-id="1e551-493">在每個按鈕按一下後開啟 web.config 檔案，並觀察 &lt;編譯&gt; 區段中的**debug**屬性。</span><span class="sxs-lookup"><span data-stu-id="1e551-493">Open the web.config file after each button click and observe the **debug** attribute in the &lt;compilation&gt; section.</span></span>

## <a name="lab-2-logging-application-restarts"></a><span data-ttu-id="1e551-494">實驗室2：記錄應用程式重新開機</span><span class="sxs-lookup"><span data-stu-id="1e551-494">Lab 2: Logging Application Restarts</span></span>

<span data-ttu-id="1e551-495">在此實驗室中，您將建立可讓您在事件檢視器中切換應用程式關閉、重新開機和重新編譯記錄的程式碼。</span><span class="sxs-lookup"><span data-stu-id="1e551-495">In this lab, you will create code that will allow you to toggle the logging of application shutdowns, startups, and recompilations in the Event Viewer.</span></span>

1. <span data-ttu-id="1e551-496">將 DropDownList 新增至 default.aspx，並將識別碼變更為 ddlLogAppEvents。</span><span class="sxs-lookup"><span data-stu-id="1e551-496">Add a DropDownList to default.aspx and change the ID to ddlLogAppEvents.</span></span>
2. <span data-ttu-id="1e551-497">將 DropDownList 的**AutoPostBack**屬性設定為**true**。</span><span class="sxs-lookup"><span data-stu-id="1e551-497">Set the **AutoPostBack** property for the DropDownList to **true**.</span></span>
3. <span data-ttu-id="1e551-498">將三個專案新增至 DropDownList 的 Items 集合。</span><span class="sxs-lookup"><span data-stu-id="1e551-498">Add three items to the Items collection for the DropDownList.</span></span> <span data-ttu-id="1e551-499">將第一個專案的\**文字\*\*\*選取值*，並將值設為-1。</span><span class="sxs-lookup"><span data-stu-id="1e551-499">Make the **Text** for the first item *Select Value* and the value -1.</span></span> <span data-ttu-id="1e551-500">將第二個專案的**文字**和**值**設**為 True** ，並將第三個專案的**文字**和**值**設**為 False**。</span><span class="sxs-lookup"><span data-stu-id="1e551-500">Make the **Text** and **Value** of the second item **True** and the **Text** and **Value** of the third item **False**.</span></span>
4. <span data-ttu-id="1e551-501">將新的標籤加入 default.aspx。</span><span class="sxs-lookup"><span data-stu-id="1e551-501">Add a new Label to default.aspx.</span></span> <span data-ttu-id="1e551-502">將識別碼變更為**lblLogAppEvents**。</span><span class="sxs-lookup"><span data-stu-id="1e551-502">Change the ID to **lblLogAppEvents**.</span></span>
5. <span data-ttu-id="1e551-503">開啟 default.aspx 的程式碼後置視圖，並為 HealthMonitoringSection 類型的變數加入新的宣告，如下所示：</span><span class="sxs-lookup"><span data-stu-id="1e551-503">Open the code-behind view for default.aspx and add a new declaration for a variable of type HealthMonitoringSection as shown below:</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample19.cs)]

1. <span data-ttu-id="1e551-504">將下列程式碼新增至頁面\_Init 中的現有程式碼：</span><span class="sxs-lookup"><span data-stu-id="1e551-504">Add the following code to the existing code in Page\_Init:</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample20.cs)]

1. <span data-ttu-id="1e551-505">按兩下 DropDownList，並將下列程式碼新增至 SelectedIndexChanged 事件：</span><span class="sxs-lookup"><span data-stu-id="1e551-505">Double-click on the DropDownList and add the following code to the SelectedIndexChanged event:</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample21.cs)]

1. <span data-ttu-id="1e551-506">流覽 default.aspx。</span><span class="sxs-lookup"><span data-stu-id="1e551-506">Browse default.aspx.</span></span>
2. <span data-ttu-id="1e551-507">將下拉式清單設定為**False**。</span><span class="sxs-lookup"><span data-stu-id="1e551-507">Set the dropdown to **False**.</span></span>
3. <span data-ttu-id="1e551-508">清除事件檢視器中的應用程式記錄檔。</span><span class="sxs-lookup"><span data-stu-id="1e551-508">Clear the Application log in the Event Viewer.</span></span>
4. <span data-ttu-id="1e551-509">按一下此按鈕，即可變更應用程式的 Debug 屬性。</span><span class="sxs-lookup"><span data-stu-id="1e551-509">Click the button to change the Debug attribute for the application.</span></span>
5. <span data-ttu-id="1e551-510">重新整理事件檢視器中的應用程式記錄檔。</span><span class="sxs-lookup"><span data-stu-id="1e551-510">Refresh the Application log in the Event Viewer.</span></span> 

    1. <span data-ttu-id="1e551-511">是否已記錄任何事件？</span><span class="sxs-lookup"><span data-stu-id="1e551-511">Were any events logged?</span></span>
    2. <span data-ttu-id="1e551-512">為何或為什麼不這麼做？</span><span class="sxs-lookup"><span data-stu-id="1e551-512">Why or why not?</span></span>
6. <span data-ttu-id="1e551-513">將下拉式清單設定為 [ **True]。**</span><span class="sxs-lookup"><span data-stu-id="1e551-513">Set the dropdown to **True.**</span></span>
7. <span data-ttu-id="1e551-514">按一下按鈕以切換應用程式的 Debug 屬性。</span><span class="sxs-lookup"><span data-stu-id="1e551-514">Click the button to toggle the Debug attribute for the application.</span></span>
8. <span data-ttu-id="1e551-515">重新整理應用程式登入事件檢視器。</span><span class="sxs-lookup"><span data-stu-id="1e551-515">Refresh the Application login the Event Viewer.</span></span> 

    1. <span data-ttu-id="1e551-516">是否已記錄任何事件？</span><span class="sxs-lookup"><span data-stu-id="1e551-516">Were any events logged?</span></span>
    2. <span data-ttu-id="1e551-517">應用程式關閉的原因為何？</span><span class="sxs-lookup"><span data-stu-id="1e551-517">What was the reason for the app shutdown?</span></span>
9. <span data-ttu-id="1e551-518">試驗開啟和關閉記錄，並查看對 web.config 檔案所做的變更。</span><span class="sxs-lookup"><span data-stu-id="1e551-518">Experiment with turning on and off logging and look at the changes made to the web.config file.</span></span>

## <a name="more-information"></a><span data-ttu-id="1e551-519">其他相關資訊：</span><span class="sxs-lookup"><span data-stu-id="1e551-519">More Information:</span></span>

<span data-ttu-id="1e551-520">ASP.NET 2.0 的提供者模型可讓您建立自己的提供者，不僅適用于應用程式檢測，還有其他許多用途，例如成員資格、設定檔等。如需撰寫自訂提供者以將應用程式事件記錄到文字檔的詳細資訊，請造訪[此連結](https://msdn.microsoft.com/library/default.asp?url=/library/dnaspp/html/ASPNETProvMod_Prt6.asp)。</span><span class="sxs-lookup"><span data-stu-id="1e551-520">ASP.NET 2.0's Provider model allows you to create your own providers for not only application instrumentation, but for many other uses as well such as Membership, Profiles, etc. For detailed information on writing a custom provider to log application events to a text file, visit [this link](https://msdn.microsoft.com/library/default.asp?url=/library/dnaspp/html/ASPNETProvMod_Prt6.asp).</span></span>
