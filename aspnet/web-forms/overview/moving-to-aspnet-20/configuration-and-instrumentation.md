---
uid: web-forms/overview/moving-to-aspnet-20/configuration-and-instrumentation
title: 設定與偵測微軟文件
author: rick-anderson
description: ASP.NET 2.0 中的配置和檢測發生了重大變化。 新的ASP.NET配置 API 允許進行配置更改。
ms.author: riande
ms.date: 02/20/2005
ms.assetid: 21ebbaee-7ed8-45ae-b6c1-c27c88342e48
msc.legacyurl: /web-forms/overview/moving-to-aspnet-20/configuration-and-instrumentation
msc.type: authoredcontent
ms.openlocfilehash: 30ea2ffd3d055c5373a33615bc19a8f68fb568ab
ms.sourcegitcommit: 022f79dbc1350e0c6ffaa1e7e7c6e850cdabf9af
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/17/2020
ms.locfileid: "81543050"
---
# <a name="configuration-and-instrumentation"></a><span data-ttu-id="ce8f9-104">設定與檢測</span><span class="sxs-lookup"><span data-stu-id="ce8f9-104">Configuration and Instrumentation</span></span>

<span data-ttu-id="ce8f9-105">由[微軟](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="ce8f9-105">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="ce8f9-106">ASP.NET 2.0 中的配置和檢測發生了重大變化。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-106">There are major changes in configuration and instrumentation in ASP.NET 2.0.</span></span> <span data-ttu-id="ce8f9-107">新的ASP.NET配置 API 允許以程式設計方式進行配置更改。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-107">The new ASP.NET configuration API allows for configuration changes to be made programmatically.</span></span> <span data-ttu-id="ce8f9-108">此外,存在許多新的配置設置允許新的配置和檢測。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-108">In addition, many new configuration settings exist allow for new configurations and instrumentation.</span></span>

<span data-ttu-id="ce8f9-109">ASP.NET 2.0 中的配置和檢測發生了重大變化。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-109">There are major changes in configuration and instrumentation in ASP.NET 2.0.</span></span> <span data-ttu-id="ce8f9-110">新的ASP.NET配置 API 允許以程式設計方式進行配置更改。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-110">The new ASP.NET configuration API allows for configuration changes to be made programmatically.</span></span> <span data-ttu-id="ce8f9-111">此外,存在許多新的配置設置允許新的配置和檢測。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-111">In addition, many new configuration settings exist allow for new configurations and instrumentation.</span></span>

<span data-ttu-id="ce8f9-112">在本模組中,我們將討論配置 API ASP.NET,因為它與讀取和寫入ASP.NET配置檔有關,我們還將討論ASP.NET檢測。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-112">In this module, we will discuss ASP.NET the configuration API as it relates to reading from and writing to ASP.NET configuration files, and we will also cover ASP.NET instrumentation.</span></span> <span data-ttu-id="ce8f9-113">我們還將介紹ASP.NET跟蹤中提供的新功能。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-113">We will also cover the new features available in ASP.NET tracing.</span></span>

## <a name="aspnet-configuration-api"></a><span data-ttu-id="ce8f9-114">ASP.NET 設定 API</span><span class="sxs-lookup"><span data-stu-id="ce8f9-114">ASP.NET Configuration API</span></span>

<span data-ttu-id="ce8f9-115">ASP.NET配置 API 允許您使用單個程式設計介面開發、部署和管理應用程式配置數據。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-115">The ASP.NET configuration API allows you to develop, deploy, and manage application configuration data by using a single programming interface.</span></span> <span data-ttu-id="ce8f9-116">您可以使用設定 API 以程式設計方式開發和修改完整的 ASP.NET 配置,而無需直接編輯設定檔中的 XML。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-116">You can use the configuration API to develop and modify complete ASP.NET configurations programmatically without directly editing the XML in the configuration files.</span></span> <span data-ttu-id="ce8f9-117">此外,您可以在開發的應用程式和腳本、基於 Web 的管理工具以及 Microsoft 管理主控台 (MMC) 管理單元中使用配置 API。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-117">In addition, you can use the configuration API in console applications and scripts that you develop, in Web-based management tools, and in Microsoft Management Console (MMC) snap-ins.</span></span>

<span data-ttu-id="ce8f9-118">以下兩個設定管理工具使用設定 API,並包含在 .NET 框架版本 2.0 中:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-118">The following two configuration-management tools use the configuration API and are included with the .NET Framework version 2.0:</span></span>

- <span data-ttu-id="ce8f9-119">mMC ASP.NET,它使用配置 API 簡化管理任務,提供來自配置層次結構所有級別的本地配置數據的整合檢視。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-119">The ASP.NET MMC snap-in, which uses the configuration API to simplify administrative tasks, providing an integrated view of local configuration data from all levels of the configuration hierarchy.</span></span>
- <span data-ttu-id="ce8f9-120">網站管理工具,允許您管理本地和遠端應用程式的設定設置,包括託管站點。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-120">The Web Site Administration Tool, which allows you to manage configuration settings for local and remote applications, including hosted sites.</span></span>

<span data-ttu-id="ce8f9-121">ASP.NET配置 API 包含一組ASP.NET管理物件,可用於以程式設計方式配置網站和應用程式。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-121">The ASP.NET configuration API comprises a set of ASP.NET management objects that you can use to configure Web sites and applications programmatically.</span></span> <span data-ttu-id="ce8f9-122">管理物件作為 .NET 框架類庫實現。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-122">Management objects are implemented as a .NET Framework class library.</span></span> <span data-ttu-id="ce8f9-123">配置 API 程式設計模型透過編譯時強制實施資料類型,有助於確保代碼的一致性和可靠性。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-123">The configuration API programming model helps ensure code consistency and reliability by enforcing data types at compile time.</span></span> <span data-ttu-id="ce8f9-124">為了更輕鬆地管理應用程式配置,配置 API 允許您將從配置層次結構中的所有點合併的數據視為單個集合,而不是將數據視為來自不同配置檔的單獨集合。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-124">To make it easier to manage application configurations, the configuration API allows you to view data that is merged from all points in the configuration hierarchy as a single collection, instead of viewing the data as separate collections from different configuration files.</span></span> <span data-ttu-id="ce8f9-125">此外,設定 API 讓您能夠操作整個應用程式設定,而無需直接編輯設定檔中的 XML。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-125">Additionally, the configuration API enables you to manipulate entire application configurations without directly editing the XML in the configuration files.</span></span> <span data-ttu-id="ce8f9-126">最後,API 透過支援管理工具(如網站管理工具)來簡化配置任務。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-126">Finally, the API simplifies configuration tasks by supporting administrative tools, such as the Web Site Administration Tool.</span></span> <span data-ttu-id="ce8f9-127">配置 API 透過支援在電腦上創建設定檔並在多台電腦上運行配置腳本來簡化部署。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-127">The configuration API simplifies deployment by supporting the creation of configuration files on a computer and running configuration scripts across multiple computers.</span></span>

> [!NOTE]
> <span data-ttu-id="ce8f9-128">配置 API 不支援創建 IIS 應用程式。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-128">The configuration API does not support the creation of IIS applications.</span></span>

## <a name="working-with-local-and-remote-configuration-settings"></a><span data-ttu-id="ce8f9-129">使用本地端與遠端設定設定</span><span class="sxs-lookup"><span data-stu-id="ce8f9-129">Working with Local and Remote Configuration Settings</span></span>

<span data-ttu-id="ce8f9-130">配置物件表示應用於特定實體實體(如電腦)或邏輯實體(如應用程式或網站)的配置設置的合併視圖。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-130">A Configuration object represents the merged view of the configuration settings that apply to a specific physical entity, such as a computer, or to a logical entity, such as an application or a Web site.</span></span> <span data-ttu-id="ce8f9-131">指定的邏輯實體可以存在於本地電腦或遠端伺服器上。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-131">The specified logical entity can exist on the local computer or on a remote server.</span></span> <span data-ttu-id="ce8f9-132">當指定實體不存在設定檔時,配置物件表示由計算機.config 檔定義的預設設定設定。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-132">When no configuration file exists for a specified entity, the Configuration object represents the default configuration settings as defined by the Machine.config file.</span></span>

<span data-ttu-id="ce8f9-133">使用以下類別的一個開啟的設定方法,可以取得設定物件:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-133">You can get a Configuration object by using one of the open configuration methods from the following classes:</span></span>

1. <span data-ttu-id="ce8f9-134">配置管理員(如果您的實體是用戶端應用程式)。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-134">The ConfigurationManager class, if your entity is a client application.</span></span>
2. <span data-ttu-id="ce8f9-135">Web 設定管理員類別(如果您的實體是 Web 應用程式)。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-135">The WebConfigurationManager class, if your entity is a Web application.</span></span>

<span data-ttu-id="ce8f9-136">這些方法將返回一個配置物件,該物件反過來提供了處理基礎配置檔所需的方法和屬性。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-136">These methods will return a Configuration object, which in turn provides the required methods and properties to handle the underlying configuration files.</span></span> <span data-ttu-id="ce8f9-137">您可以造訪這些檔案進行讀取或寫入。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-137">You can access these files for reading or writing.</span></span>

### <a name="reading"></a><span data-ttu-id="ce8f9-138">讀取</span><span class="sxs-lookup"><span data-stu-id="ce8f9-138">Reading</span></span>

<span data-ttu-id="ce8f9-139">您可以使用 GetSection 或 GetSectionGroup 方法讀取配置資訊。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-139">You use the GetSection or GetSectionGroup method to read configuration information.</span></span> <span data-ttu-id="ce8f9-140">讀取的使用者或進程必須對層次結構中的所有配置檔具有讀取許可權。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-140">The user or process that reads must have Read permissions on all of the configuration files in the hierarchy.</span></span>

> [!NOTE]
> <span data-ttu-id="ce8f9-141">如果使用採用路徑參數的靜態 GetSection 方法,則路徑參數必須引用運行代碼的應用程式。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-141">If you use a static GetSection method that takes a path parameter, the path parameter must refer to the application in which the code is running.</span></span> <span data-ttu-id="ce8f9-142">否則,將忽略該參數,並返回當前正在運行的應用程式的配置資訊。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-142">Otherwise, the parameter is ignored and the configuration information for the currently running application is returned.</span></span>

### <a name="writing"></a><span data-ttu-id="ce8f9-143">撰寫</span><span class="sxs-lookup"><span data-stu-id="ce8f9-143">Writing</span></span>

<span data-ttu-id="ce8f9-144">您可以使用 Save 方法之一來寫入設定資訊。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-144">You use one of the Save methods to write configuration information.</span></span> <span data-ttu-id="ce8f9-145">寫入的使用者或進程必須具有當前配置層次結構級別的配置檔和目錄的寫入許可權,以及層次結構中所有配置檔的讀取許可權。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-145">The user or process that writes must have Write permissions on the configuration file and directory at the current configuration hierarchy level, as well as Read permissions on all of the configuration files in the hierarchy.</span></span>

<span data-ttu-id="ce8f9-146">要產生表示指定實體繼承的設定設定的設定檔,請使用以下儲存配置方法之一:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-146">To generate a configuration file that represents the inherited configuration settings for a specified entity, use one of the following save-configuration methods:</span></span>

1. <span data-ttu-id="ce8f9-147">建立新設定檔的儲存方法。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-147">The Save method to create a new configuration file.</span></span>
2. <span data-ttu-id="ce8f9-148">保存 As 方法用於在另一個位置生成新的設定檔。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-148">The SaveAs method to generate a new configuration file at another location.</span></span>

## <a name="configuration-classes-and-namespaces"></a><span data-ttu-id="ce8f9-149">設定類別與命名空間</span><span class="sxs-lookup"><span data-stu-id="ce8f9-149">Configuration Classes and Namespaces</span></span>

<span data-ttu-id="ce8f9-150">許多配置類和方法彼此相似。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-150">Many configuration classes and methods are similar to each other.</span></span> <span data-ttu-id="ce8f9-151">下表描述了最常用的配置類和命名空間。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-151">The following table describes the most commonly used configuration classes and namespaces.</span></span>

| <span data-ttu-id="ce8f9-152">**設定類別或命名空間**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-152">**Configuration class or namespace**</span></span> | <span data-ttu-id="ce8f9-153">**說明**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-153">**Description**</span></span> |
| --- | --- |
| <span data-ttu-id="ce8f9-154">[系統.設定](https://msdn.microsoft.com/library/system.configuration.aspx)命名空間</span><span class="sxs-lookup"><span data-stu-id="ce8f9-154">[System.Configuration](https://msdn.microsoft.com/library/system.configuration.aspx) namespace</span></span> | <span data-ttu-id="ce8f9-155">包含所有 .NET 框架應用程式的主配置類。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-155">Contains the main configuration classes for all .NET Framework applications.</span></span> <span data-ttu-id="ce8f9-156">節處理程式類用於從 GetSection 和 GetSectionGroup 等方法獲取節的配置數據。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-156">Section handler classes are used to obtain configuration data for a section from methods, such as GetSection and GetSectionGroup.</span></span> <span data-ttu-id="ce8f9-157">這兩種方法是非靜態的。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-157">These two methods are non-static.</span></span> |
| <span data-ttu-id="ce8f9-158">系統.設定.設定類別</span><span class="sxs-lookup"><span data-stu-id="ce8f9-158">System.Configuration.Configuration class</span></span> | <span data-ttu-id="ce8f9-159">表示電腦、應用程式、Web 目錄或其他資源的一組配置數據。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-159">Represents a set of configuration data for a computer, application, Web directory, or other resource.</span></span> <span data-ttu-id="ce8f9-160">此類包含用於更新配置設定和獲取對節和節組的引用的有用方法,如 GetSection 和 GetSectionGroup。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-160">This class contains useful methods, such as GetSection and GetSectionGroup, for updating configuration settings and obtaining references to sections and section groups.</span></span> <span data-ttu-id="ce8f9-161">此類用作獲取設計時設定資料的方法的傳回類型,例如 Web 配置管理員和設定管理器 類的方法。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-161">This class is used as a return type for methods that obtain design-time configuration data, such as the methods of the WebConfigurationManager and ConfigurationManager classes.</span></span> |
| <span data-ttu-id="ce8f9-162">系統.Web.設定命名空間</span><span class="sxs-lookup"><span data-stu-id="ce8f9-162">System.Web.Configuration namespace</span></span> | <span data-ttu-id="ce8f9-163">包含ASP.NET[配置設定](https://msdn.microsoft.com/library/b5ysx397.aspx)中定義的ASP.NET配置部分的節處理程式類。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-163">Contains the section handler classes for the ASP.NET configuration sections defined at [ASP.NET Configuration Settings](https://msdn.microsoft.com/library/b5ysx397.aspx).</span></span> <span data-ttu-id="ce8f9-164">節處理程式類用於從 GetSection 和 GetSectionGroup 等方法獲取節的配置數據。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-164">Section handler classes are used to obtain configuration data for a section from methods, such as GetSection and GetSectionGroup.</span></span> |
| <span data-ttu-id="ce8f9-165">系統.Web.設定.Web配置管理員類別</span><span class="sxs-lookup"><span data-stu-id="ce8f9-165">System.Web.Configuration.WebConfigurationManager class</span></span> | <span data-ttu-id="ce8f9-166">提供了獲取對運行時和設計時配置設置引用的有用方法。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-166">Provides useful methods for obtaining references to run-time and design-time configuration settings.</span></span> <span data-ttu-id="ce8f9-167">這些方法使用 System.配置.配置類作為返回類型。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-167">These methods use the System.Configuration.Configuration class as a return type.</span></span> <span data-ttu-id="ce8f9-168">您可以使用此類的靜態 GetSection 方法或系統的非靜態 GetSection 方法。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-168">You can use the static GetSection method of this class or the non-static GetSection method of the System.Configuration.ConfigurationManager class interchangeably.</span></span> <span data-ttu-id="ce8f9-169">對於 Web 應用程式設定,建議使用 System.Web.配置.Web 配置管理器 類而不是系統.配置.配置管理器類。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-169">For Web application configurations, the System.Web.Configuration.WebConfigurationManager class is recommended instead of the System.Configuration.ConfigurationManager class.</span></span> |
| <span data-ttu-id="ce8f9-170">[系統.設定.提供者](https://msdn.microsoft.com/library/system.configuration.provider.aspx)命名空間</span><span class="sxs-lookup"><span data-stu-id="ce8f9-170">[System.Configuration.Provider](https://msdn.microsoft.com/library/system.configuration.provider.aspx) namespace</span></span> | <span data-ttu-id="ce8f9-171">提供了一種自定義和擴展配置提供程式的方法。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-171">Provides a way to customize and extend the configuration provider.</span></span> <span data-ttu-id="ce8f9-172">這是配置系統中所有提供程式類的基類。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-172">This is the base class for all provider classes in the configuration system.</span></span> |
| <span data-ttu-id="ce8f9-173">[系統.Web.管理](https://msdn.microsoft.com/library/system.web.management.aspx)命名空間</span><span class="sxs-lookup"><span data-stu-id="ce8f9-173">[System.Web.Management](https://msdn.microsoft.com/library/system.web.management.aspx) namespace</span></span> | <span data-ttu-id="ce8f9-174">包含用於管理和監視 Web 應用程式運行狀況的類和介面。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-174">Contains classes and interfaces for managing and monitoring the health of Web applications.</span></span> <span data-ttu-id="ce8f9-175">嚴格地說,此命名空間不被視為配置 API 的一部分。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-175">Strictly speaking, this namespace is not considered part of the configuration API.</span></span> <span data-ttu-id="ce8f9-176">例如,跟蹤和事件觸發由此命名空間中的類完成。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-176">For example, tracing and event firing is accomplished by the classes in this namespace.</span></span> |
| <span data-ttu-id="ce8f9-177">[系統管理.偵測](https://msdn.microsoft.com/library/system.management.instrumentation.aspx)命名空間</span><span class="sxs-lookup"><span data-stu-id="ce8f9-177">[System.Management.Instrumentation](https://msdn.microsoft.com/library/system.management.instrumentation.aspx) namespace</span></span> | <span data-ttu-id="ce8f9-178">提供應用程式檢測所需的類,以便通過 Windows 管理檢測 (WMI) 向潛在使用者公開其管理資訊和事件。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-178">Provides the classes necessary for the instrumentation of applications to expose their management information and events through Windows Management Instrumentation (WMI) to potential consumers.</span></span> <span data-ttu-id="ce8f9-179">ASP.NET運行狀況監視使用 WMI 傳遞事件。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-179">ASP.NET health monitoring uses WMI to deliver events.</span></span> <span data-ttu-id="ce8f9-180">嚴格地說,此命名空間不被視為配置 API 的一部分。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-180">Strictly speaking, this namespace is not considered part of the configuration API.</span></span> |

## <a name="reading-from-aspnet-configuration-files"></a><span data-ttu-id="ce8f9-181">從ASP.NET設定檔讀取</span><span class="sxs-lookup"><span data-stu-id="ce8f9-181">Reading from ASP.NET Configuration Files</span></span>

<span data-ttu-id="ce8f9-182">WebManagerManager 類是從ASP.NET配置檔讀取的核心類。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-182">The WebConfigurationManager class is the core class for reading from ASP.NET configuration files.</span></span> <span data-ttu-id="ce8f9-183">讀取ASP.NET設定檔基本上有三個步驟:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-183">There are essentially three steps to reading ASP.NET configuration files:</span></span>

1. <span data-ttu-id="ce8f9-184">使用 OpenWeb 設定方法獲取配置物件。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-184">Get a Configuration object using the OpenWebConfiguration method.</span></span>
2. <span data-ttu-id="ce8f9-185">獲取對設定檔中所需部分的引用。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-185">Get a reference to the desired section in the configuration file.</span></span>
3. <span data-ttu-id="ce8f9-186">從配置檔中讀取所需的資訊。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-186">Read the desired information from the configuration file.</span></span>

<span data-ttu-id="ce8f9-187">配置物件表示不表示特定的配置檔。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-187">The Configuration object represents does not represent a particular configuration file.</span></span> <span data-ttu-id="ce8f9-188">相反,它表示計算機、應用程式或網站的配置的合併視圖。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-188">Instead, it represents a merged view of the configuration of a computer, application, or Web site.</span></span> <span data-ttu-id="ce8f9-189">以下代碼示例實例化表示名為*ProductInfo*的 Web 應用程式的配置的配置物件。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-189">The following code sample instantiates a Configuration object representing the configuration of a Web application called *ProductInfo*.</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample1.cs)]

> [!NOTE]
> <span data-ttu-id="ce8f9-190">請注意,如果 /ProductInfo 路徑不存在,上述代碼將返回計算機中指定的默認配置。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-190">Note that if the /ProductInfo path doesn't exist, the above code will return the default configuration as specified in the machine.config file.</span></span>

<span data-ttu-id="ce8f9-191">獲得配置物件後,可以使用 GetSection 或 GetSectionGroup 方法深入瞭解配置設置。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-191">Once you have the Configuration object, you can then use the GetSection or GetSectionGroup method to drill into the configuration settings.</span></span> <span data-ttu-id="ce8f9-192">以下範例取得對上述 ProductInfo 應用程式的模擬設定的參考:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-192">The following example gets a reference to the impersonation settings for the above ProductInfo application:</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample2.cs)]

## <a name="writing-to-aspnet-configuration-files"></a><span data-ttu-id="ce8f9-193">寫入ASP.NET設定檔</span><span class="sxs-lookup"><span data-stu-id="ce8f9-193">Writing to ASP.NET Configuration Files</span></span>

<span data-ttu-id="ce8f9-194">與從設定檔讀取一樣,WebManagerManager 類是寫入Asp.NET配置檔的核心。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-194">As in reading from configuration files, the WebConfigurationManager class is the core for writing to Asp.NET configuration files.</span></span> <span data-ttu-id="ce8f9-195">還有三個步驟要寫入ASP.NET配置檔。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-195">There are also three steps to writing to ASP.NET configuration files.</span></span>

1. <span data-ttu-id="ce8f9-196">使用 OpenWeb 設定方法獲取配置物件。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-196">Get a Configuration object using the OpenWebConfiguration method.</span></span>
2. <span data-ttu-id="ce8f9-197">獲取對設定檔中所需部分的引用。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-197">Get a reference to the desired section in the configuration file.</span></span>
3. <span data-ttu-id="ce8f9-198">使用"儲存"或"儲存"方法從配置檔中寫入所需的資訊。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-198">Write the desired information from the configuration file using the Save or SaveAs method.</span></span>

<span data-ttu-id="ce8f9-199">以下代碼將編譯&lt;&gt;元素的**除錯**屬性變更為 false:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-199">The following code changes the **debug** attribute of the &lt;compilation&gt; element to false:</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample3.cs)]

<span data-ttu-id="ce8f9-200">執行此代碼時&lt;,webApp&gt;應用程式的*Web.config*檔編譯元素的**調試**屬性將設置為 false。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-200">When this code is executed, the **debug** attribute of the &lt;compilation&gt; element will be set to false for the *webApp* application's web.config file.</span></span>

## <a name="systemwebmanagement-namespace"></a><span data-ttu-id="ce8f9-201">系統.Web.管理命名空間</span><span class="sxs-lookup"><span data-stu-id="ce8f9-201">System.Web.Management Namespace</span></span>

<span data-ttu-id="ce8f9-202">System.Web.管理命名空間提供用於管理和監視ASP.NET應用程式的運行狀況的類和介面。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-202">The System.Web.Management namespace provides the classes and interfaces for managing and monitoring the health of ASP.NET applications.</span></span>

<span data-ttu-id="ce8f9-203">日誌記錄是通過定義將事件與提供程式關聯的規則來完成的。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-203">Logging is accomplished by defining a rule that associates events with a provider.</span></span> <span data-ttu-id="ce8f9-204">規則定義發送到提供程式的事件類型。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-204">The rule defines the type of events that are sent to the provider.</span></span> <span data-ttu-id="ce8f9-205">以下基本事件可供您紀錄:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-205">The following base events are available for you to log:</span></span>

| <span data-ttu-id="ce8f9-206">**WebBase 事件**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-206">**WebBaseEvent**</span></span> | <span data-ttu-id="ce8f9-207">所有事件的基礎事件類。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-207">The base event class for all events.</span></span> <span data-ttu-id="ce8f9-208">包含所有事件(如事件代碼、事件詳細資訊代碼、引發事件的日期和時間、序列號、事件消息和事件詳細資訊)所需的屬性。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-208">Contains the required properties for all events such as event code, event detail code, the date and time the event was raised, sequence number, the event message, and event details.</span></span> |
| --- | --- |
| <span data-ttu-id="ce8f9-209">**網路管理事件**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-209">**WebManagementEvent**</span></span> | <span data-ttu-id="ce8f9-210">管理事件的基本事件類,如應用程式存留期、請求、錯誤和審核事件。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-210">The base event class for management events, such as application lifetime, request, error, and audit events.</span></span> |
| <span data-ttu-id="ce8f9-211">**網路偵測事件**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-211">**WebHeartbeatEvent**</span></span> | <span data-ttu-id="ce8f9-212">應用程式以固定間隔生成的事件,用於捕獲有用的運行時狀態資訊。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-212">The event generated by the application in regular intervals to capture useful runtime state information.</span></span> |
| <span data-ttu-id="ce8f9-213">**網路審計事件**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-213">**WebAuditEvent**</span></span> | <span data-ttu-id="ce8f9-214">安全審核事件的基類,用於標記授權失敗、解密失敗*等條件。*</span><span class="sxs-lookup"><span data-stu-id="ce8f9-214">The base class for security audit events, which are used to mark conditions such as authorization failure, decryption failure, *etc.*</span></span> |
| <span data-ttu-id="ce8f9-215">**Web請求事件**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-215">**WebRequestEvent**</span></span> | <span data-ttu-id="ce8f9-216">所有資訊請求事件的基類。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-216">The base class for all informational request events.</span></span> |
| <span data-ttu-id="ce8f9-217">**WebBase 錯誤事件**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-217">**WebBaseErrorEvent**</span></span> | <span data-ttu-id="ce8f9-218">指示錯誤條件的所有事件的基類。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-218">The base class for all events indicating error conditions.</span></span> |

<span data-ttu-id="ce8f9-219">可用的提供程式類型允許您將事件輸出發送到事件查看器、SQL 伺服器、Windows 管理檢測 (WMI) 和電子郵件。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-219">The types of providers available allow you to send event output to Event Viewer, SQL Server, Windows Management Instrumentation (WMI), and email.</span></span> <span data-ttu-id="ce8f9-220">預先配置的提供程式和事件映射減少了記錄事件輸出所需的工作量。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-220">The pre-configured providers and event mappings reduce the amount of work necessary to get event output logged.</span></span>

<span data-ttu-id="ce8f9-221">ASP.NET 2.0 使用事件日誌提供程式開箱即用,基於應用程式域啟動和停止來記錄事件,以及記錄任何未處理的異常。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-221">ASP.NET 2.0 uses the Event Log provider out-of-the-box to log events based on application domains starting and stopping, as well as logging any unhandled exceptions.</span></span> <span data-ttu-id="ce8f9-222">這有助於介紹一些基本方案。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-222">This helps to cover some of the basic scenarios.</span></span> <span data-ttu-id="ce8f9-223">例如,假設您的應用程式引發異常,但使用者不保存錯誤,並且無法重現它。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-223">For example, let's say that your application throws an exception, but the user doesn't save the error and you can't reproduce it.</span></span> <span data-ttu-id="ce8f9-224">使用預設事件日誌規則,您將能夠收集異常和堆疊資訊,以便更好地瞭解發生了哪種錯誤。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-224">With the default Event Log rule, you would be able to gather the exception and stack information to get a better idea of what kind of error occurred.</span></span> <span data-ttu-id="ce8f9-225">如果應用程式正在失去會話狀態,則應用另一個示例。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-225">Another example applies if your application is losing session state.</span></span> <span data-ttu-id="ce8f9-226">在這種情況下,您可以在事件日誌中查看以確定應用程式域是否正在回收,以及應用程式域最初停止的原因。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-226">In that case, you can look in the Event Log to determine whether the application domain is recycling, and why the application domain stopped in the first place.</span></span>

<span data-ttu-id="ce8f9-227">此外,健康監測系統是可擴展的。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-227">Also, the health monitoring system is extensible.</span></span> <span data-ttu-id="ce8f9-228">例如,可以定義自訂 Web 事件,在應用程式中觸發這些事件,然後定義一條規則,將事件資訊發送到提供者(如電子郵件)。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-228">For example, you can define custom Web events, fire them within your application, and then define a rule to send the event information to a provider such as your email.</span></span> <span data-ttu-id="ce8f9-229">這允許您輕鬆地將檢測與運行狀況監視提供程式綁定。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-229">This allows you to easily tie your instrumentation to the health monitoring providers.</span></span> <span data-ttu-id="ce8f9-230">作為另一個範例,您可以在每次處理訂單時觸發事件,並設置將每個事件發送到 SQL Server 資料庫的規則。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-230">As another example, you could fire an event each time an order is processed and set up a rule that sends each event to the SQL Server database.</span></span> <span data-ttu-id="ce8f9-231">當用戶連續多次無法登錄時,還可以觸發事件,並將事件設置為使用基於電子郵件的提供程式。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-231">You could also fire an event when a user fails to log on multiple times in a row, and set up the event to use the email-based providers.</span></span>

<span data-ttu-id="ce8f9-232">預設提供程式和事件的配置存儲在全域 Web.config 檔中。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-232">The configuration for the default providers and events is stored in the global Web.config file.</span></span> <span data-ttu-id="ce8f9-233">全域 Web.config 檔案將儲存在 Machine.config 檔中的所有基於 Web 的設定儲存在 ASP.NET 1x 中。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-233">The global Web.config file stores all the Web-based settings that were stored in the Machine.config file in ASP.NET 1x.</span></span> <span data-ttu-id="ce8f9-234">全域 Web.config 檔案位於以下目錄中:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-234">The global Web.config file is located in the following directory:</span></span>

`%windir%\Microsoft.Net\Framework\v2.0.*\config\Web.config`

<span data-ttu-id="ce8f9-235">全域&lt;Web.config 檔的運行狀況&gt;監視 部分提供預設配置設定。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-235">The &lt;healthMonitoring&gt; section of the global Web.config file provides default configuration settings.</span></span> <span data-ttu-id="ce8f9-236">您可以通過在 Web.config 檔中&lt;為應用程式實現&gt;執行狀況監視 部分來覆蓋這些設定或設定您自己的設定。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-236">You can override these setting or configure your own settings by implementing the &lt;healthMonitoring&gt; section in the Web.config file for your application.</span></span>

<span data-ttu-id="ce8f9-237">全域&lt;Web.config 檔的執行狀況&gt;監視 部份包含以下項目:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-237">The &lt;healthMonitoring&gt; section of the global Web.config file contains the following items:</span></span>

| <span data-ttu-id="ce8f9-238">**供應商**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-238">**providers**</span></span> | <span data-ttu-id="ce8f9-239">包含為事件查看器、WMI 和 SQL 伺服器設置的提供程式。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-239">Contains providers set up for the Event Viewer, WMI, and SQL Server.</span></span> |
| --- | --- |
| <span data-ttu-id="ce8f9-240">**事件對應**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-240">**eventMappings**</span></span> | <span data-ttu-id="ce8f9-241">包含各種 WebBase 類的映射。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-241">Contains mappings for the various WebBase classes.</span></span> <span data-ttu-id="ce8f9-242">如果生成自己的事件類,則可以擴展此清單。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-242">You can extend this list if you generate your own event class.</span></span> <span data-ttu-id="ce8f9-243">生成自己的事件類可比向其發送資訊的提供程式提供更精細的粒度。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-243">Generating your own event class gives you finer granularity over the providers you send information to.</span></span> <span data-ttu-id="ce8f9-244">例如,您可以將未處理的異常配置為發送到 SQL Server,同時將您自己的自訂事件發送到電子郵件。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-244">For example, you could configure unhandled exceptions to be sent to SQL Server, while sending your own custom events to email.</span></span> |
| <span data-ttu-id="ce8f9-245">**規則**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-245">**rules**</span></span> | <span data-ttu-id="ce8f9-246">將事件映射連結到提供程式。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-246">Links the eventMappings to the provider.</span></span> |
| <span data-ttu-id="ce8f9-247">**緩衝**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-247">**buffering**</span></span> | <span data-ttu-id="ce8f9-248">與 SQL Server 和電子郵件提供程式一起使用,以確定將事件刷新到提供程式的頻率。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-248">Used with SQL Server and email providers to determine how often to flush the events to the provider.</span></span> |

<span data-ttu-id="ce8f9-249">下面是來自全域 Web.config 檔中的代碼範例。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-249">Below is a code example from the global Web.config file.</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample4.xml)]

## <a name="how-to-store-events-to-event-viewer"></a><span data-ttu-id="ce8f9-250">如何將事件儲存到事件檢視器</span><span class="sxs-lookup"><span data-stu-id="ce8f9-250">How to store events to Event Viewer</span></span>

<span data-ttu-id="ce8f9-251">如前所述,在全域 Web.config 檔中為您配置了用於在事件檢視器中記錄事件提供程式。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-251">As mentioned earlier, the provider for logging events in the Event Viewer is configured for you in the global Web.config file.</span></span> <span data-ttu-id="ce8f9-252">預設情況下,記錄基於**WebBaseErrorEvent**和**Web 失敗稽核事件的所有事件**。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-252">By default, all events based on **WebBaseErrorEvent** and **WebFailureAuditEvent** are logged.</span></span> <span data-ttu-id="ce8f9-253">您可以添加其他規則以將其他資訊記錄到事件日誌。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-253">You can add additional rules to log additional information to the Event Log.</span></span> <span data-ttu-id="ce8f9-254">例如,如果要記錄所有事件(*即*基於**WebBaseEvent**的每個事件),可以向 Web.config 檔新增以下規則:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-254">For example, if you wanted to log all events (*i.e.*, every event based on **WebBaseEvent**), you could add the following rule to your Web.config file:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample5.xml)]

<span data-ttu-id="ce8f9-255">此規則會將 **「所有事件事件**」映射連結到事件日誌提供者。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-255">This rule would link the **All Events** event map to the Event Log provider.</span></span> <span data-ttu-id="ce8f9-256">事件映射和提供者都包含在全域 Web.config 檔中。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-256">Both eventMapping and the provider are included in the global Web.config file.</span></span>

## <a name="how-to-store-events-to-sql-server"></a><span data-ttu-id="ce8f9-257">如何儲存的事件儲存到 SQL 伺服器</span><span class="sxs-lookup"><span data-stu-id="ce8f9-257">How to store events to SQL Server</span></span>

<span data-ttu-id="ce8f9-258">此方法使用**ASPNETDB**資料庫,該資料庫由\_Aspnet regsql.exe 工具生成。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-258">This method uses the **ASPNETDB** database, which is generated by the Aspnet\_regsql.exe tool.</span></span> <span data-ttu-id="ce8f9-259">預設提供程式使用 LocalSqlServer 連接字串,該字串使用應用\_資料資料夾中的基於檔案的資料庫或 SQL Server 的本地 SQLExpress 實例。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-259">The default provider uses the LocalSqlServer connection string, which uses either a file-based database in the App\_data folder or the local SQLExpress instance of SQL Server.</span></span> <span data-ttu-id="ce8f9-260">本地SqlServer連接字串和 SqlProvider 都在全域 Web.config 檔中配置。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-260">Both the LocalSqlServer connection string and the SqlProvider are configured in the global Web.config file.</span></span>

<span data-ttu-id="ce8f9-261">全域 Web.config 檔中的 LocalSqlServer 連接字串如下所示:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-261">The LocalSqlServer connection string in the global Web.config file looks like this:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample6.xml)]

<span data-ttu-id="ce8f9-262">如果要使用另一個 SQL Server 實體,則需要使用\_Aspnet regsql.exe 工具,該工具可在 %windir%_Microsoft.Net_Framework_v2.0 中找到。\*資料夾。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-262">If you want to use another SQL Server instance, you'll need to use the Aspnet\_regsql.exe tool, which can be found in the %windir%\Microsoft.Net\Framework\v2.0.\* folder.</span></span> <span data-ttu-id="ce8f9-263">使用 Aspnet\_regsql.exe 工具在 SQL Server 實體上生成自訂**ASPNETDB**資料庫,然後將連接字串添加到應用程式設定檔,然後使用新的連接字串添加提供者。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-263">Use the Aspnet\_regsql.exe tool to generate a custom **ASPNETDB** database on the SQL Server instance, then add the connection string to your applications configuration file, and then add a provider by using the new connection string.</span></span> <span data-ttu-id="ce8f9-264">創建**ASPNETDB**資料庫後,需要設定規則以將事件映射連結到 sqlProvider。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-264">Once you have the **ASPNETDB** database created, you'll need to set a rule to link an eventMapping to the sqlProvider.</span></span>

<span data-ttu-id="ce8f9-265">無論是使用預設 SqlProvider 還是配置自己的提供程式,都需要添加一條規則,將提供程式與事件映射連結。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-265">Whether you use the default SqlProvider or configure your own provider, you'll need to add a rule linking the provider with an event map.</span></span> <span data-ttu-id="ce8f9-266">以下規則將上面創建的新提供程式連結到 **「所有事件」** 事件映射。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-266">The following rule links the new provider that you created above to the **All Events** event map.</span></span> <span data-ttu-id="ce8f9-267">此規則將基於**WebBaseEvent**記錄所有事件,並將它們發送到將使用 MYASPNETDB 連接字串的 MySqlWebEvent 提供程式。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-267">This rule will log all the events based on **WebBaseEvent** and send them to the MySqlWebEventProvider that will use the MYASPNETDB connection string.</span></span> <span data-ttu-id="ce8f9-268">以下代碼新增了一條規則,用於將提供程式與事件映射連結:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-268">The following code adds a rule to link the provider with an event map:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample7.xml)]

<span data-ttu-id="ce8f9-269">如果只想向 SQL Server 傳送錯誤,可以新增以下規則:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-269">If you wanted to only send errors to SQL Server, you could add the following rule:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample8.xml)]

## <a name="how-to-forward-events-to-wmi"></a><span data-ttu-id="ce8f9-270">如何將事件轉寄到 WMI</span><span class="sxs-lookup"><span data-stu-id="ce8f9-270">How to forward events to WMI</span></span>

<span data-ttu-id="ce8f9-271">您還可以將事件轉發到 WMI。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-271">You can also forward the events to WMI.</span></span> <span data-ttu-id="ce8f9-272">預設情況下,WMI 提供程式在全域 Web.config 檔中為您配置。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-272">The WMI provider is configured for you in the global Web.config file by default.</span></span>

<span data-ttu-id="ce8f9-273">以下代碼範例新增一條規則以將事件轉寄到 WMI:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-273">The following code example adds a rule to forward the events to WMI:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample9.xml)]

<span data-ttu-id="ce8f9-274">您需要添加一個規則來將事件映射關聯到提供者,以及一個 WMI 偵聽器應用程式來偵聽事件。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-274">You will need to add a rule to associate an eventMapping to the provider, and also a WMI listener application to listen for the events.</span></span> <span data-ttu-id="ce8f9-275">以下代碼範例新增一條規則,將 WMI 提供程式連結到 **「所有事件」** 事件映射:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-275">The following code example adds a rule to link the WMI provider to the **All Events** event map:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample10.xml)]

## <a name="how-to-forward-events-to-email"></a><span data-ttu-id="ce8f9-276">如何將事件轉寄到電子郵件</span><span class="sxs-lookup"><span data-stu-id="ce8f9-276">How to forward events to email</span></span>

<span data-ttu-id="ce8f9-277">您還可以將事件轉發給電子郵件。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-277">You can also forward events to email.</span></span> <span data-ttu-id="ce8f9-278">請注意您映射到電子郵件供應商的事件規則,因為您可能會無意中向自己發送大量可能更適合 SQL Server 或事件日誌的資訊。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-278">Be careful about which event rules you map to your email provider, as you can unintentionally send yourself a lot of information that may be better suited for SQL Server or the Event Log.</span></span> <span data-ttu-id="ce8f9-279">有兩個電子郵件供應商;簡單郵件Web事件供應商和範本郵件Web事件供應商。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-279">There are two email providers; SimpleMailWebEventProvider and TemplatedMailWebEventProvider.</span></span> <span data-ttu-id="ce8f9-280">每個屬性具有相同的配置屬性,但「範本」和「詳細範本錯誤」屬性除外,這兩個屬性僅在範本IdmailWebEvent提供程式上可用。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-280">Each has the same configuration attributes, with the exception of the "template" and "detailedTemplateErrors" attributes, both of which are only available on the TemplatedMailWebEventProvider.</span></span>

> [!NOTE]
> <span data-ttu-id="ce8f9-281">這些電子郵件提供程式均未為您配置。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-281">Neither of these email providers is configured for you.</span></span> <span data-ttu-id="ce8f9-282">您需要將它們添加到 Web.config 檔中。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-282">You'll need to add them to your Web.config file.</span></span>

<span data-ttu-id="ce8f9-283">這兩個電子郵件供應商之間的主要區別是 SimpleMailWebEventProvider 在無法修改的通用範本中發送電子郵件。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-283">The main difference between these two email providers is that SimpleMailWebEventProvider sends emails in a generic template that cannot be modified.</span></span> <span data-ttu-id="ce8f9-284">範例 Web.config 檔案使用以下規則將此電子郵件提供者新增到已設定提供者清單中:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-284">The sample Web.config file adds this email provider to the list of configured providers by using the following rule:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample11.xml)]

<span data-ttu-id="ce8f9-285">還會新增以下規則以將電子郵件提供程式綁定到 **「所有事件」** 事件映射:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-285">The following rule is also added to tie the email provider to the **All Events** event map:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample12.xml)]

## <a name="aspnet-20-tracing"></a><span data-ttu-id="ce8f9-286">ASP.NET 2.0 追蹤</span><span class="sxs-lookup"><span data-stu-id="ce8f9-286">ASP.NET 2.0 Tracing</span></span>

<span data-ttu-id="ce8f9-287">在 2.0 ASP.NET中,跟蹤有三個主要增強功能。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-287">There are three major enhancements to tracing in ASP.NET 2.0.</span></span>

1. <span data-ttu-id="ce8f9-288">整合追蹤功能</span><span class="sxs-lookup"><span data-stu-id="ce8f9-288">Integrated tracing functionality</span></span>
2. <span data-ttu-id="ce8f9-289">追蹤訊息的程式設計存取</span><span class="sxs-lookup"><span data-stu-id="ce8f9-289">Programmatic access to trace messages</span></span>
3. <span data-ttu-id="ce8f9-290">改進應用程式級追蹤</span><span class="sxs-lookup"><span data-stu-id="ce8f9-290">Improved application-level tracing</span></span>

## <a name="integrated-tracing-functionality"></a><span data-ttu-id="ce8f9-291">整合追蹤功能</span><span class="sxs-lookup"><span data-stu-id="ce8f9-291">Integrated Tracing Functionality</span></span>

<span data-ttu-id="ce8f9-292">現在,您可以將 System.Diagnostics.Trace 類發出的消息路由到ASP.NET跟蹤輸出,並將ASP.NET跟蹤發送的消息路由到 System.診斷.Trace。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-292">You can now route messages emitted by the System.Diagnostics.Trace class to ASP.NET tracing output, and route messages emitted by ASP.NET tracing to System.Diagnostics.Trace.</span></span> <span data-ttu-id="ce8f9-293">您還可以將ASP.NET檢測事件轉發到 System.診斷.Trace。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-293">You can also forward ASP.NET instrumentation events to System.Diagnostics.Trace.</span></span> <span data-ttu-id="ce8f9-294">此功能由&lt;追蹤&gt;元素的新**writeTo診斷追蹤**屬性提供。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-294">This functionality is provided by the new **writeToDiagnosticsTrace** attribute of the &lt;trace&gt; element.</span></span> <span data-ttu-id="ce8f9-295">當此布爾值為 true 時,ASP.NET跟蹤消息將轉發到 System.診斷跟蹤基礎結構,供註冊以顯示 Trace 消息的任何偵聽器使用。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-295">When this Boolean value is true, ASP.NET Trace messages are forwarded to the System.Diagnostics tracing infrastructure for use by any listeners that are registered to display Trace messages.</span></span>

## <a name="programmatic-access-to-trace-messages"></a><span data-ttu-id="ce8f9-296">追蹤訊息的程式設計存取</span><span class="sxs-lookup"><span data-stu-id="ce8f9-296">Programmatic Access to Trace Messages</span></span>

<span data-ttu-id="ce8f9-297">ASP.NET 2.0 允許透過**TraceContextRecord**類和**追蹤記錄**集合對所有追蹤訊息進行程式設計存取。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-297">ASP.NET 2.0 allows for programmatic access to all trace messages via the **TraceContextRecord** class and the **TraceRecords** collection.</span></span> <span data-ttu-id="ce8f9-298">訪問跟蹤消息的最有效方法是註冊**TraceContextEventHandler**委託(ASP.NET 2.0 中也是新的)來處理新的**跟蹤完成**事件。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-298">The most efficient way of accessing trace messages is to register a **TraceContextEventHandler** delegate (also new in ASP.NET 2.0) to handle the new **TraceFinished** event.</span></span> <span data-ttu-id="ce8f9-299">然後,您可以根據需要循環訪問跟蹤消息。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-299">You can then loop through the trace messages as you wish.</span></span>

<span data-ttu-id="ce8f9-300">以下代碼範例說明瞭這一點:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-300">The following code sample illustrates this:</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample13.cs)]

<span data-ttu-id="ce8f9-301">在上面的示例中,我循環流覽跟蹤記錄集合,然後將每條消息寫入回應流。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-301">In the above example, I loop through the TraceRecords collection and then write each message to the Response stream.</span></span>

## <a name="improved-application-level-tracing"></a><span data-ttu-id="ce8f9-302">改進應用程式級追蹤</span><span class="sxs-lookup"><span data-stu-id="ce8f9-302">Improved Application-Level Tracing</span></span>

<span data-ttu-id="ce8f9-303">通過引入&lt;&gt;追蹤 元素的新**最新**屬性,應用程式級跟蹤得到了改進。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-303">Application-level tracing is improved via the introduction of the new **mostRecent** attribute of the &lt;trace&gt; element.</span></span> <span data-ttu-id="ce8f9-304">此屬性指定是否顯示最新的應用程式級跟蹤輸出,是否丟棄超出請求Limit 指示限制的較舊跟蹤數據。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-304">This attribute specifies whether the most recent application-level tracing output is displayed and older trace data beyond the limits that are indicated by the requestLimit are discarded.</span></span> <span data-ttu-id="ce8f9-305">如果為 false,則在達到請求 Limit 屬性之前,將顯示請求的追蹤數據。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-305">If false, trace data are displayed for requests until the requestLimit attribute is reached.</span></span>

## <a name="aspnet-command-line-tools"></a><span data-ttu-id="ce8f9-306">ASP.NET 命令列工具</span><span class="sxs-lookup"><span data-stu-id="ce8f9-306">ASP.NET Command Line Tools</span></span>

<span data-ttu-id="ce8f9-307">有幾個命令列工具可以説明配置ASP.NET。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-307">There are several command-line tools to aid in configuration of ASP.NET.</span></span> <span data-ttu-id="ce8f9-308">ASP.NET開發人員應該熟悉 aspnet\_regiis.exe 工具。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-308">ASP.NET developers should be familiar with the aspnet\_regiis.exe tool.</span></span> <span data-ttu-id="ce8f9-309">ASP.NET 2.0 提供了另外三個命令列工具,以説明配置。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-309">ASP.NET 2.0 provides three other command-line tools to aid in configuration.</span></span>

<span data-ttu-id="ce8f9-310">以下命令列工具可用:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-310">The following command-line tools are available:</span></span>

| <span data-ttu-id="ce8f9-311">**工具**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-311">**Tool**</span></span> | <span data-ttu-id="ce8f9-312">**使用**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-312">**Use**</span></span> |
| --- | --- |
| <span data-ttu-id="ce8f9-313">**阿斯普內\_雷吉斯.exe**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-313">**aspnet\_regiis.exe**</span></span> | <span data-ttu-id="ce8f9-314">允許在IIS註冊ASP.NET。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-314">Allows for registration of ASP.NET with IIS.</span></span> <span data-ttu-id="ce8f9-315">此工具有兩個版本附帶 ASP.NET 2.0,一個用於 32 位元系統(在 Framework 資料夾中),另一個用於 64 位元系統(在 Framework64 資料夾中)。64 位元版本將不會安裝在 32 位元作業系統上。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-315">There are two versions of this tools that ship with ASP.NET 2.0, one for 32-bit systems (in the Framework folder) and one for 64-bit systems (in the Framework64 folder.) The 64-bit version will not be installed on a 32-bit OS.</span></span> |
| <span data-ttu-id="ce8f9-316">**阿斯普內\_雷格斯**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-316">**aspnet\_regsql.exe**</span></span> | <span data-ttu-id="ce8f9-317">ASP.NET SQL Server 註冊工具用於建立 Microsoft SQL Server 資料庫,供 ASP.NET中的 SQL Server 提供者使用,或從現有資料庫中添加或刪除選項。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-317">The ASP.NET SQL Server Registration tool is used to create a Microsoft SQL Server database for use by the SQL Server providers in ASP.NET, or to add or remove options from an existing database.</span></span> <span data-ttu-id="ce8f9-318">Aspnet\_regsql.exe 檔案位於 Web 伺服器上的 [驅動器:]WINDOWS_Microsoft.NET_Framework_versionNumber 資料夾中。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-318">The Aspnet\_regsql.exe file is located in the [drive:]\WINDOWS\Microsoft.NET\Framework\versionNumber folder on your Web server.</span></span> |
| <span data-ttu-id="ce8f9-319">**阿斯普內\_註冊瀏覽器.exe**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-319">**aspnet\_regbrowsers.exe**</span></span> | <span data-ttu-id="ce8f9-320">ASP.NET瀏覽器註冊工具將所有系統範圍的瀏覽器定義解析和編譯到程式集中,並將程式集安裝到全域程式集緩存中。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-320">The ASP.NET Browser Registration tool parses and compiles all system-wide browser definitions into an assembly and installs the assembly into the global assembly cache.</span></span> <span data-ttu-id="ce8f9-321">該工具使用瀏覽器定義檔 (。BROWSER 檔案)來自 .NET 框架瀏覽器子目錄。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-321">The tool uses the browser definition files (.BROWSER files) from the .NET Framework Browsers subdirectory.</span></span> <span data-ttu-id="ce8f9-322">該工具可以在 %SystemRoot%\Microsoft.NET_Framework_version_目錄中找到。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-322">The tool can be found in the %SystemRoot%\Microsoft.NET\Framework\version\ directory.</span></span> |
| <span data-ttu-id="ce8f9-323">**阿斯普內\_編譯器.exe**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-323">**aspnet\_compiler.exe**</span></span> | <span data-ttu-id="ce8f9-324">ASP.NET編譯工具使您能夠編譯ASP.NET Web 應用程式,無論是就位還是部署到目標位置(如生產伺服器)。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-324">The ASP.NET Compilation tool enables you to compile an ASP.NET Web application, either in place or for deployment to a target location such as a production server.</span></span> <span data-ttu-id="ce8f9-325">就地編譯有助於應用程式性能,因為最終使用者在編譯應用程式時不會遇到對應用程式的第一個請求的延遲。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-325">In-place compilation helps application performance because end users do not encounter a delay on the first request to the application while the application is compiled.</span></span> |

<span data-ttu-id="ce8f9-326">由於 aspnet\_regiis.exe 工具對於 ASP.NET 2.0 並不新鮮,因此我們不會在此處討論它。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-326">Because the aspnet\_regiis.exe tool is not new to ASP.NET 2.0, we will not discuss it here.</span></span>

## <a name="aspnet-sql-server-registration-tool---aspnet_regsqlexe"></a><span data-ttu-id="ce8f9-327">ASP.NET SQL 伺服器註冊\_工具 - aspnet regsql.exe</span><span class="sxs-lookup"><span data-stu-id="ce8f9-327">ASP.NET SQL Server Registration Tool - aspnet\_regsql.exe</span></span>

<span data-ttu-id="ce8f9-328">您可以使用ASP.NET SQL 伺服器註冊工具設置多種類型的選項。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-328">You can set several types of options using the ASP.NET SQL Server Registration tool.</span></span> <span data-ttu-id="ce8f9-329">可以指定 SQL 連接,指定哪些 ASP.NET 應用程式服務使用 SQL Server 來管理資訊,指示哪個資料庫或表用於 SQL 快取依賴項,以及添加或刪除對使用 SQL Server 儲存過程和工作階段狀態的支援。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-329">You can specify a SQL connection, specify which ASP.NET application services use SQL Server to manage information, indicate which database or table is used for SQL cache dependency, and add or remove support for using SQL Server to store procedures and session state.</span></span>

<span data-ttu-id="ce8f9-330">多個ASP.NET應用程式服務依賴於提供程式來管理從資料源存儲和檢索數據。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-330">Several ASP.NET application services rely on a provider to manage storing and retrieving data from a data source.</span></span> <span data-ttu-id="ce8f9-331">每個提供程式都特定於數據源。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-331">Each provider is specific to the data source.</span></span> <span data-ttu-id="ce8f9-332">ASP.NET包括用於以下ASP.NET功能的 SQL Server 提供者:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-332">ASP.NET includes a SQL Server provider for the following ASP.NET features:</span></span>

- <span data-ttu-id="ce8f9-333">成員資格[(Sqlsasprovider](https://msdn.microsoft.com/library/system.web.security.sqlmembershipprovider.aspx)類)。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-333">Membership (the [SqlMembershipProvider](https://msdn.microsoft.com/library/system.web.security.sqlmembershipprovider.aspx) class).</span></span>
- <span data-ttu-id="ce8f9-334">角色管理[(SqlRole Provider](https://msdn.microsoft.com/library/system.web.security.sqlroleprovider.aspx)類)。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-334">Role Management (the [SqlRoleProvider](https://msdn.microsoft.com/library/system.web.security.sqlroleprovider.aspx) class).</span></span>
- <span data-ttu-id="ce8f9-335">設定檔[(SqlProfile Provider](https://msdn.microsoft.com/library/system.web.profile.sqlprofileprovider.aspx)類)。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-335">Profile (the [SqlProfileProvider](https://msdn.microsoft.com/library/system.web.profile.sqlprofileprovider.aspx) class).</span></span>
- <span data-ttu-id="ce8f9-336">Web 部件個人化[(Sql 個人化提供程式](https://msdn.microsoft.com/library/system.web.ui.webcontrols.webparts.sqlpersonalizationprovider.aspx)類)。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-336">Web Parts Personalization (the [SqlPersonalizationProvider](https://msdn.microsoft.com/library/system.web.ui.webcontrols.webparts.sqlpersonalizationprovider.aspx) class).</span></span>
- <span data-ttu-id="ce8f9-337">Web 事件[(SqlWebEvent 提供程式](https://msdn.microsoft.com/library/system.web.management.sqlwebeventprovider.aspx)類)。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-337">Web Events (the [SqlWebEventProvider](https://msdn.microsoft.com/library/system.web.management.sqlwebeventprovider.aspx) class).</span></span>

<span data-ttu-id="ce8f9-338">安裝ASP.NET時,伺服器的Machine.config檔包括配置元素,這些元素為依賴於提供程式的每個ASP.NET功能指定SQL Server提供程式。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-338">When you install ASP.NET, the Machine.config file for your server includes configuration elements that specify SQL Server providers for each of the ASP.NET features that rely on a provider.</span></span> <span data-ttu-id="ce8f9-339">默認情況下,這些提供程式配置為連接到 SQL Server Express 2005 的本地使用者實例。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-339">These providers are configured, by default, to connect to a local user instance of SQL Server Express 2005.</span></span> <span data-ttu-id="ce8f9-340">如果更改提供者使用的預設連接字串,則在使用電腦配置中配置的任何ASP.NET功能之前,必須使用 Aspnet\_regsql.exe 安裝 SQL Server 資料庫和所選功能的資料庫元素。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-340">If you change the default connection string used by the providers, then before you can use any of the ASP.NET features configured in the machine configuration, you must install the SQL Server database and the database elements for your chosen feature using Aspnet\_regsql.exe.</span></span> <span data-ttu-id="ce8f9-341">如果使用 SQL 註冊工具指定的資料庫不存在(如果在命令列上未指定資料庫,則 aspnetdb 將是預設資料庫),則當前使用者必須有權在 SQL Server 中創建資料庫以及在資料庫中創建架構元素。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-341">If the database that you specify with the SQL registration tool does not already exist (aspnetdb will be the default database if one is not specified on the command line), then the current user must have rights to create databases in SQL Server as well as to create schema elements within a database.</span></span>

### <a name="sql-cache-dependency"></a><span data-ttu-id="ce8f9-342">SQL 快取相依性</span><span class="sxs-lookup"><span data-stu-id="ce8f9-342">SQL Cache Dependency</span></span>

<span data-ttu-id="ce8f9-343">ASP.NET輸出緩存的高級功能是 SQL 快取依賴項。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-343">An advanced feature of ASP.NET output caching is SQL cache dependency.</span></span> <span data-ttu-id="ce8f9-344">SQL 緩存依賴項支援兩種不同的操作模式:一種是使用表輪詢ASP.NET實現,另一種模式使用 SQL Server 2005 的查詢通知功能。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-344">SQL cache dependency supports two different modes of operation: one that uses an ASP.NET implementation of table polling and a second mode that uses the query notification features of SQL Server 2005.</span></span> <span data-ttu-id="ce8f9-345">SQL 註冊工具可用於配置表輪詢操作模式。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-345">The SQL registration tool can be used to configure the table-polling mode of operation.</span></span>

### <a name="session-state"></a><span data-ttu-id="ce8f9-346">工作階段狀態</span><span class="sxs-lookup"><span data-stu-id="ce8f9-346">Session State</span></span>

<span data-ttu-id="ce8f9-347">默認情況下,會話狀態值和資訊存儲在ASP.NET進程中的記憶體中。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-347">By default, session state values and information are stored in memory within the ASP.NET process.</span></span> <span data-ttu-id="ce8f9-348">或者,您可以將會話數據存儲在 SQL Server 資料庫中,其中會話數據可以由多個 Web 伺服器共用。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-348">Alternatively, you can store session data in a SQL Server database, where it can be shared by multiple Web servers.</span></span> <span data-ttu-id="ce8f9-349">如果使用 SQL 註冊工具為工作階段狀態指定的資料庫不存在,則當前使用者必須有權在 SQL Server 中創建資料庫以及在資料庫中創建架構元素。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-349">If the database that you specify for session state with the SQL registration tool does not already exist, then the current user must have rights to create databases in SQL Server as well as to create schema elements within a database.</span></span> <span data-ttu-id="ce8f9-350">如果資料庫確實存在,則當前用戶必須有權在現有資料庫中創建架構元素。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-350">If the database does exist, then the current user must have rights to create schema elements in the existing database.</span></span>

<span data-ttu-id="ce8f9-351">在 SQL Server 上安裝工作階段狀態資料庫\_,請執行 Aspnet regsql.exe 工具,並隨命令提供以下資訊:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-351">To install the session state database on SQL Server, run the Aspnet\_regsql.exe tool and supply the following information with the command:</span></span>

- <span data-ttu-id="ce8f9-352">使用 **-S**選項的 SQL Server 實體名稱。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-352">The name of the SQL Server instance, using the **-S** option.</span></span>
- <span data-ttu-id="ce8f9-353">具有在運行 SQL Server 的電腦上創建資料庫的許可權的帳戶的登錄認證。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-353">The logon credentials for an account that has permission to create a database on a computer running SQL Server.</span></span> <span data-ttu-id="ce8f9-354">使用 **-E**選項使用目前登入的使用者,或使用 **-U**選項指定使用者 ID 以及 **-P**選項來指定密碼。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-354">Use the **-E** option to use the currently logged-on user, or use the **-U** option to specify a user ID along with the **-P** option to specify a password.</span></span>
- <span data-ttu-id="ce8f9-355">**-ssadd**命令行選項用於添加會話狀態資料庫。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-355">The **-ssadd** command-line option to add the session state database.</span></span>

<span data-ttu-id="ce8f9-356">預設情況下,不能使用 Aspnet\_regsql.exe 工具在運行 SQL Server 2005 Express 版的電腦上安裝作業階段狀態資料庫。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-356">By default, you cannot use the Aspnet\_regsql.exe tool to install the session state database on a computer running SQL Server 2005 Express Edition.</span></span>

### <a name="the-aspnet-browser-registration-tool---aspnet_regbrowsersexe"></a><span data-ttu-id="ce8f9-357">ASP.NET瀏覽器註冊工具 -\_阿斯網 註冊瀏覽器.exe</span><span class="sxs-lookup"><span data-stu-id="ce8f9-357">The ASP.NET Browser Registration Tool - aspnet\_regbrowsers.exe</span></span>

<span data-ttu-id="ce8f9-358">在ASP.NET版本 1.1 中,Machine.config&lt;檔&gt;包含一個稱為瀏覽器Cap 的部分。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-358">In ASP.NET version 1.1, the Machine.config file contained a section called &lt;browserCaps&gt;.</span></span> <span data-ttu-id="ce8f9-359">本節包含一系列 XML 條目,這些條目根據正則表達式定義了各種瀏覽器的配置。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-359">This section contained a series of XML entries that defined the configurations for various browsers based on a regular expression.</span></span> <span data-ttu-id="ce8f9-360">對於ASP.NET版本 2.0,一個新的 。BROWSER 檔案使用 XML 項目定義特定瀏覽器的參數。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-360">For ASP.NET version 2.0, a new .BROWSER file defines the parameters of a particular browser using XML entries.</span></span> <span data-ttu-id="ce8f9-361">通過添加新 的瀏覽器,可以添加新 瀏覽器上的資訊。BROWSER 檔案到位於系統上 %SystemRoot%_Microsoft.NET_Framework_conFIG_瀏覽器的資料夾。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-361">You add information on a new browser by adding a new .BROWSER file to the folder located at %SystemRoot%\Microsoft.NET\Framework\version\CONFIG\Browsers on your system.</span></span>

<span data-ttu-id="ce8f9-362">因為應用程式每次需要瀏覽器資訊時都未讀取 .config 檔案,因此您可以建立新的 。BROWSER 檔和執行 Aspnet\_註冊瀏覽器.exe 以向程式集添加所需的更改。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-362">Because an application is not reading a .config file every time it requires browser information, you can create a new .BROWSER file and run Aspnet\_regbrowsers.exe to add the required changes to the assembly.</span></span> <span data-ttu-id="ce8f9-363">這允許伺服器立即存取新的瀏覽器資訊,因此您不必關閉任何應用程式來獲取資訊。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-363">This allows the server to access the new browser information immediately so you do not have to shut down any of your applications to pick up the information.</span></span> <span data-ttu-id="ce8f9-364">應用程式可以通過當前 HttpRequest 的瀏覽器屬性訪問瀏覽器功能。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-364">An application can access browser capabilities through the Browser property of the current HttpRequest.</span></span>

<span data-ttu-id="ce8f9-365">執行 aspnet\_regbrowser.exe 時,以下選項可用:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-365">The following options are available when running aspnet\_regbrowser.exe:</span></span>

| <span data-ttu-id="ce8f9-366">**選項**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-366">**Option**</span></span> | <span data-ttu-id="ce8f9-367">**說明**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-367">**Description**</span></span> |
| --- | --- |
| <span data-ttu-id="ce8f9-368">**-?**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-368">**-?**</span></span> | <span data-ttu-id="ce8f9-369">在命令視窗中顯示\_Aspnet regb 瀏覽器.exe 幫助文字。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-369">Displays the Aspnet\_regbbrowsers.exe Help text in the command window.</span></span> |
| <span data-ttu-id="ce8f9-370">**-i**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-370">**-i**</span></span> | <span data-ttu-id="ce8f9-371">建立運行時瀏覽器功能程式集並將其安裝到全域程式集緩存中。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-371">Creates the runtime browser capabilities assembly and installs it in the global assembly cache.</span></span> |
| <span data-ttu-id="ce8f9-372">**-u**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-372">**-u**</span></span> | <span data-ttu-id="ce8f9-373">從全域程式集緩存卸載運行時瀏覽器功能程式集。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-373">Uninstalls the runtime browser capabilities assembly from the global assembly cache.</span></span> |

## <a name="the-aspnet-compilation-tool---aspnet_compilerexe"></a><span data-ttu-id="ce8f9-374">ASP.NET編譯工具 -\_阿斯普 內編譯器.exe</span><span class="sxs-lookup"><span data-stu-id="ce8f9-374">The ASP.NET Compilation Tool - aspnet\_compiler.exe</span></span>

<span data-ttu-id="ce8f9-375">ASP.NET編譯工具可通過兩種常規方式使用:用於就地編譯和編譯以進行部署,其中指定了目標輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-375">The ASP.NET Compilation tool can be used in two general ways: for in-place compilation and compilation for deployment, where a target output directory is specified.</span></span>

### <a name="compiling-an-application-in-place"></a>[<span data-ttu-id="ce8f9-376">編譯就地的應用程式</span><span class="sxs-lookup"><span data-stu-id="ce8f9-376">Compiling an Application in Place</span></span>](https://msdn.microsoft.com/library/ms229863.aspx)

<span data-ttu-id="ce8f9-377">ASP.NET編譯工具可以就地編譯應用程式,即模仿對應用程式發出多個請求的行為,從而導致定期編譯。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-377">The ASP.NET Compilation tool can compile an application in place, that is, it mimics the behavior of making multiple requests to the application, thus causing regular compilation.</span></span> <span data-ttu-id="ce8f9-378">預編譯網站的使用者不會因為在第一次請求時編譯頁面而遇到延遲。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-378">Users of a pre-compiled site will not experience a delay caused by compiling the page on first request.</span></span>

<span data-ttu-id="ce8f9-379">在就位預編譯網站時,應用以下項:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-379">When you precompile a site in place, the following items apply:</span></span>

- <span data-ttu-id="ce8f9-380">該網站保留其文件和目錄結構。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-380">The site retains its files and directory structure.</span></span>
- <span data-ttu-id="ce8f9-381">您必須具有伺服器上站點使用的所有程式設計語言的編譯器。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-381">You must have compilers for all programming languages used by the site on the server.</span></span>
- <span data-ttu-id="ce8f9-382">如果任何檔編譯失敗,則整個網站將失敗編譯。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-382">If any file fails compilation, the entire site fails compilation.</span></span>

<span data-ttu-id="ce8f9-383">在向應用程式添加新源檔後,還可以重新編譯應用程式。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-383">You can also recompile an application in place after adding new source files to it.</span></span> <span data-ttu-id="ce8f9-384">該工具僅編譯新的或更改的檔案,除非您包含 **-c**選項。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-384">The tool compiles only the new or changed files unless you include the **-c** option.</span></span>

> [!NOTE]
> <span data-ttu-id="ce8f9-385">包含嵌套應用程式的應用程式的編譯不會編譯嵌套應用程式。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-385">Compilation of an application that contains a nested application does not compile the nested application.</span></span> <span data-ttu-id="ce8f9-386">嵌套應用程序必須單獨編譯。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-386">The nested application must be compiled separately.</span></span>

### <a name="compiling-an-application-for-deployment"></a>[<span data-ttu-id="ce8f9-387">編譯應用程式進行部署</span><span class="sxs-lookup"><span data-stu-id="ce8f9-387">Compiling an Application for Deployment</span></span>](https://msdn.microsoft.com/library/ms229863.aspx)

<span data-ttu-id="ce8f9-388">通過指定目標Dir參數,編譯用於部署的應用程式(編譯到目標位置)。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-388">You compile an application for deployment (compilation to a target location) by specifying the targetDir parameter.</span></span> <span data-ttu-id="ce8f9-389">目標 Dir 可以是 Web 應用程式的最終位置,也可以進一步部署編譯的應用程式。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-389">The targetDir can be the final location for the Web application, or the compiled application can be further deployed.</span></span> <span data-ttu-id="ce8f9-390">使用 **-u**選項編譯應用程式的方式,您可以更改編譯應用程式中的某些檔,而無需重新編譯它。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-390">Using the **-u** option compiles the application in such a way that you can make changes to certain files in the compiled application without recompiling it.</span></span> <span data-ttu-id="ce8f9-391">Aspnet\_編譯器.exe 區分靜態和動態文件類型,並在創建生成的應用程式時以不同的方式處理它們。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-391">Aspnet\_compiler.exe makes a distinction between static and dynamic file types, and handles them differently when creating the resulting application.</span></span>

- <span data-ttu-id="ce8f9-392">靜態檔類型是那些沒有關聯的編譯器或生成提供程式的檔,例如其命名具有擴展名的檔,如 .css、.gif、.htm、.html、.jpg、.js 等。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-392">Static file types are those that do not have an associated compiler or build provider, such as files whose named have extensions such as .css, .gif, .htm, .html, .jpg, .js and so on.</span></span> <span data-ttu-id="ce8f9-393">這些檔只是複製到目標位置,並保留其在目錄結構中的相對位置。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-393">These files are simply copied to the target location, with their relative places in the directory structure preserved.</span></span>
- <span data-ttu-id="ce8f9-394">動態檔類型是具有關聯編譯器或生成提供程式的檔,包括具有ASP.NET特定檔名擴展名的檔,如 .asax、.ascx、.ashx、.aspx、.browser、.master 等。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-394">Dynamic file types are those that have an associated compiler or build provider, including files with ASP.NET-specific file name extensions such as .asax, .ascx, .ashx, .aspx, .browser, .master, and so on.</span></span> <span data-ttu-id="ce8f9-395">ASP.NET編譯工具從這些檔生成程式集。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-395">The ASP.NET Compilation tool generates assemblies from these files.</span></span> <span data-ttu-id="ce8f9-396">如果省略 **-u**選項,該工具還會創建檔案名擴展名的檔。將原始源檔映射到其程式集的 COMPILE。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-396">If the **-u** option is omitted, the tool also creates files with the file name extension .COMPILED that map the original source files to their assembly.</span></span> <span data-ttu-id="ce8f9-397">為了確保保留應用程式源的目錄結構,該工具會在目標應用程式中的相應位置生成占位符檔。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-397">To ensure that the directory structure of the application source is preserved, the tool generates placeholder files in the corresponding locations in the target application.</span></span>

<span data-ttu-id="ce8f9-398">您必須使用 **-u**選項來指示可以修改已編譯應用程式的內容。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-398">You must use the **-u** option to indicate that the content of the compiled application can be modified.</span></span> <span data-ttu-id="ce8f9-399">否則,後續修改將被忽略或導致運行時錯誤。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-399">Otherwise, subsequent modifications are ignored or cause run-time errors.</span></span>

<span data-ttu-id="ce8f9-400">下表描述了在包含 **-u**選項時,ASP.NET編譯工具如何處理不同的檔案類型。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-400">The following table describes how the ASP.NET Compilation tool handles different file types when the **-u** option is included.</span></span>

| <span data-ttu-id="ce8f9-401">**檔案類型**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-401">**File type**</span></span> | <span data-ttu-id="ce8f9-402">**編譯器操作**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-402">**Compiler action**</span></span> |
| --- | --- |
| <span data-ttu-id="ce8f9-403">.ascx, .aspx, .master</span><span class="sxs-lookup"><span data-stu-id="ce8f9-403">.ascx, .aspx, .master</span></span> | <span data-ttu-id="ce8f9-404">這些檔被拆分為標記和原始程式碼,其中包括代碼背後的檔和包含在腳本 runat_「server」&lt;&gt;元素中的任何代碼。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-404">These files are split into markup and source code, which includes both code-behind files and any code that is enclosed in &lt;script runat="server"&gt; elements.</span></span> <span data-ttu-id="ce8f9-405">原始程式碼被編譯成程式集,名稱派生自哈希演演演算法,並且程式集放置在 Bin 目錄中。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-405">Source code is compiled into assemblies, with names that are derived from a hashing algorithm, and the assemblies are placed in the Bin directory.</span></span> <span data-ttu-id="ce8f9-406">任何內聯代碼,即包含在 括**&lt;** 弧**%** 和 括弧之間的代碼,都包含在標記中,並且未編譯。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-406">Any inline code, that is, code enclosed between the **&lt;%** and **%&gt;** brackets, is included with markup and not compiled.</span></span> <span data-ttu-id="ce8f9-407">建立與源檔同名的新檔以包含標記並放置在相應的輸出目錄中。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-407">New files with the same name as the source files are created to contain the markup and placed in the corresponding output directories.</span></span> |
| <span data-ttu-id="ce8f9-408">.ashx, .asmx</span><span class="sxs-lookup"><span data-stu-id="ce8f9-408">.ashx, .asmx</span></span> | <span data-ttu-id="ce8f9-409">這些檔不會編譯,並且會移動到輸出目錄,以現在和未編譯。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-409">These files are not compiled and are moved to the output directories as is and not compiled.</span></span> <span data-ttu-id="ce8f9-410">如果希望編譯處理程式代碼,請將代碼放入\_App Code 目錄中的原始程式碼檔中。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-410">If you wish to have the handler code compiled, place the code into source code files in the App\_Code directory.</span></span> |
| <span data-ttu-id="ce8f9-411">.cs, .vb, .jsl, .cpp (不包括前面列出的檔案類型的代碼後檔案)</span><span class="sxs-lookup"><span data-stu-id="ce8f9-411">.cs, .vb, .jsl, .cpp (not including code-behind files for the file types listed earlier)</span></span> | <span data-ttu-id="ce8f9-412">這些檔被編譯並作為引用它們的程式集中的資源包含在其中。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-412">These files are compiled and included as a resource in assemblies that reference them.</span></span> <span data-ttu-id="ce8f9-413">源檔不會複製到輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-413">Source files are not copied to the output directory.</span></span> <span data-ttu-id="ce8f9-414">如果未引用代碼檔,則不編譯它。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-414">If a code file is not referenced, it is not compiled.</span></span> |
| <span data-ttu-id="ce8f9-415">自訂檔案類型</span><span class="sxs-lookup"><span data-stu-id="ce8f9-415">Custom file types</span></span> | <span data-ttu-id="ce8f9-416">這些檔未編譯。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-416">These files are not compiled.</span></span> <span data-ttu-id="ce8f9-417">這些檔將複製到相應的輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-417">These files are copied to the corresponding output directories.</span></span> |
| <span data-ttu-id="ce8f9-418">套\_用程式碼子目錄中的原始碼檔案</span><span class="sxs-lookup"><span data-stu-id="ce8f9-418">Source code files in the App\_Code subdirectory</span></span> | <span data-ttu-id="ce8f9-419">這些檔被編譯成程式集並放置在 Bin 目錄中。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-419">These files are compiled into assemblies and placed in the Bin directory.</span></span> |
| <span data-ttu-id="ce8f9-420">.resx 和 .資源\_檔案在 套用全域資源子目錄</span><span class="sxs-lookup"><span data-stu-id="ce8f9-420">.resx and .resource files in the App\_GlobalResources subdirectory</span></span> | <span data-ttu-id="ce8f9-421">這些檔被編譯成程式集並放置在 Bin 目錄中。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-421">These files are compiled into assemblies and placed in the Bin directory.</span></span> <span data-ttu-id="ce8f9-422">在主\_輸出目錄下不建立應用全域資源子目錄,並且源目錄中的 .resx 或 .resource 檔不會複製到輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-422">No App\_GlobalResources subdirectory is created under the main output directory, and no .resx or .resources files located in the source directory are copied to the output directories.</span></span> |
| <span data-ttu-id="ce8f9-423">.resx 和 .資源\_檔案在套用資源子目錄</span><span class="sxs-lookup"><span data-stu-id="ce8f9-423">.resx and .resource files in the App\_LocalResources subdirectory</span></span> | <span data-ttu-id="ce8f9-424">這些檔不會編譯,並複製到相應的輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-424">These files are not compiled and are copied to the corresponding output directories.</span></span> |
| <span data-ttu-id="ce8f9-425">套\_用 主題子目錄中 .skin 檔案</span><span class="sxs-lookup"><span data-stu-id="ce8f9-425">.skin files in the App\_Themes subdirectory</span></span> | <span data-ttu-id="ce8f9-426">.skin 檔和靜態主題檔不會編譯,並複製到相應的輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-426">The .skin files and static theme files are not compiled and are copied to the corresponding output directories.</span></span> |
| <span data-ttu-id="ce8f9-427">.browser Web.config 靜態檔案類型 程式集已存在於 Bin 目錄中</span><span class="sxs-lookup"><span data-stu-id="ce8f9-427">.browser Web.config Static file types Assemblies already present in the Bin directory</span></span> | <span data-ttu-id="ce8f9-428">這些檔將像一樣複製到輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-428">These files are copied as is to the output directories.</span></span> |

<span data-ttu-id="ce8f9-429">下表描述了在省略 **-u**選項時,ASP.NET編譯工具如何處理不同的文件類型。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-429">The following table describes how the ASP.NET Compilation tool handles different file types when the **-u** option is omitted.</span></span>

| <span data-ttu-id="ce8f9-430">**檔案類型**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-430">**File type**</span></span> | <span data-ttu-id="ce8f9-431">**編譯器操作**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-431">**Compiler action**</span></span> |
| --- | --- |
| <span data-ttu-id="ce8f9-432">.aspx, .asmx, .ashx, .master</span><span class="sxs-lookup"><span data-stu-id="ce8f9-432">.aspx, .asmx, .ashx, .master</span></span> | <span data-ttu-id="ce8f9-433">這些檔被拆分為標記和原始程式碼,其中包括代碼背後的檔和包含在腳本 runat_「server」&lt;&gt;元素中的任何代碼。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-433">These files are split into markup and source code, which includes both code-behind files and any code that is enclosed in &lt;script runat="server"&gt; elements.</span></span> <span data-ttu-id="ce8f9-434">原始程式碼被編譯成程式集,名稱派生自哈希演演演算法。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-434">Source code is compiled into assemblies, with names that are derived from a hashing algorithm.</span></span> <span data-ttu-id="ce8f9-435">生成的程式集放置在 Bin 目錄中。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-435">The resulting assemblies are placed in the Bin directory.</span></span> <span data-ttu-id="ce8f9-436">任何內聯代碼,即包含在 括**&lt;** 弧**%** 和 括弧之間的代碼,都包含在標記中,並且未編譯。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-436">Any inline code, that is, code enclosed between the **&lt;%** and **%&gt;** brackets, is included with markup and not compiled.</span></span> <span data-ttu-id="ce8f9-437">編譯器創建新檔以包含與源檔同名的標記。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-437">The compiler creates new files to contain the markup with the same name as the source files.</span></span> <span data-ttu-id="ce8f9-438">這些生成的檔放置在 Bin 目錄中。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-438">These resulting files are placed in the Bin directory.</span></span> <span data-ttu-id="ce8f9-439">編譯器還創建與源檔同名但具有擴展名的檔。包含映射資訊的 COMPILED。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-439">The compiler also creates files with the same name as the source files but with the extension .COMPILED that contain mapping information.</span></span> <span data-ttu-id="ce8f9-440">.COMPILED 檔案放置在與源檔的原始位置對應的輸出目錄中。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-440">The .COMPILED files are placed in the output directories corresponding to the original location of the source files.</span></span> |
| <span data-ttu-id="ce8f9-441">.ascx</span><span class="sxs-lookup"><span data-stu-id="ce8f9-441">.ascx</span></span> | <span data-ttu-id="ce8f9-442">這些檔被拆分為標記和原始碼。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-442">These files are split into markup and source code.</span></span> <span data-ttu-id="ce8f9-443">原始程式碼被編譯成程式集並放置在 Bin 目錄中,名稱派生自哈希演演演算法。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-443">Source code is compiled into assemblies and placed in the Bin directory, with names that are derived from a hashing algorithm.</span></span> <span data-ttu-id="ce8f9-444">不生成標記檔。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-444">No markup files are generated.</span></span> |
| <span data-ttu-id="ce8f9-445">.cs, .vb, .jsl, .cpp (不包括前面列出的檔案類型的代碼後檔案)</span><span class="sxs-lookup"><span data-stu-id="ce8f9-445">.cs, .vb, .jsl, .cpp (not including code-behind files for the file types listed earlier)</span></span> | <span data-ttu-id="ce8f9-446">由 .ascx、.ashx 或 .aspx 檔生成的程式集引用的原始碼被編譯到程式集中並放置在 Bin 目錄中。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-446">Source code that is referenced by the assemblies generated from .ascx, .ashx, or .aspx files is compiled into assemblies and placed in the Bin directory.</span></span> <span data-ttu-id="ce8f9-447">不會複製任何源檔。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-447">No source files are copied.</span></span> |
| <span data-ttu-id="ce8f9-448">自訂檔案類型</span><span class="sxs-lookup"><span data-stu-id="ce8f9-448">Custom file types</span></span> | <span data-ttu-id="ce8f9-449">這些檔像動態檔一樣編譯。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-449">These files are compiled like dynamic files.</span></span> <span data-ttu-id="ce8f9-450">根據它們所基於的文件類型,編譯器可以將映射檔放置在輸出目錄中。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-450">Depending on the type of file they are based on, the compiler can place mapping files in the output directories.</span></span> |
| <span data-ttu-id="ce8f9-451">套\_用程式碼子目錄中檔案</span><span class="sxs-lookup"><span data-stu-id="ce8f9-451">Files in the App\_Code subdirectory</span></span> | <span data-ttu-id="ce8f9-452">此子目錄中的原始碼檔被編譯到程式集中並放置在 Bin 目錄中。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-452">Source code files in this subdirectory are compiled into assemblies and placed in the Bin directory.</span></span> |
| <span data-ttu-id="ce8f9-453">套\_用全域資源子目錄中的檔案</span><span class="sxs-lookup"><span data-stu-id="ce8f9-453">Files in the App\_GlobalResources subdirectory</span></span> | <span data-ttu-id="ce8f9-454">這些檔被編譯成程式集並放置在 Bin 目錄中。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-454">These files are compiled into assemblies and placed in the Bin directory.</span></span> <span data-ttu-id="ce8f9-455">在主\_輸出目錄下不創建應用全域資源子目錄。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-455">No App\_GlobalResources subdirectory is created under the main output directory.</span></span> <span data-ttu-id="ce8f9-456">如果設定檔指定應用於"全部",則 .resx 和 .resources 檔將複製到輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-456">If the configuration file specifies appliesTo="All", .resx and .resources files are copied to the output directories.</span></span> <span data-ttu-id="ce8f9-457">如果[生成提供程式](https://msdn.microsoft.com/library/system.web.configuration.buildprovider.aspx)引用它們,則不複製它們。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-457">They are not copied if they are referenced by a [BuildProvider](https://msdn.microsoft.com/library/system.web.configuration.buildprovider.aspx).</span></span> |
| <span data-ttu-id="ce8f9-458">.resx 和 .資源\_檔案在套用資源子目錄</span><span class="sxs-lookup"><span data-stu-id="ce8f9-458">.resx and .resource files in the App\_LocalResources subdirectory</span></span> | <span data-ttu-id="ce8f9-459">這些檔被編譯到具有唯一名稱的程式集中,並放置在 Bin 目錄中。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-459">These files are compiled into assemblies with unique names and placed in the Bin directory.</span></span> <span data-ttu-id="ce8f9-460">沒有 .resx 或 .resource 檔案複製到輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-460">No .resx or .resource files are copied to the output directories.</span></span> |
| <span data-ttu-id="ce8f9-461">套\_用 主題子目錄中 .skin 檔案</span><span class="sxs-lookup"><span data-stu-id="ce8f9-461">.skin files in the App\_Themes subdirectory</span></span> | <span data-ttu-id="ce8f9-462">主題被編譯到程式集中並放置在 Bin 目錄中。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-462">Themes are compiled into assemblies and placed in the Bin directory.</span></span> <span data-ttu-id="ce8f9-463">為 .skin 檔案創建存根檔,並放置在相應的輸出目錄中。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-463">Stub files are created for .skin files and placed in the corresponding output directory.</span></span> <span data-ttu-id="ce8f9-464">靜態檔(如 .css)將複製到輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-464">Static files (such as .css) are copied to the output directories.</span></span> |
| <span data-ttu-id="ce8f9-465">.browser Web.config 靜態檔案類型 程式集已存在於 Bin 目錄中</span><span class="sxs-lookup"><span data-stu-id="ce8f9-465">.browser Web.config Static file types Assemblies already present in the Bin directory</span></span> | <span data-ttu-id="ce8f9-466">這些檔將照樣複製到輸出目錄。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-466">These files are copied as is to the output directory.</span></span> |

### <a name="fixed-assembly-names"></a>[<span data-ttu-id="ce8f9-467">固定程式集名稱</span><span class="sxs-lookup"><span data-stu-id="ce8f9-467">Fixed Assembly Names</span></span>](https://msdn.microsoft.com/library/ms229863.aspx##)

<span data-ttu-id="ce8f9-468">某些方案(如使用 MSI Windows 安裝程式部署 Web 應用程式)需要使用一致的檔名和內容,以及一致的目錄結構來識別更新的程式集或配置設置。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-468">Some scenarios, such as deploying a Web application using the MSI Windows Installer, require the use of consistent file names and contents, as well as consistent directory structures to identify assemblies or configuration settings for updates.</span></span> <span data-ttu-id="ce8f9-469">在這些情況下,可以使用 **-固定名稱**選項指定ASP.NET編譯工具應為每個源檔編譯程式集,而不是使用將多個頁面編譯到程式集中的位置。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-469">In those cases, you can use the **-fixednames** option to specify that the ASP.NET Compilation tool should compile an assembly for each source file instead of using the where multiple pages are compiled into assemblies.</span></span> <span data-ttu-id="ce8f9-470">這可能導致大量程式集,因此,如果您擔心可伸縮性,則應謹慎使用此選項。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-470">This can lead to a large number of assemblies, so if you are concerned with scalability you should use this option with caution.</span></span>

### <a name="strong-name-compilation"></a>[<span data-ttu-id="ce8f9-471">強名稱編譯</span><span class="sxs-lookup"><span data-stu-id="ce8f9-471">Strong-Name Compilation</span></span>](https://msdn.microsoft.com/library/ms229863.aspx##)

<span data-ttu-id="ce8f9-472">\_提供 -aptca、-delaysign、-**鍵容器**和 **-鍵檔案**選項,以便您可以使用 Aspnet 編譯器.exe 創建強命名程式集,而無需單獨使用[強名稱工具 (Sn.exe)。](https://msdn.microsoft.com/library/k5b5tt23.aspx) **-aptca** **-delaysign**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-472">The **-aptca**, **-delaysign**, **-keycontainer** and **-keyfile** options are provided so that you can use Aspnet\_compiler.exe to create strongly named assemblies without using the [Strong Name Tool (Sn.exe)](https://msdn.microsoft.com/library/k5b5tt23.aspx) separately.</span></span> <span data-ttu-id="ce8f9-473">這些選項以**允許部份信任的呼叫者屬性**、**程式集延遲屬性**、**程式集 KeyName 屬性**與**程式集金鑰檔案屬性**。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-473">These options correspond, respectively, to **AllowPartiallyTrustedCallersAttribute**, **AssemblyDelaySignAttribute**, **AssemblyKeyNameAttribute**, and **AssemblyKeyFileAttribute**.</span></span>

<span data-ttu-id="ce8f9-474">討論這些屬性超出了本課程的範圍。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-474">Discussion of these attributes is outside of the scope of this course.</span></span>

## <a name="labs"></a><span data-ttu-id="ce8f9-475">實驗室</span><span class="sxs-lookup"><span data-stu-id="ce8f9-475">Labs</span></span>

<span data-ttu-id="ce8f9-476">以下每個實驗室都基於以前的實驗室。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-476">Each of the following labs builds on the previous labs.</span></span> <span data-ttu-id="ce8f9-477">你需要按順序做它們。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-477">You will need to do them in order.</span></span>

## <a name="lab-1-using-the-configuration-api"></a><span data-ttu-id="ce8f9-478">實驗 1:使用設定 API</span><span class="sxs-lookup"><span data-stu-id="ce8f9-478">Lab 1: Using the Configuration API</span></span>

1. <span data-ttu-id="ce8f9-479">創建一個名為*mod9lab*的新網站。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-479">Create a new Web site called *mod9lab*.</span></span>
2. <span data-ttu-id="ce8f9-480">向網站添加新的 Web 配置檔。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-480">Add a new Web Configuration File to the site.</span></span>
3. <span data-ttu-id="ce8f9-481">將以下內容加入到 Web.config 檔案:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-481">Add the following to the web.config file:</span></span>

[!code-xml[Main](configuration-and-instrumentation/samples/sample14.xml)]

<span data-ttu-id="ce8f9-482">這將確保您具有保存對 Web.config 檔更改的許可權。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-482">This will ensure that you have permission to save changes to the web.config file.</span></span>

1. <span data-ttu-id="ce8f9-483">將新的 Label 控制項添加到 Default.aspx 並將 ID 更改為**lblDebugStatus。**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-483">Add a new Label control to Default.aspx and change the ID to **lblDebugStatus**.</span></span>
2. <span data-ttu-id="ce8f9-484">將新的按鈕控制項添加到 Default.aspx。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-484">Add a new Button control to Default.aspx.</span></span>
3. <span data-ttu-id="ce8f9-485">將按鈕控制項的 ID 變更為**btnToggleDebug**與「文字」來**切換除錯狀態**。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-485">Change the Button control's ID to **btnToggleDebug** and the Text to **Toggle Debug Status**.</span></span>
4. <span data-ttu-id="ce8f9-486">開啟 Default.aspx 的代碼背後檔的代碼檢視,並為**System.Web.設定**添加**using**語句,如下所示:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-486">Open the Code View for the code-behind file of Default.aspx and add a **using** statement for **System.Web.Configuration** as follows:</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample15.cs)]

1. <span data-ttu-id="ce8f9-487">新增兩個私有變數和一個\_Page Init 方法,如下所示:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-487">Add two private variables to the class and a Page\_Init method as shown below:</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample16.cs)]

1. <span data-ttu-id="ce8f9-488">將以下代碼加入頁面\_載入:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-488">Add the following code to Page\_Load:</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample17.cs)]

1. <span data-ttu-id="ce8f9-489">保存和流覽預設值.aspx。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-489">Save and browse default.aspx.</span></span> <span data-ttu-id="ce8f9-490">請注意,"標籤"控制器顯示當前調試狀態。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-490">Notice that the Label control displays the current debug status.</span></span>
2. <span data-ttu-id="ce8f9-491">按兩下設計器中的「按鈕」控制項,並將以下代碼加入到 Button 控制項的 Click 事件:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-491">Double-click on the Button control in the designer and add the following code to the Click event for the Button control:</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample18.cs)]

1. <span data-ttu-id="ce8f9-492">保存並瀏覽預設.aspx,然後單擊該按鈕。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-492">Save and browse default.aspx and click the button.</span></span>
2. <span data-ttu-id="ce8f9-493">按下每個按鈕後打開 Web.config 檔**debug**,&lt;並觀察&gt;編譯 部分中的調試屬性。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-493">Open the web.config file after each button click and observe the **debug** attribute in the &lt;compilation&gt; section.</span></span>

## <a name="lab-2-logging-application-restarts"></a><span data-ttu-id="ce8f9-494">實驗 2:記錄應用程式重新啟動</span><span class="sxs-lookup"><span data-stu-id="ce8f9-494">Lab 2: Logging Application Restarts</span></span>

<span data-ttu-id="ce8f9-495">在本實驗中,您將建立代碼,以允許您在事件查看器中切換應用程式關閉、啟動和重新編譯的日誌記錄。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-495">In this lab, you will create code that will allow you to toggle the logging of application shutdowns, startups, and recompilations in the Event Viewer.</span></span>

1. <span data-ttu-id="ce8f9-496">將下拉清單添加到預設.aspx,並將 ID 更改為 ddlLogApp 事件。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-496">Add a DropDownList to default.aspx and change the ID to ddlLogAppEvents.</span></span>
2. <span data-ttu-id="ce8f9-497">將下拉清單的**自動 PostBack**屬性設定為**true**。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-497">Set the **AutoPostBack** property for the DropDownList to **true**.</span></span>
3. <span data-ttu-id="ce8f9-498">將三個專案添加到下拉清單的「專案」集合中。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-498">Add three items to the Items collection for the DropDownList.</span></span> <span data-ttu-id="ce8f9-499">使第一個項目\**的文本\*\*\*選擇值*和值 -1。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-499">Make the **Text** for the first item *Select Value* and the value -1.</span></span> <span data-ttu-id="ce8f9-500">將**文字與\*\*\*\*值**為**true,** 並使第三個的**文字**與**值\*\*\*\*為 false**。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-500">Make the **Text** and **Value** of the second item **True** and the **Text** and **Value** of the third item **False**.</span></span>
4. <span data-ttu-id="ce8f9-501">將新標籤添加到預設.aspx。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-501">Add a new Label to default.aspx.</span></span> <span data-ttu-id="ce8f9-502">將 ID 變更為**lblLogApp 事件**。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-502">Change the ID to **lblLogAppEvents**.</span></span>
5. <span data-ttu-id="ce8f9-503">打開 default.aspx 的代碼後面檢視,並為類型為 Health 監視節的變數添加新聲明,如下所示:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-503">Open the code-behind view for default.aspx and add a new declaration for a variable of type HealthMonitoringSection as shown below:</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample19.cs)]

1. <span data-ttu-id="ce8f9-504">將以下代碼加入到頁\_Init 中的現有代碼:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-504">Add the following code to the existing code in Page\_Init:</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample20.cs)]

1. <span data-ttu-id="ce8f9-505">按兩下下拉清單,並將以下代碼添加到「選定索引更改」事件:</span><span class="sxs-lookup"><span data-stu-id="ce8f9-505">Double-click on the DropDownList and add the following code to the SelectedIndexChanged event:</span></span>

[!code-csharp[Main](configuration-and-instrumentation/samples/sample21.cs)]

1. <span data-ttu-id="ce8f9-506">瀏覽預設值.aspx。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-506">Browse default.aspx.</span></span>
2. <span data-ttu-id="ce8f9-507">將下拉設定為**False**。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-507">Set the dropdown to **False**.</span></span>
3. <span data-ttu-id="ce8f9-508">清除事件檢視器中的應用程式日誌。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-508">Clear the Application log in the Event Viewer.</span></span>
4. <span data-ttu-id="ce8f9-509">按一下這個按鈕可更改應用程式的除錯屬性。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-509">Click the button to change the Debug attribute for the application.</span></span>
5. <span data-ttu-id="ce8f9-510">刷新事件檢視器中的應用程式日誌。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-510">Refresh the Application log in the Event Viewer.</span></span> 

    1. <span data-ttu-id="ce8f9-511">是否有任何事件被記錄?</span><span class="sxs-lookup"><span data-stu-id="ce8f9-511">Were any events logged?</span></span>
    2. <span data-ttu-id="ce8f9-512">為什麼或為什麼不?</span><span class="sxs-lookup"><span data-stu-id="ce8f9-512">Why or why not?</span></span>
6. <span data-ttu-id="ce8f9-513">將下拉清單設置為 **「True」。**</span><span class="sxs-lookup"><span data-stu-id="ce8f9-513">Set the dropdown to **True.**</span></span>
7. <span data-ttu-id="ce8f9-514">按這裏按鈕可切換應用程式的除錯屬性。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-514">Click the button to toggle the Debug attribute for the application.</span></span>
8. <span data-ttu-id="ce8f9-515">刷新應用程式登錄事件檢視器。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-515">Refresh the Application login the Event Viewer.</span></span> 

    1. <span data-ttu-id="ce8f9-516">是否有任何事件被記錄?</span><span class="sxs-lookup"><span data-stu-id="ce8f9-516">Were any events logged?</span></span>
    2. <span data-ttu-id="ce8f9-517">應用關閉的原因是什麼?</span><span class="sxs-lookup"><span data-stu-id="ce8f9-517">What was the reason for the app shutdown?</span></span>
9. <span data-ttu-id="ce8f9-518">嘗試打開和關閉日誌記錄,並查看對 Web.config 檔所做的更改。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-518">Experiment with turning on and off logging and look at the changes made to the web.config file.</span></span>

## <a name="more-information"></a><span data-ttu-id="ce8f9-519">其他相關資訊：</span><span class="sxs-lookup"><span data-stu-id="ce8f9-519">More Information:</span></span>

<span data-ttu-id="ce8f9-520">ASP.NET 2.0 的提供程式模型允許您不僅為應用程式檢測創建自己的提供程式,還可用於許多其他用途,如成員資格、配置檔等。有關編寫自訂提供應用程式將應用程式事件記錄到文字檔的詳細資訊,請造[訪 此連結](https://msdn.microsoft.com/library/default.asp?url=/library/dnaspp/html/ASPNETProvMod_Prt6.asp)。</span><span class="sxs-lookup"><span data-stu-id="ce8f9-520">ASP.NET 2.0's Provider model allows you to create your own providers for not only application instrumentation, but for many other uses as well such as Membership, Profiles, etc. For detailed information on writing a custom provider to log application events to a text file, visit [this link](https://msdn.microsoft.com/library/default.asp?url=/library/dnaspp/html/ASPNETProvMod_Prt6.asp).</span></span>
