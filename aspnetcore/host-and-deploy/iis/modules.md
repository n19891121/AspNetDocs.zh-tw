---
title: 與 ASP.NET Core 搭配運作的 IIS 模組
author: guardrex
description: 探索 ASP.NET Core 應用程式的使用中和非使用中 IIS 模組，管理 IIS 模組的方式。
ms.author: riande
ms.custom: mvc
ms.date: 01/17/2019
uid: host-and-deploy/iis/modules
ms.openlocfilehash: 8c32a668b3945f0da0194162e19e965b4aed3934
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/01/2019
ms.locfileid: "57043895"
---
# <a name="iis-modules-with-aspnet-core"></a><span data-ttu-id="21ef1-103">與 ASP.NET Core 搭配運作的 IIS 模組</span><span class="sxs-lookup"><span data-stu-id="21ef1-103">IIS modules with ASP.NET Core</span></span>

<span data-ttu-id="21ef1-104">作者：[Luke Latham](https://github.com/guardrex)</span><span class="sxs-lookup"><span data-stu-id="21ef1-104">By [Luke Latham](https://github.com/guardrex)</span></span>

<span data-ttu-id="21ef1-105">您無法使用部分原生 IIS 模組與所有 IIS 受控模組來處理 ASP.NET Core 應用程式的要求。</span><span class="sxs-lookup"><span data-stu-id="21ef1-105">Some of the native IIS modules and all of the IIS managed modules aren't able to process requests for ASP.NET Core apps.</span></span> <span data-ttu-id="21ef1-106">在許多情況下，ASP.NET Core 都提供由 IIS 原生與受控模組處理之情節的替代方案。</span><span class="sxs-lookup"><span data-stu-id="21ef1-106">In many cases, ASP.NET Core offers an alternative to the scenarios addressed by IIS native and managed modules.</span></span>

## <a name="native-modules"></a><span data-ttu-id="21ef1-107">原生模組</span><span class="sxs-lookup"><span data-stu-id="21ef1-107">Native modules</span></span>

<span data-ttu-id="21ef1-108">下表指出可搭配 ASP.NET Core 應用程式和 ASP.NET Core 模組運作的原生 IIS 模組。</span><span class="sxs-lookup"><span data-stu-id="21ef1-108">The table indicates native IIS modules that are functional with ASP.NET Core apps and the ASP.NET Core Module.</span></span>

| <span data-ttu-id="21ef1-109">Module</span><span class="sxs-lookup"><span data-stu-id="21ef1-109">Module</span></span> | <span data-ttu-id="21ef1-110">對 ASP.NET Core 應用程式有作用</span><span class="sxs-lookup"><span data-stu-id="21ef1-110">Functional with ASP.NET Core apps</span></span> | <span data-ttu-id="21ef1-111">ASP.NET Core 選項</span><span class="sxs-lookup"><span data-stu-id="21ef1-111">ASP.NET Core Option</span></span> |
| --- | :---: | --- |
| <span data-ttu-id="21ef1-112">**匿名驗證**</span><span class="sxs-lookup"><span data-stu-id="21ef1-112">**Anonymous Authentication**</span></span><br>`AnonymousAuthenticationModule`                                  | <span data-ttu-id="21ef1-113">是</span><span class="sxs-lookup"><span data-stu-id="21ef1-113">Yes</span></span> | |
| <span data-ttu-id="21ef1-114">**基本驗證**</span><span class="sxs-lookup"><span data-stu-id="21ef1-114">**Basic Authentication**</span></span><br>`BasicAuthenticationModule`                                          | <span data-ttu-id="21ef1-115">是</span><span class="sxs-lookup"><span data-stu-id="21ef1-115">Yes</span></span> | |
| <span data-ttu-id="21ef1-116">**用戶端憑證對應驗證**</span><span class="sxs-lookup"><span data-stu-id="21ef1-116">**Client Certification Mapping Authentication**</span></span><br>`CertificateMappingAuthenticationModule`      | <span data-ttu-id="21ef1-117">是</span><span class="sxs-lookup"><span data-stu-id="21ef1-117">Yes</span></span> | |
| <span data-ttu-id="21ef1-118">**CGI**</span><span class="sxs-lookup"><span data-stu-id="21ef1-118">**CGI**</span></span><br>`CgiModule`                                                                           | <span data-ttu-id="21ef1-119">否</span><span class="sxs-lookup"><span data-stu-id="21ef1-119">No</span></span>  | |
| <span data-ttu-id="21ef1-120">**設定驗證**</span><span class="sxs-lookup"><span data-stu-id="21ef1-120">**Configuration Validation**</span></span><br>`ConfigurationValidationModule`                                  | <span data-ttu-id="21ef1-121">是</span><span class="sxs-lookup"><span data-stu-id="21ef1-121">Yes</span></span> | |
| <span data-ttu-id="21ef1-122">**HTTP 錯誤**</span><span class="sxs-lookup"><span data-stu-id="21ef1-122">**HTTP Errors**</span></span><br>`CustomErrorModule`                                                           | <span data-ttu-id="21ef1-123">否</span><span class="sxs-lookup"><span data-stu-id="21ef1-123">No</span></span>  | [<span data-ttu-id="21ef1-124">狀態碼頁面中介軟體</span><span class="sxs-lookup"><span data-stu-id="21ef1-124">Status Code Pages Middleware</span></span>](xref:fundamentals/error-handling#configure-status-code-pages) |
| <span data-ttu-id="21ef1-125">**自訂記錄**</span><span class="sxs-lookup"><span data-stu-id="21ef1-125">**Custom Logging**</span></span><br>`CustomLoggingModule`                                                      | <span data-ttu-id="21ef1-126">是</span><span class="sxs-lookup"><span data-stu-id="21ef1-126">Yes</span></span> | |
| <span data-ttu-id="21ef1-127">**預設文件**</span><span class="sxs-lookup"><span data-stu-id="21ef1-127">**Default Document**</span></span><br>`DefaultDocumentModule`                                                  | <span data-ttu-id="21ef1-128">否</span><span class="sxs-lookup"><span data-stu-id="21ef1-128">No</span></span>  | [<span data-ttu-id="21ef1-129">預設檔案中介軟體</span><span class="sxs-lookup"><span data-stu-id="21ef1-129">Default Files Middleware</span></span>](xref:fundamentals/static-files#serve-a-default-document) |
| <span data-ttu-id="21ef1-130">**摘要式驗證**</span><span class="sxs-lookup"><span data-stu-id="21ef1-130">**Digest Authentication**</span></span><br>`DigestAuthenticationModule`                                        | <span data-ttu-id="21ef1-131">是</span><span class="sxs-lookup"><span data-stu-id="21ef1-131">Yes</span></span> | |
| <span data-ttu-id="21ef1-132">**目錄瀏覽**</span><span class="sxs-lookup"><span data-stu-id="21ef1-132">**Directory Browsing**</span></span><br>`DirectoryListingModule`                                               | <span data-ttu-id="21ef1-133">否</span><span class="sxs-lookup"><span data-stu-id="21ef1-133">No</span></span>  | [<span data-ttu-id="21ef1-134">目錄瀏覽中介軟體</span><span class="sxs-lookup"><span data-stu-id="21ef1-134">Directory Browsing Middleware</span></span>](xref:fundamentals/static-files#enable-directory-browsing) |
| <span data-ttu-id="21ef1-135">**動態壓縮**</span><span class="sxs-lookup"><span data-stu-id="21ef1-135">**Dynamic Compression**</span></span><br>`DynamicCompressionModule`                                            | <span data-ttu-id="21ef1-136">是</span><span class="sxs-lookup"><span data-stu-id="21ef1-136">Yes</span></span> | [<span data-ttu-id="21ef1-137">回應壓縮中介軟體</span><span class="sxs-lookup"><span data-stu-id="21ef1-137">Response Compression Middleware</span></span>](xref:performance/response-compression) |
| <span data-ttu-id="21ef1-138">**追蹤**</span><span class="sxs-lookup"><span data-stu-id="21ef1-138">**Tracing**</span></span><br>`FailedRequestsTracingModule`                                                     | <span data-ttu-id="21ef1-139">是</span><span class="sxs-lookup"><span data-stu-id="21ef1-139">Yes</span></span> | [<span data-ttu-id="21ef1-140">ASP.NET Core 記錄</span><span class="sxs-lookup"><span data-stu-id="21ef1-140">ASP.NET Core Logging</span></span>](xref:fundamentals/logging/index#tracesource-provider) |
| <span data-ttu-id="21ef1-141">**檔案快取**</span><span class="sxs-lookup"><span data-stu-id="21ef1-141">**File Caching**</span></span><br>`FileCacheModule`                                                            | <span data-ttu-id="21ef1-142">否</span><span class="sxs-lookup"><span data-stu-id="21ef1-142">No</span></span>  | [<span data-ttu-id="21ef1-143">回應快取中介軟體</span><span class="sxs-lookup"><span data-stu-id="21ef1-143">Response Caching Middleware</span></span>](xref:performance/caching/middleware) |
| <span data-ttu-id="21ef1-144">**HTTP 快取**</span><span class="sxs-lookup"><span data-stu-id="21ef1-144">**HTTP Caching**</span></span><br>`HttpCacheModule`                                                            | <span data-ttu-id="21ef1-145">否</span><span class="sxs-lookup"><span data-stu-id="21ef1-145">No</span></span>  | [<span data-ttu-id="21ef1-146">回應快取中介軟體</span><span class="sxs-lookup"><span data-stu-id="21ef1-146">Response Caching Middleware</span></span>](xref:performance/caching/middleware) |
| <span data-ttu-id="21ef1-147">**HTTP 記錄**</span><span class="sxs-lookup"><span data-stu-id="21ef1-147">**HTTP Logging**</span></span><br>`HttpLoggingModule`                                                          | <span data-ttu-id="21ef1-148">是</span><span class="sxs-lookup"><span data-stu-id="21ef1-148">Yes</span></span> | [<span data-ttu-id="21ef1-149">ASP.NET Core 記錄</span><span class="sxs-lookup"><span data-stu-id="21ef1-149">ASP.NET Core Logging</span></span>](xref:fundamentals/logging/index) |
| <span data-ttu-id="21ef1-150">**HTTP 重新導向**</span><span class="sxs-lookup"><span data-stu-id="21ef1-150">**HTTP Redirection**</span></span><br>`HttpRedirectionModule`                                                  | <span data-ttu-id="21ef1-151">是</span><span class="sxs-lookup"><span data-stu-id="21ef1-151">Yes</span></span> | [<span data-ttu-id="21ef1-152">URL 重寫中介軟體</span><span class="sxs-lookup"><span data-stu-id="21ef1-152">URL Rewriting Middleware</span></span>](xref:fundamentals/url-rewriting) |
| <span data-ttu-id="21ef1-153">**IIS 用戶端憑證對應驗證**</span><span class="sxs-lookup"><span data-stu-id="21ef1-153">**IIS Client Certificate Mapping Authentication**</span></span><br>`IISCertificateMappingAuthenticationModule` | <span data-ttu-id="21ef1-154">是</span><span class="sxs-lookup"><span data-stu-id="21ef1-154">Yes</span></span> | |
| <span data-ttu-id="21ef1-155">**IP 及網域限制**</span><span class="sxs-lookup"><span data-stu-id="21ef1-155">**IP and Domain Restrictions**</span></span><br>`IpRestrictionModule`                                          | <span data-ttu-id="21ef1-156">是</span><span class="sxs-lookup"><span data-stu-id="21ef1-156">Yes</span></span> | |
| <span data-ttu-id="21ef1-157">**ISAPI 篩選器**</span><span class="sxs-lookup"><span data-stu-id="21ef1-157">**ISAPI Filters**</span></span><br>`IsapiFilterModule`                                                         | <span data-ttu-id="21ef1-158">是</span><span class="sxs-lookup"><span data-stu-id="21ef1-158">Yes</span></span> | [<span data-ttu-id="21ef1-159">中介軟體</span><span class="sxs-lookup"><span data-stu-id="21ef1-159">Middleware</span></span>](xref:fundamentals/middleware/index) |
| <span data-ttu-id="21ef1-160">**ISAPI**</span><span class="sxs-lookup"><span data-stu-id="21ef1-160">**ISAPI**</span></span><br>`IsapiModule`                                                                       | <span data-ttu-id="21ef1-161">是</span><span class="sxs-lookup"><span data-stu-id="21ef1-161">Yes</span></span> | [<span data-ttu-id="21ef1-162">中介軟體</span><span class="sxs-lookup"><span data-stu-id="21ef1-162">Middleware</span></span>](xref:fundamentals/middleware/index) |
| <span data-ttu-id="21ef1-163">**通訊協定支援**</span><span class="sxs-lookup"><span data-stu-id="21ef1-163">**Protocol Support**</span></span><br>`ProtocolSupportModule`                                                  | <span data-ttu-id="21ef1-164">是</span><span class="sxs-lookup"><span data-stu-id="21ef1-164">Yes</span></span> | |
| <span data-ttu-id="21ef1-165">**要求篩選**</span><span class="sxs-lookup"><span data-stu-id="21ef1-165">**Request Filtering**</span></span><br>`RequestFilteringModule`                                                | <span data-ttu-id="21ef1-166">是</span><span class="sxs-lookup"><span data-stu-id="21ef1-166">Yes</span></span> | [<span data-ttu-id="21ef1-167">URL 重寫中介軟體`IRule`</span><span class="sxs-lookup"><span data-stu-id="21ef1-167">URL Rewriting Middleware `IRule`</span></span>](xref:fundamentals/url-rewriting#irule-based-rule) |
| <span data-ttu-id="21ef1-168">**要求監視器**</span><span class="sxs-lookup"><span data-stu-id="21ef1-168">**Request Monitor**</span></span><br>`RequestMonitorModule`                                                    | <span data-ttu-id="21ef1-169">是</span><span class="sxs-lookup"><span data-stu-id="21ef1-169">Yes</span></span> | |
| <span data-ttu-id="21ef1-170">**URL 重新寫入**&#8224;</span><span class="sxs-lookup"><span data-stu-id="21ef1-170">**URL Rewriting**&#8224;</span></span><br>`RewriteModule`                                                      | <span data-ttu-id="21ef1-171">是</span><span class="sxs-lookup"><span data-stu-id="21ef1-171">Yes</span></span> | [<span data-ttu-id="21ef1-172">URL 重寫中介軟體</span><span class="sxs-lookup"><span data-stu-id="21ef1-172">URL Rewriting Middleware</span></span>](xref:fundamentals/url-rewriting) |
| <span data-ttu-id="21ef1-173">**伺服器端包含**</span><span class="sxs-lookup"><span data-stu-id="21ef1-173">**Server-Side Includes**</span></span><br>`ServerSideIncludeModule`                                            | <span data-ttu-id="21ef1-174">否</span><span class="sxs-lookup"><span data-stu-id="21ef1-174">No</span></span>  | |
| <span data-ttu-id="21ef1-175">**靜態壓縮**</span><span class="sxs-lookup"><span data-stu-id="21ef1-175">**Static Compression**</span></span><br>`StaticCompressionModule`                                              | <span data-ttu-id="21ef1-176">否</span><span class="sxs-lookup"><span data-stu-id="21ef1-176">No</span></span>  | [<span data-ttu-id="21ef1-177">回應壓縮中介軟體</span><span class="sxs-lookup"><span data-stu-id="21ef1-177">Response Compression Middleware</span></span>](xref:performance/response-compression) |
| <span data-ttu-id="21ef1-178">**靜態內容**</span><span class="sxs-lookup"><span data-stu-id="21ef1-178">**Static Content**</span></span><br>`StaticFileModule`                                                         | <span data-ttu-id="21ef1-179">否</span><span class="sxs-lookup"><span data-stu-id="21ef1-179">No</span></span>  | [<span data-ttu-id="21ef1-180">靜態檔案中介軟體</span><span class="sxs-lookup"><span data-stu-id="21ef1-180">Static File Middleware</span></span>](xref:fundamentals/static-files) |
| <span data-ttu-id="21ef1-181">**權杖快取**</span><span class="sxs-lookup"><span data-stu-id="21ef1-181">**Token Caching**</span></span><br>`TokenCacheModule`                                                          | <span data-ttu-id="21ef1-182">是</span><span class="sxs-lookup"><span data-stu-id="21ef1-182">Yes</span></span> | |
| <span data-ttu-id="21ef1-183">**URI 快取**</span><span class="sxs-lookup"><span data-stu-id="21ef1-183">**URI Caching**</span></span><br>`UriCacheModule`                                                              | <span data-ttu-id="21ef1-184">是</span><span class="sxs-lookup"><span data-stu-id="21ef1-184">Yes</span></span> | |
| <span data-ttu-id="21ef1-185">**URL 授權**</span><span class="sxs-lookup"><span data-stu-id="21ef1-185">**URL Authorization**</span></span><br>`UrlAuthorizationModule`                                                | <span data-ttu-id="21ef1-186">是</span><span class="sxs-lookup"><span data-stu-id="21ef1-186">Yes</span></span> | [<span data-ttu-id="21ef1-187">ASP.NET Core 身分識別</span><span class="sxs-lookup"><span data-stu-id="21ef1-187">ASP.NET Core Identity</span></span>](xref:security/authentication/identity) |
| <span data-ttu-id="21ef1-188">**Windows 驗證**</span><span class="sxs-lookup"><span data-stu-id="21ef1-188">**Windows Authentication**</span></span><br>`WindowsAuthenticationModule`                                      | <span data-ttu-id="21ef1-189">是</span><span class="sxs-lookup"><span data-stu-id="21ef1-189">Yes</span></span> | |

<span data-ttu-id="21ef1-190">&#8224;由於[目錄結構](xref:host-and-deploy/directory-structure)變更的緣故，因此「URL 重寫模組」的 `isFile` 和 `isDirectory` 比對類型對 ASP.NET Core 應用程式沒有作用。</span><span class="sxs-lookup"><span data-stu-id="21ef1-190">&#8224;The URL Rewrite Module's `isFile` and `isDirectory` match types don't work with ASP.NET Core apps due to the changes in [directory structure](xref:host-and-deploy/directory-structure).</span></span>

## <a name="managed-modules"></a><span data-ttu-id="21ef1-191">受控模組</span><span class="sxs-lookup"><span data-stu-id="21ef1-191">Managed modules</span></span>

<span data-ttu-id="21ef1-192">當應用程式集區的 .NET CLR 版本已設定為 [沒有 Managed 程式碼] 時，受控模組對所裝載的 ASP.NET Core 應用程式「沒有」作用。</span><span class="sxs-lookup"><span data-stu-id="21ef1-192">Managed modules are *not* functional with hosted ASP.NET Core apps when the app pool's .NET CLR version is set to **No Managed Code**.</span></span> <span data-ttu-id="21ef1-193">ASP.NET Core 在數種案例中都有提供中介軟體替代方案。</span><span class="sxs-lookup"><span data-stu-id="21ef1-193">ASP.NET Core offers middleware alternatives in several cases.</span></span>

| <span data-ttu-id="21ef1-194">Module</span><span class="sxs-lookup"><span data-stu-id="21ef1-194">Module</span></span>                  | <span data-ttu-id="21ef1-195">ASP.NET Core 選項</span><span class="sxs-lookup"><span data-stu-id="21ef1-195">ASP.NET Core Option</span></span> |
| ----------------------- | ------------------- |
| <span data-ttu-id="21ef1-196">AnonymousIdentification</span><span class="sxs-lookup"><span data-stu-id="21ef1-196">AnonymousIdentification</span></span> | |
| <span data-ttu-id="21ef1-197">DefaultAuthentication</span><span class="sxs-lookup"><span data-stu-id="21ef1-197">DefaultAuthentication</span></span>   | |
| <span data-ttu-id="21ef1-198">FileAuthorization</span><span class="sxs-lookup"><span data-stu-id="21ef1-198">FileAuthorization</span></span>       | |
| <span data-ttu-id="21ef1-199">FormsAuthentication</span><span class="sxs-lookup"><span data-stu-id="21ef1-199">FormsAuthentication</span></span>     | [<span data-ttu-id="21ef1-200">Cookie 驗證中介軟體</span><span class="sxs-lookup"><span data-stu-id="21ef1-200">Cookie Authentication Middleware</span></span>](xref:security/authentication/cookie) |
| <span data-ttu-id="21ef1-201">OutputCache</span><span class="sxs-lookup"><span data-stu-id="21ef1-201">OutputCache</span></span>             | [<span data-ttu-id="21ef1-202">回應快取中介軟體</span><span class="sxs-lookup"><span data-stu-id="21ef1-202">Response Caching Middleware</span></span>](xref:performance/caching/middleware) |
| <span data-ttu-id="21ef1-203">設定檔</span><span class="sxs-lookup"><span data-stu-id="21ef1-203">Profile</span></span>                 | |
| <span data-ttu-id="21ef1-204">RoleManager</span><span class="sxs-lookup"><span data-stu-id="21ef1-204">RoleManager</span></span>             | |
| <span data-ttu-id="21ef1-205">ScriptModule-4.0</span><span class="sxs-lookup"><span data-stu-id="21ef1-205">ScriptModule-4.0</span></span>        | |
| <span data-ttu-id="21ef1-206">工作階段</span><span class="sxs-lookup"><span data-stu-id="21ef1-206">Session</span></span>                 | [<span data-ttu-id="21ef1-207">工作階段中介軟體</span><span class="sxs-lookup"><span data-stu-id="21ef1-207">Session Middleware</span></span>](xref:fundamentals/app-state) |
| <span data-ttu-id="21ef1-208">UrlAuthorization</span><span class="sxs-lookup"><span data-stu-id="21ef1-208">UrlAuthorization</span></span>        | |
| <span data-ttu-id="21ef1-209">UrlMappingsModule</span><span class="sxs-lookup"><span data-stu-id="21ef1-209">UrlMappingsModule</span></span>       | [<span data-ttu-id="21ef1-210">URL 重寫中介軟體</span><span class="sxs-lookup"><span data-stu-id="21ef1-210">URL Rewriting Middleware</span></span>](xref:fundamentals/url-rewriting) |
| <span data-ttu-id="21ef1-211">UrlRoutingModule-4.0</span><span class="sxs-lookup"><span data-stu-id="21ef1-211">UrlRoutingModule-4.0</span></span>    | [<span data-ttu-id="21ef1-212">ASP.NET Core 身分識別</span><span class="sxs-lookup"><span data-stu-id="21ef1-212">ASP.NET Core Identity</span></span>](xref:security/authentication/identity) |
| <span data-ttu-id="21ef1-213">WindowsAuthentication</span><span class="sxs-lookup"><span data-stu-id="21ef1-213">WindowsAuthentication</span></span>   | |

## <a name="iis-manager-application-changes"></a><span data-ttu-id="21ef1-214">IIS 管理員應用程式變更</span><span class="sxs-lookup"><span data-stu-id="21ef1-214">IIS Manager application changes</span></span>

<span data-ttu-id="21ef1-215">使用「IIS 管理員」來進行設定時，會變更應用程式的 *web.config* 檔案。</span><span class="sxs-lookup"><span data-stu-id="21ef1-215">When using IIS Manager to configure settings, the *web.config* file of the app is changed.</span></span> <span data-ttu-id="21ef1-216">如果部署應用程式並包含 *web.config*，則所部署的 *web.config* 檔案會覆寫使用「IIS 管理員」來進行的所有變更。</span><span class="sxs-lookup"><span data-stu-id="21ef1-216">If deploying an app and including *web.config*, any changes made with IIS Manager are overwritten by the deployed *web.config* file.</span></span> <span data-ttu-id="21ef1-217">對伺服器的 *web.config* 檔案進行變更後，請立即將伺服器上已更新的 *web.config* 檔案複製到本機專案。</span><span class="sxs-lookup"><span data-stu-id="21ef1-217">If changes are made to the server's *web.config* file, copy the updated *web.config* file on the server to the local project immediately.</span></span>

## <a name="disabling-iis-modules"></a><span data-ttu-id="21ef1-218">停用 IIS 模組</span><span class="sxs-lookup"><span data-stu-id="21ef1-218">Disabling IIS modules</span></span>

<span data-ttu-id="21ef1-219">如果在必須針對應用程式停用的伺服器層級設定了 IIS 模組，只要在應用程式的 *web.config* 檔案中新增設定，即可停用該模組。</span><span class="sxs-lookup"><span data-stu-id="21ef1-219">If an IIS module is configured at the server level that must be disabled for an app, an addition to the app's *web.config* file can disable the module.</span></span> <span data-ttu-id="21ef1-220">請將模組留在原處，然後使用組態設定 (如果有的話) 來停用它，或是從應用程式移除模組。</span><span class="sxs-lookup"><span data-stu-id="21ef1-220">Either leave the module in place and deactivate it using a configuration setting (if available) or remove the module from the app.</span></span>

### <a name="module-deactivation"></a><span data-ttu-id="21ef1-221">模組停用</span><span class="sxs-lookup"><span data-stu-id="21ef1-221">Module deactivation</span></span>

<span data-ttu-id="21ef1-222">許多模組都有提供可將模組停用而無須從應用程式中移除的組態設定。</span><span class="sxs-lookup"><span data-stu-id="21ef1-222">Many modules offer a configuration setting that allows them to be disabled without removing the module from the app.</span></span> <span data-ttu-id="21ef1-223">這是停用模組的最簡便快速方式。</span><span class="sxs-lookup"><span data-stu-id="21ef1-223">This is the simplest and quickest way to deactivate a module.</span></span> <span data-ttu-id="21ef1-224">例如，使用 *web.config* 中的 `<httpRedirect>` 元素，即可停用「HTTP 重新導向模組」：</span><span class="sxs-lookup"><span data-stu-id="21ef1-224">For example, the HTTP Redirection Module can be disabled with the `<httpRedirect>` element in *web.config*:</span></span>

```xml
<configuration>
  <system.webServer>
    <httpRedirect enabled="false" />
  </system.webServer>
</configuration>
```

<span data-ttu-id="21ef1-225">如需有關使用組態設定來停用模組的詳細資訊，請參考 [IIS \<system.webServer>](/iis/configuration/system.webServer/) ＜子元素＞一節中的連結。</span><span class="sxs-lookup"><span data-stu-id="21ef1-225">For more information on disabling modules with configuration settings, follow the links in the *Child Elements* section of [IIS \<system.webServer>](/iis/configuration/system.webServer/).</span></span>

### <a name="module-removal"></a><span data-ttu-id="21ef1-226">模組移除</span><span class="sxs-lookup"><span data-stu-id="21ef1-226">Module removal</span></span>

<span data-ttu-id="21ef1-227">如果選擇透過 *web.config* 中的設定來移除模組，請先將模組解除鎖定，以及將 *web.config* 的 `<modules>` 區段解除鎖定：</span><span class="sxs-lookup"><span data-stu-id="21ef1-227">If opting to remove a module with a setting in *web.config*, unlock the module and unlock the `<modules>` section of *web.config* first:</span></span>

1. <span data-ttu-id="21ef1-228">將伺服器層級的模組解除鎖定。</span><span class="sxs-lookup"><span data-stu-id="21ef1-228">Unlock the module at the server level.</span></span> <span data-ttu-id="21ef1-229">選取「IIS 管理員」[連線] 資訊看板中的 IIS 伺服器。</span><span class="sxs-lookup"><span data-stu-id="21ef1-229">Select the IIS server in the IIS Manager **Connections** sidebar.</span></span> <span data-ttu-id="21ef1-230">開啟 [IIS] 區域中的 [模組]。</span><span class="sxs-lookup"><span data-stu-id="21ef1-230">Open the **Modules** in the **IIS** area.</span></span> <span data-ttu-id="21ef1-231">選取清單中的模組。</span><span class="sxs-lookup"><span data-stu-id="21ef1-231">Select the module in the list.</span></span> <span data-ttu-id="21ef1-232">在右邊的 [動作] 資訊看板上，選取 [解除鎖定]。</span><span class="sxs-lookup"><span data-stu-id="21ef1-232">In the **Actions** sidebar on the right, select **Unlock**.</span></span> <span data-ttu-id="21ef1-233">若模組的動作項目顯示為**鎖定**，就代表該模組已經解除鎖定，且不需要任何動作。</span><span class="sxs-lookup"><span data-stu-id="21ef1-233">If the action entry for the module appears as **Lock**, the module is already unlocked, and no action is required.</span></span> <span data-ttu-id="21ef1-234">將您打算稍後從 *web.config* 移除的模組都解除鎖定。</span><span class="sxs-lookup"><span data-stu-id="21ef1-234">Unlock as many modules as you plan to remove from *web.config* later.</span></span>

2. <span data-ttu-id="21ef1-235">在 *web.config* 不含 `<modules>` 區段的情況下部署應用程式。如果在 *web.config* 包含 `<modules>` 區段的情況下部署應用程式，但未先在「IIS 管理員」中將該區段解除鎖定，則當「設定管理員」嘗試將該區段解除鎖定時就會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="21ef1-235">Deploy the app without a `<modules>` section in *web.config*. If an app is deployed with a *web.config* containing the `<modules>` section without having unlocked the section first in the IIS Manager, the Configuration Manager throws an exception when attempting to unlock the section.</span></span> <span data-ttu-id="21ef1-236">因此，請在沒有 `<modules>` 區段的情況下部署應用程式。</span><span class="sxs-lookup"><span data-stu-id="21ef1-236">Therefore, deploy the app without a `<modules>` section.</span></span>

3. <span data-ttu-id="21ef1-237">將 *web.config* 的 `<modules>` 區段解除鎖定。在 [連線] 資訊看板中，選取 [站台]中的網站。</span><span class="sxs-lookup"><span data-stu-id="21ef1-237">Unlock the `<modules>` section of *web.config*. In the **Connections** sidebar, select the website in **Sites**.</span></span> <span data-ttu-id="21ef1-238">在 [管理] 區域中，開啟 [設定編輯器]。</span><span class="sxs-lookup"><span data-stu-id="21ef1-238">In the **Management** area, open the **Configuration Editor**.</span></span> <span data-ttu-id="21ef1-239">使用導覽控制項來選取 `system.webServer/modules` 區段。</span><span class="sxs-lookup"><span data-stu-id="21ef1-239">Use the navigation controls to select the `system.webServer/modules` section.</span></span> <span data-ttu-id="21ef1-240">在右邊的 [動作] 資訊看板上，選取將區段 [解除鎖定]。</span><span class="sxs-lookup"><span data-stu-id="21ef1-240">In the **Actions** sidebar on the right, select to **Unlock** the section.</span></span> <span data-ttu-id="21ef1-241">若模組區段的動作項目顯示為**鎖定區段**，就代表該模組區段已經解除鎖定，且不需要任何動作。</span><span class="sxs-lookup"><span data-stu-id="21ef1-241">If the action entry for the module section appears as **Lock Section**, the module section is already unlocked, and no action is required.</span></span>

4. <span data-ttu-id="21ef1-242">將 `<modules>` 區段新增至具有 `<remove>` 元素的應用程式本機 *web.config* 檔案，以從應用程式移除該模組。</span><span class="sxs-lookup"><span data-stu-id="21ef1-242">Add a `<modules>` section to the app's local *web.config* file with a `<remove>` element to remove the module from the app.</span></span> <span data-ttu-id="21ef1-243">新增多個 `<remove>` 元素以移除多個模組。</span><span class="sxs-lookup"><span data-stu-id="21ef1-243">Add multiple `<remove>` elements to remove multiple modules.</span></span> <span data-ttu-id="21ef1-244">如果已在伺服器上進行 *web.config* 變更，請立即在本機對專案的 *web.config* 檔案進行相同的變更。</span><span class="sxs-lookup"><span data-stu-id="21ef1-244">If *web.config* changes are made on the server, immediately make the same changes to the project's *web.config* file locally.</span></span> <span data-ttu-id="21ef1-245">使用此方法移除模組不會影響模組與伺服器上其他應用程式的搭配使用。</span><span class="sxs-lookup"><span data-stu-id="21ef1-245">Removing a module using this approach doesn't affect the use of the module with other apps on the server.</span></span>

   ```xml
   <configuration>
    <system.webServer>
      <modules>
        <remove name="MODULE_NAME" />
      </modules>
    </system.webServer>
   </configuration>
   ```
   
<span data-ttu-id="21ef1-246">若要使用 *web.config* 對 IIS Express 新增或移除模組，請修改 *applicationHost.config* 以解除鎖定 `<modules>` 區段：</span><span class="sxs-lookup"><span data-stu-id="21ef1-246">In order to add or remove modules for IIS Express using *web.config*, modify *applicationHost.config* to unlock the `<modules>` section:</span></span>

1. <span data-ttu-id="21ef1-247">開啟 *{APPLICATION ROOT}\\.vs\config\applicationhost.config*。</span><span class="sxs-lookup"><span data-stu-id="21ef1-247">Open *{APPLICATION ROOT}\\.vs\config\applicationhost.config*.</span></span>

1. <span data-ttu-id="21ef1-248">找出 IIS 模組的 `<section>` 元素，並將 `overrideModeDefault` 從 `Deny` 變更為 `Allow`：</span><span class="sxs-lookup"><span data-stu-id="21ef1-248">Locate the `<section>` element for IIS modules and change `overrideModeDefault` from `Deny` to `Allow`:</span></span>

   ```xml
   <section name="modules" 
            allowDefinition="MachineToApplication" 
            overrideModeDefault="Allow" />
   ```
   
1. <span data-ttu-id="21ef1-249">找出 `<location path="" overrideMode="Allow"><system.webServer><modules>` 區段。</span><span class="sxs-lookup"><span data-stu-id="21ef1-249">Locate the `<location path="" overrideMode="Allow"><system.webServer><modules>` section.</span></span> <span data-ttu-id="21ef1-250">對於您要移除的任何模組，請將 `lockItem` 從 `true` 變更為 `false`。</span><span class="sxs-lookup"><span data-stu-id="21ef1-250">For any modules that you wish to remove, set `lockItem` from `true` to `false`.</span></span> <span data-ttu-id="21ef1-251">以下為將 CGI 模組解除鎖定的範例：</span><span class="sxs-lookup"><span data-stu-id="21ef1-251">In the following example, the CGI Module is unlocked:</span></span>

   ```xml
   <add name="CgiModule" lockItem="false" />
   ```
   
1. <span data-ttu-id="21ef1-252">在將 `<modules>` 區段及個別模組解除鎖定後，您可任意使用應用程式的 *web.config* 檔案新增或移除 IIS 模組，以在 IIS Express 上執行應用程式。</span><span class="sxs-lookup"><span data-stu-id="21ef1-252">After the `<modules>` section and individual modules are unlocked, you're free to add or remove IIS modules using the app's *web.config* file for running the app on IIS Express.</span></span>

<span data-ttu-id="21ef1-253">您也可以使用 *Appcmd.exe* 來移除 IIS 模組。</span><span class="sxs-lookup"><span data-stu-id="21ef1-253">An IIS module can also be removed with *Appcmd.exe*.</span></span> <span data-ttu-id="21ef1-254">請在命令中提供 `MODULE_NAME` 和 `APPLICATION_NAME`：</span><span class="sxs-lookup"><span data-stu-id="21ef1-254">Provide the `MODULE_NAME` and `APPLICATION_NAME` in the command:</span></span>

```console
Appcmd.exe delete module MODULE_NAME /app.name:APPLICATION_NAME
```

<span data-ttu-id="21ef1-255">例如，從預設網站中移除 `DynamicCompressionModule`：</span><span class="sxs-lookup"><span data-stu-id="21ef1-255">For example, remove the `DynamicCompressionModule` from the Default Web Site:</span></span>

```console
%windir%\system32\inetsrv\appcmd.exe delete module DynamicCompressionModule /app.name:"Default Web Site"
```

## <a name="minimum-module-configuration"></a><span data-ttu-id="21ef1-256">最基本的模組設定</span><span class="sxs-lookup"><span data-stu-id="21ef1-256">Minimum module configuration</span></span>

<span data-ttu-id="21ef1-257">執行 ASP.NET Core 應用程式只需「匿名驗證模組」和「ASP.NET Core 模組」這兩個模組。</span><span class="sxs-lookup"><span data-stu-id="21ef1-257">The only modules required to run an ASP.NET Core app are the Anonymous Authentication Module and the ASP.NET Core Module.</span></span>

<span data-ttu-id="21ef1-258">「URI 快取模組」(`UriCacheModule`) 可讓 IIS 快取 URL 層級的網站設定。</span><span class="sxs-lookup"><span data-stu-id="21ef1-258">The URI Caching Module (`UriCacheModule`) allows IIS to cache website configuration at the URL level.</span></span> <span data-ttu-id="21ef1-259">如果沒有此模組，IIS 就必須針對每個要求都讀取並剖析設定，即使是重複要求相同的 URL 時也一樣。</span><span class="sxs-lookup"><span data-stu-id="21ef1-259">Without this module, IIS must read and parse configuration on every request, even when the same URL is repeatedly requested.</span></span> <span data-ttu-id="21ef1-260">針對每個要求都剖析設定會導致效能大幅降低。</span><span class="sxs-lookup"><span data-stu-id="21ef1-260">Parsing the configuration every request results in a significant performance penalty.</span></span> <span data-ttu-id="21ef1-261">*雖然不一定要有「URI 快取模組」，所裝載的 ASP.NET Core 應用程式就能執行，但建議您為所有 ASP.NET Core 部署都啟用「URI 快取模組」。*</span><span class="sxs-lookup"><span data-stu-id="21ef1-261">*Although the URI Caching Module isn't strictly required for a hosted ASP.NET Core app to run, we recommend that the URI Caching Module be enabled for all ASP.NET Core deployments.*</span></span>

<span data-ttu-id="21ef1-262">「HTTP 快取模組」(`HttpCacheModule`) 會實作 IIS 輸出快取，也會實作用來將項目快取至 HTTP.sys 快取中的邏輯。</span><span class="sxs-lookup"><span data-stu-id="21ef1-262">The HTTP Caching Module (`HttpCacheModule`) implements the IIS output cache and also the logic for caching items in the HTTP.sys cache.</span></span> <span data-ttu-id="21ef1-263">如果沒有此模組，就不會再以核心模式快取內容，而且會忽略快取設定檔。</span><span class="sxs-lookup"><span data-stu-id="21ef1-263">Without this module, content is no longer cached in kernel mode, and cache profiles are ignored.</span></span> <span data-ttu-id="21ef1-264">移除「HTTP 快取模組」通常會對效能和資源使用情況造成負面影響。</span><span class="sxs-lookup"><span data-stu-id="21ef1-264">Removing the HTTP Caching Module usually has adverse effects on performance and resource usage.</span></span> <span data-ttu-id="21ef1-265">*雖然不一定要有「HTTP 快取模組」，所裝載的 ASP.NET Core 應用程式就能執行，但建議您為所有 ASP.NET Core 部署都啟用「HTTP 快取模組」。*</span><span class="sxs-lookup"><span data-stu-id="21ef1-265">*Although the HTTP Caching Module isn't strictly required for a hosted ASP.NET Core app to run, we recommend that the HTTP Caching Module be enabled for all ASP.NET Core deployments.*</span></span>

## <a name="additional-resources"></a><span data-ttu-id="21ef1-266">其他資源</span><span class="sxs-lookup"><span data-stu-id="21ef1-266">Additional resources</span></span>

* <xref:host-and-deploy/iis/index>
* [<span data-ttu-id="21ef1-267">IIS 架構簡介：IIS 中的模組</span><span class="sxs-lookup"><span data-stu-id="21ef1-267">Introduction to IIS Architectures: Modules in IIS</span></span>](/iis/get-started/introduction-to-iis/introduction-to-iis-architecture#modules-in-iis)
* [<span data-ttu-id="21ef1-268">IIS 模組概觀</span><span class="sxs-lookup"><span data-stu-id="21ef1-268">IIS Modules Overview</span></span>](/iis/get-started/introduction-to-iis/iis-modules-overview)
* [<span data-ttu-id="21ef1-269">自訂 IIS 7.0 角色和模組</span><span class="sxs-lookup"><span data-stu-id="21ef1-269">Customizing IIS 7.0 Roles and Modules</span></span>](https://technet.microsoft.com/library/cc627313.aspx)
* [<span data-ttu-id="21ef1-270">IIS `<system.webServer>`</span><span class="sxs-lookup"><span data-stu-id="21ef1-270">IIS `<system.webServer>`</span></span>](/iis/configuration/system.webServer/)
